!function(e){"use strict";var n={},s=function(){return C.Boot.__string_rec(this,"")};function t(e,t){function n(){}n.prototype=e;var r=new n;for(var a in t)r[a]=t[a];return t.toString!==Object.prototype.toString&&(r.toString=t.toString),r}var r=e.DirectAPI=function(){this.eventEmitter=new y,C.Node.require("unorm")};(n.DirectAPI=r).__name__=["DirectAPI"],r.getInstance=function(){return null==r.instance&&(r.instance=new r),r.instance},r.main=function(){},r.prototype={setOptions:function(e){null!=e&&(v.host=e.host,v.endpoint=e.endpoint,v.accessToken=e.access_token,v.proxyURL=e.proxyURL,v.account=e.account,v.talkWithBot=e.talkWithBot,v.$name=e.name,v.storagePath=e.storage_path,v.storageQuota=e.storage_quota,v.wsConfig=e.ws_config),se._d(se.dateStr(),"current settings",v,"","",""),null==v.accessToken&&se._e(se.dateStr(),"Not enough parameters provided. I need a access token","","","","")},announce:function(e,t){var n,r=e.room;if(null!=r){var a=ie.Int64Helper.idStrToInt64(r);if(null==a||null==t)return;var i=this.data.getTalk(a);if(null==i)return;n=i.domainId}else n=ie.Int64Helper.idStrToInt64(e.id);null!=n&&this.sendQueue.sendAnnouncement(n,t)},send:function(e,t){var n=e.room,r=ie.Int64Helper.idStrToInt64(n);null!=r&&null!=t&&this.sendQueue.sendMessage(r,t)},topic:function(e,t){var n=e.room,r=ie.Int64Helper.idStrToInt64(n);this.facade.sendNotification("Talk",ie.command.TalkAction.UPDATE(r,null,t))},download:function(e,t,n){var r,a=null,i=null;"string"==typeof t?r=t:(r=t.url,a=t.path,i=t.name),null!=r?(null==i&&(i=C.Node.require("path").basename(r)),null==a&&(a=C.Node.require("path").join(C.Node.require("os").tmpdir(),i)),this.facade.sendNotification("File",ie.command.FileAction.DOWNLOAD_PATH(r,a,n))):n(null)},leave:function(e,t){var n,r=this,a=e.room,i=ie.Int64Helper.idStrToInt64(a);n=null==t?null:ie.Int64Helper.idStrToInt64(t.id),oe.Timer.delay(function(){r.facade.sendNotification("Talk",ie.command.TalkAction.DELETE(i,null,n))},500)},userForId:function(e){return this.hubotObject.userObjectByIdStr(null,e)},userObjects:function(){return this.hubotObject.userObjects(null)},talkObjects:function(){return this.hubotObject.talkObjects()},domainObjects:function(){return this.hubotObject.domainObjects()},parseInt64:function(e){return 0<e.length&&"_"==e.charAt(0)?ie.Int64Helper.makeFromIdStr(e):ie.Int64Helper.parse(e)},stringifyInt64:function(e,t){return null==t&&(t=!1),t?"_"+e.high+"_"+e.low:e.toString()},listen:function(){this.facade=ie.AppFacade.getInstance(),this.api=C.Boot.__cast(this.facade.retrieveProxy("api"),ie.proxy.AlberoServiceProxy),this.data=C.Boot.__cast(this.facade.retrieveProxy("dataStore"),ie.proxy.DataStoreProxy),this.hubotObject=C.Boot.__cast(this.facade.retrieveProxy("hubotObject"),u.proxy.HubotObjectProxy),this.sendQueue=C.Boot.__cast(this.facade.retrieveProxy("sendQueue"),u.proxy.SendQueueProxy),this.facade.startup()},emit:function(e,t,n,r){this.eventEmitter.emit(e,t,n,r)},on:function(e,t){return this.eventEmitter.on(e,t)},getDomainInvites:function(e){this.api._getDomainInvites(e)},acceptDomainInvite:function(e){this.api.acceptDomainInvite(e)},__class__:r};var o=function(e,t){t=t.split("u").join(""),this.r=new RegExp(e,t)};(n.EReg=o).__name__=["EReg"],o.prototype={match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&0<=e&&e<this.r.m.length)return this.r.m[e];throw"EReg::matched"},matchedPos:function(){if(null==this.r.m)throw"No string matched";return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(e,t,n){if(null==n&&(n=-1),this.r.global){this.r.lastIndex=t,this.r.m=this.r.exec(n<0?e:Y.substr(e,0,t+n));var r=null!=this.r.m;return r&&(this.r.s=e),r}var a=this.match(n<0?Y.substr(e,t,null):Y.substr(e,t,n));return a&&(this.r.s=e,this.r.m.index+=t),a},split:function(e){var t="#__delim__#";return e.replace(this.r,t).split(t)},replace:function(e,t){return e.replace(this.r,t)},map:function(e,t){var n=0,r=new L;do{if(n>=e.length)break;if(!this.matchSub(e,n)){r.add(Y.substr(e,n,null));break}var a=this.matchedPos();r.add(Y.substr(e,n,a.pos-n)),r.add(t(this)),0==a.len?(r.add(Y.substr(e,a.pos,1)),n=a.pos+1):n=a.pos+a.len}while(this.r.global);return!this.r.global&&0<n&&n<e.length&&r.add(Y.substr(e,n,null)),r.b},__class__:o};var Y=function(){};(n.HxOverrides=Y).__name__=["HxOverrides"],Y.dateStr=function(e){var t=e.getMonth()+1,n=e.getDate(),r=e.getHours(),a=e.getMinutes(),i=e.getSeconds();return e.getFullYear()+"-"+(t<10?"0"+t:""+t)+"-"+(n<10?"0"+n:""+n)+" "+(r<10?"0"+r:""+r)+":"+(a<10?"0"+a:""+a)+":"+(i<10?"0"+i:""+i)},Y.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),n=new Date;return n.setTime(0),n.setUTCHours(t[0]),n.setUTCMinutes(t[1]),n.setUTCSeconds(t[2]),n;case 10:var r=e.split("-");return new Date(r[0],r[1]-1,r[2],0,0,0);case 19:var a=e.split(" "),i=a[0].split("-"),o=a[1].split(":");return new Date(i[0],i[1]-1,i[2],o[0],o[1],o[2]);default:throw"Invalid date format : "+e}},Y.cca=function(e,t){var n=e.charCodeAt(t);if(n==n)return n},Y.substr=function(e,t,n){return null!=t&&0!=t&&null!=n&&n<0?"":(null==n&&(n=e.length),t<0?(t=e.length+t)<0&&(t=0):n<0&&(n=e.length+n-t),e.substr(t,n))},Y.indexOf=function(e,t,n){var r=e.length;for(n<0&&(n+=r)<0&&(n=0);n<r;){if(e[n]===t)return n;n++}return-1},Y.remove=function(e,t){var n=Y.indexOf(e,t,0);return-1!=n&&(e.splice(n,1),!0)},Y.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var ae=function(){};(n.Lambda=ae).__name__=["Lambda"],ae.array=function(e){for(var t=new Array,n=d(e)();n.hasNext();){var r=n.next();t.push(r)}return t},ae.exists=function(e,t){for(var n=d(e)();n.hasNext();){if(t(n.next()))return!0}return!1},ae.iter=function(e,t){for(var n=d(e)();n.hasNext();){t(n.next())}},ae.filter=function(e,t){for(var n=new X,r=d(e)();r.hasNext();){var a=r.next();t(a)&&n.add(a)}return n},ae.fold=function(e,t,n){for(var r=d(e)();r.hasNext();){n=t(r.next(),n)}return n},ae.count=function(e,t){var n=0;if(null==t)for(var r=d(e)();r.hasNext();){r.next();n++}else for(var a=d(e)();a.hasNext();){t(a.next())&&n++}return n},ae.find=function(e,t){for(var n=d(e)();n.hasNext();){var r=n.next();if(t(r))return r}return null};var X=function(){this.length=0};(n.List=X).__name__=["List"],X.prototype={add:function(e){var t=[e];null==this.h?this.h=t:this.q[1]=t,this.q=t,this.length++},isEmpty:function(){return null==this.h},remove:function(e){for(var t=null,n=this.h;null!=n;){if(n[0]==e)return null==t?this.h=n[1]:t[1]=n[1],this.q==n&&(this.q=t),this.length--,!0;n=(t=n)[1]}return!1},iterator:function(){return{h:this.h,hasNext:function(){return null!=this.h},next:function(){if(null==this.h)return null;var e=this.h[0];return this.h=this.h[1],e}}},map:function(e){for(var t=new X,n=this.h;null!=n;){var r=n[0];n=n[1],t.add(e(r))}return t},__class__:X};var a=function(){};(n.IMap=a).__name__=["IMap"],a.prototype={__class__:a},Math.__name__=["Math"];var g=function(){};(n.ObjectHelper=g).__name__=["ObjectHelper"],g.deepCopy=function(e){return null==e?null:JSON.parse(JSON.stringify(e))};var H=function(){};(n.Reflect=H).__name__=["Reflect"],H.field=function(e,t){try{return e[t]}catch(e){return null}},H.setField=function(e,t,n){e[t]=n},H.fields=function(e){var t=[];if(null!=e){var n=Object.prototype.hasOwnProperty;for(var r in e)"__id__"!=r&&"hx__closures__"!=r&&n.call(e,r)&&t.push(r)}return t},H.isFunction=function(e){return"function"==typeof e&&!(e.__name__||e.__ename__)},H.compare=function(e,t){return e==t?0:t<e?1:-1},H.isObject=function(e){if(null==e)return!1;var t=typeof e;return"string"==t||"object"==t&&null==e.__enum__||"function"==t&&null!=(e.__name__||e.__ename__)},H.isEnumValue=function(e){return null!=e&&null!=e.__enum__},H.deleteField=function(e,t){return!!Object.prototype.hasOwnProperty.call(e,t)&&(delete e[t],!0)};var Z=function(){};(n.Std=Z).__name__=["Std"],Z.string=function(e){return C.Boot.__string_rec(e,"")},Z.int=function(e){return 0|e},Z.parseInt=function(e){var t=parseInt(e,10);return 0!=t||120!=Y.cca(e,1)&&88!=Y.cca(e,1)||(t=parseInt(e)),isNaN(t)?null:t},Z.parseFloat=function(e){return parseFloat(e)};var L=function(){this.b=""};(n.StringBuf=L).__name__=["StringBuf"],L.prototype={add:function(e){this.b+=Z.string(e)},toString:function(){return this.b},__class__:L};var ee=function(){};(n.StringTools=ee).__name__=["StringTools"],ee.htmlEscape=function(e,t){return e=e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;"),t?e.split('"').join("&quot;").split("'").join("&#039;"):e},ee.startsWith=function(e,t){return e.length>=t.length&&Y.substr(e,0,t.length)==t},ee.endsWith=function(e,t){var n=t.length,r=e.length;return n<=r&&Y.substr(e,r-n,n)==t},ee.replace=function(e,t,n){return e.split(t).join(n)},ee.hex=function(e,t){for(var n="";n="0123456789ABCDEF".charAt(15&e)+n,0<(e>>>=4););if(null!=t)for(;n.length<t;)n="0"+n;return n},ee.fastCodeAt=function(e,t){return e.charCodeAt(t)};var c=function(){};(n.TextHelper=c).__name__=["TextHelper"],c.slice=function(e,t){for(var n=new Array,r=function(e){for(;e.length>t;)n.push(Y.substr(e,0,t)),e=Y.substr(e,t,null);0<e.length&&n.push(e)},a="",i=e.split("\n");0<i.length;){var o=i.shift();a.length+o.length>t&&(r(a),a=""),0<a.length&&(a+="\n"),a+=o}return r(a),n};var i=n.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};i.TNull=["TNull",0],i.TNull.toString=s,(i.TNull.__enum__=i).TInt=["TInt",1],i.TInt.toString=s,(i.TInt.__enum__=i).TFloat=["TFloat",2],i.TFloat.toString=s,(i.TFloat.__enum__=i).TBool=["TBool",3],i.TBool.toString=s,(i.TBool.__enum__=i).TObject=["TObject",4],i.TObject.toString=s,(i.TObject.__enum__=i).TFunction=["TFunction",5],i.TFunction.toString=s,(i.TFunction.__enum__=i).TClass=function(e){var t=["TClass",6,e];return t.__enum__=i,t.toString=s,t},i.TEnum=function(e){var t=["TEnum",7,e];return t.__enum__=i,t.toString=s,t},i.TUnknown=["TUnknown",8],i.TUnknown.toString=s,(i.TUnknown.__enum__=i).__empty_constructs__=[i.TNull,i.TInt,i.TFloat,i.TBool,i.TObject,i.TFunction,i.TUnknown];var te=function(){};(n.Type=te).__name__=["Type"],te.getClass=function(e){return null==e?null:e instanceof Array&&null==e.__enum__?Array:e.__class__},te.getClassName=function(e){return e.__name__.join(".")},te.getEnumName=function(e){return e.__ename__.join(".")},te.resolveClass=function(e){var t=n[e];return null!=t&&t.__name__?t:null},te.resolveEnum=function(e){var t=n[e];return null!=t&&t.__ename__?t:null},te.createInstance=function(e,t){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);default:throw"Too many arguments"}return null},te.createEmptyInstance=function(e){function t(){}return t.prototype=e.prototype,new t},te.createEnum=function(e,t,n){var r=H.field(e,t);if(null==r)throw"No such constructor "+t;if(H.isFunction(r)){if(null==n)throw"Constructor "+t+" need parameters";return r.apply(e,n)}if(null!=n&&0!=n.length)throw"Constructor "+t+" does not need parameters";return r},te.getEnumConstructs=function(e){return e.__constructs__.slice()},te.typeof=function(e){switch(typeof e){case"boolean":return i.TBool;case"string":return i.TClass(String);case"number":return Math.ceil(e)==e%2147483648?i.TInt:i.TFloat;case"object":if(null==e)return i.TNull;var t,n=e.__enum__;return null!=n?i.TEnum(n):null!=(t=e instanceof Array&&null==e.__enum__?Array:e.__class__)?i.TClass(t):i.TObject;case"function":return e.__name__||e.__ename__?i.TObject:i.TFunction;case"undefined":return i.TNull;default:return i.TUnknown}},te.enumEq=function(e,t){if(e==t)return!0;try{if(e[0]!=t[0])return!1;for(var n=2,r=e.length;n<r;){var a=n++;if(!te.enumEq(e[a],t[a]))return!1}var i=e.__enum__;if(i!=t.__enum__||null==i)return!1}catch(e){return!1}return!0},te.allEnums=function(e){return e.__empty_constructs__};var l={interfaces:{}};l.interfaces.IFacade=function(){},n["puremvc.interfaces.IFacade"]=l.interfaces.IFacade,l.interfaces.IFacade.__name__=["puremvc","interfaces","IFacade"],l.interfaces.IFacade.prototype={__class__:l.interfaces.IFacade},l.patterns={},l.patterns.facade={},l.patterns.facade.Facade=function(){(l.patterns.facade.Facade.instance=this).initializeFacade()},n["puremvc.patterns.facade.Facade"]=l.patterns.facade.Facade,l.patterns.facade.Facade.__name__=["puremvc","patterns","facade","Facade"],l.patterns.facade.Facade.__interfaces__=[l.interfaces.IFacade],l.patterns.facade.Facade.getInstance=function(){return null==l.patterns.facade.Facade.instance&&(l.patterns.facade.Facade.instance=new l.patterns.facade.Facade),l.patterns.facade.Facade.instance},l.patterns.facade.Facade.prototype={initializeFacade:function(){this.initializeModel(),this.initializeController(),this.initializeView()},initializeController:function(){null==this.controller&&(this.controller=l.core.Controller.getInstance())},initializeModel:function(){null==this.model&&(this.model=l.core.Model.getInstance())},initializeView:function(){null==this.view&&(this.view=l.core.View.getInstance())},registerCommand:function(e,t){this.controller.registerCommand(e,t)},removeCommand:function(e){this.controller.removeCommand(e)},hasCommand:function(e){return this.controller.hasCommand(e)},registerProxy:function(e){this.model.registerProxy(e)},retrieveProxy:function(e){return this.model.retrieveProxy(e)},removeProxy:function(e){var t=null;return null!=this.model&&(t=this.model.removeProxy(e)),t},hasProxy:function(e){return this.model.hasProxy(e)},registerMediator:function(e){null!=this.view&&this.view.registerMediator(e)},retrieveMediator:function(e){return this.view.retrieveMediator(e)},removeMediator:function(e){var t=null;return null!=this.view&&(t=this.view.removeMediator(e)),t},hasMediator:function(e){return this.view.hasMediator(e)},sendNotification:function(e,t,n){this.notifyObservers(new l.patterns.observer.Notification(e,t,n))},notifyObservers:function(e){null!=this.view&&this.view.notifyObservers(e)},__class__:l.patterns.facade.Facade};var ie={AppFacade:function(){l.patterns.facade.Facade.call(this)}};n["albero.AppFacade"]=ie.AppFacade,ie.AppFacade.__name__=["albero","AppFacade"],ie.AppFacade.getInstance=function(){return null==l.patterns.facade.Facade.instance&&(l.patterns.facade.Facade.instance=new ie.AppFacade),C.Boot.__cast(l.patterns.facade.Facade.instance,ie.AppFacade)},ie.AppFacade.__super__=l.patterns.facade.Facade,ie.AppFacade.prototype=t(l.patterns.facade.Facade.prototype,{initializeModel:function(){l.patterns.facade.Facade.prototype.initializeModel.call(this);var e=[new u.proxy.HubotObjectProxy,new u.proxy.SendQueueProxy,new u.proxy.MessageEventProxy,new ie.proxy.MsgPackRpcProxy,new ie.proxy.AppStateProxy,new ie.proxy.DataStoreProxy,new ie.proxy.DataFactoryProxy,new ie.proxy.DepartmentStoreProxy,new ie.proxy.SettingsProxy,new ie.proxy.AlberoBroadcastProxy,new ie.proxy.AlberoServiceProxy,new ie.proxy.FileServiceProxy,new ie.proxy.RoutingProxy,new ie.proxy.FileInfoStoreProxy,new ie.proxy.SearchServiceProxy,new ie.proxy.SolutionsStoreProxy,new ie.proxy.KeywordWatcherProxy,new ie.proxy.FeaturesProxy,new ie.proxy.MessageStoreProxy,new ie.proxy.ThumbnailExpansionProxy,new ie.proxy.SessionProxy,new ie.proxy.ReadStatusUpdaterProxy,new ie.proxy.LimitationsProxy,new ie.proxy.UserPresencesProxy,ie.proxy.AccessTokenResolverProxyFactory.newInstance()];e.push(ie.proxy.AccountLoaderProxyFactory.newInstance());for(var t=0;t<e.length;){var n=e[t];++t,this.registerProxy(n)}for(var r=0;r<e.length;){var a=e[r];++r,this.autoBind(a)}},initializeView:function(){l.patterns.facade.Facade.prototype.initializeView.call(this);for(var e=[new u.mediator.CommandLineMediator],t=0;t<e.length;){var n=e[t];++t,this.registerMediator(n)}},initializeController:function(){l.patterns.facade.Facade.prototype.initializeController.call(this);for(var e=[ie.command.DomainCommand,ie.command.SignInCommand,ie.command.SignOutCommand,ie.command.ReloadDataCommand,ie.command.SendCommand,ie.command.TalkCommand,ie.command.ManageFriendsCommand,ie.command.ReadCommand,ie.command.LoadStampSetCommand,ie.command.FileCommand,ie.command.SelectTalkCommand,ie.command.UpdateUserCommand,ie.command.UpdateProfileCommand,ie.command.UpdateUserPresencesCommand,ie.command.UrlCommand,ie.command.SearchCommand,ie.command.AccountControlRequestCommand,ie.command.MessageCommand,ie.command.DeviceCommand],t=0;t<e.length;){var n=e[t];++t;var r=ee.replace(te.getClassName(n).split(".").pop(),"Command","");this.registerCommand(r,n)}},registerMediator:function(e){this.autoBind(e),l.patterns.facade.Facade.prototype.registerMediator.call(this,e)},autoBind:function(e){for(var t=oe.rtti.Meta.getFields(te.getClass(e)),n=0,r=H.fields(t);n<r.length;){var a=r[n];++n;var i=H.field(t,a);if(Object.prototype.hasOwnProperty.call(i,"inject")){var o=this.retrieveProxy(a);null==o||(e[a]=o)}}},startup:function(){C.Boot.__cast(this.retrieveProxy("appState"),ie.proxy.AppStateProxy).start()},__class__:ie.AppFacade}),ie.AppState=n["albero.AppState"]={__ename__:["albero","AppState"],__constructs__:["Active","Inactive"]},ie.AppState.Active=["Active",0],ie.AppState.Active.toString=s,ie.AppState.Active.__enum__=ie.AppState,ie.AppState.Inactive=["Inactive",1],ie.AppState.Inactive.toString=s,ie.AppState.Inactive.__enum__=ie.AppState,ie.AppState.__empty_constructs__=[ie.AppState.Active,ie.AppState.Inactive],ie.ConnectionStatus=n["albero.ConnectionStatus"]={__ename__:["albero","ConnectionStatus"],__constructs__:["Ok","Error","ConcurrentAccessError","ForcibliyClosedError"]},ie.ConnectionStatus.Ok=["Ok",0],ie.ConnectionStatus.Ok.toString=s,ie.ConnectionStatus.Ok.__enum__=ie.ConnectionStatus,ie.ConnectionStatus.Error=["Error",1],ie.ConnectionStatus.Error.toString=s,ie.ConnectionStatus.Error.__enum__=ie.ConnectionStatus,ie.ConnectionStatus.ConcurrentAccessError=["ConcurrentAccessError",2],ie.ConnectionStatus.ConcurrentAccessError.toString=s,ie.ConnectionStatus.ConcurrentAccessError.__enum__=ie.ConnectionStatus,ie.ConnectionStatus.ForcibliyClosedError=["ForcibliyClosedError",3],ie.ConnectionStatus.ForcibliyClosedError.toString=s,ie.ConnectionStatus.ForcibliyClosedError.__enum__=ie.ConnectionStatus,ie.ConnectionStatus.__empty_constructs__=[ie.ConnectionStatus.Ok,ie.ConnectionStatus.Error,ie.ConnectionStatus.ConcurrentAccessError,ie.ConnectionStatus.ForcibliyClosedError],ie.DateTimeHelper=function(){},n["albero.DateTimeHelper"]=ie.DateTimeHelper,ie.DateTimeHelper.__name__=["albero","DateTimeHelper"],ie.DateTimeHelper.isSameDate=function(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()},ie.DateTimeHelper.dateString=function(e,t){var n=new Date,r="";return e.getFullYear()!=n.getFullYear()&&(r+=e.getFullYear()+"/"),r+=e.getMonth()+1+"/"+e.getDate(),t&&(r+=" ("+ie.DateTimeHelper.dayOfWeekString(e)+")"),r},ie.DateTimeHelper.dayOfWeekString=function(e){switch(e.getDay()){case 0:return ie.js.Localizer.localize("DateTimeHelper.sun");case 1:return ie.js.Localizer.localize("DateTimeHelper.mon");case 2:return ie.js.Localizer.localize("DateTimeHelper.tue");case 3:return ie.js.Localizer.localize("DateTimeHelper.wed");case 4:return ie.js.Localizer.localize("DateTimeHelper.thu");case 5:return ie.js.Localizer.localize("DateTimeHelper.fri");default:return ie.js.Localizer.localize("DateTimeHelper.sat")}},ie.DateTimeHelper.getDateStringForFile=function(){var e=new Date;return e.getFullYear()+ie.DateTimeHelper.toDoubleDigits(e.getMonth()+1)+ie.DateTimeHelper.toDoubleDigits(e.getDate())+"_"+ie.DateTimeHelper.toDoubleDigits(e.getHours())+ie.DateTimeHelper.toDoubleDigits(e.getMinutes())+ie.DateTimeHelper.toDoubleDigits(e.getSeconds())},ie.DateTimeHelper.getTimeStringForVoice=function(e){return ie.DateTimeHelper.toDoubleDigits(e/60|0)+":"+ie.DateTimeHelper.toDoubleDigits((0|e)%60)},ie.DateTimeHelper.toDoubleDigits=function(e){var t;return 1==(t=null==e?"null":""+e).length&&(t="0"+t),t},ie.DateTimeHelper.nowAsInt64=function(){return ie.DateTimeHelper.dateAsInt64((new Date).getTime())},ie.DateTimeHelper.oneDayAfterAsInt64=function(){return ie.DateTimeHelper.dateAsInt64((new Date).getTime()+864e5)},ie.DateTimeHelper.afterAsInt64=function(e){return ie.DateTimeHelper.dateAsInt64((new Date).getTime()+e)},ie.DateTimeHelper.dateAsInt64=function(e){var t=4294967296;return new oe.Int64(e/t|0,e%t|0)},ie.DateTimeHelper.abbreviateDatetimeString=function(e){if(null==e)return"";var t,n=new Date,r=ie.Int64Helper.toFloat(e),a=new Date;a.setTime(r),t=a;return n.getFullYear()==t.getFullYear()&&n.getMonth()==t.getMonth()&&n.getDate()==t.getDate()?t.getHours()+":"+(t.getMinutes()<10?"0":"")+t.getMinutes():ie.DateTimeHelper.dateString(t,!1)},ie.DateTimeHelper.datetimeStringIn11Chars=function(e){if(null==e)return"";var t,n=new Date,r=ie.Int64Helper.toFloat(e),a=new Date;a.setTime(r),t=a;var i=ie.DateTimeHelper.dateString(t,!1);return n.getFullYear()==t.getFullYear()&&(i+=" "+t.getHours()+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()),i},ie.DateTimeHelper.timeString=function(e){if(null==e)return"";var t,n=ie.Int64Helper.toFloat(e),r=new Date;return r.setTime(n),(t=r).getHours()+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()},ie.DateTimeHelper.datetimeString=function(e){if(null==e)return"";var t,n=Z.parseFloat(Z.string(e)),r=new Date;return r.setTime(n),(t=r).getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" "+t.getHours()+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()},ie.FileDynamicHelper=function(){},n["albero.FileDynamicHelper"]=ie.FileDynamicHelper,ie.FileDynamicHelper.__name__=["albero","FileDynamicHelper"],ie.FileDynamicHelper.filterDeleted=function(e){return null==e?[]:e.filter(ie.FileDynamicHelper.isNotDeleted)},ie.FileDynamicHelper.isNotDeleted=function(e){return null==e.deleted||!e.deleted},ie.FileDynamicHelper.createFileInfoDynamic=function(e,t,n,r){var a={url:r.get_url,content_type:e.type,content_size:e.size,name:t,file_id:r.file_id};return ie.OptionHelper.foreach(n,function(e){null!=e.auth&&(a.thumbnail_url=e.auth.get_url),null!=e.dimension&&(a.thumbnail_dimension=e.dimension.toObject())}),a},ie.FileHelper=function(){},n["albero.FileHelper"]=ie.FileHelper,ie.FileHelper.__name__=["albero","FileHelper"],ie.FileHelper.createByteSizeStringWithUnit=function(e){for(var t,n=["","K","M","G","T"];0<(t=e/1024|0);)e=t,n.shift();return e+" "+n.shift()+"B"},ie.History=function(){},n["albero.History"]=ie.History,ie.History.__name__=["albero","History"],ie.History.replaceState=function(e,t,n){return null!=window.history&&(window.history.replaceState(e,t,n),!0)},ie.Int64Helper=function(){},n["albero.Int64Helper"]=ie.Int64Helper,ie.Int64Helper.__name__=["albero","Int64Helper"],ie.Int64Helper.parse=function(e){if(!new o("^\\d+$","").match(e))return null;for(var t=new oe.Int64(0,0),n=new oe.Int64(0,10),r=0,a=e.length;r<a;){var i=r++;t=oe.Int64.add(oe.Int64.mul(t,n),oe.Int64.make(0,Z.parseInt(e.charAt(i))))}return t},ie.Int64Helper.getHigh=function(e){return e.high},ie.Int64Helper.getLow=function(e){return e.low},ie.Int64Helper.idStr=function(e){return"_"+e.high+"_"+e.low},ie.Int64Helper.makeFromIdStr=function(e){var t=new o("^_(-?\\d*)_(-?\\d*)$","");return t.match(e)?oe.Int64.make(Z.parseInt(t.matched(1)),Z.parseInt(t.matched(2))):null},ie.Int64Helper.eq=function(e,t){return null!=e&&null!=t&&e.high==t.high&&e.low==t.low},ie.Int64Helper.toFloat=function(e){var t=4294967296,n=e.high,r=e.low;return n*t+(0<=r?r:r+t)},ie.Int64Helper.idStrToInt64=function(e){var t=e.split("_");return 2<t.length?oe.Int64.make(Z.parseInt(t[1]),Z.parseInt(t[2])):null},ie.Int64Helper.decrement=function(e){return null==e?null:oe.Int64.sub(e,new oe.Int64(0,1))},ie.Int64Helper.increment=function(e){return null==e?null:oe.Int64.add(e,new oe.Int64(0,1))},ie.Int64Helper.unique=function(e){if(null==e)return[];for(var t=[],n=0,r=e.length;n<r;){var a=n++,i=e[a];ie.Int64Helper.indexOf(e,i)==a&&t.push(i)}return t},ie.Int64Helper.indexOf=function(e,t){if(null==e)return-1;for(var n=0,r=e.length;n<r;){var a=n++;if(ie.Int64Helper.eq(e[a],t))return a}return-1},ie.Int64Helper.contains=function(e,t){if(null==e)return!1;for(var n=0;n<e.length;){var r=e[n];if(++n,null!=r&&null!=t&&r.high==t.high&&r.low==t.low)return!0}return!1},ie.Int64Helper.notContains=function(e,t){return!ie.Int64Helper.contains(e,t)},ie.Int64Helper.remove=function(e,t){if(null==e)return!1;for(var n=0;n<e.length;){var r=e[n];if(++n,null!=r&&null!=t&&r.high==t.high&&r.low==t.low)return Y.remove(e,r),!0}return!1},ie.Int64Helper.fromIntOrInt64=function(e){return null==e||C.Boot.__instanceof(e,oe.Int64)?e:oe.Int64.ofInt(C.Boot.__cast(e,f))},ie.Int64Helper.eqArray=function(e,t){if(e!=t){if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var n=0,r=e.length;n<r;){var a=n++;if(!ie.Int64Helper.eq(e[a],t[a]))return!1}}return!0},ie.LambdaHelper=function(){},n["albero.LambdaHelper"]=ie.LambdaHelper,ie.LambdaHelper.__name__=["albero","LambdaHelper"],ie.LambdaHelper.flatten=function(e){return ae.filter(e,function(e){return ie.OptionHelper.isDefined(e)}).map(function(e){return ie.OptionHelper.get(e)})},ie.LambdaHelper.headOption=function(e){for(var t=d(e)();t.hasNext();){var n=t.next();return oe.ds.Option.Some(n)}return oe.ds.Option.None},ie.LambdaHelper.lastOption=function(e){for(var t=oe.ds.Option.None,n=d(e)();n.hasNext();){var r=n.next();t=oe.ds.Option.Some(r)}return t},ie.LambdaHelper.findOption=function(e,t){return ie.OptionHelper.option(ae.find(e,t))},ie.LambdaHelper.indexWhere=function(e,t){for(var n=0,r=d(e)();r.hasNext();){if(t(r.next()))return n;n+=1}return-1},ie.LambdaHelper.forall=function(e,t){return!ae.exists(e,function(e){return!t(e)})},ie.ArrayHelper=function(){},n["albero.ArrayHelper"]=ie.ArrayHelper,ie.ArrayHelper.__name__=["albero","ArrayHelper"],ie.ArrayHelper.lastOption=function(e){return 0==e.length?oe.ds.Option.None:oe.ds.Option.Some(e[e.length-1])},ie.ArrayHelper.sortAndReturn=function(e,t){return e.sort(t),e},ie.ArrayHelper.asArray=function(e){return C.Boot.__cast(e,Array)},ie.OptionHelper=function(){},n["albero.OptionHelper"]=ie.OptionHelper,ie.OptionHelper.__name__=["albero","OptionHelper"],ie.OptionHelper.map=function(e,t){switch(e[1]){case 1:return oe.ds.Option.None;case 0:var n=e[2];return oe.ds.Option.Some(t(n))}},ie.OptionHelper.flatMap=function(e,t){switch(e[1]){case 1:return oe.ds.Option.None;case 0:return t(e[2])}},ie.OptionHelper.foreach=function(e,t){switch(e[1]){case 1:break;case 0:t(e[2])}},ie.OptionHelper.filter=function(e,t){switch(e[1]){case 1:return oe.ds.Option.None;case 0:return t(e[2])?e:oe.ds.Option.None}},ie.OptionHelper.exists=function(e,t){return ie.OptionHelper.isDefined(ie.OptionHelper.filter(e,t))},ie.OptionHelper.isDefined=function(e){switch(e[1]){case 1:return!1;case 0:return!0}},ie.OptionHelper.isEmpty=function(e){switch(e[1]){case 1:return!0;case 0:return!1}},ie.OptionHelper.get=function(e){switch(e[1]){case 0:return e[2];case 1:throw"None.get called"}},ie.OptionHelper.orNull=function(e){switch(e[1]){case 1:return null;case 0:return e[2]}},ie.OptionHelper.flatten=function(e){return ie.OptionHelper.flatMap(e,function(e){return e})},ie.OptionHelper.eq=function(e,t){return te.enumEq(e,t)},ie.OptionHelper.option=function(e){return null!=e?oe.ds.Option.Some(e):oe.ds.Option.None},ie.StorageHelper=function(){},n["albero.StorageHelper"]=ie.StorageHelper,ie.StorageHelper.__name__=["albero","StorageHelper"],ie.StorageHelper.getItemAsJson=function(e){var t=ie.StorageHelper.getItem(e);if(null==t)return null;try{return JSON.parse(t)}catch(e){return null}},ie.StorageHelper.getItemAsInt=function(e){var t=ie.StorageHelper.getItem(e);return null==t?null:Z.parseInt(t)},ie.StorageHelper.getItem=function(e){var t=ie.js.LocalStorage.getLocalStorage();if(null==t)se._e(se.dateStr(),"storage not found","","","","");else try{return t.getItem(e)}catch(e){se._e(se.dateStr(),"storage error occered.",e,"","","")}return null},ie.StorageHelper.removeItem=function(e){var t=ie.js.LocalStorage.getLocalStorage();if(null==t)se._e(se.dateStr(),"storage not found","","","","");else try{return t.removeItem(e),!0}catch(e){se._e(se.dateStr(),"storage error occered.",e,"","","")}return!1},ie.StorageHelper.setItem=function(e,t){var n=ie.js.LocalStorage.getLocalStorage();if(null==n)se._e(se.dateStr(),"storage not found","","","","");else try{return n.setItem(e,t),!0}catch(e){se._e(se.dateStr(),"storage error occered.",e,"","","")}return!1},ie.StorageHelper.getItemWithUnserialize=function(e){var t=ie.StorageHelper.getItem(e);if(null!=t)try{return oe.Unserializer.run(t)}catch(e){se._w(se.dateStr(),e,"","","","")}return null},ie.StorageHelper.setItemWithSerialize=function(e,t){ie.StorageHelper.setItem(e,oe.Serializer.run(t))},ie.StringHelper=function(){},n["albero.StringHelper"]=ie.StringHelper,ie.StringHelper.__name__=["albero","StringHelper"],ie.StringHelper.trim=function(e){return e.trim()},ie.StringHelper.compare=function(e,t){return t<e?1:e<t?-1:0},ie.StringHelper.isEmpty=function(e){return null==e||0==e.length},ie.StringHelper.isNotEmpty=function(e){return!ie.StringHelper.isEmpty(e)},ie.StringHelper.randomString=function(){var e=new L,t=8;for(e.add(ee.hex(Z.int((new Date).getTime()),8));t++<36;)e.add(0!=(51*t&52)?ee.hex(0!=(15^t)?8^Z.int(Math.random()*(0!=(20^t)?16:4)):4):"-");return e.b.toLowerCase()},ie.Urls=n["albero.Urls"]={__ename__:["albero","Urls"],__constructs__:["auto","domains","domain","members","talks","actions","settings","announcements","error","loading","environment"]},ie.Urls.auto=["auto",0],ie.Urls.auto.toString=s,ie.Urls.auto.__enum__=ie.Urls,ie.Urls.domains=["domains",1],ie.Urls.domains.toString=s,ie.Urls.domains.__enum__=ie.Urls,ie.Urls.domain=function(e){var t=["domain",2,e];return t.__enum__=ie.Urls,t.toString=s,t},ie.Urls.members=function(e){var t=["members",3,e];return t.__enum__=ie.Urls,t.toString=s,t},ie.Urls.talks=function(e,t){var n=["talks",4,e,t];return n.__enum__=ie.Urls,n.toString=s,n},ie.Urls.actions=function(e){var t=["actions",5,e];return t.__enum__=ie.Urls,t.toString=s,t},ie.Urls.settings=function(e){var t=["settings",6,e];return t.__enum__=ie.Urls,t.toString=s,t},ie.Urls.announcements=["announcements",7],ie.Urls.announcements.toString=s,ie.Urls.announcements.__enum__=ie.Urls,ie.Urls.error=["error",8],ie.Urls.error.toString=s,ie.Urls.error.__enum__=ie.Urls,ie.Urls.loading=["loading",9],ie.Urls.loading.toString=s,ie.Urls.loading.__enum__=ie.Urls,ie.Urls.environment=function(e){var t=["environment",10,e];return t.__enum__=ie.Urls,t.toString=s,t},ie.Urls.__empty_constructs__=[ie.Urls.auto,ie.Urls.domains,ie.Urls.announcements,ie.Urls.error,ie.Urls.loading],ie.TalkUrlParam=n["albero.TalkUrlParam"]={__ename__:["albero","TalkUrlParam"],__constructs__:["multi","single","auto"]},ie.TalkUrlParam.multi=["multi",0],ie.TalkUrlParam.multi.toString=s,ie.TalkUrlParam.multi.__enum__=ie.TalkUrlParam,ie.TalkUrlParam.single=["single",1],ie.TalkUrlParam.single.toString=s,ie.TalkUrlParam.single.__enum__=ie.TalkUrlParam,ie.TalkUrlParam.auto=["auto",2],ie.TalkUrlParam.auto.toString=s,ie.TalkUrlParam.auto.__enum__=ie.TalkUrlParam,ie.TalkUrlParam.__empty_constructs__=[ie.TalkUrlParam.multi,ie.TalkUrlParam.single,ie.TalkUrlParam.auto],ie.UserInitialColors=function(){},n["albero.UserInitialColors"]=ie.UserInitialColors,ie.UserInitialColors.__name__=["albero","UserInitialColors"],ie.UserInitialColors.getBackgroundColor=function(e){if(null==e)return ie.UserInitialColors.COLORS[0];var t=oe.Int64.mod(e,oe.Int64.ofInt(ie.UserInitialColors.COLORS.length));return ie.UserInitialColors.COLORS[oe.Int64.getLow(t)]},ie.ViewAttrs=function(){},n["albero.ViewAttrs"]=ie.ViewAttrs,ie.ViewAttrs.__name__=["albero","ViewAttrs"],ie.ViewAttrs.queryAttr=function(e,t){if(null==t)return"["+e+"]";var n=t;return C.Boot.__instanceof(t,oe.Int64)&&(n=ie.Int64Helper.idStr(C.Boot.__cast(t,oe.Int64))),"["+e+"="+Z.string(n)+"]"},ie.ViewAttrs.queryAttrNot=function(e,t){if(null==t)return"["+e+"]";var n=t;return C.Boot.__instanceof(t,oe.Int64)&&(n=ie.Int64Helper.idStr(C.Boot.__cast(t,oe.Int64))),"["+e+"!="+Z.string(n)+"]"},ie.ViewAttrs.attrUser=function(e,t){return e.attr("data-user-id",t.id).attr("data-domain-id",t.domainId)},ie.ViewAttrs.queryUser=function(e){return ie.ViewAttrs.queryAttr("data-user-id",e.id)+ie.ViewAttrs.queryAttr("data-domain-id",e.domainId)},ie.ViewAttrs.queryUserByIds=function(e,t){return ie.ViewAttrs.queryAttr("data-user-id",t)+ie.ViewAttrs.queryAttr("data-domain-id",e)},ie.ViewAttrs.viewId=function(e){return"#"+e},ie.ViewAttrs.viewClass=function(e){return"."+e},l.interfaces.INotifier=function(){},n["puremvc.interfaces.INotifier"]=l.interfaces.INotifier,l.interfaces.INotifier.__name__=["puremvc","interfaces","INotifier"],l.interfaces.INotifier.prototype={__class__:l.interfaces.INotifier},l.patterns.observer={},l.patterns.observer.Notifier=function(){this.facade=l.patterns.facade.Facade.getInstance()},n["puremvc.patterns.observer.Notifier"]=l.patterns.observer.Notifier,l.patterns.observer.Notifier.__name__=["puremvc","patterns","observer","Notifier"],l.patterns.observer.Notifier.__interfaces__=[l.interfaces.INotifier],l.patterns.observer.Notifier.prototype={sendNotification:function(e,t,n){this.facade.sendNotification(e,t,n)},__class__:l.patterns.observer.Notifier},l.interfaces.ICommand=function(){},n["puremvc.interfaces.ICommand"]=l.interfaces.ICommand,l.interfaces.ICommand.__name__=["puremvc","interfaces","ICommand"],l.interfaces.ICommand.prototype={__class__:l.interfaces.ICommand},l.patterns.command={},l.patterns.command.SimpleCommand=function(){l.patterns.observer.Notifier.call(this)},n["puremvc.patterns.command.SimpleCommand"]=l.patterns.command.SimpleCommand,l.patterns.command.SimpleCommand.__name__=["puremvc","patterns","command","SimpleCommand"],l.patterns.command.SimpleCommand.__interfaces__=[l.interfaces.ICommand],l.patterns.command.SimpleCommand.__super__=l.patterns.observer.Notifier,l.patterns.command.SimpleCommand.prototype=t(l.patterns.observer.Notifier.prototype,{execute:function(e){},__class__:l.patterns.command.SimpleCommand}),ie.command={},ie.command.AutoBindCommand=function(){l.patterns.command.SimpleCommand.call(this),ie.AppFacade.getInstance().autoBind(this)},n["albero.command.AutoBindCommand"]=ie.command.AutoBindCommand,ie.command.AutoBindCommand.__name__=["albero","command","AutoBindCommand"],ie.command.AutoBindCommand.__super__=l.patterns.command.SimpleCommand,ie.command.AutoBindCommand.prototype=t(l.patterns.command.SimpleCommand.prototype,{__class__:ie.command.AutoBindCommand}),ie.command.AccountControlRequestCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.AccountControlRequestCommand"]=ie.command.AccountControlRequestCommand,ie.command.AccountControlRequestCommand.__name__=["albero","command","AccountControlRequestCommand"],ie.command.AccountControlRequestCommand.__super__=ie.command.AutoBindCommand,ie.command.AccountControlRequestCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.api.acceptAccountControlRequest(n);break;case 1:var r=t[2];this.api.rejectAccountControlRequest(r)}},__class__:ie.command.AccountControlRequestCommand}),ie.command.AccountControlRequestAction=n["albero.command.AccountControlRequestAction"]={__ename__:["albero","command","AccountControlRequestAction"],__constructs__:["ACCEPT_REQUEST","REJECT_REQUEST"]},ie.command.AccountControlRequestAction.ACCEPT_REQUEST=function(e){var t=["ACCEPT_REQUEST",0,e];return t.__enum__=ie.command.AccountControlRequestAction,t.toString=s,t},ie.command.AccountControlRequestAction.REJECT_REQUEST=function(e){var t=["REJECT_REQUEST",1,e];return t.__enum__=ie.command.AccountControlRequestAction,t.toString=s,t},ie.command.AccountControlRequestAction.__empty_constructs__=[],ie.command.DeviceCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.DeviceCommand"]=ie.command.DeviceCommand,ie.command.DeviceCommand.__name__=["albero","command","DeviceCommand"],ie.command.DeviceCommand.__super__=ie.command.AutoBindCommand,ie.command.DeviceCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var n=this;e.getBody();C.Node.require("read")({prompt:"Code: "},function(e,t){n.api.authorizeDevice(t,function(){n.sendNotification("SignIn")})})},__class__:ie.command.DeviceCommand}),ie.command.DeviceAction=n["albero.command.DeviceAction"]={__ename__:["albero","command","DeviceAction"],__constructs__:["AUTHORIZE"]},ie.command.DeviceAction.AUTHORIZE=["AUTHORIZE",0],ie.command.DeviceAction.AUTHORIZE.toString=s,ie.command.DeviceAction.AUTHORIZE.__enum__=ie.command.DeviceAction,ie.command.DeviceAction.__empty_constructs__=[ie.command.DeviceAction.AUTHORIZE],ie.command.DomainCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.DomainCommand"]=ie.command.DomainCommand,ie.command.DomainCommand.__name__=["albero","command","DomainCommand"],ie.command.DomainCommand.__super__=ie.command.AutoBindCommand,ie.command.DomainCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.api.acceptDomainInvite(n);break;case 1:var r=t[2];this.api.deleteDomainInvite(r);break;case 2:var a=t[2];this.api.leaveDomain(a)}},__class__:ie.command.DomainCommand}),ie.command.DomainAction=n["albero.command.DomainAction"]={__ename__:["albero","command","DomainAction"],__constructs__:["ACCEPT_INVITE","DELETE_INVITE","LEAVE"]},ie.command.DomainAction.ACCEPT_INVITE=function(e){var t=["ACCEPT_INVITE",0,e];return t.__enum__=ie.command.DomainAction,t.toString=s,t},ie.command.DomainAction.DELETE_INVITE=function(e){var t=["DELETE_INVITE",1,e];return t.__enum__=ie.command.DomainAction,t.toString=s,t},ie.command.DomainAction.LEAVE=function(e){var t=["LEAVE",2,e];return t.__enum__=ie.command.DomainAction,t.toString=s,t},ie.command.DomainAction.__empty_constructs__=[],ie.command.FileCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.FileCommand"]=ie.command.FileCommand,ie.command.FileCommand.__name__=["albero","command","FileCommand"],ie.command.FileCommand.__super__=ie.command.AutoBindCommand,ie.command.FileCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],r=t[2];this.api.upload(r.domainId,r.id,n);break;case 1:var a=t[4],i=t[3],o=t[2];this.api.uploadMulti(o.domainId,o.id,i,a);break;case 2:var s=t[2];s.deleted=!0,this.api.deleteAttachment(s.id,s.messageId);break;case 3:var l=t[6],c=t[5],u=t[4],d=t[3],p=t[2];this.api.createDownloadAuth(p,d,u,c,l);break;case 4:var m=t[6],_=t[5],h=t[4],y=t[3],f=t[2],g=this.fileService.createDummyFile(y,h,_),S=this.dataStore.getTalk(f);this.api.upload(S.domainId,S.id,g,m);break;case 5:for(var T=t[7],v=t[6],I=t[5],A=t[4],x=t[3],w=t[2],k=[],b=0,D=A.length;b<D;){var M=b++;k.push(this.fileService.createDummyFile(A[M],I[M],v[M]))}var E=this.dataStore.getTalk(w);this.api.uploadMulti(E.domainId,E.id,x,k,T);break;case 6:var C=t[4],P=t[3],N=t[2];this.fileService.download(N,P,C)}},__class__:ie.command.FileCommand}),ie.command.FileAction=n["albero.command.FileAction"]={__ename__:["albero","command","FileAction"],__constructs__:["UPLOAD","UPLOAD_MULTI","DELETE","AUTH","UPLOAD_PATH","UPLOAD_MULTI_PATH","DOWNLOAD_PATH"]},ie.command.FileAction.UPLOAD=function(e,t){var n=["UPLOAD",0,e,t];return n.__enum__=ie.command.FileAction,n.toString=s,n},ie.command.FileAction.UPLOAD_MULTI=function(e,t,n){var r=["UPLOAD_MULTI",1,e,t,n];return r.__enum__=ie.command.FileAction,r.toString=s,r},ie.command.FileAction.DELETE=function(e){var t=["DELETE",2,e];return t.__enum__=ie.command.FileAction,t.toString=s,t},ie.command.FileAction.AUTH=function(e,t,n,r,a){var i=["AUTH",3,e,t,n,r,a];return i.__enum__=ie.command.FileAction,i.toString=s,i},ie.command.FileAction.UPLOAD_PATH=function(e,t,n,r,a){var i=["UPLOAD_PATH",4,e,t,n,r,a];return i.__enum__=ie.command.FileAction,i.toString=s,i},ie.command.FileAction.UPLOAD_MULTI_PATH=function(e,t,n,r,a,i){var o=["UPLOAD_MULTI_PATH",5,e,t,n,r,a,i];return o.__enum__=ie.command.FileAction,o.toString=s,o},ie.command.FileAction.DOWNLOAD_PATH=function(e,t,n){var r=["DOWNLOAD_PATH",6,e,t,n];return r.__enum__=ie.command.FileAction,r.toString=s,r},ie.command.FileAction.__empty_constructs__=[],ie.command.LoadStampSetCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.LoadStampSetCommand"]=ie.command.LoadStampSetCommand,ie.command.LoadStampSetCommand.__name__=["albero","command","LoadStampSetCommand"],ie.command.LoadStampSetCommand.__super__=ie.command.AutoBindCommand,ie.command.LoadStampSetCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){new Array},__class__:ie.command.LoadStampSetCommand}),ie.command.ManageFriendsCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.ManageFriendsCommand"]=ie.command.ManageFriendsCommand,ie.command.ManageFriendsCommand.__name__=["albero","command","ManageFriendsCommand"],ie.command.ManageFriendsCommand.__super__=ie.command.AutoBindCommand,ie.command.ManageFriendsCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody();switch(t.action[1]){case 0:for(var n=0,r=t.users;n<r.length;){var a=r[n];++n,this.api.addFriend(a)}break;case 1:for(var i=0,o=t.users;i<o.length;){var s=o[i];++i,this.api.deleteFriend(s)}}},__class__:ie.command.ManageFriendsCommand}),ie.command.ManageFriendsAction=n["albero.command.ManageFriendsAction"]={__ename__:["albero","command","ManageFriendsAction"],__constructs__:["ADD","DELETE"]},ie.command.ManageFriendsAction.ADD=["ADD",0],ie.command.ManageFriendsAction.ADD.toString=s,ie.command.ManageFriendsAction.ADD.__enum__=ie.command.ManageFriendsAction,ie.command.ManageFriendsAction.DELETE=["DELETE",1],ie.command.ManageFriendsAction.DELETE.toString=s,ie.command.ManageFriendsAction.DELETE.__enum__=ie.command.ManageFriendsAction,ie.command.ManageFriendsAction.__empty_constructs__=[ie.command.ManageFriendsAction.ADD,ie.command.ManageFriendsAction.DELETE],ie.command.MessageCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.MessageCommand"]=ie.command.MessageCommand,ie.command.MessageCommand.__name__=["albero","command","MessageCommand"],ie.command.MessageCommand.__super__=ie.command.AutoBindCommand,ie.command.MessageCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],r=t[2];this.api.deleteMessage(r,n);break;case 1:var a=t[3],i=t[2];this.api.forwardMessages(i,a,0)}},__class__:ie.command.MessageCommand}),ie.command.MessageAction=n["albero.command.MessageAction"]={__ename__:["albero","command","MessageAction"],__constructs__:["DELETE","FORWARD"]},ie.command.MessageAction.DELETE=function(e,t){var n=["DELETE",0,e,t];return n.__enum__=ie.command.MessageAction,n.toString=s,n},ie.command.MessageAction.FORWARD=function(e,t){var n=["FORWARD",1,e,t];return n.__enum__=ie.command.MessageAction,n.toString=s,n},ie.command.MessageAction.__empty_constructs__=[],ie.command.ReadCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.ReadCommand"]=ie.command.ReadCommand,ie.command.ReadCommand.__name__=["albero","command","ReadCommand"],ie.command.ReadCommand.__super__=ie.command.AutoBindCommand,ie.command.ReadCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],r=t[2];this.readStatusUpdater.updateReadStatuses(r,n);break;case 1:var a=t[3],i=t[2];this.readStatusUpdater.updateAnnouncementReadStatus(i,a);break;case 2:var o=t[3],s=t[2];this.api.getReadStatus(s,o);break;case 3:var l=t[3],c=t[2];this.keywordWatcher.readKeywordDetection(c,null,l);break;case 4:var u=t[3],d=t[2];this.keywordWatcher.readKeywordDetection(null,d,u)}},__class__:ie.command.ReadCommand}),ie.command.ReadType=n["albero.command.ReadType"]={__ename__:["albero","command","ReadType"],__constructs__:["TALK","ANNOUNCEMENT","READ_STATUS","KEYWORD_IN_ANNOUNCEMENTS","KEYWORD_IN_MESSAGES"]},ie.command.ReadType.TALK=function(e,t){var n=["TALK",0,e,t];return n.__enum__=ie.command.ReadType,n.toString=s,n},ie.command.ReadType.ANNOUNCEMENT=function(e,t){var n=["ANNOUNCEMENT",1,e,t];return n.__enum__=ie.command.ReadType,n.toString=s,n},ie.command.ReadType.READ_STATUS=function(e,t){var n=["READ_STATUS",2,e,t];return n.__enum__=ie.command.ReadType,n.toString=s,n},ie.command.ReadType.KEYWORD_IN_ANNOUNCEMENTS=function(e,t){var n=["KEYWORD_IN_ANNOUNCEMENTS",3,e,t];return n.__enum__=ie.command.ReadType,n.toString=s,n},ie.command.ReadType.KEYWORD_IN_MESSAGES=function(e,t){var n=["KEYWORD_IN_MESSAGES",4,e,t];return n.__enum__=ie.command.ReadType,n.toString=s,n},ie.command.ReadType.__empty_constructs__=[],ie.command.ReloadDataCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.ReloadDataCommand"]=ie.command.ReloadDataCommand,ie.command.ReloadDataCommand.__name__=["albero","command","ReloadDataCommand"],ie.command.ReloadDataCommand.__super__=ie.command.AutoBindCommand,ie.command.ReloadDataCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:this.api.getDomains();break;case 1:this.api.getFriends(),this.api.getAcquaintances();break;case 2:this.api.getTalks();break;case 3:var n=t[5],r=t[4],a=t[3],i=t[2];this.api.getMessages(i,a,r,n);break;case 4:var o=t[2];this.api.getAllUsers(o);break;case 5:var s=t[3],l=t[2];this.api.getUsers(l,s);break;case 6:var c=t[3],u=t[2];this.api.getProfile(u,c);break;case 7:var d=t[3],p=t[2];this.api.searchDomainUsers(p,d);break;case 8:var m=t[4],_=t[3],h=t[2];this.api.getAnnouncements(h,_,m);break;case 9:var y=t[5],f=t[4],g=t[3],S=t[2];this.api.getQuestions(S,g,f,y);break;case 10:var T=t[3],v=t[2];this.api.getQuestion(v,T);break;case 11:var I=t[3],A=t[2];this.api.getAttachments(A,I);break;case 12:var x=t[3],w=t[2];this.api.getSolutions(w,x);break;case 13:this.api.getMe();break;case 14:var k=t[2];this.api.getDepartmentTree(k);break;case 15:var b=t[3],D=t[2];this.api.getDepartmentUsers(D,b);break;case 16:var M=t[2];this.api.getDepartmentAllUsers(M);break;case 17:var E=t[3],C=t[2];this.api.getDepartmentUserCount(C,E)}},__class__:ie.command.ReloadDataCommand}),ie.command.ReloadDataType=n["albero.command.ReloadDataType"]={__ename__:["albero","command","ReloadDataType"],__constructs__:["Domains","Friends","Talks","Messages","AllUsers","GetUsers","GetProfile","SearchDomainUsers","Announcements","Questions","Question","Files","Solutions","Me","DepartmentTree","DepartmentUsers","DepartmentAllUsers","DepartmentUserCount"]},ie.command.ReloadDataType.Domains=["Domains",0],ie.command.ReloadDataType.Domains.toString=s,ie.command.ReloadDataType.Domains.__enum__=ie.command.ReloadDataType,ie.command.ReloadDataType.Friends=["Friends",1],ie.command.ReloadDataType.Friends.toString=s,ie.command.ReloadDataType.Friends.__enum__=ie.command.ReloadDataType,ie.command.ReloadDataType.Talks=["Talks",2],ie.command.ReloadDataType.Talks.toString=s,ie.command.ReloadDataType.Talks.__enum__=ie.command.ReloadDataType,ie.command.ReloadDataType.Messages=function(e,t,n,r){var a=["Messages",3,e,t,n,r];return a.__enum__=ie.command.ReloadDataType,a.toString=s,a},ie.command.ReloadDataType.AllUsers=function(e){var t=["AllUsers",4,e];return t.__enum__=ie.command.ReloadDataType,t.toString=s,t},ie.command.ReloadDataType.GetUsers=function(e,t){var n=["GetUsers",5,e,t];return n.__enum__=ie.command.ReloadDataType,n.toString=s,n},ie.command.ReloadDataType.GetProfile=function(e,t){var n=["GetProfile",6,e,t];return n.__enum__=ie.command.ReloadDataType,n.toString=s,n},ie.command.ReloadDataType.SearchDomainUsers=function(e,t){var n=["SearchDomainUsers",7,e,t];return n.__enum__=ie.command.ReloadDataType,n.toString=s,n},ie.command.ReloadDataType.Announcements=function(e,t,n){var r=["Announcements",8,e,t,n];return r.__enum__=ie.command.ReloadDataType,r.toString=s,r},ie.command.ReloadDataType.Questions=function(e,t,n,r){var a=["Questions",9,e,t,n,r];return a.__enum__=ie.command.ReloadDataType,a.toString=s,a},ie.command.ReloadDataType.Question=function(e,t){var n=["Question",10,e,t];return n.__enum__=ie.command.ReloadDataType,n.toString=s,n},ie.command.ReloadDataType.Files=function(e,t){var n=["Files",11,e,t];return n.__enum__=ie.command.ReloadDataType,n.toString=s,n},ie.command.ReloadDataType.Solutions=function(e,t){var n=["Solutions",12,e,t];return n.__enum__=ie.command.ReloadDataType,n.toString=s,n},ie.command.ReloadDataType.Me=["Me",13],ie.command.ReloadDataType.Me.toString=s,ie.command.ReloadDataType.Me.__enum__=ie.command.ReloadDataType,ie.command.ReloadDataType.DepartmentTree=function(e){var t=["DepartmentTree",14,e];return t.__enum__=ie.command.ReloadDataType,t.toString=s,t},ie.command.ReloadDataType.DepartmentUsers=function(e,t){var n=["DepartmentUsers",15,e,t];return n.__enum__=ie.command.ReloadDataType,n.toString=s,n},ie.command.ReloadDataType.DepartmentAllUsers=function(e){var t=["DepartmentAllUsers",16,e];return t.__enum__=ie.command.ReloadDataType,t.toString=s,t},ie.command.ReloadDataType.DepartmentUserCount=function(e,t){var n=["DepartmentUserCount",17,e,t];return n.__enum__=ie.command.ReloadDataType,n.toString=s,n},ie.command.ReloadDataType.__empty_constructs__=[ie.command.ReloadDataType.Domains,ie.command.ReloadDataType.Friends,ie.command.ReloadDataType.Talks,ie.command.ReloadDataType.Me],ie.command.SearchCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.SearchCommand"]=ie.command.SearchCommand,ie.command.SearchCommand.__name__=["albero","command","SearchCommand"],ie.command.SearchCommand.__super__=ie.command.AutoBindCommand,ie.command.SearchCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[4],r=t[3],a=t[2];if(this.searchService.isSearching())return;switch(null==n&&this.searchService.saveParams(a),a.searchType[1]){case 0:this.api.searchMessages(a.copy(),r,n);break;case 1:this.api.searchAttachments(a.copy(),r,n)}break;case 1:this.searchService.clearEditingParams(),this.searchService.clearRecentParams(),this.searchService.clearSearching(),this.sendNotification("notify_search_clear",{})}},__class__:ie.command.SearchCommand}),ie.command.SearchAction=n["albero.command.SearchAction"]={__ename__:["albero","command","SearchAction"],__constructs__:["SEARCH","CLEAR"]},ie.command.SearchAction.SEARCH=function(e,t,n){var r=["SEARCH",0,e,t,n];return r.__enum__=ie.command.SearchAction,r.toString=s,r},ie.command.SearchAction.CLEAR=["CLEAR",1],ie.command.SearchAction.CLEAR.toString=s,ie.command.SearchAction.CLEAR.__enum__=ie.command.SearchAction,ie.command.SearchAction.__empty_constructs__=[ie.command.SearchAction.CLEAR],ie.command.SelectTalkCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.SelectTalkCommand"]=ie.command.SelectTalkCommand,ie.command.SelectTalkCommand.__name__=["albero","command","SelectTalkCommand"],ie.command.SelectTalkCommand.__super__=ie.command.AutoBindCommand,ie.command.SelectTalkCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],r=t[2];this.settings.selectTalk(ie.entity.PaneType.SingleTalkPane,r,oe.ds.Option.Some(n));break;case 1:var a=t[2];this.settings.selectTalk(ie.entity.PaneType.SingleTalkPane,a,oe.ds.Option.None);break;case 2:this.settings.selectAnnouncement(ie.entity.PaneType.SingleTalkPane)}},__class__:ie.command.SelectTalkCommand}),ie.command.SelectTalkAction=n["albero.command.SelectTalkAction"]={__ename__:["albero","command","SelectTalkAction"],__constructs__:["SelectTalkAndMessage","SelectTalk","SelectAnnouncement"]},ie.command.SelectTalkAction.SelectTalkAndMessage=function(e,t){var n=["SelectTalkAndMessage",0,e,t];return n.__enum__=ie.command.SelectTalkAction,n.toString=s,n},ie.command.SelectTalkAction.SelectTalk=function(e){var t=["SelectTalk",1,e];return t.__enum__=ie.command.SelectTalkAction,t.toString=s,t},ie.command.SelectTalkAction.SelectAnnouncement=["SelectAnnouncement",2],ie.command.SelectTalkAction.SelectAnnouncement.toString=s,ie.command.SelectTalkAction.SelectAnnouncement.__enum__=ie.command.SelectTalkAction,ie.command.SelectTalkAction.__empty_constructs__=[ie.command.SelectTalkAction.SelectAnnouncement],ie.command.SendCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.SendCommand"]=ie.command.SendCommand,ie.command.SendCommand.__name__=["albero","command","SendCommand"],ie.command.SendCommand.__super__=ie.command.AutoBindCommand,ie.command.SendCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t,n=e.getBody();t=null!=n.id?ie.Int64Helper.idStr(n.id):null,null!=n.talkId?this.api.createMessage(n.talkId,n.type,n.content,t):this.api.createAnnouncement(n.domainId,n.type,n.content,t)},__class__:ie.command.SendCommand}),ie.command.SignInCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.SignInCommand"]=ie.command.SignInCommand,ie.command.SignInCommand.__name__=["albero","command","SignInCommand"],ie.command.SignInCommand.__super__=ie.command.AutoBindCommand,ie.command.SignInCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){this.accessTokenResolver.asyncGetAccessToken(e.getBody(),_(p=this.session,p.start))},__class__:ie.command.SignInCommand}),ie.command.SignOutCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.SignOutCommand"]=ie.command.SignOutCommand,ie.command.SignOutCommand.__name__=["albero","command","SignOutCommand"],ie.command.SignOutCommand.__super__=ie.command.AutoBindCommand,ie.command.SignOutCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){this.api.deleteSession(),this.settings.clearInputTextForAll(),this.dataStore.clear(!0),se._e(se.dateStr(),"signout","","","",""),C.Node.process.exit(1)},__class__:ie.command.SignOutCommand}),ie.command.TalkCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.TalkCommand"]=ie.command.TalkCommand,ie.command.TalkCommand.__name__=["albero","command","TalkCommand"],ie.command.TalkCommand.__super__=ie.command.AutoBindCommand,ie.command.TalkCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=this,n=e.getBody();switch(n[1]){case 0:var r=n[4],a=n[3],i=n[2],o=this.dataStore.getValidPairTalk(a,i);null!=o?this.sendNotification("SelectTalk",ie.command.SelectTalkAction.SelectTalk(o)):this.api.createPairTalk(i,a,r);break;case 1:var s=n[5],l=n[4],c=n[3],u=n[2];this.api.createGroupTalk(u,c,l,s);break;case 2:var d=n[4],p=n[3],m=n[2];this.api.addTalkers(m,p,d);break;case 3:var _=n[4],h=n[3],y=n[2];null==h&&(h=this.dataStore.getTalk(y)),null==_&&(_=this.dataStore.me.id),this.api.deleteTalker(h,_);break;case 4:var f=n[7],g=n[6],S=n[5],T=n[4],v=n[3],I=n[2];if(null==v&&(v=this.dataStore.getTalk(I)),v.type!=ie.entity.TalkType.GroupTalk)return;null==f&&(f=C.Boot.__cast(v,ie.entity.Talk).isSystemMessageVisibled()),this.prepareIconUrl(v.domainId,S,g,function(e){t.api.updateGroupTalk(v,T,e,f)});break;case 5:var A=n[3],x=n[2];this.api.addFavoriteTalk(x,A);break;case 6:var w=n[3],k=n[2];this.api.deleteFavoriteTalk(k,w);break;case 7:var b=n[3],D=n[2];this.api.disablePushNotification(D,b);break;case 8:var M=n[3],E=n[2];this.api.enablePushNotification(E,M)}},prepareIconUrl:function(e,t,n,r){var a=this;null==n&&null!=t?this.api.uploadFile(t,e,ie.entity.UploadUseType.TALK_ICON,function(e){r(e.get_url)},function(e){a.sendNotification("notify_update_group_talk_ERRORED")}):r(n)},__class__:ie.command.TalkCommand}),ie.command.TalkAction=n["albero.command.TalkAction"]={__ename__:["albero","command","TalkAction"],__constructs__:["OPEN_PAIR_TALK","OPEN_GROUP_TALK","ADD","DELETE","UPDATE","ADD_FAVORITE","DELETE_FAVORITE","DISABLE_PUSH_NOTIFICATION","ENABLE_PUSH_NOTIFICATION"]},ie.command.TalkAction.OPEN_PAIR_TALK=function(e,t,n){var r=["OPEN_PAIR_TALK",0,e,t,n];return r.__enum__=ie.command.TalkAction,r.toString=s,r},ie.command.TalkAction.OPEN_GROUP_TALK=function(e,t,n,r){var a=["OPEN_GROUP_TALK",1,e,t,n,r];return a.__enum__=ie.command.TalkAction,a.toString=s,a},ie.command.TalkAction.ADD=function(e,t,n){var r=["ADD",2,e,t,n];return r.__enum__=ie.command.TalkAction,r.toString=s,r},ie.command.TalkAction.DELETE=function(e,t,n){var r=["DELETE",3,e,t,n];return r.__enum__=ie.command.TalkAction,r.toString=s,r},ie.command.TalkAction.UPDATE=function(e,t,n,r,a,i){var o=["UPDATE",4,e,t,n,r,a,i];return o.__enum__=ie.command.TalkAction,o.toString=s,o},ie.command.TalkAction.ADD_FAVORITE=function(e,t){var n=["ADD_FAVORITE",5,e,t];return n.__enum__=ie.command.TalkAction,n.toString=s,n},ie.command.TalkAction.DELETE_FAVORITE=function(e,t){var n=["DELETE_FAVORITE",6,e,t];return n.__enum__=ie.command.TalkAction,n.toString=s,n},ie.command.TalkAction.DISABLE_PUSH_NOTIFICATION=function(e,t){var n=["DISABLE_PUSH_NOTIFICATION",7,e,t];return n.__enum__=ie.command.TalkAction,n.toString=s,n},ie.command.TalkAction.ENABLE_PUSH_NOTIFICATION=function(e,t){var n=["ENABLE_PUSH_NOTIFICATION",8,e,t];return n.__enum__=ie.command.TalkAction,n.toString=s,n},ie.command.TalkAction.__empty_constructs__=[],ie.command.UpdateProfileCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.UpdateProfileCommand"]=ie.command.UpdateProfileCommand,ie.command.UpdateProfileCommand.__name__=["albero","command","UpdateProfileCommand"],ie.command.UpdateProfileCommand.__super__=ie.command.AutoBindCommand,ie.command.UpdateProfileCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody().domainId,n=e.getBody().profileItemValues,r=e.getBody().copyToAllDomains,a=this.dataStore.getDomain(t);if(null!=a&&null!=a.profileDefinition.itemDefinitions){var i=new Array;if(r){for(var o=new Array,s=0;s<n.length;){var l=n[s];++s;var c=ie.entity.ProfileItemDefinition.findById(a.profileDefinition.itemDefinitions,l.profileItemId);null!=c&&o.push({name:c.name,value:l.value})}for(var u=0,d=this.dataStore.getDomains();u<d.length;){var p=d[u];if(++u,!p.domainInfo.frozen){for(var m=new Array,_=0,h=p.profileDefinition.itemDefinitions;_<h.length;){var y=h[_];if(++_,y.visible&&!y.locked)for(var f=0;f<o.length;){var g=o[f];if(++f,g.name==y.name){var S=new ie.entity.ProfileItemValue;S.profileItemId=y.profileItemId,S.value=g.value,m.push(S);break}}}0<m.length&&i.push(new ie.entity.ProfileItemValuesPerDomain(p.id,m))}}}else{for(var T=new Array,v=(Y.iter(n),0);v<n.length;){var I=n[v];++v;var A=ie.entity.ProfileItemDefinition.findById(a.profileDefinition.itemDefinitions,I.profileItemId);null!=A&&A.visible&&!A.locked&&T.push(I)}0<T.length&&i.push(new ie.entity.ProfileItemValuesPerDomain(a.id,T))}0==i.length?this.sendNotification("update_profile_responsed",this.dataStore.me):this.api.updateProfile(i)}},__class__:ie.command.UpdateProfileCommand}),ie.command.UpdateUserCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.UpdateUserCommand"]=ie.command.UpdateUserCommand,ie.command.UpdateUserCommand.__name__=["albero","command","UpdateUserCommand"],ie.command.UpdateUserCommand.__super__=ie.command.AutoBindCommand,ie.command.UpdateUserCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody();(null==t.profileImage||ee.startsWith(t.profileImage.type,"image/"))&&this.api.updateUser(t.displayName,t.profileImage,t.profileImageUrl,t.phoneticDisplayName,t.status)},__class__:ie.command.UpdateUserCommand}),ie.command.UpdateUserPresencesCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.UpdateUserPresencesCommand"]=ie.command.UpdateUserPresencesCommand,ie.command.UpdateUserPresencesCommand.__name__=["albero","command","UpdateUserPresencesCommand"],ie.command.UpdateUserPresencesCommand.__super__=ie.command.AutoBindCommand,ie.command.UpdateUserPresencesCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody().domainId,n=e.getBody().userIds;if(null!=t&&null!=n){var r=this.filterOnlyExpired(ie.Int64Helper.unique(n));0!=r.length&&this.updateIfNeedPerSub(t,r)}},filterOnlyExpired:function(e){var n=this,r=ie.DateTimeHelper.nowAsInt64(),a=oe.Int64.ofInt(this.settings.getConfiguration().presenceExpiration);return e.filter(function(e){var t=ie.OptionHelper.map(n.userPresences.getUserPresence(e),function(e){return e.isExpired(r,a)});switch(t[1]){case 0:return t[2];case 1:return!0}})},updateIfNeedPerSub:function(e,t){var n=t.splice(0,100);0!=n.length&&this.api.getPresences(e,n),0!=t.length&&this.updateIfNeedPerSub(e,t)},__class__:ie.command.UpdateUserPresencesCommand}),ie.command.UrlCommand=function(){ie.command.AutoBindCommand.call(this)},n["albero.command.UrlCommand"]=ie.command.UrlCommand,ie.command.UrlCommand.__name__=["albero","command","UrlCommand"],ie.command.UrlCommand.__super__=ie.command.AutoBindCommand,ie.command.UrlCommand.prototype=t(ie.command.AutoBindCommand.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.routing.forward(n);break;case 1:var r=t[2];this.routing.redirect(r);break;case 2:this.routing.back()}},__class__:ie.command.UrlCommand}),ie.command.UrlAction=n["albero.command.UrlAction"]={__ename__:["albero","command","UrlAction"],__constructs__:["FORWARD","REDIRECT","BACK"]},ie.command.UrlAction.FORWARD=function(e){var t=["FORWARD",0,e];return t.__enum__=ie.command.UrlAction,t.toString=s,t},ie.command.UrlAction.REDIRECT=function(e){var t=["REDIRECT",1,e];return t.__enum__=ie.command.UrlAction,t.toString=s,t},ie.command.UrlAction.BACK=["BACK",2],ie.command.UrlAction.BACK.toString=s,ie.command.UrlAction.BACK.__enum__=ie.command.UrlAction,ie.command.UrlAction.__empty_constructs__=[ie.command.UrlAction.BACK],ie.entity={},ie.entity.Account=function(e,t,n){this.email=e,this.pass=t,this.accessToken=n},n["albero.entity.Account"]=ie.entity.Account,ie.entity.Account.__name__=["albero","entity","Account"],ie.entity.Account.prototype={__class__:ie.entity.Account},ie.entity.AccountControlGroup=function(e){null!=e&&(this.id=e.id,this.group=new ie.entity.AccountControlGroupGroup(e.group),this.profilePolicy=new ie.entity.AccountControlGroupProfilePolicy(e.profile_policy))},n["albero.entity.AccountControlGroup"]=ie.entity.AccountControlGroup,ie.entity.AccountControlGroup.__name__=["albero","entity","AccountControlGroup"],ie.entity.AccountControlGroup.prototype={isAllowedUpdateProfileImage:function(){return null==this.profilePolicy||this.profilePolicy.allowUpdateProfileImage},isAllowedUpdateDisplayName:function(){return null==this.profilePolicy||this.profilePolicy.allowUpdateDisplayName},__class__:ie.entity.AccountControlGroup},ie.entity.AccountControlGroupGroup=function(e){null!=e&&(this.name=e.name,this.alias=e.alias,this.ownerName=e.owner_name,this.version=e.version)},n["albero.entity.AccountControlGroupGroup"]=ie.entity.AccountControlGroupGroup,ie.entity.AccountControlGroupGroup.__name__=["albero","entity","AccountControlGroupGroup"],ie.entity.AccountControlGroupGroup.prototype={__class__:ie.entity.AccountControlGroupGroup},ie.entity.AccountControlGroupProfilePolicy=function(e){null!=e&&(this.allowUpdateDisplayName=e.allow_update_display_name,this.allowUpdateProfileImage=e.allow_update_profile_image,this.version=e.version)},n["albero.entity.AccountControlGroupProfilePolicy"]=ie.entity.AccountControlGroupProfilePolicy,ie.entity.AccountControlGroupProfilePolicy.__name__=["albero","entity","AccountControlGroupProfilePolicy"],ie.entity.AccountControlGroupProfilePolicy.prototype={__class__:ie.entity.AccountControlGroupProfilePolicy},ie.entity.AccountControlGroupPartialUpdate=function(e){null!=e&&(this.id=e.id,null!=e.group&&(this.group=new ie.entity.AccountControlGroupGroup(e.group)),null!=e.profile_policy&&(this.profilePolicy=new ie.entity.AccountControlGroupProfilePolicy(e.profile_policy)))},n["albero.entity.AccountControlGroupPartialUpdate"]=ie.entity.AccountControlGroupPartialUpdate,ie.entity.AccountControlGroupPartialUpdate.__name__=["albero","entity","AccountControlGroupPartialUpdate"],ie.entity.AccountControlGroupPartialUpdate.prototype={__class__:ie.entity.AccountControlGroupPartialUpdate},ie.entity.AccountControlRequest=function(e){null!=e&&(this.id=ie.Int64Helper.fromIntOrInt64(e.id),this.groupName=e.group_name,this.groupOwnerName=e.group_owner_name,this.groupOwnerEmail=e.group_owner_email,this.hasDomainInvite=e.has_domain_invite,this.updatedAt=e.updated_at,this.version=e.version)},n["albero.entity.AccountControlRequest"]=ie.entity.AccountControlRequest,ie.entity.AccountControlRequest.__name__=["albero","entity","AccountControlRequest"],ie.entity.AccountControlRequest.prototype={__class__:ie.entity.AccountControlRequest},ie.entity.Announcement=function(e){null!=e&&(this.id=e.announcement_id,this.domainId=e.domain_id,this.groupId=e.group_id,this.groupName=e.group_name,this.type=ie.entity.Message.typeOf(e.type),this.content=e.content,this.userId=e.user_id,this.userName=e.user_name,this.createdAt=e.created_at)},n["albero.entity.Announcement"]=ie.entity.Announcement,ie.entity.Announcement.__name__=["albero","entity","Announcement"],ie.entity.Announcement.prototype={__class__:ie.entity.Announcement},ie.entity.AnnouncementStatus=function(e){this.unreadCount=0,null!=e&&(this.domainId=e.domain_id,null!=e.unread_count?this.unreadCount=e.unread_count:this.unreadCount=0,this.maxAnnouncementId=e.max_announcement_id,null!=e.max_announcement&&(this.maxAnnouncement=new ie.entity.Announcement(e.max_announcement)),this.maxReadAnnouncementId=e.max_read_announcement_id)},n["albero.entity.AnnouncementStatus"]=ie.entity.AnnouncementStatus,ie.entity.AnnouncementStatus.__name__=["albero","entity","AnnouncementStatus"],ie.entity.AnnouncementStatus.prototype={updateReadWithStatusUpdate:function(e){var t=0,n=null;if(null!=e.readAnnouncementIds)for(var r=0,a=e.readAnnouncementIds;r<a.length;){var i=a[r];++r,(null==this.maxReadAnnouncementId||0<oe.Int64.compare(i,this.maxReadAnnouncementId))&&((null==n||0<oe.Int64.compare(i,n))&&(n=i),t++)}null!=n&&this.read(n,t)},read:function(e,t){this.maxReadAnnouncementId=e,this.unreadCount-=t,this.unreadCount<0&&(this.unreadCount=0),se._d(se.dateStr(),"Announcement status is updated. [domainId, maxReadAnnoundementId, unreadCount]:",this.domainId,this.maxReadAnnouncementId,this.unreadCount,"")},readAll:function(){this.maxReadAnnouncementId=this.maxAnnouncementId,this.unreadCount=0},__class__:ie.entity.AnnouncementStatus},ie.entity.AnnouncementStatusHelper=function(){},n["albero.entity.AnnouncementStatusHelper"]=ie.entity.AnnouncementStatusHelper,ie.entity.AnnouncementStatusHelper.__name__=["albero","entity","AnnouncementStatusHelper"],ie.entity.AnnouncementStatusHelper.isUnreadAnnouncementExisted=function(e){return null!=e&&(null!=e.maxAnnouncement&&(null==e.maxReadAnnouncementId||0<oe.Int64.compare(e.maxAnnouncement.id,e.maxReadAnnouncementId)))},ie.entity.AnnouncementStatusHelper.isUnread=function(e,t){return null==e.maxReadAnnouncementId||oe.Int64.compare(e.maxReadAnnouncementId,t)<0},ie.entity.AnnouncementStatusHelper.isNewMax=function(e,t){return null==e.maxAnnouncementId||oe.Int64.compare(e.maxAnnouncementId,t)<0},ie.entity.AnnouncementStatusHelper.isMax=function(e,t){return null!=e.maxAnnouncementId&&ie.Int64Helper.eq(e.maxAnnouncementId,t)},ie.entity.AnnouncementStatusUpdate=function(e){null!=e&&(this.domainId=e.domain_id,this.readAnnouncementIds=e.read_announcement_ids)},n["albero.entity.AnnouncementStatusUpdate"]=ie.entity.AnnouncementStatusUpdate,ie.entity.AnnouncementStatusUpdate.__name__=["albero","entity","AnnouncementStatusUpdate"],ie.entity.AnnouncementStatusUpdate.prototype={__class__:ie.entity.AnnouncementStatusUpdate},ie.entity.BrowserSettings=function(e){if(this.notificationInvisibleTalkSound=!0,this.notificationInvisibleTalkPopup=!1,this.notificationVisibleTalkSound=!1,this.notificationVisibleTalkPopup=!1,this.talkAutoScroll=ie.entity.BrowserSettings.TalkAutoScrollDelay,this.keywordWatchingText="",this.keywordWatchingEmphasis=!1,this.keywordWatchingSelfMessage=!1,this.keywordWatchingActionReply=!1,this.userDataContainer=new Array,this.language="ja",null!=e){if(null!=e.notificationInvisibleTalkSound&&(this.notificationInvisibleTalkSound=e.notificationInvisibleTalkSound),null!=e.notificationInvisibleTalkPopup&&(this.notificationInvisibleTalkPopup=e.notificationInvisibleTalkPopup),null!=e.notificationVisibleTalkSound&&(this.notificationVisibleTalkSound=e.notificationVisibleTalkSound),null!=e.notificationVisibleTalkPopup&&(this.notificationVisibleTalkPopup=e.notificationVisibleTalkPopup),null!=e.notificationVisibleTalkAutoScroll&&(e.notificationVisibleTalkAutoScroll?this.talkAutoScroll=ie.entity.BrowserSettings.TalkAutoScrollDelay:this.talkAutoScroll=ie.entity.BrowserSettings.TalkAutoScrollNone),null!=e.talkAutoScroll&&(this.talkAutoScroll=e.talkAutoScroll),null!=e.keywordWatchingText&&(this.keywordWatchingText=e.keywordWatchingText),null!=e.keywordWatchingEmphasis&&(this.keywordWatchingEmphasis=e.keywordWatchingEmphasis),null!=e.keywordWatchingSelfMessage&&(this.keywordWatchingSelfMessage=e.keywordWatchingSelfMessage),null!=e.keywordWatchingActionReply&&(this.keywordWatchingActionReply=e.keywordWatchingActionReply),null!=e.userDataContainer){var t,n=0;for(t=C.Boot.__cast(e.userDataContainer,Array);n<t.length;){var r=t[n];++n,this.userDataContainer.push(ie.entity.UserData.fromJson(r))}}null!=e.language&&(this.language=e.language)}},n["albero.entity.BrowserSettings"]=ie.entity.BrowserSettings,ie.entity.BrowserSettings.__name__=["albero","entity","BrowserSettings"],ie.entity.BrowserSettings.fromJson=function(e){return new ie.entity.BrowserSettings(e)},ie.entity.BrowserSettings.prototype={createCopy:function(){var e=new ie.entity.BrowserSettings(null);return this.copyTo(e),e},equalNotificationSettings:function(e){return e.notificationInvisibleTalkSound==this.notificationInvisibleTalkSound&&e.notificationInvisibleTalkPopup==this.notificationInvisibleTalkPopup&&e.notificationVisibleTalkSound==this.notificationVisibleTalkSound&&e.notificationVisibleTalkPopup==this.notificationVisibleTalkPopup},equalTalkSettings:function(e){return e.talkAutoScroll==this.talkAutoScroll},equalKeywordWatching:function(e){return e.keywordWatchingText==this.keywordWatchingText&&e.keywordWatchingEmphasis==this.keywordWatchingEmphasis&&e.keywordWatchingSelfMessage==this.keywordWatchingSelfMessage&&e.keywordWatchingActionReply==this.keywordWatchingActionReply},equalLanguageSettings:function(e){return e.language==this.language},equalUserData:function(e,t){var n=e.getUserData(t),r=this.getUserData(t);if(null==n||null==n)return!0;var a=r.stampHistories.length;if(n.stampHistories.length!=a)return!0;for(var i=0;i<a;){var o=i++;if(n.stampHistories[o]!=r.stampHistories[o])return!0}return!1},copyTo:function(e){this.copyNotificationSettingsTo(e),this.copyKeywordSettingsTo(e),this.copyTalkSettingsTo(e),this.copyUserDataContainerTo(e),this.copyLanguageSettingsTo(e)},copyNotificationSettingsTo:function(e){e.notificationInvisibleTalkSound=this.notificationInvisibleTalkSound,e.notificationInvisibleTalkPopup=this.notificationInvisibleTalkPopup,e.notificationVisibleTalkSound=this.notificationVisibleTalkSound,e.notificationVisibleTalkPopup=this.notificationVisibleTalkPopup},copyKeywordSettingsTo:function(e){e.keywordWatchingText=this.keywordWatchingText,e.keywordWatchingEmphasis=this.keywordWatchingEmphasis,e.keywordWatchingSelfMessage=this.keywordWatchingSelfMessage,e.keywordWatchingActionReply=this.keywordWatchingActionReply},copyTalkSettingsTo:function(e){e.talkAutoScroll=this.talkAutoScroll},copyUserDataContainerTo:function(e){e.userDataContainer=this.userDataContainer},getUserData:function(t){return ae.find(this.userDataContainer,function(e){return e.userIdString==t})},copyLanguageSettingsTo:function(e){e.language=this.language},assureUserData:function(e){var t=this.getUserData(e);return null==t&&(t=ie.entity.UserData.fromUserIdString(e),this.userDataContainer.push(t)),t},__class__:ie.entity.BrowserSettings},ie.entity.UserData=function(){},n["albero.entity.UserData"]=ie.entity.UserData,ie.entity.UserData.__name__=["albero","entity","UserData"],ie.entity.UserData.fromUserIdString=function(e){var t=new ie.entity.UserData;return t.userIdString=e,t.stampHistories=new Array,t.useThumbnailExpansion=!1,t},ie.entity.UserData.fromJson=function(e){var t=new ie.entity.UserData;return null!=e&&(null!=e.userIdString&&(t.userIdString=e.userIdString),null!=e.stampHistories&&(t.stampHistories=e.stampHistories),null!=e.useThumbnailExpansion&&(t.useThumbnailExpansion=e.useThumbnailExpansion)),t},ie.entity.UserData.prototype={__class__:ie.entity.UserData},ie.entity.Configuration=function(e){null!=e&&(this.maxFriends=e.max_friends,this.maxTalks=e.max_talks,this.maxTalkers=e.max_talkers,this.maxMessageContentLength=e.max_message_content_length,this.botExpiredVersion=e.bot_expired_version,null!=e.presence_expiration?this.presenceExpiration=e.presence_expiration:this.presenceExpiration=ie.entity.Configuration.DEFAULT_PRESENCE_EXPIRATION)},n["albero.entity.Configuration"]=ie.entity.Configuration,ie.entity.Configuration.__name__=["albero","entity","Configuration"],ie.entity.Configuration.prototype={__class__:ie.entity.Configuration},ie.entity.Contract=function(e){null!=e&&(this.id=e.contract_id,this.plan=new ie.entity.Plan(e.plan),this.quota=new ie.entity.Quota(e.quota),this.solutionIds=e.solution_ids)},n["albero.entity.Contract"]=ie.entity.Contract,ie.entity.Contract.__name__=["albero","entity","Contract"],ie.entity.Contract.prototype={getMaxMessageContentLength:function(){return ie.OptionHelper.map(ie.OptionHelper.option(this.quota),function(e){return e.maxMessageContentLength})},getMaxTalkers:function(){return ie.OptionHelper.flatMap(ie.OptionHelper.option(this.quota),function(e){return ie.OptionHelper.option(e.maxTalkers)})},__class__:ie.entity.Contract},ie.entity.Department=function(e){if(null!=e){switch(this.id=e.department_id,this.order=e.order,this.parentId=e.parent,null==e.node?this.nodeType=ie.entity.DepartmentNodeType.Normal:this.nodeType=this.parseDepartmentNodeType(e.node),this.nodeType[1]){case 1:this.name=ie.entity.Department.getLabelRoot();break;case 2:this.name=ie.entity.Department.getLabelFree();break;case 0:this.name=e.name}this.depth=0,this.childrenIds=null,this.userCount=null,this.userIds=null,this.userCountLoading=!1}},n["albero.entity.Department"]=ie.entity.Department,ie.entity.Department.__name__=["albero","entity","Department"],ie.entity.Department.getLabelFree=function(){return ie.js.Localizer.localize("Department.label_free")},ie.entity.Department.getLabelRoot=function(){return ie.js.Localizer.localize("Department.label_root")},ie.entity.Department.prototype={addChild:function(e){null==this.childrenIds&&(this.childrenIds=[]),this.childrenIds.push(e)},isRoot:function(){return this.nodeType==ie.entity.DepartmentNodeType.Root},isFree:function(){return this.nodeType==ie.entity.DepartmentNodeType.Free},parseDepartmentNodeType:function(e){switch(e){case 1:return ie.entity.DepartmentNodeType.Root;case 2:return ie.entity.DepartmentNodeType.Free;default:return ie.entity.DepartmentNodeType.Normal}},__class__:ie.entity.Department},ie.entity.DepartmentHelper=function(){},n["albero.entity.DepartmentHelper"]=ie.entity.DepartmentHelper,ie.entity.DepartmentHelper.__name__=["albero","entity","DepartmentHelper"],ie.entity.DepartmentHelper.getName=function(e){return null==e?null:e.name},ie.entity.DepartmentNodeType=n["albero.entity.DepartmentNodeType"]={__ename__:["albero","entity","DepartmentNodeType"],__constructs__:["Normal","Root","Free"]},ie.entity.DepartmentNodeType.Normal=["Normal",0],ie.entity.DepartmentNodeType.Normal.toString=s,ie.entity.DepartmentNodeType.Normal.__enum__=ie.entity.DepartmentNodeType,ie.entity.DepartmentNodeType.Root=["Root",1],ie.entity.DepartmentNodeType.Root.toString=s,ie.entity.DepartmentNodeType.Root.__enum__=ie.entity.DepartmentNodeType,ie.entity.DepartmentNodeType.Free=["Free",2],ie.entity.DepartmentNodeType.Free.toString=s,ie.entity.DepartmentNodeType.Free.__enum__=ie.entity.DepartmentNodeType,ie.entity.DepartmentNodeType.__empty_constructs__=[ie.entity.DepartmentNodeType.Normal,ie.entity.DepartmentNodeType.Root,ie.entity.DepartmentNodeType.Free],ie.entity.DepartmentList=function(e){null!=e&&(this.domainId=e.domain_id,this.departments=this.getDepartments(e.departments))},n["albero.entity.DepartmentList"]=ie.entity.DepartmentList,ie.entity.DepartmentList.__name__=["albero","entity","DepartmentList"],ie.entity.DepartmentList.prototype={getDepartments:function(e){return null==e?[]:e.map(function(e){return new ie.entity.Department(e)})},__class__:ie.entity.DepartmentList},ie.entity.DepartmentUserCount=function(e){null!=e&&(this.departmentId=e.department_id,this.all=e.all,this.partial=e.partial)},n["albero.entity.DepartmentUserCount"]=ie.entity.DepartmentUserCount,ie.entity.DepartmentUserCount.__name__=["albero","entity","DepartmentUserCount"],ie.entity.DepartmentUserCount.prototype={__class__:ie.entity.DepartmentUserCount},ie.entity.DepartmentUserCountList=function(e){null!=e&&(this.departments=this.getDepartmentUserCounts(e.departments))},n["albero.entity.DepartmentUserCountList"]=ie.entity.DepartmentUserCountList,ie.entity.DepartmentUserCountList.__name__=["albero","entity","DepartmentUserCountList"],ie.entity.DepartmentUserCountList.prototype={getDepartmentUserCounts:function(e){return null==e?[]:e.map(function(e){return new ie.entity.DepartmentUserCount(e)})},__class__:ie.entity.DepartmentUserCountList},ie.entity.Domain=function(e){null!=e&&(this.id=e.domain_id,this.updatedAt=e.updated_at,this.domainInfo=new ie.entity.DomainInfo(e.domain),this.contract=new ie.entity.Contract(e.contract),this.profileDefinition=new ie.entity.ProfileDefinition(e.profile_definition),this.setting=new ie.entity.DomainSetting(e.setting),this.role=new ie.entity.DomainRole(e.role),this.closed=!1)},n["albero.entity.Domain"]=ie.entity.Domain,ie.entity.Domain.__name__=["albero","entity","Domain"],ie.entity.Domain.isChangedContractTreeEnabled=function(e,t){return ie.entity.Domain.isDepartmentEnabled(e)!=ie.entity.Domain.isDepartmentEnabled(t)},ie.entity.Domain.isDepartmentEnabled=function(e){return null!=e&&(ie.entity.Domain.isAllowListUser(e)&&!!e.setting.contactTreeEnabled)},ie.entity.Domain.isAllowListUser=function(e){return null==e||e.role.allowListUsers},ie.entity.Domain.isChangedRoleType=function(e,t){return(null==e?ie.entity.DomainRoleType.user:e.role.type)!=(null==t?ie.entity.DomainRoleType.user:t.role.type)},ie.entity.Domain.isChangedMaxTalkers=function(e,t){var n,r,a=ie.OptionHelper.flatMap(ie.OptionHelper.option(e),function(e){return e.getMaxTalkers()});switch(a[1]){case 0:n=a[2];break;case 1:n=0}var i=ie.OptionHelper.flatMap(ie.OptionHelper.option(t),function(e){return e.getMaxTalkers()});switch(i[1]){case 0:r=i[2];break;case 1:r=0}return n!=r},ie.entity.Domain.prototype={getMaxMessageContentLengthOrElse:function(e){var t=ie.OptionHelper.flatMap(ie.OptionHelper.option(this.contract),function(e){return e.getMaxMessageContentLength()});switch(t[1]){case 0:return t[2];case 1:return e}},getMaxTalkers:function(){return ie.OptionHelper.flatMap(ie.OptionHelper.option(this.contract),function(e){return e.getMaxTalkers()})},__class__:ie.entity.Domain},ie.entity.DomainInfo=function(e){null!=e&&(this.name=e.domain_name,this.logoUrl=e.logo_url,this.frozen=e.frozen)},n["albero.entity.DomainInfo"]=ie.entity.DomainInfo,ie.entity.DomainInfo.__name__=["albero","entity","DomainInfo"],ie.entity.DomainInfo.prototype={__class__:ie.entity.DomainInfo},ie.entity.DomainSetting=function(e){null!=e&&(this.allowAttachmentType=this.allowAttachmentTypeOf(e.allow_attachment_type),this.allowSaveAttachmentsToDevice=e.allow_save_attachments_to_device,null!=e.allow_save_attachments&&(this.allowSaveAttachments=new ie.entity.DomainSettingAllowSaveAttachments(e.allow_save_attachments)),this.allowForwardMessageType=this.allowForwardMessageTypeOf(e.allow_forward_message_type),this.contactTreeEnabled=!!e.contact_tree_enabled)},n["albero.entity.DomainSetting"]=ie.entity.DomainSetting,ie.entity.DomainSetting.__name__=["albero","entity","DomainSetting"],ie.entity.DomainSetting.prototype={allowAttachmentTypeOf:function(e){switch(e){case 0:return ie.entity.DomainAllowAttachmentType.ng;case 1:return ie.entity.DomainAllowAttachmentType.ok;case 2:return ie.entity.DomainAllowAttachmentType.image;case 3:return ie.entity.DomainAllowAttachmentType.imageOrVideo;case 4:return ie.entity.DomainAllowAttachmentType.imageOrVideoOrAudio;default:return ie.entity.DomainAllowAttachmentType.other}},allowForwardMessageTypeOf:function(e){switch(e){case 0:return ie.entity.DomainAllowForwardMessageType.ng;case 1:return ie.entity.DomainAllowForwardMessageType.ok;case 2:return ie.entity.DomainAllowForwardMessageType.onlyTextOrStamp;default:return ie.entity.DomainAllowForwardMessageType.other}},__class__:ie.entity.DomainSetting},ie.entity.DomainSettingAllowSaveAttachments=function(e){null!=e&&(null==e.web?this.web=!0:this.web=e.web,null==e.ios?this.ios=!0:this.ios=e.ios,null==e.android?this.android=!0:this.android=e.android,null==e.desktop?this.desktop=!0:this.desktop=e.desktop)},n["albero.entity.DomainSettingAllowSaveAttachments"]=ie.entity.DomainSettingAllowSaveAttachments,ie.entity.DomainSettingAllowSaveAttachments.__name__=["albero","entity","DomainSettingAllowSaveAttachments"],ie.entity.DomainSettingAllowSaveAttachments.prototype={__class__:ie.entity.DomainSettingAllowSaveAttachments},ie.entity.DomainRole=function(e){null!=e&&(this.type=this.typeOf(e.type),this.allowGuests=this.def(e.allow_guests,!0),this.allowCreateAttachments=this.def(e.allow_create_attachments,!0),this.allowReadAttachments=this.def(e.allow_read_attachments,!0),this.allowCreateAnnouncement=this.def(e.allow_create_announcement,!1),this.allowReadAnnouncements=e.allow_read_announcements,null==this.allowReadAnnouncements&&(this.allowReadAnnouncements=!0),this.allowListUsers=e.allow_list_users,null==this.allowListUsers&&(this.allowListUsers=!0))},n["albero.entity.DomainRole"]=ie.entity.DomainRole,ie.entity.DomainRole.__name__=["albero","entity","DomainRole"],ie.entity.DomainRole.prototype={def:function(e,t){return e||t},typeOf:function(e){switch(e){case 10:return ie.entity.DomainRoleType.owner;case 20:return ie.entity.DomainRoleType.manager;case 30:return ie.entity.DomainRoleType.user;default:return ie.entity.DomainRoleType.guest}},__class__:ie.entity.DomainRole},ie.entity.DomainRoleType=n["albero.entity.DomainRoleType"]={__ename__:["albero","entity","DomainRoleType"],__constructs__:["owner","manager","user","guest"]},ie.entity.DomainRoleType.owner=["owner",0],ie.entity.DomainRoleType.owner.toString=s,ie.entity.DomainRoleType.owner.__enum__=ie.entity.DomainRoleType,ie.entity.DomainRoleType.manager=["manager",1],ie.entity.DomainRoleType.manager.toString=s,ie.entity.DomainRoleType.manager.__enum__=ie.entity.DomainRoleType,ie.entity.DomainRoleType.user=["user",2],ie.entity.DomainRoleType.user.toString=s,ie.entity.DomainRoleType.user.__enum__=ie.entity.DomainRoleType,ie.entity.DomainRoleType.guest=["guest",3],ie.entity.DomainRoleType.guest.toString=s,ie.entity.DomainRoleType.guest.__enum__=ie.entity.DomainRoleType,ie.entity.DomainRoleType.__empty_constructs__=[ie.entity.DomainRoleType.owner,ie.entity.DomainRoleType.manager,ie.entity.DomainRoleType.user,ie.entity.DomainRoleType.guest],ie.entity.DomainAllowAttachmentType=n["albero.entity.DomainAllowAttachmentType"]={__ename__:["albero","entity","DomainAllowAttachmentType"],__constructs__:["ng","ok","image","imageOrVideo","imageOrVideoOrAudio","other"]},ie.entity.DomainAllowAttachmentType.ng=["ng",0],ie.entity.DomainAllowAttachmentType.ng.toString=s,ie.entity.DomainAllowAttachmentType.ng.__enum__=ie.entity.DomainAllowAttachmentType,ie.entity.DomainAllowAttachmentType.ok=["ok",1],ie.entity.DomainAllowAttachmentType.ok.toString=s,ie.entity.DomainAllowAttachmentType.ok.__enum__=ie.entity.DomainAllowAttachmentType,ie.entity.DomainAllowAttachmentType.image=["image",2],ie.entity.DomainAllowAttachmentType.image.toString=s,ie.entity.DomainAllowAttachmentType.image.__enum__=ie.entity.DomainAllowAttachmentType,ie.entity.DomainAllowAttachmentType.imageOrVideo=["imageOrVideo",3],ie.entity.DomainAllowAttachmentType.imageOrVideo.toString=s,ie.entity.DomainAllowAttachmentType.imageOrVideo.__enum__=ie.entity.DomainAllowAttachmentType,ie.entity.DomainAllowAttachmentType.imageOrVideoOrAudio=["imageOrVideoOrAudio",4],ie.entity.DomainAllowAttachmentType.imageOrVideoOrAudio.toString=s,ie.entity.DomainAllowAttachmentType.imageOrVideoOrAudio.__enum__=ie.entity.DomainAllowAttachmentType,ie.entity.DomainAllowAttachmentType.other=["other",5],ie.entity.DomainAllowAttachmentType.other.toString=s,ie.entity.DomainAllowAttachmentType.other.__enum__=ie.entity.DomainAllowAttachmentType,ie.entity.DomainAllowAttachmentType.__empty_constructs__=[ie.entity.DomainAllowAttachmentType.ng,ie.entity.DomainAllowAttachmentType.ok,ie.entity.DomainAllowAttachmentType.image,ie.entity.DomainAllowAttachmentType.imageOrVideo,ie.entity.DomainAllowAttachmentType.imageOrVideoOrAudio,ie.entity.DomainAllowAttachmentType.other],ie.entity.DomainAllowForwardMessageType=n["albero.entity.DomainAllowForwardMessageType"]={__ename__:["albero","entity","DomainAllowForwardMessageType"],__constructs__:["ng","ok","onlyTextOrStamp","other"]},ie.entity.DomainAllowForwardMessageType.ng=["ng",0],ie.entity.DomainAllowForwardMessageType.ng.toString=s,ie.entity.DomainAllowForwardMessageType.ng.__enum__=ie.entity.DomainAllowForwardMessageType,ie.entity.DomainAllowForwardMessageType.ok=["ok",1],ie.entity.DomainAllowForwardMessageType.ok.toString=s,ie.entity.DomainAllowForwardMessageType.ok.__enum__=ie.entity.DomainAllowForwardMessageType,ie.entity.DomainAllowForwardMessageType.onlyTextOrStamp=["onlyTextOrStamp",2],ie.entity.DomainAllowForwardMessageType.onlyTextOrStamp.toString=s,ie.entity.DomainAllowForwardMessageType.onlyTextOrStamp.__enum__=ie.entity.DomainAllowForwardMessageType,ie.entity.DomainAllowForwardMessageType.other=["other",3],ie.entity.DomainAllowForwardMessageType.other.toString=s,ie.entity.DomainAllowForwardMessageType.other.__enum__=ie.entity.DomainAllowForwardMessageType,ie.entity.DomainAllowForwardMessageType.__empty_constructs__=[ie.entity.DomainAllowForwardMessageType.ng,ie.entity.DomainAllowForwardMessageType.ok,ie.entity.DomainAllowForwardMessageType.onlyTextOrStamp,ie.entity.DomainAllowForwardMessageType.other],ie.entity.DomainDepartmentPath=function(e){null!=e&&(this.domainId=e.domain_id,this.departments=e.departments)},n["albero.entity.DomainDepartmentPath"]=ie.entity.DomainDepartmentPath,ie.entity.DomainDepartmentPath.__name__=["albero","entity","DomainDepartmentPath"],ie.entity.DomainDepartmentPath.prototype={__class__:ie.entity.DomainDepartmentPath},ie.entity.DomainInvite=function(e){null!=e&&(this.id=e.domain_id,this.name=e.domain_name,this.accountControlRequestId=ie.Int64Helper.fromIntOrInt64(e.account_control_request_id),this.updatedAt=e.updated_at)},n["albero.entity.DomainInvite"]=ie.entity.DomainInvite,ie.entity.DomainInvite.__name__=["albero","entity","DomainInvite"],ie.entity.DomainInvite.prototype={__class__:ie.entity.DomainInvite},ie.entity.User=function(e){null!=e&&(this.id=e.user_id,this.status=e.status,this.displayName=e.display_name,this.canonicalDisplayName=e.canonical_display_name,this.phoneticDisplayName=e.phonetic_display_name,this.canonicalPhoneticDisplayName=e.canonical_phonetic_display_name,this.profileImageUrl=e.profile_image_url,this.updatedAt=e.updated_at)},n["albero.entity.User"]=ie.entity.User,ie.entity.User.__name__=["albero","entity","User"],ie.entity.User.prototype={__class__:ie.entity.User},ie.entity.DomainUser=function(e){ie.entity.User.call(this,e),null!=e&&(this.domainId=e.domain_id,null!=e.profile_contact&&(this.profileContact=C.Boot.__cast(e.profile_contact,Array).map(function(e){return new ie.entity.ProfileItemValue(e)})),this.departments=e.departments)},n["albero.entity.DomainUser"]=ie.entity.DomainUser,ie.entity.DomainUser.__name__=["albero","entity","DomainUser"],ie.entity.DomainUser.__super__=ie.entity.User,ie.entity.DomainUser.prototype=t(ie.entity.User.prototype,{match:function(e,t,n){if(this.matchNameOrPhonetic(e,n))return!0;if(null!=this.profileContact&&null!=t.profileDefinition.itemDefinitions)for(var r=0,a=this.profileContact;r<a.length;){var i=a[r];++r;for(var o=0,s=t.profileDefinition.itemDefinitions;o<s.length;){var l=s[o];if(++o,l.profileItemId==i.profileItemId){if(l.visible&&10==l.group&&-1<i.canonicalValue.indexOf(e))return!0;break}}}return!1},matchNameOrPhonetic:function(e,t){return!!ie.StringHelper.isEmpty(e)||(ie.StringHelper.isEmpty(this.canonicalDisplayName)&&(this.canonicalDisplayName=ie.js.TextCanonicalizer.canonicalize(this.displayName,t),se._d(se.dateStr(),"create canonical display name from %s to %s.",this.canonicalDisplayName,this.displayName,"","")),-1<this.canonicalDisplayName.indexOf(e)||null!=this.canonicalPhoneticDisplayName&&-1<this.canonicalPhoneticDisplayName.indexOf(e))},matchNameOrPhoneticRoman:function(e,t){return!!this.matchNameOrPhonetic(e,t)||(ie.StringHelper.isEmpty(this.canonicalDisplayNameRoman)&&(this.canonicalDisplayNameRoman=ie.js.TextCanonicalizer.canonicalizeForRoman(this.displayName,t),se._d(se.dateStr(),"create canonical display name(roman) from %s to %s.",this.canonicalDisplayNameRoman,this.displayName,"","")),-1<this.canonicalDisplayNameRoman.indexOf(e)||null!=this.canonicalPhoneticDisplayName&&(ie.StringHelper.isEmpty(this.canonicalPhoneticDisplayNameRoman)&&(this.canonicalPhoneticDisplayNameRoman=ie.js.TextCanonicalizer.canonicalizeForRoman(this.canonicalPhoneticDisplayName,t)),-1<this.canonicalPhoneticDisplayNameRoman.indexOf(e)))},__class__:ie.entity.DomainUser}),ie.entity.Domains=function(e){this.values=e},n["albero.entity.Domains"]=ie.entity.Domains,ie.entity.Domains.__name__=["albero","entity","Domains"],ie.entity.Domains.prototype={orderByName:function(e){var t,n,r=ie.ArrayHelper.sortAndReturn(this.values.map((t=ie.entity.DomainForSort.fromDomain,n=e,function(e){return t(e,n)})),ie.entity.DomainForSort.compare).map(ie.entity.DomainForSort.toDomain);return new ie.entity.Domains(r)},__class__:ie.entity.Domains},ie.entity.DomainForSort=function(e,t){this.domain=e,this.name=e.domainInfo.name,this.canonicalizedName=ie.js.TextCanonicalizer.canonicalize(this.name,t)},n["albero.entity.DomainForSort"]=ie.entity.DomainForSort,ie.entity.DomainForSort.__name__=["albero","entity","DomainForSort"],ie.entity.DomainForSort.fromDomain=function(e,t){return new ie.entity.DomainForSort(e,t)},ie.entity.DomainForSort.toDomain=function(e){return e.domain},ie.entity.DomainForSort.compare=function(e,t){var n=ie.StringHelper.compare(e.canonicalizedName,t.canonicalizedName);return 0!=n?n:ie.StringHelper.compare(e.name,t.name)},ie.entity.DomainForSort.prototype={__class__:ie.entity.DomainForSort},ie.entity.DownloadAuth=function(e){null!=e&&(this.fileId=e.file_id,this.url=e.get_url,this.headers=new ie.entity.DownloadAuthHeaders(e.get_headers))},n["albero.entity.DownloadAuth"]=ie.entity.DownloadAuth,ie.entity.DownloadAuth.__name__=["albero","entity","DownloadAuth"],ie.entity.DownloadAuth.prototype={__class__:ie.entity.DownloadAuth},ie.entity.DownloadAuthHeaders=function(e){null!=e&&(this.authorization=e.Authorization,this.xAmzDate=e["x-amz-date"],this.xAmzSecurityToken=e["x-amz-security-token"])},n["albero.entity.DownloadAuthHeaders"]=ie.entity.DownloadAuthHeaders,ie.entity.DownloadAuthHeaders.__name__=["albero","entity","DownloadAuthHeaders"],ie.entity.DownloadAuthHeaders.prototype={__class__:ie.entity.DownloadAuthHeaders},ie.entity.FavoriteTalkEvent=function(e){null!=e&&(this.domainId=e.domain_id,this.talkId=e.talk_id,this.orderInFavorites=e.order_in_favorites,this.favoriteVersion=e.favorite_version)},n["albero.entity.FavoriteTalkEvent"]=ie.entity.FavoriteTalkEvent,ie.entity.FavoriteTalkEvent.__name__=["albero","entity","FavoriteTalkEvent"],ie.entity.FavoriteTalkEvent.prototype={__class__:ie.entity.FavoriteTalkEvent},ie.entity.FileInfo=function(e){this.thumbnailDimension=oe.ds.Option.None,null!=e&&(this.attachmentId=e.attachment_id,this.messageId=e.message_id,this.talkId=e.talk_id,this.id=e.file_id,this.userId=e.user_id,this.name=e.name,this.contentType=e.content_type,this.contentSize=e.content_size,this.url=e.url,this.thumbUrl=e.thumbnail_url,this.updatedAt=e.updated_at,this.file=e.file,this.thumbFile=e.thumbnail_file,this.thumbnailDimension=oe.ds.Option.None,null!=e.deleted?this.deleted=e.deleted:this.deleted=!1)},n["albero.entity.FileInfo"]=ie.entity.FileInfo,ie.entity.FileInfo.__name__=["albero","entity","FileInfo"],ie.entity.FileInfo.fromMessageAndFile=function(e,t){var n=new ie.entity.FileInfo;return n.messageId=e.id,n.talkId=e.talkId,n.userId=e.userId,n.updatedAt=e.createdAt,n.id=t.file_id,n.name=t.name,n.contentType=t.content_type,n.contentSize=t.content_size,n.url=t.url,n.thumbUrl=t.thumbnail_url,null==t.thumbnail_dimension?n.thumbnailDimension=oe.ds.Option.None:n.thumbnailDimension=oe.ds.Option.Some(new ie.entity.ThumbDimension(t.thumbnail_dimension)),null!=t.deleted?n.deleted=t.deleted:n.deleted=!1,n.file=t.file,n},ie.entity.FileInfo.fromMessageAndFileWithFileId=function(e,t,n){var r=ie.entity.FileInfo.fromMessageAndFile(e,t);return r.id=n,r},ie.entity.FileInfo.prototype={hasThumb:function(){return null!=this.thumbUrl||null!=this.thumbFile},isImage:function(){return ee.startsWith(this.contentType,"image/")},isImageGif:function(){return ee.startsWith(this.contentType,"image/gif")},isPdf:function(){return ee.startsWith(this.contentType,"application/pdf")},isVideo:function(){return ee.startsWith(this.contentType,"video/")},canDisplayAsThumb:function(){return this.hasThumb()||this.isImage()},getNoThumbText:function(){return null!=this.name?this.name:this.url},setDummyThumbnail:function(e){this.thumbFile=e.file,this.thumbnailDimension=oe.ds.Option.Some(e.dimension)},__class__:ie.entity.FileInfo},ie.entity.FileInfoDeletion=function(e){null!=e&&(this.messageId=e[0],this.talkId=e[1],this.fileId=e[2])},n["albero.entity.FileInfoDeletion"]=ie.entity.FileInfoDeletion,ie.entity.FileInfoDeletion.__name__=["albero","entity","FileInfoDeletion"],ie.entity.FileInfoDeletion.prototype={__class__:ie.entity.FileInfoDeletion},ie.entity.HitContext=function(e){null!=e&&(this.talkId=e.talk_id,null!=e.messages&&(this.messages=C.Boot.__cast(e.messages,Array).map(function(e){return new ie.entity.HitMessage(e)})))},n["albero.entity.HitContext"]=ie.entity.HitContext,ie.entity.HitContext.__name__=["albero","entity","HitContext"],ie.entity.HitContext.prototype={findHitMessage:function(t){return ae.find(this.messages,function(e){return ie.Int64Helper.eq(e.id,t)})},__class__:ie.entity.HitContext},ie.entity.HitMessage=function(e){null!=e&&(this.id=e.message_id,this.talkId=e.talk_id,this.userId=e.user_id,this.type=ie.entity.Message.typeOf(e.type),this.content=e.content,this.createdAt=e.created_at,this.hit=e.hit)},n["albero.entity.HitMessage"]=ie.entity.HitMessage,ie.entity.HitMessage.__name__=["albero","entity","HitMessage"],ie.entity.HitMessage.prototype={__class__:ie.entity.HitMessage},ie.entity.LocalErrorType=n["albero.entity.LocalErrorType"]={__ename__:["albero","entity","LocalErrorType"],__constructs__:["TalksCountOvered","TalkersCountOvered","SendingMessageConflicted","DeletingMessageConflicted","UploadSizeOvered","StorageSizeOvered"]},ie.entity.LocalErrorType.TalksCountOvered=function(e){var t=["TalksCountOvered",0,e];return t.__enum__=ie.entity.LocalErrorType,t.toString=s,t},ie.entity.LocalErrorType.TalkersCountOvered=function(e){var t=["TalkersCountOvered",1,e];return t.__enum__=ie.entity.LocalErrorType,t.toString=s,t},ie.entity.LocalErrorType.SendingMessageConflicted=["SendingMessageConflicted",2],ie.entity.LocalErrorType.SendingMessageConflicted.toString=s,ie.entity.LocalErrorType.SendingMessageConflicted.__enum__=ie.entity.LocalErrorType,ie.entity.LocalErrorType.DeletingMessageConflicted=["DeletingMessageConflicted",3],ie.entity.LocalErrorType.DeletingMessageConflicted.toString=s,ie.entity.LocalErrorType.DeletingMessageConflicted.__enum__=ie.entity.LocalErrorType,ie.entity.LocalErrorType.UploadSizeOvered=function(e){var t=["UploadSizeOvered",4,e];return t.__enum__=ie.entity.LocalErrorType,t.toString=s,t},ie.entity.LocalErrorType.StorageSizeOvered=function(e){var t=["StorageSizeOvered",5,e];return t.__enum__=ie.entity.LocalErrorType,t.toString=s,t},ie.entity.LocalErrorType.__empty_constructs__=[ie.entity.LocalErrorType.SendingMessageConflicted,ie.entity.LocalErrorType.DeletingMessageConflicted],ie.entity.LocalErrorTypeMixin=function(){},n["albero.entity.LocalErrorTypeMixin"]=ie.entity.LocalErrorTypeMixin,ie.entity.LocalErrorTypeMixin.__name__=["albero","entity","LocalErrorTypeMixin"],ie.entity.LocalErrorTypeMixin.toMessage=function(e){switch(e[1]){case 0:var t=e[2];return oe.ds.Option.Some(ie.js.Localizer.localize("LocalErrorType.number_of_talks",{limitMax:t}));case 1:var n=e[2];return oe.ds.Option.Some(ie.js.Localizer.localize("LocalErrorType.number_of_talkers",{limitMax:n}));case 2:return oe.ds.Option.Some(ie.js.Localizer.localize("LocalErrorType.retry_sending"));case 3:return oe.ds.Option.Some(ie.js.Localizer.localize("LocalErrorType.retry_deletion"));case 4:var r=e[2],a=ie.FileHelper.createByteSizeStringWithUnit(r);return oe.ds.Option.Some(ie.js.Localizer.localize("LocalErrorType.file_size",{sizeString:a}));case 5:var i=e[2],o=ie.FileHelper.createByteSizeStringWithUnit(i);return oe.ds.Option.Some(ie.js.Localizer.localize("LocalErrorType.storage_size",{sizeString:o}))}},ie.entity.Me=function(e){ie.entity.User.call(this,e),null!=e&&(this.email=e.email,this.signinId=e.signin_id,null!=e.profiles&&(this.profiles=C.Boot.__cast(e.profiles,Array).map(function(e){return new ie.entity.Profile(e)})),null!=e.departments&&(this.departments=C.Boot.__cast(e.departments,Array).map(function(e){return new ie.entity.DomainDepartmentPath(e)})))},n["albero.entity.Me"]=ie.entity.Me,ie.entity.Me.__name__=["albero","entity","Me"],ie.entity.Me.__super__=ie.entity.User,ie.entity.Me.prototype=t(ie.entity.User.prototype,{toDomainUser:function(e){var t=new ie.entity.DomainUser;if(t.id=this.id,t.status=this.status,t.domainId=e,t.displayName=this.displayName,t.canonicalDisplayName=this.canonicalDisplayName,t.phoneticDisplayName=this.phoneticDisplayName,t.canonicalPhoneticDisplayName=this.canonicalPhoneticDisplayName,t.profileImageUrl=this.profileImageUrl,t.updatedAt=this.updatedAt,t.email=this.email,null!=this.profiles)for(var n=0,r=this.profiles;n<r.length;){var a=r[n];if(++n,ie.Int64Helper.eq(a.domainId,e)){t.profileContact=a.itemValues;break}}if(null!=this.departments)for(var i=0,o=this.departments;i<o.length;){var s=o[i];if(++i,ie.Int64Helper.eq(s.domainId,e)){t.departments=s.departments;break}}return t},__class__:ie.entity.Me}),ie.entity.Message=function(e){null!=e&&(this.id=e.message_id,this.talkId=e.talk_id,this.userId=e.user_id,this.type=ie.entity.Message.typeOf(e.type),this.content=e.content,this.createdAt=e.created_at,this.readCount=e.read_count,this.readUserIds=e.read_user_ids,null==e.is_unread_count_target?this.isUnreadCountTarget=!0:this.isUnreadCountTarget=e.is_unread_count_target,null==e.bot_message?this.isBotMessage=!1:this.isBotMessage=e.bot_message)},n["albero.entity.Message"]=ie.entity.Message,ie.entity.Message.__name__=["albero","entity","Message"],ie.entity.Message.typeOf=function(e){switch(e){case 0:return ie.entity.MessageType.system;case 1:return ie.entity.MessageType.text;case 2:return ie.entity.MessageType.stamp;case 3:return ie.entity.MessageType.geo;case 4:return ie.entity.MessageType.file;case 5:return ie.entity.MessageType.textMultipleFile;case 7:return ie.entity.MessageType.deleted;case 500:return ie.entity.MessageType.yesOrNo;case 501:return ie.entity.MessageType.yesOrNoReply;case 502:return ie.entity.MessageType.selectOne;case 503:return ie.entity.MessageType.selectOneReply;case 504:return ie.entity.MessageType.todo;case 505:return ie.entity.MessageType.todoDone;case 506:return ie.entity.MessageType.yesOrNoClosed;case 507:return ie.entity.MessageType.selectOneClosed;case 508:return ie.entity.MessageType.todoClosed;case 600:return ie.entity.MessageType.phoneCall;case 601:return ie.entity.MessageType.phoneReceive;default:return ie.entity.MessageType.unknown}},ie.entity.Message.enumIndex=function(e){switch(e[1]){case 0:case 1:case 2:case 3:case 4:case 5:case 6:return e[1];case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return 500+e[1]-7;case 16:case 17:return 600+e[1]-16;default:return-1}},ie.entity.Message.typeString=function(e){return Z.string(e)},ie.entity.Message.prototype={getFilesDynamic:function(){switch(this.type[1]){case 4:return[this.content];case 5:return this.content.files;default:return[]}},isDummy:function(){return null!=this.id&&this.id.high<0},__class__:ie.entity.Message},ie.entity.MessageType=n["albero.entity.MessageType"]={__ename__:["albero","entity","MessageType"],__constructs__:["system","text","stamp","geo","file","textMultipleFile","deleted","yesOrNo","yesOrNoReply","selectOne","selectOneReply","todo","todoDone","yesOrNoClosed","selectOneClosed","todoClosed","phoneCall","phoneReceive","unknown"]},ie.entity.MessageType.system=["system",0],ie.entity.MessageType.system.toString=s,ie.entity.MessageType.system.__enum__=ie.entity.MessageType,ie.entity.MessageType.text=["text",1],ie.entity.MessageType.text.toString=s,ie.entity.MessageType.text.__enum__=ie.entity.MessageType,ie.entity.MessageType.stamp=["stamp",2],ie.entity.MessageType.stamp.toString=s,ie.entity.MessageType.stamp.__enum__=ie.entity.MessageType,ie.entity.MessageType.geo=["geo",3],ie.entity.MessageType.geo.toString=s,ie.entity.MessageType.geo.__enum__=ie.entity.MessageType,ie.entity.MessageType.file=["file",4],ie.entity.MessageType.file.toString=s,ie.entity.MessageType.file.__enum__=ie.entity.MessageType,ie.entity.MessageType.textMultipleFile=["textMultipleFile",5],ie.entity.MessageType.textMultipleFile.toString=s,ie.entity.MessageType.textMultipleFile.__enum__=ie.entity.MessageType,ie.entity.MessageType.deleted=["deleted",6],ie.entity.MessageType.deleted.toString=s,ie.entity.MessageType.deleted.__enum__=ie.entity.MessageType,ie.entity.MessageType.yesOrNo=["yesOrNo",7],ie.entity.MessageType.yesOrNo.toString=s,ie.entity.MessageType.yesOrNo.__enum__=ie.entity.MessageType,ie.entity.MessageType.yesOrNoReply=["yesOrNoReply",8],ie.entity.MessageType.yesOrNoReply.toString=s,ie.entity.MessageType.yesOrNoReply.__enum__=ie.entity.MessageType,ie.entity.MessageType.selectOne=["selectOne",9],ie.entity.MessageType.selectOne.toString=s,ie.entity.MessageType.selectOne.__enum__=ie.entity.MessageType,ie.entity.MessageType.selectOneReply=["selectOneReply",10],ie.entity.MessageType.selectOneReply.toString=s,ie.entity.MessageType.selectOneReply.__enum__=ie.entity.MessageType,ie.entity.MessageType.todo=["todo",11],ie.entity.MessageType.todo.toString=s,ie.entity.MessageType.todo.__enum__=ie.entity.MessageType,ie.entity.MessageType.todoDone=["todoDone",12],ie.entity.MessageType.todoDone.toString=s,ie.entity.MessageType.todoDone.__enum__=ie.entity.MessageType,ie.entity.MessageType.yesOrNoClosed=["yesOrNoClosed",13],ie.entity.MessageType.yesOrNoClosed.toString=s,ie.entity.MessageType.yesOrNoClosed.__enum__=ie.entity.MessageType,ie.entity.MessageType.selectOneClosed=["selectOneClosed",14],ie.entity.MessageType.selectOneClosed.toString=s,ie.entity.MessageType.selectOneClosed.__enum__=ie.entity.MessageType,ie.entity.MessageType.todoClosed=["todoClosed",15],ie.entity.MessageType.todoClosed.toString=s,ie.entity.MessageType.todoClosed.__enum__=ie.entity.MessageType,ie.entity.MessageType.phoneCall=["phoneCall",16],ie.entity.MessageType.phoneCall.toString=s,ie.entity.MessageType.phoneCall.__enum__=ie.entity.MessageType,ie.entity.MessageType.phoneReceive=["phoneReceive",17],ie.entity.MessageType.phoneReceive.toString=s,ie.entity.MessageType.phoneReceive.__enum__=ie.entity.MessageType,ie.entity.MessageType.unknown=["unknown",18],ie.entity.MessageType.unknown.toString=s,ie.entity.MessageType.unknown.__enum__=ie.entity.MessageType,ie.entity.MessageType.__empty_constructs__=[ie.entity.MessageType.system,ie.entity.MessageType.text,ie.entity.MessageType.stamp,ie.entity.MessageType.geo,ie.entity.MessageType.file,ie.entity.MessageType.textMultipleFile,ie.entity.MessageType.deleted,ie.entity.MessageType.yesOrNo,ie.entity.MessageType.yesOrNoReply,ie.entity.MessageType.selectOne,ie.entity.MessageType.selectOneReply,ie.entity.MessageType.todo,ie.entity.MessageType.todoDone,ie.entity.MessageType.yesOrNoClosed,ie.entity.MessageType.selectOneClosed,ie.entity.MessageType.todoClosed,ie.entity.MessageType.phoneCall,ie.entity.MessageType.phoneReceive,ie.entity.MessageType.unknown],ie.entity.MessageDeletion=function(e){null!=e&&(this.talkId=e[0],this.messageId=e[1])},n["albero.entity.MessageDeletion"]=ie.entity.MessageDeletion,ie.entity.MessageDeletion.__name__=["albero","entity","MessageDeletion"],ie.entity.MessageDeletion.prototype={__class__:ie.entity.MessageDeletion},ie.entity.MessageReadStatus=function(e){null!=e&&(this.id=e.message_id,this.talkId=e.talk_id,this.readUserIds=e.read_user_ids,this.unreadUserIds=e.unread_user_ids)},n["albero.entity.MessageReadStatus"]=ie.entity.MessageReadStatus,ie.entity.MessageReadStatus.__name__=["albero","entity","MessageReadStatus"],ie.entity.MessageReadStatus.prototype={__class__:ie.entity.MessageReadStatus},ie.entity.MessageReadStatusesUpdate=function(e){null!=e&&(this.talkId=e.talk_id,this.messageIds=e.message_ids,this.readUserIds=e.read_user_ids,this.messageIdsExcludingUnreadCountTargets=e.message_ids_excluding_unread_count_targets,null==this.messageIdsExcludingUnreadCountTargets&&(this.messageIdsExcludingUnreadCountTargets=new Array))},n["albero.entity.MessageReadStatusesUpdate"]=ie.entity.MessageReadStatusesUpdate,ie.entity.MessageReadStatusesUpdate.__name__=["albero","entity","MessageReadStatusesUpdate"],ie.entity.MessageReadStatusesUpdate.prototype={__class__:ie.entity.MessageReadStatusesUpdate},ie.entity.MessagesOrder=n["albero.entity.MessagesOrder"]={__ename__:["albero","entity","MessagesOrder"],__constructs__:["asc","desc"]},ie.entity.MessagesOrder.asc=["asc",0],ie.entity.MessagesOrder.asc.toString=s,ie.entity.MessagesOrder.asc.__enum__=ie.entity.MessagesOrder,ie.entity.MessagesOrder.desc=["desc",1],ie.entity.MessagesOrder.desc.toString=s,ie.entity.MessagesOrder.desc.__enum__=ie.entity.MessagesOrder,ie.entity.MessagesOrder.__empty_constructs__=[ie.entity.MessagesOrder.asc,ie.entity.MessagesOrder.desc],ie.entity.MessagesOrderProc=function(){},n["albero.entity.MessagesOrderProc"]=ie.entity.MessagesOrderProc,ie.entity.MessagesOrderProc.__name__=["albero","entity","MessagesOrderProc"],ie.entity.MessagesOrderProc.orderToInt=function(e){switch(e[1]){case 0:return 1;case 1:return 2}},ie.entity.PasswordExpiration=function(e){null!=e&&(this.expiration=e.expiration,this.warning=e.warning)},n["albero.entity.PasswordExpiration"]=ie.entity.PasswordExpiration,ie.entity.PasswordExpiration.__name__=["albero","entity","PasswordExpiration"],ie.entity.PasswordExpiration.prototype={isExpired:function(e){return this.timeOvered(this.expiration,e)},needWarning:function(e,t){return this.timeOveredOrNotExist(t,e)&&this.timeOvered(this.warning,e)},timeOvered:function(e,t){return null!=e&&0<oe.Int64.compare(t,e)},timeOveredOrNotExist:function(e,t){return null==e||this.timeOvered(e,t)},__class__:ie.entity.PasswordExpiration},ie.entity.Plan=function(e){null!=e&&(this.name=e.plan_name,this.trial=e.trial)},n["albero.entity.Plan"]=ie.entity.Plan,ie.entity.Plan.__name__=["albero","entity","Plan"],ie.entity.Plan.prototype={__class__:ie.entity.Plan},ie.entity.Profile=function(e){null!=e&&(this.domainId=e.domain_id,this.userId=e.user_id,(this.itemValues=null)!=e.item_values&&(this.itemValues=C.Boot.__cast(e.item_values,Array).map(function(e){return new ie.entity.ProfileItemValue(e)})))},n["albero.entity.Profile"]=ie.entity.Profile,ie.entity.Profile.__name__=["albero","entity","Profile"],ie.entity.Profile.prototype={__class__:ie.entity.Profile},ie.entity.ProfileDefinition=function(e){if(null!=e&&(this.domainId=e.domain_id,null!=e.item_definitions)){this.itemDefinitions=new Array;var t,n=0;for(t=C.Boot.__cast(e.item_definitions,Array);n<t.length;){var r=t[n];++n,this.itemDefinitions.push(new ie.entity.ProfileItemDefinition(r))}}},n["albero.entity.ProfileDefinition"]=ie.entity.ProfileDefinition,ie.entity.ProfileDefinition.__name__=["albero","entity","ProfileDefinition"],ie.entity.ProfileDefinition.isSameProfileItemDefinitions=function(e,t){if(t.length!=e.length)return!1;for(var n=0,r=t.length;n<r;){var a=n++;if(t[a].profileItemId!=e[a].profileItemId)return!1}return!0},ie.entity.ProfileDefinition.prototype={getVisibleItemDefinitions:function(t,n){return null==n&&(n=!1),null==t&&(t=!1),null==this.itemDefinitions?[]:this.itemDefinitions.filter(function(e){return!!e.visible&&(!(!t&&10!=e.group)&&(!n||1!=e.profileItemId&&2!=e.profileItemId))})},__class__:ie.entity.ProfileDefinition},ie.entity.ProfileItemDefinition=function(e){this.locked=!1,this.visible=!0,null!=e&&(this.profileItemId=e.profile_item_id,this.group=e.group,this.name=e.name,this.valueType=e.value_type,null!=e.visible&&(this.visible=e.visible),null!=e.locked&&(this.locked=e.locked))},n["albero.entity.ProfileItemDefinition"]=ie.entity.ProfileItemDefinition,ie.entity.ProfileItemDefinition.__name__=["albero","entity","ProfileItemDefinition"],ie.entity.ProfileItemDefinition.findById=function(e,t){for(var n=0;n<e.length;){var r=e[n];if(++n,r.profileItemId==t)return r}return null},ie.entity.ProfileItemDefinition.prototype={__class__:ie.entity.ProfileItemDefinition},ie.entity.ProfileItemValue=function(e){null!=e&&(this.profileItemId=e.profile_item_id,this.value=e.value,this.canonicalValue=e.canonical_value)},n["albero.entity.ProfileItemValue"]=ie.entity.ProfileItemValue,ie.entity.ProfileItemValue.__name__=["albero","entity","ProfileItemValue"],ie.entity.ProfileItemValue.findById=function(e,t){for(var n=0;n<e.length;){var r=e[n];if(++n,r.profileItemId==t)return r}return null},ie.entity.ProfileItemValue.prototype={__class__:ie.entity.ProfileItemValue},ie.entity.ProfileItemValuesPerDomain=function(e,t){this.domainId=e,this.profileItemValues=t},n["albero.entity.ProfileItemValuesPerDomain"]=ie.entity.ProfileItemValuesPerDomain,ie.entity.ProfileItemValuesPerDomain.__name__=["albero","entity","ProfileItemValuesPerDomain"],ie.entity.ProfileItemValuesPerDomain.convertToApiParams=function(e){return e.map(function(e){return e.convertToApiParamsPerDomain()})},ie.entity.ProfileItemValuesPerDomain.prototype={convertToApiParamsPerDomain:function(){return[this.domainId,this.profileItemValues.map(function(e){return{profile_item_id:e.profileItemId,value:e.value}})]},__class__:ie.entity.ProfileItemValuesPerDomain},ie.entity.PushNotificationSetting=function(e){if(null==e)return this.enabled=!0,void(this.version=0);null==e.enabled?this.enabled=!0:this.enabled=e.enabled,this.version=e.version},n["albero.entity.PushNotificationSetting"]=ie.entity.PushNotificationSetting,ie.entity.PushNotificationSetting.__name__=["albero","entity","PushNotificationSetting"],ie.entity.PushNotificationSetting.createWithParams=function(e,t){var n=new ie.entity.PushNotificationSetting;return n.enabled=e,n.version=t,n},ie.entity.PushNotificationSetting.prototype={__class__:ie.entity.PushNotificationSetting},ie.entity.Question=function(e){null!=e&&(this.id=e.message_id,this.talkId=e.talk_id,this.type=ie.entity.Message.typeOf(e.type),this.content=e.content,this.userId=e.user_id,this.recipientIds=e.assigned_user_ids,this.responses=ie.entity.Question.createResponses(e.responses),this.listing=e.listing,this.closingType=ie.entity.Question.closeingTypeOf(e.closing_type),this.maxResponseId=e.max_response_id,this.lastResponse=e.last_response,this.lastResponseUserId=e.last_response_user_id,this.createdAt=e.created_at,this.updatedAt=e.updated_at,this.responded=e.responded,this.closed=e.closed)},n["albero.entity.Question"]=ie.entity.Question,ie.entity.Question.__name__=["albero","entity","Question"],ie.entity.Question.createResponses=function(e){return(n=ie.OptionHelper.option(e),function(e){var t;switch(n[1]){case 0:t=n[2];break;case 1:t=[]}return t}()).map(function(e){return new ie.entity.QuestionResponse(e)});var n},ie.entity.Question.createResponsesFromStrings=function(e){return(n=ie.OptionHelper.option(e),function(e){var t;switch(n[1]){case 0:t=n[2];break;case 1:t=[]}return t}()).map(function(e){var t=new ie.entity.QuestionResponse;return t.content=e,t});var n},ie.entity.Question.closeingTypeOf=function(e){switch(e){case 0:return ie.entity.QuestionClosingType.any;case 1:return ie.entity.QuestionClosingType.all;default:return ie.entity.QuestionClosingType.unknown}},ie.entity.Question.createResponseTexts=function(e,t){switch(e[1]){case 7:return["YES","NO"];case 9:return t;case 11:return["DONE","UNDONE"];default:return[]}},ie.entity.Question.fromMessageAndTalk=function(e,t){var n=new ie.entity.Question;n.id=e.id,n.talkId=e.talkId,n.type=e.type;var r=ie.OptionHelper.option(e.content.title);switch(r[1]){case 0:var a=r[2];n.content=a;break;case 1:n.content=e.content.question}n.userId=e.userId,n.recipientIds=t.userIds,n.responses=ie.entity.Question.createResponsesFromStrings(ie.entity.Question.createResponseTexts(e.type,e.content.options));var i=ie.OptionHelper.option(e.content.listing);switch(i[1]){case 0:var o=i[2];n.listing=o;break;case 1:n.listing=!0}n.closingType=ie.entity.Question.closeingTypeOf(e.content.closing_type),n.maxResponseId=null,n.lastResponse=null,n.lastResponseUserId=null,n.updatedAt=n.createdAt=e.createdAt,n.responded=!1;var s=ie.OptionHelper.option(e.content.closed);switch(s[1]){case 0:var l=s[2];n.closed=l;break;case 1:n.closed=!1}return n},ie.entity.Question.createTodoDoneMessageWithParams=function(e,t,n){var r=new ie.entity.Message;return r.talkId=e,r.type=ie.entity.MessageType.todoDone,r.content={in_reply_to:t,done:n},r},ie.entity.Question.createYesOrNoReplyMessageWithParams=function(e,t,n){var r=new ie.entity.Message;return r.talkId=e,r.content={in_reply_to:t,response:n},r.type=ie.entity.MessageType.yesOrNoReply,r},ie.entity.Question.createSelectOneReplyMessageWithParams=function(e,t,n){var r=new ie.entity.Message;return r.talkId=e,r.content={in_reply_to:t,response:n},r.type=ie.entity.MessageType.selectOneReply,r},ie.entity.Question.fromTypeToInt=function(e){switch(e[1]){case 0:return 0;case 1:return 1}},ie.entity.Question.filterToOpBool=function(e){switch(e[1]){case 0:return oe.ds.Option.Some(!0);case 1:return oe.ds.Option.Some(!1);case 2:return oe.ds.Option.None}},ie.entity.Question.isDoneResponse=function(e){return"DONE"==e.content},ie.entity.Question.prototype={isCompleted:function(e){if(te.enumEq(this.type,ie.entity.MessageType.todo)){if(te.enumEq(this.closingType,ie.entity.QuestionClosingType.any)){if(null!=this.lastResponse&&"DONE"==this.responses[this.lastResponse].content)return!0}else{if(!this.responded)return!1;for(var t=0,n=this.responses;t<n.length;){var r=n[t];if(++t,ie.Int64Helper.contains(r.userIds,e))return"DONE"==r.content}}return!1}return te.enumEq(this.closingType,ie.entity.QuestionClosingType.any)?null!=this.lastResponse:this.responded},createTodoDoneMessage:function(e){return ie.entity.Question.createTodoDoneMessageWithParams(this.talkId,this.id,e)},createYesOrNoReplyMessage:function(e){return ie.entity.Question.createYesOrNoReplyMessageWithParams(this.talkId,this.id,e)},createSelectOneReplyMessage:function(e){return ie.entity.Question.createSelectOneReplyMessageWithParams(this.talkId,this.id,e)},createActionCloseMessage:function(){var e=new ie.entity.Message;switch(e.talkId=this.talkId,e.content={in_reply_to:this.id},this.type[1]){case 7:e.type=ie.entity.MessageType.yesOrNoClosed;break;case 9:e.type=ie.entity.MessageType.selectOneClosed;break;case 11:e.type=ie.entity.MessageType.todoClosed;break;default:se._e(se.dateStr(),"message type is not action.","","","","")}return e},getLastResponse:function(){var t=this;return ie.OptionHelper.map(ie.OptionHelper.option(this.lastResponse),function(e){return t.responses[e]})},getLastDoneResponse:function(){return ie.OptionHelper.filter(this.getLastResponse(),ie.entity.Question.isDoneResponse)},getDoneResponse:function(){return ie.OptionHelper.option(ae.find(this.responses,ie.entity.Question.isDoneResponse))},__class__:ie.entity.Question},ie.entity.QuestionResponse=function(e){null!=e&&(this.content=e.content,this.count=e.count,this.userIds=e.user_ids)},n["albero.entity.QuestionResponse"]=ie.entity.QuestionResponse,ie.entity.QuestionResponse.__name__=["albero","entity","QuestionResponse"],ie.entity.QuestionResponse.prototype={__class__:ie.entity.QuestionResponse},ie.entity.QuestionClosingType=n["albero.entity.QuestionClosingType"]={__ename__:["albero","entity","QuestionClosingType"],__constructs__:["any","all","unknown"]},ie.entity.QuestionClosingType.any=["any",0],ie.entity.QuestionClosingType.any.toString=s,ie.entity.QuestionClosingType.any.__enum__=ie.entity.QuestionClosingType,ie.entity.QuestionClosingType.all=["all",1],ie.entity.QuestionClosingType.all.toString=s,ie.entity.QuestionClosingType.all.__enum__=ie.entity.QuestionClosingType,ie.entity.QuestionClosingType.unknown=["unknown",2],ie.entity.QuestionClosingType.unknown.toString=s,ie.entity.QuestionClosingType.unknown.__enum__=ie.entity.QuestionClosingType,ie.entity.QuestionClosingType.__empty_constructs__=[ie.entity.QuestionClosingType.any,ie.entity.QuestionClosingType.all,ie.entity.QuestionClosingType.unknown],ie.entity.QuestionFromType=n["albero.entity.QuestionFromType"]={__ename__:["albero","entity","QuestionFromType"],__constructs__:["fromSelf","fromOther"]},ie.entity.QuestionFromType.fromSelf=["fromSelf",0],ie.entity.QuestionFromType.fromSelf.toString=s,ie.entity.QuestionFromType.fromSelf.__enum__=ie.entity.QuestionFromType,ie.entity.QuestionFromType.fromOther=["fromOther",1],ie.entity.QuestionFromType.fromOther.toString=s,ie.entity.QuestionFromType.fromOther.__enum__=ie.entity.QuestionFromType,ie.entity.QuestionFromType.__empty_constructs__=[ie.entity.QuestionFromType.fromSelf,ie.entity.QuestionFromType.fromOther],ie.entity.QuestionFilter=n["albero.entity.QuestionFilter"]={__ename__:["albero","entity","QuestionFilter"],__constructs__:["onlyClosed","onlyUnclosed","noFilter"]},ie.entity.QuestionFilter.onlyClosed=["onlyClosed",0],ie.entity.QuestionFilter.onlyClosed.toString=s,ie.entity.QuestionFilter.onlyClosed.__enum__=ie.entity.QuestionFilter,ie.entity.QuestionFilter.onlyUnclosed=["onlyUnclosed",1],ie.entity.QuestionFilter.onlyUnclosed.toString=s,ie.entity.QuestionFilter.onlyUnclosed.__enum__=ie.entity.QuestionFilter,ie.entity.QuestionFilter.noFilter=["noFilter",2],ie.entity.QuestionFilter.noFilter.toString=s,ie.entity.QuestionFilter.noFilter.__enum__=ie.entity.QuestionFilter,ie.entity.QuestionFilter.__empty_constructs__=[ie.entity.QuestionFilter.onlyClosed,ie.entity.QuestionFilter.onlyUnclosed,ie.entity.QuestionFilter.noFilter],ie.entity.Quota=function(e){null!=e&&(this.msgRetentionPeriod=e.msg_retention_period,this.msgFileSize=e.msg_file_size,this.maxMessageContentLength=e.max_message_content_length,this.maxTalkers=e.max_talkers,this.maxTalks=e.max_talks)},n["albero.entity.Quota"]=ie.entity.Quota,ie.entity.Quota.__name__=["albero","entity","Quota"],ie.entity.Quota.prototype={__class__:ie.entity.Quota},ie.entity.SearchAttachmentsResult=function(e){if(null!=e&&(this.total=e.total,this.marker=e.marker,this.nextMarker=e.next_marker,this.contents=new Array,null!=e.contents)){var t,n=0;for(t=C.Boot.__cast(e.contents,Array);n<t.length;){var r=t[n];++n,this.contents.push(new ie.entity.FileInfo(r))}}},n["albero.entity.SearchAttachmentsResult"]=ie.entity.SearchAttachmentsResult,ie.entity.SearchAttachmentsResult.__name__=["albero","entity","SearchAttachmentsResult"],ie.entity.SearchAttachmentsResult.prototype={__class__:ie.entity.SearchAttachmentsResult},ie.entity.SearchMessagesResult=function(e){null!=e&&(this.total=e.total,this.marker=e.marker,this.nextMarker=e.next_marker,this.contents=new Array,null!=e.contents&&(this.contents=C.Boot.__cast(e.contents,Array).map(function(e){return new ie.entity.HitContext(e)})))},n["albero.entity.SearchMessagesResult"]=ie.entity.SearchMessagesResult,ie.entity.SearchMessagesResult.__name__=["albero","entity","SearchMessagesResult"],ie.entity.SearchMessagesResult.prototype={__class__:ie.entity.SearchMessagesResult},ie.entity.SearchParams=function(e){null!=e&&(null!=e.domain_id_str&&(this.domainId=ie.Int64Helper.makeFromIdStr(e.domain_id_str)),null!=e.talk_id_str&&(this.talkId=ie.Int64Helper.makeFromIdStr(e.talk_id_str)),this.keyword=e.keyword,null==e.search_type||e.search_type==ie.entity.SearchTypeUtil.toLocalizeText(ie.entity.SearchType.MESSAGES)?this.searchType=ie.entity.SearchType.MESSAGES:this.searchType=ie.entity.SearchType.ATTACHMENTS,this.sinceText=e.since,this.untilText=e.until,null!=e.from_id_str&&(this.fromUserId=ie.Int64Helper.makeFromIdStr(e.from_id_str)))},n["albero.entity.SearchParams"]=ie.entity.SearchParams,ie.entity.SearchParams.__name__=["albero","entity","SearchParams"],ie.entity.SearchParams.dateQueryToText=function(e,t){if(null==e)return t;switch(e){case"t":return ie.js.Localizer.localize("SearchParams.text_date_today");case"-1d":return ie.js.Localizer.localize("SearchParams.text_date_yesterday");case"-3d":return ie.js.Localizer.localize("SearchParams.text_date_three_days_before");default:return ee.replace(e,"-","/")}},ie.entity.SearchParams.prototype={toProps:function(){var e={};return null!=this.domainId&&(e.domain_id_str=ie.Int64Helper.idStr(this.domainId)),null!=this.talkId&&(e.talk_id_str=ie.Int64Helper.idStr(this.talkId)),e.keyword=this.keyword,e.search_type=ie.entity.SearchTypeUtil.toLocalizeText(this.searchType),e.since=this.sinceText,e.until=this.untilText,null!=this.fromUserId&&(e.from_id_str=ie.Int64Helper.idStr(this.fromUserId)),e},copy:function(){return new ie.entity.SearchParams(this.toProps())},eq:function(e){return!(this.domainId!=e.domainId&&!ie.Int64Helper.eq(this.domainId,e.domainId))&&(!(this.talkId!=e.talkId&&!ie.Int64Helper.eq(this.talkId,e.talkId))&&(this.keyword==e.keyword&&(!!te.enumEq(this.searchType,e.searchType)&&(this.sinceText==e.sinceText&&(this.untilText==e.untilText&&!(this.fromUserId!=e.fromUserId&&!ie.Int64Helper.eq(this.fromUserId,e.fromUserId)))))))},getQueryText:function(){var e=new Array;return null!=this.keyword&&0!=this.keyword.length&&e.push(this.keyword),null!=this.sinceText&&e.push("since:"+this.sinceText),null!=this.untilText&&e.push("until:"+this.untilText),null!=this.fromUserId&&e.push("from:"+this.fromUserId.toString()),e.join(" ")},getPeriodText:function(){return ie.entity.SearchParams.dateQueryToText(this.sinceText,"")+"~"+ie.entity.SearchParams.dateQueryToText(this.untilText,"")},__class__:ie.entity.SearchParams},ie.entity.SearchType=n["albero.entity.SearchType"]={__ename__:["albero","entity","SearchType"],__constructs__:["MESSAGES","ATTACHMENTS"]},ie.entity.SearchType.MESSAGES=["MESSAGES",0],ie.entity.SearchType.MESSAGES.toString=s,ie.entity.SearchType.MESSAGES.__enum__=ie.entity.SearchType,ie.entity.SearchType.ATTACHMENTS=["ATTACHMENTS",1],ie.entity.SearchType.ATTACHMENTS.toString=s,ie.entity.SearchType.ATTACHMENTS.__enum__=ie.entity.SearchType,ie.entity.SearchType.__empty_constructs__=[ie.entity.SearchType.MESSAGES,ie.entity.SearchType.ATTACHMENTS],ie.entity.SearchTypeUtil=function(){},n["albero.entity.SearchTypeUtil"]=ie.entity.SearchTypeUtil,ie.entity.SearchTypeUtil.__name__=["albero","entity","SearchTypeUtil"],ie.entity.SearchTypeUtil.toLocalizeText=function(e){switch(e[1]){case 0:return ie.js.Localizer.localize("SearchParams.text_type_messages");case 1:return ie.js.Localizer.localize("SearchParams.text_type_attachments")}},ie.entity.SearchDate=n["albero.entity.SearchDate"]={__ename__:["albero","entity","SearchDate"],__constructs__:["DATE_NONE","DATE_TODAY","DATE_YESTERDAY","DATE_THREE_DAYS_BEFORE","DATE_CALENDAR"]},ie.entity.SearchDate.DATE_NONE=["DATE_NONE",0],ie.entity.SearchDate.DATE_NONE.toString=s,ie.entity.SearchDate.DATE_NONE.__enum__=ie.entity.SearchDate,ie.entity.SearchDate.DATE_TODAY=["DATE_TODAY",1],ie.entity.SearchDate.DATE_TODAY.toString=s,ie.entity.SearchDate.DATE_TODAY.__enum__=ie.entity.SearchDate,ie.entity.SearchDate.DATE_YESTERDAY=["DATE_YESTERDAY",2],ie.entity.SearchDate.DATE_YESTERDAY.toString=s,ie.entity.SearchDate.DATE_YESTERDAY.__enum__=ie.entity.SearchDate,ie.entity.SearchDate.DATE_THREE_DAYS_BEFORE=["DATE_THREE_DAYS_BEFORE",3],ie.entity.SearchDate.DATE_THREE_DAYS_BEFORE.toString=s,ie.entity.SearchDate.DATE_THREE_DAYS_BEFORE.__enum__=ie.entity.SearchDate,ie.entity.SearchDate.DATE_CALENDAR=["DATE_CALENDAR",4],ie.entity.SearchDate.DATE_CALENDAR.toString=s,ie.entity.SearchDate.DATE_CALENDAR.__enum__=ie.entity.SearchDate,ie.entity.SearchDate.__empty_constructs__=[ie.entity.SearchDate.DATE_NONE,ie.entity.SearchDate.DATE_TODAY,ie.entity.SearchDate.DATE_YESTERDAY,ie.entity.SearchDate.DATE_THREE_DAYS_BEFORE,ie.entity.SearchDate.DATE_CALENDAR],ie.entity.SearchDateUtil=function(){},n["albero.entity.SearchDateUtil"]=ie.entity.SearchDateUtil,ie.entity.SearchDateUtil.__name__=["albero","entity","SearchDateUtil"],ie.entity.SearchDateUtil.createSearchDateArray=function(e){return e?[ie.entity.SearchDate.DATE_TODAY,ie.entity.SearchDate.DATE_YESTERDAY,ie.entity.SearchDate.DATE_THREE_DAYS_BEFORE,ie.entity.SearchDate.DATE_CALENDAR]:[ie.entity.SearchDate.DATE_YESTERDAY,ie.entity.SearchDate.DATE_THREE_DAYS_BEFORE,ie.entity.SearchDate.DATE_CALENDAR]},ie.entity.SearchDateUtil.toLocalizeText=function(e){switch(e[1]){case 0:return ie.js.Localizer.localize("SearchParams.text_date_none");case 1:return ie.js.Localizer.localize("SearchParams.text_date_today");case 2:return ie.js.Localizer.localize("SearchParams.text_date_yesterday");case 3:return ie.js.Localizer.localize("SearchParams.text_date_three_days_before");case 4:return ie.js.Localizer.localize("SearchParams.text_date_calendar")}},ie.entity.Session=function(e){null!=e&&(this.user=new ie.entity.Me(e.user),this.device=e.device,this.notification=e.notification,this.passwordExpiration=new ie.entity.PasswordExpiration(e.password_expiration),this.configuration=new ie.entity.Configuration(e.configuration))},n["albero.entity.Session"]=ie.entity.Session,ie.entity.Session.__name__=["albero","entity","Session"],ie.entity.Session.prototype={__class__:ie.entity.Session},ie.entity.Solution=function(e){null!=e&&(this.solutionId=e.solution_id,this.name=e.name,null!=e.link&&(this.link=new ie.entity.SolutionLink(e.link)),null!=e.plugin&&(this.plugin=new ie.entity.SolutionPlugin(e.plugin)))},n["albero.entity.Solution"]=ie.entity.Solution,ie.entity.Solution.__name__=["albero","entity","Solution"],ie.entity.Solution.getSolutionType=function(e){switch(e){case 1:return ie.entity.SolutionType.PhotoViewTrial;case 2:return ie.entity.SolutionType.PhotoView;case 3:return ie.entity.SolutionType.MultiView;case 4:return ie.entity.SolutionType.KeywordWatching;default:return ie.entity.SolutionType.Unknown}},ie.entity.Solution.prototype={__class__:ie.entity.Solution},ie.entity.SolutionLink=function(e){null!=e&&(this.iconUrl=e.icon_url,this.url=e.url)},n["albero.entity.SolutionLink"]=ie.entity.SolutionLink,ie.entity.SolutionLink.__name__=["albero","entity","SolutionLink"],ie.entity.SolutionLink.prototype={__class__:ie.entity.SolutionLink},ie.entity.SolutionPlugin=function(e){null!=e&&(this.url=e.url,this.loaded=!1)},n["albero.entity.SolutionPlugin"]=ie.entity.SolutionPlugin,ie.entity.SolutionPlugin.__name__=["albero","entity","SolutionPlugin"],ie.entity.SolutionPlugin.prototype={__class__:ie.entity.SolutionPlugin},ie.entity.SolutionType=n["albero.entity.SolutionType"]={__ename__:["albero","entity","SolutionType"],__constructs__:["PhotoViewTrial","PhotoView","MultiView","KeywordWatching","Unknown"]},ie.entity.SolutionType.PhotoViewTrial=["PhotoViewTrial",0],ie.entity.SolutionType.PhotoViewTrial.toString=s,ie.entity.SolutionType.PhotoViewTrial.__enum__=ie.entity.SolutionType,ie.entity.SolutionType.PhotoView=["PhotoView",1],ie.entity.SolutionType.PhotoView.toString=s,ie.entity.SolutionType.PhotoView.__enum__=ie.entity.SolutionType,ie.entity.SolutionType.MultiView=["MultiView",2],ie.entity.SolutionType.MultiView.toString=s,ie.entity.SolutionType.MultiView.__enum__=ie.entity.SolutionType,ie.entity.SolutionType.KeywordWatching=["KeywordWatching",3],ie.entity.SolutionType.KeywordWatching.toString=s,ie.entity.SolutionType.KeywordWatching.__enum__=ie.entity.SolutionType,ie.entity.SolutionType.Unknown=["Unknown",4],ie.entity.SolutionType.Unknown.toString=s,ie.entity.SolutionType.Unknown.__enum__=ie.entity.SolutionType,ie.entity.SolutionType.__empty_constructs__=[ie.entity.SolutionType.PhotoViewTrial,ie.entity.SolutionType.PhotoView,ie.entity.SolutionType.MultiView,ie.entity.SolutionType.KeywordWatching,ie.entity.SolutionType.Unknown],ie.entity.StampSet=function(){},n["albero.entity.StampSet"]=ie.entity.StampSet,ie.entity.StampSet.__name__=["albero","entity","StampSet"],ie.entity.StampSet.prototype={__class__:ie.entity.StampSet},ie.entity.Talk=function(e){null!=e&&(this.id=e.talk_id,this.domainId=e.domain_id,this.type=this.typeOf(e.type),this.name=e.talk_name,this.iconUrl=e.icon_url,this.userIds=e.user_ids,this.updatedAt=e.updated_at,this.leftUsers=this.getUsers(e.left_users),this.groupTalkSettings=this.getGroupTalkSetting(e.settings))},n["albero.entity.Talk"]=ie.entity.Talk,ie.entity.Talk.__name__=["albero","entity","Talk"],ie.entity.Talk.prototype={typeOf:function(e){switch(e){case 1:return ie.entity.TalkType.PairTalk;case 2:return ie.entity.TalkType.GroupTalk;default:return ie.entity.TalkType.Unknown}},getUsers:function(e){return null==e?null:e.map(function(e){return new ie.entity.DomainUser(e)})},getGroupTalkSetting:function(e){return null==e?oe.ds.Option.None:oe.ds.Option.Some(new ie.entity.GroupTalkSettings(e))},isSystemMessageVisibled:function(){var e=ie.OptionHelper.map(this.groupTalkSettings,function(e){return e.systemMessageVisible});switch(e[1]){case 0:return e[2];case 1:return!0}},isAllowDisplayPastMessages:function(){var e=ie.OptionHelper.map(this.groupTalkSettings,function(e){return e.allowDisplayPastMessages});switch(e[1]){case 0:return e[2];case 1:return!1}},__class__:ie.entity.Talk},ie.entity.GroupTalkSettings=function(e){null!=e&&(this.allowDisplayPastMessages=!!e.allow_display_past_messages,null==e.system_message_visible?this.systemMessageVisible=!0:this.systemMessageVisible=e.system_message_visible)},n["albero.entity.GroupTalkSettings"]=ie.entity.GroupTalkSettings,ie.entity.GroupTalkSettings.__name__=["albero","entity","GroupTalkSettings"],ie.entity.GroupTalkSettings.createDefault=function(){var e=new ie.entity.GroupTalkSettings;return e.allowDisplayPastMessages=!0,e.systemMessageVisible=!0,e},ie.entity.GroupTalkSettings.prototype={__class__:ie.entity.GroupTalkSettings},ie.entity.TalkType=n["albero.entity.TalkType"]={__ename__:["albero","entity","TalkType"],__constructs__:["Unknown","PairTalk","GroupTalk"]},ie.entity.TalkType.Unknown=["Unknown",0],ie.entity.TalkType.Unknown.toString=s,ie.entity.TalkType.Unknown.__enum__=ie.entity.TalkType,ie.entity.TalkType.PairTalk=["PairTalk",1],ie.entity.TalkType.PairTalk.toString=s,ie.entity.TalkType.PairTalk.__enum__=ie.entity.TalkType,ie.entity.TalkType.GroupTalk=["GroupTalk",2],ie.entity.TalkType.GroupTalk.toString=s,ie.entity.TalkType.GroupTalk.__enum__=ie.entity.TalkType,ie.entity.TalkType.__empty_constructs__=[ie.entity.TalkType.Unknown,ie.entity.TalkType.PairTalk,ie.entity.TalkType.GroupTalk],ie.entity.TalkPack=function(e,t){this.talk=e,this.status=t},n["albero.entity.TalkPack"]=ie.entity.TalkPack,ie.entity.TalkPack.__name__=["albero","entity","TalkPack"],ie.entity.TalkPack.compareTalkOrderingTimestamp=function(e,t){var n=e.getTalkOrderingTimestamp(),r=t.getTalkOrderingTimestamp();return oe.Int64.compare(n,r)},ie.entity.TalkPack.compareTalkConsideredFavorite=function(e,t){var n=e.getTalkOrderInFavorites(),r=t.getTalkOrderInFavorites();return null!=n&&null!=r?ie.entity.TalkPack.compareTalkOrderingTimestamp(e,t):null!=n?1:null!=r?-1:ie.entity.TalkPack.compareTalkOrderingTimestamp(e,t)},ie.entity.TalkPack.prototype={getTalkOrderingTimestamp:function(){return null!=this.status&&null!=this.status.talkOrderingTimestamp?this.status.talkOrderingTimestamp:this.talk.updatedAt},getTalkOrderInFavorites:function(){return null!=this.status?this.status.orderInFavorites:null},__class__:ie.entity.TalkPack},ie.entity.TalkPaneSelection=function(e,t){this.paneType=e,this.talkSelection=t},n["albero.entity.TalkPaneSelection"]=ie.entity.TalkPaneSelection,ie.entity.TalkPaneSelection.__name__=["albero","entity","TalkPaneSelection"],ie.entity.TalkPaneSelection.toPanePrefix=function(e){switch(e[1]){case 0:return"";case 1:return"multi1-";case 2:return"multi2-";case 3:return"multi3-"}},ie.entity.TalkPaneSelection.getPaneType=function(e){switch(e){case 0:return ie.entity.PaneType.SingleTalkPane;case 1:return ie.entity.PaneType.MultiTalkPane1;case 2:return ie.entity.PaneType.MultiTalkPane2;case 3:return ie.entity.PaneType.MultiTalkPane3;default:return null}},ie.entity.TalkPaneSelection.getMultiPaneType=function(e){switch(e){case 0:return ie.entity.PaneType.MultiTalkPane1;case 1:return ie.entity.PaneType.MultiTalkPane2;case 2:return ie.entity.PaneType.MultiTalkPane3;default:return ie.entity.PaneType.MultiTalkPane1}},ie.entity.TalkPaneSelection.prototype={__class__:ie.entity.TalkPaneSelection},ie.entity.TalkSelection=n["albero.entity.TalkSelection"]={__ename__:["albero","entity","TalkSelection"],__constructs__:["NotSelected","TalkSelected","AnnouncementsSelected"]},ie.entity.TalkSelection.NotSelected=["NotSelected",0],ie.entity.TalkSelection.NotSelected.toString=s,ie.entity.TalkSelection.NotSelected.__enum__=ie.entity.TalkSelection,ie.entity.TalkSelection.TalkSelected=function(e,t){var n=["TalkSelected",1,e,t];return n.__enum__=ie.entity.TalkSelection,n.toString=s,n},ie.entity.TalkSelection.AnnouncementsSelected=["AnnouncementsSelected",2],ie.entity.TalkSelection.AnnouncementsSelected.toString=s,ie.entity.TalkSelection.AnnouncementsSelected.__enum__=ie.entity.TalkSelection,ie.entity.TalkSelection.__empty_constructs__=[ie.entity.TalkSelection.NotSelected,ie.entity.TalkSelection.AnnouncementsSelected],ie.entity.PaneType=n["albero.entity.PaneType"]={__ename__:["albero","entity","PaneType"],__constructs__:["SingleTalkPane","MultiTalkPane1","MultiTalkPane2","MultiTalkPane3"]},ie.entity.PaneType.SingleTalkPane=["SingleTalkPane",0],ie.entity.PaneType.SingleTalkPane.toString=s,ie.entity.PaneType.SingleTalkPane.__enum__=ie.entity.PaneType,ie.entity.PaneType.MultiTalkPane1=["MultiTalkPane1",1],ie.entity.PaneType.MultiTalkPane1.toString=s,ie.entity.PaneType.MultiTalkPane1.__enum__=ie.entity.PaneType,ie.entity.PaneType.MultiTalkPane2=["MultiTalkPane2",2],ie.entity.PaneType.MultiTalkPane2.toString=s,ie.entity.PaneType.MultiTalkPane2.__enum__=ie.entity.PaneType,ie.entity.PaneType.MultiTalkPane3=["MultiTalkPane3",3],ie.entity.PaneType.MultiTalkPane3.toString=s,ie.entity.PaneType.MultiTalkPane3.__enum__=ie.entity.PaneType,ie.entity.PaneType.__empty_constructs__=[ie.entity.PaneType.SingleTalkPane,ie.entity.PaneType.MultiTalkPane1,ie.entity.PaneType.MultiTalkPane2,ie.entity.PaneType.MultiTalkPane3],ie.entity.TalkPushNotificationEvent=function(e){null!=e&&(this.domainId=e.domain_id,this.talkId=e.talk_id,this.version=e.version)},n["albero.entity.TalkPushNotificationEvent"]=ie.entity.TalkPushNotificationEvent,ie.entity.TalkPushNotificationEvent.__name__=["albero","entity","TalkPushNotificationEvent"],ie.entity.TalkPushNotificationEvent.prototype={__class__:ie.entity.TalkPushNotificationEvent},ie.entity.TalkStatus=function(e){this.unreadCount=0,null!=e&&(this.id=e.talk_id,null!=e.unread_count?this.unreadCount=e.unread_count:this.unreadCount=0,this.maxMessageId=e.max_message_id,null!=e.max_message?this.maxMessage=new ie.entity.Message(e.max_message):this.maxMessage=null,this.maxReadMessageId=e.max_read_message_id,this.maxEveryoneReadMessageId=e.max_everyone_read_message_id,this.talkOrderingTimestamp=e.talk_ordering_timestamp,this.orderInFavorites=e.order_in_favorites,this.favoriteVersion=e.favorite_version,this.pushNotificationSetting=new ie.entity.PushNotificationSetting(e.push_notification))},n["albero.entity.TalkStatus"]=ie.entity.TalkStatus,ie.entity.TalkStatus.__name__=["albero","entity","TalkStatus"],ie.entity.TalkStatus.prototype={update:function(e){var t=this,n=!1;return this.needIdUpdate(this.maxEveryoneReadMessageId,e.maxEveryoneReadMessageId)&&(this.maxEveryoneReadMessageId=e.maxEveryoneReadMessageId,n=!0),ie.OptionHelper.foreach(e.maxReadMessageId,function(e){t.needIdUpdate(t.maxReadMessageId,e)&&(t.maxReadMessageId=e,n=!0)}),n},needIdUpdate:function(e,t){return null!=t&&(null==e||oe.Int64.compare(e,t)<0)},read:function(e,t){this.maxReadMessageId=e,this.unreadCount-=t,this.unreadCount<0&&(this.unreadCount=0)},readAll:function(){this.maxReadMessageId=this.maxMessageId,this.unreadCount=0},__class__:ie.entity.TalkStatus},ie.entity.TalkStatusHelper=function(){},n["albero.entity.TalkStatusHelper"]=ie.entity.TalkStatusHelper,ie.entity.TalkStatusHelper.__name__=["albero","entity","TalkStatusHelper"],ie.entity.TalkStatusHelper.isNotificationDisabled=function(e){return null!=e&&null!=e.pushNotificationSetting&&!e.pushNotificationSetting.enabled},ie.entity.TalkStatusHelper.isFavoriteTalk=function(e){return null!=e&&null!=e.orderInFavorites},ie.entity.TalkStatusHelper.isUnreadMesasgeExisted=function(e){return null!=e&&(null!=e.maxMessage&&ie.entity.TalkStatusHelper.isUnread(e,e.maxMessage.id))},ie.entity.TalkStatusHelper.isUnread=function(e,t){return null==e.maxReadMessageId||oe.Int64.compare(e.maxReadMessageId,t)<0},ie.entity.TalkStatusHelper.isNewMax=function(e,t){return null==e.maxMessageId||oe.Int64.compare(e.maxMessageId,t)<0},ie.entity.TalkStatusHelper.isMax=function(e,t){return null!=e.maxMessageId&&ie.Int64Helper.eq(e.maxMessageId,t)},ie.entity.TalkStatusUpdate=function(e){null!=e&&(this.talkId=e.talk_id,this.maxEveryoneReadMessageId=e.max_everyone_read_message_id,this.maxReadMessageId=ie.OptionHelper.option(e.max_read_message_id))},n["albero.entity.TalkStatusUpdate"]=ie.entity.TalkStatusUpdate,ie.entity.TalkStatusUpdate.__name__=["albero","entity","TalkStatusUpdate"],ie.entity.TalkStatusUpdate.prototype={__class__:ie.entity.TalkStatusUpdate},ie.entity.ThumbInfo=function(e,t,n){this.file=e,this.dimension=ie.entity.ThumbDimension.createWithSize(t,n),this.auth=null},n["albero.entity.ThumbInfo"]=ie.entity.ThumbInfo,ie.entity.ThumbInfo.__name__=["albero","entity","ThumbInfo"],ie.entity.ThumbInfo.prototype={setAuth:function(e){this.auth=e},__class__:ie.entity.ThumbInfo},ie.entity.ThumbDimension=function(e){null!=e&&(this.width=e.width,this.height=e.height)},n["albero.entity.ThumbDimension"]=ie.entity.ThumbDimension,ie.entity.ThumbDimension.__name__=["albero","entity","ThumbDimension"],ie.entity.ThumbDimension.createWithSize=function(e,t){var n=new ie.entity.ThumbDimension;return n.width=e,n.height=t,n},ie.entity.ThumbDimension.prototype={toObject:function(){return{width:this.width,height:this.height}},__class__:ie.entity.ThumbDimension},ie.entity.UploadUseType=n["albero.entity.UploadUseType"]={__ename__:["albero","entity","UploadUseType"],__constructs__:["PROFILE_IMAGE","MESSAGE","TALK_ICON","THUMBNAIL"]},ie.entity.UploadUseType.PROFILE_IMAGE=["PROFILE_IMAGE",0],ie.entity.UploadUseType.PROFILE_IMAGE.toString=s,ie.entity.UploadUseType.PROFILE_IMAGE.__enum__=ie.entity.UploadUseType,ie.entity.UploadUseType.MESSAGE=["MESSAGE",1],ie.entity.UploadUseType.MESSAGE.toString=s,ie.entity.UploadUseType.MESSAGE.__enum__=ie.entity.UploadUseType,ie.entity.UploadUseType.TALK_ICON=["TALK_ICON",2],ie.entity.UploadUseType.TALK_ICON.toString=s,ie.entity.UploadUseType.TALK_ICON.__enum__=ie.entity.UploadUseType,ie.entity.UploadUseType.THUMBNAIL=["THUMBNAIL",3],ie.entity.UploadUseType.THUMBNAIL.toString=s,ie.entity.UploadUseType.THUMBNAIL.__enum__=ie.entity.UploadUseType,ie.entity.UploadUseType.__empty_constructs__=[ie.entity.UploadUseType.PROFILE_IMAGE,ie.entity.UploadUseType.MESSAGE,ie.entity.UploadUseType.TALK_ICON,ie.entity.UploadUseType.THUMBNAIL],ie.entity.UploadUseTypeHelper=function(){},n["albero.entity.UploadUseTypeHelper"]=ie.entity.UploadUseTypeHelper,ie.entity.UploadUseTypeHelper.__name__=["albero","entity","UploadUseTypeHelper"],ie.entity.UploadUseTypeHelper.getUseTypeInt=function(e){switch(e[1]){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 4}},ie.entity.UserIdentifier=function(e){null!=e&&(null!=e.user_id&&(this.userId=e.user_id),null!=e.email&&(this.email=e.email),null!=e.sub_email&&(this.subEmail=e.sub_email),null!=e.group_alias&&(this.groupAlias=e.group_alias),null!=e.signin_id&&(this.signinId=e.signin_id))},n["albero.entity.UserIdentifier"]=ie.entity.UserIdentifier,ie.entity.UserIdentifier.__name__=["albero","entity","UserIdentifier"],ie.entity.UserIdentifier.prototype={__class__:ie.entity.UserIdentifier};var oe={Int64:function(e,t){this.high=0|e,this.low=0|t}};n["haxe.Int64"]=oe.Int64,oe.Int64.__name__=["haxe","Int64"],oe.Int64.make=function(e,t){return new oe.Int64(e,t)},oe.Int64.ofInt=function(e){return new oe.Int64(e>>31,e)},oe.Int64.getLow=function(e){return e.low},oe.Int64.getHigh=function(e){return e.high},oe.Int64.add=function(e,t){var n=e.high+t.high|0,r=e.low+t.low|0;return oe.Int64.uicompare(r,e.low)<0&&n++,new oe.Int64(n,r)},oe.Int64.sub=function(e,t){var n=e.high-t.high|0,r=e.low-t.low|0;return oe.Int64.uicompare(e.low,t.low)<0&&n--,new oe.Int64(n,r)},oe.Int64.mul=function(e,t){var n,r,a,i,o=65535&e.low,s=e.low>>>16,l=65535&t.low,c=t.low>>>16,u=s*l,d=o*c,p=o*l,m=s*c+(d>>>16)+(u>>>16)|0;return p=p+(d=d<<16|0)|0,oe.Int64.uicompare(p,d)<0&&(m=m+1|0),p=p+(u=u<<16|0)|0,oe.Int64.uicompare(p,u)<0&&(m=m+1|0),m=(m=m+(n=e.low,r=t.high,(n*(r>>>16)<<16|0)+n*(65535&r)|0)|0)+(a=e.high,i=t.low,(a*(i>>>16)<<16|0)+a*(65535&i)|0)|0,new oe.Int64(m,p)},oe.Int64.divMod=function(e,t){var n=new oe.Int64(0,0),r=0,a=1;for(t=new oe.Int64(t.high,t.low);0<=t.high;){var i=oe.Int64.ucompare(t,e);if(t.high=t.high<<1|0|t.low>>>31|0,t.low=t.low<<1|0,r=r<<1|0|a>>>31|0,a=a<<1|0,0<=i)break}for(;0!=(a|r|0);)0<=oe.Int64.ucompare(e,t)&&(n.high=n.high|r|0,n.low=n.low|a|0,e=oe.Int64.sub(e,t)),a=0|(a>>>1|r<<31),r>>>=1,t.low=0|(t.low>>>1|t.high<<31),t.high=t.high>>>1;return{quotient:n,modulus:e}},oe.Int64.mod=function(e,t){if(0==t.high)switch(t.low){case 0:throw"modulus by zero";case 1:return new oe.Int64(0,0)}var n=e.high<0;e.high<0&&(e=oe.Int64.neg(e)),t.high<0&&(t=oe.Int64.neg(t));var r=oe.Int64.divMod(e,t).modulus;return n?oe.Int64.neg(r):r},oe.Int64.neg=function(e){var t=0|~e.high,n=0|-e.low;return 0==n&&t++,new oe.Int64(t,n)},oe.Int64.uicompare=function(e,t){return e<0?t<0?~t-~e|0:1:t<0?-1:e-t|0},oe.Int64.compare=function(e,t){var n=e.high-t.high|0;return 0!=n?n:oe.Int64.uicompare(e.low,t.low)},oe.Int64.ucompare=function(e,t){var n=oe.Int64.uicompare(e.high,t.high);return 0!=n?n:oe.Int64.uicompare(e.low,t.low)},oe.Int64.prototype={toString:function(){if(0==(this.high|this.low))return"0";var e="",t=!1,n=this;n.high<0&&(t=!0,n=oe.Int64.neg(n));for(var r=new oe.Int64(0,10);0!=(n.high|n.low);){var a=oe.Int64.divMod(n,r);e=a.modulus.low+e,n=a.quotient}return t&&(e="-"+e),e},__class__:oe.Int64},ie.entity.UserPresence=function(e,t){this.lastUpdatedAt=t,null!=e&&(this.userId=e.user_id,this.lastUsedAtOpt=ie.OptionHelper.option(e.last_used_at))},n["albero.entity.UserPresence"]=ie.entity.UserPresence,ie.entity.UserPresence.__name__=["albero","entity","UserPresence"],ie.entity.UserPresence.createUserPresenceState=function(e,t){var n=oe.Int64.sub(t,e);return 0<oe.Int64.compare(n,ie.entity.UserPresence.SIXTY_MINUTES)?ie.entity.UserPresenceState.GT_60:0<oe.Int64.compare(n,ie.entity.UserPresence.FIFTEEN_MINUTES)?ie.entity.UserPresenceState.LT_OR_EQ_60:ie.entity.UserPresenceState.LT_OR_EQ_15},ie.entity.UserPresence.prototype={toState:function(e){var t,n,r=ie.OptionHelper.map(this.lastUsedAtOpt,(t=ie.entity.UserPresence.createUserPresenceState,n=e,function(e){return t(e,n)}));switch(r[1]){case 0:return r[2];case 1:return ie.entity.UserPresenceState.GT_60}},isExpired:function(e,t){var n=oe.Int64.sub(e,this.lastUpdatedAt);return 0<oe.Int64.compare(n,t)},__class__:ie.entity.UserPresence},ie.entity.UserPresenceState=n["albero.entity.UserPresenceState"]={__ename__:["albero","entity","UserPresenceState"],__constructs__:["LT_OR_EQ_15","LT_OR_EQ_60","GT_60"]},ie.entity.UserPresenceState.LT_OR_EQ_15=["LT_OR_EQ_15",0],ie.entity.UserPresenceState.LT_OR_EQ_15.toString=s,ie.entity.UserPresenceState.LT_OR_EQ_15.__enum__=ie.entity.UserPresenceState,ie.entity.UserPresenceState.LT_OR_EQ_60=["LT_OR_EQ_60",1],ie.entity.UserPresenceState.LT_OR_EQ_60.toString=s,ie.entity.UserPresenceState.LT_OR_EQ_60.__enum__=ie.entity.UserPresenceState,ie.entity.UserPresenceState.GT_60=["GT_60",2],ie.entity.UserPresenceState.GT_60.toString=s,ie.entity.UserPresenceState.GT_60.__enum__=ie.entity.UserPresenceState,ie.entity.UserPresenceState.__empty_constructs__=[ie.entity.UserPresenceState.LT_OR_EQ_15,ie.entity.UserPresenceState.LT_OR_EQ_60,ie.entity.UserPresenceState.GT_60],ie.js={},ie.js.BootstrapHelper=function(){},n["albero.js.BootstrapHelper"]=ie.js.BootstrapHelper,ie.js.BootstrapHelper.__name__=["albero","js","BootstrapHelper"],ie.js.BootstrapHelper.tooltip=function(e,t){return e.tooltip(t)},ie.js.BootstrapHelper.popover=function(e,t){return e.popover(t)},ie.js.BootstrapHelper.modal=function(e,t){return e.modal(t)},ie.js.BootstrapHelper.collapse=function(e,t){return e.collapse(t)},ie.js.BootstrapHelper.tab=function(e,t){return e.tab(t)},ie.js.BootstrapHelper.dropdown=function(e,t){return e.dropdown(t)},ie.js.JQueryBuilder=function(e){this.tag=e},n["albero.js.JQueryBuilder"]=ie.js.JQueryBuilder,ie.js.JQueryBuilder.__name__=["albero","js","JQueryBuilder"],ie.js.JQueryBuilder.prototype={id:function(e){return null==e||0==e.length?this:this.attr("id",e)},attr:function(e,t){null==this.attrs&&(this.attrs=new oe.ds.StringMap);var n="";if(C.Boot.__instanceof(t,oe.Int64))n=ie.Int64Helper.idStr(C.Boot.__cast(t,oe.Int64));else{if("string"!=typeof t)throw"Unknown attr value type.";n=C.Boot.__cast(t,String)}return this.attrs.set(e,n),this},addClass:function(e){if(null==e||0==e.length)return this;if(null!=this.attrs){var t=this.attrs.get("class");null!=t&&(e=t+" "+e)}return this.attr("class",e)},prepend:function(e){return null!=e&&(null==this.children&&(this.children=new Array),this.children.unshift(e)),this},append:function(e){return null!=e&&(null==this.children&&(this.children=new Array),this.children.push(e)),this},text:function(e){var t;return t=null!=e?ee.htmlEscape(e,!0):"",this.append(t)},addListener:function(e){return null==this.listeners&&(this.listeners=new Array),this.listeners.push(e),this},build:function(){var e,t=this._build();return e=C.Boot.__instanceof(t,C.JQuery)?t:new C.JQuery(t),this._onBuild(e),e},_build:function(){var r=this,a=null,t=null,e=function(){var e=null;if(null!=r.tag){if(e="<"+r.tag,null!=r.attrs)for(var t=r.attrs.keys();t.hasNext();){var n=t.next();e+=" "+n+'="'+r.attrs.get(n)+'"'}e+=">"}return null!=a&&(null!=e?e+=a.join(""):e=a.join(""),a=null),null!=r.tag&&(e+="</"+r.tag+">"),e};if(null!=this.children)for(var n=function(e){null==a&&(a=new Array),a.push(e)},i=function(e){null==t&&(t=new C.JQuery(window.document.createDocumentFragment())),null!=a&&(t.append(a.join("")),a=null),t.append(e)},o=0,s=this.children;o<s.length;){var l=s[o];if(++o,C.Boot.__instanceof(l,ie.js.JQueryBuilder)){var c=C.Boot.__cast(l,ie.js.JQueryBuilder)._build();C.Boot.__instanceof(c,C.JQuery)?i(c):n(c)}else if(C.Boot.__instanceof(l,C.JQuery))i(l);else if(C.Boot.__instanceof(l,Element))i(l);else{if("string"!=typeof l)throw"unknown type child.";n(l)}}return null!=t?(null!=a&&t.append(a.join("")),null==this.tag?t:new C.JQuery(e()).append(t)):e()},_onBuild:function(e){if(null!=this.listeners)for(var t=0,n=this.listeners;t<n.length;){var r=n[t];++t,r(e)}if(null!=this.children)for(var a=0,i=this.children;a<i.length;){var o=i[a];++a,C.Boot.__instanceof(o,ie.js.JQueryBuilder)&&C.Boot.__cast(o,ie.js.JQueryBuilder)._onBuild(e)}},__class__:ie.js.JQueryBuilder},ie.js._JQueryBuilder={},ie.js._JQueryBuilder.Child_Impl_=function(){},n["albero.js._JQueryBuilder.Child_Impl_"]=ie.js._JQueryBuilder.Child_Impl_,ie.js._JQueryBuilder.Child_Impl_.__name__=["albero","js","_JQueryBuilder","Child_Impl_"],ie.js._JQueryBuilder.Child_Impl_._new=function(){return 0},ie.js.JQueryHelper=function(){},n["albero.js.JQueryHelper"]=ie.js.JQueryHelper,ie.js.JQueryHelper.__name__=["albero","js","JQueryHelper"],ie.js.JQueryHelper.off=function(e,t,n,r){return e.off(t,n,r),e},ie.js.JQueryHelper.isVisible=function(e){return"none"!=e.css("display")},ie.js.JQueryHelper.toggleClass=function(e,t,n){return e.toggleClass(t,n),e},ie.js.JQueryHelper.toggleIfNeed=function(e,t){e.each(function(){var e=$(this);t?ie.js.JQueryHelper.isVisible(e)||e.show():ie.js.JQueryHelper.isVisible(e)&&e.hide()})},ie.js.JQueryHelper.toggleWithAnimationIfNeed=function(e,t){e.each(function(){var e=$(this);t?ie.js.JQueryHelper.isVisible(e)||e.fadeIn():ie.js.JQueryHelper.isVisible(e)&&e.fadeOut()})},ie.js.JQueryHelper.modalIfNeed=function(e,t){e.each(function(){var e=$(this);t?ie.js.JQueryHelper.isVisible(e)||e.modal("show"):ie.js.JQueryHelper.isVisible(e)&&e.modal("hide")})},ie.js.JQueryHelper.loadStyleSheet=function(e,t){null==t&&(t=!1);var n=new C.JQuery('<link href="'+e+'" rel="stylesheet">');t?n.prependTo("head"):n.appendTo("head")},ie.js.JQueryHelper.loadScript=function(n,e){null==ie.js.JQueryHelper.callbackMap&&(ie.js.JQueryHelper.callbackMap=new oe.ds.StringMap);var r=ie.js.JQueryHelper.callbackMap.get(n);null==r&&(r=new Array,ie.js.JQueryHelper.callbackMap.set(n,r),$.getScript(n).done(function(){for(var e=0;e<r.length;){var t=r[e];++e,t()}ie.js.JQueryHelper.callbackMap.remove(n)})),null!=e&&r.push(e)},ie.js.JQueryHelper.triggerLazyLoad=function(e){e.is(":hidden")||ie.js.JQueryHelper.triggerLazyLoadNoCheck(e)},ie.js.JQueryHelper.triggerLazyLoadNoCheck=function(e){oe.Timer.delay(function(){e.trigger("scroll")},200)},ie.js.JQueryHelper.triggerLazyLoadSoonNoCheck=function(e){e.trigger("scroll")},ie.js.JQueryHelper.displaySpinnerWithExplicitToggle=function(e,t){t?e.show():e.hide(),ie.js.JQueryHelper.displaySpinner(e,t)},ie.js.JQueryHelper.displaySpinner=function(e,t){t?e.spin({lines:11,length:4,width:3,radius:7,color:"#49ccd7",top:"50%",left:"50%"}):e.spin(!1)},ie.js.JQueryHelper.displaySpinnerGray=function(e,t){oe.Timer.delay(function(){t?e.spin({lines:11,length:4,width:3,radius:7,color:"gray",top:"50%",left:"50%"}):e.spin(!1)},0)},ie.js.KatakanaToRoman=function(){},n["albero.js.KatakanaToRoman"]=ie.js.KatakanaToRoman,ie.js.KatakanaToRoman.__name__=["albero","js","KatakanaToRoman"],ie.js.KatakanaToRoman.assureConvertTable=function(){return null!=ie.js.KatakanaToRoman.convertTable||(ie.js.KatakanaToRoman.convertTable=new oe.ds.StringMap,ae.iter([["","A"],["","I"],["","U"],["","E"],["","O"],["","KA"],["","KI"],["","KU"],["","KE"],["","KO"],["","KYA"],["","KYU"],["","KYO"],["","SA"],["","SI"],["","SU"],["","SE"],["","SO"],["","SHA"],["","SHU"],["","SHO"],["","TA"],["","TI"],["","TU"],["","TE"],["","TO"],["","THA"],["","THU"],["","THO"],["","NA"],["","NI"],["","NU"],["","NE"],["","NO"],["","NYA"],["","NYU"],["","NYO"],["","HA"],["","HI"],["","FU"],["","HE"],["","HO"],["","HYA"],["","HYU"],["","HYO"],["","MA"],["","MI"],["","MU"],["","ME"],["","MO"],["","MYA"],["","MYU"],["","MYO"],["","YA"],["","YU"],["","YO"],["","RA"],["","RI"],["","RU"],["","RE"],["","RO"],["","RYA"],["","RYU"],["","RYO"],["","WA"],["","O"],["","N"],["","GA"],["","GI"],["","GU"],["","GE"],["","GO"],["","GYA"],["","GYU"],["","GYO"],["","ZA"],["","JI"],["","ZU"],["","ZE"],["","ZO"],["","ZYA"],["","ZYU"],["","ZYO"],["","DA"],["","JI"],["","ZU"],["","DE"],["","DO"],["","BA"],["","BI"],["","BU"],["","BE"],["","BO"],["","BYA"],["","BYU"],["","BYO"],["","PA"],["","PI"],["","PU"],["","PE"],["","PO"],["","PYA"],["","PYU"],["","PYO"],["",""],["",""]],function(e){ie.js.KatakanaToRoman.convertTable.set(e[0],e[1])})),ie.js.KatakanaToRoman.convertTable},ie.js.KatakanaToRoman.matchNext=function(e,t){var n,r=ie.js.KatakanaToRoman.assureConvertTable();if(t+1<e.length){var a=e.substring(t,t+2),i=r.get(a);if(null!=i)return ie.js.ResultOfMatchNext.MatchedToTwoCharsKey(i)}if(t<e.length){var o=e.substring(t,t+1),s=r.get(o);if(null!=s)return ie.js.ResultOfMatchNext.MatchedToOneCharKey(s)}return n=t<e.length?e.substring(t,t+1):"",ie.js.ResultOfMatchNext.NotMatched(n)},ie.js.KatakanaToRoman.prototype={convert:function(e){for(var t=0,n="";t<e.length;){var r=ie.js.KatakanaToRoman.matchNext(e,t);switch(r[1]){case 0:t+=2,n+=r[2];break;case 1:t+=1,n+=r[2];break;case 2:t+=1,n+=r[2]}}return n=ie.js.KatakanaToRoman.TU_REG.replace(n,"$1$1"),n=ie.js.KatakanaToRoman.XTU_REG.replace(n,"XTU")},__class__:ie.js.KatakanaToRoman},ie.js.ResultOfMatchNext=n["albero.js.ResultOfMatchNext"]={__ename__:["albero","js","ResultOfMatchNext"],__constructs__:["MatchedToTwoCharsKey","MatchedToOneCharKey","NotMatched"]},ie.js.ResultOfMatchNext.MatchedToTwoCharsKey=function(e){var t=["MatchedToTwoCharsKey",0,e];return t.__enum__=ie.js.ResultOfMatchNext,t.toString=s,t},ie.js.ResultOfMatchNext.MatchedToOneCharKey=function(e){var t=["MatchedToOneCharKey",1,e];return t.__enum__=ie.js.ResultOfMatchNext,t.toString=s,t},ie.js.ResultOfMatchNext.NotMatched=function(e){var t=["NotMatched",2,e];return t.__enum__=ie.js.ResultOfMatchNext,t.toString=s,t},ie.js.ResultOfMatchNext.__empty_constructs__=[],ie.js.LocalStorage=function(e){this.isDirty=!1,this.key=e},n["albero.js.LocalStorage"]=ie.js.LocalStorage,ie.js.LocalStorage.__name__=["albero","js","LocalStorage"],ie.js.LocalStorage.getLocalStorage=function(){return new(C.Node.require("node-localstorage").LocalStorage)(null!=v.storagePath?v.storagePath:"./storage.local",null!=v.storageQuota?Z.parseInt(v.storageQuota):null)},ie.js.LocalStorage.prototype={load:function(){var e=this.val();if(null==e||""==e)return null;var t=null;try{t=oe.Unserializer.run(e),this.isDirty=!1}catch(e){se._w(se.dateStr(),e,"","","","")}return t},save:function(e){try{this.val(oe.Serializer.run(e)),this.isDirty=!1}catch(e){se._w(se.dateStr(),e,"","","","")}},setDirtyFlag:function(){if(!this.isDirty)try{this.val(""),this.isDirty=!0}catch(e){se._w(se.dateStr(),e,"","","","")}},val:function(e){var t=ie.js.LocalStorage.getLocalStorage();return null!=t&&(null==e?e=t.getItem(this.key):""==e?t.removeItem(this.key):t.setItem(this.key,e)),e},__class__:ie.js.LocalStorage},ie.js.Localizer=function(){},n["albero.js.Localizer"]=ie.js.Localizer,ie.js.Localizer.__name__=["albero","js","Localizer"],ie.js.Localizer.runOrReserve=function(e){e()},ie.js.Localizer.localize=function(e,t){var n=window.i18next;return null==n?(se._e(se.dateStr(),"i18next not found.","","","",""),""):(null==t&&(t={}),n.t(e,t))};var C={Node:function(){}};n["js.Node"]=C.Node,C.Node.__name__=["js","Node"],C.Node.get_assert=function(){return C.Node.require("assert")},C.Node.get_child_process=function(){return C.Node.require("child_process")},C.Node.get_cluster=function(){return C.Node.require("cluster")},C.Node.get_crypto=function(){return C.Node.require("crypto")},C.Node.get_dgram=function(){return C.Node.require("dgram")},C.Node.get_dns=function(){return C.Node.require("dns")},C.Node.get_fs=function(){return C.Node.require("fs")},C.Node.get_http=function(){return C.Node.require("http")},C.Node.get_https=function(){return C.Node.require("https")},C.Node.get_net=function(){return C.Node.require("net")},C.Node.get_os=function(){return C.Node.require("os")},C.Node.get_path=function(){return C.Node.require("path")},C.Node.get_querystring=function(){return C.Node.require("querystring")},C.Node.get_repl=function(){return C.Node.require("repl")},C.Node.get_tls=function(){return C.Node.require("tls")},C.Node.get_url=function(){return C.Node.require("url")},C.Node.get_util=function(){return C.Node.require("util")},C.Node.get_vm=function(){return C.Node.require("vm")},C.Node.get_zlib=function(){return C.Node.require("zlib")},C.Node.get___filename=function(){return __filename},C.Node.get___dirname=function(){return __dirname},C.Node.get_json=function(){return JSON},C.Node.newSocket=function(e){return new(C.Node.require("net").Socket)(e)},C.Node.isNodeWebkit=function(){return"object"==typeof process};var se=e.AlberoLog=function(){};(n.AlberoLog=se).__name__=["AlberoLog"],se.getLogLevel=function(e){switch(e=null!=e?e.toUpperCase():"INFO"){case"EMERGENCY":return 0;case"ALERT":return 1;case"CRITICAL":return 2;case"ERROR":return 3;case"WARNING":return 4;case"NOTICE":return 5;case"INFO":return 6;default:return 7}},se._nop=function(){},se.dateStr=function(){return"["+(e=new Date,Y.dateStr(e))+"] ";var e},ie.js.NFKCTextSearch=function(e,t,n){this.ignoreCase=t,this.normalizeFunc=n,t&&(e=e.toUpperCase()),this.normalizedPattern=n(e)},n["albero.js.NFKCTextSearch"]=ie.js.NFKCTextSearch,ie.js.NFKCTextSearch.__name__=["albero","js","NFKCTextSearch"],ie.js.NFKCTextSearch.prototype={search:function(e){var t=new L,n=new Array;this.ignoreCase&&(e=e.toUpperCase()),this.normalize(e,t,n);for(var r,a=0,i=new Array,o=t.b;-1!=(r=o.indexOf(this.normalizedPattern,a));){a=r+this.normalizedPattern.length;for(var s=n[r],l=n[a-1],c=null,u=a,d=n.length;u<d;){if(l!=(c=n[u++]))break;c=null}null==c&&(c=e.length),i.push(new ie.js.HitSpan(s,c))}return i},normalize:function(e,t,n){for(var r=e.length,a=new L,i=0,o=0;o<r;){var s=o++,l=a.b.length,c=a.b,u=c+e.charAt(s),d=this.normalizeFunc(u);if(u!=d)if(ee.startsWith(d,c)){t.add(c.substring(0,l)),(a=new L).add(d.substring(l,d.length));for(var p=0;p<l;){p++;n.push(i)}i=s}else(a=new L).b+=null==d?"null":""+d;else{t.b+=Z.string(a),(a=new L).add(e.charAt(s));for(var m=0;m<l;){m++;n.push(i)}i=s}}null==a.b?t.b+="null":t.b+=""+a.b;for(var _=0,h=a.b.length;_<h;){_++;n.push(i)}},__class__:ie.js.NFKCTextSearch},ie.js.HitSpan=function(e,t){this.start=e,this.end=t},n["albero.js.HitSpan"]=ie.js.HitSpan,ie.js.HitSpan.__name__=["albero","js","HitSpan"],ie.js.HitSpan.prototype={__class__:ie.js.HitSpan},ie.js.ProxyHelper=function(){},n["albero.js.ProxyHelper"]=ie.js.ProxyHelper,ie.js.ProxyHelper.__name__=["albero","js","ProxyHelper"],ie.js.ProxyHelper.createAgent=function(e){var t=C.Node.require("url").parse(e),n={host:t.hostname};null!=t.port&&(n.port=Z.parseInt(t.port)),null!=t.auth&&(n.proxyAuth=t.auth);var r=C.Node.require("tunnel-agent");return("https:"==t.protocol?r.httpsOverHttps:r.httpsOverHttp)({proxy:n})},ie.js.TextCanonicalizer=function(){},n["albero.js.TextCanonicalizer"]=ie.js.TextCanonicalizer,ie.js.TextCanonicalizer.__name__=["albero","js","TextCanonicalizer"],ie.js.TextCanonicalizer.canonicalize=function(e,t){return ie.js.TextCanonicalizer.basicLatinAlphabetToUpperCase(ie.js.TextCanonicalizer.hiraganaToKatakana(t(ie.js.TextCanonicalizer.eraseInvisible(e))))},ie.js.TextCanonicalizer.canonicalizeForRoman=function(e,t){return ie.js.TextCanonicalizer.basicLatinAlphabetToUpperCase(ie.js.TextCanonicalizer.katakanaToRoman(ie.js.TextCanonicalizer.hiraganaToKatakana(t(ie.js.TextCanonicalizer.eraseInvisible(e)))))},ie.js.TextCanonicalizer.basicLatinAlphabetToUpperCase=function(e){return e.toUpperCase()},ie.js.TextCanonicalizer.hiraganaToKatakana=function(e){for(var t=0,n="",r=0,a=e.length;r<a;){var i=r++,o=Y.cca(e,i);o>=ie.js.TextCanonicalizer.HIRAGANA_SMALL_A&&o<=ie.js.TextCanonicalizer.HIRAGANA_NN&&(n+=e.substring(t,i),n+=String.fromCharCode(o+(ie.js.TextCanonicalizer.KATAKANA_SMALL_A-ie.js.TextCanonicalizer.HIRAGANA_SMALL_A)),t=i+1)}return n+=e.substring(t,e.length)},ie.js.TextCanonicalizer.katakanaToRoman=function(e){return(new ie.js.KatakanaToRoman).convert(e)},ie.js.TextCanonicalizer.normalize=function(e){return e.normalize("NFKC")},ie.js.TextCanonicalizer.assureNormalize=function(e){e(ie.js.TextCanonicalizer.normalize)},ie.js.TextCanonicalizer.eraseInvisible=function(e){return new o("[\\u0000-\\u0020]","g").replace(e,"")},ie.js.WebSocket=function(e){var t=this,n=v.wsConfig,r=C.Node.require("websocket").client;this.ws=new r(n),this.ws.on("connectFailed",_(this,this.onError)),this.ws.on("connect",function(e){(t.connection=e).on("error",_(t,t.onError)),e.on("close",_(t,t.onConnectionClose)),e.on("message",_(t,t.onMessage)),e.on("pong",_(t,t.onPong)),t.onOpen(null)});var a=null;null!=v.proxyURL&&(a={agent:ie.js.ProxyHelper.createAgent(v.proxyURL)}),this.ws.connect(e,null,null,null,a)},n["albero.js.WebSocket"]=ie.js.WebSocket,ie.js.WebSocket.__name__=["albero","js","WebSocket"],ie.js.WebSocket.prototype={onOpen:function(e){se._i(se.dateStr(),"WebSocket opened.","","","",""),null!=this.onopen&&this.onopen()},onMessage:function(e){if(null!=this.onmessage){var t,n=e;t=oe.io.Bytes.ofData(n.binaryData),this.onmessage(t)}},onPong:function(e){null!=this.onpong&&this.onpong(e)},onError:function(e){se._e(se.dateStr(),"WebSocket error. event:",e,"","",""),null!=this.onerror&&this.onerror()},onClose:function(e){null!=this.ws&&(this.ws.removeAllListeners(),this.ws=null),null!=this.connection&&(this.connection.removeAllListeners(),this.connection=null),se._i(se.dateStr(),"WebSocket closed. event:%s reason:%s wasClean:%s",e.code,e.reason,e.wasClean,""),null!=this.onclose&&this.onclose(e.code,e.reason,e.wasClean)},onConnectionClose:function(e,t){this.onClose({code:e,reason:t})},close:function(){if(!this.isClosed()){var e=this.connection;this.onConnectionClose(1e3,"Normal connection closure"),e.close()}},send:function(e){this.isClosed()||this.connection.sendBytes(e.b)},ping:function(e){this.connection.ping(e)},isClosed:function(){return null==this.ws||null==this.connection||!this.connection.connected},__class__:ie.js.WebSocket},l.interfaces.IMediator=function(){},n["puremvc.interfaces.IMediator"]=l.interfaces.IMediator,l.interfaces.IMediator.__name__=["puremvc","interfaces","IMediator"],l.interfaces.IMediator.prototype={__class__:l.interfaces.IMediator},l.patterns.mediator={},l.patterns.mediator.Mediator=function(e,t){l.patterns.observer.Notifier.call(this),this.mediatorName=null!=e?e:l.patterns.mediator.Mediator.NAME,null!=t&&(this.viewComponent=t)},n["puremvc.patterns.mediator.Mediator"]=l.patterns.mediator.Mediator,l.patterns.mediator.Mediator.__name__=["puremvc","patterns","mediator","Mediator"],l.patterns.mediator.Mediator.__interfaces__=[l.interfaces.IMediator],l.patterns.mediator.Mediator.__super__=l.patterns.observer.Notifier,l.patterns.mediator.Mediator.prototype=t(l.patterns.observer.Notifier.prototype,{getMediatorName:function(){return this.mediatorName},setViewComponent:function(e){this.viewComponent=e},getViewComponent:function(){return this.viewComponent},listNotificationInterests:function(){return[]},handleNotification:function(e){},onRegister:function(){},onRemove:function(){},__class__:l.patterns.mediator.Mediator}),ie.mediator={},ie.mediator.UserModalMediator=function(){l.patterns.mediator.Mediator.call(this,"user-modal"),this.fragment=new C.JQuery("#user-modal")},n["albero.mediator.UserModalMediator"]=ie.mediator.UserModalMediator,ie.mediator.UserModalMediator.__name__=["albero","mediator","UserModalMediator"],ie.mediator.UserModalMediator.inHasUserDialog=function(e){return e.hasClass("has-user-dialog")||0<e.closest(".has-user-dialog").length},ie.mediator.UserModalMediator.__super__=l.patterns.mediator.Mediator,ie.mediator.UserModalMediator.prototype=t(l.patterns.mediator.Mediator.prototype,{listNotificationInterests:function(){return["domain_selection_changed","get_domain_users_responsed","get_department_users_responsed","notify_update_user","notify_add_friend","notify_delete_friend","notify_add_acquaintance","notify_update_domain","get_users_responsed","get_profile_responsed","get_profile_errored","get_department_tree_responsed","presences_updated"]},handleNotification:function(e){var t=this;switch(e.getName()){case"domain_selection_changed":var n=e.getBody();null==this.user||ie.Int64Helper.eq(this.user.domainId,n)||this.fragment.modal("hide");break;case"get_domain_users_responsed":case"get_department_users_responsed":var r=e.getBody()[0];if(null!=this.domainId&&ie.Int64Helper.eq(this.domainId,r))for(var a=e.getBody()[3],i=0;i<a.length;){var o=a[i];if(++i,ie.Int64Helper.eq(this.userId,o.id)){this.onBasicProfileUpdated(o),this.onDepartmentsUpdated();break}}break;case"get_users_responsed":var s=e.getBody()[0];if(null!=this.domainId&&ie.Int64Helper.eq(this.domainId,s))for(var l=e.getBody()[1],c=0;c<l.length;){var u=l[c];if(++c,ie.Int64Helper.eq(this.userId,u.id)){this.onBasicProfileUpdated(u),null!=this.profileItemValues&&this.displayProgress(!1);break}}break;case"notify_update_user":case"notify_add_friend":case"notify_add_acquaintance":if(null==this.user)return;var d=e.getBody();ie.Int64Helper.eq(this.user.domainId,d.domainId)&&ie.Int64Helper.eq(this.user.id,d.id)&&(this.onBasicProfileUpdated(d),this.requestGetProfileIfNeed());break;case"notify_delete_friend":if(null==this.user)return;var p=e.getBody()[0],m=e.getBody()[1];ie.Int64Helper.eq(this.user.domainId,p)&&ie.Int64Helper.eq(this.user.id,m)&&this.onFriendUpdated(!1);break;case"get_profile_responsed":var _=e.getBody();null!=this.domainId&&ie.Int64Helper.eq(this.domainId,_.domainId)&&ie.Int64Helper.eq(this.userId,_.userId)&&(this.onOptionProfileUpdated(_.itemValues),null!=this.user&&this.displayProgress(!1));break;case"get_profile_errored":if(null!=this.user){var h=e.getBody();null!=ae.find(h,function(e){return ie.Int64Helper.eq(e,t.userId)})&&this.displayProgress(!1)}break;case"get_department_tree_responsed":var y=e.getBody()[0];ie.Int64Helper.eq(y,this.domainId)&&this.onDepartmentsUpdated();break;case"notify_update_domain":e.getBody()[0];var f=e.getBody()[1];null!=this.domainId&&ie.Int64Helper.eq(this.domainId,f.id)&&(this.onOptionProfileUpdated(this.profileItemValues),this.onDepartmentsUpdated());break;case"presences_updated":var g=e.getBody();this.onUpdatePresences(g)}},onRegister:function(){var t=this;new C.JQuery(window.document.body).on("click",".has-user-dialog",function(e){t.setupEventHandlers(),t.userId=ie.Int64Helper.makeFromIdStr($(this).attr("data-user-id")),t.domainId=ie.Int64Helper.makeFromIdStr($(this).attr("data-domain-id")),t.user=t.dataStore.getUser(t.domainId,t.userId),t.fragment.modal(null)})},setupEventHandlers:function(){var t=this;this.eventHandlersPrepared||(this.eventHandlersPrepared=!0,this.fragment.on("show.bs.modal",_(this,this.onShownModal)).on("hidden.bs.modal",_(this,this.onHiddenModal)),this.fragment.find(".prof-icon-large").find("img").on("load",function(e){var t=new C.JQuery(e.target).parent(),n=Z.parseInt(t.css("width")),r=Z.parseInt(t.css("height"));albero_tools.ImageTools.cropImage(e.target,n,r)}).on("error",function(e){albero_tools.ImageTools.clearCrop(e.target)}),new C.JQuery("#user-dialog-favorite-button").click(function(e){t.sendNotification("ManageFriends",{action:t.isFriend?ie.command.ManageFriendsAction.DELETE:ie.command.ManageFriendsAction.ADD,users:[t.user]})}),new C.JQuery("#user-dialog-talk-button").click(function(e){t.talkCreating||(t.talkCreating=!0,t.fragment.modal("hide"),t.sendNotification("Talk",ie.command.TalkAction.OPEN_PAIR_TALK(t.user.domainId,t.user.id,ie.entity.PaneType.SingleTalkPane)),t.sendNotification("Url",ie.command.UrlAction.REDIRECT(ie.Urls.talks(t.user.domainId,ie.TalkUrlParam.single))))}),new C.JQuery("#user-dialog-edit-profile-button").click(function(e){t.fragment.modal("hide"),t.sendNotification("Url",ie.command.UrlAction.REDIRECT(ie.Urls.settings(t.domainId)))}),new C.JQuery("#user-dialog-search-for-other, #user-dialog-search-for-me").click(function(e){t.fragment.modal("hide"),t.sendNotification("Url",ie.command.UrlAction.REDIRECT(ie.Urls.talks(t.user.domainId,ie.TalkUrlParam.single))),oe.Timer.delay(function(){t.searchService.clearEditingParams(),t.searchService.updateFromUserIdParam(t.user.id),t.searchService.updateKeywordParam(new C.JQuery("#talk-searchbox").val()),t.sendNotification("notify_search_prepare",{searching:!1,params:t.searchService.editingParams})},0)}),ie.mediator.helper.UserViewHelper.attachDepartmentClick(this.fragment,function(e){t.fragment.modal("hide"),t.sendNotification("department_selection_changed_for_members_page",e),t.sendNotification("Url",ie.command.UrlAction.REDIRECT(ie.Urls.members(t.domainId)))}))},requestGetProfileIfNeed:function(){this.dataStore.isMe(this.userId)?(this.displayProgress(!1),this.onOptionProfileUpdated(this.user.profileContact)):(this.displayProgress(!0),this.sendNotification("ReloadData",ie.command.ReloadDataType.GetProfile(this.domainId,this.userId)))},onShownModal:function(e){null==this.user&&this.sendNotification("ReloadData",ie.command.ReloadDataType.GetUsers(this.domainId,[this.userId])),this.onBasicProfileUpdated(this.user),this.requestGetProfileIfNeed(),this.onDepartmentsUpdated(),this.loadDepartmentIfNeed(),this.talkCreating=!1},onBasicProfileUpdated:function(e){var t=new C.JQuery("#user-dialog-content");if(null==(this.user=e))t.children().hide();else{t.children().show(),new C.JQuery("#user-dialog-username").text(e.displayName),new C.JQuery("#user-dialog-phonetic-username").text(null!=e.phoneticDisplayName?e.phoneticDisplayName:"");var n=this.fragment.find(".prof-icon-large img");n.attr("style",""),ie.mediator.helper.FileLoadHelper.setSrcAsync(e.profileImageUrl,null,n),this.updateStatusSection(),this.updatePresenceSection(),this.sendNotification("UpdateUserPresences",{domainId:e.domainId,userIds:[e.id]});var r=new C.JQuery("#user-dialog-me-buttons"),a=new C.JQuery("#user-dialog-not-me-buttons");this.isMe=this.dataStore.isMe(e.id),this.isMe?(r.show(),a.hide()):(r.hide(),a.show(),this.onFriendUpdated(this.dataStore.isFriend(e.domainId,e.id)))}},updateStatusSection:function(){new C.JQuery("#user-dialog-status").text(null!=this.user.status?this.user.status:""),ie.js.JQueryHelper.toggleIfNeed(new C.JQuery("#user-dialog-status-section"),null!=this.user.status)},updatePresenceSection:function(){new C.JQuery("#user-dialog-last-used-at-value").text(this.getLastUsedAtString(this.user.id)),new C.JQuery("#user-dialog-presence-section .c-presence").replaceWith(ie.mediator.helper.UserIconBuilder.createPresenceMark(this.getUserPresenceStatus(this.user.id)).build())},getUserPresenceStatus:function(e){return this.userPresences.getUserPresenceState(e,ie.DateTimeHelper.nowAsInt64())},getLastUsedAtString:function(e){var t=ie.OptionHelper.map(ie.OptionHelper.flatMap(this.userPresences.getUserPresence(e),function(e){return e.lastUsedAtOpt}),function(e){return ie.DateTimeHelper.datetimeString(e)});switch(t[1]){case 0:return t[2];case 1:return" - "}},onOptionProfileUpdated:function(e){this.profileItemValues=e,null==this.profileItemValues&&(this.profileItemValues=new Array);var t=this.dataStore.getDomain(this.domainId);if(null!=t){var n=t.profileDefinition.getVisibleItemDefinitions(!0,ie.mediator.helper.DomainHelper.isDepartmentEnabled(t));if(0!=n.length){var r=new C.JQuery("#user-dialog-option-profiles");r.empty();for(var a=new ie.js.JQueryBuilder,i=0;i<n.length;){var o=n[i];++i;var s=null;if(null!=e)for(var l=0;l<e.length;){var c=e[l];if(++l,c.profileItemId==o.profileItemId){s=c.value;break}}null!=s&&0!=ie.StringHelper.trim(s).length&&a.append(this.createLabelValue(o,s))}r.append(a.build())}}else this.fragment.modal("hide")},onDepartmentsUpdated:function(){var e=this.dataStore.getDomain(this.domainId);if(null!=e){var t=new C.JQuery("#user-dialog-departments");if(t.empty(),ie.mediator.helper.DomainHelper.isDepartmentEnabled(e))for(var n=this.getDomainDepartmentIds(),r=0,a=n.length;r<a;){var i,o=r++;i=1==n.length?"":Z.string(o+1),t.append(this.createDepartmentItemBuilder(n[o],i).build())}}else this.fragment.modal("hide")},onUpdatePresences:function(e){var t=this;ae.exists(e,function(e){return ie.Int64Helper.eq(t.userId,e)})&&this.updatePresenceSection()},createDepartmentItemBuilder:function(e,t){for(var n=new ie.js.JQueryBuilder("div").addClass("list-group-item-heading").text(""+ie.js.Localizer.localize("user_dialog.department")+t),r=new ie.js.JQueryBuilder("div").addClass("list-group-item-text department-item-value"),a=0,i=this.departmentStore.getDepartmentPathWithoutRoot(e);a<i.length;){var o=i[a];++a,r.append(ie.mediator.helper.UserViewHelper.createUserDepartmentLinkBuilder(o))}return new ie.js.JQueryBuilder("div").addClass("list-group-item").append(n).append(r)},getDomainDepartmentIds:function(){var n=this;return null!=this.user&&null!=this.user.departments?this.user.departments.filter(function(e){var t=n.departmentStore.getDepartment(e);return null!=t&&!t.isFree()&&ie.StringHelper.isNotEmpty(t.name)}):[]},createLabelValue:function(e,t){var n=new ie.js.JQueryBuilder("div").addClass("list-group-item-heading").text(e.name),r=new ie.js.JQueryBuilder("div").addClass("list-group-item-text profile-item-value").text(t);return new ie.js.JQueryBuilder("div").addClass("list-group-item").append(n).append(r)},onFriendUpdated:function(e){this.isFriend=e;var t=new C.JQuery("#user-dialog-favorite-button").find(".glyphicon");t.toggleClass("glyphicon-star",e),t.toggleClass("glyphicon-star-empty",!e)},displayProgress:function(e){var t=this.fragment.find(".spinner-container");e?t.show():t.hide(),ie.js.JQueryHelper.displaySpinner(t,e)},onHiddenModal:function(e){this.user=null,this.userId=null,this.domainId=null,this.profileItemValues=null,new C.JQuery("#user-dialog-option-profiles").children().remove(),new C.JQuery("#user-dialog-departments").children().remove()},loadDepartmentIfNeed:function(){null!=this.domainId&&ie.mediator.helper.DomainHelper.isDepartmentEnabled(this.dataStore.getDomain(this.domainId))&&null==this.departmentStore.getRootDepartmentId(this.domainId)&&this.sendNotification("ReloadData",ie.command.ReloadDataType.DepartmentTree(this.domainId))},__class__:ie.mediator.UserModalMediator}),ie.mediator.UsernameTooltipMediator=function(){l.patterns.mediator.Mediator.call(this,"body")},n["albero.mediator.UsernameTooltipMediator"]=ie.mediator.UsernameTooltipMediator,ie.mediator.UsernameTooltipMediator.__name__=["albero","mediator","UsernameTooltipMediator"],ie.mediator.UsernameTooltipMediator.__super__=l.patterns.mediator.Mediator,ie.mediator.UsernameTooltipMediator.prototype=t(l.patterns.mediator.Mediator.prototype,{onRegister:function(){var t=this;oe.Timer.delay(function(){t.hoverUsernameTooltip(new C.JQuery(window.document.body),".has-username-tooltip"),window.document.body.addEventListener("DOMNodeRemoved",function(e){t.destroyUsernameTooltipIfElementNotExist(e)})},0)},listNotificationInterests:function(){return["notify_update_user"]},handleNotification:function(e){switch(e.getName()){case"notify_update_user":var t=e.getBody();this.destroyUsernameTooltip(t.domainId,t.id)}},hoverUsernameTooltip:function(e,t){var s=this;e.on("mouseenter",t,function(e){var t=$(this),n=ie.Int64Helper.makeFromIdStr(t.attr("data-domain-id")),r=ie.Int64Helper.makeFromIdStr(t.attr("data-user-id")),a=s.dataStore.getUser(n,r);if(null!=a){var i=t.closest(".modal-dialog");if(0==i.length&&(i=new C.JQuery(window.document.body)),null!=s.jqUserTooltipBase){var o=s.jqUserTooltipBase;s.jqUserTooltipBase=null,0==o.closest("body").length&&new C.JQuery("#username-tooltip").remove()}(s.jqUserTooltipBase=t).tooltip({title:a.displayName,trigger:"manual",template:'<div id="username-tooltip" class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',container:i}),t.tooltip("show")}}).on("mouseleave",t,function(e){se._d(se.dateStr(),"click selector:",t,"","",""),new C.JQuery(e.currentTarget).tooltip("destroy")})},destroyUsernameTooltipIfElementNotExist:function(e){null!=this.jqUserTooltipBase&&(se._d(se.dateStr(),"destroyUsernameTooltipIfElementNotExist.","","","",""),(e.target==this.jqUserTooltipBase[0]||C.JQuery.contains(e.target,this.jqUserTooltipBase[0])||0==this.jqUserTooltipBase.closest("body").length)&&(se._d(se.dateStr(),"username tooltip base removed.","","","",""),this.jqUserTooltipBase=null,new C.JQuery("#username-tooltip").remove()))},destroyUsernameTooltip:function(e,t){if(null!=this.jqUserTooltipBase&&"_"+t.high+"_"+t.low==this.jqUserTooltipBase.attr("data-user-id")&&"_"+e.high+"_"+e.low==this.jqUserTooltipBase.attr("data-domain-id")){se._d(se.dateStr(),"destroy user tooltip.","","","","");var n=this.jqUserTooltipBase;this.jqUserTooltipBase=null,0!=n.closest("body").length?n.tooltip("destroy"):new C.JQuery("#username-tooltip").remove(),n=null}},__class__:ie.mediator.UsernameTooltipMediator}),ie.mediator.helper={},ie.mediator.helper.AnnouncementHelper=function(){},n["albero.mediator.helper.AnnouncementHelper"]=ie.mediator.helper.AnnouncementHelper,ie.mediator.helper.AnnouncementHelper.__name__=["albero","mediator","helper","AnnouncementHelper"],ie.mediator.helper.AnnouncementHelper.getDisplayTextWithoutEscape=function(e){return ie.mediator.helper.MessageHelper.getDisplayTextWithoutEscape(e.type,e.content)},ie.mediator.helper.AnnouncementHelper.getNotificatoinTextWithoutEscape=function(e,t){switch(null==t&&(t=e.userName),null==t&&(t=""),e.type[1]){case 1:case 6:return t+":"+ie.mediator.helper.AnnouncementHelper.getDisplayTextWithoutEscape(e);default:return se._e(se.dateStr(),"Unsupported announcement.type is detected. announcment:%o",e,"","",""),ie.mediator.helper.MessageHelper.getUnsupportText()}},ie.mediator.helper.AnswerForView=function(e,t,n){this.answerText=e,this.userIds=t,this.displayUserCount=n},n["albero.mediator.helper.AnswerForView"]=ie.mediator.helper.AnswerForView,ie.mediator.helper.AnswerForView.__name__=["albero","mediator","helper","AnswerForView"],ie.mediator.helper.AnswerForView.prototype={getAnswerTitle:function(){return this.displayUserCount?this.answerText+" ("+this.getAnswerersCount()+")":this.answerText},getAnswerersCount:function(){return null!=this.userIds?this.userIds.length:0},hasUser:function(){return 0==this.getAnswerersCount()},getSortedUsers:function(e,t){return ie.ArrayHelper.sortAndReturn(e.getUsers(t,this.userIds),function(e,t){return ie.StringHelper.compare(e.canonicalPhoneticDisplayName,t.canonicalPhoneticDisplayName)})},__class__:ie.mediator.helper.AnswerForView},ie.mediator.helper.ButtonMaker=function(){},n["albero.mediator.helper.ButtonMaker"]=ie.mediator.helper.ButtonMaker,ie.mediator.helper.ButtonMaker.__name__=["albero","mediator","helper","ButtonMaker"],ie.mediator.helper.ButtonMaker.createWarningButton=function(){return ie.mediator.helper.ButtonMaker.createButton().addClass("btn-warning")},ie.mediator.helper.ButtonMaker.createPrimaryButton=function(){return ie.mediator.helper.ButtonMaker.createButton().addClass("btn-primary")},ie.mediator.helper.ButtonMaker.createDefaultButton=function(){return ie.mediator.helper.ButtonMaker.createButton().addClass("btn-default")},ie.mediator.helper.ButtonMaker.createDangerButton=function(){return ie.mediator.helper.ButtonMaker.createButton().addClass("btn-danger")},ie.mediator.helper.ButtonMaker.createButton=function(){return new ie.js.JQueryBuilder("button").addClass("btn").attr("type","button")},ie.mediator.helper.DomainHelper=function(){},n["albero.mediator.helper.DomainHelper"]=ie.mediator.helper.DomainHelper,ie.mediator.helper.DomainHelper.__name__=["albero","mediator","helper","DomainHelper"],ie.mediator.helper.DomainHelper.isSaveAllowedChanged=function(e,t){return ie.mediator.helper.DomainHelper.isSaveAllowed(e)!=ie.mediator.helper.DomainHelper.isSaveAllowed(t)},ie.mediator.helper.DomainHelper.isForwardTypeChanged=function(e,t){return null==e||e.setting.allowForwardMessageType!=t.setting.allowForwardMessageType},ie.mediator.helper.DomainHelper.isSolutionChanged=function(e,t){var n=ie.mediator.helper.DomainHelper.getSolutionIds(e),r=ie.mediator.helper.DomainHelper.getSolutionIds(t);if(null==n&&null==r)return!1;if(null==n||null==r)return!0;if(n.length!=r.length)return!0;for(var a=0,i=n.length;a<i;){var o=a++;if(n[o]!=r[o])return!0}return!1},ie.mediator.helper.DomainHelper.getSolutionIds=function(e){return null==e||null==e.contract?null:e.contract.solutionIds},ie.mediator.helper.DomainHelper.isSaveAllowed=function(e){return null==e||(null==e.setting.allowSaveAttachments?e.setting.allowSaveAttachmentsToDevice:null==electronHelper.electron?e.setting.allowSaveAttachments.web:e.setting.allowSaveAttachments.desktop)},ie.mediator.helper.DomainHelper.isChangedContractTreeEnabled=function(e,t){return ie.entity.Domain.isChangedContractTreeEnabled(e,t)},ie.mediator.helper.DomainHelper.isDepartmentEnabled=function(e){return ie.entity.Domain.isDepartmentEnabled(e)},ie.mediator.helper.DomainHelper.isAllowListUser=function(e){return ie.entity.Domain.isAllowListUser(e)},ie.mediator.helper.DomainHelper.isAllowReadAnnouncement=function(e){return null!=e&&!!e.role.allowReadAnnouncements},ie.mediator.helper.FileLoadHelper=function(){},n["albero.mediator.helper.FileLoadHelper"]=ie.mediator.helper.FileLoadHelper,ie.mediator.helper.FileLoadHelper.__name__=["albero","mediator","helper","FileLoadHelper"],ie.mediator.helper.FileLoadHelper.download=function(r,e,a){e.hasClass("disabled")||(e.addClass("disabled"),oe.Timer.delay(function(){var n=function(){oe.Timer.delay(function(){e.removeClass("disabled")},1e3)},t=window.navigator;null!=t.msSaveBlob?ie.mediator.helper.Resources.getInstance().createBlobReliable(r.url,r.messageId,!0,function(e){n(),t.msSaveBlob(e,r.name)},function(e){n(),se._d(se.dateStr(),"FileLoadHelper.download error=",e,"","","")},0):ie.mediator.helper.Resources.getInstance().createBlobUrl(r.url,r.messageId,!0,function(e){n();var t=new ie.js.JQueryBuilder("a").attr("href",e).attr("download",r.name).build();new C.JQuery("#link-creator").append(t),t[0].click(),t.remove()},function(e){n(),se._d(se.dateStr(),"FileLoadHelper.download error=",e,"","","")},a)},0))},ie.mediator.helper.FileLoadHelper.setSrcAsyncLazy=function(t,n,r,e,a,i){e.appear=function(e){ie.mediator.helper.FileLoadHelper.loadAsObjectUrl(t,n,!1,function(e){ie.mediator.helper.FileLoadHelper.isWaiting(r)?r.data("original",e):r.attr("src",e)},a,i)},r.data("original",ie.mediator.helper.FileLoadHelper.getWaitingUrl()),r.lazyload(e)},ie.mediator.helper.FileLoadHelper.isWaiting=function(e){return e.attr("src")!=ie.mediator.helper.FileLoadHelper.getWaitingUrl()},ie.mediator.helper.FileLoadHelper.getWaitingUrl=function(){return albero_tools.ImageTools.getBlankImage()+"?waiting"},ie.mediator.helper.FileLoadHelper.setSrcAsync=function(e,t,n,r,a,i){ie.mediator.helper.FileLoadHelper.setAttrAsync(e,t,n,"src",r,a,i)},ie.mediator.helper.FileLoadHelper.setPosterAsync=function(e,t,n,r,a,i){ie.mediator.helper.FileLoadHelper.setAttrAsync(e,t,n,"poster",r,a,i)},ie.mediator.helper.FileLoadHelper.setAttrAsync=function(e,t,n,r,a,i,o){ie.mediator.helper.FileLoadHelper.loadAsObjectUrl(e,t,!1,function(e){n.attr(r,e),null!=a&&a()},i,o)},ie.mediator.helper.FileLoadHelper.loadAsByteArray=function(e,t,n){ie.mediator.helper.FileLoadHelper.loadAsObjectUrl(e.url,e.messageId,!1,function(e){ie.mediator.helper.FileLoaderCommon.loadAsArrayBuffer(e,null,function(e){t(null==e?oe.ds.Option.None:oe.ds.Option.Some(new Uint8Array(e)))},function(e){t(oe.ds.Option.None)})},function(e){t(oe.ds.Option.None)},n)},ie.mediator.helper.FileLoadHelper.loadAsObjectUrl=function(e,t,n,r,a,i){ie.mediator.helper.Resources.getInstance().createBlobUrl(e,t,n,null!=r?r:function(e){},null!=a?a:function(e){},i)},ie.mediator.helper.FileLoadHelper.setupIcon=function(t,e,n,r,a,i){var o=null,s=null;o=function(e){t.attr("src")!=ie.mediator.helper.FileLoadHelper.getWaitingUrl()&&(r(),t.off("load",o).off("error",s))},s=function(e){a(null),t.remove()},t.on("load",o).on("error",s),null==n?ie.mediator.helper.FileLoadHelper.setSrcAsync(e,null,t,null,a,i):ie.mediator.helper.FileLoadHelper.setSrcAsyncLazy(e,null,t,n,a,i)},ie.mediator.helper.FileLoadHelper.setupIconDummy=function(r,e,t,n){var a=null,i=null;a=function(e){r.attr("src")!=ie.mediator.helper.FileLoadHelper.getWaitingUrl()&&(t(),r.off("load",a).off("error",i))},i=function(e){n(null),r.remove()},r.on("load",a).on("error",i),D.readAsDataURL(null!=e.thumbFile?e.thumbFile.blob:ie.proxy.FileServiceProxy.getBlobFromUpdatableFile(e.file),function(e){if("load"==e.type){var t=e.result;r.attr("src",t)}else if("error"==e.type){var n="Can't read file thumbnail. evt:"+Z.string(e);se._e(se.dateStr(),n,"","","","")}})},ie.mediator.helper.FragmentMaker=function(){},n["albero.mediator.helper.FragmentMaker"]=ie.mediator.helper.FragmentMaker,ie.mediator.helper.FragmentMaker.__name__=["albero","mediator","helper","FragmentMaker"],ie.mediator.helper.FragmentMaker.replaceProfIcons=function(e,t,n){null==n&&(n=""),0!=e.length&&e.each(function(){$(this).replaceWith(new ie.mediator.helper.UserIconBuilder(t).addTooltip().addCircleClip().addDialog().build().addClass(n).build())})},ie.mediator.helper.FragmentMaker.getFileService=function(){return l.patterns.facade.Facade.getInstance().retrieveProxy("fileService")},ie.mediator.helper.FragmentMaker.getDataStore=function(){return l.patterns.facade.Facade.getInstance().retrieveProxy("dataStore")},ie.mediator.helper.FragmentMaker.createIconIdString=function(){return"icon-id-"+Z.string(++ie.mediator.helper.FragmentMaker.iconIdMax)},ie.mediator.helper.FragmentMaker.containsOrSelf=function(e,t){return C.JQuery.contains(e,t)||e==t},ie.mediator.helper.FragmentMaker.emptyUserIcon=function(){var e=new ie.js.JQueryBuilder("div").addClass("img-circle prof-icon"),t=new ie.js.JQueryBuilder("img").addClass("icon-user");return t.attr("src",albero_tools.ImageTools.getBlankImage()),e.append(t),e},ie.mediator.helper.FragmentMaker.createUserInitial=function(e,t){if(null!=t){var n=new ie.js.JQueryBuilder("span").addClass("initial-user");n.text(t.charAt(0));var r=ie.UserInitialColors.getBackgroundColor(e);return n.attr("style","background: "+r+";"),n}var a=new ie.js.JQueryBuilder("img").addClass("icon-user");return a.attr("src",albero_tools.ImageTools.getBlankImage()),a.attr("alt",ie.js.Localizer.localize("FragmentMaker.deleted_account")),a},ie.mediator.helper.FragmentMaker.groupTalkIconLazy=function(e,t){return ie.mediator.helper.FragmentMaker.groupTalkIcon(e,t)},ie.mediator.helper.FragmentMaker.groupTalkIcon=function(o,s){var e=new ie.js.JQueryBuilder("div").addClass("prof-icon").attr("data-talk-id",ie.Int64Helper.idStr(o.id)),t=new ie.js.JQueryBuilder("div").addClass("img-circle prof-icon-body");if(t.append(new ie.js.JQueryBuilder("div").addClass("prof-icon-dummy").append(new ie.js.JQueryBuilder("span").addClass("dicon dicon-group-talk"))),null!=o&&ie.StringHelper.isNotEmpty(o.iconUrl)){var n=new ie.js.JQueryBuilder("img").addClass("icon-users");null!=o.name&&null==s&&n.attr("alt",ee.htmlEscape(o.name,!0));var l=ie.mediator.helper.FragmentMaker.createIconIdString();n.attr("id",l).addClass("icon-user").addListener(function(e){var t,n,r,a,i=e.find("#"+l);ie.mediator.helper.FileLoadHelper.setupIcon(i,o.iconUrl,s,(r=ie.mediator.helper.FragmentMaker.onSuccessTalkIconLoad,a=i,function(){return r(a)}),(t=ie.mediator.helper.FragmentMaker.onErrorTalkIconLoad,n=i,function(e){return t(n,e)}),new ie.mediator.helper.ResourceRevokerNone)}),t.append(n)}if(e.append(t),o.type==ie.entity.TalkType.GroupTalk){var r=new ie.js.JQueryBuilder("div").addClass("img-circle prof-icon-mini-mark").append(new ie.js.JQueryBuilder("span").addClass("dicon dicon-group-talk"));e.append(r)}return e},ie.mediator.helper.FragmentMaker.onSuccessTalkIconLoad=function(e){var t=e.parent();albero_tools.ImageTools.cropImage(e.get(0),Z.parseInt(t.css("width")),Z.parseInt(t.css("height"))),t.find(".prof-icon-dummy").remove()},ie.mediator.helper.FragmentMaker.onErrorTalkIconLoad=function(e,t){albero_tools.ImageTools.clearCrop(e.get(0))},ie.mediator.helper.FragmentMaker.talkName=function(e){if(null==e)return new ie.js.JQueryBuilder;var t=new ie.js.JQueryBuilder("span").addClass("talk-name"),n=!1;if(null!=e.name&&0<e.name.length)t.text(e.name);else{for(var r=!0,a=ie.mediator.helper.FragmentMaker.getDataStore(),i=0,o=e.userIds;i<o.length;){var s=o[i];if(++i,null==a.me||!ie.Int64Helper.eq(a.me.id,s)){r||t.append(", "),r=!1;var l=a.getUser(e.domainId,s);null!=l&&t.append(ie.ViewAttrs.attrUser(new ie.js.JQueryBuilder("span").addClass("username"),l).text(l.displayName))}}r&&(t.append(ie.js.Localizer.localize("FragmentMaker.no_talk_member")),n=!0)}return e.type!=ie.entity.TalkType.GroupTalk||n||t.append(new ie.js.JQueryBuilder("span").addClass("talker-count").append("("+e.userIds.length+")")),t},ie.mediator.helper.FragmentMaker.talkNameAbbrebiate=function(t,e,n,r){if(null==r&&(r=15),null==n&&(n=!0),null==t)return new ie.js.JQueryBuilder;var a=new ie.js.JQueryBuilder("div").addClass("talk-name"),i=new ie.js.JQueryBuilder("div").addClass("talk-name-part"),o=!1;if(null!=e&&i.append(e),null!=t.name&&0<t.name.length)i.text(t.name);else{var s=ie.mediator.helper.FragmentMaker.getDataStore(),l=t.userIds.filter(function(e){return!(null!=s.me&&ie.Int64Helper.eq(s.me.id,e))}).map(function(e){return s.getUser(t.domainId,e)}).filter(function(e){return null!=e});if(0==l.length)i.text(ie.js.Localizer.localize("FragmentMaker.no_talk_member")),o=!0;else for(var c=0,u=l.length;c<u;){var d=c++;0!=d&&i.append(", ");var p=l[d];i.append(ie.ViewAttrs.attrUser(new ie.js.JQueryBuilder("span").addClass("username"),p).text(p.displayName))}}if(a.append(i),t.type==ie.entity.TalkType.GroupTalk&&!o&&n){var m="("+t.userIds.length+")";a.append(new ie.js.JQueryBuilder("div").addClass("talker-count-part").text(m)),null==a.listeners&&(a.listeners=new Array),a.listeners.push(function(e){var t=ie.mediator.helper.TextWidthGetter.calcMonospacedTextWidth(m,r);e.find(".talk-name-part").css({marginRight:-t+"px",paddingRight:t+"px"})})}return a},ie.mediator.helper.FragmentMaker.taskLabel=function(e,t,n){var r=[];if(n){var a=new ie.js.JQueryBuilder("span").addClass("label label-danger").text(ie.js.Localizer.localize("FragmentMaker.close"));r.push(a)}var i=new ie.js.JQueryBuilder("span").addClass("label label-primary");switch(e[1]){case 11:i.append(ie.js.Localizer.localize("FragmentMaker.task"));break;case 7:i.append("Yes/No");break;case 9:i.append(ie.js.Localizer.localize("FragmentMaker.select"))}if(r.push(i),te.enumEq(t,ie.entity.QuestionClosingType.any)){var o=new ie.js.JQueryBuilder("span").addClass("label label-primary").text(ie.js.Localizer.localize("FragmentMaker.number_1"));r.push(o)}if(1==r.length)return r[0];for(var s=new ie.js.JQueryBuilder("span").addClass("labels"),l=0;l<r.length;){var c=r[l];++l,s.append(c)}return s},ie.mediator.helper.FragmentMaker.setBadge=function(e,t){var n=e.children(".corner-badge");return t<=0?n.remove():0==n.length?e.append(ie.mediator.helper.FragmentMaker.createBadgeBuilder(t).build()):n.text(null==t?"null":""+t),n},ie.mediator.helper.FragmentMaker.createBadgeBuilder=function(e){return new ie.js.JQueryBuilder("span").addClass("corner-badge").text(null==e?"null":""+e)},ie.mediator.helper.MessageHelper=function(){},n["albero.mediator.helper.MessageHelper"]=ie.mediator.helper.MessageHelper,ie.mediator.helper.MessageHelper.__name__=["albero","mediator","helper","MessageHelper"],ie.mediator.helper.MessageHelper.getDisplayTextWithoutEscape=function(e,t){switch(e[1]){case 1:return t;case 6:return ie.mediator.helper.MessageHelper.getDeletedText();default:return se._e(se.dateStr(),"Unsupported message.type is detected.",e,"","",""),ie.mediator.helper.MessageHelper.getUnsupportText()}},ie.mediator.helper.MessageHelper.getDeletedText=function(){return ie.js.Localizer.localize("MessageHelper.deleted")},ie.mediator.helper.MessageHelper.getUnsupportText=function(){return ie.js.Localizer.localize("MessageHelper.not_support")},ie.mediator.helper.MessageHelper.getMessageTextWithoutEscape=function(e){if(null==e)return"";switch(e.type[1]){case 1:return e.content;case 6:return ie.mediator.helper.MessageHelper.getDeletedText();case 2:case 5:return null==e.content.text?"":e.content.text;case 7:var t=[ie.js.Localizer.localize("MessageHelper.yes"),ie.js.Localizer.localize("MessageHelper.no")].join("\n");return ie.mediator.helper.QuestionHelper.getQuestionTitle(e)+"\n--\n"+t;case 9:var n;return n=null==e.content.options?"":e.content.options.join("\n"),ie.mediator.helper.QuestionHelper.getQuestionTitle(e)+"\n--\n"+n;case 11:var r=ie.js.Localizer.localize("MessageHelper.achieve");return ie.mediator.helper.QuestionHelper.getQuestionTitle(e)+"\n--\n"+r;case 8:var a;return a=e.content.response?ie.js.Localizer.localize("MessageHelper.yes"):ie.js.Localizer.localize("MessageHelper.no"),">"+ie.mediator.helper.QuestionHelper.getQuestionTitle(e)+"\n"+a;case 10:var i;return i=null==e.content.options&&null==e.content.response?"":e.content.options[e.content.response],">"+ie.mediator.helper.QuestionHelper.getQuestionTitle(e)+"\n"+i;case 12:var o;return o=e.content.done?ie.js.Localizer.localize("MessageHelper.achieve"):ie.js.Localizer.localize("MessageHelper.remand"),">"+ie.mediator.helper.QuestionHelper.getQuestionTitle(e)+"\n"+o;case 13:return">"+ie.mediator.helper.QuestionHelper.getQuestionTitle(e)+"\n"+ie.mediator.helper.QuestionHelper.getChoiceCloseResponse(e,function(e){return"YES"==e?ie.js.Localizer.localize("MessageHelper.yes"):ie.js.Localizer.localize("MessageHelper.no")});case 14:return">"+ie.mediator.helper.QuestionHelper.getQuestionTitle(e)+"\n"+ie.mediator.helper.QuestionHelper.getChoiceCloseResponse(e,function(e){return e});case 15:return">"+ie.mediator.helper.QuestionHelper.getQuestionTitle(e)+"\n"+ie.mediator.helper.QuestionHelper.getTodoCloseResponse(e);default:return""}},ie.mediator.helper.MessageHelper.copyMessageToClipboard=function(e){var t=window.document,n=t.createElement("textarea");n.value=ie.mediator.helper.MessageHelper.getMessageTextWithoutEscape(e);var r=n.style;r.opacity="0",r.position="fixed",t.body.appendChild(n),n.focus(),n.select();var a=t.execCommand("copy",!1);return n.blur(),t.body.removeChild(n),a},ie.mediator.helper.MessageStringMaker=function(){},n["albero.mediator.helper.MessageStringMaker"]=ie.mediator.helper.MessageStringMaker,ie.mediator.helper.MessageStringMaker.__name__=["albero","mediator","helper","MessageStringMaker"],ie.mediator.helper.MessageStringMaker.messageString=function(e,t,n){var r,a;switch(a=null!=(r=t.type==ie.entity.MessageType.system?null:n.getUser(e,t.userId))?r.displayName:"",t.type[1]){case 0:return ie.mediator.helper.SystemMessageParser.parse(t.content).buildText(new ie.mediator.helper.SystemMessageBuildContext(e,t.talkId,n));case 1:return a+""+Z.string(t.content);case 3:return a+ie.js.Localizer.localize("MessageStringMaker.space_send_position");case 4:return a+ie.js.Localizer.localize("MessageStringMaker.space_send_attachment_file");case 5:return null!=t.content.text&&0<t.content.text.length?a+ie.js.Localizer.localize("MessageStringMaker.colon_attachment_file")+Z.string(t.content.text):a+ie.js.Localizer.localize("MessageStringMaker.space_send_attachment_file");case 2:return null!=t.content.text&&0<t.content.text.length?a+ie.js.Localizer.localize("MessageStringMaker.colon_stamp")+Z.string(t.content.text):a+ie.js.Localizer.localize("MessageStringMaker.space_send_stamp");case 7:case 9:return a+""+ie.js.Localizer.localize("MessageStringMaker.question_space")+Z.string(t.content.question);case 8:case 10:return a+ie.js.Localizer.localize("MessageStringMaker.space_answer_question");case 11:return a+""+ie.js.Localizer.localize("MessageStringMaker.task")+Z.string(t.content.title);case 12:return t.content.done?a+ie.js.Localizer.localize("MessageStringMaker.space_achieve_task"):a+ie.js.Localizer.localize("MessageStringMaker.space_remand_task");case 13:case 14:return a+ie.js.Localizer.localize("MessageStringMaker.space_close_answer");case 15:return a+ie.js.Localizer.localize("MessageStringMaker.space_close_task");default:return a+ie.js.Localizer.localize("MessageStringMaker.space_send_message")}},ie.mediator.helper.MessageStringMaker.messageStringForSummary=function(e,t,n,r){var a="",i="";if(null!=t)switch(t.type[1]){case 0:var o=ie.mediator.helper.SystemMessageParser.parse(t.content).buildText(new ie.mediator.helper.SystemMessageBuildContext(e,t.talkId,r));return new ie.js.JQueryBuilder("span").text(o);case 1:i=t.content;break;case 3:a=ie.js.Localizer.localize("MessageStringMaker.send_position");break;case 4:a=ie.js.Localizer.localize("MessageStringMaker.send_attachment_file");break;case 5:null!=t.content.text&&0<t.content.text.length?(a=ie.js.Localizer.localize("MessageStringMaker.attachment_file"),i=t.content.text):a=ie.js.Localizer.localize("MessageStringMaker.send_attachment_file");break;case 6:a=ie.js.Localizer.localize("MessageStringMaker.deleted");break;case 2:null!=t.content.text&&0<t.content.text.length?(a=ie.js.Localizer.localize("MessageStringMaker.stamp"),i=t.content.text):a=ie.js.Localizer.localize("MessageStringMaker.send_stamp");break;case 7:case 9:a=ie.js.Localizer.localize("MessageStringMaker.question"),i=t.content.question;break;case 8:case 10:a=ie.js.Localizer.localize("MessageStringMaker.answer_question");break;case 11:a=ie.js.Localizer.localize("MessageStringMaker.task"),i=t.content.title;break;case 12:a=t.content.done?ie.js.Localizer.localize("MessageStringMaker.achieve_task"):ie.js.Localizer.localize("MessageStringMaker.remand_task");break;case 13:case 14:a=ie.js.Localizer.localize("MessageStringMaker.close_answer");break;case 15:a=ie.js.Localizer.localize("MessageStringMaker.close_task");break;default:a=""}var s=new ie.js.JQueryBuilder("span");return 0!=a.length&&s.append(new ie.js.JQueryBuilder("span").append(ie.mediator.helper.MessageStringMaker.createTextWithoutLinking(a))),0!=i.length&&s.append(new ie.js.JQueryBuilder("span").addClass(n).append(ie.mediator.helper.MessageStringMaker.createTextWithoutLinking(i))),s},ie.mediator.helper.MessageStringMaker.messageStringForKeywordDetection=function(e,t){if(null==e)return"";switch(e.type[1]){case 0:return"";case 1:return e.content;case 3:case 4:return"";case 5:return null!=e.content.text&&0<e.content.text.length?e.content.text:"";case 6:return"";case 2:return null!=e.content.text&&0<e.content.text.length?e.content.text:"";case 7:return[e.content.question,ie.js.Localizer.localize("MessageStringMaker.yes"),ie.js.Localizer.localize("MessageStringMaker.no")].join(" ");case 9:return null!=e.content.options?Z.string(e.content.question)+" "+Z.string(e.content.options.join(" ")):e.content.question;case 11:return[e.content.title,ie.js.Localizer.localize("MessageStringMaker.achieve"),ie.js.Localizer.localize("MessageStringMaker.remand")].join(" ");case 8:return t&&null!=e.content.response?e.content.response?ie.js.Localizer.localize("MessageStringMaker.yes"):ie.js.Localizer.localize("MessageStringMaker.no"):"";case 10:return t&&null!=e.content.response&&null!=e.content.options&&e.content.options.length>e.content.response?e.content.options[e.content.response]:"";case 12:return t&&null!=e.content.done?e.content.done?ie.js.Localizer.localize("MessageStringMaker.achieve"):ie.js.Localizer.localize("MessageStringMaker.remand"):"";case 13:case 14:case 15:default:return""}},ie.mediator.helper.MessageStringMaker.createText=function(e){if(null==e)return null;var t=ie.mediator.helper.MessageStringMaker.emoji(ie.mediator.helper.MessageStringMaker.linking(e));return ee.endsWith(t,"\n")&&(t+="\n"),t},ie.mediator.helper.MessageStringMaker.createTextWithoutLinking=function(e){if(null==e)return null;var t=ie.mediator.helper.MessageStringMaker.emoji(ee.htmlEscape(e,!0));return ee.endsWith(t,"\n")&&(t+="\n"),t},ie.mediator.helper.MessageStringMaker.emoji=function(e){return new o("\\{p:(\\d+)\\}","g").replace(e,"<img class='emoji' src='images/emoji/$1.gif'>")},ie.mediator.helper.MessageStringMaker.linking=function(e){return twttr.txt.autoLinkUrlsCustom(e,{targetBlank:!0,htmlEscapeNonEntities:!0})},ie.mediator.helper.QuestionHelper=function(){},n["albero.mediator.helper.QuestionHelper"]=ie.mediator.helper.QuestionHelper,ie.mediator.helper.QuestionHelper.__name__=["albero","mediator","helper","QuestionHelper"],ie.mediator.helper.QuestionHelper.createQuestionBody=function(e,t,n,r,a,i,o){var s=(i?"action-page-question-body-":"question-body-")+ie.Int64Helper.idStr(e.id),l=new ie.js.JQueryBuilder("div").addClass("panel panel-default").id(s).addClass("panel-collapse collapse").addClass(a?"":"in"),c=new ie.js.JQueryBuilder("div").addClass("panel-heading");ie.ViewAttrs.attrUser(new ie.js.JQueryBuilder("span").addClass("question-creator"),r).text(r.displayName).addClass("has-user-dialog");c.append(new ie.js.JQueryBuilder("div").addClass("question-property").append(ie.js.Localizer.localize("QuestionHelper.create_date")).append(ie.DateTimeHelper.datetimeString(e.createdAt))),c.append(new ie.js.JQueryBuilder("div").addClass("question-property").append(ie.js.Localizer.localize("QuestionHelper.update_date")).append(ie.DateTimeHelper.datetimeString(e.updatedAt))),l.append(c);var u=i,d=new ie.js.JQueryBuilder("div").addClass("panel-body");return ae.iter(ie.mediator.helper.QuestionHelper.createAnswers(e),function(e){d.append(ie.mediator.helper.QuestionHelper.createQuestionAnswer(t,n,e,u,o))}),l.append(d),l},ie.mediator.helper.QuestionHelper.createAnswers=function(r){var a=[];switch(r.type[1]){case 11:if(te.enumEq(r.closingType,ie.entity.QuestionClosingType.any))ie.OptionHelper.foreach(r.getLastDoneResponse(),function(e){a.push(new ie.mediator.helper.AnswerForView(ie.js.Localizer.localize("QuestionHelper.achieve"),[r.lastResponseUserId],!1))}),a.push(new ie.mediator.helper.AnswerForView(ie.js.Localizer.localize("QuestionHelper.target"),r.recipientIds,!0));else{var e,t=ie.OptionHelper.map(r.getDoneResponse(),function(e){return e.userIds});switch(t[1]){case 0:e=t[2];break;case 1:e=[]}a.push(new ie.mediator.helper.AnswerForView(ie.js.Localizer.localize("QuestionHelper.achieve"),e,!0));var n=r.recipientIds.slice();if(null!=e)for(var i=0;i<e.length;){var o=e[i];++i,ie.Int64Helper.remove(n,o)}a.push(new ie.mediator.helper.AnswerForView(ie.js.Localizer.localize("QuestionHelper.not_achieve"),n,!0))}break;case 7:case 9:if(te.enumEq(r.closingType,ie.entity.QuestionClosingType.any))ie.OptionHelper.foreach(r.getLastResponse(),function(e){var t=[r.lastResponseUserId],n=ie.mediator.helper.QuestionHelper.getResponseTitle(r,e);a.push(new ie.mediator.helper.AnswerForView(n,t,!1))}),a.push(new ie.mediator.helper.AnswerForView(ie.js.Localizer.localize("QuestionHelper.target"),r.recipientIds,!0));else{for(var s=0,l=r.responses;s<l.length;){var c=l[s];++s;var u=ie.mediator.helper.QuestionHelper.getResponseTitle(r,c);a.push(new ie.mediator.helper.AnswerForView(u,c.userIds,!0))}a.push(new ie.mediator.helper.AnswerForView(ie.js.Localizer.localize("QuestionHelper.target"),r.recipientIds,!0))}break;default:se._e(se.dateStr(),"invalid question.type",r.type,"","","")}return a},ie.mediator.helper.QuestionHelper.getResponseTitle=function(e,t){switch(e.type[1]){case 7:return"YES"==t.content?ie.js.Localizer.localize("QuestionHelper.yes"):ie.js.Localizer.localize("QuestionHelper.no");default:return t.content}},ie.mediator.helper.QuestionHelper.createQuestionAnswer=function(e,t,n,r,a){var i=new ie.js.JQueryBuilder;i.append(new ie.js.JQueryBuilder("div").addClass("question-answer").text(n.getAnswerTitle()));var o=new ie.js.JQueryBuilder("div").addClass("question-answerers collapse");return n.hasUser()?o.append(new ie.js.JQueryBuilder("div").addClass("question-no-answerer small").text(ie.js.Localizer.localize("QuestionHelper.no_answerer"))):o.addClass("question-answerers-delaying"),i.append(o),i},ie.mediator.helper.QuestionHelper.assureAnswerers=function(e,t,n,r,a){var i=e.next(".question-answerers");if(i.hasClass("question-answerers-delaying")){var o=e.prevAll(".question-answer").length,s=i.closest(".question-box"),l=ie.Int64Helper.makeFromIdStr(s.attr("data-question-id")),c=t.getQuestion(l);if(null!=c){var u=ie.mediator.helper.QuestionHelper.createAnswers(c),d=new ie.js.JQueryBuilder;ae.iter(u[o].getSortedUsers(t,n),function(e){d.append(ie.mediator.helper.QuestionHelper.createAnswerer(e,r,a))}),i.append(d.build()).removeClass("question-answerers-delaying")}}},ie.mediator.helper.QuestionHelper.createAnswerer=function(e,t,n){var r=ie.ViewAttrs.attrUser(new ie.js.JQueryBuilder("div").addClass("question-answerer"),e),a=ie.ViewAttrs.attrUser(new ie.js.JQueryBuilder("small").addClass("username").text(e.displayName),e).addClass("has-user-dialog");t&&r.addClass("question-answerer-inline");var i=new ie.mediator.helper.UserIconBuilder(e).addCircleClip().addDialog().addLazyloadOption(n).build().addClass("prof-icon-left-of-username");return r.append(i).append(a),r},ie.mediator.helper.QuestionHelper.createQuestionOperations=function(e,t,n){var r=new ie.js.JQueryBuilder("div").addClass("question-operations");if(n&&r.addClass("hide"),!e.closed)switch(e.type[1]){case 11:e.isCompleted(t.me.id)?r.append(ie.mediator.helper.ButtonMaker.createPrimaryButton().addClass("is-todo-done-trigger").attr("data-done","undone").text(ie.js.Localizer.localize("QuestionHelper.remand"))):r.append(ie.mediator.helper.ButtonMaker.createPrimaryButton().addClass("is-todo-done-trigger").attr("data-done","done").text(ie.js.Localizer.localize("QuestionHelper.achieve")));break;case 7:r.append(ie.mediator.helper.ButtonMaker.createPrimaryButton().addClass("is-yes-or-no-trigger").attr("data-yes-or-no","yes").text(ie.js.Localizer.localize("QuestionHelper.yes"))),r.append(ie.mediator.helper.ButtonMaker.createPrimaryButton().addClass("is-yes-or-no-trigger").attr("data-yes-or-no","no").text(ie.js.Localizer.localize("QuestionHelper.no")));break;case 9:r.append(ie.mediator.helper.ButtonMaker.createPrimaryButton().addClass("has-select-one-dialog").text(ie.js.Localizer.localize("QuestionHelper.answer")));break;default:se._e(se.dateStr(),"question type is not valid.","","","","")}return null!=t.me&&ie.Int64Helper.eq(t.me.id,e.userId)&&!e.closed&&r.append(ie.mediator.helper.ButtonMaker.createWarningButton().addClass("has-action-close-dialog").text(ie.js.Localizer.localize("QuestionHelper.close"))),r},ie.mediator.helper.QuestionHelper.getQuestionTitle=function(e){var t=e.content;if(null!=t.title)return t.title;switch(e.type[1]){case 7:case 9:case 8:case 10:case 13:case 14:return null==t.question?"":t.question;case 11:case 12:case 15:return null==t.title?"":t.title;default:return se._e(se.dateStr(),"message type is not action.","","","",""),""}},ie.mediator.helper.QuestionHelper.getChoiceCloseResponse=function(e,a){var t=e.content,n=ie.js.Localizer.localize("QuestionHelper.close_answer");if(null==t.responses)n+="...";else{var i=t.responses,r=t.last_response;switch(ie.entity.Question.closeingTypeOf(t.closing_type)[1]){case 0:n+=null!=r?ie.js.Localizer.localize("QuestionHelper.last_response",{content:a(i[r].content)}):ie.js.Localizer.localize("QuestionHelper.no_answer");break;default:n+=null!=r?function(){var e=ie.js.Localizer.localize("QuestionHelper.result");if(null!=i)for(var t=0;t<i.length;){var n,r=i[t];++t,n=null==r.count?0:r.count,e+="\n"+a(r.content)+": "+n+ie.js.Localizer.localize("QuestionHelper.name")}return e}():ie.js.Localizer.localize("QuestionHelper.no_answer")}}return n},ie.mediator.helper.QuestionHelper.getTodoCloseResponse=function(e){var t=e.content,n=ie.js.Localizer.localize("QuestionHelper.close_answer");if(null==t.responses)n+="...";else{var r=t.responses,a=t.last_response;switch(ie.entity.Question.closeingTypeOf(t.closing_type)[1]){case 0:n+=null!=a&&"DONE"==r[a].content?ie.js.Localizer.localize("QuestionHelper.achieve_task"):ie.js.Localizer.localize("QuestionHelper.not_achieve_task");break;default:var i=0;if(null!=r)for(var o=0;o<r.length;){var s=r[o];if(++o,"DONE"==s.content){i=null==s.count?0:s.count;break}}n+=0!=i?""+ie.js.Localizer.localize("QuestionHelper.result_achieve")+i+ie.js.Localizer.localize("QuestionHelper.name"):ie.js.Localizer.localize("QuestionHelper.no_answer")}}return n},ie.mediator.helper.Resources=function(){this.blobLoadIntegrator=new ie.mediator.helper.BlobLoadIntegrator,this.caches=new oe.ds.StringMap},n["albero.mediator.helper.Resources"]=ie.mediator.helper.Resources,ie.mediator.helper.Resources.__name__=["albero","mediator","helper","Resources"],ie.mediator.helper.Resources.getInstance=function(){return null==ie.mediator.helper.Resources.instance&&(ie.mediator.helper.Resources.instance=new ie.mediator.helper.Resources),ie.mediator.helper.Resources.instance},ie.mediator.helper.Resources.prototype={createBlobUrl:function(n,e,t,r,a,i){var o=this;if(null!=n)if(ee.startsWith(n,"blob:"))r(n);else{if(this.caches.exists(n)){var s=this.caches.get(n);return s.setRemoveSkipping(),void r(s.getObjectUrl())}var l=this.blobLoadIntegrator.isReserved(n);this.blobLoadIntegrator.reserve(n,r,a),l||this.createBlobReliable(n,e,t,function(e){var t=new ie.mediator.helper.Resource(e);o.caches.set(n,t),o.blobLoadIntegrator.onLoad(n,t.getObjectUrl()),null==i&&(i=new ie.mediator.helper.ResourceRevokerAuto),i.setCaches(o.caches),i.registerUrl(n)},function(e){o.blobLoadIntegrator.onError(n,e)},0)}else a("url is null.")},createBlobReliable:function(t,n,r,a,i,o){var s=this;this.createBlob(t,n,r,a,function(e){o<3?s.createBlobReliable(t,n,r,a,i,o+1):i(e)})},createBlob:function(e,t,n,r,a){null!=e?this.asyncCreateDownloadAuth(e,t,n,function(e){ie.mediator.helper.FileLoaderCommon.loadAsBlob(e.url,e.headers,r,a)}):a("url is null.")},asyncCreateDownloadAuth:function(e,t,n,r){var a,i;ie.AppFacade.getInstance().sendNotification("File",ie.command.FileAction.AUTH(e,t,n,r,(p=this.blobLoadIntegrator,a=_(p,p.onError),i=e,function(e){return a(i,e)})))},__class__:ie.mediator.helper.Resources},ie.mediator.helper.BlobLoadIntegrator=function(){this.listenersMap=new oe.ds.StringMap},n["albero.mediator.helper.BlobLoadIntegrator"]=ie.mediator.helper.BlobLoadIntegrator,ie.mediator.helper.BlobLoadIntegrator.__name__=["albero","mediator","helper","BlobLoadIntegrator"],ie.mediator.helper.BlobLoadIntegrator.prototype={reserve:function(e,t,n){this.isReserved(e)||this.listenersMap.set(e,[]),this.listenersMap.get(e).push(new ie.mediator.helper.BlobLoadListener(t,n))},onLoad:function(e,t){var n,r;ae.iter((n=this,r=ie.OptionHelper.option(n.listenersMap.get(e)),function(e){var t;switch(r[1]){case 0:t=r[2];break;case 1:t=[]}return t}()),function(e){e.onLoad(t)}),this.listenersMap.remove(e)},onError:function(e,t){var n,r;ae.iter((n=this,r=ie.OptionHelper.option(n.listenersMap.get(e)),function(e){var t;switch(r[1]){case 0:t=r[2];break;case 1:t=[]}return t}()),function(e){e.onError(t)}),this.listenersMap.remove(e)},isReserved:function(e){return this.listenersMap.exists(e)},__class__:ie.mediator.helper.BlobLoadIntegrator},ie.mediator.helper.BlobLoadListener=function(e,t){this.onLoad=e,this.onError=t},n["albero.mediator.helper.BlobLoadListener"]=ie.mediator.helper.BlobLoadListener,ie.mediator.helper.BlobLoadListener.__name__=["albero","mediator","helper","BlobLoadListener"],ie.mediator.helper.BlobLoadListener.prototype={__class__:ie.mediator.helper.BlobLoadListener},ie.mediator.helper.FileLoaderCommon=function(){},n["albero.mediator.helper.FileLoaderCommon"]=ie.mediator.helper.FileLoaderCommon,ie.mediator.helper.FileLoaderCommon.__name__=["albero","mediator","helper","FileLoaderCommon"],ie.mediator.helper.FileLoaderCommon.loadAsBlob=function(e,t,n,r){ie.mediator.helper.FileLoaderCommon.load(e,t,"blob",n,r)},ie.mediator.helper.FileLoaderCommon.loadAsArrayBuffer=function(e,t,n,r){ie.mediator.helper.FileLoaderCommon.load(e,t,"arraybuffer",n,r)},ie.mediator.helper.FileLoaderCommon.load=function(e,t,n,r,a){var i=new XMLHttpRequest;i.open("GET",e),null!=t&&(null!=t.authorization&&i.setRequestHeader("Authorization",t.authorization),null!=t.xAmzDate&&i.setRequestHeader("x-amz-date",t.xAmzDate),null!=t.xAmzSecurityToken&&i.setRequestHeader("x-amz-security-token",t.xAmzSecurityToken)),i.onload=function(e){r(e.target.response)},i.onerror=function(e){a(e)},i.responseType=n,i.send()},ie.mediator.helper.Resource=function(e){this.objectUrl=URL.createObjectURL(e),this.removeSkipping=!1},n["albero.mediator.helper.Resource"]=ie.mediator.helper.Resource,ie.mediator.helper.Resource.__name__=["albero","mediator","helper","Resource"],ie.mediator.helper.Resource.prototype={isRemoveSkipping:function(){return this.removeSkipping},setRemoveSkipping:function(){this.removeSkipping=!0},resetRemoveSkipping:function(){this.removeSkipping=!1},getObjectUrl:function(){return this.objectUrl},__class__:ie.mediator.helper.Resource},ie.mediator.helper.ResourceRevoker=function(){},n["albero.mediator.helper.ResourceRevoker"]=ie.mediator.helper.ResourceRevoker,ie.mediator.helper.ResourceRevoker.__name__=["albero","mediator","helper","ResourceRevoker"],ie.mediator.helper.ResourceRevoker.prototype={__class__:ie.mediator.helper.ResourceRevoker},ie.mediator.helper.ResourceRevokerUtil=function(){},n["albero.mediator.helper.ResourceRevokerUtil"]=ie.mediator.helper.ResourceRevokerUtil,ie.mediator.helper.ResourceRevokerUtil.__name__=["albero","mediator","helper","ResourceRevokerUtil"],ie.mediator.helper.ResourceRevokerUtil.asyncRevokeFile=function(t,n){oe.Timer.delay(function(){if(t.exists(n)){var e=t.get(n);e.isRemoveSkipping()?(e.resetRemoveSkipping(),ie.mediator.helper.ResourceRevokerUtil.asyncRevokeFile(t,n)):(t.remove(n),URL.revokeObjectURL(e.getObjectUrl()))}},ie.mediator.helper.ResourceRevokerUtil.OBJECT_URL_LIFE_TIME)},ie.mediator.helper.ResourceRevokerAuto=function(){},n["albero.mediator.helper.ResourceRevokerAuto"]=ie.mediator.helper.ResourceRevokerAuto,ie.mediator.helper.ResourceRevokerAuto.__name__=["albero","mediator","helper","ResourceRevokerAuto"],ie.mediator.helper.ResourceRevokerAuto.__interfaces__=[ie.mediator.helper.ResourceRevoker],ie.mediator.helper.ResourceRevokerAuto.prototype={setCaches:function(e){this.caches=e},registerUrl:function(e){this.originalUrl=e,ie.mediator.helper.ResourceRevokerUtil.asyncRevokeFile(this.caches,e)},revoke:function(){},__class__:ie.mediator.helper.ResourceRevokerAuto},ie.mediator.helper.ResourceRevokerManual=function(){this.revokeTargetUrls=[]},n["albero.mediator.helper.ResourceRevokerManual"]=ie.mediator.helper.ResourceRevokerManual,ie.mediator.helper.ResourceRevokerManual.__name__=["albero","mediator","helper","ResourceRevokerManual"],ie.mediator.helper.ResourceRevokerManual.__interfaces__=[ie.mediator.helper.ResourceRevoker],ie.mediator.helper.ResourceRevokerManual.prototype={setCaches:function(e){this.caches=e},registerUrl:function(e){this.revokeTargetUrls.push(e)},revoke:function(){var n=this;ae.iter(this.revokeTargetUrls,function(e){if(n.caches.exists(e)){var t=n.caches.get(e);n.caches.remove(e),URL.revokeObjectURL(t.getObjectUrl())}}),this.revokeTargetUrls=[]},__class__:ie.mediator.helper.ResourceRevokerManual},ie.mediator.helper.ResourceRevokerNone=function(){this.revokeTargetUrls=[]},n["albero.mediator.helper.ResourceRevokerNone"]=ie.mediator.helper.ResourceRevokerNone,ie.mediator.helper.ResourceRevokerNone.__name__=["albero","mediator","helper","ResourceRevokerNone"],ie.mediator.helper.ResourceRevokerNone.__interfaces__=[ie.mediator.helper.ResourceRevoker],ie.mediator.helper.ResourceRevokerNone.prototype={setCaches:function(e){},registerUrl:function(e){},revoke:function(){},__class__:ie.mediator.helper.ResourceRevokerNone},ie.mediator.helper.SystemMessageParser=function(){},n["albero.mediator.helper.SystemMessageParser"]=ie.mediator.helper.SystemMessageParser,ie.mediator.helper.SystemMessageParser.__name__=["albero","mediator","helper","SystemMessageParser"],ie.mediator.helper.SystemMessageParser.parse=function(e){switch(e.type){case"add_talkers":return new ie.mediator.helper.SystemMessageContentsAddTalkers(e);case"delete_talker":return new ie.mediator.helper.SystemMessageContentsDeleteTalker(e);case"hide_pair_talk":return new ie.mediator.helper.SystemMessageContentsHidePairTalk(e);case"update_group_talk":return new ie.mediator.helper.SystemMessageContentsUpdateGroupTalk(e);default:return new ie.mediator.helper.SystemMessageContentsUnknown}},ie.mediator.helper.SystemMessageBuildContext=function(e,t,n){this.domainId=e,this.talkId=t,this.dataStore=n},n["albero.mediator.helper.SystemMessageBuildContext"]=ie.mediator.helper.SystemMessageBuildContext,ie.mediator.helper.SystemMessageBuildContext.__name__=["albero","mediator","helper","SystemMessageBuildContext"],ie.mediator.helper.SystemMessageBuildContext.prototype={getUserName:function(e){return ie.OptionHelper.map(this.getUser(e),function(e){return e.displayName})},isAllowDisplayPastMessages:function(){var e=ie.OptionHelper.map(ie.OptionHelper.flatMap(this.getTalk(this.talkId),function(e){return e.groupTalkSettings}),function(e){return e.allowDisplayPastMessages});switch(e[1]){case 0:return e[2];case 1:return!1}},getUser:function(e){return null==e?oe.ds.Option.None:ie.OptionHelper.option(this.dataStore.getUser(this.domainId,e))},getTalk:function(e){return null==e?oe.ds.Option.None:ie.OptionHelper.option(this.dataStore.getTalk(e))},__class__:ie.mediator.helper.SystemMessageBuildContext},ie.mediator.helper.ISystemMessageContents=function(){},n["albero.mediator.helper.ISystemMessageContents"]=ie.mediator.helper.ISystemMessageContents,ie.mediator.helper.ISystemMessageContents.__name__=["albero","mediator","helper","ISystemMessageContents"],ie.mediator.helper.ISystemMessageContents.prototype={__class__:ie.mediator.helper.ISystemMessageContents},ie.mediator.helper.SystemMessageContentsAddTalkers=function(e){this.userIds=e.added_user_ids,this.addBy=e.added_by},n["albero.mediator.helper.SystemMessageContentsAddTalkers"]=ie.mediator.helper.SystemMessageContentsAddTalkers,ie.mediator.helper.SystemMessageContentsAddTalkers.__name__=["albero","mediator","helper","SystemMessageContentsAddTalkers"],ie.mediator.helper.SystemMessageContentsAddTalkers.__interfaces__=[ie.mediator.helper.ISystemMessageContents],ie.mediator.helper.SystemMessageContentsAddTalkers.prototype={buildText:function(t){var e,n=ie.OptionHelper.map(t.getUserName(this.addBy),function(e){return ie.js.Localizer.localize("SystemMessageParser.operator_part",{operator:e,interpolation:{escapeValue:!1}})});switch(n[1]){case 0:e=n[2];break;case 1:e=""}var r,a=ae.array(ie.LambdaHelper.flatten(this.userIds.map(function(e){return t.getUserName(e)}))).join(ie.js.Localizer.localize("SystemMessageParser.and"));return r=t.isAllowDisplayPastMessages()?ie.js.Localizer.localize("SystemMessageParser.can_see_past_messages"):ie.js.Localizer.localize("SystemMessageParser.cannot_see_past_messages"),ie.js.Localizer.localize("SystemMessageParser.add",{operatorPart:e,addedUsers:a,interpolation:{escapeValue:!1}})+r},getOccurredBy:function(){return this.addBy},isJoiningOrLeavingMessage:function(){return!0},__class__:ie.mediator.helper.SystemMessageContentsAddTalkers},ie.mediator.helper.SystemMessageContentsDeleteTalker=function(e){this.deletedUserId=e.deleted_user_id,this.deletedBy=e.deleted_by},n["albero.mediator.helper.SystemMessageContentsDeleteTalker"]=ie.mediator.helper.SystemMessageContentsDeleteTalker,ie.mediator.helper.SystemMessageContentsDeleteTalker.__name__=["albero","mediator","helper","SystemMessageContentsDeleteTalker"],ie.mediator.helper.SystemMessageContentsDeleteTalker.__interfaces__=[ie.mediator.helper.ISystemMessageContents],ie.mediator.helper.SystemMessageContentsDeleteTalker.prototype={buildText:function(e){var t=e.getUserName(this.deletedUserId);if(ie.OptionHelper.isEmpty(t))return"";var n=e.getUserName(this.deletedBy);if(ie.OptionHelper.isEmpty(n))return ie.js.Localizer.localize("SystemMessageParser.left",{user:ie.OptionHelper.get(t),interpolation:{escapeValue:!1}});var r=ie.js.Localizer.localize("SystemMessageParser.operator_part",{operator:ie.OptionHelper.get(n),interpolation:{escapeValue:!1}});return ie.js.Localizer.localize("SystemMessageParser.to_leave",{operatorPart:r,user:ie.OptionHelper.get(t),interpolation:{escapeValue:!1}})},getOccurredBy:function(){return this.deletedBy},isJoiningOrLeavingMessage:function(){return!0},__class__:ie.mediator.helper.SystemMessageContentsDeleteTalker},ie.mediator.helper.SystemMessageContentsHidePairTalk=function(e){this.userId=e.user_id},n["albero.mediator.helper.SystemMessageContentsHidePairTalk"]=ie.mediator.helper.SystemMessageContentsHidePairTalk,ie.mediator.helper.SystemMessageContentsHidePairTalk.__name__=["albero","mediator","helper","SystemMessageContentsHidePairTalk"],ie.mediator.helper.SystemMessageContentsHidePairTalk.__interfaces__=[ie.mediator.helper.ISystemMessageContents],ie.mediator.helper.SystemMessageContentsHidePairTalk.prototype={buildText:function(e){var t,n=ie.OptionHelper.map(e.getUserName(this.userId),function(e){return ie.js.Localizer.localize("SystemMessageParser.operator_part",{operator:e,interpolation:{escapeValue:!1}})});switch(n[1]){case 0:t=n[2];break;case 1:t=""}return ie.js.Localizer.localize("SystemMessageParser.delete_message_history",{operatorPart:t,interpolation:{escapeValue:!1}})},getOccurredBy:function(){return this.userId},isJoiningOrLeavingMessage:function(){return!0},__class__:ie.mediator.helper.SystemMessageContentsHidePairTalk},ie.mediator.helper.SystemMessageContentsUpdateGroupTalk=function(e){this.oldTalkName=e.old_talk_name,this.newTalkName=e.new_talk_name,this.iconChanged=!!e.icon_changed,this.talkChanged=null!=e.new_talk_name,this.updatedBy=e.updated_by},n["albero.mediator.helper.SystemMessageContentsUpdateGroupTalk"]=ie.mediator.helper.SystemMessageContentsUpdateGroupTalk,ie.mediator.helper.SystemMessageContentsUpdateGroupTalk.__name__=["albero","mediator","helper","SystemMessageContentsUpdateGroupTalk"],ie.mediator.helper.SystemMessageContentsUpdateGroupTalk.__interfaces__=[ie.mediator.helper.ISystemMessageContents],ie.mediator.helper.SystemMessageContentsUpdateGroupTalk.prototype={buildText:function(e){if(!this.iconChanged&&!this.talkChanged)return ie.js.Localizer.localize("SystemMessageParser.not_support");var t,n=ie.OptionHelper.map(e.getUserName(this.updatedBy),function(e){return ie.js.Localizer.localize("SystemMessageParser.operator_part",{operator:e,interpolation:{escapeValue:!1}})});switch(n[1]){case 0:t=n[2];break;case 1:t=""}var r=[];return this.iconChanged&&r.push(this.getIconChangeText(t)),this.talkChanged&&r.push(this.getTalkChangeText(t)),r.join("\n")},getIconChangeText:function(e){return ie.js.Localizer.localize("SystemMessageParser.change_icon",{operatorPart:e,interpolation:{escapeValue:!1}})},getTalkChangeText:function(e){return 0==this.oldTalkName.length&&0==this.newTalkName.length?ie.js.Localizer.localize("SystemMessageParser.not_support"):0==this.oldTalkName.length?ie.js.Localizer.localize("SystemMessageParser.new_talk_name",{operatorPart:e,newTalkName:this.newTalkName,interpolation:{escapeValue:!1}}):0==this.newTalkName.length?ie.js.Localizer.localize("SystemMessageParser.old_talk_name",{operatorPart:e,oldTalkName:this.oldTalkName,interpolation:{escapeValue:!1}}):ie.js.Localizer.localize("SystemMessageParser.new_to_old",{operatorPart:e,newTalkName:this.newTalkName,oldTalkName:this.oldTalkName,interpolation:{escapeValue:!1}})},getOccurredBy:function(){return this.updatedBy},isJoiningOrLeavingMessage:function(){return!1},__class__:ie.mediator.helper.SystemMessageContentsUpdateGroupTalk},ie.mediator.helper.SystemMessageContentsUnknown=function(){},n["albero.mediator.helper.SystemMessageContentsUnknown"]=ie.mediator.helper.SystemMessageContentsUnknown,ie.mediator.helper.SystemMessageContentsUnknown.__name__=["albero","mediator","helper","SystemMessageContentsUnknown"],ie.mediator.helper.SystemMessageContentsUnknown.__interfaces__=[ie.mediator.helper.ISystemMessageContents],ie.mediator.helper.SystemMessageContentsUnknown.prototype={buildText:function(e){return ie.js.Localizer.localize("SystemMessageParser.not_support")},getOccurredBy:function(){return null},isJoiningOrLeavingMessage:function(){return!1},__class__:ie.mediator.helper.SystemMessageContentsUnknown},ie.mediator.helper.TextWidthGetter=function(){},n["albero.mediator.helper.TextWidthGetter"]=ie.mediator.helper.TextWidthGetter,ie.mediator.helper.TextWidthGetter.__name__=["albero","mediator","helper","TextWidthGetter"],ie.mediator.helper.TextWidthGetter.calcMonospacedTextWidth=function(e,t){null==ie.mediator.helper.TextWidthGetter.textWidthMap&&(ie.mediator.helper.TextWidthGetter.textWidthMap=new oe.ds.StringMap);var n=t+"_"+e.length;if(ie.mediator.helper.TextWidthGetter.textWidthMap.exists(n))return ie.mediator.helper.TextWidthGetter.textWidthMap.get(n);var r=new ie.js.JQueryBuilder("span").addClass("measure-item").attr("style","font-size:"+t+"px").text(e).build();new C.JQuery("#measure").append(r);var a=r.width();return oe.Timer.delay(function(){r.remove()},0),ie.mediator.helper.TextWidthGetter.textWidthMap.set(n,a),a},ie.mediator.helper.UserIconBuilder=function(e){this.user=e,this.tooltip=!1,this.circle=!1,this.dialog=!1,this.mentionChooser=!1,this.userPresenceStateOpt=oe.ds.Option.None,this.userPresenceLarge=!1,this.selectedUser=!1},n["albero.mediator.helper.UserIconBuilder"]=ie.mediator.helper.UserIconBuilder,ie.mediator.helper.UserIconBuilder.__name__=["albero","mediator","helper","UserIconBuilder"],ie.mediator.helper.UserIconBuilder.createPresenceMarkOnLargeIcon=function(e){return ie.mediator.helper.UserIconBuilder.createPresenceMarkOnIcon(e).addClass("c-presence__large")},ie.mediator.helper.UserIconBuilder.createPresenceMarkOnIcon=function(e){return ie.mediator.helper.UserIconBuilder.createPresenceMark(e).addClass("c-presence__on_icon")},ie.mediator.helper.UserIconBuilder.createPresenceMark=function(e){switch(e[1]){case 2:return new ie.js.JQueryBuilder("div").addClass("c-presence c-presence__gt_60");case 1:return new ie.js.JQueryBuilder("div").addClass("c-presence c-presence__lt_or_eq_60");case 0:return new ie.js.JQueryBuilder("div").addClass("c-presence c-presence__lt_or_eq_15")}},ie.mediator.helper.UserIconBuilder.onSuccessUserIconLoad=function(e){var t=e.parent();albero_tools.ImageTools.cropImage(e.get(0),Z.parseInt(t.css("width")),Z.parseInt(t.css("height")))},ie.mediator.helper.UserIconBuilder.onErrorUserIconLoad=function(e,t){albero_tools.ImageTools.clearCrop(e.get(0));var n=e.parent(),r=e.attr("data-user-name"),a=ie.Int64Helper.makeFromIdStr(n.attr("data-user-id")),i=ie.mediator.helper.FragmentMaker.createUserInitial(a,r);e.replaceWith(i.build())},ie.mediator.helper.UserIconBuilder.prototype={addTooltip:function(){return this.tooltip=!0,this},addCircleClip:function(){return this.circle=!0,this},addDialog:function(){return this.dialog=!0,this},addMentionChooser:function(){return this.mentionChooser=!0,this},addLazyloadOption:function(e){return this.lazyloadOptions=e,this},addPresenceState:function(e){return this.userPresenceStateOpt=oe.ds.Option.Some(e),this},addPresenceLarge:function(){return this.userPresenceLarge=!0,this},addSelectedUser:function(){return this.selectedUser=!0,this},build:function(){var e,o=this,t=new ie.js.JQueryBuilder("div").addClass("prof-icon"),n=new ie.js.JQueryBuilder("div").addClass("prof-icon-body");if(this.circle&&n.addClass("img-circle"),n.attr("data-user-id",this.user.id),C.Boot.__instanceof(this.user,ie.entity.DomainUser)&&n.attr("data-domain-id",C.Boot.__cast(this.user,ie.entity.DomainUser).domainId),this.tooltip&&n.addClass("has-username-tooltip"),this.dialog&&n.addClass("has-user-dialog"),this.mentionChooser&&n.addClass(ie.mediator.helper.UserIconBuilder.MENTION_CHOICE),this.selectedUser&&n.addClass("selected-user-icon"),null!=this.user)if(null!=this.user.profileImageUrl&&0<this.user.profileImageUrl.length){var s=ie.mediator.helper.FragmentMaker.createIconIdString();e=new ie.js.JQueryBuilder("img").attr("id",s).addClass("icon-user"),null!=this.user.displayName&&e.attr("data-user-name",this.user.displayName),null==n.listeners&&(n.listeners=new Array),n.listeners.push(function(e){var t,n,r,a,i=e.find("#"+s);ie.mediator.helper.FileLoadHelper.setupIcon(i,o.user.profileImageUrl,o.lazyloadOptions,(r=ie.mediator.helper.UserIconBuilder.onSuccessUserIconLoad,a=i,function(){return r(a)}),(t=ie.mediator.helper.UserIconBuilder.onErrorUserIconLoad,n=i,function(e){return t(n,e)}),new ie.mediator.helper.ResourceRevokerNone)})}else e=ie.mediator.helper.FragmentMaker.createUserInitial(this.user.id,this.user.displayName);else(e=new ie.js.JQueryBuilder("img").addClass("icon-user")).attr("src",albero_tools.ImageTools.getBlankImage());return n.append(e),t.append(n),ie.OptionHelper.foreach(ie.OptionHelper.map(this.userPresenceStateOpt,ie.mediator.helper.UserIconBuilder.createPresenceMarkOnIcon),function(e){o.userPresenceLarge&&e.addClass("c-presence__large"),t.append(e)}),t},__class__:ie.mediator.helper.UserIconBuilder},ie.mediator.helper.UserViewHelper=function(){},n["albero.mediator.helper.UserViewHelper"]=ie.mediator.helper.UserViewHelper,ie.mediator.helper.UserViewHelper.__name__=["albero","mediator","helper","UserViewHelper"],ie.mediator.helper.UserViewHelper.profileValuesInListView=function(e,t,n,r){var a=new ie.js.JQueryBuilder("span"),i=!1,o=ie.mediator.helper.UserViewHelper.getProfileOneLineText(e.profileContact,t);0!=o.length&&(a.append(new ie.js.JQueryBuilder("span").addClass("profile").text(o)),i=!0);var s=ie.mediator.helper.UserViewHelper.getVisibleDepartmentsInListView(e.departments,r);return ae.iter(s,function(e){i&&a.append(new ie.js.JQueryBuilder("span").text("")),n?a.append(ie.mediator.helper.UserViewHelper.createUserDepartmentLinkBuilder(e)):a.append(ie.mediator.helper.UserViewHelper.createUserDepartmentSpanBuilder(e)),i=!0}),i?a:null},ie.mediator.helper.UserViewHelper.getProfileOneLineText=function(n,e){return null==n?"":e.map(function(t){var e=ae.find(n,function(e){return t.profileItemId==e.profileItemId});return null==e?null:e.value}).filter(ie.StringHelper.isNotEmpty).join("")},ie.mediator.helper.UserViewHelper.getVisibleDepartmentsInListView=function(e,t){return null==e||0==e.length?[]:e.map(function(e){return t.getDepartment(e)}).filter(function(e){return null!=e&&!e.isFree()&&ie.StringHelper.isNotEmpty(e.name)})},ie.mediator.helper.UserViewHelper.createUserDepartmentSpanBuilder=function(e){return new ie.js.JQueryBuilder("span").addClass("user-department").attr("data-department-id",ie.Int64Helper.idStr(e.id)).text(e.name)},ie.mediator.helper.UserViewHelper.createUserDepartmentLinkBuilder=function(e){return new ie.js.JQueryBuilder("a").attr("href","#").addClass("user-department").attr("data-department-id",ie.Int64Helper.idStr(e.id)).text(e.name)},ie.mediator.helper.UserViewHelper.attachDepartmentTooltip=function(e,t,n){e.tooltip({container:t,title:function(){var e=ie.Int64Helper.makeFromIdStr($(this).attr("data-department-id"));return null==e?"":n.getDepartmentPathWithoutRoot(e).map(ie.entity.DepartmentHelper.getName).filter(ie.StringHelper.isNotEmpty).join("/")},placement:"top",selector:".user-department",delay:{show:300,hide:0}})},ie.mediator.helper.UserViewHelper.attachDepartmentClick=function(e,n){e.on("click",".user-department",function(e){e.preventDefault();var t=ie.Int64Helper.makeFromIdStr($(this).attr("data-department-id"));null!=t&&(n(t),$(this).trigger("mouseleave"))})},l.interfaces.IProxy=function(){},n["puremvc.interfaces.IProxy"]=l.interfaces.IProxy,l.interfaces.IProxy.__name__=["puremvc","interfaces","IProxy"],l.interfaces.IProxy.prototype={__class__:l.interfaces.IProxy},ie.proxy={},ie.proxy.AccessTokenResolverProxy=function(){},n["albero.proxy.AccessTokenResolverProxy"]=ie.proxy.AccessTokenResolverProxy,ie.proxy.AccessTokenResolverProxy.__name__=["albero","proxy","AccessTokenResolverProxy"],ie.proxy.AccessTokenResolverProxy.__interfaces__=[l.interfaces.IProxy],ie.proxy.AccessTokenResolverProxy.prototype={__class__:ie.proxy.AccessTokenResolverProxy},ie.proxy.AccessTokenResolverProxyFactory=function(){},n["albero.proxy.AccessTokenResolverProxyFactory"]=ie.proxy.AccessTokenResolverProxyFactory,ie.proxy.AccessTokenResolverProxyFactory.__name__=["albero","proxy","AccessTokenResolverProxyFactory"],ie.proxy.AccessTokenResolverProxyFactory.newInstance=function(){return new ie.proxy.AccessTokenResolverProxyForDirectJsHubot("accessTokenResolver")},l.patterns.proxy={},l.patterns.proxy.Proxy=function(e,t){l.patterns.observer.Notifier.call(this),this.proxyName=null!=e?e:l.patterns.proxy.Proxy.NAME,null!=t&&this.setData(t)},n["puremvc.patterns.proxy.Proxy"]=l.patterns.proxy.Proxy,l.patterns.proxy.Proxy.__name__=["puremvc","patterns","proxy","Proxy"],l.patterns.proxy.Proxy.__interfaces__=[l.interfaces.IProxy],l.patterns.proxy.Proxy.__super__=l.patterns.observer.Notifier,l.patterns.proxy.Proxy.prototype=t(l.patterns.observer.Notifier.prototype,{getProxyName:function(){return this.proxyName},setData:function(e){this.data=e},getData:function(){return this.data},onRegister:function(){},onRemove:function(){},__class__:l.patterns.proxy.Proxy}),ie.proxy.AccessTokenResolverProxyForDirectJsHubot=function(e){l.patterns.proxy.Proxy.call(this,e)},n["albero.proxy.AccessTokenResolverProxyForDirectJsHubot"]=ie.proxy.AccessTokenResolverProxyForDirectJsHubot,ie.proxy.AccessTokenResolverProxyForDirectJsHubot.__name__=["albero","proxy","AccessTokenResolverProxyForDirectJsHubot"],ie.proxy.AccessTokenResolverProxyForDirectJsHubot.__interfaces__=[ie.proxy.AccessTokenResolverProxy],ie.proxy.AccessTokenResolverProxyForDirectJsHubot.__super__=l.patterns.proxy.Proxy,ie.proxy.AccessTokenResolverProxyForDirectJsHubot.prototype=t(l.patterns.proxy.Proxy.prototype,{asyncGetAccessToken:function(e,t){var n,r=this.settings.getAccessToken();null==r?null==(n=null!=v.account?v.account.split(":"):null)||2!=n.length?null!=(e=null==e?this.accountLoader.load():e)&&(null!=e.accessToken?(this.settings.setAccessToken(e.accessToken),t(e.accessToken)):this.api.createAccessToken(e.email,e.pass,t)):this.api.createAccessToken(n[0],n[1],t):t(r)},__class__:ie.proxy.AccessTokenResolverProxyForDirectJsHubot}),ie.proxy.AccountLoaderProxy=function(){},n["albero.proxy.AccountLoaderProxy"]=ie.proxy.AccountLoaderProxy,ie.proxy.AccountLoaderProxy.__name__=["albero","proxy","AccountLoaderProxy"],ie.proxy.AccountLoaderProxy.__interfaces__=[l.interfaces.IProxy],ie.proxy.AccountLoaderProxy.prototype={__class__:ie.proxy.AccountLoaderProxy},ie.proxy.AccountLoaderProxyFactory=function(){},n["albero.proxy.AccountLoaderProxyFactory"]=ie.proxy.AccountLoaderProxyFactory,ie.proxy.AccountLoaderProxyFactory.__name__=["albero","proxy","AccountLoaderProxyFactory"],ie.proxy.AccountLoaderProxyFactory.newInstance=function(){var e=te.resolveClass("albero.debug.proxy.AccountLoaderProxyImpl");return null!=e?te.createInstance(e,["accountLoader"]):new ie.proxy.AccountLoaderProxyForHubot("accountLoader")},ie.proxy.AccountLoaderProxyForHubot=function(e){l.patterns.proxy.Proxy.call(this,e)},n["albero.proxy.AccountLoaderProxyForHubot"]=ie.proxy.AccountLoaderProxyForHubot,ie.proxy.AccountLoaderProxyForHubot.__name__=["albero","proxy","AccountLoaderProxyForHubot"],ie.proxy.AccountLoaderProxyForHubot.__interfaces__=[ie.proxy.AccountLoaderProxy],ie.proxy.AccountLoaderProxyForHubot.__super__=l.patterns.proxy.Proxy,ie.proxy.AccountLoaderProxyForHubot.prototype=t(l.patterns.proxy.Proxy.prototype,{load:function(){var r=this,t=C.Node.require("read");return t({prompt:"Email: "},function(e,n){t({prompt:"Password: ",silent:!0},function(e,t){r.sendNotification("SignIn",new ie.entity.Account(n,t))})}),null},__class__:ie.proxy.AccountLoaderProxyForHubot}),ie.proxy.AlberoBroadcastProxy=function(){l.patterns.proxy.Proxy.call(this,"broadcast")},n["albero.proxy.AlberoBroadcastProxy"]=ie.proxy.AlberoBroadcastProxy,ie.proxy.AlberoBroadcastProxy.__name__=["albero","proxy","AlberoBroadcastProxy"],ie.proxy.AlberoBroadcastProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.AlberoBroadcastProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{handleNotification:function(t,e,n){var r,a,i=this;switch(se._d(se.dateStr(),"Receive request from server. name:",t," body:",e,""),t){case"notify_update_user":if(e instanceof Array&&null==e.__enum__){var o=this.dataFactory.newDomainUser(e[1]);this.dataStore.setUserIfLatest(null,o)}else{var s=new ie.entity.Me(e);se._d(se.dateStr(),"Current user updated. user:",s,"","",""),this.dataStore.setMe(s)}n();break;case"notify_update_domain_users":for(var l=e,c=0;c<l.length;){var u=l[c];++c;var d=this.dataStore.getDomain(u);null!=d&&d.setting.contactTreeEnabled&&this.departmentStore.clearDomainDepartmentUsers(u)}this.sendNotification(t,e),n();break;case"notify_update_department_tree":var p=e;this.departmentStore.clearDomainDepartment(p),this.api.getDepartmentTree(p),this.sendNotification(t,p),n();break;case"notify_update_department_users":var m=e;this.departmentStore.clearDomainDepartmentUsers(m),this.api.getUsers(m,this.dataStore.getFriendsOrAcquaintances(m).map(function(e){return e.id})),this.api.getMe(),this.sendNotification(t,m),n();break;case"notify_add_friend":this.sendNotification(t,this.dataFactory.newFriend(e[1])),n();break;case"notify_add_acquaintance":this.sendNotification(t,this.dataFactory.newAcquaintance(e[1])),n();break;case"notify_join_domain":var _=this.dataStore.setDomainIfLatest(new ie.entity.Domain(e));ie.mediator.helper.DomainHelper.isAllowReadAnnouncement(_)&&this.api.getAnnouncementStatus(_.id),this.sendNotification(t,[null,_]),n();break;case"notify_update_domain":var h=new ie.entity.Domain(e),y=this.dataStore.getDomain(h.id),f=this.dataStore.setDomainIfLatest(h);if(null!=y&&ie.mediator.helper.DomainHelper.isAllowReadAnnouncement(y)&&!ie.mediator.helper.DomainHelper.isAllowReadAnnouncement(f)){this.dataStore.removeAnnouncementStatus(y.id);var g=new ie.entity.AnnouncementStatusUpdate;g.domainId=f.id,this.sendNotification("notify_update_announcement_status",g),this.settings.clearSelectedTalkIfMatch(ie.entity.TalkSelection.AnnouncementsSelected)}if(!ie.mediator.helper.DomainHelper.isAllowReadAnnouncement(y)&&ie.mediator.helper.DomainHelper.isAllowReadAnnouncement(f)&&this.api.getAnnouncementStatus(f.id),ie.entity.Domain.isChangedContractTreeEnabled(y,f)&&!ie.entity.Domain.isDepartmentEnabled(f)){var S=f.id;this.departmentStore.clearDomainDepartment(S),this.dataStore.clearUsersDepartments(S)}this.sendNotification(t,[y,f]),n();break;case"notify_add_domain_invite":var T=new ie.entity.DomainInvite(e);this.dataStore.setDomainInvite(T),this.sendNotification(t,T),n();break;case"notify_create_pair_talk":case"notify_create_group_talk":var v=new ie.entity.Talk(e);this.dataStore.setTalk(v),this.newTalkStatusByTalk(v),this.sendNotification(t,v),n();break;case"notify_add_talkers":var I=new ie.entity.Talk(e);null==this.dataStore.getTalk(I.id)&&this.sendNotification("notify_add_talkers_including_me",I),this.dataStore.setTalk(I),this.sendNotification(t,I),n();break;case"notify_update_group_talk":case"notify_delete_talker":var A=new ie.entity.Talk(e);this.dataStore.setTalk(A),this.sendNotification(t,A),n();break;case"notify_create_message":var x=new ie.entity.Message(e);this.messageStore.setMessage(x),this.keywordWatcher.onMessageCreated(x);var w=this.newTalkStatusByMessage(x);switch(null!=w&&this.sendNotification("notify_update_local_talk_status",w),x.type[1]){case 7:case 9:case 11:oe.Timer.delay(function(){var e=i.dataStore.getTalk(x.talkId);null!=e&&i.sendNotification("notify_update_question",i.dataStore.setQuestion(ie.entity.Question.fromMessageAndTalk(x,e))),i.sendNotification(t,x),n()},500);break;case 8:case 10:case 12:case 13:case 14:case 15:oe.Timer.delay(function(){var e=x.content.in_reply_to;null!=i.dataStore.getTalk(x.talkId)&&null!=i.dataStore.getQuestion(e)?i.sendNotification("ReloadData",ie.command.ReloadDataType.Question(e,function(e){i.sendNotification(t,x),n()})):(i.sendNotification(t,x),n())},500);break;case 4:if(null!=x.content.file_id){var k=[ie.entity.FileInfo.fromMessageAndFile(x,x.content)];this.fileInfoStore.setMessageFileInfos(x.id,k),ae.iter(k,function(e){i.fileInfoStore.setTalkFileInfo(e,!1),i.sendNotification("notify_create_attachment",e)})}this.sendNotification(t,x),n();break;case 5:var b=ie.ArrayHelper.asArray(x.content.files).map((r=ie.entity.FileInfo.fromMessageAndFile,a=x,function(e){return r(a,e)}));this.fileInfoStore.setMessageFileInfos(x.id,b),ae.iter(b,function(e){i.fileInfoStore.setTalkFileInfo(e,!1),i.sendNotification("notify_create_attachment",e)}),this.sendNotification(t,x),n();break;case 0:var D=x.content,M=null;switch(D.type){case"delete_talker":M=D.deleted_user_id;break;case"hide_pair_talk":M=D.user_id}if(null==M)return this.sendNotification(t,x),void n();for(var E=x.talkId,C=this.dataStore.getQuestions(E,M),P=0;P<C.length;){var N=C[P];++P,N.closed=!0,this.sendNotification("notify_update_question",N)}this.sendNotification(t,x),n();break;default:this.sendNotification(t,x),n()}break;case"notify_delete_message":var U=new ie.entity.MessageDeletion(e);ie.OptionHelper.foreach(this.messageStore.getMessage(U.messageId),function(e){e.type=ie.entity.MessageType.deleted,e.content=""});var R=this.updateTalkStatusOnMessageDelete(U);null!=R&&this.sendNotification("notify_update_local_talk_status",R),this.sendNotification(t,U),n();break;case"notify_update_read_statuses":var O=new ie.entity.MessageReadStatusesUpdate(e),F=this.updateTalkStatus(O);null!=F&&this.sendNotification("notify_update_local_talk_status",F),this.sendNotification(t,O),n();break;case"notify_update_talk_status":var H=new ie.entity.TalkStatusUpdate(e),L=this.dataStore.getTalkStatus(H.talkId);null!=L&&L.update(H)&&(this.dataStore.setTalkStatus(L),this.sendNotification("notify_update_local_talk_status",L)),this.sendNotification(t,H),n();break;case"notify_create_announcement":var B=new ie.entity.Announcement(e);this.keywordWatcher.onAnnouncementCreated(B),this.sendNotification("notify_update_announcement_status",this.newAnnouncementStatus(B)),this.sendNotification(t,B),n();break;case"notify_delete_announcement":var j=e[0],z=e[1],Q=this.dataStore.getAnnouncementStatus(j);null!=Q&&(ie.entity.AnnouncementStatusHelper.isUnread(Q,z)&&(Q.unreadCount-=1,Q.unreadCount<0&&(Q.unreadCount=0)),null!=Q.maxAnnouncementId&&ie.Int64Helper.eq(Q.maxAnnouncementId,z)&&null!=Q.maxAnnouncement&&(Q.maxAnnouncement.type=ie.entity.MessageType.deleted,Q.maxAnnouncement.content=""),this.dataStore.setAnnouncementStatus(Q)),this.sendNotification(t,e),n();break;case"notify_update_announcement_status":var V=new ie.entity.AnnouncementStatusUpdate(e),q=this.dataStore.getAnnouncementStatus(V.domainId);null==q&&(q=this.assureAnnouncementStatus(V.domainId)),q.updateReadWithStatusUpdate(V),this.dataStore.setAnnouncementStatus(q),this.sendNotification(t,V),n();break;case"notify_delete_attachment":var G=new ie.entity.FileInfoDeletion(e);this.messageStore.onFileDeleted(G),this.fileInfoStore.onFileDeleted(G),this.sendNotification(t,G),n();break;case"notify_leave_domain":var K=e;this.dataStore.removeDomain(K),this.sendNotification(t,K),n();break;case"notify_delete_domain_invite":var W=e;this.dataStore.removeDomainInvite(W),this.sendNotification(t,W),n();break;case"notify_delete_friend":this.dataStore.removeFriend(e[0],e[1]),this.sendNotification(t,e),n();break;case"notify_delete_acquaintance":this.dataStore.removeAcquaintance(e[0],e[1]),this.sendNotification(t,e),n();break;case"notify_delete_talk":this.dataStore.removeTalk(e),this.dataStore.removeTalkStatus(e),this.sendNotification("brand_badge_changed"),this.settings.clearSelectedTalkIfMatch(ie.entity.TalkSelection.TalkSelected(e,null)),this.sendNotification(t,e),n();break;case"notify_add_account_control_request":var J=new ie.entity.AccountControlRequest(e);this.dataStore.setAccountControlRequest(J),this.sendNotification(t,J),n();break;case"notify_delete_account_control_request":var Y=ie.Int64Helper.fromIntOrInt64(e);this.dataStore.removeAccountControlRequest(Y),this.sendNotification(t,Y),n();break;case"notify_join_account_control_group":var X=new ie.entity.AccountControlGroup(e);this.dataStore.setAccountControlGroup(X),this.dataStore.removeAccountControlRequests(),this.sendNotification("brand_badge_changed"),this.sendNotification(t,X),n();break;case"notify_update_account_control_group_partially":var Z=new ie.entity.AccountControlGroupPartialUpdate(e);this.dataStore.updateAccountControlGroup(Z),this.sendNotification(t,Z),n();break;case"notify_leave_account_control_group":var $=e;this.dataStore.removeAccountControlGroup($),this.sendNotification(t,$),n();break;case"notify_add_favorite_talk":var ee=new ie.entity.FavoriteTalkEvent(e);this.updateTalkStatusByFavoriteTalkEvent(ee),this.sendNotification(t,ee),n();break;case"notify_delete_favorite_talk":var te=new ie.entity.FavoriteTalkEvent(e);this.updateTalkStatusByFavoriteTalkEvent(te),this.sendNotification(t,te),n();break;case"notify_disable_push_notification":var ne=new ie.entity.TalkPushNotificationEvent(e);this.updateTalkStatusByTalkPushNotificationEvent(!1,ne),this.sendNotification(t,ne),n();break;case"notify_enable_push_notification":var re=new ie.entity.TalkPushNotificationEvent(e);this.updateTalkStatusByTalkPushNotificationEvent(!0,re),this.sendNotification(t,re),n();break;default:this.sendNotification(t,e),n()}},updateTalkStatusByFavoriteTalkEvent:function(e){var t=this.dataStore.getTalkStatus(e.talkId);if(null==t){var n=this.dataStore.getTalk(e.talkId);if(null==n)return void se._e(se.dateStr(),"talk not found on change favorite talk.","","","","");(t=new ie.entity.TalkStatus).id=e.talkId,t.talkOrderingTimestamp=n.updatedAt}(null==t.favoriteVersion||e.favoriteVersion>t.favoriteVersion)&&(t.favoriteVersion=e.favoriteVersion,t.orderInFavorites=e.orderInFavorites,this.dataStore.setTalkStatus(t))},updateTalkStatusByTalkPushNotificationEvent:function(e,t){var n=this.dataStore.getTalkStatus(t.talkId);if(null==n){var r=this.dataStore.getTalk(t.talkId);if(null==r)return void se._e(se.dateStr(),"talk not found on change favorite talk.","","","","");(n=new ie.entity.TalkStatus).id=t.talkId,n.talkOrderingTimestamp=r.updatedAt}(null==n.pushNotificationSetting||t.version>n.pushNotificationSetting.version)&&(n.pushNotificationSetting=ie.entity.PushNotificationSetting.createWithParams(e,t.version),this.dataStore.setTalkStatus(n))},newTalkStatusByTalk:function(e){var t=this.dataStore.getTalkStatus(e.id);return null==t&&((t=new ie.entity.TalkStatus).id=e.id),null==t.talkOrderingTimestamp&&(t.talkOrderingTimestamp=e.updatedAt),this.dataStore.setTalkStatus(t),t},newTalkStatusByMessage:function(e){var t=this.dataStore.getTalkStatus(e.talkId);return null==t&&((t=new ie.entity.TalkStatus).id=e.talkId),ie.entity.TalkStatusHelper.isNewMax(t,e.id)&&(t.maxMessageId=e.id,t.maxMessage=e),e.isUnreadCountTarget&&(this.dataStore.isMe(e.userId)||t.unreadCount++,t.talkOrderingTimestamp=e.createdAt),this.dataStore.setTalkStatus(t),t},updateTalkStatusOnMessageDelete:function(e){var t=this.dataStore.getTalkStatus(e.talkId);return null!=t&&(ie.entity.TalkStatusHelper.isUnread(t,e.messageId)&&(t.unreadCount-=1,t.unreadCount<0&&(t.unreadCount=0)),ie.entity.TalkStatusHelper.isMax(t,e.messageId)&&null!=t.maxMessage&&(t.maxMessage.type=ie.entity.MessageType.deleted),this.dataStore.setTalkStatus(t)),t},updateTalkStatus:function(e){var t=this;if(!ae.exists(e.readUserIds,function(e){return t.dataStore.isMe(e)}))return null;var n=this.dataStore.getTalkStatus(e.talkId);if(null==n)return se._e(se.dateStr(),"talkStatus is not found.","","","",""),null;for(var r=e.messageIds[0],a=0,i=e.messageIds;a<i.length;){var o=i[a];++a,ie.entity.TalkStatusHelper.isUnread(n,o)&&(oe.Int64.compare(r,o)<0&&(r=o),ie.Int64Helper.notContains(e.messageIdsExcludingUnreadCountTargets,o)&&n.unreadCount--)}return ie.entity.TalkStatusHelper.isUnread(n,r)&&(n.maxReadMessageId=r,this.dataStore.setTalkStatus(n)),n},newAnnouncementStatus:function(e){var t=this.dataStore.getAnnouncementStatus(e.domainId);return null==t&&((t=new ie.entity.AnnouncementStatus).domainId=e.domainId),ie.entity.AnnouncementStatusHelper.isNewMax(t,e.id)&&(t.maxAnnouncementId=e.id,t.maxAnnouncement=e),null==t.unreadCount&&(t.unreadCount=0),t.unreadCount++,this.dataStore.setAnnouncementStatus(t),t},assureAnnouncementStatus:function(e){var t=this.dataStore.getAnnouncementStatus(e);return null==t&&(t=this.dataFactory.newAnnouncementStatusForDomain(e)),t},__class__:ie.proxy.AlberoBroadcastProxy}),ie.proxy.AlberoServiceProxy=function(){l.patterns.proxy.Proxy.call(this,"api")},n["albero.proxy.AlberoServiceProxy"]=ie.proxy.AlberoServiceProxy,ie.proxy.AlberoServiceProxy.__name__=["albero","proxy","AlberoServiceProxy"],ie.proxy.AlberoServiceProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.AlberoServiceProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{getOSString:function(){return"bot"},createAccessToken:function(e,t,n){var r,a,i=this,o=this.settings.getOs(),s=this.settings.getIDFV(),l=e.split("$");-1==e.indexOf("@")&&2==l.length?(r="create_access_token_by_id",a=[l[1],l[0],t,s,o,""]):(r="create_access_token",a=[e,t,s,o,""]),this.rpc.call(r,a,function(e){se._d(se.dateStr(),"access token:",e,"","",""),i.settings.setAccessToken(e),n(e)},function(e){i.sendNotification("Url",ie.command.UrlAction.FORWARD(ie.Urls.error))})},authorizeDevice:function(e,t){var n=this.settings.getIDFV();this.rpc.call("authorize_device",[e,n],function(e){t()})},createSession:function(e,r){var a=this,t=[e,"1.99",this.getOSString()];this.rpc.call("create_session",t,function(e){var t=new ie.entity.Session(e),n=ie.DateTimeHelper.nowAsInt64();t.passwordExpiration.isExpired(n)?a.sendNotification("password_expiration_overed"):(t.passwordExpiration.needWarning(n,a.settings.getPasswordWarningSkipUntil())&&(a.settings.setPasswordWarningSkipUntil(ie.DateTimeHelper.oneDayAfterAsInt64()),a.sendNotification("password_expiration_warned")),r(t))},function(e){if(null!=e){if(401==e.code&&"expired password"==e.message)return void a.sendNotification("password_expiration_overed");if(401==e.code&&"deleted account"==e.message)return void a.sendNotification("SignOut");if(401==e.code&&"unauthorized device"==e.message)return void a.sendNotification("Device",ie.command.DeviceAction.AUTHORIZE);a.rpc.onServerError(e)}a.settings.clearAccessToken(),a.sendNotification("Url",ie.command.UrlAction.FORWARD(ie.Urls.error))})},startNotification:function(){var t=this;this.rpc.call("start_notification",[],function(e){e||(t.dataStore.clear(!0),se._e(se.dateStr(),"start_notification failed.","","","",""),C.Node.process.exit(1))})},resetNotification:function(e){this.rpc.call("reset_notification",[],e)},sendDomainNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_update_domain",[null,n])}},sendAnnouncementStatusNotification:function(e){var t=new ie.entity.AnnouncementStatusUpdate;t.domainId=e.domainId,this.sendNotification("notify_update_announcement_status",t)},sendTalkNotification:function(e){var t;t=e.type==ie.entity.TalkType.PairTalk?"notify_create_pair_talk":"notify_create_group_talk",this.sendNotification(t,e)},sendTalkNotifications:function(e){var t=this;ae.iter(ie.ArrayHelper.sortAndReturn(e.map(function(e){return t.dataStore.getTalkPack(e.id)}),ie.entity.TalkPack.compareTalkConsideredFavorite),function(e){t.sendTalkNotification(e.talk)})},sendTalkStatusNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_update_local_talk_status",n)}},deleteSession:function(){this.settings.clearSelectedStampTabId(),this.settings.clearDomainSelection(),this.settings.clearAccessToken(),this.rpc.restart()},updateUser:function(t,e,n,r,a){var i=this,o=function(e){i.sendNotification("update_user_errored",i.dataStore.me)},s=function(e){i.rpc.call("update_user",[t,e,r,a],function(e){i.dataStore.setMe(new ie.entity.Me(e)),i.sendNotification("update_user_responsed",i.dataStore.me)},function(e){o(),i.rpc.onServerError(e)})};null!=n?s(n):null!=e?this.uploadFile(e,null,ie.entity.UploadUseType.PROFILE_IMAGE,function(e){s(e.get_url)},o):s()},updateProfile:function(e){var t=this,n=ie.entity.ProfileItemValuesPerDomain.convertToApiParams(e);this.rpc.call("update_profile",[n],function(e){se._d(se.dateStr(),"update_profile_succeed",e,"","",""),t.dataStore.setMe(new ie.entity.Me(e)),t.sendNotification("update_profile_responsed",t.dataStore.me)},function(e){t.sendNotification("update_profile_errored",t.dataStore.me),t.rpc.onServerError(e)})},addFriend:function(e){var t=this.settings.getSelectedDomainId();this.rpc.call("add_friend",[t,e.id])},deleteFriend:function(e){var t=this.settings.getSelectedDomainId();this.rpc.call("delete_friend",[t,e.id])},getFriends:function(a){var i=this;this.rpc.call("get_friends",[],function(e){for(var t=0;t<e.length;){var n=e[t];++t;n[0];var r=n[1];ae.iter(r,function(e){i.sendNotification("notify_add_friend",i.dataFactory.newFriend(e))})}null!=a&&a()})},getAcquaintances:function(a){var i=this;this.rpc.call("get_acquaintances",[],function(e){for(var t=0;t<e.length;){var n=e[t];++t;var r=n[1];ae.iter(r,function(e){i.sendNotification("notify_add_acquaintance",i.dataFactory.newAcquaintance(e))})}null!=a&&a()})},getAllUsers:function(e){var n=this,r=this.settings.getSelectedDomainId();this.rpc.call("get_domain_users",[r,14,40,e],function(e){var t=ie.ArrayHelper.asArray(e.contents).map(_(p=n.dataFactory,p.newDomainUser));n.dataStore.setUsersIfLatest(r,t),n.sendNotification("get_domain_users_responsed",[r,e.marker,e.next_marker,t])})},getUsers:function(e,t){this._getUsers(e,t.slice())},_getUsers:function(n,r){var a=this,e=r.splice(0,100);0!=e.length&&this.rpc.call("get_users",[n,e],function(e){var t=e.map(_(p=a.dataFactory,p.newDomainUser));a.dataStore.setUsersIfLatest(n,t),a.sendNotification("get_users_responsed",[n,t]),a._getUsers(n,r)})},getProfile:function(e,t){var n=this;this.rpc.call("get_profile",[e,t],function(e){var t=new ie.entity.Profile(e);n.sendNotification("get_profile_responsed",t)},function(e){403==e.code&&"invalid user"==e.message?null!=e.detail&&null!=e.detail.invalid_user_ids&&n.sendNotification("get_profile_errored",e.detail.invalid_user_ids):n.rpc.onServerError(e)})},searchDomainUsers:function(n,e){var r=this,a=this.settings.getSelectedDomainId();this.rpc.call("search_domain_users",[a,n,14,40,e],function(e){var t=ie.ArrayHelper.asArray(e.contents).map(_(p=r.dataFactory,p.newDomainUser));r.dataStore.setUsersIfLatest(a,t),r.sendNotification("get_domain_users_responsed",[a,e.marker,e.next_marker,t,n])})},getUserIdentifiers:function(e,t,n){var r=this;0==t.length?null!=n&&n():this._getUserIdentifiers(e,t.slice(0,100),function(){r.getUserIdentifiers(e,t.slice(100),n)})},_getUserIdentifiers:function(_,h,y){var f=this;this.rpc.call("get_user_identifiers",[_,h],function(e){for(var t=e.contents,n=new oe.ds.StringMap,r=0,a=t.length;r<a;){var i=r++,o=new ie.entity.UserIdentifier(t[i]),s=ie.Int64Helper.idStr(o.userId);n.set(s,o)}for(var l=0,c=h.length;l<c;){var u=l++,d=f.dataStore.getUser(_,h[u]);if(null!=d){var p,m=ie.Int64Helper.idStr(d.id);null!=(p=n.get(m))&&(d.email=p.email,d.subEmail=p.subEmail,d.groupAlias=p.groupAlias,d.signinId=p.signinId),d.__uid_caching=!0}}null!=y&&y()},function(e){for(var t=0,n=h.length;t<n;){var r=t++,a=f.dataStore.getUser(_,h[r]);null!=a&&(a.__uid_caching=null)}null!=y&&y()})},getAllUserIdentifiers:function(t){var n=this,r=null,e=this.dataStore.getUsers();null==e&&(e=new Array);for(var a=0;a<e.length;){var i=e[a];if(++a,null==i.__uid_caching){i.__uid_caching=!1;var o=ie.Int64Helper.idStr(i.domainId);null==r&&(r=new oe.ds.StringMap);var s=r.get(o);null==s&&(s=new Array,r.set(o,s)),s.push(i.id)}}if(null==r)t();else{var l=r.keys(),c=null;(c=function(){if(l.hasNext()){var e=l.next();n.getUserIdentifiers(ie.Int64Helper.makeFromIdStr(e),r.get(e),c)}else t()})()}},getAllUserEmails:function(e){se._w(se.dateStr(),"'getAllUserEmails' is deprecated, please use 'getAllUserIdentifiers' instead","","","",""),this.getAllUserIdentifiers(e)},getDepartmentTree:function(n){var r=this;this.rpc.call("get_department_tree",[n],function(e){ae.iter(new ie.entity.DepartmentList(e).departments,function(e){e.isRoot()&&r.departmentStore.setRootDepartmentId(n,e.id),r.departmentStore.setDepartment(e)});var t=r.settings.getSelectedDepartmentId(n);null!=t&&null==r.departmentStore.getDepartment(t)&&r.settings.setSelectedDepartmentId(n,null),r.sendNotification("get_department_tree_responsed",[n])},function(e){403!=e.code||"forbidden"!=e.message?r.rpc.onServerError(e):r.sendNotification("get_department_tree_canceled",[n])})},getDepartmentUsers:function(e,t){this._getDepartmentUsers(e,t,null)},getDepartmentAllUsers:function(o){var s=this,e=this.departmentStore.getDepartment(o);if(null==e||null==e.userIds){var l=new oe.ds.StringMap,c=null;c=function(e,t,n){if(ae.iter(n,function(e){var t=ie.Int64Helper.idStr(e.id);l.set(t,e.id)}),null==t){for(var r=[],a=l.iterator();a.hasNext();){var i=a.next();r.push(i)}se._d(se.dateStr(),"department all users prepared. [departmentId, users_count]:",o,r.length,"",""),s.departmentStore.setDepartmentUsers(o,r),s.sendNotification("department_user_ids_prepared",r)}else s._getDepartmentUsers(o,t,c)},this._getDepartmentUsers(o,null,c)}else this.sendNotification("department_user_ids_prepared",e.userIds)},_getDepartmentUsers:function(n,e,r){var a=this,i=this.settings.getSelectedDomainId(),t=this.departmentStore.getDepartment(n),o=null!=t&&null!=t.childrenIds;this.rpc.call("get_department_users",[i,n,o,100,e],function(e){var t=ie.ArrayHelper.asArray(e.contents).map(_(p=a.dataFactory,p.newDomainUser));a.dataStore.setUsersIfLatest(i,t),a.sendNotification("get_department_users_responsed",[i,e.marker,e.next_marker,t,n]),null!=r&&r(e.marker,e.next_marker,t)},function(e){403!=e.code||"forbidden"!=e.message?a.rpc.onServerError(e):a.sendNotification("get_department_users_canceled",[i])})},getMe:function(){var t=this;this.rpc.call("get_me",[],function(e){t.dataStore.setMe(new ie.entity.Me(e)),t.sendNotification("get_me_responsed")},function(e){t.rpc.onServerError(e)})},getDepartmentUserCount:function(e,t){var n=t.filter(_(p=this.departmentStore,p.needUserCountLoading));this._getDepartmentUserCount(e,n)},_getDepartmentUserCount:function(n,r){var a=this,i=r.splice(0,100);0!=i.length&&(ae.iter(i,function(e){a.departmentStore.setUserCountLoading(e,!0)}),this.rpc.call("get_department_user_count",[n,i],function(e){var t=new ie.entity.DepartmentUserCountList(e);ae.iter(t.departments,_(p=a.departmentStore,p.setDepartmentUserCount)),a.sendNotification("get_department_user_count_responsed",{completed:i,remaining:r}),a._getDepartmentUserCount(n,r)},function(e){ae.iter(i,function(e){a.departmentStore.setUserCountLoading(e,!1)}),a.rpc.onServerError(e)}))},getDomains:function(t){var n=this;this.rpc.call("get_domains",[],function(e){ae.iter(e,_(p=n.dataFactory,p.newDomain)),n.sendDomainNotifications(n.dataStore.getDomains()),null!=t&&t()})},leaveDomain:function(e){var t=this;this.rpc.call("leave_domain",[e.id],function(e){t.dataStore.removeDomain(e)})},getDomainInvites:function(t){var e;e=null==t?function(e){}:function(e){t()},this._getDomainInvites(e)},_getDomainInvites:function(n){var r=this;this.rpc.call("get_domain_invites",[],function(e){var t=e.map(_(p=r.dataFactory,p.newDomainInvite));ae.iter(t,function(e){r.sendNotification("notify_add_domain_invite",e)}),n(t)})},acceptDomainInvite:function(e){this.callApiReliable("accept_domain_invite",[e],function(e){})},deleteDomainInvite:function(e){this.callApiReliable("delete_domain_invite",[e],function(e){})},getAccountControlRequests:function(t){var n=this;this.rpc.call("get_account_control_requests",[],function(e){ae.iter(e.map(_(p=n.dataFactory,p.newAccountControlRequest)),function(e){n.sendNotification("notify_add_account_control_request",e)}),null!=t&&t()})},acceptAccountControlRequest:function(e){if(null!=e){var t=this.dataStore.getAccountControlRequest(e);null!=t&&this.rpc.call("accept_account_control_request",[t.id,t.version],function(e){})}},rejectAccountControlRequest:function(e){if(null!=e){var t=this.dataStore.getAccountControlRequest(e);null!=t&&this.rpc.call("reject_account_control_request",[t.id,t.version],function(e){})}},getJoinedAccountControlGroup:function(t){var n=this;this.rpc.call("get_joined_account_control_group",[],function(e){ae.iter(e.map(_(p=n.dataFactory,p.newAccountControlGroup)),function(e){n.sendNotification("notify_join_account_control_group",e)}),null!=t&&t()})},getTalks:function(t){var n=this;this.rpc.call("get_talks",[],function(e){ae.iter(e,_(p=n.dataFactory,p.newTalk)),n.rpc.call("get_talk_statuses",[],function(e){ae.iter(e,_(p=n.dataFactory,p.newTalkStatus)),n.sendTalkNotifications(n.dataStore.getTalks()),n.sendTalkStatusNotifications(n.dataStore.getTalkStatuses()),null!=t&&t()})})},getReadStatus:function(e,t){var n=this;this.rpc.call("get_read_status",[e,t],function(e){n.sendNotification("notify_get_message_status",new ie.entity.MessageReadStatus(e))})},createGroupTalk:function(e,t,n,r){var a=this;null==e&&(e=this.settings.getSelectedDomainId()),0!=t.length&&this.rpc.call("create_group_talk",[e,t,n.allowDisplayPastMessages],function(e){var t=a.dataFactory.newTalk(e);a.selectTalk(t,r)},function(e){if(null!=e&&502==e.code&&null!=e.detail&&"talks"==e.detail.limit_target){var t=e.detail.limit_max;a.sendNotification("error_occurred",ie.proxy.ErrorConverter.toLocalError(ie.entity.LocalErrorType.TalksCountOvered(t),e))}else if(null!=e&&502==e.code&&null!=e.detail&&"talkers"==e.detail.limit_target){var n=e.detail.limit_max;a.sendNotification("error_occurred",ie.proxy.ErrorConverter.toLocalError(ie.entity.LocalErrorType.TalkersCountOvered(n),e))}else a.rpc.onServerError(e)})},createPairTalk:function(e,t,n){var r=this;null==e&&(e=this.settings.getSelectedDomainId()),this.rpc.call("create_pair_talk",[e,t],function(e){var t=r.dataFactory.newTalk(e);r.selectTalk(t,n)},function(e){if(null!=e&&502==e.code&&null!=e.detail&&"talks"==e.detail.limit_target){var t=e.detail.limit_max;r.sendNotification("error_occurred",ie.proxy.ErrorConverter.toLocalError(ie.entity.LocalErrorType.TalksCountOvered(t),e))}else r.rpc.onServerError(e)})},selectTalk:function(e,t){null==t&&ie.entity.PaneType.SingleTalkPane,null==e?this.settings.selectAnnouncement(ie.entity.PaneType.SingleTalkPane):this.settings.selectTalk(ie.entity.PaneType.SingleTalkPane,e,oe.ds.Option.None)},updateGroupTalk:function(e,t,n,r){var a=this;this.rpc.call("update_group_talk",[e.id,t,n,r],function(e){a.sendNotification("notify_update_group_talk",a.dataFactory.newTalk(e))},function(e){a.sendNotification("notify_update_group_talk_ERRORED"),a.rpc.onServerError(e)})},addTalkers:function(e,t,n){var r=this;if(e.type!=ie.entity.TalkType.PairTalk)0!=t.length&&this.rpc.call("add_talkers",[e.id,t],function(e){r.sendNotification("notify_add_talkers",r.dataFactory.newTalk(e))},function(e){if(null!=e&&502==e.code&&null!=e.detail&&"talkers"==e.detail.limit_target){var t=e.detail.limit_max;r.sendNotification("error_occurred",ie.proxy.ErrorConverter.toLocalError(ie.entity.LocalErrorType.TalkersCountOvered(t),e))}else r.rpc.onServerError(e)});else{var a=e.userIds.concat(t);ie.Int64Helper.remove(a,this.dataStore.me.id);var i=this.settings.getSelectedDomainId();this.createGroupTalk(i,a,ie.entity.GroupTalkSettings.createDefault(),n)}},deleteTalker:function(t,n){var r=this,a=null,i=null,o=this.dataStore.isMe(n);o&&(a=t,i=this.dataStore.getTalkStatus(t.id),this.dataStore.removeTalk(t.id),this.dataStore.removeTalkStatus(t.id)),this.rpc.call("delete_talker",[t.id,n],function(e){ie.Int64Helper.remove(t.userIds,n),o||r.dataStore.setTalk(t),r.sendNotification("notify_delete_talker",t)},function(e){null!=a&&r.dataStore.setTalk(a),null!=i&&r.dataStore.setTalkStatus(i),r.sendNotification("error_occurred",e)})},getMessages:function(n,e,r,a){var i=this;e=null==e?{sinceId:null,maxId:null}:e,null==r&&(r=ie.entity.MessagesOrder.desc),this.rpc.call("get_messages",[n,20,e.sinceId,e.maxId,ie.entity.MessagesOrderProc.orderToInt(r)],function(e){var t=e.map(_(p=i.dataFactory,p.newMessage));i.sendNotification("notify_get_messages",{talkId:n,messages:t,sortOrder:r,callerKey:a})})},createMessage:function(e,t,n,r){var a=this,i=this.dataFactory.newDummyMessage(e,t,n);if(null==this.dataStore.getTalk(e)){var o={code:400,message:"invalid talk_id (deleted talk)"};return se._w(se.dateStr(),"WARNING method: create_message",o,"","",""),void this.sendNotification("create_message_fail",[o,i],r)}this.sendNotification("create_message_start",i),this.rpc.call("create_message",[e,ie.entity.Message.enumIndex(t),n],function(e){a.fileInfoStore.removeMessageFileInfos(i.id),a.sendNotification("create_message_complete",[a.dataFactory.newMessage(e),i.id],r)},function(e){a.sendNotification("create_message_fail",[e,i],r),null!=e&&409==e.code?a.sendNotification("error_occurred",ie.proxy.ErrorConverter.toLocalError(ie.entity.LocalErrorType.SendingMessageConflicted,e)):a.sendNotification("error_occurred",e)})},forwardMessages:function(t,n,r){null==r&&(r=0);var a=this;if(!(r>=n.length)){var e=n[r],i=t.id,o=this.dataFactory.newDummyMessage(i,e.type,e.content);this.sendNotification("create_message_start",o),this.rpc.call("create_message",[i,ie.entity.Message.enumIndex(e.type),e.content],function(e){a.sendNotification("create_message_complete",[a.dataFactory.newMessage(e),o.id]),a.forwardMessages(t,n,r+1)},function(e){a.sendNotification("create_message_fail",[e,o]),null!=e&&409==e.code?a.sendNotification("error_occurred",ie.proxy.ErrorConverter.toLocalError(ie.entity.LocalErrorType.SendingMessageConflicted,e)):a.sendNotification("error_occurred",e)})}},deleteMessage:function(n,r){var a=this;this.rpc.call("delete_message",[n,r],function(e){var t=new ie.entity.MessageDeletion;t.talkId=n,t.messageId=r,a.sendNotification("notify_delete_message",t)},function(e){if(null!=e){if(403==e.code&&"frozen domain"==e.message)return void a.sendNotification("error_occurred",e);if(409==e.code&&"conflict"==e.message)return void a.sendNotification("error_occurred",ie.proxy.ErrorConverter.toLocalError(ie.entity.LocalErrorType.DeletingMessageConflicted,e));a.sendNotification("error_occurred",e)}})},updateReadStatuses:function(n,r){var a=this;this.callApiReliable("update_read_statuses",[n,r],function(e){var t=a.dataStore.getTalkStatus(n);null!=t&&ie.Int64Helper.eq(t.maxReadMessageId,r)&&a.sendNotification("notify_update_local_talk_status",t)},null,function(e){return 429==e.code&&"too many requests"==e.message?oe.ds.Option.Some(1e3*a.asInt(e.detail.retry_after)):oe.ds.Option.None})},upload:function(n,r,a,i){var o=this;ie.js.TextCanonicalizer.assureNormalize(function(e){var t=o.dataFactory.newDummyFileMessage(r,a,e);o.prepareFileMessage(a,n,r,t,e,function(e){o.createMessageReliable(r,ie.entity.MessageType.file,e,t,i)},function(e){o.sendNotification("create_message_fail",[e,t],i)})})},uploadMulti:function(s,l,c,u,d){var p=this;ie.js.TextCanonicalizer.assureNormalize(function(n){var r=p.dataFactory.newDummyMultipleFileMessage(l,c,u,n);p.sendNotification("create_message_start",r);var a=function(e){p.sendNotification("create_message_fail",[e,r],d)},i=new Array,o=null;(o=function(t){if(t.hasNext()){var e=t.next();p.prepareFileMessage(e,s,l,null,n,function(e){i.push(e),o(t)},a)}else!function(){if(i.length==u.length){var e={files:i};null!=c&&0<c.length&&(e.text=c),p.createMessageReliable(l,ie.entity.MessageType.textMultipleFile,e,r,d)}}()})(Y.iter(u))})},prepareFileMessage:function(n,e,t,r,a,i,o){var s=this;this.uploadThumbnail(n,e,t,null,function(t){s.uploadFile(n,e,ie.entity.UploadUseType.MESSAGE,function(e){i(ie.FileDynamicHelper.createFileInfoDynamic(n,a(n.name),t,e))},o)},o)},createMessageReliable:function(e,t,n,r,a){var i=this;this.callApiReliable("create_message",[e,ie.entity.Message.enumIndex(t),n],function(e){i.sendNotification("create_message_complete",[i.dataFactory.newMessage(e),r.id],a)},function(e){i.sendNotification("create_message_fail",[e,r],a),null!=e&&409==e.code?i.sendNotification("error_occurred",ie.proxy.ErrorConverter.toLocalError(ie.entity.LocalErrorType.SendingMessageConflicted,e)):i.sendNotification("error_occurred",e)},function(e){return 500==e.code&&"Internal Error (IllegalStateException)"==e.message?oe.ds.Option.Some(1e3):oe.ds.Option.None})},uploadThumbnail:function(e,r,t,a,i,o){var s=this,n=ie.proxy.FileServiceProxy.getBlobFromUpdatableFile(e);this.fileService.createThumbnail(n,function(n){null!=a&&(ie.OptionHelper.foreach(n,function(t){ie.OptionHelper.foreach(s.fileInfoStore.getMessageFileInfos(a.id),function(e){e[0].setDummyThumbnail(t)})}),s.sendNotification("create_message_start",a)),ie.OptionHelper.foreach(n,function(t){s.uploadFile(t.file,r,ie.entity.UploadUseType.THUMBNAIL,function(e){t.setAuth(e),i(n)},o)}),ie.OptionHelper.isEmpty(n)&&i(oe.ds.Option.None)})},uploadFile:function(r,n,a,i,o){var s=this;ie.js.TextCanonicalizer.assureNormalize(function(e){var t=e(r.name);s.rpc.call("create_upload_auth",[t,r.type,r.size,n,ie.entity.UploadUseTypeHelper.getUseTypeInt(a)],function(e){var t,n;s.fileService.upload(e,r.type,r,(t=i,n=e,function(){return t(n)}),o)},function(e){if(null!=e)if(502==e.code&&null!=e.detail){var t=e.detail.limit_max;"file_size"==e.detail.limit_target?s.sendNotification("error_occurred",ie.proxy.ErrorConverter.toLocalError(ie.entity.LocalErrorType.UploadSizeOvered(t),e)):"storage_size"==e.detail.limit_target&&s.sendNotification("error_occurred",ie.proxy.ErrorConverter.toLocalError(ie.entity.LocalErrorType.StorageSizeOvered(t),e))}else s.sendNotification("error_occurred",e);o(e)})})},createDownloadAuth:function(e,t,n,r,a){var i=this;this.callApiReliable("create_download_auth",[e,t,n],function(e){r(new ie.entity.DownloadAuth(e))},function(e){a(e)},function(e){return 429==e.code&&"too many requests"==e.message?oe.ds.Option.Some(1e3*i.asInt(e.detail.retry_after)):oe.ds.Option.None})},deleteAttachment:function(e,t){this.rpc.call("delete_attachment",[e,t])},getAttachments:function(n,e){var r=this;null==e&&(e={sinceId:null,maxId:null}),this.rpc.call("get_attachments",[n,20,e.sinceId,e.maxId],function(e){var t=e.map(_(p=r.dataFactory,p.newFileInfo));r.sendNotification("get_file_responsed",{talkId:n,files:t})})},createAnnouncement:function(e,t,n,r){var a=this;if(null!=e||null!=(e=this.settings.getSelectedDomainId())){var i=this.dataFactory.newDummyMessage(null,t,n);this.sendNotification("create_announcement_start",i),this.rpc.call("create_announcement",[e,ie.entity.Message.enumIndex(t),n],function(e){a.sendNotification("create_announcement_complete",[a.dataFactory.newAnnouncement(e),i.id],r)},function(e){a.sendNotification("create_announcement_fail",i),a.sendNotification("error_occurred",e)})}},getAnnouncements:function(e,n,r){var a=this,i=this.settings.getSelectedDomainId();null!=i&&(e=null==e?{sinceId:null,maxId:null}:e,this.rpc.call("get_announcements",[i,20,e.sinceId,e.maxId,ie.entity.MessagesOrderProc.orderToInt(n)],function(e){var t=e.map(_(p=a.dataFactory,p.newAnnouncement));a.sendNotification("notify_get_announcements",{domainId:i,announcements:t,sortOrder:n,callerKey:r})}))},getAnnouncementStatuses:function(r){var a=this;this.rpc.call("get_announcement_statuses",[],function(e){for(var t=0;t<e.length;){var n=e[t];++t,a.sendAnnouncementStatusNotification(a.dataFactory.newAnnouncementStatus(n)),null!=r&&r()}})},getAnnouncementStatus:function(e,t){var n=this;this.rpc.call("get_announcement_status",[e],function(e){n.sendAnnouncementStatusNotification(n.dataFactory.newAnnouncementStatus(e)),null!=t&&t()})},updateAnnouncementReadStatus:function(n,r){var a=this;this.rpc.call("update_announcement_status",[n,r],function(e){var t=a.dataStore.getAnnouncementStatus(n);null!=t&&ie.Int64Helper.eq(t.maxReadAnnouncementId,r)&&a.sendAnnouncementStatusNotification(t)})},getQuestions:function(e,n,r,t){var a=this,i=this.settings.getSelectedDomainId(),o=null;null!=e&&(i=e.domainId,o=e.id);var s=ie.entity.Question.fromTypeToInt(n),l=ie.OptionHelper.orNull(ie.entity.Question.filterToOpBool(r));t=null==t?{sinceId:null,maxId:null}:t,this.rpc.call("get_actions",[i,o,s,l,20,t.sinceId,t.maxId],function(e){var t=e.map(_(p=a.dataFactory,p.newQuestion));a.sendNotification("get_questions_responsed",{domainId:i,talkId:o,questions:t,fromType:n,filter:r})})},getQuestion:function(e,n){var r=this;this.callApiReliable("get_action",[e],function(e){var t=r.dataFactory.newQuestion(e);r.sendNotification("notify_update_question",t),null!=n&&n(t)})},searchMessages:function(t,n,r,a){var i=this;this.searchService.prepareForSearching(t,r),this.rpc.call("search_messages",[t.domainId,t.talkId,t.getQueryText(),n,r],function(e){i.searchService.isRecentParams(t)&&i.searchService.isSearching()&&i.searchService.saveSearchMessagesResult(new ie.entity.SearchMessagesResult(e)),null!=a&&a()},function(e){i.searchService.notifySearchMessagesFail(),400!=e.code||null==r?i.sendNotification("error_occurred",e):i.searchMessages(t,n,null,a)})},searchAttachments:function(t,n,r,a){var i=this;this.searchService.prepareForSearching(t,r),this.rpc.call("search_attachments",[t.domainId,t.talkId,t.getQueryText(),n,r],function(e){i.searchService.isRecentParams(t)&&i.searchService.isSearching()&&i.searchService.saveSearchAttachmentsResult(new ie.entity.SearchAttachmentsResult(e)),null!=a&&a()},function(e){i.searchService.notifySearchAttachmentsFail(),400!=e.code||null==r?i.sendNotification("error_occurred",e):i.searchAttachments(t,n,null,a)})},startUpdateLastUsedAtIfNeed:function(){if(null==this.lastUsedExpiredAtTimer){var e,t=this.settings.getLastUsedExpiredAt();(e=null==t?0:Z.int(ie.Int64Helper.toFloat(t)-(new Date).getTime()))<=0?(this.updateLastUsedAt(),this.lastUsedExpiredAtTimer=new oe.Timer(6e5),this.lastUsedExpiredAtTimer.run=_(this,this.updateLastUsedAt)):oe.Timer.delay(_(this,this.startUpdateLastUsedAtIfNeed),e)}},updateLastUsedAt:function(){var t=this;this.rpc.call("update_last_used_at",[],function(e){t.settings.setLastUsedExpiredAt(ie.DateTimeHelper.afterAsInt64(6e5))})},addFavoriteTalk:function(e,t){this.rpc.call("add_favorite_talk",[e,t])},deleteFavoriteTalk:function(e,t){this.rpc.call("delete_favorite_talk",[e,t])},disablePushNotification:function(e,t){this.rpc.call("disable_push_notification",[e,t])},enablePushNotification:function(e,t){this.rpc.call("enable_push_notification",[e,t])},getSolutions:function(e,t){var n=this;this.rpc.call("get_solutions",[e,t],function(e){ae.iter(e,_(p=n.dataFactory,p.newSolution)),n.sendNotification("solutions_loaded")})},getPresences:function(e,a){var i=this;this.rpc.call("get_presences",[e,a],function(e){var t,n,r=ie.DateTimeHelper.nowAsInt64();ae.iter(e,(p=i.dataFactory,t=_(p,p.newUserPresence),n=r,function(e){return t(e,n)})),i.sendNotification("presences_updated",a)})},asInt:function(e){return C.Boot.__cast(e,f)},callApiReliable:function(e,t,n,a,i){var o=this;null==i&&(i=function(e){return 404==e.code?oe.ds.Option.Some(1e3):oe.ds.Option.None});var s=null;(s=function(r){o.rpc.call(e,t,n,function(e){var t;switch(t=0==r?oe.ds.Option.None:i(e),ie.OptionHelper.foreach(t,function(e){var t,n;oe.Timer.delay((t=s,n=r-1,function(){return t(n)}),e)}),t[1]){case 0:break;case 1:null==a?o.rpc.onServerError(e):a(e)}})})(3)},__class__:ie.proxy.AlberoServiceProxy}),ie.proxy.AppStateProxy=function(){l.patterns.proxy.Proxy.call(this,"appState")},n["albero.proxy.AppStateProxy"]=ie.proxy.AppStateProxy,ie.proxy.AppStateProxy.__name__=["albero","proxy","AppStateProxy"],ie.proxy.AppStateProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.AppStateProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{start:function(){this.updateLastActivityAt(),this.checkInactiveInterval()},activateAppIfNeed:function(){this.updateLastActivityAt(),this.appState==ie.AppState.Inactive&&this.setAppState(ie.AppState.Active)},setAppState:function(e){se._d(se.dateStr(),"APP_STATE_CHANGED: ",e,"","",""),this.appState=e,this.sendNotification("app_state_changed",this.appState)},updateLastActivityAt:function(){this.lastActivityAt=new Date},checkInactiveInterval:function(){var e=this;this.checkInactive(),oe.Timer.delay(function(){e.checkInactiveInterval()},500)},checkInactive:function(){this.appState!=ie.AppState.Inactive&&((new Date).getTime()-this.lastActivityAt.getTime()<2e3||this.setAppState(ie.AppState.Inactive))},__class__:ie.proxy.AppStateProxy}),ie.proxy.DataFactoryProxy=function(){this.dummyFileId=new oe.Int64(-1,-1),this.dummyMsgId=new oe.Int64(-1,-1),l.patterns.proxy.Proxy.call(this,"dataFactory")},n["albero.proxy.DataFactoryProxy"]=ie.proxy.DataFactoryProxy,ie.proxy.DataFactoryProxy.__name__=["albero","proxy","DataFactoryProxy"],ie.proxy.DataFactoryProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.DataFactoryProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{onRegister:function(){},newAcquaintance:function(e){return this.dataStore.addAcquaintance(this.newDomainUser(e))},newFriend:function(e){return this.dataStore.addFriend(this.newDomainUser(e))},newDomainUser:function(e){return new ie.entity.DomainUser(e)},newDomain:function(e){return this.dataStore.setDomainIfLatest(new ie.entity.Domain(e))},newDomainInvite:function(e){return this.dataStore.setDomainInvite(new ie.entity.DomainInvite(e))},newTalk:function(e){return this.dataStore.setTalk(new ie.entity.Talk(e))},newTalkStatus:function(e){return this.dataStore.setTalkStatus(new ie.entity.TalkStatus(e))},newMessage:function(e){var t,n,r=new ie.entity.Message(e);switch(r.type[1]){case 4:this.fileInfoStore.setMessageFileInfos(r.id,[ie.entity.FileInfo.fromMessageAndFile(r,r.content)]);break;case 5:this.fileInfoStore.setMessageFileInfos(r.id,ie.ArrayHelper.asArray(r.content.files).map((t=ie.entity.FileInfo.fromMessageAndFile,n=r,function(e){return t(n,e)})))}return this.messageStore.setMessage(r),r},newDummyMessage:function(e,t,n){var r=this,a=new ie.entity.Message;switch(a.id=this.dummyMsgId,a.userId=this.dataStore.me.id,a.talkId=e,a.type=t,a.content=n,this.dummyMsgId=ie.Int64Helper.decrement(this.dummyMsgId),a.type[1]){case 4:var i=[this.createDummyFileInfo(a,a.content)];this.fileInfoStore.setMessageFileInfos(a.id,i);break;case 5:var o=C.Boot.__cast(a.content.files,Array).map(function(e){return r.createDummyFileInfo(a,e)});this.fileInfoStore.setMessageFileInfos(a.id,o)}return this.messageStore.setMessage(a),a},newDummyFileMessage:function(e,t,n){var r=this.createFileInfoDynamic(t,n);return this.newDummyMessage(e,ie.entity.MessageType.file,r)},newDummyMultipleFileMessage:function(e,t,n,r){var a,i,o=ae.array(n.filter(function(e){return null!=e}).map((a=_(this,this.createFileInfoDynamic),i=r,function(e){return a(e,i)})));return this.newDummyMessage(e,ie.entity.MessageType.textMultipleFile,{text:t,files:o})},createFileInfoDynamic:function(e,t){return{content_type:e.type,content_size:e.size,name:t(e.name),file:e}},createDummyFileInfo:function(e,t){var n=ie.entity.FileInfo.fromMessageAndFileWithFileId(e,t,this.dummyFileId);return this.dummyFileId=ie.Int64Helper.decrement(this.dummyFileId),n},newQuestion:function(e){return this.dataStore.setQuestion(new ie.entity.Question(e))},newFileInfo:function(e){var t=new ie.entity.FileInfo(e);return this.fileInfoStore.setTalkFileInfo(t,!0),t},newAnnouncement:function(e){return new ie.entity.Announcement(e)},newAnnouncementStatus:function(e){return this.dataStore.setAnnouncementStatus(new ie.entity.AnnouncementStatus(e))},newAnnouncementStatusForDomain:function(e){var t=new ie.entity.AnnouncementStatus;return t.domainId=e,t.unreadCount=0,this.dataStore.setAnnouncementStatus(t)},newAccountControlRequest:function(e){return this.dataStore.setAccountControlRequest(new ie.entity.AccountControlRequest(e))},newAccountControlGroup:function(e){return this.dataStore.setAccountControlGroup(new ie.entity.AccountControlGroup(e))},newSolution:function(e){var t=new ie.entity.Solution(e);return this.solutionsStore.setSolution(t),t},newUserPresence:function(e,t){var n=new ie.entity.UserPresence(e,t);return this.dataStore.setUserPresence(n),n},__class__:ie.proxy.DataFactoryProxy}),ie.proxy.DataStoreProxy=function(){l.patterns.proxy.Proxy.call(this,"dataStore")},n["albero.proxy.DataStoreProxy"]=ie.proxy.DataStoreProxy,ie.proxy.DataStoreProxy.__name__=["albero","proxy","DataStoreProxy"],ie.proxy.DataStoreProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.DataStoreProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{onRegister:function(){this.init()},setMe:function(e){this.me=e;for(var t=0,n=this.getDomains();t<n.length;){var r=n[t];++t,this.sendNotification("notify_update_user",this.me.toDomainUser(r.id))}this.sendNotification("current_user_changed",e),this.storage.setDirtyFlag()},getMe:function(){return this.me},isMe:function(e){return null!=this.me&&ie.Int64Helper.eq(this.me.id,e)},getFriendsOrAcquaintances:function(e){var t=this.users.get("_"+e.high+"_"+e.low),n=[];if(null!=t)for(var r=t.iterator();r.hasNext();){var a=r.next();0!=a.type&&1!=a.type||n.push(a.user)}return n},getFriends:function(e){var t=this.users.get("_"+e.high+"_"+e.low),n=[];if(null!=t)for(var r=t.iterator();r.hasNext();){var a=r.next();0==a.type&&n.push(a.user)}return n},getAcquaintances:function(e){var t=this.users.get("_"+e.high+"_"+e.low),n=[];if(null!=t)for(var r=t.iterator();r.hasNext();){var a=r.next();1==a.type&&n.push(a.user)}return n},isFriend:function(e,t){var n=this.users.get("_"+e.high+"_"+e.low);if(null!=n){var r=n.get("_"+t.high+"_"+t.low);return null!=r&&0==r.type}return!1},addFriend:function(e){var t=this.ensureDomainUserMap(e.domainId),n=ie.Int64Helper.idStr(e.id);return t.set(n,{type:0,user:e}),this.storage.setDirtyFlag(),e},addAcquaintance:function(e){var t=this.ensureDomainUserMap(e.domainId),n=ie.Int64Helper.idStr(e.id);return t.set(n,{type:1,user:e}),this.storage.setDirtyFlag(),e},ensureDomainUserMap:function(e){var t="_"+e.high+"_"+e.low,n=this.users.get(t);return null==n&&(n=new oe.ds.StringMap,this.users.set(t,n)),n},setUserIfLatest:function(e,t){null==e&&(e=this.ensureDomainUserMap(t.domainId));var n=ie.Int64Helper.idStr(t.id),r=e.get(n);if(null!=r){var a=oe.Int64.compare(t.updatedAt,r.user.updatedAt);(1<a||2==r.type&&0!=a)&&(r.user=t,this.sendNotification("notify_update_user",t))}else e.set(n,{type:2,user:t});this.storage.setDirtyFlag()},setUserPresence:function(e){null==this.userPresences&&(this.userPresences=new oe.ds.StringMap);var t=ie.Int64Helper.idStr(e.userId);this.userPresences.set(t,e),this.storage.setDirtyFlag()},getUserPresence:function(e){return null==this.userPresences?null:this.userPresences.get("_"+e.high+"_"+e.low)},isDepartmentsChanged:function(e,t){return!ie.Int64Helper.eqArray(e.departments,t.departments)},setUsersIfLatest:function(e,t){var n,r,a=this.ensureDomainUserMap(e);ae.iter(t,(n=_(this,this.setUserIfLatest),r=a,function(e){return n(r,e)}))},clearUsersDepartments:function(e){var t=this.users.get("_"+e.high+"_"+e.low);if(null!=t)for(var n=t.iterator();n.hasNext();){var r=n.next();r.user.departments=null,this.sendNotification("notify_update_user",r.user)}this.storage.setDirtyFlag()},removeFriend:function(e,t){var n=this.users.get("_"+e.high+"_"+e.low);if(null!=n){var r=n.get("_"+t.high+"_"+t.low);null!=r&&(r.type=2)}this.storage.setDirtyFlag()},removeAcquaintance:function(e,t){this.removeFriend(e,t)},getUser:function(e,t){if(null==t)return null;if(0==(t.high|t.low))return null;if(null!=this.me&&ie.Int64Helper.eq(this.me.id,t))return this.me.toDomainUser(e);var n=this.users.get("_"+e.high+"_"+e.low);if(null!=n){var r=n.get("_"+t.high+"_"+t.low);if(null!=r)return r.user}return null},getUsers:function(e,t){var i=this,n=function(n,e){var r=i.users.get("_"+n.high+"_"+n.low);if(null!=r){if(null!=e)return e.map(function(e){if(0==(e.high|e.low))return null;if(ie.Int64Helper.eq(i.me.id,e))return i.me.toDomainUser(n);var t=r.get("_"+e.high+"_"+e.low);return null!=t?t.user:null});for(var t=new Array,a=r.iterator();a.hasNext();)t.push(a.next().user);return t}return new Array};if(null!=e)return n(e,t);for(var r=this.domains.iterator(),a=null;r.hasNext();)a=null==a?n(r.next().id,t):a.concat(n(r.next().id,t));return null==a?[]:a},getTalk:function(e){return this.talks.get("_"+e.high+"_"+e.low)},getTalkPack:function(e){var t="_"+e.high+"_"+e.low;return new ie.entity.TalkPack(this.talks.get(t),this.talkStatuses.get(t))},getValidPairTalk:function(t,n){var r=this;return null==this.me?null:ae.find(this.getTalks(),function(e){return!!te.enumEq(e.type,ie.entity.TalkType.PairTalk)&&(!!ie.Int64Helper.eq(e.domainId,n)&&(!!ae.exists(e.userIds,function(e){return null!=e&&null!=t&&e.high==t.high&&e.low==t.low})&&!!ae.exists(e.userIds,function(e){return ie.Int64Helper.eq(e,r.me.id)})))})},setTalk:function(e){var t=ie.Int64Helper.idStr(e.id);if(this.talks.set(t,e),null!=e.leftUsers)for(var n=this.ensureDomainUserMap(e.domainId),r=0,a=e.leftUsers;r<a.length;){var i=a[r];++r;var o=ie.Int64Helper.idStr(i.id),s=n.get(o);null!=s?2==s.type&&0<oe.Int64.compare(i.updatedAt,s.user.updatedAt)&&(s.user=i,this.sendNotification("notify_update_user",i)):(n.set(o,{type:2,user:i}),this.sendNotification("notify_update_user",i))}return this.storage.setDirtyFlag(),e},getTalks:function(){for(var e=new Array,t=this.talks.keys();t.hasNext();){var n=t.next();e.push(this.talks.get(n))}return e},setTalks:function(e){ae.iter(e,_(this,this.setTalk))},removeTalk:function(e){if(null!=this.domainUnreadCounts){var t=this.talks.get("_"+e.high+"_"+e.low);if(null!=t){var n=ie.Int64Helper.idStr(t.domainId);this.domainUnreadCounts.remove(n)}}if(null!=this.questions)for(var r=this.getQuestions(e),a=0;a<r.length;){var i=r[a];++a;var o=ie.Int64Helper.idStr(i.id);this.questions.remove(o)}this.talks.remove("_"+e.high+"_"+e.low),this.storage.setDirtyFlag()},getTalkStatuses:function(){for(var e=new Array,t=this.talkStatuses.keys();t.hasNext();){var n=t.next();this.talks.exists(n)&&e.push(this.talkStatuses.get(n))}return e},getTalkStatus:function(e){return this.talkStatuses.get("_"+e.high+"_"+e.low)},setTalkStatus:function(e){var t=ie.Int64Helper.idStr(e.id);if(null!=this.domainUnreadCounts){var n=this.talks.get(t);if(null!=n){var r=ie.Int64Helper.idStr(n.domainId);this.domainUnreadCounts.remove(r)}}return this.talkStatuses.set(t,e),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),e},removeTalkStatus:function(e){var t="_"+e.high+"_"+e.low;if(null!=this.domainUnreadCounts){var n=this.talks.get(t);if(null!=n){var r=ie.Int64Helper.idStr(n.domainId);this.domainUnreadCounts.remove(r)}}this.talkStatuses.remove(t),this.storage.setDirtyFlag()},getDomains:function(){for(var e=new Array,t=this.domains.iterator();t.hasNext();){var n=t.next();e.push(n)}return e},getDomain:function(e){return this.domains.get("_"+e.high+"_"+e.low)},setDomainIfLatest:function(e){var t=ie.Int64Helper.idStr(e.id),n=this.domains.get(t);return null==n||0<=oe.Int64.compare(e.updatedAt,n.updatedAt)?(this.domains.set(t,e),this.storage.setDirtyFlag(),e):n},removeDomain:function(t){this.domains.remove("_"+t.high+"_"+t.low),this.storage.setDirtyFlag();for(var e=this.getTalks().filter(function(e){return ie.Int64Helper.eq(e.domainId,t)}),n=0;n<e.length;){var r=e[n];++n,this.removeTalk(r.id),this.removeTalkStatus(r.id)}},getUnreadCount:function(){for(var e=0,t=this.domains.keys();t.hasNext();){var n=t.next();e+=this._getDomainUnreadCount(n)}return e+=this.getDomainInvitesCount()},_getDomainUnreadCount:function(e){if(null!=this.domainUnreadCounts&&this.domainUnreadCounts.exists(e))return this.domainUnreadCounts.get(e);null==this.domainUnreadCounts&&(this.domainUnreadCounts=new oe.ds.StringMap);for(var t=0,n=this.talkStatuses.iterator();n.hasNext();){var r=n.next();if(null!=r.unreadCount&&0!=r.unreadCount){var a,i=ie.Int64Helper.idStr(r.id);null!=(a=this.talks.get(i))&&ie.Int64Helper.idStr(a.domainId)==e&&(t+=r.unreadCount)}}var o=this.announcementStatuses.get(e);if(null!=o&&null!=o.unreadCount){var s=this.domains.get(e);null!=s&&s.role.allowReadAnnouncements&&(t+=o.unreadCount)}return this.domainUnreadCounts.set(e,t),t},getDomainUnreadCount:function(e){return null==e?0:this._getDomainUnreadCount("_"+e.high+"_"+e.low)},getDomainInvites:function(){for(var e=new Array,t=this.domainInvites.keys();t.hasNext();){var n=t.next();e.push(this.domainInvites.get(n))}return e},getDomainInvitesCount:function(){var e=0;if(null==this.accountControlGroup)for(var t=this.domainInvites.iterator();t.hasNext();){var n=t.next();null!=n.accountControlRequestId&&null!=this.getAccountControlRequest(n.accountControlRequestId)||e++}else for(var r=this.domainInvites.iterator();r.hasNext();){r.next();e++}return e},getDomainInvite:function(e){return this.domainInvites.get("_"+e.high+"_"+e.low)},setDomainInvite:function(e){var t=ie.Int64Helper.idStr(e.id);return this.domainInvites.set(t,e),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),e},removeDomainInvite:function(e){this.domainInvites.remove("_"+e.high+"_"+e.low),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag()},getQuestions:function(e,t){var n=[];if(null!=this.questions)for(var r=this.questions.iterator();r.hasNext();){var a=r.next();ie.Int64Helper.eq(a.talkId,e)&&((null==t||ie.Int64Helper.eq(t,a.userId))&&n.push(a))}return n},getQuestion:function(e){return this.questions.get("_"+e.high+"_"+e.low)},setQuestion:function(e){return e},getAnnouncementStatus:function(e){return this.announcementStatuses.get("_"+e.high+"_"+e.low)},setAnnouncementStatus:function(e){var t=ie.Int64Helper.idStr(e.domainId);return this.announcementStatuses.set(t,e),null!=this.domainUnreadCounts&&this.domainUnreadCounts.remove(t),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),e},removeAnnouncementStatus:function(e){var t="_"+e.high+"_"+e.low;this.announcementStatuses.remove(t),null!=this.domainUnreadCounts&&this.domainUnreadCounts.remove(t),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag()},getAccountControlRequests:function(){for(var e=new Array,t=this.accountControlRequests.iterator();t.hasNext();){var n=t.next();e.push(n)}return e},getAccountControlRequest:function(e){var t="_"+e.high+"_"+e.low;return this.accountControlRequests.get(t)},setAccountControlRequest:function(e){var t=ie.Int64Helper.idStr(e.id),n=this.accountControlRequests.get(t);return null!=n&&n.version>e.version?n:(this.accountControlRequests.set(t,e),this.storage.setDirtyFlag(),e)},removeAccountControlRequest:function(e){var t="_"+e.high+"_"+e.low;this.accountControlRequests.remove(t),this.storage.setDirtyFlag()},removeAccountControlRequests:function(){this.accountControlRequests=new oe.ds.StringMap,this.storage.setDirtyFlag()},getAccountControlGroup:function(){return this.accountControlGroup},setAccountControlGroup:function(e){return this.accountControlGroup=e,this.storage.setDirtyFlag(),this.accountControlGroup},updateAccountControlGroup:function(e){if(null!=this.accountControlGroup&&ie.Int64Helper.eq(this.accountControlGroup.id,e.id)){var t=e.group;null!=t&&this.accountControlGroup.group.version<t.version&&(this.accountControlGroup.group=t,this.storage.setDirtyFlag());var n=e.profilePolicy;null!=n&&this.accountControlGroup.profilePolicy.version<n.version&&(this.accountControlGroup.profilePolicy=n,this.storage.setDirtyFlag())}},removeAccountControlGroup:function(e){null!=this.accountControlGroup&&ie.Int64Helper.eq(this.accountControlGroup.id,e)&&(this.accountControlGroup=null,this.storage.setDirtyFlag())},clear:function(e){this.users=new oe.ds.StringMap,this.talks=new oe.ds.StringMap,this.talkStatuses=new oe.ds.StringMap,this.domains=new oe.ds.StringMap,this.domainInvites=new oe.ds.StringMap,this.questions=new oe.ds.StringMap,this.announcementStatuses=new oe.ds.StringMap,this.accountControlRequests=new oe.ds.StringMap,this.accountControlGroup=null,e&&(this.me=null),this.storage.setDirtyFlag()},init:function(){this.storage=new ie.js.LocalStorage("dataStore");var e=this.storage.load();if(null!=e&&"1.99_1"==e.shift())return this.me=e.shift(),this.users=e.shift(),this.talks=e.shift(),this.talkStatuses=e.shift(),this.domains=e.shift(),this.domainInvites=e.shift(),this.questions=e.shift(),this.announcementStatuses=e.shift(),this.accountControlRequests=e.shift(),this.accountControlGroup=e.shift(),void se._d(se.dateStr(),"dataStore is loaded.","","","","");this.clear(!0),se._d(se.dateStr(),"dataStore is initialized.","","","","")},saveIfNeeded:function(){this.storage.isDirty&&(this.storage.save(["1.99_1",this.me,this.users,this.talks,this.talkStatuses,this.domains,this.domainInvites,this.questions,this.announcementStatuses,this.accountControlRequests,this.accountControlGroup]),se._d(se.dateStr(),"dataStore is saved.","","","",""))},__class__:ie.proxy.DataStoreProxy}),ie.proxy.DepartmentStoreProxy=function(){l.patterns.proxy.Proxy.call(this,"departmentStore"),this.departmentMap=new oe.ds.StringMap,this.rootDepartmentIdMap=new oe.ds.StringMap},n["albero.proxy.DepartmentStoreProxy"]=ie.proxy.DepartmentStoreProxy,ie.proxy.DepartmentStoreProxy.__name__=["albero","proxy","DepartmentStoreProxy"],ie.proxy.DepartmentStoreProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.DepartmentStoreProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{getDepartment:function(e){return null==e?null:this.departmentMap.get("_"+e.high+"_"+e.low)},setDepartment:function(e){if(null!=e.parentId){var t=this.getDepartment(e.parentId);null!=t&&(t.addChild(e.id),e.depth=t.depth+1)}var n=ie.Int64Helper.idStr(e.id);this.departmentMap.set(n,e)},clearDomainDepartment:function(e){var n=this,t="_"+e.high+"_"+e.low,r=this.rootDepartmentIdMap.get(t);null!=r&&(ae.iter(this.getDepartmentsDescendantOrSelf(r),function(e){var t=ie.Int64Helper.idStr(e.id);n.departmentMap.remove(t)}),this.rootDepartmentIdMap.remove(t))},getRootDepartmentId:function(e){return this.rootDepartmentIdMap.get("_"+e.high+"_"+e.low)},setRootDepartmentId:function(e,t){this.rootDepartmentIdMap.set("_"+e.high+"_"+e.low,t)},setDepartmentUserCount:function(e){var t=this.getDepartment(e.departmentId);null!=t&&(t.userCount=e,t.userCountLoading=!1)},setUserCountLoading:function(e,t){var n=this.getDepartment(e);null!=n&&(n.userCountLoading=t)},needUserCountLoading:function(e){var t=this.getDepartment(e);return null==t||null==t.userCount&&!t.userCountLoading},clearDomainDepartmentUsers:function(e){var t=this.getRootDepartmentId(e);null!=t&&(ae.iter(this.getDepartmentsDescendantOrSelf(t),function(e){e.userCount=null,e.userIds=null,e.userCountLoading=!1}),this.sendNotification("department_user_count_cleared",e))},setDepartmentUsers:function(e,t){var n=this.getDepartment(e);null!=n&&(n.userIds=t)},getDepartmentPath:function(e){return this.getDepartmentsAncestorOrSelf(e)},getDepartmentPathWithoutRoot:function(e){return this.getDepartmentPath(e).filter(function(e){return!e.isRoot()})},getDepartmentsAncestorOrSelf:function(e){var t=[];return this._getDepartmentsAncestorOrSelf(e,t),t},_getDepartmentsAncestorOrSelf:function(e,t){var n=this.getDepartment(e);null!=n&&(null!=n.parentId&&this._getDepartmentsAncestorOrSelf(n.parentId,t),t.push(n))},getDepartmentsDescendantOrSelf:function(e){var t=[];return this._getDepartmentsDescendantOrSelf(e,t),t},_getDepartmentsDescendantOrSelf:function(e,t){var n=this,r=this.getDepartment(e);null!=r&&(t.push(r),null!=r.childrenIds&&ae.iter(r.childrenIds,function(e){n._getDepartmentsDescendantOrSelf(e,t)}))},__class__:ie.proxy.DepartmentStoreProxy}),ie.proxy.FeaturesProxy=function(){l.patterns.proxy.Proxy.call(this,"features")},n["albero.proxy.FeaturesProxy"]=ie.proxy.FeaturesProxy,ie.proxy.FeaturesProxy.__name__=["albero","proxy","FeaturesProxy"],ie.proxy.FeaturesProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.FeaturesProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{canSendMessageOnMultiView:function(e){return this.settings.isOnPremises()||this.selectedDomainHasSolution(e,ie.entity.SolutionType.MultiView)},canDetectKeyword:function(e){return this.settings.isOnPremises()||this.selectedDomainHasSolution(e,ie.entity.SolutionType.KeywordWatching)},selectedDomainHasSolution:function(e,t){if(null==e)return!1;var n=this.dataStore.getDomain(e);return null!=n&&null!=n.contract&&null!=n.contract.solutionIds&&ae.exists(n.contract.solutionIds,function(e){return ie.entity.Solution.getSolutionType(e)==t})},__class__:ie.proxy.FeaturesProxy}),ie.proxy.FileInfoStoreProxy=function(){l.patterns.proxy.Proxy.call(this,"fileInfoStore"),this.fileInfoMap=new oe.ds.StringMap,this.fileIdStrsMap=new oe.ds.StringMap,this.messageFileIdStrsMap=new oe.ds.StringMap,this.stagedFileInfosMaxId=0},n["albero.proxy.FileInfoStoreProxy"]=ie.proxy.FileInfoStoreProxy,ie.proxy.FileInfoStoreProxy.__name__=["albero","proxy","FileInfoStoreProxy"],ie.proxy.FileInfoStoreProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.FileInfoStoreProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{getStagedFileIdsKey:function(e,t){return"staged__"+e.high+"_"+e.low+ie.entity.TalkPaneSelection.toPanePrefix(t)},ensureStagedFileInfos:function(e,t){return this.ensureStagedFileIdStrs(e,t).map(ie.Int64Helper.makeFromIdStr).filter(function(e){return null!=e}).map(_(this,this.getFileInfo))},moveStagedFile:function(e,t,n,r){var a=this.ensureStagedFileIdStrs(e,t);if(null!=a){var i=a[n];Y.remove(a,i),a.splice(r,0,i)}},ensureStagedFileIdStrs:function(e,t){var n=this.getStagedFileIdsKey(e,t),r=this.fileIdStrsMap.get(n);return null==r&&(r=[],this.fileIdStrsMap.set(n,r)),r},addStagedFileInfo:function(e,t,n,r){var a=new ie.entity.FileInfo;a.id=oe.Int64.make(0,--this.stagedFileInfosMaxId),a.talkId=e,null!=n&&(a.contentType=n.type,a.contentSize=n.size,a.url=URL.createObjectURL(ie.proxy.FileServiceProxy.getBlobFromUpdatableFile(n)),a.file=n,a.name=n.name),null!=r&&(a.thumbUrl=URL.createObjectURL(r.blob));var i=ie.Int64Helper.idStr(a.id);return this.fileInfoMap.set(i,a),this.ensureStagedFileIdStrs(e,t).push(ie.Int64Helper.idStr(a.id)),a},removeStagedFileInfo:function(e,t,n){var r="_"+n.high+"_"+n.low,a=this.ensureStagedFileIdStrs(e,t);Y.remove(a,r),this.fileInfoMap.remove(r)},removeStagedFileInfos:function(e,t){for(var n=0,r=this.ensureStagedFileIdStrs(e,t);n<r.length;){var a=r[n];++n,this.fileInfoMap.remove(a)}var i=this.getStagedFileIdsKey(e,t);this.fileIdStrsMap.remove(i)},ensureTalkFileInfos:function(e){return this.ensureTalkFileIds(e).map(_(this,this.fileInfoGetter))},ensureTalkFileIds:function(e){var t="_"+e.high+"_"+e.low,n=this.fileIdStrsMap.get(t);return null==n&&(n=new Array,this.fileIdStrsMap.set(t,n)),n},getTalkFileInfo:function(e,t,n){return this.getFileInfo(n)},setTalkFileInfo:function(e,t){var n=ie.Int64Helper.idStr(e.id);this.fileInfoMap.set(n,e);var r=this.ensureTalkFileIds(e.talkId);-1==Y.indexOf(r,n,0)&&r.push(n)},onFileDeleted:function(e){var t=this.getTalkFileInfo(e.talkId,e.messageId,e.fileId);null!=t&&(t.deleted=!0)},getFileInfo:function(e){return this.fileInfoMap.get("_"+e.high+"_"+e.low)},getMessageFileInfos:function(e){var t=this;return ie.OptionHelper.map(ie.OptionHelper.option(this.messageFileIdStrsMap.get("_"+e.high+"_"+e.low)),function(e){return e.map(_(t,t.fileInfoGetter))})},setMessageFileInfos:function(e,t){for(var n=0;n<t.length;){var r=t[n];++n;var a=ie.Int64Helper.idStr(r.id);this.fileInfoMap.set(a,r)}var i=t.map(_(this,this.fileIdStrGetter));this.messageFileIdStrsMap.set("_"+e.high+"_"+e.low,i)},removeMessageFileInfos:function(e){this.messageFileIdStrsMap.remove("_"+e.high+"_"+e.low)},isAllFileDeletedOnMessage:function(e){return!ae.exists((n=this.getMessageFileInfos(e),function(e){var t;switch(n[1]){case 0:t=n[2];break;case 1:t=[]}return t}()),function(e){return!e.deleted});var n},fileIdStrGetter:function(e){return ie.Int64Helper.idStr(e.id)},fileInfoGetter:function(e){return this.fileInfoMap.get(e)},__class__:ie.proxy.FileInfoStoreProxy}),ie.proxy.FileServiceProxy=function(){l.patterns.proxy.Proxy.call(this,"fileService"),this.validHost=this.getValidHost()},n["albero.proxy.FileServiceProxy"]=ie.proxy.FileServiceProxy,ie.proxy.FileServiceProxy.__name__=["albero","proxy","FileServiceProxy"],ie.proxy.FileServiceProxy.createByteSizeStringWithUnit=function(e){return ie.FileHelper.createByteSizeStringWithUnit(e)},ie.proxy.FileServiceProxy.convertUploadableFile=function(e){if(null==e)return e;var t=!1,n=e.name;ie.StringHelper.isEmpty(n)&&(n="clipboard_"+ie.DateTimeHelper.getDateStringForFile()+".png",t=!0);var r=ie.proxy.FileServiceProxy.getContentTypeByFileName(n,e.type);return r!=e.type&&(t=!0),t?{name:n,type:r,file:n,blob:e,size:e.size}:e},ie.proxy.FileServiceProxy.getBlobFromUpdatableFile=function(e){return null==e.blob?e:e.blob},ie.proxy.FileServiceProxy.getContentTypeByFileName=function(e,t){if(ie.StringHelper.isNotEmpty(t))return"csv"==ie.proxy.FileServiceProxy.getExtension(e)?"text/csv":t;switch(ie.proxy.FileServiceProxy.getExtension(e)){case"txt":return"text/plain";case"md":return"text/markdown";case"csv":return"text/csv";case"htm":case"html":return"text/html";case"xml":return"text/xml";case"gif":return"image/gif";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"pdf":return"application/pdf";case"doc":return"application/msword";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case"docm":return"application/vnd.ms-word.document.macroenabled.12";case"xls":return"application/vnd.ms-excel";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"xlsm":return"application/vnd.ms-excel.sheet.macroenabled.12";case"xlsb":return"application/vnd.ms-excel.sheet.binary.macroenabled.12";case"ppt":return"application/vnd.ms-powerpoint";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation";case"pptm":return"application/vnd.ms-powerpoint.presentation.macroenabled.12";default:return"application/octet-stream"}},ie.proxy.FileServiceProxy.getExtension=function(e){if(null==e)return"";var t=e.split("."),n=t.length;return 0==n?"":t[n-1]},ie.proxy.FileServiceProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.FileServiceProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{getValidHost:function(){return"https://"+v.host},downloadUrl:function(e,t){if(null==t&&(t=!1),null==e||0==e.length)return"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(ee.startsWith(e,this.validHost)){var n=this.settings.getAccessToken(),r=e;return-1!=e.indexOf("?")?r+="&":r+="?",r+="Authorization=ALB%20"+n,t&&(r+="&download=true"),r}return e},download:function(e,r,a){var i=this;if(e=this.downloadUrl(e),ee.startsWith(e,"data:"))a(null);else{var t=C.Node.require("url").parse(e);null!=v.proxyURL&&(t.agent=ie.js.ProxyHelper.createAgent(v.proxyURL));var n=C.Node.require("https").request(t,function(e){var t=e.headers.location;if(null==t)if(2==Math.floor(e.statusCode/100)){var n=C.Node.require("fs").createWriteStream(r);e.on("data",function(e){n.write(e)}),e.on("end",function(){n.end(),n.on("finish",function(){a(r)})}),e.on("error",function(e){a(null)}),n.on("error",function(e){a(null)})}else a(null);else i.download(t,r,a)});n.on("error",function(e){a(null)}),n.end()}},upload:function(e,t,n,r,a){var i=this,o=C.Node.require("url").parse(e.put_url);o.method="PUT",o.headers={},o.headers["Content-Length"]=n.size,o.headers["Content-Type"]=e.post_form["Content-Type"],o.headers["Content-Disposition"]=e.post_form["Content-Disposition"],null!=v.proxyURL&&(o.agent=ie.js.ProxyHelper.createAgent(v.proxyURL));var s=C.Node.require("https").request(o,function(e){if(2!=Math.floor(e.statusCode/100)){var t="";return e.on("data",function(e){t+=e}),void e.on("end",function(){i.uploadFailed({responseText:e.statusCode+": "+t},a)})}r()});s.on("error",function(e){i.uploadFailed({responseText:e.message},a)});var l=C.Node.require("fs").createReadStream(n.path);l.on("data",function(e){s.write(e)}),l.on("end",function(){s.end()}),l.on("error",function(){s.end()})},uploadFailed:function(e,t){this.sendNotification("error_occurred",{message:ie.js.Localizer.localize("FileServiceProxy.failed_send_file")}),t(null)},createDummyFile:function(e,t,n){var r=ee.replace(e,"/","\\").split("\\");if(0==r.length)return null;var a=r[r.length-1];if(null!=t&&(a=t),0==a.length)return null;var i=ie.proxy.FileServiceProxy.getContentTypeByFileName(a,n);return{name:a,size:C.Node.require("fs").statSync(e).size,type:i,path:e}},createThumbnail:function(e,t){t(oe.ds.Option.None)},captureVideo:function(e,t,n){var r=e.width,a=e.height,i=t.videoWidth,o=t.videoHeight;o<i?r<i&&(o*=r/i,i=r):a<o&&(i*=a/o,o=a),o<1&&(o=1),i<1&&(i=1),e.height=0|o,e.width=0|i,e.getContext("2d").drawImage(t,0,0,i,o),this.craeteThumbFromCanvas(e,n)},normalizeImage:function(e,t,n){var r=e.width,a=e.height,i=t.width,o=t.height;o<i?r<i&&(o*=r/i,i=r):a<o&&(i*=a/o,o=a),o<1&&(o=1),i<1&&(i=1),e.height=0|o,e.width=0|i,this.drawImageWithAntialias(e,t),this.craeteThumbFromCanvas(e,n)},craeteThumbFromCanvas:function(n,r){try{n.toBlob(function(e){var t={name:"thumb.jpeg",type:"image/jpeg",file:"thumb.jpeg",blob:e,size:e.size};r(oe.ds.Option.Some(new ie.entity.ThumbInfo(t,n.width,n.height)))},"image/jpeg",.6)}catch(e){se._e(se.dateStr(),"failed to create thumbnail. error:",e,"","",""),r(oe.ds.Option.None)}},drawImageWithAntialias:function(e,t){var n=e.width,r=e.height,a=0|t.width,i=0|t.height;a<1&&(a=1),i<1&&(i=1),se._d(se.dateStr(),"drawImageWithAntialias",a,n,i,r);var o=window.document.createElement("canvas"),s=o.getContext("2d");o.width=a,o.height=i,s.drawImage(t,0,0);var l=window.document.createElement("canvas"),c=l.getContext("2d");l.width=a,l.height=i;for(var u=this.getOptSize(a,n),d=this.getOptSize(i,r);n<u||r<d;)se._d(se.dateStr(),"downsize",a,u,i,d),c.clearRect(0,0,a,i),c.drawImage(o,0,0,a,i,0,0,u,d),s.clearRect(0,0,a,i),s.drawImage(l,0,0,u,d,0,0,u,d),a=u,u=this.getOptSize(a,n),i=d,d=this.getOptSize(i,r);var p=e.getContext("2d");p.fillStyle="rgb(255, 255, 255)",p.fillRect(0,0,n,r),p.drawImage(o,0,0,a,i,0,0,n,r)},getOptSize:function(e,t){return t*Math.ceil(Math.log(e/t)/Math.log(2))},__class__:ie.proxy.FileServiceProxy}),ie.proxy.KeywordWatcherProxy=function(){l.patterns.proxy.Proxy.call(this,"keywordWatcher")},n["albero.proxy.KeywordWatcherProxy"]=ie.proxy.KeywordWatcherProxy,ie.proxy.KeywordWatcherProxy.__name__=["albero","proxy","KeywordWatcherProxy"],ie.proxy.KeywordWatcherProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.KeywordWatcherProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{onMessageCreated:function(e){if(null!=e){var t,n=ie.OptionHelper.map(ie.OptionHelper.option(this.dataStore.getTalk(e.talkId)),function(e){return e.domainId});switch(n[1]){case 0:t=n[2];break;case 1:t=this.settings.getSelectedDomainId()}if(this.features.canDetectKeyword(t)&&(this.settings.getBrowserSettings().keywordWatchingSelfMessage||!this.dataStore.isMe(e.userId))){var r=ie.mediator.helper.MessageStringMaker.messageStringForKeywordDetection(e,this.settings.getBrowserSettings().keywordWatchingActionReply);this.detectKeyword(r,e.type,e.id,t,e.talkId)}}},onAnnouncementCreated:function(e){if(null!=e&&this.features.canDetectKeyword(e.domainId)){var t=ie.mediator.helper.AnnouncementHelper.getDisplayTextWithoutEscape(e);this.detectKeyword(t,e.type,e.id,e.domainId,null)}},detectKeyword:function(o,s,l,c,u){var d=this;this.reserveOnNormalizedKeywordPrepared(function(e){for(var t=e.keys();t.hasNext();){var n=t.next(),r=e.get(n);if(null!=r&&0!=r.length&&ie.proxy.KeywordTypeHelper.match(s,n))for(var a=0;a<r.length;){var i=r[a];if(++a,0!=i.search(o).length)return void d.addkeywordDetection(c,u,l)}}})},reserveOnNormalizedKeywordPrepared:function(c){var u=this;ie.js.TextCanonicalizer.assureNormalize(function(e){var t=u.settings.getBrowserSettings().keywordWatchingText;if(u.cachedKeyword!=t){u.cachedKeyword=t,u.cachedNormalizedKeywordsMap=new oe.ds.EnumValueMap;for(var n=0,r=te.allEnums(ie.proxy.KeywordType);n<r.length;){var a=r[n];++n;var i=new Array;u.cachedNormalizedKeywordsMap.set(a,i)}for(var o=0,s=ie.proxy.KeywordParser.parse(t);o<s.length;){var l=s[o];++o,u.cachedNormalizedKeywordsMap.get(l.type).push(new ie.js.NFKCTextSearch(l.word,!0,e))}}c(u.cachedNormalizedKeywordsMap)})},addkeywordDetection:function(e,t,n){null==this.detectedDomainTalkIdStrings&&(this.detectedDomainTalkIdStrings=new oe.ds.StringMap);var r=this.getKey(e,t);if(null!=r)if(this.hasKeywordDetection(e,t))this.detectedDomainTalkIdStrings.set(r,n);else{this.detectedDomainTalkIdStrings.set(r,n);var a=this.settings.getBrowserSettings().keywordWatchingEmphasis;this.sendNotification("keyword_detaction_updated",{domainId:e,talkId:t,detected:!0,emphasis:a})}},readKeywordDetection:function(e,t,n){if(!this.settings.getBrowserSettings().keywordWatchingEmphasis){var r=this.getDetectId(e,t);se._d(se.dateStr(),"readKeywordDetection",r,n,"",""),null!=r&&0<=oe.Int64.compare(n,r)&&this.removeKeywordDetection(e,t)}},removeKeywordDetection:function(e,t){if(null!=this.detectedDomainTalkIdStrings){var n=this.getKey(e,t);if(null!=n){this.detectedDomainTalkIdStrings.remove(n);var r=this.settings.getBrowserSettings().keywordWatchingEmphasis;this.sendNotification("keyword_detaction_updated",{domainId:e,talkId:t,detected:!1,emphasis:r})}}},removeKeywordDetectionAll:function(){if(null!=this.detectedDomainTalkIdStrings)for(var e=this.settings.getBrowserSettings().keywordWatchingEmphasis,t=this.detectedDomainTalkIdStrings.keys();t.hasNext();){var n=t.next();if(ee.startsWith(n,"talk_")){var r=n.substring("talk_".length),a=ie.Int64Helper.makeFromIdStr(r);this.sendNotification("keyword_detaction_updated",{domainId:null,talkId:a,detected:!1,emphasis:e})}else if(ee.startsWith(n,"announcement_")){var i=n.substring("announcement_".length),o=ie.Int64Helper.makeFromIdStr(i);this.sendNotification("keyword_detaction_updated",{domainId:o,talkId:null,detected:!1,emphasis:e})}this.detectedDomainTalkIdStrings.remove(n)}},getDetectId:function(e,t){if(null==this.detectedDomainTalkIdStrings)return null;var n=this.getKey(e,t);return null==n?null:this.detectedDomainTalkIdStrings.get(n)},hasKeywordDetection:function(e,t){return null!=this.getDetectId(e,t)},getKey:function(e,t){return null==e&&null==t?null:null!=t?"talk__"+t.high+"_"+t.low:"announcement__"+e.high+"_"+e.low},__class__:ie.proxy.KeywordWatcherProxy}),ie.proxy.KeywordParser=function(){},n["albero.proxy.KeywordParser"]=ie.proxy.KeywordParser,ie.proxy.KeywordParser.__name__=["albero","proxy","KeywordParser"],ie.proxy.KeywordParser.parse=function(e){var t=ee.htmlEscape(e,!0),n=new o("&quot;(.*?)&quot;","g").map(t,function(e){return ie.proxy.KeywordParser.encodeSpace(e.matched(1))});return new o("[ ]","g").split(n).filter(ie.StringHelper.isNotEmpty).map(ie.proxy.KeywordParser.decodeSpace).map(ie.proxy.KeywordParser.createParsedKeyword)},ie.proxy.KeywordParser.encodeSpace=function(e){return ee.replace(ee.replace(e," ","&SPACE"),"","&FULL_PITCH_SPACE")},ie.proxy.KeywordParser.decodeSpace=function(e){return ee.replace(ee.replace(e,"&SPACE"," "),"&FULL_PITCH_SPACE","")},ie.proxy.KeywordParser.createParsedKeyword=function(e){var t=new o("\\[type:([A-Za-z]+)\\](.*)","g");if(t.match(e)){var n=t.matched(1),r=t.matched(2),a=ie.proxy.KeywordTypeHelper.getKeywordTypeByMessageTypeString(n);if(a!=ie.proxy.KeywordType.normal)return new ie.proxy.ParsedKeyword(a,r)}return new ie.proxy.ParsedKeyword(ie.proxy.KeywordType.normal,e)},ie.proxy.ParsedKeyword=function(e,t){this.type=e,this.word=t},n["albero.proxy.ParsedKeyword"]=ie.proxy.ParsedKeyword,ie.proxy.ParsedKeyword.__name__=["albero","proxy","ParsedKeyword"],ie.proxy.ParsedKeyword.prototype={__class__:ie.proxy.ParsedKeyword},ie.proxy.KeywordType=n["albero.proxy.KeywordType"]={__ename__:["albero","proxy","KeywordType"],__constructs__:["normal","selectOneReplyOnly","yesOrNoReplyOnly","todoDoneOnly"]},ie.proxy.KeywordType.normal=["normal",0],ie.proxy.KeywordType.normal.toString=s,ie.proxy.KeywordType.normal.__enum__=ie.proxy.KeywordType,ie.proxy.KeywordType.selectOneReplyOnly=["selectOneReplyOnly",1],ie.proxy.KeywordType.selectOneReplyOnly.toString=s,ie.proxy.KeywordType.selectOneReplyOnly.__enum__=ie.proxy.KeywordType,ie.proxy.KeywordType.yesOrNoReplyOnly=["yesOrNoReplyOnly",2],ie.proxy.KeywordType.yesOrNoReplyOnly.toString=s,ie.proxy.KeywordType.yesOrNoReplyOnly.__enum__=ie.proxy.KeywordType,ie.proxy.KeywordType.todoDoneOnly=["todoDoneOnly",3],ie.proxy.KeywordType.todoDoneOnly.toString=s,ie.proxy.KeywordType.todoDoneOnly.__enum__=ie.proxy.KeywordType,ie.proxy.KeywordType.__empty_constructs__=[ie.proxy.KeywordType.normal,ie.proxy.KeywordType.selectOneReplyOnly,ie.proxy.KeywordType.yesOrNoReplyOnly,ie.proxy.KeywordType.todoDoneOnly],ie.proxy.KeywordTypeHelper=function(){},n["albero.proxy.KeywordTypeHelper"]=ie.proxy.KeywordTypeHelper,ie.proxy.KeywordTypeHelper.__name__=["albero","proxy","KeywordTypeHelper"],ie.proxy.KeywordTypeHelper.getKeywordType=function(e){return null!=e?ie.proxy.KeywordTypeHelper.getKeywordTypeByMessageTypeString(ie.entity.Message.typeString(e)):ie.proxy.KeywordType.normal},ie.proxy.KeywordTypeHelper.getKeywordTypeByMessageTypeString=function(e){if(null!=e)switch(e){case"selectOneReply":return ie.proxy.KeywordType.selectOneReplyOnly;case"yesOrNoReply":return ie.proxy.KeywordType.yesOrNoReplyOnly;case"todoDone":return ie.proxy.KeywordType.todoDoneOnly}return ie.proxy.KeywordType.normal},ie.proxy.KeywordTypeHelper.match=function(e,t){switch(t[1]){case 0:return!0;case 1:return e==ie.entity.MessageType.selectOneReply;case 2:return e==ie.entity.MessageType.yesOrNoReply;case 3:return e==ie.entity.MessageType.todoDone}},ie.proxy.KeywordTypeHelper.createFilterClassStringFromMessageType=function(e){return ie.proxy.KeywordTypeHelper.createFilterClassString(ie.proxy.KeywordTypeHelper.getKeywordType(e))},ie.proxy.KeywordTypeHelper.createFilterClassString=function(e){return"keyword_type_"+Z.string(e)},ie.proxy.LimitationsProxy=function(){l.patterns.proxy.Proxy.call(this,"limitations")},n["albero.proxy.LimitationsProxy"]=ie.proxy.LimitationsProxy,ie.proxy.LimitationsProxy.__name__=["albero","proxy","LimitationsProxy"],ie.proxy.LimitationsProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.LimitationsProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{getMaxTalkers:function(){var t=this,e=ie.OptionHelper.flatMap(ie.OptionHelper.flatMap(ie.OptionHelper.option(this.settings.getSelectedDomainId()),function(e){return ie.OptionHelper.option(t.dataStore.getDomain(e))}),function(e){return e.getMaxTalkers()});switch(e[1]){case 0:return e[2];case 1:return this.settings.getConfiguration().maxTalkers}},__class__:ie.proxy.LimitationsProxy}),ie.proxy.MessageStoreProxy=function(){l.patterns.proxy.Proxy.call(this,"messageStore")},n["albero.proxy.MessageStoreProxy"]=ie.proxy.MessageStoreProxy,ie.proxy.MessageStoreProxy.__name__=["albero","proxy","MessageStoreProxy"],ie.proxy.MessageStoreProxy.findFileDynamic=function(e,n){return ae.find(e,function(e){var t=e.file_id;return null!=t&&null!=t&&null!=n&&t.high==n.high&&t.low==n.low})},ie.proxy.MessageStoreProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.MessageStoreProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{onRegister:function(){this.messages=new oe.ds.StringMap},getMessage:function(e){return null==e?oe.ds.Option.None:ie.OptionHelper.option(this.messages.get("_"+e.high+"_"+e.low))},setMessage:function(e){},removeMessage:function(e){this.messages.remove("_"+e.high+"_"+e.low)},onFileDeleted:function(r){ie.OptionHelper.foreach(this.getMessage(r.messageId),function(e){var t=e.getFilesDynamic();if(0!=t.length){var n=ie.proxy.MessageStoreProxy.findFileDynamic(t,r.fileId);null!=n&&(n.deleted=!0)}})},__class__:ie.proxy.MessageStoreProxy}),ie.proxy.MsgPackRpcProxy=function(){this.connectionStatus=ie.ConnectionStatus.Ok,l.patterns.proxy.Proxy.call(this,"rpc"),this.responseHandlers=new oe.ds.IntMap,this.errorHandler=_(this,this.onServerErrorWithMethod),this.connectionKeeper=new ie.proxy._MsgPackRpcProxy.ConnectionKeeper(_(this,this.ping))},n["albero.proxy.MsgPackRpcProxy"]=ie.proxy.MsgPackRpcProxy,ie.proxy.MsgPackRpcProxy.__name__=["albero","proxy","MsgPackRpcProxy"],ie.proxy.MsgPackRpcProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.MsgPackRpcProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{initWebSocket:function(){null==this.ws&&(this.ws=new ie.js.WebSocket(v.endpoint),this.ws.onopen=_(this,this.onOpen),this.ws.onmessage=_(this,this.onMessage),this.ws.onclose=_(this,this.onClose),this.ws.onpong=_(this,this.onPong),ie.proxy.MsgPackRpcProxy.pingAt=null)},finishWebSocket:function(){if(null==this.ws)return null;this.ws.onopen=null,this.ws.onmessage=null,this.ws.onerror=null,this.ws.onclose=null,this.ws.onpong=null,this.ws.close();var e=this.ws;return this.ws=null,ie.proxy.MsgPackRpcProxy.pingAt=null,e},onRegister:function(){this.initWebSocket(),this.connectionKeeper.start()},onRemove:function(){this.connectionKeeper.stop(),this.finishWebSocket()},onOpen:function(){this.connectionStatus=ie.ConnectionStatus.Ok,this.connectionKeeper.setConnected(!0),this.sendNotification("SignIn")},onPong:function(e){ie.proxy.MsgPackRpcProxy.pingAt=null;var t="PONG "+Z.string(e);se._d(se.dateStr(),t,"","","","")},onMessage:function(e){var t,n=this,r=new h.Decoder(e,!0).getResult();if(1==(t=C.Boot.__cast(r[0],f))&&4==r.length){var a;a=C.Boot.__cast(r[1],f);var i=r[2],o=r[3],s=this.responseHandlers.get(a);if(null==s)return void se._e(se.dateStr(),"No ResponseHandler prepared. msgId:%s error:%s result:",a,i,o,"");if(se._d(se.dateStr(),"response received. method:",s.method," data:",r,""),null==i){var l=s.onSuccess;null!=l&&l(o)}else{se._e(se.dateStr(),"Receive Error Response. method:",s.method," error:",i,"");var c=s.onError;null!=c?c(i):null!=this.errorHandler&&this.errorHandler(s.method,i)}this.responseHandlers.remove(a)}else if(0==t&&4==r.length){var u,d,p;u=C.Boot.__cast(r[1],f),d=C.Boot.__cast(r[2],String),p=C.Boot.__cast(r[3],Array),se._d(se.dateStr(),"request received. method:",d,"","","");for(var m=0;m<p.length;){var _=p[m];++m,this.broadcast.handleNotification(d,_,function(){se._d(se.dateStr(),"response sent. method:",d,"","",""),n.ws.send(new h.Encoder([1,u,null,!0]).getBytes())})}}},onClose:function(e,t,n){se._i(se.dateStr(),"onClose. code:"+e+", reason:"+t+", wasClean:"+(null==n?"null":""+n),"","","",""),1001==e&&n||(this.connectionStatus=1e3!=e&&1005!=e||"concurrent access"!=t?1e3!=e&&1005!=e||"forcibly closed"!=t?ie.ConnectionStatus.Error:ie.ConnectionStatus.ForcibliyClosedError:ie.ConnectionStatus.ConcurrentAccessError,this.connectionStatus==ie.ConnectionStatus.ForcibliyClosedError?this.sendNotification("SignOut"):this.sendNotification("Url",ie.command.UrlAction.FORWARD(ie.Urls.error))),this.finishWebSocket(),this.connectionKeeper.setConnected(!1)},restart:function(e){null==e&&(e=500);for(var t=this,n=this.finishWebSocket(),r=this.responseHandlers.keys();r.hasNext();){var a=r.next();this.responseHandlers.remove(a)}var i=null;i=function(){null==n||n.isClosed()?t.initWebSocket():oe.Timer.delay(i,100)},oe.Timer.delay(i,e)},call:function(e,t,n,r){if(null!=this.ws){null==t&&(t=[]);var a=ie.proxy.MsgPackRpcProxy.lastMsgId++,i=new ie.proxy._MsgPackRpcProxy.ResponseHandler(e,n,r);this.responseHandlers.set(a,i);var o=[0,a,e,t],s=new h.Encoder(o).getBytes();this.ws.send(s),se._d(se.dateStr(),"send request. data:",o,"","","")}else se._e(se.dateStr(),"disconnected. data:",this.data,"","","")},ping:function(){switch(this.connectionStatus[1]){case 2:case 3:return}if(null==this.ws||this.ws.isClosed()){this.restart();var e="restart connection. "+ie.proxy.MsgPackRpcProxy.pingAt+" "+Z.string(null==this.ws||this.ws.isClosed());se._d(se.dateStr(),e,"","","","")}else if(0<ie.proxy.MsgPackRpcProxy.pingAt){this.restart();var t="restart connection. "+ie.proxy.MsgPackRpcProxy.pingAt+" "+Z.string(null==this.ws||this.ws.isClosed());se._d(se.dateStr(),t,"","","","")}else se._d(se.dateStr(),"before pingAt "+ie.proxy.MsgPackRpcProxy.pingAt,"","","",""),this.connectionKeeper.isConnected()&&(this.ws.ping("PING"),ie.proxy.MsgPackRpcProxy.pingAt=(new Date).getTime(),se._d(se.dateStr(),"send ping","","","",""))},onServerErrorWithMethod:function(e,t){this.onServerError(t)},onServerError:function(e){if(this.sendNotification("error_occurred",e),503==e.code&&"service temporarily unavailable"==e.message){var t=e.detail.retry_after;this.restart(1e3*t)}"invalid session"==e.message&&this.restart()},__class__:ie.proxy.MsgPackRpcProxy}),ie.proxy._MsgPackRpcProxy={},ie.proxy._MsgPackRpcProxy.ConnectionKeeper=function(e){this.connected=!1,this.ping=e},n["albero.proxy._MsgPackRpcProxy.ConnectionKeeper"]=ie.proxy._MsgPackRpcProxy.ConnectionKeeper,ie.proxy._MsgPackRpcProxy.ConnectionKeeper.__name__=["albero","proxy","_MsgPackRpcProxy","ConnectionKeeper"],ie.proxy._MsgPackRpcProxy.ConnectionKeeper.prototype={start:function(){},stop:function(){this.deleteTimer()},setConnected:function(e){this.connected==e&&null!=this.timer||(this.connected=e,this.resetTimer())},isConnected:function(){return this.connected},resetTimer:function(){var n=this;if(this.deleteTimer(),this.connected)this.timer=new oe.Timer(45e3),this.timer.run=this.ping;else{var r=null;(r=function(e){var t=Z.int(Math.min(2*e,45e3));return function(){n.ping(),n.timer=oe.Timer.delay(r(t),e)}})(3e3)()}},deleteTimer:function(){null!=this.timer&&(this.timer.stop(),this.timer=null)},__class__:ie.proxy._MsgPackRpcProxy.ConnectionKeeper},ie.proxy._MsgPackRpcProxy.ResponseHandler=function(e,t,n){this.method=e,this.onSuccess=t,this.onError=n},n["albero.proxy._MsgPackRpcProxy.ResponseHandler"]=ie.proxy._MsgPackRpcProxy.ResponseHandler,ie.proxy._MsgPackRpcProxy.ResponseHandler.__name__=["albero","proxy","_MsgPackRpcProxy","ResponseHandler"],ie.proxy._MsgPackRpcProxy.ResponseHandler.prototype={__class__:ie.proxy._MsgPackRpcProxy.ResponseHandler},ie.proxy.Error=function(e){this.code=e.code,this.message=e.message,this.detail=e.detail},n["albero.proxy.Error"]=ie.proxy.Error,ie.proxy.Error.__name__=["albero","proxy","Error"],ie.proxy.Error.prototype={__class__:ie.proxy.Error},ie.proxy.ErrorConverter=function(){},n["albero.proxy.ErrorConverter"]=ie.proxy.ErrorConverter,ie.proxy.ErrorConverter.__name__=["albero","proxy","ErrorConverter"],ie.proxy.ErrorConverter.toLocalError=function(e,t){return{code:t.code,message:t.message,detail:t.detail,localErrorType:e}},ie.proxy.ReadStatusUpdaterProxy=function(){l.patterns.proxy.Proxy.call(this,"readStatusUpdater"),this.updateReadStatusesTimers=new oe.ds.StringMap,this.updateReadAnnouncementStatusesTimers=new oe.ds.StringMap},n["albero.proxy.ReadStatusUpdaterProxy"]=ie.proxy.ReadStatusUpdaterProxy,ie.proxy.ReadStatusUpdaterProxy.__name__=["albero","proxy","ReadStatusUpdaterProxy"],ie.proxy.ReadStatusUpdaterProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.ReadStatusUpdaterProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{updateReadStatuses:function(e,t){var n=this,r=this.dataStore.getTalkStatus(e);if(null!=r){if(null==t||this.canRegardTalkReadCountZero(r,t)){if(!ie.entity.TalkStatusHelper.isUnreadMesasgeExisted(r))return;if(null==r.maxMessageId)return;r.readAll(),this.dataStore.setTalkStatus(r)}else{var a=t.filter(function(e){return ie.entity.TalkStatusHelper.isUnread(r,e.id)});if(0==a.length)return;var i=a.filter(function(e){return e.isUnreadCountTarget&&!n.dataStore.isMe(e.userId)}).length;r.read(a[a.length-1].id,i),this.dataStore.setTalkStatus(r)}var o="_"+e.high+"_"+e.low,s=this.updateReadStatusesTimers.get(o);null!=s&&s.stop();var l=r.maxReadMessageId,c=oe.Timer.delay(function(){n.updateReadStatusesTimers.remove(o),null!=n.dataStore.getTalkStatus(e)&&n.api.updateReadStatuses(e,l)},1e3);this.updateReadStatusesTimers.set(o,c)}},updateAnnouncementReadStatus:function(e,t){var n=this,r=this.dataStore.getAnnouncementStatus(e);if(null!=r){if(null==t||this.canRegardAnnouncementReadCountZero(r,t)){if(!ie.entity.AnnouncementStatusHelper.isUnreadAnnouncementExisted(r))return;if(null==r.maxAnnouncementId)return;r.readAll(),this.dataStore.setAnnouncementStatus(r)}else{var a=t.filter(function(e){return ie.entity.AnnouncementStatusHelper.isUnread(r,e)});if(0==a.length)return;r.read(a[a.length-1],a.length),this.dataStore.setAnnouncementStatus(r)}var i="_"+e.high+"_"+e.low,o=this.updateReadAnnouncementStatusesTimers.get(i);null!=o&&o.stop();var s=r.maxReadAnnouncementId;o=oe.Timer.delay(function(){n.updateReadAnnouncementStatusesTimers.remove(i),n.api.updateAnnouncementReadStatus(e,s)},1e3),this.updateReadAnnouncementStatusesTimers.set(i,o)}},canRegardTalkReadCountZero:function(e,t){return this.canRegardReadCountZero(e.maxMessageId,t.map(function(e){return e.id}))},canRegardAnnouncementReadCountZero:function(e,t){return this.canRegardReadCountZero(e.maxAnnouncementId,t)},canRegardReadCountZero:function(e,t){return ie.Int64Helper.eq(e,ie.OptionHelper.orNull(ie.ArrayHelper.lastOption(t)))},__class__:ie.proxy.ReadStatusUpdaterProxy}),ie.proxy.RoutingProxy=function(){l.patterns.proxy.Proxy.call(this,"routing")},n["albero.proxy.RoutingProxy"]=ie.proxy.RoutingProxy,ie.proxy.RoutingProxy.__name__=["albero","proxy","RoutingProxy"],ie.proxy.RoutingProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.RoutingProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{onRegister:function(){},init:function(){null==this.router&&(this.router=new ie.proxy._RoutingProxy.LocalRouter(this,this.settings,this.dataStore),this.router.start())},forward:function(e){this.init(),this.router.forward(e)},redirect:function(e,t){this.init(),this.router.redirect(e,t)},back:function(){null!=this.router&&this.router.back()},stop:function(){null!=this.router&&this.router.started&&this.router.stop()},__class__:ie.proxy.RoutingProxy}),ie.proxy._RoutingProxy={},ie.proxy._RoutingProxy.LocalRouter=function(e,t,n){this.proxy=e,this.settings=t,this.dataStore=n,this.started=!1},n["albero.proxy._RoutingProxy.LocalRouter"]=ie.proxy._RoutingProxy.LocalRouter,ie.proxy._RoutingProxy.LocalRouter.__name__=["albero","proxy","_RoutingProxy","LocalRouter"],ie.proxy._RoutingProxy.LocalRouter.prototype={notify:function(e){var t=this.getDomainId(e);this.settings.setSelectedDomainId(t),this.proxy.sendNotification("current_page_changed",e)},start:function(){this.started=!0},forward:function(e){switch(e[1]){case 0:break;default:this.notify(e)}},redirect:function(e,t){},redirectWithHash:function(){},back:function(){this.notify(this.prev)},stop:function(){this.started=!1},getDomainId:function(e){switch(e[1]){case 2:return e[2];case 3:return e[2];case 4:return e[2];case 5:return e[2];case 6:return e[2];case 10:return e[2];default:return null}},parseFragment:function(e){if(null==e)return null;var t=e.split("/");if(""!=t[0])return null;if(2==t.length){if(""==t[1])return ie.Urls.domains;if("settings"==t[1]){var n=this.settings.getLastSelectedDomainId();if(null!=n&&null!=this.dataStore.getDomain(n))return ie.History.replaceState("settings",null,"#"+this.toFragment(ie.Urls.settings(n))),ie.Urls.settings(n);var r=ie.proxy.LocalRouterHelper.getOldestDomain(this.dataStore.getDomains());return null!=r?(ie.History.replaceState("settings",null,"#"+this.toFragment(ie.Urls.settings(r.id))),ie.Urls.settings(r.id)):ie.Urls.settings(null)}if(t[1]==Z.string(ie.Urls.error))return ie.Urls.error;if(t[1]==Z.string(ie.Urls.loading))return ie.Urls.loading;if("environment"==t[1]){var a=this.settings.getLastSelectedDomainId();if(null!=a&&null!=this.dataStore.getDomain(a))return ie.History.replaceState("environment",null,"#"+this.toFragment(ie.Urls.environment(a))),ie.Urls.environment(a);var i=ie.proxy.LocalRouterHelper.getOldestDomain(this.dataStore.getDomains());return null!=i?(ie.History.replaceState("environment",null,"#"+this.toFragment(ie.Urls.environment(i.id))),ie.Urls.environment(i.id)):ie.Urls.environment(null)}}else if(3==t.length){var o=ie.Int64Helper.parse(t[1]);if(null!=o){if(""==t[2])return ie.Urls.domain(o);if("members"==t[2])return ie.Urls.members(o);if("talks"==t[2])return this.settings.isMultiViewMode()?ie.Urls.talks(o,ie.TalkUrlParam.multi):ie.Urls.talks(o,ie.TalkUrlParam.single);if("actions"==t[2])return ie.Urls.actions(o);if("settings"==t[2])return ie.Urls.settings(o);if("environment"==t[2])return ie.Urls.environment(o)}}else if(4==t.length){var s=ie.Int64Helper.parse(t[1]);if(null!=s&&"talks"==t[2]){if("multi"==t[3])return ie.Urls.talks(s,ie.TalkUrlParam.multi);if("single"==t[3])return ie.Urls.talks(s,ie.TalkUrlParam.single)}}return null},toFragment:function(e){switch(e[1]){case 1:return"/";case 8:case 9:return"/"+Z.string(e);case 2:return"/"+e[2].toString()+"/";case 3:return"/"+e[2].toString()+"/members";case 4:var t=e[3],n=e[2];switch(t[1]){case 0:return"/"+n.toString()+"/talks/multi";case 1:return"/"+n.toString()+"/talks/single";case 2:return this.settings.isMultiViewMode()?"/"+n.toString()+"/talks/multi":"/"+n.toString()+"/talks/single"}break;case 5:return"/"+e[2].toString()+"/actions";case 6:var r=e[2];return se._d(se.dateStr(),"convert urls.settings to fragment. domainId:",null!=r?r:"","","",""),null==r&&(r=this.settings.getLastSelectedDomainId()),null!=r?"/"+r.toString()+"/settings":"/settings";case 10:var a=e[2];return se._d(se.dateStr(),"convert urls.environment to fragment. domainId:",null!=a?a:"","","",""),null==a&&(a=this.settings.getLastSelectedDomainId()),null!=a?"/"+a.toString()+"/environment":"/environment";default:return null}},__class__:ie.proxy._RoutingProxy.LocalRouter},ie.proxy.LocalRouterHelper=function(){},n["albero.proxy.LocalRouterHelper"]=ie.proxy.LocalRouterHelper,ie.proxy.LocalRouterHelper.__name__=["albero","proxy","LocalRouterHelper"],ie.proxy.LocalRouterHelper.getOldestDomain=function(e){if(null!=e&&0<e.length){for(var t=null,n=0;n<e.length;){var r=e[n];++n,(null==t||0<oe.Int64.compare(t.id,r.id))&&(t=r)}return t}return null},ie.proxy.SearchServiceProxy=function(){l.patterns.proxy.Proxy.call(this,"searchService")},n["albero.proxy.SearchServiceProxy"]=ie.proxy.SearchServiceProxy,ie.proxy.SearchServiceProxy.__name__=["albero","proxy","SearchServiceProxy"],ie.proxy.SearchServiceProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.SearchServiceProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{isSearching:function(){return this.searching},clearSearching:function(){this.searching=!1},isRecentParams:function(e){return null!=this.recentParams&&null!=e&&this.recentParams.eq(e)},clearRecentParams:function(){this.recentParams=null},clearEditingParams:function(){this.editingParams=null},saveParams:function(e){this.editingParams=e,this.recentParams=e.copy()},updateTalkIdParam:function(e){this.assureParams(),this.editingParams.talkId=e},updateSearchTypeParam:function(e){this.assureParams(),this.editingParams.searchType=e},updateFromUserIdParam:function(e){this.assureParams(),this.editingParams.fromUserId=e},updateKeywordParam:function(e){this.assureParams(),this.editingParams.keyword=e},updateDomainIdParam:function(e){this.assureParams(),this.editingParams.domainId=e},updateSinceTextParam:function(e){this.assureParams(),this.editingParams.sinceText=e},updateUntilTextParam:function(e){this.assureParams(),this.editingParams.untilText=e},assureParams:function(){if(null==this.editingParams){var e={domain_id_str:ie.Int64Helper.idStr(this.settings.getSelectedDomainId())};this.editingParams=new ie.entity.SearchParams(e)}},prepareForSearching:function(e,t){this.searching=!0,null==t&&this.sendNotification("notify_search_prepare",{searching:!0,params:e})},notifySearchMessagesFail:function(){this.searching=!1,this.sendNotification("notify_search_messages_fail",{})},notifySearchAttachmentsFail:function(){this.searching=!1,this.sendNotification("notify_search_attachments_fail",{})},saveSearchMessagesResult:function(e){null==this.contextMap&&(this.contextMap=new oe.ds.StringMap),this.messagesNextMarker=e.nextMarker,null==e.marker&&(this.hitMessageIdSet=new oe.ds.StringMap);for(var t=0,n=e.contents;t<n.length;){var r=n[t];++t;var a=ie.Int64Helper.idStr(r.messages[0].id);this.contextMap.set(a,r),this.hitMessageIdSet=ae.fold(r.messages,function(e,t){if(e.hit){var n=ie.Int64Helper.idStr(e.id);t.set(n,1)}return t},this.hitMessageIdSet)}this.searching=!1,this.sendNotification("notify_search_messages",e)},saveSearchAttachmentsResult:function(e){null==this.attachmentsMap&&(this.attachmentsMap=new oe.ds.StringMap),this.attachmentsNextMarker=e.nextMarker;for(var t=0,n=e.contents;t<n.length;){var r=n[t];++t;var a=ie.Int64Helper.idStr(r.attachmentId);this.attachmentsMap.set(a,r)}this.searching=!1,this.sendNotification("notify_search_attachments",e)},getHitContext:function(e){return this.contextMap.get(e)},getFileInfo:function(e){return this.attachmentsMap.get(e)},isHitMessage:function(e){return this.hitMessageIdSet.exists("_"+e.high+"_"+e.low)},reserveOnNormalizedKeywordPrepared:function(r){var a=this;null!=this.recentParams&&null!=this.recentParams.keyword&&ie.js.TextCanonicalizer.assureNormalize(function(t){var e;if(e=null==a.recentParams?"":a.recentParams.keyword,a.cachedKeyword!=e){a.cachedKeyword=e,null==a.cachedNormalizedKeywords?a.cachedNormalizedKeywords=new Array:a.cachedNormalizedKeywords.splice(0,a.cachedNormalizedKeywords.length);var n=new o("[ ]","g").split(ee.htmlEscape(e,!0));ae.iter(n.filter(ie.StringHelper.isNotEmpty),function(e){a.cachedNormalizedKeywords.push(new ie.js.NFKCTextSearch(e,!0,t))})}r(a.cachedNormalizedKeywords)})},__class__:ie.proxy.SearchServiceProxy}),ie.proxy.SessionProxy=function(){l.patterns.proxy.Proxy.call(this,"session"),this.createSessionCount=0},n["albero.proxy.SessionProxy"]=ie.proxy.SessionProxy,ie.proxy.SessionProxy.__name__=["albero","proxy","SessionProxy"],ie.proxy.SessionProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.SessionProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{start:function(e){this.api.createSession(e,_(this,this.onSessionCreated))},onSessionCreated:function(e){var t=this,n=e.notification&&this.dataStore.isMe(e.user.id);this.dataStore.setMe(e.user),this.settings.setConfiguration(e.configuration),this.sendNotification("data_recovering"),ie.js.Localizer.runOrReserve(function(){n?t.prepareNecessaryDataFromCache():(t.dataStore.clear(!1),t.prepareNecessaryDataFromServer()),t.createSessionCount++})},prepareNecessaryDataFromServer:function(){var i=this;this.api.resetNotification(function(e){var t=0,a=function(){5==++t&&i.api.getAllUserIdentifiers(_(i,i.onNecessaryDataPrepared))};i.api.getDomains(function(){var e=i.dataStore.getDomains(),t=0;0<e.length?i.api.getAnnouncementStatuses(function(){++t==e.length&&a()}):a();var n=0,r=function(){2==++n&&i.api.getTalks(a)};i.api.getFriends(r),i.api.getAcquaintances(r)}),i.api.getDomainInvites(a),i.api.getAccountControlRequests(a),i.api.getJoinedAccountControlGroup(a)})},prepareNecessaryDataFromCache:function(){var e=ie.ArrayHelper.sortAndReturn(this.dataStore.getDomains(),function(e,t){return oe.Int64.compare(t.id,e.id)});this.api.sendDomainNotifications(e);for(var t=0;t<e.length;){var n=e[t];++t;var r=this.dataStore.getAnnouncementStatus(n.id);null==r&&(r=this.dataFactory.newAnnouncementStatusForDomain(n.id)),this.api.sendAnnouncementStatusNotification(r);for(var a=0,i=this.dataStore.getFriends(n.id);a<i.length;){var o=i[a];++a,this.sendNotification("notify_add_friend",o)}for(var s=0,l=this.dataStore.getAcquaintances(n.id);s<l.length;){var c=l[s];++s,this.sendNotification("notify_add_acquaintance",c)}}this.api.sendTalkNotifications(this.dataStore.getTalks()),this.api.sendTalkStatusNotifications(this.dataStore.getTalkStatuses());for(var u=0,d=this.dataStore.getDomainInvites();u<d.length;){var p=d[u];++u,this.sendNotification("notify_add_domain_invite",p)}for(var m=0,_=this.dataStore.getAccountControlRequests();m<_.length;){var h=_[m];++m,this.sendNotification("notify_add_account_control_request",h)}var y=this.dataStore.getAccountControlGroup();null!=y&&this.sendNotification("notify_join_account_control_group",y),this.onNecessaryDataPrepared()},onNecessaryDataPrepared:function(){var e=this.settings.getConfiguration().botExpiredVersion;if(se._d(se.dateStr(),"bot_expired_version",e,"","",""),null!=e){var t=C.Node.require("../../package.json").version;if(se._d(se.dateStr(),"current",t,"","",""),null!=t){var n=e.split("."),r=t.split(".");3==n.length&&3==r.length&&0<=1e4*(Z.parseFloat(n[0])-Z.parseFloat(r[0]))+100*(Z.parseFloat(n[1])-Z.parseFloat(r[1]))+(Z.parseFloat(n[2])-Z.parseFloat(r[2]))&&C.Node.process.stderr.write("-----------------------------------------\nCurrent version is expired! (current: "+t+")\nRun 'npm install direct-js' to update\n-----------------------------------------\n")}}this.sendNotification("data_recovered"),this.api.startNotification(),this.api.startUpdateLastUsedAtIfNeed()},__class__:ie.proxy.SessionProxy}),ie.proxy.SettingsProxy=function(){this.selectedDomainId=null,this.remember=!0,l.patterns.proxy.Proxy.call(this,"settings")},n["albero.proxy.SettingsProxy"]=ie.proxy.SettingsProxy,ie.proxy.SettingsProxy.__name__=["albero","proxy","SettingsProxy"],ie.proxy.SettingsProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.SettingsProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{onRegister:function(){this.loadBrowserSettings()},setAccessTokenRemember:function(e){this.remember=e},setAccessToken:function(e){this.remember&&(this.accessToken=e,this.sendNotification("access_token_changed",e))},getAccessToken:function(){return null==this.accessToken&&(this.accessToken=v.accessToken),this.accessToken},clearAccessToken:function(){this.accessToken=null},getOs:function(){return"bot"},getIDFV:function(){var e=ie.StorageHelper.getItem("idfv");return null!=e&&""!=e||(e=ie.StringHelper.randomString(),ie.StorageHelper.setItem("idfv",e)),e},setConfiguration:function(e){this.configuration=e,this.sendNotification("configuration_changed",e)},getConfiguration:function(){return this.configuration},setSelectedDomainId:function(e){ie.Int64Helper.eq(this.selectedDomainId,e)||(null!=e?(ie.StorageHelper.setItem("selected_domain_id_h",null==e.high?"null":""+e.high),ie.StorageHelper.setItem("selected_domain_id_l",null==e.low?"null":""+e.low)):(ie.StorageHelper.removeItem("selected_domain_id_h"),ie.StorageHelper.removeItem("selected_domain_id_l")),this.selectedDomainId=e,this.sendNotification("domain_selection_changed",e))},getLastSelectedDomainId:function(){var e=ie.StorageHelper.getItemAsInt("selected_domain_id_h"),t=ie.StorageHelper.getItemAsInt("selected_domain_id_l");return null!=e&&null!=t?new oe.Int64(e,t):null},getSelectedDomainId:function(){return this.selectedDomainId},clearDomainSelection:function(){this.selectedDomainId=null,ie.StorageHelper.removeItem("selected_domain_id_h"),ie.StorageHelper.removeItem("selected_domain_id_l")},clearSelectedTalkIfMatch:function(a){for(var i=this,e=[ie.entity.PaneType.SingleTalkPane,ie.entity.PaneType.MultiTalkPane1,ie.entity.PaneType.MultiTalkPane2,ie.entity.PaneType.MultiTalkPane3].filter(function(e){var t=i.getTalkSelection(e);switch(a[1]){case 1:a[3];var n=a[2];switch(t[1]){case 1:t[3];var r=t[2];return null!=n&&null!=r&&n.high==r.high&&n.low==r.low;default:return!1}break;case 2:return ie.entity.TalkSelection.AnnouncementsSelected==t;default:return!1}}),t=0;t<e.length;){var n=e[t];++t,this.clearSelectedTalk(n)}},clearSelectedTalk:function(e){if(null==e&&(e=ie.entity.PaneType.SingleTalkPane),this.hasSelectedTalkOrAnnouncements(e)){var t=ie.Int64Helper.idStr(this.selectedDomainId);this.paneTalkSelections.get(t).remove(e),this.sendNotification("talk_selection_changed",new ie.entity.TalkPaneSelection(e,ie.entity.TalkSelection.NotSelected))}},selectTalk:function(e,t,n){var r=ie.Int64Helper.idStr(t.domainId);if(null==r)return!1;var a=this.assureTalkSelectionMap(r),i=ie.entity.TalkSelection.TalkSelected(t.id,n);return a.set(e,i),!!ie.Int64Helper.eq(t.domainId,this.selectedDomainId)&&(this.sendNotification("talk_selection_changed",new ie.entity.TalkPaneSelection(e,i)),!0)},selectAnnouncement:function(e){if(null==this.selectedDomainId)return!1;var t=ie.Int64Helper.idStr(this.selectedDomainId);return this.assureTalkSelectionMap(t).set(e,ie.entity.TalkSelection.AnnouncementsSelected),this.sendNotification("talk_selection_changed",new ie.entity.TalkPaneSelection(e,ie.entity.TalkSelection.AnnouncementsSelected)),!0},reselectTalk:function(e,t){var n=this.assureTalkSelectionMap("_"+e.high+"_"+e.low).get(t);return null==n&&(n=ie.entity.TalkSelection.NotSelected),this.sendNotification("talk_selection_changed",new ie.entity.TalkPaneSelection(t,n)),!0},hasSelectedTalkOrAnnouncements:function(e){null==e&&(e=ie.entity.PaneType.SingleTalkPane);var t=this.getTalkSelectionMap();return null!=t&&t.get(e)!=ie.entity.TalkSelection.NotSelected},hasSelectedTalk:function(e){null==e&&(e=ie.entity.PaneType.SingleTalkPane);var t=this.getTalkSelectionMap();if(null==t)return!1;var n=t.get(e);if(null==n)return!1;switch(n[1]){case 0:return!1;default:return!0}},getTalkSelectionMap:function(){if(null==this.paneTalkSelections)return null;if(null==this.selectedDomainId)return null;var e=ie.Int64Helper.idStr(this.selectedDomainId);return this.paneTalkSelections.get(e)},assureTalkSelectionMap:function(e){null==this.paneTalkSelections&&(this.paneTalkSelections=new oe.ds.StringMap);var t=this.paneTalkSelections.get(e);return null==t&&(t=new oe.ds.EnumValueMap,this.paneTalkSelections.set(e,t)),t},getSelectedTalkId:function(){var e=this.getTalkSelection(ie.entity.PaneType.SingleTalkPane);switch(e[1]){case 1:e[3];return e[2];default:return null}},getTalkSelection:function(e){if(null==this.paneTalkSelections)return ie.entity.TalkSelection.NotSelected;var t=this.getTalkSelectionMap();if(null==t)return ie.entity.TalkSelection.NotSelected;var n=t.get(e);return null==n?ie.entity.TalkSelection.NotSelected:n},isSendByEnter:function(){return null==this.sendByEnter&&(this.sendByEnter=!0),this.sendByEnter},setSendByEnter:function(e){e!=this.sendByEnter&&(this.sendByEnter=e,this.sendNotification("send_by_enter_changed",e))},setSelectedStampTabId:function(e){ie.StorageHelper.setItem("selected_stamp_tab_id",null==e?"null":""+e)},getSelectedStampTabId:function(){var e=ie.StorageHelper.getItemAsInt("selected_stamp_tab_id");return null==e?0:e},clearSelectedStampTabId:function(){ie.StorageHelper.removeItem("selected_stamp_tab_id")},setInputTextForTalkId:function(e,t){null==e||0==e.length?this.clearInputTextForTalkId(t):(this.loadInputTextForAll(),this.inputTexts["_"+t.high+"_"+t.low]=e)},getInputTextForTalkId:function(e){this.loadInputTextForAll();var t=this.inputTexts["_"+e.high+"_"+e.low];return null!=t?t:""},clearInputTextForTalkId:function(e){this.loadInputTextForAll(),delete this.inputTexts["_"+e.high+"_"+e.low]},loadInputTextForAll:function(){null==this.inputTexts&&(this.inputTexts=ie.StorageHelper.getItemAsJson("input_text"),null==this.inputTexts&&(this.inputTexts={}))},saveInputTextForAll:function(){if(null!=this.inputTexts){var e=JSON.stringify(this.inputTexts,null,null);ie.StorageHelper.setItem("input_text",e)}},clearInputTextForAll:function(){ie.StorageHelper.removeItem("input_text"),this.inputTexts=null},setCopyProfileToAllDomains:function(e){e?ie.StorageHelper.setItem("copy_profile_to_all_domains","true"):ie.StorageHelper.removeItem("copy_profile_to_all_domains")},isCopyProfileToAllDomains:function(){return null!=ie.StorageHelper.getItem("copy_profile_to_all_domains")},setSearchHistoriesForSelectedDomain:function(e){null!=this.selectedDomainId&&(this.loadSearchHistoryForAll(),null==e?delete this.searchHistories[ie.Int64Helper.idStr(this.selectedDomainId)]:this.searchHistories[ie.Int64Helper.idStr(this.selectedDomainId)]=e,this.saveSearchHistoryForAll())},getSearchHistoriesForSelectedDomain:function(){return null==this.selectedDomainId?null:(this.loadSearchHistoryForAll(),this.searchHistories[ie.Int64Helper.idStr(this.selectedDomainId)])},loadSearchHistoryForAll:function(){null==this.searchHistories&&(this.searchHistories=ie.StorageHelper.getItemAsJson("search_histories"),null==this.searchHistories&&(this.searchHistories={}))},saveSearchHistoryForAll:function(){if(null!=this.searchHistories){var e=JSON.stringify(this.searchHistories,null,null);ie.StorageHelper.setItem("search_histories",e)}},setSelectedDepartmentId:function(e,t){null!=e&&(this.loadSelectedDepartmentIdsForAll(),null==t?this.selectedDepartmentIds.remove("_"+e.high+"_"+e.low):this.selectedDepartmentIds.set("_"+e.high+"_"+e.low,t),this.saveSelectedDepartmentIdsForAll())},getSelectedDepartmentId:function(e){return null==e?null:(this.loadSelectedDepartmentIdsForAll(),this.selectedDepartmentIds.get("_"+e.high+"_"+e.low))},loadSelectedDepartmentIdsForAll:function(){null==this.selectedDepartmentIds&&(this.selectedDepartmentIds=ie.StorageHelper.getItemWithUnserialize("selected_department_ids"),null==this.selectedDepartmentIds&&(this.selectedDepartmentIds=new oe.ds.StringMap))},saveSelectedDepartmentIdsForAll:function(){null!=this.selectedDepartmentIds&&ie.StorageHelper.setItemWithSerialize("selected_department_ids",this.selectedDepartmentIds)},setRightPanelOpened:function(e){e?ie.StorageHelper.removeItem("right_panel_opened"):ie.StorageHelper.setItem("right_panel_opened","false")},isRightPanelOpened:function(){return null==ie.StorageHelper.getItem("right_panel_opened")},setMultiViewMode:function(e){e?ie.StorageHelper.setItem("multi_view_mode","true"):ie.StorageHelper.removeItem("multi_view_mode")},isMultiViewMode:function(){return null!=ie.StorageHelper.getItem("multi_view_mode")},setPasswordWarningSkipUntil:function(e){null==e?ie.StorageHelper.removeItem("password_warning_skip_until"):ie.StorageHelper.setItem("password_warning_skip_until","_"+e.high+"_"+e.low)},getPasswordWarningSkipUntil:function(){var e=ie.StorageHelper.getItem("password_warning_skip_until");return null==e?null:ie.Int64Helper.makeFromIdStr(e)},setLastUsedExpiredAt:function(e){null==e?ie.StorageHelper.removeItem("last_used_expired_at"):ie.StorageHelper.setItem("last_used_expired_at","_"+e.high+"_"+e.low)},getLastUsedExpiredAt:function(){var e=ie.StorageHelper.getItem("last_used_expired_at");return null==e?null:ie.Int64Helper.makeFromIdStr(e)},setOnPremise:function(e){this.onPremises=e},isOnPremises:function(){return this.onPremises},getBrowserSettings:function(){return this.browserSettings},applyNotificationSettings:function(e){return e.copyNotificationSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyKeywordWatchingSettings:function(e){return e.copyKeywordSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyTalkSettings:function(e){return e.copyTalkSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyUserDataSettings:function(e){return e.copyUserDataContainerTo(this.browserSettings),this.saveBrowserSettings()},applyLanguageSettings:function(e){return e.copyLanguageSettingsTo(this.browserSettings),this.saveBrowserSettings()},loadBrowserSettings:function(){this.browserSettings=ie.entity.BrowserSettings.fromJson(ie.StorageHelper.getItemAsJson(ie.entity.BrowserSettings.NAME))},saveBrowserSettings:function(){var e=ie.StorageHelper.getItemAsJson(ie.entity.BrowserSettings.NAME);return null==e&&(e={}),this.browserSettings.copyTo(e),ie.StorageHelper.setItem(ie.entity.BrowserSettings.NAME,JSON.stringify(e,null,null))},__class__:ie.proxy.SettingsProxy}),ie.proxy.SolutionsStoreProxy=function(){l.patterns.proxy.Proxy.call(this,"solutionsStore")},n["albero.proxy.SolutionsStoreProxy"]=ie.proxy.SolutionsStoreProxy,ie.proxy.SolutionsStoreProxy.__name__=["albero","proxy","SolutionsStoreProxy"],ie.proxy.SolutionsStoreProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.SolutionsStoreProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{getSolutions:function(e){var t=this;return null==this.solutionsMap?[]:this.getSolutionIds(e).map(function(e){return t.solutionsMap.get(e)}).filter(function(e){return null!=e})},getSolution:function(e){return null==this.solutionsMap?null:this.solutionsMap.get(e)},getSolutionIds:function(e){return null==e?[]:null==e.contract?[]:null==e.contract.solutionIds?[]:e.contract.solutionIds},getSolutionIdsNotLoaded:function(e){var t=this;return this.getSolutionIds(e).filter(function(e){return null==t.solutionsMap||!t.solutionsMap.exists(e)})},setSolution:function(e){null==this.solutionsMap&&(this.solutionsMap=new oe.ds.IntMap),this.solutionsMap.set(e.solutionId,e)},__class__:ie.proxy.SolutionsStoreProxy}),ie.proxy.ThumbnailExpansionProxy=function(){l.patterns.proxy.Proxy.call(this,"ThumbnailExpansion")},n["albero.proxy.ThumbnailExpansionProxy"]=ie.proxy.ThumbnailExpansionProxy,ie.proxy.ThumbnailExpansionProxy.__name__=["albero","proxy","ThumbnailExpansionProxy"],ie.proxy.ThumbnailExpansionProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.ThumbnailExpansionProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{onRegister:function(){var e=this;oe.Timer.delay(function(){e.workingBrowserSettings=e.settings.getBrowserSettings().createCopy()},0)},updateThumbnailExpansionEnabled:function(e){if(null!=this.workingBrowserSettings){var t=this.dataStore.me;if(null!=t)this.workingBrowserSettings.assureUserData(ie.Int64Helper.idStr(t.id)).useThumbnailExpansion=e,this.settings.applyUserDataSettings(this.workingBrowserSettings)}},isThumbnailExpansionEnabled:function(){if(null==this.workingBrowserSettings)return!1;var e=this.dataStore.me;return null!=e&&this.workingBrowserSettings.assureUserData(ie.Int64Helper.idStr(e.id)).useThumbnailExpansion},__class__:ie.proxy.ThumbnailExpansionProxy}),ie.proxy.UserPresencesProxy=function(){l.patterns.proxy.Proxy.call(this,"userPresences")},n["albero.proxy.UserPresencesProxy"]=ie.proxy.UserPresencesProxy,ie.proxy.UserPresencesProxy.__name__=["albero","proxy","UserPresencesProxy"],ie.proxy.UserPresencesProxy.__super__=l.patterns.proxy.Proxy,ie.proxy.UserPresencesProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{getUserPresenceState:function(e,t){var n=ie.OptionHelper.map(this.getUserPresence(e),function(e){return e.toState(t)});switch(n[1]){case 0:return n[2];case 1:return ie.entity.UserPresenceState.GT_60}},getUserPresence:function(e){return ie.OptionHelper.option(this.dataStore.getUserPresence(e))},__class__:ie.proxy.UserPresencesProxy});var u={mediator:{}};u.mediator.CommandLineMediator=function(){l.patterns.mediator.Mediator.call(this,"commandline",null)},n["albero_cli.mediator.CommandLineMediator"]=u.mediator.CommandLineMediator,u.mediator.CommandLineMediator.__name__=["albero_cli","mediator","CommandLineMediator"],u.mediator.CommandLineMediator.__super__=l.patterns.mediator.Mediator,u.mediator.CommandLineMediator.prototype=t(l.patterns.mediator.Mediator.prototype,{onRegister:function(){this.getViewComponent();this.eventEmitter=r.getInstance(),this.dataRecovered=!1,this.startDataSaver()},listNotificationInterests:function(){return["app_state_changed","access_token_changed","current_user_changed","configuration_changed","domain_selection_changed","talk_selection_changed","talk_list_scroll_to_talk_top_needed","user_selection_needed","user_selection_changed","friend_selection_needed","stamp_set_changed","stamp_selection_changed","action_selection_changed","current_page_changed","current_page_not_changed","fileinfo_selection_changed","message_fileinfo_selection_changed","staged_fileinfo_selection_changed","error_occurred","brand_badge_changed","send_form_top_changed","solutions_loaded","right_pane_opened","right_pane_closed","password_expiration_overed","password_expiration_warned","photo_editor_saved","mc_authenticated_user_received","data_recovering","data_recovered","notify_update_user","notify_add_friend","notify_add_acquaintance","notify_delete_friend","notify_delete_acquaintance","notify_update_domain_users","get_domain_users_responsed","get_users_responsed","get_profile_responsed","update_user_responsed","update_profile_responsed","notify_add_domain_invite","notify_accept_domain_invite","notify_delete_domain_invite","notify_join_domain","notify_update_domain","notify_leave_domain","notify_create_pair_talk","notify_create_group_talk","notify_update_group_talk","notify_add_talkers","notify_delete_talker","notify_delete_talk","notify_create_message","notify_update_read_statuses","notify_update_talk_status","notify_update_local_talk_status","notify_get_messages","notify_get_message_status","create_message_start","create_message_complete","create_message_fail","notify_create_announcement","notify_update_announcement_status","notify_get_announcements","create_announcement_start","create_announcement_complete","create_announcement_fail","notify_update_question","get_questions_responsed","notify_create_attachment","notify_delete_attachment","get_file_responsed","notify_search_messages","notify_search_attachments","notify_search_messages_fail","notify_search_attachments_fail","notify_search_prepare","notify_search_clear","notify_search_box_popup","notify_add_account_control_request","notify_delete_account_control_request","notify_join_account_control_group","notify_update_account_control_group_partially","notify_leave_account_control_group"]},handleNotification:function(e){var t=this,n=e.getName();switch(n){case"data_recovering":this.dataRecovered=!1,this.eventEmitter.emit(e.getName());break;case"data_recovered":if(this.dataRecovered)return;this.dataRecovered=!0,this.eventEmitter.emit(e.getName());break;case"error_occurred":this.eventEmitter.emit(e.getName(),new Error("AdapterError"),e.getBody());break;case"current_page_changed":var r=e.getBody();te.enumEq(r,ie.Urls.error)&&(this.dataRecovered=!1),this.eventEmitter.emit(e.getName(),e.getBody());break;default:this.eventEmitter.emit(e.getName(),e.getBody())}this.getViewComponent();switch(e.getName()){case"access_token_changed":this.dataStore.clear(!0),C.Node.console.log(e.getBody()),C.Node.process.exit(0);break;case"current_user_changed":e.getBody();this.sendQueue.restart();break;case"notify_add_domain_invite":e.getBody();break;case"notify_create_pair_talk":case"notify_create_group_talk":if(!this.dataRecovered)return;var a=e.getBody();oe.Timer.delay(function(){t.emit(a,"JoinMessage",t.dataStore.me)},500);break;case"notify_update_group_talk":if(!this.dataRecovered)return;var i,o=e.getBody();i=null!=o.name?o.name:"",oe.Timer.delay(function(){t.emit(o,"TopicChangeMessage",t.dataStore.me,i)},500);break;case"create_message_complete":case"create_announcement_complete":var s=e.getBody(),l=s[0];s[1];if(this.dataStore.isMe(l.userId))return this.messageEvent.messageCreated(l,e.getType()),void this.sendQueue.sendNext(l);break;case"create_message_fail":var c=e.getBody()[0],u=e.getBody()[1];if(this.dataStore.isMe(u.userId))return this.messageEvent.messageCreated(null,e.getType()),void(null!=c&&429==c.code?this.sendQueue.retryAfter(1e3*Z.int(c.detail.retry_after)):null!=c&&503==c.code?this.sendQueue.retryAfter(1e3*Z.int(c.detail.retry_after)):this.sendQueue.sendNext(u));break;case"notify_create_message":var d=e.getBody();if(this.dataStore.isMe(d.userId))return;if(d.isBotMessage&&!v.talkWithBot)return;var p=this.dataStore.getTalkStatus(d.talkId);if(null!=p&&null!=p.maxReadMessageId&&0<=oe.Int64.compare(p.maxReadMessageId,d.id))return;oe.Timer.delay(function(){null!=t.dataStore.getTalk(d.talkId)&&(t.sendNotification("Read",ie.command.ReadType.TALK(d.talkId)),t.dispatch(d))},200);break;case"notify_update_read_statuses":for(var m=e.getBody(),_=0,h=m.messageIds;_<h.length;){var y=h[_];++_,this.messageEvent.messageRead(m.talkId,y,m.readUserIds)}break;case"notify_get_message_status":var f=e.getBody();this.messageEvent.messageRead(f.talkId,f.id,f.readUserIds,f.unreadUserIds);break;case"notify_update_local_talk_status":var g=e.getBody();this.messageEvent.messageReadEveryone(g.id,g.maxEveryoneReadMessageId);break;case"notify_delete_talk":var S=e.getBody();this.messageEvent.deleteTalk(S);break;case"notify_leave_domain":var T=e.getBody();this.messageEvent.leaveDomain(T)}},emit:function(e,t,n,r){var a=this;null!=t&&null!=e&&null!=n&&this.api.getAllUserIdentifiers(function(){a.eventEmitter.emit(t,{room:ie.Int64Helper.idStr(e.id),rooms:a.hubotObject.talkObjects()},a.hubotObject.userObject(n),r)})},leave:function(e){var t=this;oe.Timer.delay(function(){null!=t.dataStore.getTalk(e.id)&&t.sendNotification("Talk",ie.command.TalkAction.DELETE(null,e))},500)},dispatch:function(r){var a=this,e=r.content,i=this.dataStore.getTalk(r.talkId),t=function(e,t,n){a.emit(i,e,a.dataStore.getUser(i.domainId,t),{id:ie.Int64Helper.idStr(r.id),content:n})};if(r.type==ie.entity.MessageType.system){var n=e.type;if("add_talkers"==n){var o=e.added_user_ids,s=this.dataStore.me.id;if(ie.Int64Helper.contains(o,s))return void t("JoinMessage",s);for(var l=0;l<o.length;){var c=o[l];++l,t("EnterMessage",c)}}else"delete_talker"==n?(t("LeaveMessage",e.deleted_user_id),e.user_ids.length<=1&&this.leave(i)):"hide_pair_talk"==n&&(t("LeaveMessage",e.user_id),this.leave(i))}else{var u=null;switch(r.type[1]){case 1:u=e;break;default:for(var d=g.deepCopy(r.content),p=0,m=H.fields(d);p<m.length;){var _=m[p];++p;var h=H.field(d,_);if(H.isObject(d)&&null!=h.high&&null!=h.low){var y=oe.Int64.make(h.high,h.low);H.setField(d,_,"stamp_index"==_?y.toString():"_"+y.high+"_"+y.low)}else"stamp_set"==_&&H.setField(d,_,Z.string(h))}r.type!=ie.entity.MessageType.textMultipleFile||null!=d.text&&0!=d.text.length||null==d.files||1!=d.files.length||(d=d.files[0]),u=JSON.stringify(d)}if(null!=u){var f;if(i.type==ie.entity.TalkType.PairTalk)f=null!=v.$name?v.$name:"Hubot",ee.startsWith(u,f)||(u=f+" "+u);t("TextMessage",r.userId,u)}}},startDataSaver:function(){var e=this;oe.Timer.delay(function(){e.dataRecovered&&e.dataStore.saveIfNeeded(),e.startDataSaver()},5e3)},__class__:u.mediator.CommandLineMediator}),u.proxy={},u.proxy.HubotObjectProxy=function(){l.patterns.proxy.Proxy.call(this,"hubotObject")},n["albero_cli.proxy.HubotObjectProxy"]=u.proxy.HubotObjectProxy,u.proxy.HubotObjectProxy.__name__=["albero_cli","proxy","HubotObjectProxy"],u.proxy.HubotObjectProxy.__super__=l.patterns.proxy.Proxy,u.proxy.HubotObjectProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{userObject:function(e){var t;return(t=null==e?null:JSON.parse(JSON.stringify(e))).id_i64=e.id,t.id=ie.Int64Helper.idStr(e.id),t.name=e.displayName,t.profile_url=e.profileImageUrl,t},userObjectByIdStr:function(e,t){var n=this.userObjectsByIds(e,[ie.Int64Helper.idStrToInt64(t)]);return 0<n.length?n[0]:null},userObjectsByIds:function(e,t,n){for(var r=[],a=0,i=this.dataStore.getUsers(e,t);a<i.length;){var o=i[a];if(++a,null!=o){var s,l="u"+ie.Int64Helper.idStr(o.id);if(null==(s=null!=n?n.get(l):null)&&(s=this.userObject(o),null!=n)){var c=s;n.set(l,c)}r.push(s)}}return r},userObjects:function(e){for(var t={},n=0,r=this.dataStore.getUsers(e);n<r.length;){var a=r[n];++n,t[ie.Int64Helper.idStr(a.id)]=this.userObject(a)}return t},talkObject:function(e,t){var n;return(n=null==e?null:JSON.parse(JSON.stringify(e))).id_i64=e.id,n.id=ie.Int64Helper.idStr(e.id),n.topic=e.name,e.type==ie.entity.TalkType.Unknown?n.type=0:e.type==ie.entity.TalkType.PairTalk?n.type=1:n.type=2,n.userIds=e.userIds,n.users=this.userObjectsByIds(e.domainId,e.userIds,t),n.domain=this.domainObjectById(e.domainId,t),n.domainId_i64=e.domainId,n.domainId=ie.Int64Helper.idStr(e.domainId),n},talkObjects:function(e){for(var t=new oe.ds.StringMap,n={},r=0,a=this.dataStore.getTalks();r<a.length;){var i=a[r];++r,(null==e||ie.Int64Helper.eq(e,i.domainId))&&(n[ie.Int64Helper.idStr(i.id)]=this.talkObject(i,t))}return n},domainObjectById:function(e,t){if(null==e)return null;var n="d_"+e.high+"_"+e.low,r=t.get(n);if(null==r){var a=r=this.domainObject(this.dataStore.getDomain(e));t.set(n,a)}return r},domainObject:function(e,t){var n;return null==t&&(t=!1),(n=null==e?null:JSON.parse(JSON.stringify(e))).id_i64=e.id,n.id=ie.Int64Helper.idStr(e.id),t&&(n.talks=this.talkObjects(e.id)),n},domainObjects:function(){for(var e={},t=0,n=this.dataStore.getDomains();t<n.length;){var r=n[t];++t,e[ie.Int64Helper.idStr(r.id)]=this.domainObject(r)}return e},messageObject:function(e){var t=new oe.ds.StringMap,n=this.dataStore.getTalk(e.talkId),r=this.userObjectsByIds(n.domainId,[e.userId],t),a={};return a.type=ie.entity.Message.enumIndex(e.type),a.content=g.deepCopy(e.content),a.createdAt=g.deepCopy(e.createdAt),a.id_i64=g.deepCopy(e.id),a.id=ie.Int64Helper.idStr(e.id),0<r.length?a.user=r[0]:a.user=null,a.userId=ie.Int64Helper.idStr(e.userId),a.talk=this.talkObject(n,t),a.talkId=ie.Int64Helper.idStr(e.talkId),a},__class__:u.proxy.HubotObjectProxy}),u.proxy.MessageEventProxy=function(){l.patterns.proxy.Proxy.call(this,"messageEvent"),this.emitters=new oe.ds.StringMap},n["albero_cli.proxy.MessageEventProxy"]=u.proxy.MessageEventProxy,u.proxy.MessageEventProxy.__name__=["albero_cli","proxy","MessageEventProxy"],u.proxy.MessageEventProxy.__super__=l.patterns.proxy.Proxy,u.proxy.MessageEventProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{registEmitter:function(e,t){u.proxy.Emitter.factory=this;var n=u.proxy.Emitter.createInstance(t);null!=n&&this.emitters.set(e,n)},messageCreated:function(e,t){var n=this.emitters.get(t);if(null!=n&&(this.emitters.remove(t),null!=e)){var r=ie.Int64Helper.idStr(e.id);if(this.emitters.set(r,n),n.talk=this.dataStore.getTalk(e.talkId),n.setFirstReader(this.dataStore.me),n.emitOnSend(e),n.removeEventListener("send"),!n.hasEventListener()){var a=ie.Int64Helper.idStr(e.id);this.emitters.remove(a)}}},messageRead:function(t,n,e,r){var a=this,i=this.emitters.get("_"+n.high+"_"+n.low);if(null!=i){i.emitOnRead(e,r);var o=16<=i.__readerIds.length;i.startTimer(o,function(e){e?a.messageReadEveryone(t,n):a.sendNotification("Read",ie.command.ReadType.READ_STATUS(t,n))}),0==i.__unreadIds.length&&this.messageReadEveryone(t,n)}},messageReadEveryone:function(e,t){if(null!=t)for(var n=this.emitters.keys();n.hasNext();){var r=n.next(),a=this.emitters.get(r);if(null!=a.talk&&ie.Int64Helper.eq(a.talk.id,e)){var i=ie.Int64Helper.makeFromIdStr(r);oe.Int64.compare(i,t)<=0&&this._messageReadEveryone(e,r)}}},_messageReadEveryone:function(e,t){var n=this.emitters.get(t);null!=n&&(0<n.__unreadIds.length&&n.emitOnRead(n.__unreadIds),n.stopTimer(),n.removeEventListener("read"),n.hasEventListener()||this.emitters.remove(t))},deleteTalk:function(e){for(var t=this.emitters.keys();t.hasNext();){var n=t.next(),r=this.emitters.get(n);null!=r.talk&&ie.Int64Helper.eq(r.talk.id,e)&&(r.stopTimer(),this.emitters.remove(n))}},leaveDomain:function(e){for(var t=this.emitters.keys();t.hasNext();){var n=t.next(),r=this.emitters.get(n);null!=r.talk&&ie.Int64Helper.eq(r.talk.domainId,e)&&(r.stopTimer(),this.emitters.remove(n))}},__class__:u.proxy.MessageEventProxy}),u.proxy.Emitter=function(e){this.context=e,this.listeners=new oe.ds.StringMap,Object.defineProperty(this,"readUsers",{get:this.get_readUsers}),Object.defineProperty(this,"unreadUsers",{get:this.get_unreadUsers})},n["albero_cli.proxy.Emitter"]=u.proxy.Emitter,u.proxy.Emitter.__name__=["albero_cli","proxy","Emitter"],u.proxy.Emitter.createInstance=function(e){for(var t=null,n=H.fields(e),r=0;r<n.length;){var a=n[r];if(++r,ee.startsWith(a,"on")){var i=H.field(e,a);H.isFunction(i)&&(H.deleteField(e,a),null==t&&(t=new u.proxy.Emitter(e)),t.addEventListener(Y.substr(a,2,null),i))}}return t},u.proxy.Emitter.prototype={addEventListener:function(e,t){var n=t;this.listeners.set(e,n)},hasEventListener:function(){return this.listeners.iterator().hasNext()},removeEventListener:function(e){this.listeners.remove(e)},emit:function(e,t){var n=this.listeners.get(e);null!=n&&n.apply(this,t)},emitOnSend:function(e){this.message=this.get_message(e),this.emit("send",[this,e])},emitOnRead:function(e,t){var n=[];null!=t&&(this.__unreadIds=t);for(var r=0;r<e.length;){var a=e[r];++r,ie.Int64Helper.contains(this.__readerIds,a)||(this.__readerIds.push(a),n.push(a)),ie.Int64Helper.remove(this.__unreadIds,a)}0<n.length&&this.emit("read",[this.users(n),this.get_readUsers(),this.get_unreadUsers()])},setFirstReader:function(e){this.__readerIds=[e.id],this.__unreadIds=this.talk.userIds.slice(),ie.Int64Helper.remove(this.__unreadIds,e.id)},get_readUsers:function(){return this.users(this.__readerIds)},get_unreadUsers:function(){return this.users(this.__unreadIds)},users:function(e){return null==e?[]:u.proxy.Emitter.factory.hubotObject.userObjectsByIds(this.talk.domainId,e)},get_message:function(e){return u.proxy.Emitter.factory.hubotObject.messageObject(e)},answer:function(n){var r=this,a=ie.entity.Message.typeOf(this.message.type),e=ie.Int64Helper.idStrToInt64(this.message.id);switch(a[1]){case 8:case 13:case 10:case 14:case 12:case 15:var t=this.message.content.in_reply_to;e=new oe.Int64(t.high,t.low)}u.proxy.Emitter.factory.sendNotification("ReloadData",ie.command.ReloadDataType.Question(e,function(e){var t=e.responses;switch(a[1]){case 7:case 8:case 13:n(r.users(t[0].userIds),r.users(t[1].userIds));break;case 9:case 10:case 14:n(t.map(function(e){return r.users(e.userIds)}));break;case 11:case 12:case 15:n(r.users(t[0].userIds),r.users(t[1].userIds))}}))},startTimer:function(e,t){var n=this;null!=this.__readerTimer&&this.stopTimer(),this.__readerTimerWait=e?1:1440;var r=null;r=function(){n.__readerTimerWait*=2,n.__readerTimerWait<1440?(t(!1),n.__readerTimer=oe.Timer.delay(r,60*n.__readerTimerWait*1e3|0)):(t(!0),n.__readerTimer=null)},this.__readerTimer=oe.Timer.delay(r,60*this.__readerTimerWait*1e3|0)},stopTimer:function(){null!=this.__readerTimer&&(this.__readerTimer.stop(),this.__readerTimer=null)},__class__:u.proxy.Emitter},u.proxy.SendQueueProxy=function(){l.patterns.proxy.Proxy.call(this,"sendQueue"),this.sendCount=0,this.sendMsgQueue=new u.proxy._SendQueueProxy.SendQueue(this,550,new ie.js.LocalStorage("sendQueueMessage")),this.sendAnnounceQueue=new u.proxy._SendQueueProxy.SendQueue(this,5050,new ie.js.LocalStorage("sendQueueAnnounce"))},n["albero_cli.proxy.SendQueueProxy"]=u.proxy.SendQueueProxy,u.proxy.SendQueueProxy.__name__=["albero_cli","proxy","SendQueueProxy"],u.proxy.SendQueueProxy.__super__=l.patterns.proxy.Proxy,u.proxy.SendQueueProxy.prototype=t(l.patterns.proxy.Proxy.prototype,{restart:function(){this.sendMsgQueue.sendNext(),this.sendAnnounceQueue.sendNext()},retryAfter:function(e){this.sendMsgQueue.retryAfter(e),this.sendAnnounceQueue.retryAfter(e)},sendNext:function(e){null!=e.talkId?this.sendMsgQueue.sendNext():this.sendAnnounceQueue.sendNext()},sendAnnouncement:function(e,t){this.send(e,null,t)},sendMessage:function(e,t){this.send(null,e,t)},send:function(e,t,n){if("string"!=typeof n){var r=oe.Int64.make(0,this.sendCount++);this.messageEvent.registEmitter("_"+r.high+"_"+r.low,n);var a=new ie.entity.Message;if(a.id=r,a.domainId=e,a.talkId=t,a.content=this.parseContent(n),a.type=this.detectType(a.content),a.type==ie.entity.MessageType.unknown)return;if(a.type==ie.entity.MessageType.file&&null!=a.content.path)return void this.sendFile(t,a.content,"_"+r.high+"_"+r.low);a.type!=ie.entity.MessageType.yesOrNo&&a.type!=ie.entity.MessageType.selectOne||null!=a.content.listing||(a.content.listing=!1),this.applyLimitToMessage(a),this.pushQueue(a)}else for(var i=0,o=c.slice(n,1024);i<o.length;){var s=o[i];++i;var l=new ie.entity.Message;l.domainId=e,l.talkId=t,l.type=ie.entity.MessageType.text,l.content=s,this.pushQueue(l)}},sendFile:function(e,t,n){var r,a=null,i=null;if("string"==typeof t)r=t;else{if(t.path instanceof Array&&null==t.path.__enum__)return void this.sendFiles(e,t.path,t.name,t.type,t.text,n);if(null!=t.text)return void this.sendFiles(e,[t.path],[t.name],[t.type],t.text,n);r=t.path,a=t.name,i=t.type}null!=r&&C.Node.require("fs").existsSync(r)?this.sendMsgQueue.pushQueue("File",ie.command.FileAction.UPLOAD_PATH(e,r,a,i,n)):se._e(se.dateStr(),"File not found: ",r,"","","")},sendFiles:function(e,t,n,r,a,i){for(var o=0;o<t.length;){var s=t[o];if(++o,!C.Node.require("fs").existsSync(s))return void se._e(se.dateStr(),"File not found: ",s,"","","")}var l=t.length;if(null==n){for(var c=[],u=0;u<l;){u++;c.push(null)}n=c}if(null==r){for(var d=[],p=0;p<l;){p++;d.push(null)}r=d}n.length==l&&r.length==l?this.sendMsgQueue.pushQueue("File",ie.command.FileAction.UPLOAD_MULTI_PATH(e,a,t,n,r,i)):se._e(se.dateStr(),"The length of name or type must be the same as path length.","","","","")},pushQueue:function(e){null==e.talkId?this.sendAnnounceQueue.pushQueue("Send",e):this.sendMsgQueue.pushQueue("Send",e)},parseContent:function(e){if(null==e)return null;for(var t=H.fields(e),n=0;n<t.length;){var r=t[n];++n;var a=H.field(e,r);if("string"==typeof a){var i=null;"stamp_set"==r?i=Z.parseInt(a):"stamp_index"==r?i=ie.Int64Helper.parse(a):"file_id"==r||"in_reply_to"==r?i=ie.Int64Helper.idStrToInt64(a):"close_yesno"!=r&&"close_select"!=r&&"close_task"!=r||(H.setField(e,"close",Y.substr(r,6,null)),r="in_reply_to",i=ie.Int64Helper.idStrToInt64(a)),null!=i&&(e[r]=i)}else null!=a&&H.isObject(e)&&null!=a.high&&null!=a.low&&H.setField(e,r,oe.Int64.make(a.high,a.low))}return 1==t.length&&null!=e.text?e.text:e},detectType:function(e){if(null==e)return ie.entity.MessageType.unknown;if("string"==typeof e)return ie.entity.MessageType.text;if(null!=e.stamp_set)return ie.entity.MessageType.stamp;if(null!=e.lat)return ie.entity.MessageType.geo;if(null!=e.file_id||null!=e.path)return ie.entity.MessageType.file;if(null!=e.close){var t=e.close;if(H.deleteField(e,"close"),"yesno"==t)return ie.entity.MessageType.yesOrNoClosed;if("select"==t)return ie.entity.MessageType.selectOneClosed;if("task"==t)return ie.entity.MessageType.todoClosed}else if(null!=e.in_reply_to){if("boolean"==typeof e.response)return ie.entity.MessageType.yesOrNoReply;if(C.Boot.__instanceof(e.response,f))return ie.entity.MessageType.selectOneReply;if(null!=e.done)return ie.entity.MessageType.todoDone}else{if(null!=e.question)return null==e.options?ie.entity.MessageType.yesOrNo:ie.entity.MessageType.selectOne;if(null!=e.title)return ie.entity.MessageType.todo}return ie.entity.MessageType.unknown},applyLimitToMessage:function(e){switch(e.type[1]){case 1:var t=e.content;null!=t&&1024<t.length&&(e.content=t.substring(0,1024));break;case 2:case 5:var n=e.content.text;null!=n&&1024<n.length&&(e.content.text=n.substring(0,1024));break;case 7:case 9:var r=e.content.question;if(null!=r&&1024<r.length&&(e.content.question=r.substring(0,1024)),e.type==ie.entity.MessageType.selectOne){var a=e.content.options;9<a.length&&(e.content.options=a=a.slice(0,9));for(var i=0,o=a.length;i<o;){var s=i++;64<a[s].length&&(a[s]=a[s].substring(0,64))}}break;case 11:var l=e.content.title;null!=l&&1024<l.length&&(e.content.title=l.substring(0,1024))}},__class__:u.proxy.SendQueueProxy}),u.proxy._SendQueueProxy={},u.proxy._SendQueueProxy.SendQueue=function(e,t,n){this.proxy=e,this.sendSpan=t,this.storage=n,this.sendQueue=this.loadQueue(),this.sending=0<this.sendQueue.length,this.lastSendNode=null;var r=new Date;r.setTime(0),this.lastSendTime=r},n["albero_cli.proxy._SendQueueProxy.SendQueue"]=u.proxy._SendQueueProxy.SendQueue,u.proxy._SendQueueProxy.SendQueue.__name__=["albero_cli","proxy","_SendQueueProxy","SendQueue"],u.proxy._SendQueueProxy.SendQueue.prototype={pushQueue:function(e,t){this.sendQueue.push({name:e,param:t}),this.saveQueue(),this.sending||(this.sending=!0,this.sendNext())},sendNext:function(){if(this.sending&&0!=this.sendQueue.length){var e=(new Date).getTime()-this.lastSendTime.getTime(),t=Z.int(Math.max(this.sendSpan-e,100));oe.Timer.delay(_(this,this.sendNotification),t)}else this.closeQueue()},retryAfter:function(e){this.sending&&null!=this.lastSendNode?(this.sendQueue.unshift(this.lastSendNode),this.saveQueue(),oe.Timer.delay(_(this,this.sendNotification),e)):this.closeQueue()},sendNotification:function(){var e=this.sendQueue.shift();this.saveQueue(),this.proxy.sendNotification(e.name,e.param),this.lastSendNode=e,this.lastSendTime=new Date},closeQueue:function(){this.sending=!1,this.lastSendNode=null},saveQueue:function(){null!=this.storage&&this.storage.save(this.sendQueue)},loadQueue:function(){if(null!=this.storage){var e=this.storage.load();if(null!=e)return e}return new Array},__class__:u.proxy._SendQueueProxy.SendQueue},oe.Json=function(){},n["haxe.Json"]=oe.Json,oe.Json.__name__=["haxe","Json"],oe.Json.stringify=function(e,t,n){return JSON.stringify(e,t,n)},oe.Json.parse=function(e){return JSON.parse(e)},oe.Serializer=function(){this.buf=new L,this.cache=new Array,this.useCache=oe.Serializer.USE_CACHE,this.useEnumIndex=oe.Serializer.USE_ENUM_INDEX,this.shash=new oe.ds.StringMap,this.scount=0},n["haxe.Serializer"]=oe.Serializer,oe.Serializer.__name__=["haxe","Serializer"],oe.Serializer.run=function(e){var t=new oe.Serializer;return t.serialize(e),t.toString()},oe.Serializer.prototype={toString:function(){return this.buf.b},serializeString:function(e){var t=this.shash.get(e);if(null!=t)return this.buf.b+="R",void(this.buf.b+=null==t?"null":""+t);this.shash.set(e,this.scount++),this.buf.b+="y",null==(e=encodeURIComponent(e)).length?this.buf.b+="null":this.buf.b+=""+e.length,this.buf.b+=":",this.buf.b+=null==e?"null":""+e},serializeRef:function(e){for(var t=typeof e,n=0,r=this.cache.length;n<r;){var a=n++,i=this.cache[a];if(typeof i==t&&i==e)return this.buf.b+="r",this.buf.b+=null==a?"null":""+a,!0}return this.cache.push(e),!1},serializeFields:function(e){for(var t=0,n=H.fields(e);t<n.length;){var r=n[t];++t,this.serializeString(r),this.serialize(H.field(e,r))}this.buf.b+="g"},serialize:function(e){var t=te.typeof(e);switch(t[1]){case 0:this.buf.b+="n";break;case 1:var n=e;if(0==n)return void(this.buf.b+="z");this.buf.b+="i",this.buf.b+=null==n?"null":""+n;break;case 2:var r=e;Math.isNaN(r)?this.buf.b+="k":Math.isFinite(r)?(this.buf.b+="d",this.buf.b+=null==r?"null":""+r):this.buf.b+=r<0?"m":"p";break;case 3:this.buf.b+=e?"t":"f";break;case 6:var a=t[2];if(a==String)return void this.serializeString(e);if(this.useCache&&this.serializeRef(e))return;switch(a){case Array:var i=0;this.buf.b+="a";for(var o=e.length,s=0;s<o;){var l=s++;null==e[l]?i++:(0<i&&(1==i?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==i?"null":""+i),i=0),this.serialize(e[l]))}0<i&&(1==i?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==i?"null":""+i)),this.buf.b+="h";break;case X:this.buf.b+="l";for(var c=e.iterator();c.hasNext();){var u=c.next();this.serialize(u)}this.buf.b+="h";break;case Date:var d=e;this.buf.b+="v",this.buf.add(Y.dateStr(d));break;case oe.ds.StringMap:this.buf.b+="b";for(var p=e,m=p.keys();m.hasNext();){var _=m.next();this.serializeString(_),this.serialize(p.get(_))}this.buf.b+="h";break;case oe.ds.IntMap:this.buf.b+="q";for(var h=e,y=h.keys();y.hasNext();){var f=y.next();this.buf.b+=":",this.buf.b+=null==f?"null":""+f,this.serialize(h.get(f))}this.buf.b+="h";break;case oe.ds.ObjectMap:this.buf.b+="M";for(var g=e,S=g.keys();S.hasNext();){var T=S.next(),v=H.field(T,"__id__");H.deleteField(T,"__id__"),this.serialize(T),T.__id__=v,this.serialize(g.h[T.__id__])}this.buf.b+="h";break;case oe.io.Bytes:for(var I=e,A=0,x=I.length-2,w=new L,k=oe.Serializer.BASE64;A<x;){var b=I.get(A++),D=I.get(A++),M=I.get(A++);w.add(k.charAt(b>>2)),w.add(k.charAt(63&(b<<4|D>>4))),w.add(k.charAt(63&(D<<2|M>>6))),w.add(k.charAt(63&M))}if(A==x){var E=I.get(A++),C=I.get(A++);w.add(k.charAt(E>>2)),w.add(k.charAt(63&(E<<4|C>>4))),w.add(k.charAt(C<<2&63))}else if(A==x+1){var P=I.get(A++);w.add(k.charAt(P>>2)),w.add(k.charAt(P<<4&63))}var N=w.b;this.buf.b+="s",null==N.length?this.buf.b+="null":this.buf.b+=""+N.length,this.buf.b+=":",this.buf.b+=null==N?"null":""+N;break;default:this.useCache&&this.cache.pop(),null!=e.hxSerialize?(this.buf.b+="C",this.serializeString(te.getClassName(a)),this.useCache&&this.cache.push(e),e.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(te.getClassName(a)),this.useCache&&this.cache.push(e),this.serializeFields(e))}break;case 4:if(this.useCache&&this.serializeRef(e))return;this.buf.b+="o",this.serializeFields(e);break;case 7:var U=t[2];if(this.useCache){if(this.serializeRef(e))return;this.cache.pop()}this.useEnumIndex?this.buf.b+="j":this.buf.b+="w",this.serializeString(te.getEnumName(U)),this.useEnumIndex?(this.buf.b+=":",this.buf.b+=Z.string(e[1])):this.serializeString(e[0]),this.buf.b+=":";var R=e.length;this.buf.b+=Z.string(R-2);for(var O=2;O<R;){var F=O++;this.serialize(e[F])}this.useCache&&this.cache.push(e);break;case 5:throw"Cannot serialize function";default:throw"Cannot serialize "+Z.string(e)}},__class__:oe.Serializer},oe.Timer=function(e){var t=this;this.id=setInterval(function(){t.run()},e)},n["haxe.Timer"]=oe.Timer,oe.Timer.__name__=["haxe","Timer"],oe.Timer.delay=function(e,t){var n=new oe.Timer(t);return n.run=function(){n.stop(),e()},n},oe.Timer.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:oe.Timer},oe.Unserializer=function(e){this.buf=e,this.length=e.length,this.pos=0,this.scache=new Array,this.cache=new Array;var t=oe.Unserializer.DEFAULT_RESOLVER;null==t&&(t=te,oe.Unserializer.DEFAULT_RESOLVER=t),this.setResolver(t)},n["haxe.Unserializer"]=oe.Unserializer,oe.Unserializer.__name__=["haxe","Unserializer"],oe.Unserializer.initCodes=function(){for(var e=new Array,t=0,n=oe.Unserializer.BASE64.length;t<n;){var r=t++;e[oe.Unserializer.BASE64.charCodeAt(r)]=r}return e},oe.Unserializer.run=function(e){return new oe.Unserializer(e).unserialize()},oe.Unserializer.prototype={setResolver:function(e){this.resolver=null==e?{resolveClass:function(e){return null},resolveEnum:function(e){return null}}:e},get:function(e){return this.buf.charCodeAt(e)},readDigits:function(){for(var e=0,t=!1,n=this.pos;;){var r=this.buf.charCodeAt(this.pos);if(r!=r)break;if(45!=r){if(r<48||57<r)break;e=10*e+(r-48),this.pos++}else{if(this.pos!=n)break;t=!0,this.pos++}}return t&&(e*=-1),e},unserializeObject:function(e){for(;;){if(this.pos>=this.length)throw"Invalid object";if(103==this.buf.charCodeAt(this.pos))break;var t=this.unserialize();if("string"!=typeof t)throw"Invalid object key";var n=this.unserialize();e[t]=n}this.pos++},unserializeEnum:function(e,t){if(58!=this.get(this.pos++))throw"Invalid enum format";var n=this.readDigits();if(0==n)return te.createEnum(e,t);for(var r=new Array;0<n--;)r.push(this.unserialize());return te.createEnum(e,t,r)},unserialize:function(){switch(this.get(this.pos++)){case 110:return null;case 116:return!0;case 102:return!1;case 122:return 0;case 105:return this.readDigits();case 100:for(var e=this.pos;;){var t=this.buf.charCodeAt(this.pos);if(!(43<=t&&t<58||101==t||69==t))break;this.pos++}return Z.parseFloat(Y.substr(this.buf,e,this.pos-e));case 121:var n=this.readDigits();if(58!=this.get(this.pos++)||this.length-this.pos<n)throw"Invalid string length";var r=Y.substr(this.buf,this.pos,n);return this.pos+=n,r=decodeURIComponent(r.split("+").join(" ")),this.scache.push(r),r;case 107:return Math.NaN;case 109:return Math.NEGATIVE_INFINITY;case 112:return Math.POSITIVE_INFINITY;case 97:this.buf;var a=new Array;for(this.cache.push(a);;){var i=this.buf.charCodeAt(this.pos);if(104==i){this.pos++;break}if(117==i){this.pos++;var o=this.readDigits();a[a.length+o-1]=null}else a.push(this.unserialize())}return a;case 111:var s={};return this.cache.push(s),this.unserializeObject(s),s;case 114:var l=this.readDigits();if(l<0||l>=this.cache.length)throw"Invalid reference";return this.cache[l];case 82:var c=this.readDigits();if(c<0||c>=this.scache.length)throw"Invalid string reference";return this.scache[c];case 120:throw this.unserialize();case 99:var u=this.unserialize(),d=this.resolver.resolveClass(u);if(null==d)throw"Class not found "+u;var p=te.createEmptyInstance(d);return this.cache.push(p),this.unserializeObject(p),p;case 119:var m=this.unserialize(),_=this.resolver.resolveEnum(m);if(null==_)throw"Enum not found "+m;var h=this.unserializeEnum(_,this.unserialize());return this.cache.push(h),h;case 106:var y=this.unserialize(),f=this.resolver.resolveEnum(y);if(null==f)throw"Enum not found "+y;this.pos++;var g=this.readDigits(),S=te.getEnumConstructs(f)[g];if(null==S)throw"Unknown enum index "+y+"@"+g;var T=this.unserializeEnum(f,S);return this.cache.push(T),T;case 108:var v=new X;this.cache.push(v);for(this.buf;104!=this.buf.charCodeAt(this.pos);)v.add(this.unserialize());return this.pos++,v;case 98:var I=new oe.ds.StringMap;this.cache.push(I);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var A=this.unserialize();I.set(A,this.unserialize())}return this.pos++,I;case 113:var x=new oe.ds.IntMap;this.cache.push(x);this.buf;for(var w=this.get(this.pos++);58==w;){var k=this.readDigits();x.set(k,this.unserialize()),w=this.get(this.pos++)}if(104!=w)throw"Invalid IntMap format";return x;case 77:var b=new oe.ds.ObjectMap;this.cache.push(b);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var D=this.unserialize();b.set(D,this.unserialize())}return this.pos++,b;case 118:var M,E=Y.substr(this.buf,this.pos,19);return M=Y.strDate(E),this.cache.push(M),this.pos+=19,M;case 115:var C=this.readDigits(),P=this.buf;if(58!=this.get(this.pos++)||this.length-this.pos<C)throw"Invalid bytes length";var N=oe.Unserializer.CODES;null==N&&(N=oe.Unserializer.initCodes(),oe.Unserializer.CODES=N);var U,R=this.pos,O=3&C;U=3*(C>>2)+(2<=O?O-1:0);for(var F=R+(C-O),H=oe.io.Bytes.alloc(U),L=0;R<F;){var B=N[ee.fastCodeAt(P,R++)],j=N[ee.fastCodeAt(P,R++)];H.set(L++,B<<2|j>>4);var z=N[ee.fastCodeAt(P,R++)];H.set(L++,j<<4|z>>2);var Q=N[ee.fastCodeAt(P,R++)];H.set(L++,z<<6|Q)}if(2<=O){var V=N[ee.fastCodeAt(P,R++)],q=N[ee.fastCodeAt(P,R++)];if(H.set(L++,V<<2|q>>4),3==O){var G=N[ee.fastCodeAt(P,R++)];H.set(L++,q<<4|G>>2)}}return this.pos+=C,this.cache.push(H),H;case 67:var K=this.unserialize(),W=this.resolver.resolveClass(K);if(null==W)throw"Class not found "+K;var J=te.createEmptyInstance(W);if(this.cache.push(J),J.hxUnserialize(this),103!=this.get(this.pos++))throw"Invalid custom data";return J}throw this.pos--,"Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos},__class__:oe.Unserializer},oe.ds={},oe.ds.BalancedTree=function(){},n["haxe.ds.BalancedTree"]=oe.ds.BalancedTree,oe.ds.BalancedTree.__name__=["haxe","ds","BalancedTree"],oe.ds.BalancedTree.prototype={set:function(e,t){this.root=this.setLoop(e,t,this.root)},get:function(e){for(var t=this.root;null!=t;){var n=this.compare(e,t.key);if(0==n)return t.value;t=n<0?t.left:t.right}return null},remove:function(e){try{return this.root=this.removeLoop(e,this.root),!0}catch(e){if(C.Boot.__instanceof(e,String))return!1;throw e}},keys:function(){var e=[];return this.keysLoop(this.root,e),Y.iter(e)},setLoop:function(e,t,n){if(null==n)return new oe.ds.TreeNode(null,e,t,null);var r=this.compare(e,n.key);if(0==r)return new oe.ds.TreeNode(n.left,e,t,n.right,null==n?0:n._height);if(r<0){var a=this.setLoop(e,t,n.left);return this.balance(a,n.key,n.value,n.right)}var i=this.setLoop(e,t,n.right);return this.balance(n.left,n.key,n.value,i)},removeLoop:function(e,t){if(null==t)throw"Not_found";var n=this.compare(e,t.key);return 0==n?this.merge(t.left,t.right):n<0?this.balance(this.removeLoop(e,t.left),t.key,t.value,t.right):this.balance(t.left,t.key,t.value,this.removeLoop(e,t.right))},keysLoop:function(e,t){null!=e&&(this.keysLoop(e.left,t),t.push(e.key),this.keysLoop(e.right,t))},merge:function(e,t){if(null==e)return t;if(null==t)return e;var n=this.minBinding(t);return this.balance(e,n.key,n.value,this.removeMinBinding(t))},minBinding:function(e){if(null==e)throw"Not_found";return null==e.left?e:this.minBinding(e.left)},removeMinBinding:function(e){return null==e.left?e.right:this.balance(this.removeMinBinding(e.left),e.key,e.value,e.right)},balance:function(e,t,n,r){var a,i,o,s,l,c;return a=null==e?0:e._height,(i=null==r?0:r._height)+2<a?(null==(c=e.left)?0:c._height)>=(null==(l=e.right)?0:l._height)?new oe.ds.TreeNode(e.left,e.key,e.value,new oe.ds.TreeNode(e.right,t,n,r)):new oe.ds.TreeNode(new oe.ds.TreeNode(e.left,e.key,e.value,e.right.left),e.right.key,e.right.value,new oe.ds.TreeNode(e.right.right,t,n,r)):a+2<i?(null==(s=r.right)?0:s._height)>(null==(o=r.left)?0:o._height)?new oe.ds.TreeNode(new oe.ds.TreeNode(e,t,n,r.left),r.key,r.value,r.right):new oe.ds.TreeNode(new oe.ds.TreeNode(e,t,n,r.left.left),r.left.key,r.left.value,new oe.ds.TreeNode(r.left.right,r.key,r.value,r.right)):new oe.ds.TreeNode(e,t,n,r,(i<a?a:i)+1)},compare:function(e,t){return H.compare(e,t)},__class__:oe.ds.BalancedTree},oe.ds.TreeNode=function(e,t,n,r,a){var i,o,s,l;null==a&&(a=-1),this.left=e,this.key=t,this.value=n,this.right=r,this._height=-1==a?((null==(l=this.left)?0:l._height)>(null==(s=this.right)?0:s._height)?null==(o=this.left)?0:o._height:null==(i=this.right)?0:i._height)+1:a},n["haxe.ds.TreeNode"]=oe.ds.TreeNode,oe.ds.TreeNode.__name__=["haxe","ds","TreeNode"],oe.ds.TreeNode.prototype={__class__:oe.ds.TreeNode},oe.ds.EnumValueMap=function(){oe.ds.BalancedTree.call(this)},n["haxe.ds.EnumValueMap"]=oe.ds.EnumValueMap,oe.ds.EnumValueMap.__name__=["haxe","ds","EnumValueMap"],oe.ds.EnumValueMap.__interfaces__=[a],oe.ds.EnumValueMap.__super__=oe.ds.BalancedTree,oe.ds.EnumValueMap.prototype=t(oe.ds.BalancedTree.prototype,{compare:function(e,t){var n=e[1]-t[1];if(0!=n)return n;var r=e.slice(2),a=t.slice(2);return 0==r.length&&0==a.length?0:this.compareArgs(r,a)},compareArgs:function(e,t){var n=e.length-t.length;if(0!=n)return n;for(var r=0,a=e.length;r<a;){var i=r++,o=this.compareArg(e[i],t[i]);if(0!=o)return o}return 0},compareArg:function(e,t){return H.isEnumValue(e)&&H.isEnumValue(t)?this.compare(e,t):e instanceof Array&&null==e.__enum__&&t instanceof Array&&null==t.__enum__?this.compareArgs(e,t):H.compare(e,t)},__class__:oe.ds.EnumValueMap}),oe.ds.IntMap=function(){this.h={}},n["haxe.ds.IntMap"]=oe.ds.IntMap,oe.ds.IntMap.__name__=["haxe","ds","IntMap"],oe.ds.IntMap.__interfaces__=[a],oe.ds.IntMap.prototype={set:function(e,t){this.h[e]=t},get:function(e){return this.h[e]},exists:function(e){return this.h.hasOwnProperty(e)},remove:function(e){return!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(0|t);return Y.iter(e)},__class__:oe.ds.IntMap},oe.ds.ObjectMap=function(){this.h={},this.h.__keys__={}},n["haxe.ds.ObjectMap"]=oe.ds.ObjectMap,oe.ds.ObjectMap.__name__=["haxe","ds","ObjectMap"],oe.ds.ObjectMap.__interfaces__=[a],oe.ds.ObjectMap.prototype={set:function(e,t){var n=e.__id__||(e.__id__=++oe.ds.ObjectMap.count);this.h[n]=t,this.h.__keys__[n]=e},remove:function(e){var t=e.__id__;return null!=this.h.__keys__[t]&&(delete this.h[t],delete this.h.__keys__[t],!0)},keys:function(){var e=[];for(var t in this.h.__keys__)this.h.hasOwnProperty(t)&&e.push(this.h.__keys__[t]);return Y.iter(e)},__class__:oe.ds.ObjectMap},oe.ds.Option=n["haxe.ds.Option"]={__ename__:["haxe","ds","Option"],__constructs__:["Some","None"]},oe.ds.Option.Some=function(e){var t=["Some",0,e];return t.__enum__=oe.ds.Option,t.toString=s,t},oe.ds.Option.None=["None",1],oe.ds.Option.None.toString=s,oe.ds.Option.None.__enum__=oe.ds.Option,oe.ds.Option.__empty_constructs__=[oe.ds.Option.None],oe.ds.StringMap=function(){this.h={}},n["haxe.ds.StringMap"]=oe.ds.StringMap,oe.ds.StringMap.__name__=["haxe","ds","StringMap"],oe.ds.StringMap.__interfaces__=[a],oe.ds.StringMap.prototype={set:function(e,t){this.h["$"+e]=t},get:function(e){return this.h["$"+e]},exists:function(e){return this.h.hasOwnProperty("$"+e)},remove:function(e){return e="$"+e,!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(t.substr(1));return Y.iter(e)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var e=this.it.next();return this.ref["$"+e]}}},__class__:oe.ds.StringMap},oe.io={},oe.io.Bytes=function(e,t){this.length=e,this.b=t},n["haxe.io.Bytes"]=oe.io.Bytes,oe.io.Bytes.__name__=["haxe","io","Bytes"],oe.io.Bytes.alloc=function(e){return new oe.io.Bytes(e,new Buffer(e))},oe.io.Bytes.ofString=function(e){var t=new Buffer(e,"utf8");return new oe.io.Bytes(t.length,t)},oe.io.Bytes.ofData=function(e){return new oe.io.Bytes(e.length,e)},oe.io.Bytes.prototype={get:function(e){return this.b[e]},set:function(e,t){this.b[e]=t},blit:function(e,t,n,r){if(e<0||n<0||r<0||e+r>this.length||n+r>t.length)throw oe.io.Error.OutsideBounds;t.b.copy(this.b,e,n,n+r)},sub:function(e,t){if(e<0||t<0||e+t>this.length)throw oe.io.Error.OutsideBounds;var n=new Buffer(t);return this.b.slice(e,e+t).copy(n,0,0,t),new oe.io.Bytes(t,n)},compare:function(e){var t,n=this.b,r=e.b;t=this.length<e.length?this.length:e.length;for(var a=0;a<t;){var i=a++;if(n[i]!=r[i])return n[i]-r[i]}return this.length-e.length},getString:function(e,t){if(e<0||t<0||e+t>this.length)throw oe.io.Error.OutsideBounds;return this.b.toString("utf8",e,e+t)},readString:function(e,t){return this.getString(e,t)},toString:function(){return this.getString(0,this.length)},toHex:function(){for(var e=new L,t=[],n="0123456789abcdef",r=0,a=n.length;r<a;){var i=r++;t.push(Y.cca(n,i))}for(var o=0,s=this.length;o<s;){var l=o++,c=this.b[l];e.b+=String.fromCharCode(t[c>>4]),e.b+=String.fromCharCode(t[15&c])}return e.b},getData:function(){return this.b},__class__:oe.io.Bytes},oe.io.BytesBuffer=function(){this.b=new Array},n["haxe.io.BytesBuffer"]=oe.io.BytesBuffer,oe.io.BytesBuffer.__name__=["haxe","io","BytesBuffer"],oe.io.BytesBuffer.prototype={get_length:function(){return this.b.length},addByte:function(e){this.b.push(e)},add:function(e){this.b;for(var t=e.b,n=0,r=e.length;n<r;){var a=n++;this.b.push(t[a])}},addBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw oe.io.Error.OutsideBounds;this.b;for(var r=e.b,a=t,i=t+n;a<i;){var o=a++;this.b.push(r[o])}},getBytes:function(){var e=new Buffer(this.b),t=new oe.io.Bytes(e.length,e);return this.b=null,t},__class__:oe.io.BytesBuffer},oe.io.Input=function(){},n["haxe.io.Input"]=oe.io.Input,oe.io.Input.__name__=["haxe","io","Input"],oe.io.Input.prototype={readByte:function(){throw"Not implemented"},readBytes:function(e,t,n){var r=n,a=e.b;if(t<0||n<0||t+n>e.length)throw oe.io.Error.OutsideBounds;for(;0<r;)a[t]=this.readByte(),t++,r--;return n},set_bigEndian:function(e){return this.bigEndian=e},read:function(e){for(var t=oe.io.Bytes.alloc(e),n=0;0<e;){var r=this.readBytes(t,n,e);if(0==r)throw oe.io.Error.Blocked;n+=r,e-=r}return t},readFloat:function(){var e=[];e.push(this.readByte()),e.push(this.readByte()),e.push(this.readByte()),e.push(this.readByte()),this.bigEndian||e.reverse();var t=1-(e[0]>>7<<1),n=(e[0]<<1&255|e[1]>>7)-127,r=(127&e[1])<<16|e[2]<<8|e[3];return 0==r&&-127==n?0:t*(1+Math.pow(2,-23)*r)*Math.pow(2,n)},readDouble:function(){var e=[];e.push(this.readByte()),e.push(this.readByte()),e.push(this.readByte()),e.push(this.readByte()),e.push(this.readByte()),e.push(this.readByte()),e.push(this.readByte()),e.push(this.readByte()),this.bigEndian||e.reverse();var t=1-(e[0]>>7<<1),n=(e[0]<<4&2047|e[1]>>4)-1023,r=this.getDoubleSig(e);return 0==r&&-1023==n?0:t*(1+Math.pow(2,-52)*r)*Math.pow(2,n)},readInt8:function(){var e=this.readByte();return 128<=e?e-256:e},readInt16:function(){var e,t=this.readByte(),n=this.readByte();return 0!=(32768&(e=this.bigEndian?n|t<<8:t|n<<8))?e-65536:e},readUInt16:function(){var e=this.readByte(),t=this.readByte();return this.bigEndian?t|e<<8:e|t<<8},readInt32:function(){var e=this.readByte(),t=this.readByte(),n=this.readByte(),r=this.readByte();return this.bigEndian?r|n<<8|t<<16|e<<24:e|t<<8|n<<16|r<<24},getDoubleSig:function(e){return 4294967296*((15&e[1])<<16|e[2]<<8|e[3])+2147483648*(e[4]>>7)+((127&e[4])<<24|e[5]<<16|e[6]<<8|e[7])},__class__:oe.io.Input},oe.io.BytesInput=function(e,t,n){if(null==t&&(t=0),null==n&&(n=e.length-t),t<0||n<0||t+n>e.length)throw oe.io.Error.OutsideBounds;this.b=e.b,this.pos=t,this.len=n,this.totlen=n},n["haxe.io.BytesInput"]=oe.io.BytesInput,oe.io.BytesInput.__name__=["haxe","io","BytesInput"],oe.io.BytesInput.__super__=oe.io.Input,oe.io.BytesInput.prototype=t(oe.io.Input.prototype,{readByte:function(){if(0==this.len)throw new oe.io.Eof;return this.len--,this.b[this.pos++]},readBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw oe.io.Error.OutsideBounds;if(0==this.len&&0<n)throw new oe.io.Eof;this.len<n&&(n=this.len);for(var r=this.b,a=e.b,i=0;i<n;){var o=i++;a[t+o]=r[this.pos+o]}return this.pos+=n,this.len-=n,n},__class__:oe.io.BytesInput}),oe.io.Output=function(){},n["haxe.io.Output"]=oe.io.Output,oe.io.Output.__name__=["haxe","io","Output"],oe.io.Output.prototype={writeByte:function(e){throw"Not implemented"},writeBytes:function(e,t,n){var r=n,a=e.b;if(t<0||n<0||t+n>e.length)throw oe.io.Error.OutsideBounds;for(;0<r;)this.writeByte(a[t]),t++,r--;return n},set_bigEndian:function(e){return this.bigEndian=e},write:function(e){for(var t=e.length,n=0;0<t;){var r=this.writeBytes(e,n,t);if(0==r)throw oe.io.Error.Blocked;n+=r,t-=r}},writeFloat:function(e){if(0==e)return this.writeByte(0),this.writeByte(0),this.writeByte(0),void this.writeByte(0);var t,n=Math.floor(Math.log(Math.abs(e))/oe.io.Output.LN2),r=8388607&Math.floor(Math.abs(e)/Math.pow(2,n)*8388608);t=n+127>>1|(0<n?e<0?128:64:e<0?128:0);var a=n+127<<7&255|r>>16&127,i=r>>8&255,o=255&r;this.bigEndian?(this.writeByte(t),this.writeByte(a),this.writeByte(i),this.writeByte(o)):(this.writeByte(o),this.writeByte(i),this.writeByte(a),this.writeByte(t))},writeDouble:function(e){if(0==e)return this.writeByte(0),this.writeByte(0),this.writeByte(0),this.writeByte(0),this.writeByte(0),this.writeByte(0),this.writeByte(0),void this.writeByte(0);var t,n=Math.floor(Math.log(Math.abs(e))/oe.io.Output.LN2),r=Math.floor(Math.abs(e)/Math.pow(2,n)*Math.pow(2,52)),a=34359738367&r,i=Math.floor(r/Math.pow(2,32));t=n+1023>>4|(0<n?e<0?128:64:e<0?128:0);var o=n+1023<<4&255|i>>16&15,s=i>>8&255,l=255&i,c=a>>24&255,u=a>>16&255,d=a>>8&255,p=255&a;this.bigEndian?(this.writeByte(t),this.writeByte(o),this.writeByte(s),this.writeByte(l),this.writeByte(c),this.writeByte(u),this.writeByte(d),this.writeByte(p)):(this.writeByte(p),this.writeByte(d),this.writeByte(u),this.writeByte(c),this.writeByte(l),this.writeByte(s),this.writeByte(o),this.writeByte(t))},writeInt8:function(e){if(e<-128||128<=e)throw oe.io.Error.Overflow;this.writeByte(255&e)},writeInt16:function(e){if(e<-32768||32768<=e)throw oe.io.Error.Overflow;this.writeUInt16(65535&e)},writeUInt16:function(e){if(e<0||65536<=e)throw oe.io.Error.Overflow;this.bigEndian?(this.writeByte(e>>8),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8))},writeInt32:function(e){this.bigEndian?(this.writeByte(e>>>24),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8&255),this.writeByte(e>>16&255),this.writeByte(e>>>24))},__class__:oe.io.Output},oe.io.BytesOutput=function(){this.b=new oe.io.BytesBuffer},n["haxe.io.BytesOutput"]=oe.io.BytesOutput,oe.io.BytesOutput.__name__=["haxe","io","BytesOutput"],oe.io.BytesOutput.__super__=oe.io.Output,oe.io.BytesOutput.prototype=t(oe.io.Output.prototype,{writeByte:function(e){this.b.b.push(e)},writeBytes:function(e,t,n){return this.b.addBytes(e,t,n),n},getBytes:function(){return this.b.getBytes()},__class__:oe.io.BytesOutput}),oe.io.Eof=function(){},n["haxe.io.Eof"]=oe.io.Eof,oe.io.Eof.__name__=["haxe","io","Eof"],oe.io.Eof.prototype={toString:function(){return"Eof"},__class__:oe.io.Eof},oe.io.Error=n["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]},oe.io.Error.Blocked=["Blocked",0],oe.io.Error.Blocked.toString=s,oe.io.Error.Blocked.__enum__=oe.io.Error,oe.io.Error.Overflow=["Overflow",1],oe.io.Error.Overflow.toString=s,oe.io.Error.Overflow.__enum__=oe.io.Error,oe.io.Error.OutsideBounds=["OutsideBounds",2],oe.io.Error.OutsideBounds.toString=s,oe.io.Error.OutsideBounds.__enum__=oe.io.Error,oe.io.Error.Custom=function(e){var t=["Custom",3,e];return t.__enum__=oe.io.Error,t.toString=s,t},oe.io.Error.__empty_constructs__=[oe.io.Error.Blocked,oe.io.Error.Overflow,oe.io.Error.OutsideBounds],oe.rtti={},oe.rtti.Meta=function(){},n["haxe.rtti.Meta"]=oe.rtti.Meta,oe.rtti.Meta.__name__=["haxe","rtti","Meta"],oe.rtti.Meta.getFields=function(e){var t=e.__meta__;return null==t||null==t.fields?{}:t.fields},C.Boot=function(){},n["js.Boot"]=C.Boot,C.Boot.__name__=["js","Boot"],C.Boot.getClass=function(e){return e instanceof Array&&null==e.__enum__?Array:e.__class__},C.Boot.__string_rec=function(e,t){if(null==e)return"null";if(5<=t.length)return"<...>";var n=typeof e;switch("function"==n&&(e.__name__||e.__ename__)&&(n="object"),n){case"object":if(e instanceof Array){if(e.__enum__){if(2==e.length)return e[0];var r=e[0]+"(";t+="\t";for(var a=2,i=e.length;a<i;){var o=a++;r+=2!=o?","+C.Boot.__string_rec(e[o],t):C.Boot.__string_rec(e[o],t)}return r+")"}var s=e.length,l="[";t+="\t";for(var c=0;c<s;){var u=c++;l+=(0<u?",":"")+C.Boot.__string_rec(e[u],t)}return l+="]"}var d;try{d=e.toString}catch(e){return"???"}if(null!=d&&d!=Object.toString){var p=e.toString();if("[object Object]"!=p)return p}var m=null,_="{\n";t+="\t";var h=null!=e.hasOwnProperty;for(var m in e)h&&!e.hasOwnProperty(m)||"prototype"!=m&&"__class__"!=m&&"__super__"!=m&&"__interfaces__"!=m&&"__properties__"!=m&&(2!=_.length&&(_+=", \n"),_+=t+m+" : "+C.Boot.__string_rec(e[m],t));return _+="\n"+(t=t.substring(1))+"}";case"function":return"<function>";case"string":return e;default:return String(e)}},C.Boot.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;var n=e.__interfaces__;if(null!=n)for(var r=0,a=n.length;r<a;){var i=n[r++];if(i==t||C.Boot.__interfLoop(i,t))return!0}return C.Boot.__interfLoop(e.__super__,t)},C.Boot.__instanceof=function(e,t){if(null==t)return!1;switch(t){case f:return(0|e)===e;case T:return"number"==typeof e;case I:return"boolean"==typeof e;case String:return"string"==typeof e;case Array:return e instanceof Array&&null==e.__enum__;case S:return!0;default:if(null==e)return!1;if("function"==typeof t){if(e instanceof t)return!0;if(C.Boot.__interfLoop(C.Boot.getClass(e),t))return!0}return t==A&&null!=e.__name__||(t==x&&null!=e.__ename__||e.__enum__==t)}},C.Boot.__cast=function(e,t){if(C.Boot.__instanceof(e,t))return e;throw"Cannot cast "+Z.string(e)+" to "+Z.string(t)},C.NodeC=function(){},n["js.NodeC"]=C.NodeC,C.NodeC.__name__=["js","NodeC"];var h={};function d(e){return e instanceof Array?function(){return Y.iter(e)}:"function"==typeof e.iterator?_(e,e.iterator):e.iterator}h.Decoder=function(e,t){var n=new oe.io.BytesInput(e);n.set_bigEndian(!0),this.o=this.decode(n,t)},n["msgpack.Decoder"]=h.Decoder,h.Decoder.__name__=["msgpack","Decoder"],h.Decoder.prototype={decode:function(e,t){try{var n=e.readByte();switch(n){case 192:return null;case 194:return!1;case 195:return!0;case 202:return e.readFloat();case 203:return e.readDouble();case 204:return e.readByte();case 205:return e.readUInt16();case 206:return e.readInt32();case 207:return oe.Int64.make(e.readInt32(),e.readInt32());case 208:return e.readInt8();case 209:return e.readInt16();case 210:return e.readInt32();case 211:return oe.Int64.make(e.readInt32(),e.readInt32());case 218:case 219:return e.read(218==n?e.readUInt16():e.readInt32()).toString();case 220:case 221:return this.readArray(e,220==n?e.readUInt16():e.readInt32(),t);case 222:case 223:return this.readMap(e,222==n?e.readUInt16():e.readInt32(),t);default:if(n<128)return n;if(n<144)return this.readMap(e,15&n,t);if(n<160)return this.readArray(e,15&n,t);if(n<192)return e.read(31&n).toString();if(223<n)return-256|n}}catch(e){if(!C.Boot.__instanceof(e,oe.io.Eof))throw e}return null},readArray:function(e,t,n){for(var r=[],a=0;a<t;){a++;r.push(this.decode(e,n))}return r},readMap:function(e,t,n){if(n){for(var r={},a=0;a<t;){a++;var i=this.decode(e,n),o=this.decode(e,n);r[i]=o}return r}for(var s=new oe.ds.ObjectMap,l=0;l<t;){l++;var c=this.decode(e,n),u=this.decode(e,n);s.set(c,u)}return s},getResult:function(){return this.o},__class__:h.Decoder},h.Encoder=function(e){this.o=new oe.io.BytesOutput,this.o.set_bigEndian(!0),this.encode(e)},n["msgpack.Encoder"]=h.Encoder,h.Encoder.__name__=["msgpack","Encoder"],h.Encoder.prototype={encode:function(e){var t=te.typeof(e);switch(t[1]){case 0:this.o.writeByte(192);break;case 3:this.o.writeByte(e?195:194);break;case 1:this.writeInt(e);break;case 2:this.writeFloat(e);break;case 6:var n=t[2];switch(te.getClassName(n)){case"String":this.writeRaw(oe.io.Bytes.ofString(e));break;case"Array":this.writeArray(e);break;case"Hash":this.writeHashMap(e);break;case"haxe.Int64":this.writeInt64(e)}break;case 4:this.writeObjectMap(e);break;case 7:throw"Error: Enum not supported";case 5:throw"Error: Function not supported";case 8:throw"Error: Unknown Data Type"}},writeInt:function(e){e<-32?e<-32768?(this.o.writeByte(210),this.o.writeInt32(e)):e<-128?(this.o.writeByte(209),this.o.writeInt16(e)):(this.o.writeByte(208),this.o.writeInt8(e)):e<128?this.o.writeByte(255&e):e<256?(this.o.writeByte(204),this.o.writeByte(e)):e<65536?(this.o.writeByte(205),this.o.writeUInt16(e)):(this.o.writeByte(206),this.o.writeInt32(e))},writeInt64:function(e){this.o.writeByte(e.high<0?211:207),this.o.writeInt32(oe.Int64.getHigh(e)),this.o.writeInt32(oe.Int64.getLow(e))},writeFloat:function(e){var t=Math.abs(e);1401298464324817e-60<t&&t<34028234663852886e22?(this.o.writeByte(202),this.o.writeFloat(e)):(this.o.writeByte(203),this.o.writeDouble(e))},writeRaw:function(e){var t=e.length;t<32?this.o.writeByte(160|t):t<65536?(this.o.writeByte(218),this.o.writeUInt16(t)):(this.o.writeByte(219),this.o.writeInt32(t)),this.o.write(e)},writeArray:function(e){var t=e.length;t<16?this.o.writeByte(144|t):t<65536?(this.o.writeByte(220),this.o.writeUInt16(t)):(this.o.writeByte(221),this.o.writeInt32(t));for(var n=0;n<e.length;){var r=e[n];++n,this.encode(r)}},writeMapLength:function(e){e<16?this.o.writeByte(128|e):e<65536?(this.o.writeByte(222),this.o.writeUInt16(e)):(this.o.writeByte(223),this.o.writeInt32(e))},writeHashMap:function(e){this.writeMapLength(ae.count(e));for(var t=e.keys();t.hasNext();){var n=t.next();this.writeRaw(oe.io.Bytes.ofString(n)),this.encode(e.get(n))}},writeObjectMap:function(e){var t=H.fields(e);this.writeMapLength(ae.count(t));for(var n=0;n<t.length;){var r=t[n];++n,this.writeRaw(oe.io.Bytes.ofString(r)),this.encode(H.field(e,r))}},getBytes:function(){return this.o.getBytes()},__class__:h.Encoder},h.MsgPack=function(){},n["msgpack.MsgPack"]=h.MsgPack,h.MsgPack.__name__=["msgpack","MsgPack"],h.MsgPack.encode=function(e){return new h.Encoder(e).getBytes()},h.MsgPack.decode=function(e,t){return null==t&&(t=!0),new h.Decoder(e,t).getResult()},l.interfaces.IController=function(){},n["puremvc.interfaces.IController"]=l.interfaces.IController,l.interfaces.IController.__name__=["puremvc","interfaces","IController"],l.interfaces.IController.prototype={__class__:l.interfaces.IController},l.core={},l.core.Controller=function(){(l.core.Controller.instance=this).commandMap=new oe.ds.StringMap,this.initializeController()},n["puremvc.core.Controller"]=l.core.Controller,l.core.Controller.__name__=["puremvc","core","Controller"],l.core.Controller.__interfaces__=[l.interfaces.IController],l.core.Controller.getInstance=function(){return null==l.core.Controller.instance&&(l.core.Controller.instance=new l.core.Controller),l.core.Controller.instance},l.core.Controller.prototype={initializeController:function(){this.view=l.core.View.getInstance()},executeCommand:function(e){var t=this.commandMap.get(e.getName());null!=t&&te.createInstance(t,[]).execute(e)},registerCommand:function(e,t){this.commandMap.exists(e)||this.view.registerObserver(e,new l.patterns.observer.Observer(_(this,this.executeCommand),this)),this.commandMap.set(e,t)},hasCommand:function(e){return this.commandMap.exists(e)},removeCommand:function(e){this.hasCommand(e)&&(this.view.removeObserver(e,this),this.commandMap.remove(e))},__class__:l.core.Controller},l.interfaces.IModel=function(){},n["puremvc.interfaces.IModel"]=l.interfaces.IModel,l.interfaces.IModel.__name__=["puremvc","interfaces","IModel"],l.interfaces.IModel.prototype={__class__:l.interfaces.IModel},l.core.Model=function(){(l.core.Model.instance=this).proxyMap=new oe.ds.StringMap,this.initializeModel()},n["puremvc.core.Model"]=l.core.Model,l.core.Model.__name__=["puremvc","core","Model"],l.core.Model.__interfaces__=[l.interfaces.IModel],l.core.Model.getInstance=function(){return null==l.core.Model.instance&&(l.core.Model.instance=new l.core.Model),l.core.Model.instance},l.core.Model.prototype={initializeModel:function(){},registerProxy:function(e){this.proxyMap.set(e.getProxyName(),e),e.onRegister()},retrieveProxy:function(e){return this.proxyMap.get(e)},hasProxy:function(e){return this.proxyMap.exists(e)},removeProxy:function(e){var t=this.proxyMap.get(e);return null!=t&&(this.proxyMap.remove(e),t.onRemove()),t},__class__:l.core.Model},l.interfaces.IView=function(){},n["puremvc.interfaces.IView"]=l.interfaces.IView,l.interfaces.IView.__name__=["puremvc","interfaces","IView"],l.interfaces.IView.prototype={__class__:l.interfaces.IView},l.core.View=function(){(l.core.View.instance=this).mediatorMap=new oe.ds.StringMap,this.observerMap=new oe.ds.StringMap,this.initializeView()},n["puremvc.core.View"]=l.core.View,l.core.View.__name__=["puremvc","core","View"],l.core.View.__interfaces__=[l.interfaces.IView],l.core.View.getInstance=function(){return null==l.core.View.instance&&(l.core.View.instance=new l.core.View),l.core.View.instance},l.core.View.prototype={initializeView:function(){},registerObserver:function(e,t){this.observerMap.exists(e)||this.observerMap.set(e,new X),this.observerMap.get(e).add(t)},notifyObservers:function(e){if(this.observerMap.exists(e.getName())){for(var t=this.observerMap.get(e.getName()),n=new X,r=t.iterator();r.hasNext();){var a=r.next();n.add(a)}for(var i=n.iterator();i.hasNext();){i.next().notifyObserver(e)}}},removeObserver:function(e,t){for(var n=this.observerMap.get(e),r=n.iterator();r.hasNext();){var a=r.next();if(1==a.compareNotifyContext(t)){n.remove(a);break}}n.isEmpty()&&this.observerMap.remove(e)},registerMediator:function(e){if(!this.mediatorMap.exists(e.getMediatorName())){this.mediatorMap.set(e.getMediatorName(),e);var t=e.listNotificationInterests();if(0<t.length)for(var n=new l.patterns.observer.Observer(_(e,e.handleNotification),e),r=0,a=t.length;r<a;){var i=r++;this.registerObserver(t[i],n)}e.onRegister()}},retrieveMediator:function(e){return this.mediatorMap.get(e)},removeMediator:function(e){var t=this.mediatorMap.get(e);if(null!=t){for(var n=t.listNotificationInterests(),r=0,a=n.length;r<a;){var i=r++;this.removeObserver(n[i],t)}this.mediatorMap.remove(e),t.onRemove()}return t},hasMediator:function(e){return this.mediatorMap.exists(e)},__class__:l.core.View},l.interfaces.INotification=function(){},n["puremvc.interfaces.INotification"]=l.interfaces.INotification,l.interfaces.INotification.__name__=["puremvc","interfaces","INotification"],l.interfaces.INotification.prototype={__class__:l.interfaces.INotification},l.interfaces.IObserver=function(){},n["puremvc.interfaces.IObserver"]=l.interfaces.IObserver,l.interfaces.IObserver.__name__=["puremvc","interfaces","IObserver"],l.interfaces.IObserver.prototype={__class__:l.interfaces.IObserver},l.patterns.observer.Notification=function(e,t,n){this.name=e,null!=t&&(this.body=t),null!=n&&(this.type=n)},n["puremvc.patterns.observer.Notification"]=l.patterns.observer.Notification,l.patterns.observer.Notification.__name__=["puremvc","patterns","observer","Notification"],l.patterns.observer.Notification.__interfaces__=[l.interfaces.INotification],l.patterns.observer.Notification.prototype={getName:function(){return this.name},setBody:function(e){this.body=e},getBody:function(){return this.body},setType:function(e){this.type=e},getType:function(){return this.type},toString:function(){var e="Notification Name: "+this.getName();return e+="\nBody:"+(null==this.body?"null":this.body.toString()),e+="\nType:"+(null==this.type?"null":this.type)},__class__:l.patterns.observer.Notification},l.patterns.observer.Observer=function(e,t){this.setNotifyMethod(e),this.setNotifyContext(t)},n["puremvc.patterns.observer.Observer"]=l.patterns.observer.Observer,l.patterns.observer.Observer.__name__=["puremvc","patterns","observer","Observer"],l.patterns.observer.Observer.__interfaces__=[l.interfaces.IObserver],l.patterns.observer.Observer.prototype={setNotifyMethod:function(e){this.notify=e},setNotifyContext:function(e){this.context=e},getNotifyMethod:function(){return this.notify},getNotifyContext:function(){return this.context},notifyObserver:function(e){this.getNotifyMethod()(e)},compareNotifyContext:function(e){return e==this.context},__class__:l.patterns.observer.Observer};var p,m=0;function _(e,t){return null==t?null:(null==t.__id__&&(t.__id__=m++),null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[t.__id__],null==n&&((n=function(){return n.method.apply(n.scope,arguments)}).scope=e,n.method=t,e.hx__closures__[t.__id__]=n),n);var n}var v={},y=require("events").EventEmitter;Array.prototype.indexOf&&(Y.indexOf=function(e,t,n){return Array.prototype.indexOf.call(e,t,n)}),Math.NaN=Number.NaN,Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,n.Math=Math,Math.isFinite=function(e){return isFinite(e)},Math.isNaN=function(e){return isNaN(e)},String.prototype.__class__=n.String=String,String.__name__=["String"],n.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=n.Date=Date,Date.__name__=["Date"];var f=n.Int={__name__:["Int"]},S=n.Dynamic={__name__:["Dynamic"]},T=n.Float=Number;T.__name__=["Float"];var I=n.Bool=Boolean;I.__ename__=["Bool"];var A=n.Class={__name__:["Class"]},x={};null==Array.prototype.map&&(Array.prototype.map=function(e){for(var t=[],n=0,r=this.length;n<r;){var a=n++;t[a]=e(this[a])}return t}),null==Array.prototype.filter&&(Array.prototype.filter=function(e){for(var t=[],n=0,r=this.length;n<r;){var a=this[n++];e(a)&&t.push(a)}return t});var w,k,b,D=((w={}).exports=null,w.exports={upload:function(e){var t=e.url,n=e.headers,r=e.data,a=e.files,i=e.complete,o=new FormData;for(var s in r)r.hasOwnProperty(s)&&o.append(s,r[s]);for(var s in a)a.hasOwnProperty(s)&&o.append(s,a[s]);var l=new XMLHttpRequest;for(var s in l.open("POST",t,!0),n)n.hasOwnProperty(s)&&l.setRequestHeader(s,n[s]);return l.onload=function(e){4===l.readyState&&i(200===l.status,l)},l.onerror=function(e){i(!1,l)},l.send(o),l}},w.exports),M=window.jQuery;C.JQuery=M,ie.AppFacade.APP_STATE_CHANGED="app_state_changed",ie.AppFacade.ACCESS_TOKEN_CHANGED="access_token_changed",ie.AppFacade.CURRENT_USER_CHANGED="current_user_changed",ie.AppFacade.CONFIGURATION_CHANGED="configuration_changed",ie.AppFacade.DOMAIN_SELECTION_CHANGED="domain_selection_changed",ie.AppFacade.TALK_SELECTION_CHANGED="talk_selection_changed",ie.AppFacade.TALK_LIST_SCROLL_TO_TALK_TOP_NEEDED="talk_list_scroll_to_talk_top_needed",ie.AppFacade.USER_SELECTION_NEEDED="user_selection_needed",ie.AppFacade.USER_SELECTION_CHANGED="user_selection_changed",ie.AppFacade.FRIEND_SELECTION_NEEDED="friend_selection_needed",ie.AppFacade.STAMP_SET_CHANGED="stamp_set_changed",ie.AppFacade.STAMP_SELECTION_STARTED="stamp_selection_started",ie.AppFacade.STAMP_SELECTION_ENDED="stamp_selection_ended",ie.AppFacade.STAMP_SELECTION_CHANGED="stamp_selection_changed",ie.AppFacade.ACTION_SELECTION_CHANGED="action_selection_changed",ie.AppFacade.CURRENT_PAGE_CHANGED="current_page_changed",ie.AppFacade.CURRENT_PAGE_NOT_CHANGED="current_page_not_changed",ie.AppFacade.FILEINFO_SELECTION_CHANGED="fileinfo_selection_changed",ie.AppFacade.MESSAGE_FILEINFO_SELECTION_CHANGED="message_fileinfo_selection_changed",ie.AppFacade.STAGED_FILEINFO_SELECTION_CHANGED="staged_fileinfo_selection_changed",ie.AppFacade.STAGED_FILEINFOS_ADDED="staged_fileinfos_added",ie.AppFacade.STAGED_FILEINFOS_MOVED="staged_fileinfos_moved",ie.AppFacade.ERROR_OCCURRED="error_occurred",ie.AppFacade.UNREAD_COUNT_CHANGED="brand_badge_changed",ie.AppFacade.SEND_FORM_TOP_CHANGED="send_form_top_changed",ie.AppFacade.SOLUTIONS_LOADED="solutions_loaded",ie.AppFacade.RIGHT_PANE_OPENED="right_pane_opened",ie.AppFacade.RIGHT_PANE_CLOSED="right_pane_closed",ie.AppFacade.PASSWORD_EXPIRATION_OVERED="password_expiration_overed",ie.AppFacade.PASSWORD_EXPIRATION_WARNED="password_expiration_warned",ie.AppFacade.PHOTO_EDITOR_SAVED="photo_editor_saved",ie.AppFacade.MC_AUTHENTICATED_USER_RECEIVED="mc_authenticated_user_received",ie.AppFacade.KEYWORD_WATCHING_UPDATED="keyword_watching_updated",ie.AppFacade.KEYWORD_DETECTION_UPDATED="keyword_detaction_updated",ie.AppFacade.SEND_BY_ENTER_CHANGED="send_by_enter_changed",ie.AppFacade.DEPARTMENT_SELECTION_CHANGED_FOR_MEMBERS_PAGE="department_selection_changed_for_members_page",ie.AppFacade.PRESENCES_UPDATED="presences_updated",ie.AppFacade.DATA_RECOVERING="data_recovering",ie.AppFacade.DATA_RECOVERED="data_recovered",ie.AppFacade.NOTIFY_UPDATE_USER="notify_update_user",ie.AppFacade.NOTIFY_ADD_FRIEND="notify_add_friend",ie.AppFacade.NOTIFY_ADD_ACQUAINTANCE="notify_add_acquaintance",ie.AppFacade.NOTIFY_DELETE_FRIEND="notify_delete_friend",ie.AppFacade.NOTIFY_DELETE_ACQUAINTANCE="notify_delete_acquaintance",ie.AppFacade.NOTIFY_UPDATE_DOMAIN_USERS="notify_update_domain_users",ie.AppFacade.GET_DOMAIN_USERS_RESPONSED="get_domain_users_responsed",ie.AppFacade.GET_USERS_RESPONSED="get_users_responsed",ie.AppFacade.GET_PROFILE_RESPONSED="get_profile_responsed",ie.AppFacade.GET_PROFILE_ERRORED="get_profile_errored",ie.AppFacade.UPDATE_USER_RESPONSED="update_user_responsed",ie.AppFacade.UPDATE_USER_ERRORED="update_user_errored",ie.AppFacade.UPDATE_PROFILE_RESPONSED="update_profile_responsed",ie.AppFacade.UPDATE_PROFILE_ERRORED="update_profile_errored",ie.AppFacade.NOTIFY_UPDATE_DEPARTMENT_TREE="notify_update_department_tree",ie.AppFacade.NOTIFY_UPDATE_DEPARTMENT_USERS="notify_update_department_users",ie.AppFacade.GET_DEPARTMENT_TREE_RESPONSED="get_department_tree_responsed",ie.AppFacade.GET_DEPARTMENT_TREE_CANCELED="get_department_tree_canceled",ie.AppFacade.GET_DEPARTMENT_USERS_RESPONSED="get_department_users_responsed",ie.AppFacade.GET_DEPARTMENT_USERS_CANCELED="get_department_users_canceled",ie.AppFacade.GET_DEPARTMENT_USER_COUNT_RESPONSED="get_department_user_count_responsed",ie.AppFacade.GET_ME_RESPONSED="get_me_responsed",ie.AppFacade.DEPARTMENT_USER_COUNT_CLEARED="department_user_count_cleared",ie.AppFacade.DEPARTMENT_USER_IDS_PREPARED="department_user_ids_prepared",ie.AppFacade.NOTIFY_ADD_DOMAIN_INVITE="notify_add_domain_invite",ie.AppFacade.NOTIFY_ACCEPT_DOMAIN_INVITE="notify_accept_domain_invite",ie.AppFacade.NOTIFY_DELETE_DOMAIN_INVITE="notify_delete_domain_invite",ie.AppFacade.NOTIFY_JOIN_DOMAIN="notify_join_domain",ie.AppFacade.NOTIFY_UPDATE_DOMAIN="notify_update_domain",ie.AppFacade.NOTIFY_LEAVE_DOMAIN="notify_leave_domain",ie.AppFacade.NOTIFY_CREATE_PAIR_TALK="notify_create_pair_talk",ie.AppFacade.NOTIFY_CREATE_GROUP_TALK="notify_create_group_talk",ie.AppFacade.NOTIFY_UPDATE_GROUP_TALK="notify_update_group_talk",ie.AppFacade.NOTIFY_UPDATE_GROUP_TALK_ERRORED="notify_update_group_talk_ERRORED",ie.AppFacade.NOTIFY_ADD_TALKERS="notify_add_talkers",ie.AppFacade.NOTIFY_ADD_TALKERS_INCLUDING_ME="notify_add_talkers_including_me",ie.AppFacade.NOTIFY_DELETE_TALKER="notify_delete_talker",ie.AppFacade.NOTIFY_DELETE_TALK="notify_delete_talk",ie.AppFacade.NOTIFY_CREATE_MESSAGE="notify_create_message",ie.AppFacade.NOTIFY_DELETE_MESSAGE="notify_delete_message",ie.AppFacade.NOTIFY_UPDATE_READ_STATUSES="notify_update_read_statuses",ie.AppFacade.NOTIFY_UPDATE_TALK_STATUS="notify_update_talk_status",ie.AppFacade.NOTIFY_UPDATE_LOCAL_TALK_STATUS="notify_update_local_talk_status",ie.AppFacade.NOTIFY_GET_MESSAGES="notify_get_messages",ie.AppFacade.NOTIFY_GET_MESSAGE_READ_STATUS="notify_get_message_status",ie.AppFacade.NOTIFY_ADD_FAVORITE_TALK="notify_add_favorite_talk",ie.AppFacade.NOTIFY_DELETE_FAVORITE_TALK="notify_delete_favorite_talk",ie.AppFacade.NOTIFY_DISABLE_PUSH_NOTIFICATION="notify_disable_push_notification",ie.AppFacade.NOTIFY_ENABLE_PUSH_NOTIFICATION="notify_enable_push_notification",ie.AppFacade.CREATE_MESSAGE_START="create_message_start",ie.AppFacade.CREATE_MESSAGE_COMPLETE="create_message_complete",ie.AppFacade.CREATE_MESSAGE_FAIL="create_message_fail",ie.AppFacade.NOTIFY_CREATE_ANNOUNCEMENT="notify_create_announcement",ie.AppFacade.NOTIFY_DELETE_ANNOUNCEMENT="notify_delete_announcement",ie.AppFacade.NOTIFY_UPDATE_ANNOUNCEMENT_STATUS="notify_update_announcement_status",ie.AppFacade.NOTIFY_GET_ANNOUNCEMENTS="notify_get_announcements",ie.AppFacade.CREATE_ANNOUNCEMENT_START="create_announcement_start",ie.AppFacade.CREATE_ANNOUNCEMENT_COMPLETE="create_announcement_complete",ie.AppFacade.CREATE_ANNOUNCEMENT_FAIL="create_announcement_fail",ie.AppFacade.NOTIFY_UPDATE_QUESTION="notify_update_question",ie.AppFacade.NOTIFY_GET_QUESTIONS="get_questions_responsed",ie.AppFacade.NOTIFY_CREATE_ATTACHMENT="notify_create_attachment",ie.AppFacade.NOTIFY_DELETE_ATTACHMENT="notify_delete_attachment",ie.AppFacade.GET_FILE_RESPONSED="get_file_responsed",ie.AppFacade.NOTIFY_SEARCH_MESSAGES="notify_search_messages",ie.AppFacade.NOTIFY_SEARCH_ATTACHMENTS="notify_search_attachments",ie.AppFacade.NOTIFY_SEARCH_MESSAGES_FAIL="notify_search_messages_fail",ie.AppFacade.NOTIFY_SEARCH_ATTACHMENTS_FAIL="notify_search_attachments_fail",ie.AppFacade.NOTIFY_SEARCH_PREPARE="notify_search_prepare",ie.AppFacade.NOTIFY_SEARCH_CLEAR="notify_search_clear",ie.AppFacade.NOTIFY_FILTER_BOX_TEXT_CHANGED="notify_filter_box_text_changed",ie.AppFacade.NOTIFY_SEARCH_BOX_POPUP="notify_search_box_popup",ie.AppFacade.NOTIFY_ADD_ACCOUNT_CONTROL_REQUEST="notify_add_account_control_request",ie.AppFacade.NOTIFY_DELETE_ACCOUNT_CONTROL_REQUEST="notify_delete_account_control_request",ie.AppFacade.NOTIFY_JOIN_ACCOUNT_CONTROL_GROUP="notify_join_account_control_group",ie.AppFacade.NOTIFY_UPDATE_ACCOUNT_CONTROL_GROUP_PARTIALLY="notify_update_account_control_group_partially",ie.AppFacade.NOTIFY_LEAVE_ACCOUNT_CONTROL_GROUP="notify_leave_account_control_group",ie.UserInitialColors.COLORS=albero_tools.Constants.defaultIconColors,ie.ViewAttrs.DATA_USER_ID="data-user-id",ie.ViewAttrs.DATA_DOMAIN_ID="data-domain-id",ie.command.AccountControlRequestCommand.__meta__={fields:{api:{inject:null}}},ie.command.AccountControlRequestCommand.NAME="AccountControlRequest",ie.command.DeviceCommand.__meta__={fields:{api:{inject:null}}},ie.command.DeviceCommand.NAME="Device",ie.command.DomainCommand.__meta__={fields:{api:{inject:null}}},ie.command.DomainCommand.NAME="Domain",ie.command.FileCommand.__meta__={fields:{api:{inject:null},dataStore:{inject:null},fileService:{inject:null}}},ie.command.FileCommand.NAME="File",ie.command.LoadStampSetCommand.NAME="LoadStampSet",ie.command.LoadStampSetCommand.TAB_URL="./json/app_ja.json",ie.command.LoadStampSetCommand.TAB_PANE_URL="./json/illust_category_ja.json",ie.command.ManageFriendsCommand.__meta__={fields:{api:{inject:null}}},ie.command.ManageFriendsCommand.NAME="ManageFriends",ie.command.MessageCommand.__meta__={fields:{api:{inject:null}}},ie.command.MessageCommand.NAME="Message",ie.command.ReadCommand.__meta__={fields:{api:{inject:null},keywordWatcher:{inject:null},readStatusUpdater:{inject:null}}},ie.command.ReadCommand.NAME="Read",ie.command.ReloadDataCommand.__meta__={fields:{api:{inject:null}}},ie.command.ReloadDataCommand.NAME="ReloadData",ie.command.SearchCommand.__meta__={fields:{api:{inject:null},searchService:{inject:null}}},ie.command.SearchCommand.NAME="Search",ie.command.SelectTalkCommand.__meta__={fields:{dataStore:{inject:null},settings:{inject:null}}},ie.command.SelectTalkCommand.NAME="SelectTalk",ie.command.SendCommand.__meta__={fields:{api:{inject:null}}},ie.command.SendCommand.NAME="Send",ie.command.SignInCommand.__meta__={fields:{accessTokenResolver:{inject:null},session:{inject:null}}},ie.command.SignInCommand.NAME="SignIn",ie.command.SignOutCommand.__meta__={fields:{api:{inject:null},settings:{inject:null},dataStore:{inject:null}}},ie.command.SignOutCommand.NAME="SignOut",ie.command.TalkCommand.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},ie.command.TalkCommand.NAME="Talk",ie.command.UpdateProfileCommand.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},ie.command.UpdateProfileCommand.NAME="UpdateProfile",ie.command.UpdateUserCommand.__meta__={fields:{api:{inject:null}}},ie.command.UpdateUserCommand.NAME="UpdateUser",ie.command.UpdateUserPresencesCommand.__meta__={fields:{userPresences:{inject:null},api:{inject:null},settings:{inject:null}}},ie.command.UpdateUserPresencesCommand.NAME="UpdateUserPresences",ie.command.UpdateUserPresencesCommand.MAX_USERS_PER_API=100,ie.command.UrlCommand.__meta__={fields:{routing:{inject:null}}},ie.command.UrlCommand.NAME="Url",ie.entity.BrowserSettings.TalkAutoScrollDelay=1,ie.entity.BrowserSettings.TalkAutoScrollImmediately=2,ie.entity.BrowserSettings.TalkAutoScrollNone=3,ie.entity.BrowserSettings.NAME="browser_settings",ie.entity.Configuration.DEFAULT_PRESENCE_EXPIRATION=3e5,ie.entity.Message.MAX_READ_USER_IDS_COUNT=16,ie.entity.SearchParams.QUERY_DATE_TODAY="t",ie.entity.SearchParams.QUERY_DATE_YESTERDAY="-1d",ie.entity.SearchParams.QUERY_DATE_THREE_DAYS_BEFORE="-3d",ie.entity.UserPresence.SIXTY_MINUTES=new oe.Int64(0,36e5),ie.entity.UserPresence.FIFTEEN_MINUTES=new oe.Int64(0,9e5),ie.js.KatakanaToRoman.TU_REG=new o("([BCDFGHIJKLMNOPQRSTUVWYZ])","gm"),ie.js.KatakanaToRoman.XTU_REG=new o("","gm"),C.Node.console=console,C.Node.process=process,C.Node.require=require,C.Node.setTimeout=setTimeout,C.Node.clearTimeout=clearTimeout,C.Node.setInterval=setInterval,C.Node.clearInterval=clearInterval,C.Node.setImmediate=0<(k=Y.substr(C.Node.process.version,1,null).split(".").map(Z.parseInt))[0]||9<=k[1]?C.Node.isNodeWebkit()?global.setImmediate:setImmediate:null,C.Node.clearImmediate=0<(b=Y.substr(C.Node.process.version,1,null).split(".").map(Z.parseInt))[0]||9<=b[1]?C.Node.isNodeWebkit()?global.clearImmediate:clearImmediate:null,C.Node.global=global,C.Node.module=C.Node.isNodeWebkit()?global.module:module,C.Node.stringify=JSON.stringify,C.Node.parse=JSON.parse,se.EMERGENCY=0,se.ALERT=1,se.CRITICAL=2,se.ERROR=3,se.WARNING=4,se.NOTICE=5,se.INFO=6,se.DEBUG=7,se.level=se.getLogLevel(C.Node.process.env.HUBOT_LOG_LEVEL),se._d=7<=se.level&&null!=console?console.log.bind(console):se._nop,se._i=6<=se.level&&null!=console?console.info.bind(console):se._nop,se._w=4<=se.level&&null!=console?console.warn.bind(console):se._nop,se._e=3<=se.level&&null!=console?console.error.bind(console):se._nop,ie.js.TextCanonicalizer.HIRAGANA_SMALL_A=12353,ie.js.TextCanonicalizer.HIRAGANA_NN=12435,ie.js.TextCanonicalizer.KATAKANA_SMALL_A=12449,l.patterns.mediator.Mediator.NAME="Mediator",ie.mediator.UserModalMediator.__meta__={fields:{dataStore:{inject:null},searchService:{inject:null},departmentStore:{inject:null},userPresences:{inject:null}}},ie.mediator.UserModalMediator.NAME="user-modal",ie.mediator.UserModalMediator.CLASS_HAS_USER_DIALOG="has-user-dialog",ie.mediator.UserModalMediator.DATA_USER="user",ie.mediator.UsernameTooltipMediator.__meta__={fields:{dataStore:{inject:null}}},ie.mediator.UsernameTooltipMediator.NAME="body",ie.mediator.UsernameTooltipMediator.CLASS_HAS_USERNAME_TOOLTIP="has-username-tooltip",ie.mediator.UsernameTooltipMediator.ID_USER_TOOLTIP="username-tooltip",ie.mediator.UsernameTooltipMediator.DEBUG=!1,ie.mediator.helper.FragmentMaker.iconIdMax=0,ie.mediator.helper.MessageHelper.LARGEST_DUMMY_MESSAGE_ID=new oe.Int64(-1,-1),ie.mediator.helper.ResourceRevokerUtil.OBJECT_URL_LIFE_TIME=3e4,ie.mediator.helper.SystemMessageContentsAddTalkers.__meta__={fields:{buildText:{override:null},getOccurredBy:{override:null},isJoiningOrLeavingMessage:{override:null}}},ie.mediator.helper.SystemMessageContentsDeleteTalker.__meta__={fields:{buildText:{override:null},getOccurredBy:{override:null},isJoiningOrLeavingMessage:{override:null}}},ie.mediator.helper.SystemMessageContentsHidePairTalk.__meta__={fields:{buildText:{override:null},getOccurredBy:{override:null},isJoiningOrLeavingMessage:{override:null}}},ie.mediator.helper.SystemMessageContentsUpdateGroupTalk.__meta__={fields:{buildText:{override:null},getOccurredBy:{override:null},isJoiningOrLeavingMessage:{override:null}}},ie.mediator.helper.SystemMessageContentsUnknown.__meta__={fields:{buildText:{override:null},getOccurredBy:{override:null},isJoiningOrLeavingMessage:{override:null}}},ie.mediator.helper.UserIconBuilder.MENTION_CHOICE="mention-choice",ie.proxy.AccessTokenResolverProxyFactory.NAME="accessTokenResolver",l.patterns.proxy.Proxy.NAME="Proxy",ie.proxy.AccessTokenResolverProxyForDirectJsHubot.__meta__={fields:{settings:{inject:null},accountLoader:{inject:null},api:{inject:null}}},ie.proxy.AccountLoaderProxyFactory.NAME="accountLoader",ie.proxy.AlberoBroadcastProxy.__meta__={fields:{api:{inject:null},dataStore:{inject:null},settings:{inject:null},fileInfoStore:{inject:null},departmentStore:{inject:null},messageStore:{inject:null},dataFactory:{inject:null},keywordWatcher:{inject:null}}},ie.proxy.AlberoBroadcastProxy.NAME="broadcast",ie.proxy.AlberoServiceProxy.__meta__={fields:{rpc:{inject:null},settings:{inject:null},dataStore:{inject:null},dataFactory:{inject:null},fileService:{inject:null},searchService:{inject:null},fileInfoStore:{inject:null},departmentStore:{inject:null}}},ie.proxy.AlberoServiceProxy.NAME="api",ie.proxy.AlberoServiceProxy.API_VERSION="1.99",ie.proxy.AlberoServiceProxy.UPDATE_VERSION="1.99_1",ie.proxy.AlberoServiceProxy.ACTIONS_COUNT_PER_API=20,ie.proxy.AlberoServiceProxy.DELAY_FOR_DB_REPLICATION=1e3,ie.proxy.AlberoServiceProxy.API_TRY_COUNT=3,ie.proxy.AlberoServiceProxy.UPDATE_LAST_USED_AT_INTERVAL=6e5,ie.proxy.AppStateProxy.NAME="appState",ie.proxy.DataFactoryProxy.__meta__={fields:{dataStore:{inject:null},fileInfoStore:{inject:null},messageStore:{inject:null},solutionsStore:{inject:null}}},ie.proxy.DataFactoryProxy.NAME="dataFactory",ie.proxy.DataStoreProxy.NAME="dataStore",ie.proxy.DataStoreProxy.TYPE_FRIEND=0,ie.proxy.DataStoreProxy.TYPE_ACQUAINSTANCE=1,ie.proxy.DataStoreProxy.TYPE_NONE=2,ie.proxy.DepartmentStoreProxy.__meta__={fields:{dataStore:{inject:null}}},ie.proxy.DepartmentStoreProxy.NAME="departmentStore",ie.proxy.FeaturesProxy.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},ie.proxy.FeaturesProxy.NAME="features",ie.proxy.FileInfoStoreProxy.__meta__={fields:{fileService:{inject:null}}},ie.proxy.FileInfoStoreProxy.NAME="fileInfoStore",ie.proxy.FileServiceProxy.__meta__={fields:{settings:{inject:null}}},ie.proxy.FileServiceProxy.NAME="fileService",ie.proxy.FileServiceProxy.THUMBNAIL_WIDTH=600,ie.proxy.FileServiceProxy.THUMBNAIL_HEIGHT=600,ie.proxy.KeywordWatcherProxy.__meta__={fields:{settings:{inject:null},features:{inject:null},dataStore:{inject:null}}},ie.proxy.KeywordWatcherProxy.NAME="keywordWatcher",ie.proxy.KeywordWatcherProxy.TALK_KEY_PREFIX="talk_",ie.proxy.KeywordWatcherProxy.ANNOUNCEMENT_KEY_PREFIX="announcement_",ie.proxy.KeywordParser.TEMP_HALF_SPACE="&SPACE",ie.proxy.KeywordParser.TEMP_FULL_SPACE="&FULL_PITCH_SPACE",ie.proxy.LimitationsProxy.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},ie.proxy.LimitationsProxy.NAME="limitations",ie.proxy.MessageStoreProxy.NAME="messageStore",ie.proxy.MsgPackRpcProxy.__meta__={fields:{broadcast:{inject:null}}},ie.proxy.MsgPackRpcProxy.NAME="rpc",ie.proxy.MsgPackRpcProxy.lastMsgId=0,ie.proxy._MsgPackRpcProxy.ConnectionKeeper.PING_INTERVAL_ON_CONNECTED=45e3,ie.proxy.ReadStatusUpdaterProxy.__meta__={fields:{dataStore:{inject:null},api:{inject:null}}},ie.proxy.ReadStatusUpdaterProxy.NAME="readStatusUpdater",ie.proxy.RoutingProxy.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},ie.proxy.RoutingProxy.NAME="routing",ie.proxy.SearchServiceProxy.__meta__={fields:{settings:{inject:null}}},ie.proxy.SearchServiceProxy.NAME="searchService",ie.proxy.SearchServiceProxy.LOAD_SIZE=20,ie.proxy.SearchServiceProxy.DUMMY_VALUE_FOR_SET=1,ie.proxy.SessionProxy.__meta__={fields:{settings:{inject:null},dataStore:{inject:null},dataFactory:{inject:null},api:{inject:null}}},ie.proxy.SessionProxy.NAME="session",ie.proxy.SettingsProxy.NAME="settings",ie.proxy.SettingsProxy.KEY_ACCESS_TOKEN="access_token",ie.proxy.SettingsProxy.KEY_ACCESS_TOKEN_WITHOUT_MANAGEMENT_CONSOLE="access_token_without_management_console",ie.proxy.SettingsProxy.KEY_SELECTED_DOMAIN_ID_H="selected_domain_id_h",ie.proxy.SettingsProxy.KEY_SELECTED_DOMAIN_ID_L="selected_domain_id_l",ie.proxy.SettingsProxy.COOKIE_KEY_SEND_BY_ENTER="send-by-enter",ie.proxy.SettingsProxy.COOKIE_EXPIRES_SEND_BY_ENTER=31536e3,ie.proxy.SettingsProxy.KEY_SELECTED_STAMP_TAB_ID="selected_stamp_tab_id",ie.proxy.SettingsProxy.KEY_INPUT_TEXT="input_text",ie.proxy.SettingsProxy.KEY_COPY_PROFILE_TO_ALL_DOMAINS="copy_profile_to_all_domains",ie.proxy.SettingsProxy.KEY_SELECTED_DEPARTMENT_IDS="selected_department_ids",ie.proxy.SettingsProxy.KEY_SEARCH_HISTORIES="search_histories",ie.proxy.SettingsProxy.KEY_RIGHT_PANEL_OPENED="right_panel_opened",ie.proxy.SettingsProxy.KEY_MULTI_VIEW_MODE="multi_view_mode",ie.proxy.SettingsProxy.KEY_PASSWORD_WARNING_SKIP_UNTIL="password_warning_skip_until",ie.proxy.SettingsProxy.KEY_LAST_USED_EXPIRED_AT="last_used_expired_at",ie.proxy.SettingsProxy.KEY_IDFV="idfv",ie.proxy.SolutionsStoreProxy.NAME="solutionsStore",ie.proxy.ThumbnailExpansionProxy.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},ie.proxy.ThumbnailExpansionProxy.NAME="ThumbnailExpansion",ie.proxy.UserPresencesProxy.__meta__={fields:{dataStore:{inject:null}}},ie.proxy.UserPresencesProxy.NAME="userPresences",u.mediator.CommandLineMediator.__meta__={fields:{dataStore:{inject:null},api:{inject:null},hubotObject:{inject:null},messageEvent:{inject:null},sendQueue:{inject:null}}},u.mediator.CommandLineMediator.NAME="commandline",u.mediator.CommandLineMediator.DATA_SAVE_SPAN=5e3,u.proxy.HubotObjectProxy.__meta__={fields:{dataStore:{inject:null}}},u.proxy.HubotObjectProxy.NAME="hubotObject",u.proxy.MessageEventProxy.__meta__={fields:{dataStore:{inject:null},hubotObject:{inject:null}}},u.proxy.MessageEventProxy.NAME="messageEvent",u.proxy.Emitter.minWaitMinute=1,u.proxy.Emitter.maxWaitMinute=1440,u.proxy.SendQueueProxy.__meta__={fields:{messageEvent:{inject:null}}},u.proxy.SendQueueProxy.NAME="sendQueue",u.proxy.SendQueueProxy.MIN_SEND_SPAN_MESSAGE=550,u.proxy.SendQueueProxy.MIN_SEND_SPAN_ANNOUNCE=5050,u.proxy.SendQueueProxy.MAX_TEXT_LENGTH=1024,u.proxy.SendQueueProxy.MAX_FIELD_COUNT=9,u.proxy.SendQueueProxy.MAX_FIELD_LENGTH=64,oe.Serializer.USE_CACHE=!1,oe.Serializer.USE_ENUM_INDEX=!1,oe.Serializer.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",oe.Unserializer.DEFAULT_RESOLVER=te,oe.Unserializer.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",oe.ds.ObjectMap.count=0,oe.io.Output.LN2=Math.log(2),C.NodeC.UTF8="utf8",C.NodeC.ASCII="ascii",C.NodeC.BINARY="binary",C.NodeC.BASE64="base64",C.NodeC.HEX="hex",C.NodeC.EVENT_EVENTEMITTER_NEWLISTENER="newListener",C.NodeC.EVENT_EVENTEMITTER_ERROR="error",C.NodeC.EVENT_STREAM_DATA="data",C.NodeC.EVENT_STREAM_END="end",C.NodeC.EVENT_STREAM_ERROR="error",C.NodeC.EVENT_STREAM_CLOSE="close",C.NodeC.EVENT_STREAM_DRAIN="drain",C.NodeC.EVENT_STREAM_CONNECT="connect",C.NodeC.EVENT_STREAM_SECURE="secure",C.NodeC.EVENT_STREAM_TIMEOUT="timeout",C.NodeC.EVENT_STREAM_PIPE="pipe",C.NodeC.EVENT_PROCESS_EXIT="exit",C.NodeC.EVENT_PROCESS_UNCAUGHTEXCEPTION="uncaughtException",C.NodeC.EVENT_PROCESS_SIGINT="SIGINT",C.NodeC.EVENT_PROCESS_SIGUSR1="SIGUSR1",C.NodeC.EVENT_CHILDPROCESS_EXIT="exit",C.NodeC.EVENT_HTTPSERVER_REQUEST="request",C.NodeC.EVENT_HTTPSERVER_CONNECTION="connection",C.NodeC.EVENT_HTTPSERVER_CLOSE="close",C.NodeC.EVENT_HTTPSERVER_UPGRADE="upgrade",C.NodeC.EVENT_HTTPSERVER_CLIENTERROR="clientError",C.NodeC.EVENT_HTTPSERVERREQUEST_DATA="data",C.NodeC.EVENT_HTTPSERVERREQUEST_END="end",C.NodeC.EVENT_CLIENTREQUEST_RESPONSE="response",C.NodeC.EVENT_CLIENTRESPONSE_DATA="data",C.NodeC.EVENT_CLIENTRESPONSE_END="end",C.NodeC.EVENT_NETSERVER_CONNECTION="connection",C.NodeC.EVENT_NETSERVER_CLOSE="close",C.NodeC.FILE_READ="r",C.NodeC.FILE_READ_APPEND="r+",C.NodeC.FILE_WRITE="w",C.NodeC.FILE_WRITE_APPEND="a+",C.NodeC.FILE_READWRITE="a",C.NodeC.FILE_READWRITE_APPEND="a+",h.Encoder.FLOAT_SINGLE_MIN=1401298464324817e-60,h.Encoder.FLOAT_SINGLE_MAX=34028234663852886e22,h.Encoder.FLOAT_DOUBLE_MIN=5e-324,h.Encoder.FLOAT_DOUBLE_MAX=17976931348623157e292,r.main()}("undefined"!=typeof window?window:exports);