!function(e,t){"use strict";function s(){return Ga.__string_rec(this,"")}var n={};function i(e,t){function n(){}n.prototype=e;var i=new n;for(var r in t)i[r]=t[r];return t.toString!==Object.prototype.toString&&(i.toString=t.toString),i}var r=e.DirectAPI=function(){this.eventEmitter=new o,require("unorm")};(n.DirectAPI=r).__name__=["DirectAPI"],r.getInstance=function(){return null==r.instance&&(r.instance=new r),r.instance},r.main=function(){},r.prototype={setOptions:function(e){null!=e&&(wo.host=e.host,wo.endpoint=e.endpoint,wo.accessToken=e.access_token,wo.proxyURL=e.proxyURL,wo.account=e.account,wo.talkWithBot=e.talkWithBot,wo.acceptableEventTimeDiff=e.acceptableEventTimeDiff,wo.name=e.name,wo.storagePath=e.storage_path,wo.storageQuota=e.storage_quota,wo.wsConfig=e.ws_config),ji._d("["+tt.dateStr(new Date)+"] ","current settings",wo,"","",""),null==wo.accessToken&&ji._e("["+tt.dateStr(new Date)+"] ","Not enough parameters provided. I need a access token","","","","")},announce:function(e,t){var n,i=e.room;if(null!=i){var r,a=i.split("_");if(2<a.length)r=new zn(K.parseInt(a[1]),K.parseInt(a[2]));else r=null;if(null==r||null==t)return;var o=this.data.getTalk(r);if(null==o)return;n=o.domainId}else{var s=e.id.split("_");if(2<s.length)n=new zn(K.parseInt(s[1]),K.parseInt(s[2]));else n=null}null!=n&&this.sendQueue.sendAnnouncement(n,t)},send:function(e,t){var n,i=e.room.split("_");2<i.length?n=new zn(K.parseInt(i[1]),K.parseInt(i[2])):n=null;null!=n&&null!=t&&this.sendQueue.sendMessage(n,t)},topic:function(e,t){var n,i=e.room.split("_");2<i.length?n=new zn(K.parseInt(i[1]),K.parseInt(i[2])):n=null;this.facade.sendNotification("Talk",Ie.UPDATE(n,null,t))},download:function(e,t,n){var i,r=null,a=null;"string"==typeof t?i=t:(i=t.url,r=t.path,a=t.name),null!=i?(null==a&&(a=qa.basename(i)),null==r&&(r=qa.join(Va.tmpdir(),a)),this.facade.sendNotification("File",Z.DOWNLOAD_PATH(i,r,n))):n(null,new Error("target URL is required"))},leave:function(e,t){var n,i,r=this,a=e.room.split("_");if(2<a.length){var o=new zn(K.parseInt(a[1]),K.parseInt(a[2]));n=o}else n=null;if(null==t)i=null;else{var s=t.id.split("_");if(2<s.length){var l=new zn(K.parseInt(s[1]),K.parseInt(s[2]));i=l}else i=null}wa.delay(function(){r.facade.sendNotification("Talk",Ie.DELETE(n,null,i))},500)},userForId:function(e){return this.hubotObject.userObjectByIdStr(null,e)},userObjects:function(){return this.hubotObject.userObjects(null)},talkObjects:function(){return this.hubotObject.talkObjects()},domainObjects:function(){return this.hubotObject.domainObjects()},parseInt64:function(e){return 0<e.length&&"_"==e.charAt(0)?it.makeFromIdStr(e):it.parse(e)},stringifyInt64:function(e,t){return null==t&&(t=!1),t?"_"+e.high+"_"+e.low:va.toString(e)},listen:function(){this.facade=p.getInstance(),this.api=Ga.__cast(this.facade.retrieveProxy("api"),or),this.data=Ga.__cast(this.facade.retrieveProxy("dataStore"),hr),this.hubotObject=Ga.__cast(this.facade.retrieveProxy("hubotObject"),oa),this.sendQueue=Ga.__cast(this.facade.retrieveProxy("sendQueue"),ua);var e=Ga.__cast(this.facade.retrieveProxy("fileService"),pr),t=Ga.__cast(this.facade.retrieveProxy("fileInfoStore"),mr);this.notes=new Wr(new Vr(this,this.api,t,e)),this.facade.startup()},emit:function(e,t,n,i){this.eventEmitter.emit(e,t,n,i)},on:function(e,t){return this.eventEmitter.on(e,t)},getDomainInvites:function(e){this.api._getDomainInvites(e)},acceptDomainInvite:function(e){this.api.acceptDomainInvite(e)},__class__:r};function y(e,t){this.r=new RegExp(e,t.split("u").join(""))}(n.EReg=y).__name__=["EReg"],y.prototype={match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&0<=e&&e<this.r.m.length)return this.r.m[e];throw new za("EReg::matched")},matchedPos:function(){if(null==this.r.m)throw new za("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(e,t,n){if(null==n&&(n=-1),this.r.global){this.r.lastIndex=t;var i=this.r,r=n<0?e:tt.substr(e,0,t+n);this.r.m=i.exec(r);var a=null!=this.r.m;return a&&(this.r.s=e),a}var o=this.match(n<0?tt.substr(e,t,null):tt.substr(e,t,n));return o&&(this.r.s=e,this.r.m.index+=t),o},split:function(e){var t="#__delim__#";return e.replace(this.r,t).split(t)},map:function(e,t){for(var n=0,i="";!(n>=e.length);){if(!this.matchSub(e,n)){i+=K.string(tt.substr(e,n,null));break}var r=this.matchedPos();if(i+=K.string(tt.substr(e,n,r.pos-n)),i+=K.string(t(this)),n=0==r.len?(i+=K.string(tt.substr(e,r.pos,1)),r.pos+1):r.pos+r.len,!this.r.global)break}return!this.r.global&&0<n&&n<e.length&&(i+=K.string(tt.substr(e,n,null))),i},__class__:y};var a=require("events").EventEmitter,o=function(){a.call(this)};(n.EventEmitter=o).__name__=["EventEmitter"],o.__super__=a,o.prototype=i(a.prototype,{__class__:o});var tt=function(){};(n.HxOverrides=tt).__name__=["HxOverrides"],tt.dateStr=function(e){var t=e.getMonth()+1,n=e.getDate(),i=e.getHours(),r=e.getMinutes(),a=e.getSeconds();return e.getFullYear()+"-"+(t<10?"0"+t:""+t)+"-"+(n<10?"0"+n:""+n)+" "+(i<10?"0"+i:""+i)+":"+(r<10?"0"+r:""+r)+":"+(a<10?"0"+a:""+a)},tt.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),n=new Date;return n.setTime(0),n.setUTCHours(t[0]),n.setUTCMinutes(t[1]),n.setUTCSeconds(t[2]),n;case 10:var i=e.split("-");return new Date(i[0],i[1]-1,i[2],0,0,0);case 19:var r=e.split(" "),a=r[0].split("-"),o=r[1].split(":");return new Date(a[0],a[1]-1,a[2],o[0],o[1],o[2]);default:throw new za("Invalid date format : "+e)}},tt.cca=function(e,t){var n=e.charCodeAt(t);if(n==n)return n},tt.substr=function(e,t,n){if(null==n)n=e.length;else if(n<0){if(0!=t)return"";n=e.length+n}return e.substr(t,n)},tt.remove=function(e,t){var n=e.indexOf(t);return-1!=n&&(e.splice(n,1),!0)},tt.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};function nt(){}(n.Lambda=nt).__name__=["Lambda"],nt.array=function(e){for(var t=[],n=co(e)();n.hasNext();){var i=n.next();t.push(i)}return t},nt.map=function(e,t){for(var n=new $,i=co(e)();i.hasNext();){var r=i.next();n.add(t(r))}return n},nt.mapi=function(e,t){for(var n=new $,i=0,r=co(e)();r.hasNext();){var a=r.next();n.add(t(i++,a))}return n},nt.exists=function(e,t){for(var n=co(e)();n.hasNext();){if(t(n.next()))return!0}return!1},nt.foreach=function(e,t){for(var n=co(e)();n.hasNext();){if(!t(n.next()))return!1}return!0},nt.iter=function(e,t){for(var n=co(e)();n.hasNext();){t(n.next())}},nt.filter=function(e,t){for(var n=new $,i=co(e)();i.hasNext();){var r=i.next();t(r)&&n.add(r)}return n},nt.fold=function(e,t,n){for(var i=co(e)();i.hasNext();){n=t(i.next(),n)}return n},nt.count=function(e,t){var n=0;if(null==t)for(var i=co(e)();i.hasNext();){i.next();++n}else for(var r=co(e)();r.hasNext();){t(r.next())&&++n}return n},nt.find=function(e,t){for(var n=co(e)();n.hasNext();){var i=n.next();if(t(i))return i}return null};var $=function(){this.length=0};(n.List=$).__name__=["List"],$.prototype={add:function(e){var t=new l(e,null);null==this.h?this.h=t:this.q.next=t,this.q=t,this.length++},isEmpty:function(){return null==this.h},remove:function(e){for(var t=null,n=this.h;null!=n;){if(n.item==e)return null==t?this.h=n.next:t.next=n.next,this.q==n&&(this.q=t),this.length--,!0;n=(t=n).next}return!1},iterator:function(){return new c(this.h)},map:function(e){for(var t=new $,n=this.h;null!=n;){var i=n.item;n=n.next,t.add(e(i))}return t},__class__:$};var l=function(e,t){this.item=e,this.next=t};(n["_List.ListNode"]=l).__name__=["_List","ListNode"],l.prototype={__class__:l};var c=function(e){this.head=e};(n["_List.ListIterator"]=c).__name__=["_List","ListIterator"],c.prototype={hasNext:function(){return null!=this.head},next:function(){var e=this.head.item;return this.head=this.head.next,e},__class__:c},Math.__name__=["Math"];function u(){}(n.ObjectHelper=u).__name__=["ObjectHelper"],u.deepCopy=function(e){return null==e?null:JSON.parse(JSON.stringify(e))};function _(e,t){this.basetime=0,this.count=0,this.max=e,this.interval=t}(n.RateLimit=_).__name__=["RateLimit"],_.prototype={_now:function(){return(new Date).getTime()},calculateRetryAfter:function(e){var t;return t=0<this.basetime?this.interval-(e-this.basetime):this.interval,Math.ceil(t/1e3)},createError:function(e){var t=this.max+" calls every "+Math.floor(this.interval/1e3)+" sec";return _a.createTooManyRequestsError(t,this.calculateRetryAfter(e))},apply:function(i){var r=this;return new Promise(function(e,t){var n=r._now();if(0<r.max&&n-r.basetime>r.interval)r.basetime=n,r.count=1;else{if(!(0<r.max&&r.count<r.max))return void t(r.createError(n));r.count++}i().then(e,t)})},__class__:_};function z(){}(n.Reflect=z).__name__=["Reflect"],z.field=function(e,t){try{return e[t]}catch(e){return null}},z.fields=function(e){var t=[];if(null!=e){var n=Object.prototype.hasOwnProperty;for(var i in e)"__id__"!=i&&"hx__closures__"!=i&&n.call(e,i)&&t.push(i)}return t},z.isFunction=function(e){return"function"==typeof e&&!(e.__name__||e.__ename__)},z.compare=function(e,t){return e==t?0:t<e?1:-1},z.isObject=function(e){if(null==e)return!1;var t=typeof e;return"string"==t||"object"==t&&null==e.__enum__||"function"==t&&null!=(e.__name__||e.__ename__)},z.isEnumValue=function(e){return null!=e&&null!=e.__enum__},z.deleteField=function(e,t){return!!Object.prototype.hasOwnProperty.call(e,t)&&(delete e[t],!0)};var K=function(){};(n.Std=K).__name__=["Std"],K.string=function(e){return Ga.__string_rec(e,"")},K.parseInt=function(e){var t=parseInt(e,10);return 0!=t||120!=tt.cca(e,1)&&88!=tt.cca(e,1)||(t=parseInt(e)),isNaN(t)?null:t};function I(){this.b=""}(n.StringBuf=I).__name__=["StringBuf"],I.prototype={toString:function(){return this.b},__class__:I};function W(){}(n.StringTools=W).__name__=["StringTools"],W.htmlEscape=function(e,t){return e=e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;"),t?e.split('"').join("&quot;").split("'").join("&#039;"):e},W.startsWith=function(e,t){return e.length>=t.length&&tt.substr(e,0,t.length)==t},W.isSpace=function(e,t){var n=tt.cca(e,t);return 8<n&&n<14||32==n},W.ltrim=function(e){for(var t=e.length,n=0;n<t&&W.isSpace(e,n);)++n;return 0<n?tt.substr(e,n,t-n):e},W.rtrim=function(e){for(var t=e.length,n=0;n<t&&W.isSpace(e,t-n-1);)++n;return 0<n?tt.substr(e,0,t-n):e},W.trim=function(e){return W.ltrim(W.rtrim(e))},W.replace=function(e,t,n){return e.split(t).join(n)},W.hex=function(e,t){for(var n="";n="0123456789ABCDEF".charAt(15&e)+n,0<(e>>>=4););if(null!=t)for(;n.length<t;)n="0"+n;return n};function h(){}(n.TextHelper=h).__name__=["TextHelper"],h.slice=function(e,n){for(var i=[],t=function(e){for(;e.length>n;){var t=tt.substr(e,0,n);i.push(t),e=tt.substr(e,n,null)}0<e.length&&i.push(e)},r="",a=e.split("\n");0<a.length;){var o=a.shift();r.length+o.length>n&&(t(r),r=""),0<r.length&&(r+="\n"),r+=o}return t(r),i};var d=n.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};d.TNull=["TNull",0],d.TNull.toString=s,(d.TNull.__enum__=d).TInt=["TInt",1],d.TInt.toString=s,(d.TInt.__enum__=d).TFloat=["TFloat",2],d.TFloat.toString=s,(d.TFloat.__enum__=d).TBool=["TBool",3],d.TBool.toString=s,(d.TBool.__enum__=d).TObject=["TObject",4],d.TObject.toString=s,(d.TObject.__enum__=d).TFunction=["TFunction",5],d.TFunction.toString=s,(d.TFunction.__enum__=d).TClass=function(e){var t=["TClass",6,e];return t.__enum__=d,t.toString=s,t},d.TEnum=function(e){var t=["TEnum",7,e];return t.__enum__=d,t.toString=s,t},d.TUnknown=["TUnknown",8],d.TUnknown.toString=s,(d.TUnknown.__enum__=d).__empty_constructs__=[d.TNull,d.TInt,d.TFloat,d.TBool,d.TObject,d.TFunction,d.TUnknown];function ee(){}(n.Type=ee).__name__=["Type"],ee.getClassName=function(e){var t=e.__name__;return null==t?null:t.join(".")},ee.getEnumName=function(e){return e.__ename__.join(".")},ee.resolveClass=function(e){var t=n[e];return null!=t&&t.__name__?t:null},ee.resolveEnum=function(e){var t=n[e];return null!=t&&t.__ename__?t:null},ee.createInstance=function(e,t){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);case 9:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]);case 10:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);case 11:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10]);case 12:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11]);case 13:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12]);case 14:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13]);default:throw new za("Too many arguments")}},ee.createEmptyInstance=function(e){function t(){}return t.prototype=e.prototype,new t},ee.createEnum=function(e,t,n){var i=z.field(e,t);if(null==i)throw new za("No such constructor "+t);if(z.isFunction(i)){if(null==n)throw new za("Constructor "+t+" need parameters");return i.apply(e,n)}if(null!=n&&0!=n.length)throw new za("Constructor "+t+" does not need parameters");return i},ee.typeof=function(e){switch(typeof e){case"boolean":return d.TBool;case"function":return e.__name__||e.__ename__?d.TObject:d.TFunction;case"number":return Math.ceil(e)==e%2147483648?d.TInt:d.TFloat;case"object":if(null==e)return d.TNull;var t=e.__enum__;if(null!=t)return d.TEnum(t);var n=Ga.getClass(e);return null!=n?d.TClass(n):d.TObject;case"string":return d.TClass(String);case"undefined":return d.TNull;default:return d.TUnknown}},ee.enumEq=function(e,t){if(e==t)return!0;try{if(e[0]!=t[0])return!1;for(var n=2,i=e.length;n<i;){var r=n++;if(!ee.enumEq(e[r],t[r]))return!1}var a=e.__enum__;if(a!=t.__enum__||null==a)return!1}catch(e){return!1}return!0};function f(){}(n["puremvc.interfaces.IFacade"]=f).__name__=["puremvc","interfaces","IFacade"],f.prototype={__class__:f};var m=function(){(m.instance=this).initializeFacade()};(n["puremvc.patterns.facade.Facade"]=m).__name__=["puremvc","patterns","facade","Facade"],m.__interfaces__=[f],m.getInstance=function(){return null==m.instance&&(m.instance=new m),m.instance},m.prototype={initializeFacade:function(){this.initializeModel(),this.initializeController(),this.initializeView()},initializeController:function(){null==this.controller&&(this.controller=to.getInstance())},initializeModel:function(){null==this.model&&(this.model=io.getInstance())},initializeView:function(){null==this.view&&(this.view=ao.getInstance())},registerCommand:function(e,t){this.controller.registerCommand(e,t)},removeCommand:function(e){this.controller.removeCommand(e)},hasCommand:function(e){return this.controller.hasCommand(e)},registerProxy:function(e){this.model.registerProxy(e)},retrieveProxy:function(e){return this.model.retrieveProxy(e)},removeProxy:function(e){var t=null;return null!=this.model&&(t=this.model.removeProxy(e)),t},hasProxy:function(e){return this.model.hasProxy(e)},registerMediator:function(e){null!=this.view&&this.view.registerMediator(e)},retrieveMediator:function(e){return this.view.retrieveMediator(e)},removeMediator:function(e){var t=null;return null!=this.view&&(t=this.view.removeMediator(e)),t},hasMediator:function(e){return this.view.hasMediator(e)},sendNotification:function(e,t,n){this.notifyObservers(new lo(e,t,n))},notifyObservers:function(e){null!=this.view&&this.view.notifyObservers(e)},__class__:m};var p=function(){m.call(this)};(n["albero.AppFacade"]=p).__name__=["albero","AppFacade"],p.getInstance=function(){return null==m.instance&&(m.instance=new p),Ga.__cast(m.instance,p)},p.__super__=m,p.prototype=i(m.prototype,{initializeModel:function(){m.prototype.initializeModel.call(this);var e=[];(e=(e=e.concat([new oa,new ua,new sa])).concat([new br,new ur,new hr,new _r,new dr,new Lr,new ar,new or,new sr,new lr,gr.newInstance(),new Rr,new mr,new Ur,new Br,new yr,new fr,new Ar,new Yr,new Pr,new Mr,new Nr,new zr,new cr,new jr,new Er,new Hr,$i.newInstance()])).push(ir.newInstance());for(var t=0;t<e.length;){var n=e[t];++t,this.registerProxy(n)}for(var i=0;i<e.length;){var r=e[i];++i,this.autoBind(r)}},initializeView:function(){m.prototype.initializeView.call(this);for(var e=0,t=this.getMediators();e<t.length;){var n=t[e];++e,this.registerMediator(n)}},getMediators:function(){return[new aa]},initializeController:function(){m.prototype.initializeController.call(this);for(var e=[Q,ye,Se,he,ve,we,re,ce,te,X,pe,Ee,Te,Ne,Ae,fe,B,oe,G,j,le],t=0;t<e.length;){var n=e[t];++t;var i=W.replace(ee.getClassName(n).split(".").pop(),"Command","");this.registerCommand(i,n)}},registerMediator:function(e){this.autoBind(e),m.prototype.registerMediator.call(this,e)},autoBind:function(e){for(var t=e,n=Ya.getFields(null==t?null:Ga.getClass(t)),i=0,r=z.fields(n);i<r.length;){var a=r[i];++i;var o=z.field(n,a);if(Object.prototype.hasOwnProperty.call(o,"inject")){var s=this.retrieveProxy(a);null!=s&&(e[a]=s)}}},startup:function(){Ga.__cast(this.retrieveProxy("appState"),ur).start()},__class__:p});var g=n["albero.AppState"]={__ename__:["albero","AppState"],__constructs__:["Active","Inactive"]};g.Active=["Active",0],g.Active.toString=s,(g.Active.__enum__=g).Inactive=["Inactive",1],g.Inactive.toString=s,(g.Inactive.__enum__=g).__empty_constructs__=[g.Active,g.Inactive];var v=n["albero.ConnectionStatus"]={__ename__:["albero","ConnectionStatus"],__constructs__:["Ok","Error","ConcurrentAccessError","ForcibliyClosedError"]};v.Ok=["Ok",0],v.Ok.toString=s,(v.Ok.__enum__=v).Error=["Error",1],v.Error.toString=s,(v.Error.__enum__=v).ConcurrentAccessError=["ConcurrentAccessError",2],v.ConcurrentAccessError.toString=s,(v.ConcurrentAccessError.__enum__=v).ForcibliyClosedError=["ForcibliyClosedError",3],v.ForcibliyClosedError.toString=s,(v.ForcibliyClosedError.__enum__=v).__empty_constructs__=[v.Ok,v.Error,v.ConcurrentAccessError,v.ForcibliyClosedError];function S(){}(n["albero.ContentTypeResolver"]=S).__name__=["albero","ContentTypeResolver"],S.prototype={__class__:S};function w(){}(n["albero.DefaultContentTypeResolver"]=w).__name__=["albero","DefaultContentTypeResolver"],w.__interfaces__=[S],w.getContentTypeByFileName=function(e,t){if(k.isNotEmpty(t))return"csv"==w.getExtension(e)?"text/csv":t;switch(w.getExtension(e)){case"csv":return"text/csv";case"doc":return"application/msword";case"docm":return"application/vnd.ms-word.document.macroenabled.12";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case"gif":return"image/gif";case"htm":case"html":return"text/html";case"jpeg":case"jpg":return"image/jpeg";case"md":return"text/markdown";case"pdf":return"application/pdf";case"png":return"image/png";case"ppt":return"application/vnd.ms-powerpoint";case"pptm":return"application/vnd.ms-powerpoint.presentation.macroenabled.12";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation";case"svg":return"image/svg+xml";case"txt":return"text/plain";case"webp":return"image/webp";case"xls":return"application/vnd.ms-excel";case"xlsb":return"application/vnd.ms-excel.sheet.binary.macroenabled.12";case"xlsm":return"application/vnd.ms-excel.sheet.macroenabled.12";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"xml":return"text/xml";default:return"application/octet-stream"}},w.getExtension=function(e){if(null==e)return"";var t=e.split("."),n=t.length;return 0==n?"":t[n-1]},w.prototype={resolve:function(e){return w.getContentTypeByFileName(e.name,e.type)},__class__:w};function T(){}(n["albero.DateTimeHelper"]=T).__name__=["albero","DateTimeHelper"],T.isSameDate=function(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()},T.dateString=function(e,t){var n=new Date,i="";return e.getFullYear()!=n.getFullYear()&&(i+=e.getFullYear()+"/"),i+=e.getMonth()+1+"/"+e.getDate(),t&&(i+=" ("+T.dayOfWeekString(e)+")"),i},T.dayOfWeekString=function(e){switch(e.getDay()){case 0:return Hi.localize("DateTimeHelper.sun");case 1:return Hi.localize("DateTimeHelper.mon");case 2:return Hi.localize("DateTimeHelper.tue");case 3:return Hi.localize("DateTimeHelper.wed");case 4:return Hi.localize("DateTimeHelper.thu");case 5:return Hi.localize("DateTimeHelper.fri");default:return Hi.localize("DateTimeHelper.sat")}},T.getDateStringForFile=function(){var e=new Date;return e.getFullYear()+T.toDoubleDigits(e.getMonth()+1)+T.toDoubleDigits(e.getDate())+"_"+T.toDoubleDigits(e.getHours())+T.toDoubleDigits(e.getMinutes())+T.toDoubleDigits(e.getSeconds())},T.getTimeStringForVoice=function(e){return T.toDoubleDigits(e/60|0)+":"+T.toDoubleDigits((0|e)%60)},T.toDoubleDigits=function(e){var t=null==e?"null":""+e;return 1==t.length&&(t="0"+t),t},T.nowAsInt64=function(){return T.dateAsInt64((new Date).getTime())},T.oneDayAfterAsInt64=function(){return T.dateAsInt64((new Date).getTime()+864e5)},T.afterAsInt64=function(e){return T.dateAsInt64((new Date).getTime()+e)},T.dateAsInt64=function(e){var t=4294967296;return new zn(e/t|0,e%t|0)},T.abbreviateDatetimeString=function(e){if(null==e)return"";var t=new Date,n=4294967296,i=e.high,r=e.low,a=new Date(i*n+(0<=r?r:r+n));return t.getFullYear()==a.getFullYear()&&t.getMonth()==a.getMonth()&&t.getDate()==a.getDate()?a.getHours()+":"+(a.getMinutes()<10?"0":"")+a.getMinutes():T.dateString(a,!1)},T.datetimeStringIn11Chars=function(e){if(null==e)return"";var t=new Date,n=4294967296,i=e.high,r=e.low,a=new Date(i*n+(0<=r?r:r+n)),o=T.dateString(a,!1);return t.getFullYear()==a.getFullYear()&&(o+=" "+a.getHours()+":"+(a.getMinutes()<10?"0":"")+a.getMinutes()),o},T.timeString=function(e){if(null==e)return"";var t=4294967296,n=e.high,i=e.low,r=new Date(n*t+(0<=i?i:i+t));return r.getHours()+":"+(r.getMinutes()<10?"0":"")+r.getMinutes()},T.datetimeString=function(e){if(null==e)return"";var t=parseFloat(va.toString(e)),n=new Date(t);return n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate()+" "+n.getHours()+":"+(n.getMinutes()<10?"0":"")+n.getMinutes()};function E(){}(n["albero.FileDynamicHelper"]=E).__name__=["albero","FileDynamicHelper"],E.filterDeleted=function(e){return null==e?[]:e.filter(E.isNotDeleted)},E.isNotDeleted=function(e){return null==e.deleted||!e.deleted},E.createFileInfoDynamic=function(e,t,n,i){var r={url:i.get_url,content_type:e.type,content_size:e.size,name:t,file_id:i.file_id};return at.foreach(n,function(e){null!=e.auth&&(r.thumbnail_url=e.auth.get_url),null!=e.dimension&&(r.thumbnail_dimension=e.dimension.toObject())}),r};function N(){}(n["albero.FileHelper"]=N).__name__=["albero","FileHelper"],N.createByteSizeStringWithUnit=function(e){if(null==e)return"0 B";for(var t,n=["","K","M","G","T"];;){var i=new zn(0,1024),r=t=va.divMod(e,i).quotient,a=new zn(0,0),o=r.high-a.high|0;if(o=0!=o?o:ga.ucompare(r.low,a.low),!(0<(r.high<0?a.high<0?o:-1:0<=a.high?o:1)))break;e=t,n.shift()}return va.toString(e)+" "+n.shift()+"B"},N.extractFilenameExceptExtension=function(e){return new y("\\.(?=[^.]+$)","").split(e)[0]};function A(){}(n["albero.History"]=A).__name__=["albero","History"],A.replaceState=function(e,t,n){return null!=window.history&&(window.history.replaceState(e,t,n),!0)};var it=function(){};(n["albero.Int64Helper"]=it).__name__=["albero","Int64Helper"],it.parse=function(e){if(!new y("^\\d+$","").match(e))return null;for(var t=new zn(0,0),n=new zn(0,10),i=0,r=e.length;i<r;){var a=i++,o=65535&t.low,s=t.low>>>16,l=65535&n.low,u=n.low>>>16,c=ga._mul(o,l),_=ga._mul(s,l),h=ga._mul(o,u),d=c,f=(ga._mul(s,u)+(h>>>16)|0)+(_>>>16)|0;if(d=d+(h<<=16)|0,ga.ucompare(d,h)<0){f++;f|=0}if(d=d+(_<<=16)|0,ga.ucompare(d,_)<0){f++;f|=0}f=f+(ga._mul(t.low,n.high)+ga._mul(t.high,n.low)|0)|0;var m=new zn(f,d),p=new zn(0,K.parseInt(e.charAt(a))),g=m.high+p.high|0,v=m.low+p.low|0;if(ga.ucompare(v,m.low)<0){g++;g|=0}t=new zn(g,v)}return t},it.getHigh=function(e){return e.high},it.getLow=function(e){return e.low},it.idStr=function(e){return"_"+e.high+"_"+e.low},it.makeFromIdStr=function(e){var t=new y("^_(-?\\d*)_(-?\\d*)$","");return t.match(e)?new zn(K.parseInt(t.matched(1)),K.parseInt(t.matched(2))):null},it.toStr=function(e){return va.toString(e)},it.isNeg=function(e){return e.high<0},it.add=function(e,t){var n=e.high+t.high|0,i=e.low+t.low|0;if(ga.ucompare(i,e.low)<0){n++;n|=0}return new zn(n,i)},it.sub=function(e,t){var n=e.high-t.high|0,i=e.low-t.low|0;if(ga.ucompare(e.low,t.low)<0){n--;n|=0}return new zn(n,i)},it.compare=function(e,t){var n=e.high-t.high|0;return n=0!=n?n:ga.ucompare(e.low,t.low),e.high<0?t.high<0?n:-1:0<=t.high?n:1},it.eq=function(e,t){return null!=e&&null!=t&&e.high==t.high&&e.low==t.low},it.eqOrBothNull=function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.high==t.high&&e.low==t.low},it.toFloat=function(e){var t=4294967296,n=e.high,i=e.low;return n*t+(0<=i?i:i+t)},it.idStrToInt64=function(e){var t=e.split("_");return 2<t.length?new zn(K.parseInt(t[1]),K.parseInt(t[2])):null},it.decrement=function(e){if(null==e)return null;var t=new zn(0,1),n=e.high-t.high|0,i=e.low-t.low|0;if(ga.ucompare(e.low,t.low)<0){n--;n|=0}return new zn(n,i)},it.increment=function(e){if(null==e)return null;var t=new zn(0,1),n=e.high+t.high|0,i=e.low+t.low|0;if(ga.ucompare(i,e.low)<0){n++;n|=0}return new zn(n,i)},it.unique=function(e){if(null==e)return[];for(var t=[],n=0,i=e.length;n<i;){var r=n++,a=e[r];it.indexOf(e,a)==r&&t.push(a)}return t},it.indexOf=function(e,t){if(null==e)return-1;for(var n=0,i=e.length;n<i;){var r=n++,a=e[r];if(null!=a&&null!=t&&a.high==t.high&&a.low==t.low)return r}return-1},it.contains=function(e,t){if(null==e)return!1;for(var n=0;n<e.length;){var i=e[n];if(++n,null!=i&&null!=t&&i.high==t.high&&i.low==t.low)return!0}return!1},it.notContains=function(e,t){return!it.contains(e,t)},it.remove=function(e,t){if(null==e)return!1;for(var n=0;n<e.length;){var i=e[n];if(++n,null!=i&&null!=t&&i.high==t.high&&i.low==t.low)return tt.remove(e,i),!0}return!1},it.fromIntOrInt64=function(e){if(null==e||Ga.__instanceof(e,zn))return e;var t=Ga.__cast(e,mo);return new zn(t>>31,t)},it.eqArray=function(e,t){if(e!=t){if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var n=0,i=e.length;n<i;){var r=n++,a=e[r],o=t[r];if(null==a||null==o||a.high!=o.high||a.low!=o.low)return!1}}return!0},it.splitUsingMaxCount=function(e,t){for(var n=[],i=0;i<e.length;){var r=i+t,a=e.slice(i,r);n.push(a),i=r}return n};function b(){}(n["albero.LambdaHelper"]=b).__name__=["albero","LambdaHelper"],b.flatten=function(e){return nt.filter(e,function(e){return at.isDefined(e)}).map(function(e){return at.get(e)})},b.headOption=function(e){for(var t=co(e)();t.hasNext();){var n=t.next();return Ca.Some(n)}return Ca.None},b.lastOption=function(e){for(var t=Ca.None,n=co(e)();n.hasNext();){var i=n.next();t=Ca.Some(i)}return t},b.findOption=function(e,t){return at.option(nt.find(e,t))},b.indexWhere=function(e,t){for(var n=0,i=co(e)();i.hasNext();){if(t(i.next()))return n;++n}return-1},b.forall=function(e,t){return!nt.exists(e,function(e){return!t(e)})};function rt(){}(n["albero.ArrayHelper"]=rt).__name__=["albero","ArrayHelper"],rt.lastOption=function(e){return 0==e.length?Ca.None:Ca.Some(e[e.length-1])},rt.sortAndReturn=function(e,t){return e.sort(t),e},rt.reverseAndReturn=function(e){return e.reverse(),e},rt.asArray=function(e){return Ga.__cast(e,Array)};var at=function(){};(n["albero.OptionHelper"]=at).__name__=["albero","OptionHelper"],at.map=function(e,t){switch(e[1]){case 0:var n=e[2];return Ca.Some(t(n));case 1:return Ca.None}},at.flatMap=function(e,t){switch(e[1]){case 0:return t(e[2]);case 1:return Ca.None}},at.foreach=function(e,t){switch(e[1]){case 0:t(e[2])}},at.filter=function(e,t){switch(e[1]){case 0:return t(e[2])?e:Ca.None;case 1:return Ca.None}},at.exists=function(e,t){return at.isDefined(at.filter(e,t))},at.isDefined=function(e){switch(e[1]){case 0:return!0;case 1:return!1}},at.isEmpty=function(e){switch(e[1]){case 0:return!1;case 1:return!0}},at.get=function(e){switch(e[1]){case 0:return e[2];case 1:throw new za("None.get called")}},at.orNull=function(e){switch(e[1]){case 0:return e[2];case 1:return null}},at.flatten=function(e){return at.flatMap(e,function(e){return e})},at.eq=function(e,t){return ee.enumEq(e,t)},at.option=function(e){return null!=e?Ca.Some(e):Ca.None};function D(){}(n["albero.StorageHelper"]=D).__name__=["albero","StorageHelper"],D.getItemAsJson=function(e){var t=D.getItem(e);if(null==t)return null;try{return JSON.parse(t)}catch(e){return null}},D.getItemAsInt=function(e){var t=D.getItem(e);return null==t?null:K.parseInt(t)},D.getItem=function(e){var t=Bi.getLocalStorage();if(null==t)ji._e("["+tt.dateStr(new Date)+"] ","storage not found","","","","");else try{return t.getItem(e)}catch(e){e instanceof za&&(e=e.val),ji._e("["+tt.dateStr(new Date)+"] ","storage error occered.",e,"","","")}return null},D.removeItem=function(e){var t=Bi.getLocalStorage();if(null==t)ji._e("["+tt.dateStr(new Date)+"] ","storage not found","","","","");else try{return t.removeItem(e),!0}catch(e){e instanceof za&&(e=e.val),ji._e("["+tt.dateStr(new Date)+"] ","storage error occered.",e,"","","")}return!1},D.setItem=function(e,t){var n=Bi.getLocalStorage();if(null==n)ji._e("["+tt.dateStr(new Date)+"] ","storage not found","","","","");else try{return n.setItem(e,t),!0}catch(e){e instanceof za&&(e=e.val),ji._e("["+tt.dateStr(new Date)+"] ","storage error occered.",e,"","","")}return!1},D.getItemWithUnserialize=function(e){var t=D.getItem(e);if(null!=t)try{return Ta.run(t)}catch(e){e instanceof za&&(e=e.val),ji._w("["+tt.dateStr(new Date)+"] ",e,"","","","")}return null},D.setItemWithSerialize=function(e,t){D.setItem(e,Sa.run(t))};var k=function(){};(n["albero.StringHelper"]=k).__name__=["albero","StringHelper"],k.trim=function(e){return e.trim()},k.compare=function(e,t){return t<e?1:e<t?-1:0},k.isEmpty=function(e){return null==e||0==e.length},k.isNotEmpty=function(e){return!k.isEmpty(e)},k.randomString=function(){var e="",t=8;for(e+=K.string(W.hex(0|(new Date).getTime(),8));t++<36;)e+=K.string(0!=(51*t&52)?W.hex(0!=(15^t)?8^(Math.random()*(0!=(20^t)?16:4)|0):4):"-");return e.toLowerCase()};var V=n["albero.Urls"]={__ename__:["albero","Urls"],__constructs__:["auto","domains","domain","members","talks","actions","bookmarks","settings","announcements","error","loading","environment","unknown"]};V.auto=["auto",0],V.auto.toString=s,(V.auto.__enum__=V).domains=["domains",1],V.domains.toString=s,(V.domains.__enum__=V).domain=function(e){var t=["domain",2,e];return t.__enum__=V,t.toString=s,t},V.members=function(e){var t=["members",3,e];return t.__enum__=V,t.toString=s,t},V.talks=function(e,t){var n=["talks",4,e,t];return n.__enum__=V,n.toString=s,n},V.actions=function(e){var t=["actions",5,e];return t.__enum__=V,t.toString=s,t},V.bookmarks=function(e){var t=["bookmarks",6,e];return t.__enum__=V,t.toString=s,t},V.settings=function(e){var t=["settings",7,e];return t.__enum__=V,t.toString=s,t},V.announcements=["announcements",8],V.announcements.toString=s,(V.announcements.__enum__=V).error=["error",9],V.error.toString=s,(V.error.__enum__=V).loading=["loading",10],V.loading.toString=s,(V.loading.__enum__=V).environment=function(e){var t=["environment",11,e];return t.__enum__=V,t.toString=s,t},V.unknown=["unknown",12],V.unknown.toString=s,(V.unknown.__enum__=V).__empty_constructs__=[V.auto,V.domains,V.announcements,V.error,V.loading,V.unknown];var C=n["albero.TalkUrlParam"]={__ename__:["albero","TalkUrlParam"],__constructs__:["multi","single"]};C.multi=function(e){var t=["multi",0,e];return t.__enum__=C,t.toString=s,t},C.single=function(e){var t=["single",1,e];return t.__enum__=C,t.toString=s,t},C.__empty_constructs__=[];function O(){}(n["albero.TalkUrlParamHelper"]=O).__name__=["albero","TalkUrlParamHelper"],O.getTalkSelectionForSingle=function(e){switch(e[1]){case 0:return Ca.None;case 1:var t=e[2];return Ca.Some(t)}},O.getTalkSelectionsForMulti=function(e){switch(e[1]){case 0:var t=e[2];return Ca.Some(t);case 1:return Ca.None}};function M(){}(n["albero.UrlConverter"]=M).__name__=["albero","UrlConverter"],M.createUrls=function(e,t){if(null==e)return V.unknown;var n=e.split("/");return""!=n[0]?V.unknown:n.length<2?V.unknown:2==n.length?M.createUrlsWithoutDomain(n,t):M.createUrlsWithDomain(n,t)},M.createUrlsWithoutDomain=function(e,t){switch(e[1]){case"":return V.domains;case"environment":var n=t.getFallbackDomainId();return at.foreach(n,function(e){A.replaceState("environment",null,"#"+M.createFragment(V.environment(e),t))}),V.environment(at.orNull(n));case"error":return V.error;case"loading":return V.loading;case"settings":var i=t.getFallbackDomainId();return at.foreach(i,function(e){A.replaceState("settings",null,"#"+M.createFragment(V.settings(e),t))}),V.settings(at.orNull(i));default:return V.unknown}},M.createUrlsWithDomain=function(e,t){var n=it.parse(e[1]);if(null==n)return V.unknown;switch(e[2]){case"":return V.domain(n);case"actions":return V.actions(n);case"bookmarks":return V.bookmarks(n);case"environment":return V.environment(n);case"members":return V.members(n);case"settings":return V.settings(n);case"talks":if(e.length<4)return V.talks(n,C.single(Mn.NotSelected));if("multi"==e[3]||",,"==e[3])return V.talks(n,C.multi([Mn.NotSelected,Mn.NotSelected,Mn.NotSelected]));if("single"==e[3]||""==e[3])return V.talks(n,C.single(Mn.NotSelected));var i=e[3].split(",");if(1==i.length){var r=e.length<5?Ca.None:at.option(it.parse(e[4])),a=M.createTalkSelection(i[0],r);return V.talks(n,C.single(a))}if(3!=i.length)break;var o=i.map(function(e){return M.createTalkSelection(e,Ca.None)});return V.talks(n,C.multi(o))}return V.unknown},M.createTalkSelection=function(e,t){if(e==M.ANNOUNCEMENTS_KEY)return Mn.AnnouncementsSelected;var n=it.parse(e);return null==n?Mn.NotSelected:Mn.TalkSelected(n,t)},M.createFragment=function(e,t){switch(e[1]){case 1:return"/";case 2:var n=e[2];return"/"+va.toString(n)+"/";case 3:var i=e[2];return"/"+va.toString(i)+"/members";case 4:var r=e[3],a=e[2];switch(r[1]){case 0:var o="/"+r[2].map(M.createTalkPartFragment).join(",");return"/"+va.toString(a)+"/talks"+o;case 1:var s=r[2],l=M.createTalkPartFragment(s),u=k.isEmpty(l)?"":"/"+l;return"/"+va.toString(a)+"/talks"+u}break;case 5:var c=e[2];return"/"+va.toString(c)+"/actions";case 6:var _=e[2];return"/"+va.toString(_)+"/bookmarks";case 7:var h,d=e[2];switch(ji._d("["+tt.dateStr(new Date)+"] ","convert urls.settings to fragment. domainId:",null!=d?d:"","","",""),at.option(d)[1]){case 0:h=at.option(d);break;case 1:h=t.getLastSelectedDomainId()}var f=at.map(h,function(e){return"/"+va.toString(e)+"/settings"});switch(f[1]){case 0:return f[2];case 1:return"/settings"}break;case 9:case 10:return"/"+K.string(e);case 11:var m,p=e[2];switch(ji._d("["+tt.dateStr(new Date)+"] ","convert urls.environment to fragment. domainId:",null!=p?p:"","","",""),at.option(p)[1]){case 0:m=at.option(p);break;case 1:m=t.getLastSelectedDomainId()}var g=at.map(m,function(e){return"/"+va.toString(e)+"/environment"});switch(g[1]){case 0:return g[2];case 1:return"/environment"}break;default:return null}},M.createTalkPartFragment=function(e){switch(e[1]){case 0:return"";case 1:var t,n=e[3],i=e[2],r=at.map(n,function(e){return"/"+va.toString(e)});switch(r[1]){case 0:t=r[2];break;case 1:t=""}return va.toString(i)+t;case 2:return M.ANNOUNCEMENTS_KEY}};function R(){}(n["albero.IUrlConverterDelegate"]=R).__name__=["albero","IUrlConverterDelegate"],R.prototype={__class__:R};function F(){}(n["puremvc.interfaces.INotifier"]=F).__name__=["puremvc","interfaces","INotifier"],F.prototype={__class__:F};function x(){this.facade=m.getInstance()}(n["puremvc.patterns.observer.Notifier"]=x).__name__=["puremvc","patterns","observer","Notifier"],x.__interfaces__=[F],x.prototype={sendNotification:function(e,t,n){this.facade.sendNotification(e,t,n)},__class__:x};function U(){}(n["puremvc.interfaces.ICommand"]=U).__name__=["puremvc","interfaces","ICommand"],U.prototype={__class__:U};function P(){x.call(this)}(n["puremvc.patterns.command.SimpleCommand"]=P).__name__=["puremvc","patterns","command","SimpleCommand"],P.__interfaces__=[U],P.__super__=x,P.prototype=i(x.prototype,{execute:function(e){},__class__:P});function L(){P.call(this),p.getInstance().autoBind(this)}(n["albero.command.AutoBindCommand"]=L).__name__=["albero","command","AutoBindCommand"],L.__super__=P,L.prototype=i(P.prototype,{__class__:L});var B=function(){L.call(this)};(n["albero.command.AccountControlRequestCommand"]=B).__name__=["albero","command","AccountControlRequestCommand"],B.__super__=L,B.prototype=i(L.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.api.acceptAccountControlRequest(n);break;case 1:var i=t[2];this.api.rejectAccountControlRequest(i)}},__class__:B});var H=n["albero.command.AccountControlRequestAction"]={__ename__:["albero","command","AccountControlRequestAction"],__constructs__:["ACCEPT_REQUEST","REJECT_REQUEST"]};H.ACCEPT_REQUEST=function(e){var t=["ACCEPT_REQUEST",0,e];return t.__enum__=H,t.toString=s,t},H.REJECT_REQUEST=function(e){var t=["REJECT_REQUEST",1,e];return t.__enum__=H,t.toString=s,t},H.__empty_constructs__=[];var j=function(){L.call(this)};(n["albero.command.ConferenceCommand"]=j).__name__=["albero","command","ConferenceCommand"],j.__super__=L,j.prototype=i(L.prototype,{execute:function(e){var t=this,n=e.getBody();switch(n[1]){case 0:var i=n[3],r=n[2];this.api.joinConference(r,i);break;case 1:var a=n[2];this.api.leaveConference(a);var o=at.filter(this.conferenceStore.getConference(a),function(e){return e.isExpired()});at.foreach(o,function(e){t.conferenceStore.removeConference(e),t.sendNotification("notify_close_conference",e)});break;case 2:var s=n[2];this.api.rejectConference(s)}},__class__:j});var Y=n["albero.command.ConferenceAction"]={__ename__:["albero","command","ConferenceAction"],__constructs__:["JOIN_CONFERENCE","LEAVE_CONFERENCE","REJECT_CONFERENCE"]};Y.JOIN_CONFERENCE=function(e,t){var n=["JOIN_CONFERENCE",0,e,t];return n.__enum__=Y,n.toString=s,n},Y.LEAVE_CONFERENCE=function(e){var t=["LEAVE_CONFERENCE",1,e];return t.__enum__=Y,t.toString=s,t},Y.REJECT_CONFERENCE=function(e){var t=["REJECT_CONFERENCE",2,e];return t.__enum__=Y,t.toString=s,t},Y.__empty_constructs__=[];var G=function(){L.call(this)};(n["albero.command.DeviceCommand"]=G).__name__=["albero","command","DeviceCommand"],G.__super__=L,G.prototype=i(L.prototype,{execute:function(e){var n=this;e.getBody();require("read")({prompt:"Code: "},function(e,t){n.api.authorizeDevice(t,function(){n.sendNotification("SignIn")})})},__class__:G});var q=n["albero.command.DeviceAction"]={__ename__:["albero","command","DeviceAction"],__constructs__:["AUTHORIZE"]};q.AUTHORIZE=["AUTHORIZE",0],q.AUTHORIZE.toString=s,(q.AUTHORIZE.__enum__=q).__empty_constructs__=[q.AUTHORIZE];var Q=function(){L.call(this)};(n["albero.command.DomainCommand"]=Q).__name__=["albero","command","DomainCommand"],Q.__super__=L,Q.prototype=i(L.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.api.acceptDomainInvite(n);break;case 1:var i=t[2];this.api.deleteDomainInvite(i);break;case 2:var r=t[2];this.api.leaveDomain(r)}},__class__:Q});var J=n["albero.command.DomainAction"]={__ename__:["albero","command","DomainAction"],__constructs__:["ACCEPT_INVITE","DELETE_INVITE","LEAVE"]};J.ACCEPT_INVITE=function(e){var t=["ACCEPT_INVITE",0,e];return t.__enum__=J,t.toString=s,t},J.DELETE_INVITE=function(e){var t=["DELETE_INVITE",1,e];return t.__enum__=J,t.toString=s,t},J.LEAVE=function(e){var t=["LEAVE",2,e];return t.__enum__=J,t.toString=s,t},J.__empty_constructs__=[];var X=function(){L.call(this)};(n["albero.command.FileCommand"]=X).__name__=["albero","command","FileCommand"],X.__super__=L,X.prototype=i(L.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.api.uploadV2(i.domainId,i.id,n);break;case 1:var r=t[4],a=t[3],o=t[2];this.api.uploadMultiV2(o.domainId,o.id,a,r);break;case 2:var s=t[2];s.deleted=!0,this.api.deleteAttachment(s.id,s.messageId);break;case 3:var l=t[6],u=t[5],c=t[4],_=t[3],h=t[2];this.api.createDownloadAuth(h,_,c,u,l);break;case 4:var d=t[6],f=t[5],m=t[4],p=t[3],g=t[2],v=this.fileService.createDummyFile(p,m,f);this.api.uploadForHubot(g,v,d);break;case 5:for(var y=t[7],S=t[6],w=t[5],I=t[4],T=t[3],E=t[2],N=[],A=0,b=I.length;A<b;){var D=A++;N.push(this.fileService.createDummyFile(I[D],w[D],S[D]))}this.api.uploadMultiForHubot(E,T,N,y);break;case 6:var k=t[4],C=t[3],O=t[2];this.fileService.download(O,C,k)}},__class__:X});var Z=n["albero.command.FileAction"]={__ename__:["albero","command","FileAction"],__constructs__:["UPLOAD","UPLOAD_MULTI","DELETE","AUTH","UPLOAD_PATH","UPLOAD_MULTI_PATH","DOWNLOAD_PATH"]};Z.UPLOAD=function(e,t){var n=["UPLOAD",0,e,t];return n.__enum__=Z,n.toString=s,n},Z.UPLOAD_MULTI=function(e,t,n){var i=["UPLOAD_MULTI",1,e,t,n];return i.__enum__=Z,i.toString=s,i},Z.DELETE=function(e){var t=["DELETE",2,e];return t.__enum__=Z,t.toString=s,t},Z.AUTH=function(e,t,n,i,r){var a=["AUTH",3,e,t,n,i,r];return a.__enum__=Z,a.toString=s,a},Z.UPLOAD_PATH=function(e,t,n,i,r){var a=["UPLOAD_PATH",4,e,t,n,i,r];return a.__enum__=Z,a.toString=s,a},Z.UPLOAD_MULTI_PATH=function(e,t,n,i,r,a){var o=["UPLOAD_MULTI_PATH",5,e,t,n,i,r,a];return o.__enum__=Z,o.toString=s,o},Z.DOWNLOAD_PATH=function(e,t,n){var i=["DOWNLOAD_PATH",6,e,t,n];return i.__enum__=Z,i.toString=s,i},Z.__empty_constructs__=[];var te=function(){L.call(this)};(n["albero.command.LoadStampsetCommand"]=te).__name__=["albero","command","LoadStampsetCommand"],te.__super__=L,te.prototype=i(L.prototype,{execute:function(e){e.getBody();this.loadCommonStampset()},getOriginalStampset:function(t){var n=ie.getInstance(),e=n.get(t);if(null!=e)return e;var i=this.api.getStampsets([t]);return n.add(t,i),i.then(function(e){n.remove(t)},function(e){n.remove(t)}),i},getOriginalStamp:function(n){var i=this,e=this.stampsStore.getOriginalStamp(n.stampId);return null!=e?Promise.resolve(e):this.getOriginalStampset(n.stampsetId).then(function(e){var t=i.stampsStore.getOriginalStamp(n.stampId);return null==t?Promise.reject("stamp_not_found"):Promise.resolve(t)})},loadCommonStampset:function(){},__class__:te});var ne=n["albero.command.LoadStampsetAction"]={__ename__:["albero","command","LoadStampsetAction"],__constructs__:["COMMON"]};ne.COMMON=["COMMON",0],ne.COMMON.toString=s,(ne.COMMON.__enum__=ne).__empty_constructs__=[ne.COMMON];var ie=function(){this.loadings=new Ma};(n["albero.command.StampsetLoadingPromises"]=ie).__name__=["albero","command","StampsetLoadingPromises"],ie.getInstance=function(){return null==ie.instance&&(ie.instance=new ie),ie.instance},ie.prototype={get:function(e){var t="_"+e.high+"_"+e.low,n=this.loadings;return null!=Io[t]?n.getReserved(t):n.h[t]},add:function(e,t){var n="_"+e.high+"_"+e.low,i=this.loadings;null!=Io[n]?i.setReserved(n,t):i.h[n]=t},remove:function(e){this.loadings.remove("_"+e.high+"_"+e.low)},__class__:ie};var re=function(){L.call(this)};(n["albero.command.ManageFriendsCommand"]=re).__name__=["albero","command","ManageFriendsCommand"],re.__super__=L,re.prototype=i(L.prototype,{execute:function(e){var t=e.getBody();switch(t.action[1]){case 0:for(var n=0,i=t.users;n<i.length;){var r=i[n];++n,this.api.addFriend(r)}break;case 1:for(var a=0,o=t.users;a<o.length;){var s=o[a];++a,this.api.deleteFriend(s)}}},__class__:re});var ae=n["albero.command.ManageFriendsAction"]={__ename__:["albero","command","ManageFriendsAction"],__constructs__:["ADD","DELETE"]};ae.ADD=["ADD",0],ae.ADD.toString=s,(ae.ADD.__enum__=ae).DELETE=["DELETE",1],ae.DELETE.toString=s,(ae.DELETE.__enum__=ae).__empty_constructs__=[ae.ADD,ae.DELETE];var oe=function(){L.call(this)};(n["albero.command.MessageCommand"]=oe).__name__=["albero","command","MessageCommand"],oe.__super__=L,oe.prototype=i(L.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.api.deleteMessage(i,n);break;case 1:var r=t[3],a=t[2];this.api.forwardMessages(a,r,0);break;case 2:var o=t[4],s=t[3],l=t[2];this.api.addFavoriteMessage(l,s,o);break;case 3:var u=t[3],c=t[2];this.api.deleteFavoriteMessage(c,u);break;case 4:var _=t[4],h=t[3],d=t[2];this.api.getFavoriteMessages(d,h,_)}},__class__:oe});var se=n["albero.command.MessageAction"]={__ename__:["albero","command","MessageAction"],__constructs__:["DELETE","FORWARD","ADD_FAVORITE","DELETE_FAVORITE","GET_FAVORITES"]};se.DELETE=function(e,t){var n=["DELETE",0,e,t];return n.__enum__=se,n.toString=s,n},se.FORWARD=function(e,t){var n=["FORWARD",1,e,t];return n.__enum__=se,n.toString=s,n},se.ADD_FAVORITE=function(e,t,n){var i=["ADD_FAVORITE",2,e,t,n];return i.__enum__=se,i.toString=s,i},se.DELETE_FAVORITE=function(e,t){var n=["DELETE_FAVORITE",3,e,t];return n.__enum__=se,n.toString=s,n},se.GET_FAVORITES=function(e,t,n){var i=["GET_FAVORITES",4,e,t,n];return i.__enum__=se,i.toString=s,i},se.__empty_constructs__=[];var le=function(){L.call(this)};(n["albero.command.NoteCommand"]=le).__name__=["albero","command","NoteCommand"],le.__super__=L,le.prototype=i(L.prototype,{execute:function(e){var t=this,n=e.getBody();switch(n[1]){case 0:var i=n[3],r=n[2];this.api.getNoteStatuses(r,i);break;case 1:var a=n[2];this.api.getNote(a);break;case 2:n[3];var o=n[2];sr.delayForReplicationLag().then(function(e){t.api.getNote(o)});break;case 3:var s=n[4],l=n[3],u=n[2];this.api.createNoteV2(u,l,s);break;case 4:var c=n[5],_=n[4],h=n[3],d=n[2],f=this.createNoteLocalEdit(d,h,c);this.api.createNoteV2(d,f,_);break;case 5:var m=n[4],p=n[3],g=n[2];this.api.updateNoteSetting(g,p,m);break;case 6:var v=n[5],y=n[4],S=n[3],w=n[2];this.api.updateNoteV2(w,S,y,v);break;case 7:var I=n[2];this.api.deleteNote(I);break;case 8:var T=n[2];this.dataStore.setNoteLocalEdit(T,null)}},createNoteLocalEdit:function(e,t,n){var i=Si.createDummyId(),r=this.createNoteAttachmentFileInfoList(e,t.attachments);return new wi(e,i,t.title,t.content,r,n)},createNoteAttachmentFileInfoList:function(e,t){for(var n=[],i=0;i<t.length;){var r=t[i];++i;var a=this.fileService.createDummyFile(r.path,r.name,r.type);n.push(this.fileInfoStore.createStagedFileInfoFromDummyFile(e,a,null))}return n},updateNote:function(e,t,n,i){return this.api.updateNoteV2(e,t,n,i)},lockNote:function(e,t){return this.api.lockNote(e,t)},unlockNote:function(e,t){return this.api.unlockNote(e,t)},__class__:le});var ue=n["albero.command.NoteAction"]={__ename__:["albero","command","NoteAction"],__constructs__:["GET_NOTE_STATUSES","GET_NOTE","GET_NOTE_ON_NOTIFY_UPDATE","CREATE_NOTE","CREATE_NOTE_FOR_HUBOT","UPDATE_NOTE_SETTING","UPDATE_NOTE","DELETE_NOTE","DELETE_NOTE_LOCAL_EDIT"]};ue.GET_NOTE_STATUSES=function(e,t){var n=["GET_NOTE_STATUSES",0,e,t];return n.__enum__=ue,n.toString=s,n},ue.GET_NOTE=function(e){var t=["GET_NOTE",1,e];return t.__enum__=ue,t.toString=s,t},ue.GET_NOTE_ON_NOTIFY_UPDATE=function(e,t){var n=["GET_NOTE_ON_NOTIFY_UPDATE",2,e,t];return n.__enum__=ue,n.toString=s,n},ue.CREATE_NOTE=function(e,t,n){var i=["CREATE_NOTE",3,e,t,n];return i.__enum__=ue,i.toString=s,i},ue.CREATE_NOTE_FOR_HUBOT=function(e,t,n,i){var r=["CREATE_NOTE_FOR_HUBOT",4,e,t,n,i];return r.__enum__=ue,r.toString=s,r},ue.UPDATE_NOTE_SETTING=function(e,t,n){var i=["UPDATE_NOTE_SETTING",5,e,t,n];return i.__enum__=ue,i.toString=s,i},ue.UPDATE_NOTE=function(e,t,n,i){var r=["UPDATE_NOTE",6,e,t,n,i];return r.__enum__=ue,r.toString=s,r},ue.DELETE_NOTE=function(e){var t=["DELETE_NOTE",7,e];return t.__enum__=ue,t.toString=s,t},ue.DELETE_NOTE_LOCAL_EDIT=function(e){var t=["DELETE_NOTE_LOCAL_EDIT",8,e];return t.__enum__=ue,t.toString=s,t},ue.__empty_constructs__=[];var ce=function(){L.call(this)};(n["albero.command.ReadCommand"]=ce).__name__=["albero","command","ReadCommand"],ce.__super__=L,ce.prototype=i(L.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.readStatusUpdater.updateReadStatuses(i,n);break;case 1:var r=t[3],a=t[2];this.readStatusUpdater.updateAnnouncementReadStatus(a,r);break;case 2:var o=t[3],s=t[2];this.api.getReadStatus(s,o);break;case 3:var l=t[3],u=t[2];this.keywordWatcher.readKeywordDetection(u,null,l);break;case 4:var c=t[3],_=t[2];this.keywordWatcher.readKeywordDetection(null,_,c)}},__class__:ce});var _e=n["albero.command.ReadType"]={__ename__:["albero","command","ReadType"],__constructs__:["TALK","ANNOUNCEMENT","READ_STATUS","KEYWORD_IN_ANNOUNCEMENTS","KEYWORD_IN_MESSAGES"]};_e.TALK=function(e,t){var n=["TALK",0,e,t];return n.__enum__=_e,n.toString=s,n},_e.ANNOUNCEMENT=function(e,t){var n=["ANNOUNCEMENT",1,e,t];return n.__enum__=_e,n.toString=s,n},_e.READ_STATUS=function(e,t){var n=["READ_STATUS",2,e,t];return n.__enum__=_e,n.toString=s,n},_e.KEYWORD_IN_ANNOUNCEMENTS=function(e,t){var n=["KEYWORD_IN_ANNOUNCEMENTS",3,e,t];return n.__enum__=_e,n.toString=s,n},_e.KEYWORD_IN_MESSAGES=function(e,t){var n=["KEYWORD_IN_MESSAGES",4,e,t];return n.__enum__=_e,n.toString=s,n},_e.__empty_constructs__=[];var he=function(){L.call(this)};(n["albero.command.ReloadDataCommand"]=he).__name__=["albero","command","ReloadDataCommand"],he.__super__=L,he.prototype=i(L.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:this.api.getDomains();break;case 1:this.api.getFriends(),this.api.getAcquaintances();break;case 2:this.api.getTalks();break;case 3:var n=t[5],i=t[4],r=t[3],a=t[2];this.api.getMessages(a,r,i,n);break;case 4:var o=t[2];this.api.getAllUsers(o);break;case 5:var s=t[3],l=t[2];this.api.getUsers(l,s);break;case 6:var u=t[3],c=t[2];this.api.getProfile(c,u);break;case 7:var _=t[3],h=t[2];this.api.searchDomainUsers(h,_);break;case 8:var d=t[4],f=t[3],m=t[2];this.api.getAnnouncements(m,f,d);break;case 9:var p=t[5],g=t[4],v=t[3],y=t[2];this.api.getQuestions(y,v,g,p);break;case 10:var S=t[3],w=t[2];this.api.getQuestion(w,S);break;case 11:var I=t[3],T=t[2];this.api.getAttachments(T,I);break;case 12:var E=t[3],N=t[2];this.api.getSolutions(N,E);break;case 13:this.api.getMe();break;case 14:var A=t[2];this.api.getDepartmentTree(A);break;case 15:var b=t[3],D=t[2];this.api.getDepartmentUsers(D,b);break;case 16:var k=t[2];this.api.getDepartmentAllUsers(k);break;case 17:var C=t[3],O=t[2];this.api.getDepartmentUserCount(O,C)}},__class__:he});var de=n["albero.command.ReloadDataType"]={__ename__:["albero","command","ReloadDataType"],__constructs__:["Domains","Friends","Talks","Messages","AllUsers","GetUsers","GetProfile","SearchDomainUsers","Announcements","Questions","Question","Files","Solutions","Me","DepartmentTree","DepartmentUsers","DepartmentAllUsers","DepartmentUserCount"]};de.Domains=["Domains",0],de.Domains.toString=s,(de.Domains.__enum__=de).Friends=["Friends",1],de.Friends.toString=s,(de.Friends.__enum__=de).Talks=["Talks",2],de.Talks.toString=s,(de.Talks.__enum__=de).Messages=function(e,t,n,i){var r=["Messages",3,e,t,n,i];return r.__enum__=de,r.toString=s,r},de.AllUsers=function(e){var t=["AllUsers",4,e];return t.__enum__=de,t.toString=s,t},de.GetUsers=function(e,t){var n=["GetUsers",5,e,t];return n.__enum__=de,n.toString=s,n},de.GetProfile=function(e,t){var n=["GetProfile",6,e,t];return n.__enum__=de,n.toString=s,n},de.SearchDomainUsers=function(e,t){var n=["SearchDomainUsers",7,e,t];return n.__enum__=de,n.toString=s,n},de.Announcements=function(e,t,n){var i=["Announcements",8,e,t,n];return i.__enum__=de,i.toString=s,i},de.Questions=function(e,t,n,i){var r=["Questions",9,e,t,n,i];return r.__enum__=de,r.toString=s,r},de.Question=function(e,t){var n=["Question",10,e,t];return n.__enum__=de,n.toString=s,n},de.Files=function(e,t){var n=["Files",11,e,t];return n.__enum__=de,n.toString=s,n},de.Solutions=function(e,t){var n=["Solutions",12,e,t];return n.__enum__=de,n.toString=s,n},de.Me=["Me",13],de.Me.toString=s,(de.Me.__enum__=de).DepartmentTree=function(e){var t=["DepartmentTree",14,e];return t.__enum__=de,t.toString=s,t},de.DepartmentUsers=function(e,t){var n=["DepartmentUsers",15,e,t];return n.__enum__=de,n.toString=s,n},de.DepartmentAllUsers=function(e){var t=["DepartmentAllUsers",16,e];return t.__enum__=de,t.toString=s,t},de.DepartmentUserCount=function(e,t){var n=["DepartmentUserCount",17,e,t];return n.__enum__=de,n.toString=s,n},de.__empty_constructs__=[de.Domains,de.Friends,de.Talks,de.Me];var fe=function(){L.call(this)};(n["albero.command.SearchCommand"]=fe).__name__=["albero","command","SearchCommand"],fe.__super__=L,fe.prototype=i(L.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[4],i=t[3],r=t[2];if(this.searchService.isSearching())return;switch(null==n&&this.searchService.saveParams(r),r.searchType[1]){case 0:this.api.searchMessages(r.copy(),i,n);break;case 1:this.api.searchAttachments(r.copy(),i,n)}break;case 1:this.searchService.clearEditingParams(),this.searchService.clearRecentParams(),this.searchService.clearSearching(),this.sendNotification("notify_search_clear",{})}},__class__:fe});var me=n["albero.command.SearchAction"]={__ename__:["albero","command","SearchAction"],__constructs__:["SEARCH","CLEAR"]};me.SEARCH=function(e,t,n){var i=["SEARCH",0,e,t,n];return i.__enum__=me,i.toString=s,i},me.CLEAR=["CLEAR",1],me.CLEAR.toString=s,(me.CLEAR.__enum__=me).__empty_constructs__=[me.CLEAR];var pe=function(){L.call(this)};(n["albero.command.SelectTalkCommand"]=pe).__name__=["albero","command","SelectTalkCommand"],pe.__super__=L,pe.prototype=i(L.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2],r=new kn(i,Mn.NotSelected);this.sendNotification("Url",be.REDIRECT(r.createUrls(n,this.settings)));break;case 1:var a=t[4],o=t[3],s=t[2],l=new kn(s,Mn.TalkSelected(o.id,Ca.Some(a)));this.sendNotification("Url",be.REDIRECT(l.createUrls(o.domainId,this.settings)));break;case 2:var u=t[3],c=t[2],_=new kn(c,Mn.TalkSelected(u.id,Ca.None));this.sendNotification("Url",be.REDIRECT(_.createUrls(u.domainId,this.settings)));break;case 3:var h=t[3],d=t[2],f=new kn(d,Mn.AnnouncementsSelected);this.sendNotification("Url",be.REDIRECT(f.createUrls(h,this.settings)));break;case 4:var m=t[4],p=t[3],g=t[2],v=this.getFallbackUrls(g,nt.array(p));if(at.isEmpty(v)){var y=fo(this,this.updateSelectionIfNeed),S=g,w=m;nt.iter(p,function(e){y(S,w,e)})}}},updateSelectionIfNeed:function(e,t,n){if(t||!this.isSelectionParametersNotChanged(e,n)){var i=n.talkSelection;switch(i[1]){case 0:this.settings.clearSelectedTalk(n.paneType);break;case 1:var r=i[3],a=i[2];this.settings.selectTalk(n.paneType,e,a,r);break;case 2:this.settings.selectAnnouncement(n.paneType)}}},isSelectionParametersNotChanged:function(e,t){var n=this.settings.getSelectedDomainIdOnTalkSelectionChanged();return null!=e&&null!=n&&e.high==n.high&&e.low==n.low&&Rn.eqTalkSelection(t.talkSelection,this.settings.getTalkSelection(e,t.paneType))},getFallbackUrls:function(e,t){var n=fo(this,this.getValidTalkSelection),i=e,r=t.map(function(e){return n(i,e)});if(!nt.exists(r,at.isEmpty))return Ca.None;var a=r.map(fo(this,this.getOrNotSelected)),o=1==r.length?C.single(a[0]):C.multi(a);return Ca.Some(V.talks(e,o))},getOrNotSelected:function(e){switch(e[1]){case 0:return e[2];case 1:return Mn.NotSelected}},getValidTalkSelection:function(e,t){var n=t.talkSelection;switch(n[1]){case 0:break;case 1:n[3];var i,r=n[2],a=this.dataStore.getTalk(r);if(null!=a){var o=a.domainId;i=!(null!=o&&null!=e&&o.high==e.high&&o.low==e.low)}else i=!0;if(i)return Ca.None;break;case 2:var s=this.dataStore.getDomain(e),l=this.dataStore.getAnnouncementStatus(e);if(!ct.hasAnnouncement(s,l))return Ca.None}return Ca.Some(t.talkSelection)},__class__:pe});var ge=n["albero.command.SelectTalkAction"]={__ename__:["albero","command","SelectTalkAction"],__constructs__:["SelectNone","SelectTalkAndMessage","SelectTalk","SelectAnnouncement","UpdateSelection"]};ge.SelectNone=function(e,t){var n=["SelectNone",0,e,t];return n.__enum__=ge,n.toString=s,n},ge.SelectTalkAndMessage=function(e,t,n){var i=["SelectTalkAndMessage",1,e,t,n];return i.__enum__=ge,i.toString=s,i},ge.SelectTalk=function(e,t){var n=["SelectTalk",2,e,t];return n.__enum__=ge,n.toString=s,n},ge.SelectAnnouncement=function(e,t){var n=["SelectAnnouncement",3,e,t];return n.__enum__=ge,n.toString=s,n},ge.UpdateSelection=function(e,t,n){var i=["UpdateSelection",4,e,t,n];return i.__enum__=ge,i.toString=s,i},ge.__empty_constructs__=[];var ve=function(){L.call(this)};(n["albero.command.SendCommand"]=ve).__name__=["albero","command","SendCommand"],ve.__super__=L,ve.prototype=i(L.prototype,{execute:function(e){var t,n=e.getBody();if(null!=n.id){var i=n.id;t="_"+i.high+"_"+i.low}else t=null;null!=n.talkId?this.api.createMessage(n.talkId,n.type,n.content,t):this.api.createAnnouncement(n.domainId,n.type,n.content,t)},__class__:ve});var ye=function(){L.call(this)};(n["albero.command.SignInCommand"]=ye).__name__=["albero","command","SignInCommand"],ye.__super__=L,ye.prototype=i(L.prototype,{execute:function(e){this.accessTokenResolver.asyncGetAccessToken(e.getBody(),fo(_o=this.session,_o.start))},__class__:ye});var Se=function(){L.call(this)};(n["albero.command.SignOutCommand"]=Se).__name__=["albero","command","SignOutCommand"],Se.__super__=L,Se.prototype=i(L.prototype,{execute:function(e){this.api.deleteSession(),this.settings.clearInputTextForAll(),this.dataStore.clear(!0),ji._e("["+tt.dateStr(new Date)+"] ","signout","","","",""),process.exit(1)},__class__:Se});var we=function(){L.call(this)};(n["albero.command.TalkCommand"]=we).__name__=["albero","command","TalkCommand"],we.__super__=L,we.prototype=i(L.prototype,{execute:function(e){var t=this,n=e.getBody();switch(n[1]){case 0:var i=n[4],r=n[3],a=n[2],o=this.dataStore.getValidPairTalk(r,a);null!=o?(this.sendNotification("SelectTalk",ge.SelectTalk(i,o)),this.sendNotification("open_existing_pair_talk_completed")):this.api.createPairTalk(a,r,i);break;case 1:var s=n[5],l=n[4],u=n[3],c=n[2];this.api.createGroupTalk(c,u,l,s);break;case 2:var _=n[4],h=n[3],d=n[2];this.api.addTalkers(d,h,_);break;case 3:var f=n[4],m=n[3],p=n[2];null==m&&(m=this.dataStore.getTalk(p)),null==f&&(f=this.dataStore.me.id),this.api.deleteTalker(m,f);break;case 4:var g=n[7],v=n[6],y=n[5],S=n[4],w=n[3],I=n[2];if(null==w&&(w=this.dataStore.getTalk(I)),w.type!=Nn.GroupTalk)return;null==g&&(g=Ga.__cast(w,Tn).isSystemMessageVisibled()),this.prepareIconUrl(w.domainId,y,v,function(e){t.api.updateGroupTalk(w,S,e,g)});break;case 5:var T=n[3],E=n[2];this.api.addFavoriteTalk(E,T);break;case 6:var N=n[3],A=n[2];this.api.deleteFavoriteTalk(A,N);break;case 7:var b=n[3],D=n[2];this.api.disablePushNotification(D,b);break;case 8:var k=n[3],C=n[2];this.api.enablePushNotification(C,k)}},prepareIconUrl:function(e,t,n,i){var r=this;null==n&&null!=t?this.api.uploadFile(t,e,Hn.TALK_ICON,function(e){i(e.get_url)},function(e){r.sendNotification("notify_update_group_talk_ERRORED")}):i(n)},__class__:we});var Ie=n["albero.command.TalkAction"]={__ename__:["albero","command","TalkAction"],__constructs__:["OPEN_PAIR_TALK","OPEN_GROUP_TALK","ADD","DELETE","UPDATE","ADD_FAVORITE","DELETE_FAVORITE","DISABLE_PUSH_NOTIFICATION","ENABLE_PUSH_NOTIFICATION"]};Ie.OPEN_PAIR_TALK=function(e,t,n){var i=["OPEN_PAIR_TALK",0,e,t,n];return i.__enum__=Ie,i.toString=s,i},Ie.OPEN_GROUP_TALK=function(e,t,n,i){var r=["OPEN_GROUP_TALK",1,e,t,n,i];return r.__enum__=Ie,r.toString=s,r},Ie.ADD=function(e,t,n){var i=["ADD",2,e,t,n];return i.__enum__=Ie,i.toString=s,i},Ie.DELETE=function(e,t,n){var i=["DELETE",3,e,t,n];return i.__enum__=Ie,i.toString=s,i},Ie.UPDATE=function(e,t,n,i,r,a){var o=["UPDATE",4,e,t,n,i,r,a];return o.__enum__=Ie,o.toString=s,o},Ie.ADD_FAVORITE=function(e,t){var n=["ADD_FAVORITE",5,e,t];return n.__enum__=Ie,n.toString=s,n},Ie.DELETE_FAVORITE=function(e,t){var n=["DELETE_FAVORITE",6,e,t];return n.__enum__=Ie,n.toString=s,n},Ie.DISABLE_PUSH_NOTIFICATION=function(e,t){var n=["DISABLE_PUSH_NOTIFICATION",7,e,t];return n.__enum__=Ie,n.toString=s,n},Ie.ENABLE_PUSH_NOTIFICATION=function(e,t){var n=["ENABLE_PUSH_NOTIFICATION",8,e,t];return n.__enum__=Ie,n.toString=s,n},Ie.__empty_constructs__=[];var Te=function(){L.call(this)};(n["albero.command.UpdateProfileCommand"]=Te).__name__=["albero","command","UpdateProfileCommand"],Te.__super__=L,Te.prototype=i(L.prototype,{execute:function(e){var t=e.getBody().domainId,n=e.getBody().profileItemValues,i=e.getBody().copyToAllDomains,r=this.dataStore.getDomain(t);if(null!=r&&null!=r.profileDefinition.itemDefinitions){var a=[];if(i){for(var o=[],s=0;s<n.length;){var l=n[s];++s;var u=Kt.findById(r.profileDefinition.itemDefinitions,l.profileItemId);null!=u&&o.push({name:u.name,value:l.value})}for(var c=0,_=this.dataStore.getDomains();c<_.length;){var h=_[c];if(++c,!h.domainInfo.frozen){for(var d=[],f=0,m=h.profileDefinition.itemDefinitions;f<m.length;){var p=m[f];if(++f,p.visible&&!p.locked)for(var g=0;g<o.length;){var v=o[g];if(++g,v.name==p.name){var y=new Wt;y.profileItemId=p.profileItemId,y.value=v.value,d.push(y);break}}}0<d.length&&a.push(new Vt(h.id,d))}}}else{for(var S=[],w=(tt.iter(n),0);w<n.length;){var I=n[w];++w;var T=Kt.findById(r.profileDefinition.itemDefinitions,I.profileItemId);null!=T&&T.visible&&!T.locked&&S.push(I)}0<S.length&&a.push(new Vt(r.id,S))}0==a.length?this.sendNotification("update_profile_responsed",this.dataStore.me):this.api.updateProfile(a)}},__class__:Te});var Ee=function(){L.call(this)};(n["albero.command.UpdateUserCommand"]=Ee).__name__=["albero","command","UpdateUserCommand"],Ee.__super__=L,Ee.prototype=i(L.prototype,{execute:function(e){var t=e.getBody();if(null!=t.profileImage){var n=t.profileImage;if(!W.startsWith(n.type,"image/"))return}this.api.updateUser(t.displayName,t.profileImage,t.profileImageUrl,t.phoneticDisplayName,t.status)},__class__:Ee});var Ne=function(){L.call(this)};(n["albero.command.UpdateUserPresencesCommand"]=Ne).__name__=["albero","command","UpdateUserPresencesCommand"],Ne.__super__=L,Ne.prototype=i(L.prototype,{execute:function(e){var t=e.getBody().domainId,n=e.getBody().userIds;if(null!=t&&null!=n){var i=this.filterOnlyExpired(it.unique(n));0!=i.length&&this.updateIfNeedPerSub(t,i)}},filterOnlyExpired:function(e){var n=this,i=T.nowAsInt64(),t=this.settings.getConfiguration().presenceExpiration,r=new zn(t>>31,t);return e.filter(function(e){var t=at.map(n.userPresences.getUserPresence(e),function(e){return e.isExpired(i,r)});switch(t[1]){case 0:return t[2];case 1:return!0}})},updateIfNeedPerSub:function(n,e){for(var i=this,t=Promise.resolve([]),r=it.splitUsingMaxCount(e,100),a=0;a<r.length;){var o=[r[a]];++a,t=t.then(function(t){return function(e){return i.api.getPresences(n,t[0])}}(o))}t.catch(function(e){})},__class__:Ne});var Ae=function(){L.call(this)};(n["albero.command.UrlCommand"]=Ae).__name__=["albero","command","UrlCommand"],Ae.__super__=L,Ae.prototype=i(L.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.routing.forward(n);break;case 1:var i=t[2];this.routing.redirect(i);break;case 2:this.routing.back()}},__class__:Ae});var be=n["albero.command.UrlAction"]={__ename__:["albero","command","UrlAction"],__constructs__:["FORWARD","REDIRECT","BACK"]};be.FORWARD=function(e){var t=["FORWARD",0,e];return t.__enum__=be,t.toString=s,t},be.REDIRECT=function(e){var t=["REDIRECT",1,e];return t.__enum__=be,t.toString=s,t},be.BACK=["BACK",2],be.BACK.toString=s,(be.BACK.__enum__=be).__empty_constructs__=[be.BACK];function De(e,t,n){this.email=e,this.pass=t,this.accessToken=n}(n["albero.entity.Account"]=De).__name__=["albero","entity","Account"],De.prototype={__class__:De};function ot(e){null!=e&&(this.id=e.id,this.group=new ke(e.group),this.profilePolicy=new Ce(e.profile_policy))}(n["albero.entity.AccountControlGroup"]=ot).__name__=["albero","entity","AccountControlGroup"],ot.prototype={isAllowedUpdateProfileImage:function(){return null==this.profilePolicy||this.profilePolicy.allowUpdateProfileImage},isAllowedUpdateDisplayName:function(){return null==this.profilePolicy||this.profilePolicy.allowUpdateDisplayName},__class__:ot};var ke=function(e){null!=e&&(this.name=e.name,this.alias=e.alias,this.ownerName=e.owner_name,this.version=e.version)};(n["albero.entity.AccountControlGroupGroup"]=ke).__name__=["albero","entity","AccountControlGroupGroup"],ke.prototype={__class__:ke};var Ce=function(e){null!=e&&(this.allowUpdateDisplayName=e.allow_update_display_name,this.allowUpdateProfileImage=e.allow_update_profile_image,this.version=e.version)};(n["albero.entity.AccountControlGroupProfilePolicy"]=Ce).__name__=["albero","entity","AccountControlGroupProfilePolicy"],Ce.prototype={__class__:Ce};function st(e){null!=e&&(this.id=e.id,null!=e.group&&(this.group=new ke(e.group)),null!=e.profile_policy&&(this.profilePolicy=new Ce(e.profile_policy)))}(n["albero.entity.AccountControlGroupPartialUpdate"]=st).__name__=["albero","entity","AccountControlGroupPartialUpdate"],st.prototype={__class__:st};function lt(e){null!=e&&(this.id=it.fromIntOrInt64(e.id),this.groupName=e.group_name,this.groupOwnerName=e.group_owner_name,this.groupOwnerEmail=e.group_owner_email,this.hasDomainInvite=e.has_domain_invite,this.updatedAt=e.updated_at,this.version=e.version)}(n["albero.entity.AccountControlRequest"]=lt).__name__=["albero","entity","AccountControlRequest"],lt.prototype={__class__:lt};var Oe=n["albero.entity.AllowAttachmentTypeValue"]={__ename__:["albero","entity","AllowAttachmentTypeValue"],__constructs__:["ng","ok","image","imageOrVideo","imageOrVideoOrAudio","other"]};Oe.ng=["ng",0],Oe.ng.toString=s,(Oe.ng.__enum__=Oe).ok=["ok",1],Oe.ok.toString=s,(Oe.ok.__enum__=Oe).image=["image",2],Oe.image.toString=s,(Oe.image.__enum__=Oe).imageOrVideo=["imageOrVideo",3],Oe.imageOrVideo.toString=s,(Oe.imageOrVideo.__enum__=Oe).imageOrVideoOrAudio=["imageOrVideoOrAudio",4],Oe.imageOrVideoOrAudio.toString=s,(Oe.imageOrVideoOrAudio.__enum__=Oe).other=["other",5],Oe.other.toString=s,(Oe.other.__enum__=Oe).__empty_constructs__=[Oe.ng,Oe.ok,Oe.image,Oe.imageOrVideo,Oe.imageOrVideoOrAudio,Oe.other];function Me(e){this.value=e}(n["albero.entity.AllowAttachmentType"]=Me).__name__=["albero","entity","AllowAttachmentType"],Me.fromInt=function(e){if(null==e)return new Me(Oe.other);var t;if(null==e)t=Oe.other;else switch(e){case 0:t=Oe.ng;break;case 1:t=Oe.ok;break;case 2:t=Oe.image;break;case 3:t=Oe.imageOrVideo;break;case 4:t=Oe.imageOrVideoOrAudio;break;default:t=Oe.other}return new Me(t)},Me.fromValue=function(e){return new Me(e)},Me.createAttachmentErrorMessage=function(e,t,n){return null==n&&(n=""),0<e.compareStrongness(t)?e.createAttachmentErrorMessageByNetwork(n):t.createAttachmentErrorMessageByDomain(n)},Me.prototype={compareStrongness:function(e){return this.getStrongness()-e.getStrongness()},getStrongness:function(){switch(this.value[1]){case 0:return 40;case 2:return 30;case 3:return 20;case 4:return 10;case 1:case 5:return 0}},createAttachmentErrorMessageByDomain:function(e){switch(null==e&&(e=""),this.value[1]){case 0:return Hi.localize("AllowAttachmentType.ban_attach_file")+e;case 2:return Hi.localize("AllowAttachmentType.ban_attach_file_without_img")+e;case 3:return Hi.localize("AllowAttachmentType.ban_attach_file_without_img_movie")+e;case 4:return Hi.localize("AllowAttachmentType.ban_attach_file_without_img_movie_sound")+e;default:return""}},createAttachmentErrorMessageByNetwork:function(e){switch(null==e&&(e=""),this.value[1]){case 0:return Hi.localize("AllowAttachmentType.network_ban_attach_file")+e;case 2:return Hi.localize("AllowAttachmentType.network_ban_attach_file_without_img")+e;case 3:return Hi.localize("AllowAttachmentType.network_ban_attach_file_without_img_movie")+e;case 4:return Hi.localize("AllowAttachmentType.network_ban_attach_file_without_img_movie_sound")+e;default:return""}},createAttachmentFilter:function(){switch(this.value[1]){case 0:return function(e){return!1};case 2:return function(e){return new y("image.*","").match(e.type)};case 3:return function(e){return new y("image.*|video.*","").match(e.type)};case 4:return function(e){return new y("image.*|video.*|audio.*","").match(e.type)};default:return function(e){return!0}}},createDataTransferItemFilter:function(){switch(this.value[1]){case 0:return function(e){return!1};case 2:var t=new y("image.*","");return function(e){return t.match(e.type)};case 3:var n=new y("image.*|video.*","");return function(e){return n.match(e.type)};case 4:var i=new y("image.*|video.*|audio.*","");return function(e){return i.match(e.type)};default:return function(e){return!0}}},__class__:Me};function ut(e){null!=e&&(this.id=e.announcement_id,this.domainId=e.domain_id,this.groupId=e.group_id,this.groupName=e.group_name,this.type=Mt.typeOf(e.type),this.content=e.content,this.userId=e.user_id,this.userName=e.user_name,this.createdAt=e.created_at)}(n["albero.entity.Announcement"]=ut).__name__=["albero","entity","Announcement"],ut.prototype={getDisplayTextWithoutEscape:function(){return Mt.getDisplayTextWithoutEscape(this.type,this.content)},getNotificatoinTextWithoutEscape:function(e){switch(null==e&&(e=this.userName),null==e&&(e=""),this.type[1]){case 1:case 7:return e+":"+this.getDisplayTextWithoutEscape();default:return ji._e("["+tt.dateStr(new Date)+"] ","Unsupported announcement.type is detected. announcment:%o",this,"","",""),Mt.getUnsupportText()}},__class__:ut};function Re(e){this.unreadCount=0,null!=e&&(this.domainId=e.domain_id,this.unreadCount=null!=e.unread_count?e.unread_count:0,this.maxAnnouncementId=e.max_announcement_id,null!=e.max_announcement&&(this.maxAnnouncement=new ut(e.max_announcement)),this.maxReadAnnouncementId=e.max_read_announcement_id)}(n["albero.entity.AnnouncementStatus"]=Re).__name__=["albero","entity","AnnouncementStatus"],Re.prototype={updateReadWithStatusUpdate:function(e){var t=0,n=null;if(null!=e.readAnnouncementIds)for(var i=0,r=e.readAnnouncementIds;i<r.length;){var a,o=r[i];if(++i,null!=this.maxReadAnnouncementId){var s=this.maxReadAnnouncementId,l=o.high-s.high|0;l=0!=l?l:ga.ucompare(o.low,s.low),a=0<(o.high<0?s.high<0?l:-1:0<=s.high?l:1)}else a=!0;if(a){var u;if(null!=n){var c=o.high-n.high|0;c=0!=c?c:ga.ucompare(o.low,n.low),u=0<(o.high<0?n.high<0?c:-1:0<=n.high?c:1)}else u=!0;u&&(n=o),++t}}null!=n&&this.read(n,t)},read:function(e,t){this.maxReadAnnouncementId=e,this.unreadCount-=t,this.unreadCount<0&&(this.unreadCount=0);var n=this.domainId,i=this.maxReadAnnouncementId,r=this.unreadCount;ji._d("["+tt.dateStr(new Date)+"] ","Announcement status is updated. [domainId, maxReadAnnoundementId, unreadCount]:",n,i,r,"")},readAll:function(){this.maxReadAnnouncementId=this.maxAnnouncementId,this.unreadCount=0},__class__:Re};var ct=function(){};(n["albero.entity.AnnouncementStatusHelper"]=ct).__name__=["albero","entity","AnnouncementStatusHelper"],ct.isUnreadAnnouncementExisted=function(e){if(null==e)return!1;if(null==e.maxAnnouncement)return!1;if(null==e.maxReadAnnouncementId)return!0;var t=e.maxAnnouncement.id,n=e.maxReadAnnouncementId,i=t.high-n.high|0;return i=0!=i?i:ga.ucompare(t.low,n.low),0<(t.high<0?n.high<0?i:-1:0<=n.high?i:1)},ct.isUnread=function(e,t){if(null==e.maxReadAnnouncementId)return!0;var n=e.maxReadAnnouncementId,i=n.high-t.high|0;return i=0!=i?i:ga.ucompare(n.low,t.low),(n.high<0?t.high<0?i:-1:0<=t.high?i:1)<0},ct.isNewMax=function(e,t){if(null==e.maxAnnouncementId)return!0;var n=e.maxAnnouncementId,i=n.high-t.high|0;return i=0!=i?i:ga.ucompare(n.low,t.low),(n.high<0?t.high<0?i:-1:0<=t.high?i:1)<0},ct.isMax=function(e,t){if(null==e.maxAnnouncementId)return!1;var n=e.maxAnnouncementId;return null!=n&&null!=t&&n.high==t.high&&n.low==t.low},ct.hasAnnouncement=function(e,t){return!(null==e||!e.role.allowReadAnnouncements||null==t)&&null!=t.maxAnnouncementId};function _t(e){null!=e&&(this.domainId=e.domain_id,this.readAnnouncementIds=e.read_announcement_ids)}(n["albero.entity.AnnouncementStatusUpdate"]=_t).__name__=["albero","entity","AnnouncementStatusUpdate"],_t.prototype={__class__:_t};function Fe(e){if(this.notificationInvisibleTalkSound=!0,this.notificationInvisibleTalkPopup=!1,this.notificationVisibleTalkSound=!1,this.notificationVisibleTalkPopup=!1,this.notificationIncludingMessageContent=!0,this.talkAutoScroll=1,this.keywordWatchingText="",this.keywordWatchingEmphasis=!1,this.keywordWatchingSelfMessage=!1,this.keywordWatchingActionReply=!1,this.userDataContainer=[],this.language="ja",this.conferenceIncomingSound=!0,null!=e){if(null!=e.notificationInvisibleTalkSound&&(this.notificationInvisibleTalkSound=e.notificationInvisibleTalkSound),null!=e.notificationInvisibleTalkPopup&&(this.notificationInvisibleTalkPopup=e.notificationInvisibleTalkPopup),null!=e.notificationVisibleTalkSound&&(this.notificationVisibleTalkSound=e.notificationVisibleTalkSound),null!=e.notificationVisibleTalkPopup&&(this.notificationVisibleTalkPopup=e.notificationVisibleTalkPopup),null!=e.notificationIncludingMessageContent&&(this.notificationIncludingMessageContent=e.notificationIncludingMessageContent),null!=e.notificationVisibleTalkAutoScroll&&(this.talkAutoScroll=e.notificationVisibleTalkAutoScroll?1:3),null!=e.talkAutoScroll&&(this.talkAutoScroll=e.talkAutoScroll),null!=e.keywordWatchingText&&(this.keywordWatchingText=e.keywordWatchingText),null!=e.keywordWatchingEmphasis&&(this.keywordWatchingEmphasis=e.keywordWatchingEmphasis),null!=e.keywordWatchingSelfMessage&&(this.keywordWatchingSelfMessage=e.keywordWatchingSelfMessage),null!=e.keywordWatchingActionReply&&(this.keywordWatchingActionReply=e.keywordWatchingActionReply),null!=e.userDataContainer)for(var t=0,n=Ga.__cast(e.userDataContainer,Array);t<n.length;){var i=n[t];++t,this.userDataContainer.push(xe.fromJson(i))}null!=e.language&&(this.language=e.language),null!=e.conferenceIncomingSound&&(this.conferenceIncomingSound=e.conferenceIncomingSound)}}(n["albero.entity.BrowserSettings"]=Fe).__name__=["albero","entity","BrowserSettings"],Fe.fromJson=function(e){return new Fe(e)},Fe.prototype={createCopy:function(){var e=new Fe(null);return this.copyTo(e),e},equalNotificationSettings:function(e){return e.notificationInvisibleTalkSound==this.notificationInvisibleTalkSound&&e.notificationInvisibleTalkPopup==this.notificationInvisibleTalkPopup&&e.notificationVisibleTalkSound==this.notificationVisibleTalkSound&&e.notificationVisibleTalkPopup==this.notificationVisibleTalkPopup&&e.notificationIncludingMessageContent==this.notificationIncludingMessageContent},equalTalkSettings:function(e){return e.talkAutoScroll==this.talkAutoScroll},equalKeywordWatching:function(e){return e.keywordWatchingText==this.keywordWatchingText&&e.keywordWatchingEmphasis==this.keywordWatchingEmphasis&&e.keywordWatchingSelfMessage==this.keywordWatchingSelfMessage&&e.keywordWatchingActionReply==this.keywordWatchingActionReply},equalLanguageSettings:function(e){return e.language==this.language},equalConferenceSettings:function(e){return e.conferenceIncomingSound==this.conferenceIncomingSound},equalUserData:function(e,t){var n=e.getUserData(t),i=this.getUserData(t);if(null==n||null==n)return!0;var r=i.stampHistories.length;if(n.stampHistories.length!=r)return!0;for(var a=0,o=r;a<o;){var s=a++;if(!Ue.eq(n.stampHistories[s],i.stampHistories[s]))return!0}return!1},copyTo:function(e){this.copyNotificationSettingsTo(e),this.copyKeywordSettingsTo(e),this.copyTalkSettingsTo(e),this.copyUserDataContainerTo(e),this.copyLanguageSettingsTo(e),this.copyConferenceSettingsTo(e)},copyNotificationSettingsTo:function(e){e.notificationInvisibleTalkSound=this.notificationInvisibleTalkSound,e.notificationInvisibleTalkPopup=this.notificationInvisibleTalkPopup,e.notificationVisibleTalkSound=this.notificationVisibleTalkSound,e.notificationVisibleTalkPopup=this.notificationVisibleTalkPopup,e.notificationIncludingMessageContent=this.notificationIncludingMessageContent},copyKeywordSettingsTo:function(e){e.keywordWatchingText=this.keywordWatchingText,e.keywordWatchingEmphasis=this.keywordWatchingEmphasis,e.keywordWatchingSelfMessage=this.keywordWatchingSelfMessage,e.keywordWatchingActionReply=this.keywordWatchingActionReply},copyTalkSettingsTo:function(e){e.talkAutoScroll=this.talkAutoScroll},copyUserDataContainerTo:function(e){e.userDataContainer=this.userDataContainer},getUserData:function(t){return nt.find(this.userDataContainer,function(e){return e.userIdString==t})},copyLanguageSettingsTo:function(e){e.language=this.language},copyConferenceSettingsTo:function(e){e.conferenceIncomingSound=this.conferenceIncomingSound},assureUserData:function(e){var t=this.getUserData(e);return null==t&&(t=xe.fromUserIdString(e),this.userDataContainer.push(t)),t},isThumbnailExpansionEnabled:function(e){var t=this.getUserData(e);return null!=t&&t.useThumbnailExpansion},setThumbnailExpansionEnabled:function(e,t){this.assureUserData(e).useThumbnailExpansion=t},setPrevSelectedMic:function(e,t){var n=this.assureUserData(e);null==n.prevSelectedDevice?n.prevSelectedDevice={mic:t,speaker:"",camera:""}:n.prevSelectedDevice.mic=t},setPrevSelectedSpeaker:function(e,t){var n=this.assureUserData(e);null==n.prevSelectedDevice?n.prevSelectedDevice={mic:"",speaker:t,camera:""}:n.prevSelectedDevice.speaker=t},setPrevSelectedCamera:function(e,t){var n=this.assureUserData(e);null==n.prevSelectedDevice?n.prevSelectedDevice={mic:"",speaker:"",camera:t}:n.prevSelectedDevice.camera=t},getPrevSelectedDevice:function(e){var t=this.getUserData(e);return null==t||null==t.prevSelectedDevice?{mic:"",speaker:"",camera:""}:t.prevSelectedDevice},getStampHistories:function(e){var t=this.getUserData(e);return null==t?[]:t.stampHistories},addUsedStampJson:function(e,t){var n=this.assureUserData(e),i=n.stampHistories.filter(function(e){return!Ue.eq(t,e)});i.unshift(t),n.stampHistories=i.slice(0,Ue.MAX_SIZE)},isJaMode:function(){return null==this.language||"ja"==this.language},__class__:Fe};var xe=function(){};(n["albero.entity.UserData"]=xe).__name__=["albero","entity","UserData"],xe.fromUserIdString=function(e){var t=new xe;return t.userIdString=e,t.stampHistories=[],t.useThumbnailExpansion=!1,t.prevSelectedDevice={mic:"",speaker:"",camera:""},t},xe.fromJson=function(e){var t=new xe;return null!=e&&(null!=e.userIdString&&(t.userIdString=e.userIdString),null!=e.stampHistories&&(t.stampHistories=e.stampHistories.map(Ue.migrate)),null!=e.useThumbnailExpansion&&(t.useThumbnailExpansion=e.useThumbnailExpansion),null!=e.prevSelectedDevice&&(t.prevSelectedDevice=e.prevSelectedDevice)),t},xe.prototype={__class__:xe};var Ue=function(){};(n["albero.entity.StampHisory"]=Ue).__name__=["albero","entity","StampHisory"],Ue.migrate=function(e){return"string"==typeof e?{commonStampId:e}:e},Ue.eq=function(e,t){return null==e||null==t?e!=t:null!=e.commonStampId&&null!=t.commonStampId?e.commonStampId==t.commonStampId:null!=e.originalStamp&&null!=t.originalStamp&&e.originalStamp.stampIdStr==t.originalStamp.stampIdStr};function ht(e){null!=e&&(this.userId=e.user_id,this.id=e.conference_id,this.domainId=e.domain_id,this.talkId=e.talk_id,this.messageId=e.message_id,this.createdAt=e.created_at,this.expiredAt=e.expired_at,this.participants=e.participants)}(n["albero.entity.Conference"]=ht).__name__=["albero","entity","Conference"],ht.prototype={isIncomingExpired:function(){var e=this.createdAt,t=4294967296,n=e.high,i=e.low;return n*t+(0<=i?i:i+t)+ht.INCOMING_TIME<(new Date).getTime()},isExpired:function(){var e=this.expiredAt,t=4294967296,n=e.high,i=e.low;return n*t+(0<=i?i:i+t)<(new Date).getTime()},__class__:ht};var Pe=function(e){null!=e&&(this.maxFriends=e.max_friends,this.maxTalks=e.max_talks,this.maxTalkers=e.max_talkers,this.maxMessageContentLength=e.max_message_content_length,this.botExpiredVersion=e.bot_expired_version,this.presenceExpiration=null!=e.presence_expiration?e.presence_expiration:Pe.DEFAULT_PRESENCE_EXPIRATION,this.allowAttachmentType=Me.fromInt(e.allow_attachment_type),this.imageSanitizationEnabled=!!e.image_sanitization_enabled)};(n["albero.entity.Configuration"]=Pe).__name__=["albero","entity","Configuration"],Pe.prototype={__class__:Pe};function Le(e){this.contractConference=Ca.None,null!=e&&(this.id=e.contract_id,this.plan=new Yt(e.plan),this.quota=new tn(e.quota),this.solutionIds=e.solution_ids,null!=e.conference&&(this.contractConference=Ca.Some(new Be(e.conference))))}(n["albero.entity.Contract"]=Le).__name__=["albero","entity","Contract"],Le.prototype={getMaxMessageContentLength:function(){return at.map(at.option(this.quota),function(e){return e.maxMessageContentLength})},getMaxTalkers:function(){return at.flatMap(at.option(this.quota),function(e){return at.option(e.maxTalkers)})},getMaxTalks:function(){return at.flatMap(at.option(this.quota),function(e){return at.option(e.maxTalks)})},isConferenceEnalbed:function(){return at.isDefined(this.contractConference)},isVideoEnalbed:function(){var e=at.map(this.contractConference,function(e){return e.videoEnabled});switch(e[1]){case 0:return e[2];case 1:return!1}},getConferenceTtl:function(){return at.map(this.contractConference,function(e){return e.ttl})},getConferenceMaxParticipants:function(){return at.map(this.contractConference,function(e){return e.maxConferenceParticipants})},isGroupConfenreceEnalbed:function(){var e=at.map(this.contractConference,function(e){return e.groupConferenceEnabled});switch(e[1]){case 0:return e[2];case 1:return!1}},isTargetOfPlanAd:function(){return null!=this.quota&&this.quota.withAd},isFreePlan:function(){return null!=this.plan&&this.plan.free},__class__:Le};var Be=function(e){this.groupConferenceEnabled=!1,this.maxConferenceParticipants=Be.DEFAULT_MAX_PARTICIPANTS,this.ttl=Be.DEFAULT_TTL,this.videoEnabled=!1,null!=e&&(this.videoEnabled=e.video_enabled,this.ttl=e.ttl,this.maxConferenceParticipants=e.max_conference_participants,this.groupConferenceEnabled=e.group_conference_enabled)};(n["albero.entity.ContractConference"]=Be).__name__=["albero","entity","ContractConference"],Be.prototype={__class__:Be};var He=function(e){if(null!=e){switch(this.id=e.department_id,this.order=e.order,this.parentId=e.parent,this.nodeType=null==e.node?Ye.Normal:this.parseDepartmentNodeType(e.node),this.nodeType[1]){case 0:this.name=e.name;break;case 1:this.name=He.getLabelRoot();break;case 2:this.name=He.getLabelFree()}this.depth=0,this.childrenIds=null,this.userCount=null,this.userIds=null,this.userCountLoading=!1}};(n["albero.entity.Department"]=He).__name__=["albero","entity","Department"],He.getLabelFree=function(){return Hi.localize("Department.label_free")},He.getLabelRoot=function(){return Hi.localize("Department.label_root")},He.prototype={addChild:function(e){null==this.childrenIds&&(this.childrenIds=[]),this.childrenIds.push(e)},isRoot:function(){return this.nodeType==Ye.Root},isFree:function(){return this.nodeType==Ye.Free},parseDepartmentNodeType:function(e){switch(e){case 1:return Ye.Root;case 2:return Ye.Free;default:return Ye.Normal}},__class__:He};function je(){}(n["albero.entity.DepartmentHelper"]=je).__name__=["albero","entity","DepartmentHelper"],je.getName=function(e){return null==e?null:e.name};var Ye=n["albero.entity.DepartmentNodeType"]={__ename__:["albero","entity","DepartmentNodeType"],__constructs__:["Normal","Root","Free"]};Ye.Normal=["Normal",0],Ye.Normal.toString=s,(Ye.Normal.__enum__=Ye).Root=["Root",1],Ye.Root.toString=s,(Ye.Root.__enum__=Ye).Free=["Free",2],Ye.Free.toString=s,(Ye.Free.__enum__=Ye).__empty_constructs__=[Ye.Normal,Ye.Root,Ye.Free];function ze(e){null!=e&&(this.domainId=e.domain_id,this.departments=this.getDepartments(e.departments))}(n["albero.entity.DepartmentList"]=ze).__name__=["albero","entity","DepartmentList"],ze.prototype={getDepartments:function(e){return null==e?[]:e.map(function(e){return new He(e)})},__class__:ze};function Ge(e){null!=e&&(this.departmentId=e.department_id,this.all=e.all,this.partial=e.partial)}(n["albero.entity.DepartmentUserCount"]=Ge).__name__=["albero","entity","DepartmentUserCount"],Ge.prototype={__class__:Ge};function Ke(e){null!=e&&(this.departments=this.getDepartmentUserCounts(e.departments))}(n["albero.entity.DepartmentUserCountList"]=Ke).__name__=["albero","entity","DepartmentUserCountList"],Ke.prototype={getDepartmentUserCounts:function(e){return null==e?[]:e.map(function(e){return new Ge(e)})},__class__:Ke};function dt(e){null!=e&&(this.id=e.domain_id,this.updatedAt=e.updated_at,this.domainInfo=new We(e.domain),this.contract=new Le(e.contract),this.profileDefinition=new Gt(e.profile_definition),this.setting=new Ve(e.setting),this.role=new Qe(e.role),this.stampsetSetting=new Sn(e.stampset_setting),this.closed=!1)}(n["albero.entity.Domain"]=dt).__name__=["albero","entity","Domain"],dt.isChangedContractTreeEnabled=function(e,t){return dt.isDepartmentEnabled(e)!=dt.isDepartmentEnabled(t)},dt.isDepartmentEnabled=function(e){return null!=e&&(!!dt.isAllowListUser(e)&&!!e.setting.contactTreeEnabled)},dt.isAllowListUser=function(e){return null==e||e.role.allowListUsers},dt.isChangedRoleType=function(e,t){return(null==e?Je.user:e.role.type)!=(null==t?Je.user:t.role.type)},dt.isChangedMaxTalkers=function(e,t){var n,i,r=at.flatMap(at.option(e),function(e){return e.getMaxTalkers()});switch(r[1]){case 0:n=r[2];break;case 1:n=0}var a=at.flatMap(at.option(t),function(e){return e.getMaxTalkers()});switch(a[1]){case 0:i=a[2];break;case 1:i=0}return n!=i},dt.isAllowReadAnnouncement=function(e){return null!=e&&!!e.role.allowReadAnnouncements},dt.isSolutionChanged=function(e,t){var n=dt.getSolutionIds(e),i=dt.getSolutionIds(t);if(null==n&&null==i)return!1;if(null==n||null==i)return!0;if(n.length!=i.length)return!0;for(var r=0,a=n.length;r<a;){var o=r++;if(n[o]!=i[o])return!0}return!1},dt.getSolutionIds=function(e){return null==e||null==e.contract?null:e.contract.solutionIds},dt.isForwardTypeChanged=function(e,t){return null==e||e.setting.allowForwardMessageType!=t.setting.allowForwardMessageType},dt.isSaveAllowedChanged=function(e,t,n){return(null==e||e.isSaveAllowed(n))!=(null==t||t.isSaveAllowed(n))},dt.prototype={getMaxMessageContentLengthOrElse:function(e){var t=at.flatMap(at.option(this.contract),function(e){return e.getMaxMessageContentLength()});switch(t[1]){case 0:return t[2];case 1:return e}},getMaxTalkers:function(){return at.flatMap(at.option(this.contract),function(e){return e.getMaxTalkers()})},getMaxTalks:function(){return at.flatMap(at.option(this.contract),function(e){return e.getMaxTalks()})},isSaveAllowed:function(e){return e?this.setting.allowSaveAttachments.desktop:this.setting.allowSaveAttachments.web},isFreePlan:function(){return null!=this.contract&&this.contract.isFreePlan()},isTargetOfPlanAd:function(){return null!=this.contract&&this.contract.isTargetOfPlanAd()},isMyOwnDomain:function(){return this.role.isOwner()},updateStampsetSetting:function(e){e.isNewerThan(this.stampsetSetting)&&(this.stampsetSetting=e)},updateStampsetInfo:function(e){this.stampsetSetting.updateStampsetInfo(e)},deleteStampsetInfo:function(e){this.stampsetSetting.deleteStampsetInfo(e)},__class__:dt};var We=function(e){null!=e&&(this.name=e.domain_name,this.logoUrl=e.logo_url,this.frozen=e.frozen)};(n["albero.entity.DomainInfo"]=We).__name__=["albero","entity","DomainInfo"],We.prototype={__class__:We};var Ve=function(e){null!=e&&(this.allowAttachmentType=Me.fromInt(e.allow_attachment_type),this.allowSaveAttachmentsToDevice=e.allow_save_attachments_to_device,null!=e.allow_save_attachments&&(this.allowSaveAttachments=new qe(e.allow_save_attachments)),this.allowForwardMessageType=this.allowForwardMessageTypeOf(e.allow_forward_message_type),this.contactTreeEnabled=!!e.contact_tree_enabled,this.dropboxIntegrationEnabled=!!e.dropbox_integration_enabled,this.boxIntegrationEnabled=!!e.box_integration_enabled)};(n["albero.entity.DomainSetting"]=Ve).__name__=["albero","entity","DomainSetting"],Ve.prototype={allowForwardMessageTypeOf:function(e){switch(e){case 0:return Xe.ng;case 1:return Xe.ok;case 2:return Xe.onlyTextOrStamp;default:return Xe.other}},__class__:Ve};var qe=function(e){null!=e&&(this.web=null==e.web||e.web,this.ios=null==e.ios||e.ios,this.android=null==e.android||e.android,this.desktop=null==e.desktop||e.desktop)};(n["albero.entity.DomainSettingAllowSaveAttachments"]=qe).__name__=["albero","entity","DomainSettingAllowSaveAttachments"],qe.prototype={__class__:qe};var Qe=function(e){if(null!=e){this.type=this.typeOf(e.type);var t=e.allow_guests;this.allowGuests=t||!0;var n=e.allow_create_attachments;this.allowCreateAttachments=n||!0;var i=e.allow_read_attachments;this.allowReadAttachments=i||!0;var r=e.allow_create_announcement;this.allowCreateAnnouncement=r&&r,this.allowReadAnnouncements=e.allow_read_announcements,null==this.allowReadAnnouncements&&(this.allowReadAnnouncements=!0),this.allowListUsers=e.allow_list_users,null==this.allowListUsers&&(this.allowListUsers=!0)}};(n["albero.entity.DomainRole"]=Qe).__name__=["albero","entity","DomainRole"],Qe.prototype={def:function(e,t){return e||t},typeOf:function(e){switch(e){case 10:return Je.owner;case 20:return Je.manager;case 30:return Je.user;default:return Je.guest}},isOwner:function(){return ee.enumEq(this.type,Je.owner)},__class__:Qe};var Je=n["albero.entity.DomainRoleType"]={__ename__:["albero","entity","DomainRoleType"],__constructs__:["owner","manager","user","guest"]};Je.owner=["owner",0],Je.owner.toString=s,(Je.owner.__enum__=Je).manager=["manager",1],Je.manager.toString=s,(Je.manager.__enum__=Je).user=["user",2],Je.user.toString=s,(Je.user.__enum__=Je).guest=["guest",3],Je.guest.toString=s,(Je.guest.__enum__=Je).__empty_constructs__=[Je.owner,Je.manager,Je.user,Je.guest];var Xe=n["albero.entity.DomainAllowForwardMessageType"]={__ename__:["albero","entity","DomainAllowForwardMessageType"],__constructs__:["ng","ok","onlyTextOrStamp","other"]};Xe.ng=["ng",0],Xe.ng.toString=s,(Xe.ng.__enum__=Xe).ok=["ok",1],Xe.ok.toString=s,(Xe.ok.__enum__=Xe).onlyTextOrStamp=["onlyTextOrStamp",2],Xe.onlyTextOrStamp.toString=s,(Xe.onlyTextOrStamp.__enum__=Xe).other=["other",3],Xe.other.toString=s,(Xe.other.__enum__=Xe).__empty_constructs__=[Xe.ng,Xe.ok,Xe.onlyTextOrStamp,Xe.other];function Ze(e){null!=e&&(this.domainId=e.domain_id,this.departments=e.departments)}(n["albero.entity.DomainDepartmentPath"]=Ze).__name__=["albero","entity","DomainDepartmentPath"],Ze.prototype={__class__:Ze};function ft(e){null!=e&&(this.id=e.domain_id,this.name=e.domain_name,this.accountControlRequestId=it.fromIntOrInt64(e.account_control_request_id),this.updatedAt=e.updated_at)}(n["albero.entity.DomainInvite"]=ft).__name__=["albero","entity","DomainInvite"],ft.prototype={__class__:ft};function $e(e){null!=e&&(this.id=e.user_id,this.status=e.status,this.displayName=e.display_name,this.canonicalDisplayName=e.canonical_display_name,this.phoneticDisplayName=e.phonetic_display_name,this.canonicalPhoneticDisplayName=e.canonical_phonetic_display_name,this.profileImageUrl=e.profile_image_url,this.updatedAt=e.updated_at)}(n["albero.entity.User"]=$e).__name__=["albero","entity","User"],$e.prototype={__class__:$e};function et(e){$e.call(this,e),null!=e&&(this.domainId=e.domain_id,null!=e.profile_contact&&(this.profileContact=Ga.__cast(e.profile_contact,Array).map(function(e){return new Wt(e)})),this.departments=e.departments)}(n["albero.entity.DomainUser"]=et).__name__=["albero","entity","DomainUser"],et.__super__=$e,et.prototype=i($e.prototype,{match:function(e,t){if(this.matchNameOrPhonetic(e))return!0;if(null!=this.profileContact&&null!=t.profileDefinition.itemDefinitions)for(var n=0,i=this.profileContact;n<i.length;){var r=i[n];++n;for(var a=0,o=t.profileDefinition.itemDefinitions;a<o.length;){var s=o[a];if(++a,s.profileItemId==r.profileItemId){if(s.visible&&10==s.group&&-1<r.canonicalValue.indexOf(e))return!0;break}}}return!1},matchNameOrPhonetic:function(e){if(k.isEmpty(e))return!0;if(k.isEmpty(this.canonicalDisplayName)){this.canonicalDisplayName=Vi.canonicalize(this.displayName);var t=this.canonicalDisplayName,n=this.displayName;ji._d("["+tt.dateStr(new Date)+"] ","create canonical display name from %s to %s.",t,n,"","")}return-1<this.canonicalDisplayName.indexOf(e)||null!=this.canonicalPhoneticDisplayName&&-1<this.canonicalPhoneticDisplayName.indexOf(e)},matchNameOrPhoneticRoman:function(e){if(this.matchNameOrPhonetic(e))return!0;if(k.isEmpty(this.canonicalDisplayNameRoman)){this.canonicalDisplayNameRoman=Vi.canonicalizeForRoman(this.displayName);var t=this.canonicalDisplayNameRoman,n=this.displayName;ji._d("["+tt.dateStr(new Date)+"] ","create canonical display name(roman) from %s to %s.",t,n,"","")}return-1<this.canonicalDisplayNameRoman.indexOf(e)||null!=this.canonicalPhoneticDisplayName&&(k.isEmpty(this.canonicalPhoneticDisplayNameRoman)&&(this.canonicalPhoneticDisplayNameRoman=Vi.canonicalizeForRoman(this.canonicalPhoneticDisplayName)),-1<this.canonicalPhoneticDisplayNameRoman.indexOf(e))},__class__:et});function mt(e){this.values=e}(n["albero.entity.Domains"]=mt).__name__=["albero","entity","Domains"],mt.prototype={orderByName:function(){var e=rt.sortAndReturn(this.values.map(pt.fromDomain),pt.compare).map(pt.toDomain);return new mt(e)},getOldestDomain:function(){return null==this.values||0==this.values.length?Ca.None:nt.fold(this.values,function(r,e){switch(at.filter(e,function(e){var t=e.id,n=r.id,i=t.high-n.high|0;return i=0!=i?i:ga.ucompare(t.low,n.low),(t.high<0?n.high<0?i:-1:0<=n.high?i:1)<=0})[1]){case 0:return at.filter(e,function(e){var t=e.id,n=r.id,i=t.high-n.high|0;return i=0!=i?i:ga.ucompare(t.low,n.low),(t.high<0?n.high<0?i:-1:0<=n.high?i:1)<=0});case 1:return Ca.Some(r)}},Ca.None)},__class__:mt};var pt=function(e){this.domain=e,this.name=e.domainInfo.name,this.canonicalizedName=Vi.canonicalize(this.name)};(n["albero.entity.DomainForSort"]=pt).__name__=["albero","entity","DomainForSort"],pt.fromDomain=function(e){return new pt(e)},pt.toDomain=function(e){return e.domain},pt.compare=function(e,t){var n=k.compare(e.canonicalizedName,t.canonicalizedName);return 0!=n?n:k.compare(e.name,t.name)},pt.prototype={__class__:pt};function gt(e){null!=e&&(this.fileId=e.file_id,this.url=e.get_url,this.headers=new vt(e.get_headers))}(n["albero.entity.DownloadAuth"]=gt).__name__=["albero","entity","DownloadAuth"],gt.prototype={__class__:gt};var vt=function(e){this.rawData=e};(n["albero.entity.DownloadAuthHeaders"]=vt).__name__=["albero","entity","DownloadAuthHeaders"],vt.prototype={__class__:vt};function yt(e){null!=e&&(this.domainId=e.domain_id,this.talkId=e.talk_id,this.orderInFavorites=e.order_in_favorites,this.favoriteVersion=e.favorite_version)}(n["albero.entity.FavoriteTalkEvent"]=yt).__name__=["albero","entity","FavoriteTalkEvent"],yt.prototype={__class__:yt};function St(e){this.uploadResult=wt.NONE,this.thumbnailDimension=Ca.None,null!=e&&(this.attachmentId=e.attachment_id,this.messageId=e.message_id,this.talkId=e.talk_id,this.id=e.file_id,this.userId=e.user_id,this.name=e.name,this.contentType=e.content_type,this.contentSize=e.content_size,this.url=e.url,this.thumbUrl=e.thumbnail_url,this.updatedAt=e.updated_at,this.file=e.file,this.localThumbInfo=e.localThumbInfo,this.thumbnailDimension=Ca.None,this.deleted=null!=e.deleted&&e.deleted)}(n["albero.entity.FileInfo"]=St).__name__=["albero","entity","FileInfo"],St.fromMessageAndFile=function(e,t){var n=new St;return n.messageId=e.id,n.talkId=e.talkId,n.userId=e.userId,n.updatedAt=e.createdAt,n.id=t.file_id,n.name=t.name,n.contentType=t.content_type,n.contentSize=t.content_size,n.url=t.url,n.thumbUrl=t.thumbnail_url,n.thumbnailDimension=null==t.thumbnail_dimension?Ca.None:Ca.Some(new Ln(t.thumbnail_dimension)),n.deleted=null!=t.deleted&&t.deleted,n.file=t.file,n.localThumbInfo=t.localThumbInfo,n},St.fromMessageAndFileWithFileId=function(e,t,n){var i=St.fromMessageAndFile(e,t);return i.id=n,i},St.prototype={isRemote:function(){return null==this.file},isUploaded:function(){if(this.isRemote())return!0;switch(this.uploadResult[1]){case 0:return!0;case 1:case 2:return!1}},isUploadFailed:function(){if(this.isRemote())return!1;switch(this.uploadResult[1]){case 1:return!0;case 0:case 2:return!1}},setUploadResult:function(e){this.uploadResult=e},isNotUploaded:function(){return!this.isUploaded()},hasThumb:function(){return null!=this.thumbUrl||this.hasLocalThumbInfo()},hasLocalThumbInfo:function(){return null!=this.localThumbInfo},hasLocalFile:function(){return null!=this.file},hasUrl:function(){return null!=this.url},isImage:function(){return W.startsWith(this.contentType,"image/")},isImageGif:function(){return W.startsWith(this.contentType,"image/gif")},isPdf:function(){return W.startsWith(this.contentType,"application/pdf")},isVideo:function(){return W.startsWith(this.contentType,"video/")},canDisplayAsThumb:function(){return!!this.hasThumb()||this.isImage()},getNoThumbText:function(){return null!=this.name?this.name:this.url},getUploadedFileData:function(){if(null==this.file){var e={url:this.url,content_type:this.contentType,content_size:this.contentSize,name:this.name,file_id:this.id};return null!=this.thumbUrl&&(e.thumbnail_url=this.thumbUrl),at.isDefined(this.thumbnailDimension)&&(e.thumbnail_dimension=at.get(this.thumbnailDimension)),e}var t=this.uploadResult;switch(t[1]){case 0:return t[2];case 1:case 2:return ji._e("["+tt.dateStr(new Date)+"] ","file not uploaded.","","","",""),null}},addLocalFile:function(e){this.file=e},addLocalThumbInfo:function(e){this.localThumbInfo=e},getUploadableFilePack:function(){return{file:this.file,thumb:this.localThumbInfo}},__class__:St};var wt=n["albero.entity.UploadResult"]={__ename__:["albero","entity","UploadResult"],__constructs__:["SUCCESS","FAILUER","NONE"]};wt.SUCCESS=function(e){var t=["SUCCESS",0,e];return t.__enum__=wt,t.toString=s,t},wt.FAILUER=["FAILUER",1],wt.FAILUER.toString=s,(wt.FAILUER.__enum__=wt).NONE=["NONE",2],wt.NONE.toString=s,(wt.NONE.__enum__=wt).__empty_constructs__=[wt.FAILUER,wt.NONE];function It(e){null!=e&&(this.messageId=e[0],this.talkId=e[1],this.fileId=e[2])}(n["albero.entity.FileInfoDeletion"]=It).__name__=["albero","entity","FileInfoDeletion"],It.prototype={__class__:It};function Tt(e){null!=e&&(this.talkId=e.talk_id,null!=e.messages&&(this.messages=Ga.__cast(e.messages,Array).map(function(e){return new Et(e)})))}(n["albero.entity.HitContext"]=Tt).__name__=["albero","entity","HitContext"],Tt.prototype={findHitMessage:function(n){return nt.find(this.messages,function(e){var t=e.id;return null!=t&&null!=n&&t.high==n.high&&t.low==n.low})},__class__:Tt};var Et=function(e){null!=e&&(this.id=e.message_id,this.talkId=e.talk_id,this.userId=e.user_id,this.type=Mt.typeOf(e.type),this.content=e.content,this.createdAt=e.created_at,this.hit=e.hit)};(n["albero.entity.HitMessage"]=Et).__name__=["albero","entity","HitMessage"],Et.prototype={__class__:Et};function Nt(){}(n["albero.entity.IdSpec"]=Nt).__name__=["albero","entity","IdSpec"],Nt.timestamp=function(e){var t=Nt.TIMESTAMP_SHIFT;return 0!=(t&=63)?t<32?new zn(e.high>>t,e.high<<32-t|e.low>>>t):new zn(e.high>>31,e.high>>t-32):new zn(e.high,e.low)},Nt.subTimestampPart=function(e,t){var n=Nt.timestamp(e),i=Nt.timestamp(t),r=n.high-i.high|0,a=n.low-i.low|0;if(ga.ucompare(n.low,i.low)<0){r--;r|=0}return new zn(r,a)},Nt.createForTest=function(e){var t=Nt.TIMESTAMP_SHIFT;return 0!=(t&=63)?t<32?new zn(e.high<<t|e.low>>>32-t,e.low<<t):new zn(e.low<<t-32,0):new zn(e.high,e.low)};function At(){}(n["albero.entity.IdValue"]=At).__name__=["albero","entity","IdValue"],At.prototype={__class__:At};function bt(e){null!=e&&(this.conferenceId=e.conference_id,this.roomName=e.room_name,this.credential=e.credential,this.mode=this.parseMode(e.mode),this.timestamp=e.timestamp)}(n["albero.entity.JoinConference"]=bt).__name__=["albero","entity","JoinConference"],bt.prototype={parseMode:function(e){return"sfu"==e?Dt.sfu:"fullMesh"==e?Dt.fullMesh:Dt.unknown},isSfu:function(e){switch(this.mode[1]){case 0:return!0;case 1:return!1;case 2:return e.type==Nn.GroupTalk}},getEllaspedSecOnJoin:function(){var e=it.fromIntOrInt64(this.credential.timestamp),t=it.fromIntOrInt64(this.timestamp),n=t.high-e.high|0,i=t.low-e.low|0;if(ga.ucompare(t.low,e.low)<0){n--;n|=0}var r=new zn(n,i);return r.high<0?0:0<r.high||this.credential.ttl<r.low?this.credential.ttl:r.low},__class__:bt};var Dt=n["albero.entity.JoinConferenceMode"]={__ename__:["albero","entity","JoinConferenceMode"],__constructs__:["sfu","fullMesh","unknown"]};Dt.sfu=["sfu",0],Dt.sfu.toString=s,(Dt.sfu.__enum__=Dt).fullMesh=["fullMesh",1],Dt.fullMesh.toString=s,(Dt.fullMesh.__enum__=Dt).unknown=["unknown",2],Dt.unknown.toString=s,(Dt.unknown.__enum__=Dt).__empty_constructs__=[Dt.sfu,Dt.fullMesh,Dt.unknown];var kt=n["albero.entity.LocalErrorType"]={__ename__:["albero","entity","LocalErrorType"],__constructs__:["TalksCountOvered","TalkersCountOvered","SendingMessageConflicted","DeletingMessageConflicted","UploadForbidden","UploadSizeOvered","StorageSizeOvered","GeneralFileError","UploadForbiddenForNote","UploadSizeOveredForNote","StorageSizeOveredForNote","GeneralFileErrorForNote","AddingSomeUsersFailure"]};kt.TalksCountOvered=function(e){var t=["TalksCountOvered",0,e];return t.__enum__=kt,t.toString=s,t},kt.TalkersCountOvered=function(e){var t=["TalkersCountOvered",1,e];return t.__enum__=kt,t.toString=s,t},kt.SendingMessageConflicted=["SendingMessageConflicted",2],kt.SendingMessageConflicted.toString=s,(kt.SendingMessageConflicted.__enum__=kt).DeletingMessageConflicted=["DeletingMessageConflicted",3],kt.DeletingMessageConflicted.toString=s,(kt.DeletingMessageConflicted.__enum__=kt).UploadForbidden=["UploadForbidden",4],kt.UploadForbidden.toString=s,(kt.UploadForbidden.__enum__=kt).UploadSizeOvered=function(e){var t=["UploadSizeOvered",5,e];return t.__enum__=kt,t.toString=s,t},kt.StorageSizeOvered=function(e){var t=["StorageSizeOvered",6,e];return t.__enum__=kt,t.toString=s,t},kt.GeneralFileError=["GeneralFileError",7],kt.GeneralFileError.toString=s,(kt.GeneralFileError.__enum__=kt).UploadForbiddenForNote=function(e){var t=["UploadForbiddenForNote",8,e];return t.__enum__=kt,t.toString=s,t},kt.UploadSizeOveredForNote=function(e,t){var n=["UploadSizeOveredForNote",9,e,t];return n.__enum__=kt,n.toString=s,n},kt.StorageSizeOveredForNote=function(e,t){var n=["StorageSizeOveredForNote",10,e,t];return n.__enum__=kt,n.toString=s,n},kt.GeneralFileErrorForNote=function(e){var t=["GeneralFileErrorForNote",11,e];return t.__enum__=kt,t.toString=s,t},kt.AddingSomeUsersFailure=["AddingSomeUsersFailure",12],kt.AddingSomeUsersFailure.toString=s,(kt.AddingSomeUsersFailure.__enum__=kt).__empty_constructs__=[kt.SendingMessageConflicted,kt.DeletingMessageConflicted,kt.UploadForbidden,kt.GeneralFileError,kt.AddingSomeUsersFailure];function Ct(){}(n["albero.entity.LocalErrorTypeMixin"]=Ct).__name__=["albero","entity","LocalErrorTypeMixin"],Ct.toMessage=function(e){switch(e[1]){case 0:var t=e[2];return Hi.localize("LocalErrorType.number_of_talks",{limitMax:t});case 1:var n=e[2];return Hi.localize("LocalErrorType.number_of_talkers",{limitMax:n});case 2:return Hi.localize("LocalErrorType.retry_sending");case 3:return Hi.localize("LocalErrorType.retry_deletion");case 4:return Hi.localize("LocalErrorType.file_forbidden");case 5:var i=e[2],r=N.createByteSizeStringWithUnit(i);return Hi.localize("LocalErrorType.file_size",{sizeString:r});case 6:var a=e[2],o=N.createByteSizeStringWithUnit(a);return Hi.localize("LocalErrorType.storage_size",{sizeString:o});case 7:case 11:return Hi.localize("LocalErrorType.file");case 8:return Hi.localize("LocalErrorType.file_forbidden_for_note");case 9:var s=e[2],l=N.createByteSizeStringWithUnit(s);return Hi.localize("LocalErrorType.file_size",{sizeString:l});case 10:var u=e[2],c=N.createByteSizeStringWithUnit(u);return Hi.localize("LocalErrorType.storage_size",{sizeString:c});case 12:return Hi.localize("LocalErrorType.adding_users")}},Ct.getNoteId=function(e){switch(e[1]){case 8:var t=e[2];return Ca.Some(t);case 9:var n=e[3];return Ca.Some(n);case 10:var i=e[3];return Ca.Some(i);case 11:var r=e[2];return Ca.Some(r);default:return Ca.None}},Ct.convertFileErrorForNote=function(e,t){if(null==t)return null;if(403==t.code)return kt.UploadForbiddenForNote(e);if(502==t.code&&null!=t.detail){var n=it.fromIntOrInt64(t.detail.limit_max);if("file_size"==t.detail.limit_target)return kt.UploadSizeOveredForNote(n,e);if("storage_size"==t.detail.limit_target)return kt.UploadSizeOveredForNote(n,e)}return kt.GeneralFileErrorForNote(e)};function Ot(e){$e.call(this,e),null!=e&&(this.email=e.email,this.signinId=e.signin_id,null!=e.profiles&&(this.profiles=Ga.__cast(e.profiles,Array).map(function(e){return new zt(e)})),null!=e.departments&&(this.departments=Ga.__cast(e.departments,Array).map(function(e){return new Ze(e)})))}(n["albero.entity.Me"]=Ot).__name__=["albero","entity","Me"],Ot.__super__=$e,Ot.prototype=i($e.prototype,{toDomainUser:function(e){var t=new et;if(t.id=this.id,t.status=this.status,t.domainId=e,t.displayName=this.displayName,t.canonicalDisplayName=this.canonicalDisplayName,t.phoneticDisplayName=this.phoneticDisplayName,t.canonicalPhoneticDisplayName=this.canonicalPhoneticDisplayName,t.profileImageUrl=this.profileImageUrl,t.updatedAt=this.updatedAt,t.email=this.email,null!=this.profiles)for(var n=0,i=this.profiles;n<i.length;){var r=i[n];++n;var a=r.domainId;if(null!=a&&null!=e&&a.high==e.high&&a.low==e.low){t.profileContact=r.itemValues;break}}if(null!=this.departments)for(var o=0,s=this.departments;o<s.length;){var l=s[o];++o;var u=l.domainId;if(null!=u&&null!=e&&u.high==e.high&&u.low==e.low){t.departments=l.departments;break}}return t},__class__:Ot});var Mt=function(e){if(null==e)return this.readUserIds=[],void(this.favorite=new pi(null));this.id=e.message_id,this.talkId=e.talk_id,this.userId=e.user_id,this.type=Mt.typeOf(e.type),this.content=e.content,this.createdAt=e.created_at,this.readCount=e.read_count,this.readUserIds=null==e.read_user_ids?[]:e.read_user_ids,this.isUnreadCountTarget=null==e.is_unread_count_target||e.is_unread_count_target,this.isBotMessage=null!=e.bot_message&&e.bot_message,this.favorite=new pi(e.favorite)};(n["albero.entity.Message"]=Mt).__name__=["albero","entity","Message"],Mt.typeOf=function(e){switch(e){case 0:return Rt.system;case 1:return Rt.text;case 2:return Rt.stamp;case 3:return Rt.geo;case 4:return Rt.file;case 5:return Rt.textMultipleFile;case 7:return Rt.deleted;case 8:return Rt.noteShared;case 9:return Rt.noteDeleted;case 10:return Rt.noteCreated;case 11:return Rt.noteUpdated;case 12:return Rt.originalStamp;case 500:return Rt.yesOrNo;case 501:return Rt.yesOrNoReply;case 502:return Rt.selectOne;case 503:return Rt.selectOneReply;case 504:return Rt.todo;case 505:return Rt.todoDone;case 506:return Rt.yesOrNoClosed;case 507:return Rt.selectOneClosed;case 508:return Rt.todoClosed;case 509:return Rt.openConference;case 600:return Rt.phoneCall;case 601:return Rt.phoneReceive;default:return Rt.unknown}},Mt.enumIndex=function(e){switch(e[1]){case 0:case 1:case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:return e[1];case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:return 500+e[1]-13;case 23:case 24:return 600+e[1]-23;default:return-1}},Mt.typeString=function(e){return K.string(e)},Mt.getDisplayTextWithoutEscape=function(e,t){switch(e[1]){case 1:return t;case 7:return Mt.getDeletedText();default:return ji._e("["+tt.dateStr(new Date)+"] ","Unsupported message.type is detected.",e,"","",""),Mt.getUnsupportText()}},Mt.getDeletedText=function(){return Hi.localize("MessageHelper.deleted")},Mt.getUnsupportText=function(){return Hi.localize("MessageHelper.not_support")},Mt.prototype={isDummy:function(){return null!=this.id&&this.id.high<0},messageStringForKeywordDetection:function(e){switch(this.type[1]){case 0:return"";case 1:return this.content;case 3:case 4:return"";case 5:return null!=this.content.text&&0<this.content.text.length?this.content.text:"";case 7:return"";case 2:case 12:return null!=this.content.text&&0<this.content.text.length?this.content.text:"";case 13:return[this.content.question,Hi.localize("MessageStringMaker.yes"),Hi.localize("MessageStringMaker.no")].join(" ");case 14:return e&&null!=this.content.response?this.content.response?Hi.localize("MessageStringMaker.yes"):Hi.localize("MessageStringMaker.no"):"";case 15:return null!=this.content.options?K.string(this.content.question)+" "+K.string(this.content.options.join(" ")):this.content.question;case 16:return e&&null!=this.content.response&&null!=this.content.options&&this.content.options.length>this.content.response?this.content.options[this.content.response]:"";case 17:return[this.content.title,Hi.localize("MessageStringMaker.achieve"),Hi.localize("MessageStringMaker.remand")].join(" ");case 18:return e&&null!=this.content.done?this.content.done?Hi.localize("MessageStringMaker.achieve"):Hi.localize("MessageStringMaker.remand"):"";case 19:case 20:case 21:default:return""}},messageStringForBookmarkWithEllipsis:function(){var e=this.messageStringForBookmark();return e.length<100?e:e.substring(0,99)+""},messageStringForBookmark:function(){switch(this.type[1]){case 1:return this.content;case 5:if(null!=this.content.text&&0<this.content.text.length)return this.content.text;break;case 7:return Hi.localize("Message.bookmark_label_deleted");case 8:return[Hi.localize("Message.bookmark_label_note_shared"),new ci(this.content).title].join(" ");case 10:return[Hi.localize("Message.bookmark_label_note_created"),new ci(this.content).title].join(" ");case 11:return[Hi.localize("Message.bookmark_label_note_updated"),new ci(this.content).title].join(" ");case 2:case 12:if(null!=this.content.text&&0<this.content.text.length)return[Hi.localize("Message.bookmark_label_stamp"),this.content.text].join(" ");break;case 14:case 16:return[Hi.localize("Message.bookmark_label_answer"),this.content.question].join(" ");case 13:case 15:return[Hi.localize("Message.bookmark_label_question"),this.content.question].join(" ");case 17:return[Hi.localize("Message.bookmark_label_task"),this.content.title].join(" ");case 18:return[this.content.done?Hi.localize("Message.bookmark_label_completed"):Hi.localize("Message.bookmark_label_reverted"),this.content.title].join(" ");case 19:case 20:return[Hi.localize("Message.bookmark_label_closed"),this.content.question].join(" ");case 21:return[Hi.localize("Message.bookmark_label_closed"),this.content.title].join(" ")}return""},getContentsForNote:function(){switch(this.type[1]){case 8:case 10:case 11:return new ci(this.content);default:return null}},getContentsForNoteDelete:function(){return 9==this.type[1]?new _i(this.content):null},getContentsForOriginalStamp:function(){return 12==this.type[1]?new hi(this.content):null},isAllowedToDelete:function(e){return!!(this.isSentBy(e)&&this.isNotSystemMessage()&&this.isNotActionStampMessage()&&this.isNotNoteMessage())&&this.isNotDeletedMessage()},isAllowedToReply:function(e){return!(!this.isNotSentBy(e)||!this.isNotSystemMessage())&&this.isNotDeletedMessage()},isAllowedToQuote:function(e){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotFileMessage()&&this.isNotStampMessageWithEmptyText())&&this.isNotTextMultipleFileWithEmptyText()},isAllowedToCopy:function(){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotFileMessage()&&this.isNotStampMessageWithEmptyText())&&this.isNotTextMultipleFileWithEmptyText()},isAllowedToForward:function(e){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotActionStampMessage()&&this.isNotDeletedFileMessage(e)&&this.isNotTextMultipleFileAllDeletedWithEmptyText(e)&&this.isNotNoteMessage())&&this.isNotOpenConference()},isAllowedToForwardOnOnlyTextOrStamp:function(){return!(!this.isTextMessage()&&!this.isStampMessage())||this.isTextMultipleFileWithText()},isAllowedToAddToFavorites:function(){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotOpenConference()&&this.isNotStampMessageWithEmptyText()&&this.isNotNoteDeletedMessage())&&this.isNotFavorite()},isAllowedToRemoveFromFavorites:function(){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotOpenConference()&&this.isNotStampMessageWithEmptyText()&&this.isNotNoteDeletedMessage())&&this.isFavorite()},isSentBy:function(e){var t=this.userId;return null!=e&&null!=t&&e.high==t.high&&e.low==t.low},isNotSentBy:function(e){return!this.isSentBy(e)},isSystemMessage:function(){return this.type==Rt.system},isNotSystemMessage:function(){return!this.isSystemMessage()},isActionStampMessage:function(){return this.type==Rt.yesOrNo||this.type==Rt.yesOrNoReply||this.type==Rt.selectOne||this.type==Rt.selectOneReply||this.type==Rt.todo||this.type==Rt.todoDone||this.type==Rt.yesOrNoClosed||this.type==Rt.selectOneClosed||this.type==Rt.todoClosed},isNotActionStampMessage:function(){return!this.isActionStampMessage()},isReplyActionStampMessage:function(){return this.type==Rt.selectOneReply||this.type==Rt.yesOrNoReply||this.type==Rt.todoDone},isClosedActionStampMessage:function(){return this.type==Rt.yesOrNoClosed||this.type==Rt.selectOneClosed||this.type==Rt.todoClosed},isSendingActionStampMessage:function(){return this.type==Rt.yesOrNo||this.type==Rt.selectOne||this.type==Rt.todo},isNoteMessage:function(){return this.type==Rt.noteShared||this.type==Rt.noteDeleted||this.type==Rt.noteCreated||this.type==Rt.noteUpdated},isNoteDeletedMessage:function(){return this.type==Rt.noteDeleted},isNotNoteMessage:function(){return!this.isNoteMessage()},isNotNoteDeletedMessage:function(){return!this.isNoteDeletedMessage()},isDeletedMessage:function(){return this.type==Rt.deleted},isNotDeletedMessage:function(){return!this.isDeletedMessage()},isFileMessage:function(){return this.type==Rt.file},isNotFileMessage:function(){return!this.isFileMessage()},isStampMessage:function(){return this.type==Rt.stamp||this.type==Rt.originalStamp},isNotStampMessage:function(){return!this.isStampMessage()},isStampMessageWithEmptyText:function(){return!!this.isStampMessage()&&this.isObjectWithEmptyText()},isNotStampMessageWithEmptyText:function(){return!!this.isNotStampMessage()||this.isNotObjectWithEmptyText()},isObjectWithEmptyText:function(){return k.isEmpty(this.content.text)},isNotObjectWithEmptyText:function(){return!this.isObjectWithEmptyText()},isTextMultipleFile:function(){return this.type==Rt.textMultipleFile},isNotTextMultipleFile:function(){return!this.isTextMultipleFile()},isTextMultipleFileWithText:function(){return!!this.isTextMultipleFile()&&this.isNotObjectWithEmptyText()},isTextMultipleFileWithEmptyText:function(){return!!this.isTextMultipleFile()&&this.isObjectWithEmptyText()},isNotTextMultipleFileWithEmptyText:function(){return!!this.isNotTextMultipleFile()||this.isNotObjectWithEmptyText()},isNotDeletedFileMessage:function(e){return!!this.isNotFileMessage()||!e},isNotTextMultipleFileAllDeletedWithEmptyText:function(e){return!!this.isNotTextMultipleFileWithEmptyText()||!e},isTextMessage:function(){return this.type==Rt.text},isOpenConference:function(){return this.type==Rt.openConference},isNotOpenConference:function(){return!this.isOpenConference()},getInReplyTo:function(){var e=this.type;return ji._i("["+tt.dateStr(new Date)+"] ",e,"","","",""),this.isReplyActionStampMessage()||this.isClosedActionStampMessage()?Ca.Some(this.content.in_reply_to):Ca.None},isNotFavorite:function(){return!this.isFavorite()},isFavorite:function(){return this.favorite.isFavorite()},isNotCalloutHolder:function(){return!(!this.isFileMessage()&&!this.isTextMultipleFileWithEmptyText())||this.isStampMessageWithEmptyText()},close:function(){this.content.closed=!0},updateFavorite:function(e){this.favorite.update(e)},addReadUsersUntillMaxCount:function(e){var t=this;if(!(16<=this.readUserIds.length)){var n=e.filter(function(e){return it.notContains(t.readUserIds,e)});this.readUserIds=this.readUserIds.concat(n).slice(0,16)}},createReadCountText:function(){return 16<=this.readUserIds.length?"15+":K.string(this.readUserIds.length)},hasNoReadUsers:function(){return 0==this.readUserIds.length},deleteFile:function(i){var e;switch(this.type[1]){case 4:e=[this.content];break;case 5:e=this.content.files;break;default:e=[]}if(0!=e.length){var t=nt.find(e,function(e){var t=e.file_id,n=i.fileId;return null!=t&&null!=n&&t.high==n.high&&t.low==n.low});null!=t&&(t.deleted=!0)}},getQuestionTitle:function(){switch(this.type[1]){case 17:case 18:case 21:return null==this.content.title?"":this.content.title;case 13:case 14:case 15:case 16:case 19:case 20:return null==this.content.question?"":this.content.question;default:return""}},getChoiceCloseResponse:function(n){var e=Hi.localize("QuestionHelper.close_answer")+"\n";if(null==this.content.responses)e+="...";else{var t=this.content.responses,i=this.content.last_response;if(0==$t.closingTypeOf(this.content.closing_type)[1])e+=null!=i?Hi.localize("QuestionHelper.last_response",{content:n(t[i].content),interpolation:{escapeValue:!1}}):Hi.localize("QuestionHelper.no_answer");else{e+=null!=i?null==t?"":t.map(function(e){var t=null==e.count?0:e.count;return n(e.content)+": "+t+Hi.localize("QuestionHelper.name")}).join("\n"):Hi.localize("QuestionHelper.no_answer")}}return e},getTodoCloseResponse:function(){var e=Hi.localize("QuestionHelper.close_task")+"\n";if(null==this.content.responses)e+="...";else{var t=this.content.responses,n=this.content.last_response;if(0==$t.closingTypeOf(this.content.closing_type)[1]){e+=null!=n&&"DONE"==t[n].content?Hi.localize("QuestionHelper.achieve_task"):Hi.localize("QuestionHelper.not_achieve_task")}else{var i=0;if(null!=t)for(var r=0;r<t.length;){var a=t[r];if(++r,"DONE"==a.content){i=null==a.count?0:a.count;break}}e+=0!=i?Hi.localize("QuestionHelper.completed")+": "+i+Hi.localize("QuestionHelper.name"):Hi.localize("QuestionHelper.no_achiever")}}return e},__class__:Mt};var Rt=n["albero.entity.MessageType"]={__ename__:["albero","entity","MessageType"],__constructs__:["system","text","stamp","geo","file","textMultipleFile","unused","deleted","noteShared","noteDeleted","noteCreated","noteUpdated","originalStamp","yesOrNo","yesOrNoReply","selectOne","selectOneReply","todo","todoDone","yesOrNoClosed","selectOneClosed","todoClosed","openConference","phoneCall","phoneReceive","unknown"]};Rt.system=["system",0],Rt.system.toString=s,(Rt.system.__enum__=Rt).text=["text",1],Rt.text.toString=s,(Rt.text.__enum__=Rt).stamp=["stamp",2],Rt.stamp.toString=s,(Rt.stamp.__enum__=Rt).geo=["geo",3],Rt.geo.toString=s,(Rt.geo.__enum__=Rt).file=["file",4],Rt.file.toString=s,(Rt.file.__enum__=Rt).textMultipleFile=["textMultipleFile",5],Rt.textMultipleFile.toString=s,(Rt.textMultipleFile.__enum__=Rt).unused=["unused",6],Rt.unused.toString=s,(Rt.unused.__enum__=Rt).deleted=["deleted",7],Rt.deleted.toString=s,(Rt.deleted.__enum__=Rt).noteShared=["noteShared",8],Rt.noteShared.toString=s,(Rt.noteShared.__enum__=Rt).noteDeleted=["noteDeleted",9],Rt.noteDeleted.toString=s,(Rt.noteDeleted.__enum__=Rt).noteCreated=["noteCreated",10],Rt.noteCreated.toString=s,(Rt.noteCreated.__enum__=Rt).noteUpdated=["noteUpdated",11],Rt.noteUpdated.toString=s,(Rt.noteUpdated.__enum__=Rt).originalStamp=["originalStamp",12],Rt.originalStamp.toString=s,(Rt.originalStamp.__enum__=Rt).yesOrNo=["yesOrNo",13],Rt.yesOrNo.toString=s,(Rt.yesOrNo.__enum__=Rt).yesOrNoReply=["yesOrNoReply",14],Rt.yesOrNoReply.toString=s,(Rt.yesOrNoReply.__enum__=Rt).selectOne=["selectOne",15],Rt.selectOne.toString=s,(Rt.selectOne.__enum__=Rt).selectOneReply=["selectOneReply",16],Rt.selectOneReply.toString=s,(Rt.selectOneReply.__enum__=Rt).todo=["todo",17],Rt.todo.toString=s,(Rt.todo.__enum__=Rt).todoDone=["todoDone",18],Rt.todoDone.toString=s,(Rt.todoDone.__enum__=Rt).yesOrNoClosed=["yesOrNoClosed",19],Rt.yesOrNoClosed.toString=s,(Rt.yesOrNoClosed.__enum__=Rt).selectOneClosed=["selectOneClosed",20],Rt.selectOneClosed.toString=s,(Rt.selectOneClosed.__enum__=Rt).todoClosed=["todoClosed",21],Rt.todoClosed.toString=s,(Rt.todoClosed.__enum__=Rt).openConference=["openConference",22],Rt.openConference.toString=s,(Rt.openConference.__enum__=Rt).phoneCall=["phoneCall",23],Rt.phoneCall.toString=s,(Rt.phoneCall.__enum__=Rt).phoneReceive=["phoneReceive",24],Rt.phoneReceive.toString=s,(Rt.phoneReceive.__enum__=Rt).unknown=["unknown",25],Rt.unknown.toString=s,(Rt.unknown.__enum__=Rt).__empty_constructs__=[Rt.system,Rt.text,Rt.stamp,Rt.geo,Rt.file,Rt.textMultipleFile,Rt.unused,Rt.deleted,Rt.noteShared,Rt.noteDeleted,Rt.noteCreated,Rt.noteUpdated,Rt.originalStamp,Rt.yesOrNo,Rt.yesOrNoReply,Rt.selectOne,Rt.selectOneReply,Rt.todo,Rt.todoDone,Rt.yesOrNoClosed,Rt.selectOneClosed,Rt.todoClosed,Rt.openConference,Rt.phoneCall,Rt.phoneReceive,Rt.unknown];function Ft(e){null!=e&&(this.talkId=e[0],this.messageId=e[1])}(n["albero.entity.MessageDeletion"]=Ft).__name__=["albero","entity","MessageDeletion"],Ft.prototype={__class__:Ft};function xt(e){this.id=e.message_id,this.talkId=e.talk_id,this.readUserIds=null==e.read_user_ids?[]:e.read_user_ids,this.unreadUserIds=null==e.unread_user_ids?[]:e.unread_user_ids}(n["albero.entity.MessageReadStatus"]=xt).__name__=["albero","entity","MessageReadStatus"],xt.prototype={__class__:xt};function Ut(e){this.talkId=e.talk_id,this.messageIds=e.message_ids,this.readUserIds=null==e.read_user_ids?[]:e.read_user_ids,this.messageIdsExcludingUnreadCountTargets=e.message_ids_excluding_unread_count_targets,null==this.messageIdsExcludingUnreadCountTargets&&(this.messageIdsExcludingUnreadCountTargets=[])}(n["albero.entity.MessageReadStatusesUpdate"]=Ut).__name__=["albero","entity","MessageReadStatusesUpdate"],Ut.prototype={__class__:Ut};var Pt=n["albero.entity.MessagesOrder"]={__ename__:["albero","entity","MessagesOrder"],__constructs__:["asc","desc"]};Pt.asc=["asc",0],Pt.asc.toString=s,(Pt.asc.__enum__=Pt).desc=["desc",1],Pt.desc.toString=s,(Pt.desc.__enum__=Pt).__empty_constructs__=[Pt.asc,Pt.desc];function Lt(){}(n["albero.entity.MessagesOrderProc"]=Lt).__name__=["albero","entity","MessagesOrderProc"],Lt.orderToInt=function(e){switch(e[1]){case 0:return 1;case 1:return 2}};var Bt=n["albero.entity.PaneType"]={__ename__:["albero","entity","PaneType"],__constructs__:["SingleTalkPane","MultiTalkPane1","MultiTalkPane2","MultiTalkPane3"]};Bt.SingleTalkPane=["SingleTalkPane",0],Bt.SingleTalkPane.toString=s,(Bt.SingleTalkPane.__enum__=Bt).MultiTalkPane1=["MultiTalkPane1",1],Bt.MultiTalkPane1.toString=s,(Bt.MultiTalkPane1.__enum__=Bt).MultiTalkPane2=["MultiTalkPane2",2],Bt.MultiTalkPane2.toString=s,(Bt.MultiTalkPane2.__enum__=Bt).MultiTalkPane3=["MultiTalkPane3",3],Bt.MultiTalkPane3.toString=s,(Bt.MultiTalkPane3.__enum__=Bt).__empty_constructs__=[Bt.SingleTalkPane,Bt.MultiTalkPane1,Bt.MultiTalkPane2,Bt.MultiTalkPane3];function Ht(){}(n["albero.entity.PaneTypeHelper"]=Ht).__name__=["albero","entity","PaneTypeHelper"],Ht.toPanePrefix=function(e){switch(e[1]){case 0:return"";case 1:return"multi1-";case 2:return"multi2-";case 3:return"multi3-"}},Ht.getPaneType=function(e){switch(e){case 0:return Bt.SingleTalkPane;case 1:return Bt.MultiTalkPane1;case 2:return Bt.MultiTalkPane2;case 3:return Bt.MultiTalkPane3;default:return null}},Ht.getMultiPaneType=function(e){switch(e){case 0:return Bt.MultiTalkPane1;case 1:return Bt.MultiTalkPane2;case 2:return Bt.MultiTalkPane3;default:return Bt.MultiTalkPane1}},Ht.getMultiPaneTypes=function(){return[Bt.MultiTalkPane1,Bt.MultiTalkPane2,Bt.MultiTalkPane3]},Ht.fromString=function(e){switch(e){case"multi1":return Bt.MultiTalkPane1;case"multi2":return Bt.MultiTalkPane2;case"multi3":return Bt.MultiTalkPane3;default:return Bt.SingleTalkPane}},Ht.toString=function(e){switch(e[1]){case 0:return"single";case 1:return"multi1";case 2:return"multi2";case 3:return"multi3"}};function jt(e){null!=e&&(this.expiration=e.expiration,this.warning=e.warning)}(n["albero.entity.PasswordExpiration"]=jt).__name__=["albero","entity","PasswordExpiration"],jt.prototype={isExpired:function(e){return this.timeOvered(this.expiration,e)},needWarning:function(e,t){return!!this.timeOveredOrNotExist(t,e)&&this.timeOvered(this.warning,e)},timeOvered:function(e,t){if(null==e)return!1;var n=t.high-e.high|0;return n=0!=n?n:ga.ucompare(t.low,e.low),0<(t.high<0?e.high<0?n:-1:0<=e.high?n:1)},timeOveredOrNotExist:function(e,t){return null==e||this.timeOvered(e,t)},__class__:jt};var Yt=function(e){null!=e&&(this.name=e.plan_name,this.trial=!!e.trial,this.free=!!e.free)};(n["albero.entity.Plan"]=Yt).__name__=["albero","entity","Plan"],Yt.prototype={__class__:Yt};var zt=function(e){null!=e&&(this.domainId=e.domain_id,this.userId=e.user_id,(this.itemValues=null)!=e.item_values&&(this.itemValues=Ga.__cast(e.item_values,Array).map(function(e){return new Wt(e)})))};(n["albero.entity.Profile"]=zt).__name__=["albero","entity","Profile"],zt.prototype={__class__:zt};var Gt=function(e){if(null!=e&&(this.domainId=e.domain_id,null!=e.item_definitions)){this.itemDefinitions=[];for(var t=0,n=Ga.__cast(e.item_definitions,Array);t<n.length;){var i=n[t];++t,this.itemDefinitions.push(new Kt(i))}}};(n["albero.entity.ProfileDefinition"]=Gt).__name__=["albero","entity","ProfileDefinition"],Gt.isSameProfileItemDefinitions=function(e,t){if(t.length!=e.length)return!1;for(var n=0,i=t.length;n<i;){var r=n++;if(t[r].profileItemId!=e[r].profileItemId)return!1}return!0},Gt.prototype={getVisibleItemDefinitions:function(t,n){return null==n&&(n=!1),null==t&&(t=!1),null==this.itemDefinitions?[]:this.itemDefinitions.filter(function(e){return!!e.visible&&(!(!t&&10!=e.group)&&(!n||1!=e.profileItemId&&2!=e.profileItemId))})},__class__:Gt};var Kt=function(e){this.locked=!1,this.visible=!0,null!=e&&(this.profileItemId=e.profile_item_id,this.group=e.group,this.name=e.name,this.valueType=e.value_type,null!=e.visible&&(this.visible=e.visible),null!=e.locked&&(this.locked=e.locked))};(n["albero.entity.ProfileItemDefinition"]=Kt).__name__=["albero","entity","ProfileItemDefinition"],Kt.findById=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.profileItemId==t)return i}return null},Kt.prototype={__class__:Kt};var Wt=function(e){null!=e&&(this.profileItemId=e.profile_item_id,this.value=e.value,this.canonicalValue=e.canonical_value)};(n["albero.entity.ProfileItemValue"]=Wt).__name__=["albero","entity","ProfileItemValue"],Wt.findById=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.profileItemId==t)return i}return null},Wt.prototype={__class__:Wt};var Vt=function(e,t){this.domainId=e,this.profileItemValues=t};(n["albero.entity.ProfileItemValuesPerDomain"]=Vt).__name__=["albero","entity","ProfileItemValuesPerDomain"],Vt.convertToApiParams=function(e){return e.map(function(e){return e.convertToApiParamsPerDomain()})},Vt.prototype={convertToApiParamsPerDomain:function(){return[this.domainId,this.profileItemValues.map(function(e){return{profile_item_id:e.profileItemId,value:e.value}})]},__class__:Vt};function qt(e){if(null==e)return this.enabled=!0,void(this.version=0);this.enabled=null==e.enabled||e.enabled,this.version=e.version}(n["albero.entity.PushNotificationSetting"]=qt).__name__=["albero","entity","PushNotificationSetting"],qt.createWithParams=function(e,t){var n=new qt;return n.enabled=e,n.version=t,n},qt.prototype={__class__:qt};var Qt=function(e){null!=e&&(this.id=e.message_id,this.talkId=e.talk_id,this.type=Mt.typeOf(e.type),this.content=e.content,this.userId=e.user_id,this.recipientIds=e.assigned_user_ids,this.responses=Qt.createResponses(e.responses),this.listing=e.listing,this.closingType=$t.closingTypeOf(e.closing_type),this.maxResponseId=e.max_response_id,this.lastResponse=e.last_response,this.lastResponseUserId=e.last_response_user_id,this.createdAt=e.created_at,this.updatedAt=e.updated_at,this.responded=e.responded,this.closed=e.closed)};(n["albero.entity.Question"]=Qt).__name__=["albero","entity","Question"],Qt.createResponses=function(e){var t,n=at.option(e);switch(n[1]){case 0:t=n[2];break;case 1:t=[]}return t.map(function(e){return new en(e)})},Qt.createResponsesFromStrings=function(e){var t,n=at.option(e);switch(n[1]){case 0:t=n[2];break;case 1:t=[]}return t.map(function(e){return new en({content:e,count:0,user_ids:[]})})},Qt.createResponseTexts=function(e,t){switch(e[1]){case 13:return["YES","NO"];case 15:return t;case 17:return["DONE","UNDONE"];default:return[]}},Qt.fromMessageAndTalk=function(e,t){var n=new Qt;n.id=e.id,n.talkId=e.talkId,n.type=e.type;var i,r=at.option(e.content.title);switch(r[1]){case 0:i=r[2];break;case 1:i=e.content.question}n.content=i,n.userId=e.userId,n.recipientIds=t.userIds,n.responses=Qt.createResponsesFromStrings(Qt.createResponseTexts(e.type,e.content.options));var a,o=at.option(e.content.listing);switch(o[1]){case 0:a=o[2];break;case 1:a=!0}n.listing=a,n.closingType=$t.closingTypeOf(e.content.closing_type),n.maxResponseId=null,n.lastResponse=null,n.lastResponseUserId=null,n.updatedAt=n.createdAt=e.createdAt,n.responded=!1;var s,l=at.option(e.content.closed);switch(l[1]){case 0:s=l[2];break;case 1:s=!1}return n.closed=s,n},Qt.createTodoDoneMessageWithParams=function(e,t,n){var i=new Mt;return i.talkId=e,i.type=Rt.todoDone,i.content={in_reply_to:t,done:n},i},Qt.createYesOrNoReplyMessageWithParams=function(e,t,n){var i=new Mt;return i.talkId=e,i.content={in_reply_to:t,response:n},i.type=Rt.yesOrNoReply,i},Qt.createSelectOneReplyMessageWithParams=function(e,t,n){var i=new Mt;return i.talkId=e,i.content={in_reply_to:t,response:n},i.type=Rt.selectOneReply,i},Qt.fromTypeToInt=function(e){switch(e[1]){case 0:return 0;case 1:return 1}},Qt.filterToOpBool=function(e){switch(e[1]){case 0:return Ca.Some(!0);case 1:return Ca.Some(!1);case 2:return Ca.None}},Qt.isDoneResponse=function(e){return"DONE"==e.content},Qt.prototype={isCompleted:function(e){if(ee.enumEq(this.type,Rt.todo)){if(ee.enumEq(this.closingType,Zt.any)){if(null!=this.lastResponse&&"DONE"==this.responses[this.lastResponse].content)return!0}else{if(!this.responded)return!1;for(var t=0,n=this.responses;t<n.length;){var i=n[t];if(++t,i.contains(e))return"DONE"==i.content}}return!1}return ee.enumEq(this.closingType,Zt.any)?null!=this.lastResponse:this.responded},createTodoDoneMessage:function(e){return Qt.createTodoDoneMessageWithParams(this.talkId,this.id,e)},createYesOrNoReplyMessage:function(e){return Qt.createYesOrNoReplyMessageWithParams(this.talkId,this.id,e)},createSelectOneReplyMessage:function(e){return Qt.createSelectOneReplyMessageWithParams(this.talkId,this.id,e)},createActionCloseMessage:function(){var e=new Mt;switch(e.talkId=this.talkId,e.content={in_reply_to:this.id},this.type[1]){case 13:e.type=Rt.yesOrNoClosed;break;case 15:e.type=Rt.selectOneClosed;break;case 17:e.type=Rt.todoClosed;break;default:ji._e("["+tt.dateStr(new Date)+"] ","message type is not action.","","","","")}return e},getLastResponse:function(){var t=this;return at.map(at.option(this.lastResponse),function(e){return t.responses[e]})},getLastDoneResponse:function(){return at.filter(this.getLastResponse(),Qt.isDoneResponse)},getDoneResponse:function(){return at.option(nt.find(this.responses,Qt.isDoneResponse))},isSendingQuestion:function(){return this.type==Rt.yesOrNo||this.type==Rt.selectOne||this.type==Rt.todo},isNotSendingQuestion:function(){return!this.isSendingQuestion()},updateByMessage:function(e,t){switch(e.type[1]){case 14:var n=new mi(e.content).getResponseIndex();this.updateByReply(n,e,t);break;case 16:var i=new di(e.content).getResponseIndex();this.updateByReply(i,e,t);break;case 18:var r=new fi(e.content).getResponseIndex();this.updateByReply(r,e,t);break;case 19:case 20:case 21:this.updateByClose()}},updateByClose:function(){this.closed=!0},updateByReply:function(e,t,n){this.updateByReplySub(e,t.id,t.userId,t.createdAt,n)},updateByReplySub:function(e,t,n,i,r){nt.iter(this.responses,function(e){e.sub(n)}),this.responses[e].add(n),r&&(this.responded=!0);var a=this.updatedAt,o=i.high-a.high|0;o=0!=o?o:ga.ucompare(i.low,a.low),0<(i.high<0?a.high<0?o:-1:0<=a.high?o:1)&&(this.updatedAt=i,this.maxResponseId=t,this.lastResponse=e,this.lastResponseUserId=n)},__class__:Qt};var Jt=n["albero.entity.QuestionFromType"]={__ename__:["albero","entity","QuestionFromType"],__constructs__:["fromSelf","fromOther"]};Jt.fromSelf=["fromSelf",0],Jt.fromSelf.toString=s,(Jt.fromSelf.__enum__=Jt).fromOther=["fromOther",1],Jt.fromOther.toString=s,(Jt.fromOther.__enum__=Jt).__empty_constructs__=[Jt.fromSelf,Jt.fromOther];var Xt=n["albero.entity.QuestionFilter"]={__ename__:["albero","entity","QuestionFilter"],__constructs__:["onlyClosed","onlyUnclosed","noFilter"]};Xt.onlyClosed=["onlyClosed",0],Xt.onlyClosed.toString=s,(Xt.onlyClosed.__enum__=Xt).onlyUnclosed=["onlyUnclosed",1],Xt.onlyUnclosed.toString=s,(Xt.onlyUnclosed.__enum__=Xt).noFilter=["noFilter",2],Xt.noFilter.toString=s,(Xt.noFilter.__enum__=Xt).__empty_constructs__=[Xt.onlyClosed,Xt.onlyUnclosed,Xt.noFilter];var Zt=n["albero.entity.QuestionClosingType"]={__ename__:["albero","entity","QuestionClosingType"],__constructs__:["any","all","unknown"]};Zt.any=["any",0],Zt.any.toString=s,(Zt.any.__enum__=Zt).all=["all",1],Zt.all.toString=s,(Zt.all.__enum__=Zt).unknown=["unknown",2],Zt.unknown.toString=s,(Zt.unknown.__enum__=Zt).__empty_constructs__=[Zt.any,Zt.all,Zt.unknown];var $t=function(){};(n["albero.entity.QuestionClosingTypeHelper"]=$t).__name__=["albero","entity","QuestionClosingTypeHelper"],$t.closingTypeOf=function(e){switch(e){case 0:return Zt.any;case 1:return Zt.all;default:return Zt.unknown}};var en=function(e){this.content=e.content,this.count=null==e.count?0:e.count,this.userIds=null==e.user_ids?[]:e.user_ids};(n["albero.entity.QuestionResponse"]=en).__name__=["albero","entity","QuestionResponse"],en.prototype={add:function(e){this.contains(e)||(this.count+=1,this.userIds=this.userIds.concat([e]))},sub:function(t){this.contains(t)&&(this.count-=1,this.userIds=this.userIds.filter(function(e){return!(t.high==e.high&&t.low==e.low)}))},contains:function(e){return it.contains(this.userIds,e)},__class__:en};var tn=function(e){null!=e&&(this.msgRetentionPeriod=e.msg_retention_period,this.msgFileSize=e.msg_file_size,this.maxMessageContentLength=e.max_message_content_length,this.maxTalkers=e.max_talkers,this.maxTalks=e.max_talks,this.withAd=!!e.with_ad)};(n["albero.entity.Quota"]=tn).__name__=["albero","entity","Quota"],tn.prototype={__class__:tn};function nn(e){if(null!=e&&(this.total=e.total,this.marker=e.marker,this.nextMarker=e.next_marker,this.contents=[],null!=e.contents))for(var t=0,n=Ga.__cast(e.contents,Array);t<n.length;){var i=n[t];++t,this.contents.push(new St(i))}}(n["albero.entity.SearchAttachmentsResult"]=nn).__name__=["albero","entity","SearchAttachmentsResult"],nn.prototype={__class__:nn};function rn(e){null!=e&&(this.total=e.total,this.marker=e.marker,this.nextMarker=e.next_marker,this.contents=[],null!=e.contents&&(this.contents=Ga.__cast(e.contents,Array).map(function(e){return new Tt(e)})))}(n["albero.entity.SearchMessagesResult"]=rn).__name__=["albero","entity","SearchMessagesResult"],rn.prototype={__class__:rn};function an(e){null!=e&&(null!=e.domain_id_str&&(this.domainId=it.makeFromIdStr(e.domain_id_str)),null!=e.talk_id_str&&(this.talkId=it.makeFromIdStr(e.talk_id_str)),this.keyword=e.keyword,null==e.search_type||e.search_type==sn.toLocalizeText(on.MESSAGES)?this.searchType=on.MESSAGES:this.searchType=on.ATTACHMENTS,this.sinceText=e.since,this.untilText=e.until,null!=e.from_id_str&&(this.fromUserId=it.makeFromIdStr(e.from_id_str)))}(n["albero.entity.SearchParams"]=an).__name__=["albero","entity","SearchParams"],an.dateQueryToText=function(e,t){if(null==e)return t;switch(e){case"-1d":return Hi.localize("SearchParams.text_date_yesterday");case"-3d":return Hi.localize("SearchParams.text_date_three_days_before");case"t":return Hi.localize("SearchParams.text_date_today");default:return W.replace(e,"-","/")}},an.prototype={toProps:function(){var e={};if(null!=this.domainId){var t=this.domainId;e.domain_id_str="_"+t.high+"_"+t.low}if(null!=this.talkId){var n=this.talkId;e.talk_id_str="_"+n.high+"_"+n.low}if(e.keyword=this.keyword,e.search_type=sn.toLocalizeText(this.searchType),e.since=this.sinceText,e.until=this.untilText,null!=this.fromUserId){var i=this.fromUserId;e.from_id_str="_"+i.high+"_"+i.low}return e},copy:function(){return new an(this.toProps())},eq:function(e){return!!this.isSameInt64(this.domainId,e.domainId)&&(!!this.isSameInt64(this.talkId,e.talkId)&&(this.keyword==e.keyword&&(!!ee.enumEq(this.searchType,e.searchType)&&(this.sinceText==e.sinceText&&(this.untilText==e.untilText&&!!this.isSameInt64(this.fromUserId,e.fromUserId))))))},isSameInt64:function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.high==t.high&&e.low==t.low},getQueryText:function(){var e=[];return null!=this.keyword&&0!=this.keyword.length&&e.push(this.keyword),null!=this.sinceText&&e.push("since:"+this.sinceText),null!=this.untilText&&e.push("until:"+this.untilText),null!=this.fromUserId&&e.push("from:"+va.toString(this.fromUserId)),e.join(" ")},getPeriodText:function(){return an.dateQueryToText(this.sinceText,"")+"~"+an.dateQueryToText(this.untilText,"")},__class__:an};var on=n["albero.entity.SearchType"]={__ename__:["albero","entity","SearchType"],__constructs__:["MESSAGES","ATTACHMENTS"]};on.MESSAGES=["MESSAGES",0],on.MESSAGES.toString=s,(on.MESSAGES.__enum__=on).ATTACHMENTS=["ATTACHMENTS",1],on.ATTACHMENTS.toString=s,(on.ATTACHMENTS.__enum__=on).__empty_constructs__=[on.MESSAGES,on.ATTACHMENTS];var sn=function(){};(n["albero.entity.SearchTypeUtil"]=sn).__name__=["albero","entity","SearchTypeUtil"],sn.toLocalizeText=function(e){switch(e[1]){case 0:return Hi.localize("SearchParams.text_type_messages");case 1:return Hi.localize("SearchParams.text_type_attachments")}};var ln=n["albero.entity.SearchDate"]={__ename__:["albero","entity","SearchDate"],__constructs__:["DATE_NONE","DATE_TODAY","DATE_YESTERDAY","DATE_THREE_DAYS_BEFORE","DATE_CALENDAR"]};ln.DATE_NONE=["DATE_NONE",0],ln.DATE_NONE.toString=s,(ln.DATE_NONE.__enum__=ln).DATE_TODAY=["DATE_TODAY",1],ln.DATE_TODAY.toString=s,(ln.DATE_TODAY.__enum__=ln).DATE_YESTERDAY=["DATE_YESTERDAY",2],ln.DATE_YESTERDAY.toString=s,(ln.DATE_YESTERDAY.__enum__=ln).DATE_THREE_DAYS_BEFORE=["DATE_THREE_DAYS_BEFORE",3],ln.DATE_THREE_DAYS_BEFORE.toString=s,(ln.DATE_THREE_DAYS_BEFORE.__enum__=ln).DATE_CALENDAR=["DATE_CALENDAR",4],ln.DATE_CALENDAR.toString=s,(ln.DATE_CALENDAR.__enum__=ln).__empty_constructs__=[ln.DATE_NONE,ln.DATE_TODAY,ln.DATE_YESTERDAY,ln.DATE_THREE_DAYS_BEFORE,ln.DATE_CALENDAR];function un(){}(n["albero.entity.SearchDateUtil"]=un).__name__=["albero","entity","SearchDateUtil"],un.createSearchDateArray=function(e){return e?[ln.DATE_TODAY,ln.DATE_YESTERDAY,ln.DATE_THREE_DAYS_BEFORE,ln.DATE_CALENDAR]:[ln.DATE_YESTERDAY,ln.DATE_THREE_DAYS_BEFORE,ln.DATE_CALENDAR]},un.toLocalizeText=function(e){switch(e[1]){case 0:return Hi.localize("SearchParams.text_date_none");case 1:return Hi.localize("SearchParams.text_date_today");case 2:return Hi.localize("SearchParams.text_date_yesterday");case 3:return Hi.localize("SearchParams.text_date_three_days_before");case 4:return Hi.localize("SearchParams.text_date_calendar")}};function cn(e){null!=e&&(this.user=new Ot(e.user),this.device=e.device,this.notification=e.notification,this.passwordExpiration=new jt(e.password_expiration),this.configuration=new Pe(e.configuration))}(n["albero.entity.Session"]=cn).__name__=["albero","entity","Session"],cn.prototype={__class__:cn};function _n(e){null!=e&&(this.solutionId=e.solution_id,this.name=e.name,null!=e.link&&(this.link=new hn(e.link)),null!=e.plugin&&(this.plugin=new dn(e.plugin)))}(n["albero.entity.Solution"]=_n).__name__=["albero","entity","Solution"],_n.getSolutionType=function(e){switch(e){case 1:return fn.PhotoViewTrial;case 2:return fn.PhotoView;case 3:return fn.MultiView;case 4:return fn.KeywordWatching;default:return fn.Unknown}},_n.prototype={__class__:_n};var hn=function(e){null!=e&&(this.iconUrl=e.icon_url,this.url=e.url)};(n["albero.entity.SolutionLink"]=hn).__name__=["albero","entity","SolutionLink"],hn.prototype={__class__:hn};var dn=function(e){null!=e&&(this.url=e.url,this.loaded=!1)};(n["albero.entity.SolutionPlugin"]=dn).__name__=["albero","entity","SolutionPlugin"],dn.prototype={__class__:dn};var fn=n["albero.entity.SolutionType"]={__ename__:["albero","entity","SolutionType"],__constructs__:["PhotoViewTrial","PhotoView","MultiView","KeywordWatching","Unknown"]};fn.PhotoViewTrial=["PhotoViewTrial",0],fn.PhotoViewTrial.toString=s,(fn.PhotoViewTrial.__enum__=fn).PhotoView=["PhotoView",1],fn.PhotoView.toString=s,(fn.PhotoView.__enum__=fn).MultiView=["MultiView",2],fn.MultiView.toString=s,(fn.MultiView.__enum__=fn).KeywordWatching=["KeywordWatching",3],fn.KeywordWatching.toString=s,(fn.KeywordWatching.__enum__=fn).Unknown=["Unknown",4],fn.Unknown.toString=s,(fn.Unknown.__enum__=fn).__empty_constructs__=[fn.PhotoViewTrial,fn.PhotoView,fn.MultiView,fn.KeywordWatching,fn.Unknown];function mn(){}(n["albero.entity.Stamp"]=mn).__name__=["albero","entity","Stamp"],mn.prototype={__class__:mn};function pn(e){this.commonStampId=e}(n["albero.entity.CommonStamp"]=pn).__name__=["albero","entity","CommonStamp"],pn.__interfaces__=[mn],pn.fromCommonStampId=function(e){return new pn(e)},pn.fromJson=function(e){return null==e.commonStampId?null:pn.fromCommonStampId(e.commonStampId)},pn.prototype={getImageUrl:function(){return"./images/stamp/3/"+this.commonStampId+".png"},getKey:function(){return"common_"+this.commonStampId},toJson:function(){return{commonStampId:this.commonStampId}},createMessage:function(e,t){var n=new Mt;return n.talkId=e,n.type=Rt.stamp,n.content={stamp_set:3,stamp_index:this.createStampIndex()},null!=t&&0!=t.length&&(n.content.text=t),n},createStampIndex:function(){for(var e=new zn(0,0),t=new zn(0,10),n=0,i=this.commonStampId.length;n<i;){var r=n++,a=65535&e.low,o=e.low>>>16,s=65535&t.low,l=t.low>>>16,u=ga._mul(a,s),c=ga._mul(o,s),_=ga._mul(a,l),h=u,d=(ga._mul(o,l)+(_>>>16)|0)+(c>>>16)|0;if(h=h+(_<<=16)|0,ga.ucompare(h,_)<0){d++;d|=0}if(h=h+(c<<=16)|0,ga.ucompare(h,c)<0){d++;d|=0}d=d+(ga._mul(e.low,t.high)+ga._mul(e.high,t.low)|0)|0;var f=new zn(d,h),m=new zn(0,K.parseInt(this.commonStampId.charAt(r))),p=f.high+m.high|0,g=f.low+m.low|0;if(ga.ucompare(g,f.low)<0){p++;p|=0}e=new zn(p,g)}return e},__class__:pn};function gn(e,t,n){this.stampsetId=e,this.id=t,this.illust=n}(n["albero.entity.OriginalStamp"]=gn).__name__=["albero","entity","OriginalStamp"],gn.__interfaces__=[mn],gn.fromJson=function(e){if(null==e.originalStamp)return null;var t=e.originalStamp;if(null==t.stampsetIdStr||null==t.stampIdStr)return null;var n=it.makeFromIdStr(t.stampsetIdStr),i=it.makeFromIdStr(t.stampIdStr);return new gn(n,i,t.illust)},gn.fromPropsAndStampsetId=function(e,t){return new gn(t,it.fromIntOrInt64(e.id),e.illust)},gn.createKey=function(e){return"original__"+e.high+"_"+e.low},gn.prototype={getImageUrl:function(){return this.illust},getKey:function(){return gn.createKey(this.id)},toJson:function(){var e=this.stampsetId,t=this.id;return{originalStamp:{stampsetIdStr:"_"+e.high+"_"+e.low,stampIdStr:"_"+t.high+"_"+t.low,illust:this.illust}}},createMessage:function(e,t){var n=new Mt;return n.talkId=e,n.type=Rt.originalStamp,n.content={stampset_id:this.stampsetId,stamp_id:this.id},null!=t&&0!=t.length&&(n.content.text=t),n},__class__:gn};function vn(e,t,n,i){this.stampsetType=e,this.name=t,this.icon=n,this.version=i,this.stamps=[]}(n["albero.entity.Stampset"]=vn).__name__=["albero","entity","Stampset"],vn.historyStampset=function(){return new vn(In.getHistoryStampsetType(),"stamp-history",null,0)},vn.commonStampset=function(e,t,n){return new vn(In.fromCommonStampCategoryIndex(e),t,"./images/stamp/3/"+n,0)},vn.originalStampset=function(e){var t=it.fromIntOrInt64(e.stampset_id),n=In.fromStampsetId(t),i=new vn(n,e.name,e.icon,e.version);if(null!=e.stamps){var r=Ga.__cast(e.stamps,Array).map(function(e){return gn.fromPropsAndStampsetId(e,t)});i.setStamps(r)}return i},vn.fromStampsetInfo=function(e){var t=In.fromStampsetId(e.stampsetId);return new vn(t,e.name,e.icon,e.version)},vn.prototype={toTabId:function(){return this.stampsetType.toTabId()},getIconUrl:function(){return this.icon},isStampHistory:function(){return"stamp-history"==this.name},isOriginalStampset:function(){return this.stampsetType.isOriginalStampset()},isEmpty:function(){return 0==this.stamps.length},setStamps:function(e){this.stamps=e},getStamps:function(){return this.stamps},isOlderThan:function(e){return this.version<e.version},__class__:vn};function yn(e){null!=e&&(this.stampsetId=it.fromIntOrInt64(e.stampset_id),this.name=e.name,this.icon=e.icon,this.version=e.version)}(n["albero.entity.StampsetInfo"]=yn).__name__=["albero","entity","StampsetInfo"],yn.prototype={toTabId:function(){var e=this.stampsetId;return"_"+e.high+"_"+e.low},eqStampsetId:function(e){var t=this.stampsetId,n=e.stampsetId;return null!=t&&null!=n&&t.high==n.high&&t.low==n.low},isNewerThan:function(e){return this.version>e.version},__class__:yn};var Sn=function(e){this.stampsetInfos=[],this.allowCreateMessageStampsetIds=[],this.version=0,null!=e&&(this.version=e.version,this.allowCreateMessageStampsetIds=e.allow_create_message_stampset_ids.map(it.fromIntOrInt64),this.stampsetInfos=this.getStampsetInfos(e.stampset_infos))};(n["albero.entity.StampsetSetting"]=Sn).__name__=["albero","entity","StampsetSetting"],Sn.prototype={getStampsetInfos:function(e){return null==e?[]:e.map(function(e){return new yn(e)})},isForwardForbidden:function(e){var t=e.getContentsForOriginalStamp(),n=null==t?null:t.stampsetId;return null!=n&&!this.containSendableStampset(n)},containSendableStampset:function(t){return null!=this.allowCreateMessageStampsetIds&&nt.exists(this.allowCreateMessageStampsetIds,function(e){return null!=t&&null!=e&&t.high==e.high&&t.low==e.low})},containVisibleStampset:function(n){return nt.exists(this.stampsetInfos,function(e){var t=e.stampsetId;return null!=n&&null!=t&&n.high==t.high&&n.low==t.low})},getSendableStampsetInfos:function(){var t=this;return null==this.stampsetInfos?[]:null==this.allowCreateMessageStampsetIds?[]:this.stampsetInfos.filter(function(e){return t.containSendableStampset(e.stampsetId)})},isNewerThan:function(e){return this.version>e.version},updateStampsetInfo:function(t){this.stampsetInfos=this.stampsetInfos.map(function(e){return t.eqStampsetId(e)&&t.isNewerThan(e)?t:e})},deleteStampsetInfo:function(n){this.stampsetInfos=this.stampsetInfos.filter(function(e){var t=e.stampsetId;return!(null!=t&&null!=n&&t.high==n.high&&t.low==n.low)}),this.allowCreateMessageStampsetIds=this.allowCreateMessageStampsetIds.filter(function(e){return!(null!=e&&null!=n&&e.high==n.high&&e.low==n.low)})},getStampsetIdsDiff:function(e){for(var t=new Ma,n=e.stampsetInfos.concat(this.stampsetInfos),i=0;i<n.length;){var r=n[i];++i;var a=r.stampsetId,o="_"+a.high+"_"+a.low,s=((null!=Io[o]?t.existsReserved(o):t.h.hasOwnProperty(o))?null!=Io[o]?t.getReserved(o):t.h[o]:0)+1;null!=Io[o]?t.setReserved(o,s):t.h[o]=s}for(var l=[],u=t.keys();u.hasNext();){var c=u.next();1==(null!=Io[c]?t.getReserved(c):t.h[c])&&l.push(it.makeFromIdStr(c))}return l},__class__:Sn};var wn=n["albero.entity.StampsetTypeValue"]={__ename__:["albero","entity","StampsetTypeValue"],__constructs__:["HISTORY","COMMON_CIMMON","COMMON_BUSINESS","COMMON_BUSINESS_TEXT","COMMON_LARGE_TEXT","COMMON_EFFECT","COMMON_EFFECT2","COMMON_HANKO","COMMON_YUZU","COMMON_YUZU2","COMMON_YUZU3","ORIGINAL"]};wn.HISTORY=["HISTORY",0],wn.HISTORY.toString=s,(wn.HISTORY.__enum__=wn).COMMON_CIMMON=["COMMON_CIMMON",1],wn.COMMON_CIMMON.toString=s,(wn.COMMON_CIMMON.__enum__=wn).COMMON_BUSINESS=["COMMON_BUSINESS",2],wn.COMMON_BUSINESS.toString=s,(wn.COMMON_BUSINESS.__enum__=wn).COMMON_BUSINESS_TEXT=["COMMON_BUSINESS_TEXT",3],wn.COMMON_BUSINESS_TEXT.toString=s,(wn.COMMON_BUSINESS_TEXT.__enum__=wn).COMMON_LARGE_TEXT=["COMMON_LARGE_TEXT",4],wn.COMMON_LARGE_TEXT.toString=s,(wn.COMMON_LARGE_TEXT.__enum__=wn).COMMON_EFFECT=["COMMON_EFFECT",5],wn.COMMON_EFFECT.toString=s,(wn.COMMON_EFFECT.__enum__=wn).COMMON_EFFECT2=["COMMON_EFFECT2",6],wn.COMMON_EFFECT2.toString=s,(wn.COMMON_EFFECT2.__enum__=wn).COMMON_HANKO=["COMMON_HANKO",7],wn.COMMON_HANKO.toString=s,(wn.COMMON_HANKO.__enum__=wn).COMMON_YUZU=["COMMON_YUZU",8],wn.COMMON_YUZU.toString=s,(wn.COMMON_YUZU.__enum__=wn).COMMON_YUZU2=["COMMON_YUZU2",9],wn.COMMON_YUZU2.toString=s,(wn.COMMON_YUZU2.__enum__=wn).COMMON_YUZU3=["COMMON_YUZU3",10],wn.COMMON_YUZU3.toString=s,(wn.COMMON_YUZU3.__enum__=wn).ORIGINAL=function(e){var t=["ORIGINAL",11,e];return t.__enum__=wn,t.toString=s,t},wn.__empty_constructs__=[wn.HISTORY,wn.COMMON_CIMMON,wn.COMMON_BUSINESS,wn.COMMON_BUSINESS_TEXT,wn.COMMON_LARGE_TEXT,wn.COMMON_EFFECT,wn.COMMON_EFFECT2,wn.COMMON_HANKO,wn.COMMON_YUZU,wn.COMMON_YUZU2,wn.COMMON_YUZU3];var In=function(e){this.value=e};(n["albero.entity.StampsetType"]=In).__name__=["albero","entity","StampsetType"],In.fromStampsetId=function(e){return new In(wn.ORIGINAL(e))},In.fromCommonStampCategoryIndex=function(e){switch(e){case 0:return new In(wn.COMMON_CIMMON);case 1:return new In(wn.COMMON_BUSINESS);case 2:return new In(wn.COMMON_BUSINESS_TEXT);case 3:return new In(wn.COMMON_LARGE_TEXT);case 4:return new In(wn.COMMON_EFFECT);case 5:return new In(wn.COMMON_EFFECT2);case 6:return new In(wn.COMMON_HANKO);case 7:return new In(wn.COMMON_YUZU);case 8:return new In(wn.COMMON_YUZU2);case 9:return new In(wn.COMMON_YUZU3);default:return null}},In.fromTabId=function(e){var t=K.parseInt(e);if(null!=t)if(null==t){var n=In.fromCommonStampCategoryIndex(t-1);if(null!=n)return n}else{if(0==t)return In.getHistoryStampsetType();var i=In.fromCommonStampCategoryIndex(t-1);if(null!=i)return i}var r=it.makeFromIdStr(e);if(null!=r)return new In(wn.ORIGINAL(r));try{return new In(ee.createEnum(wn,e))}catch(e){return In.getDefaultStampsetType()}},In.getHistoryStampsetType=function(){return new In(wn.HISTORY)},In.getDefaultStampsetType=function(){return new In(wn.COMMON_CIMMON)},In.prototype={toTabId:function(){var e=this.value;if(11!=e[1])return K.string(this.value);var t=e[2];return"_"+t.high+"_"+t.low},getStampsetId:function(){var e=this.value;return 11!=e[1]?null:e[2]},isOriginalStampset:function(){var e=this.value;if(11!=e[1])return null;e[2];return!0},fallbackIfInvalid:function(e){return this.isValid(e)?this:In.getDefaultStampsetType()},isValid:function(e){var t=this.value;if(11!=t[1])return!0;var n=t[2];return null!=e&&null!=e.stampsetSetting&&e.stampsetSetting.containSendableStampset(n)},__class__:In};var Tn=function(e){null!=e&&(this.id=e.talk_id,this.domainId=e.domain_id,this.type=this.typeOf(e.type),this.name=e.talk_name,this.iconUrl=e.icon_url,this.userIds=e.user_ids,this.updatedAt=e.updated_at,this.leftUsers=this.getUsers(e.left_users),this.groupTalkSettings=this.getGroupTalkSetting(e.settings))};(n["albero.entity.Talk"]=Tn).__name__=["albero","entity","Talk"],Tn.prototype={typeOf:function(e){switch(e){case 1:return Nn.PairTalk;case 2:return Nn.GroupTalk;default:return Nn.Unknown}},getUsers:function(e){return null==e?null:e.map(function(e){return new et(e)})},getGroupTalkSetting:function(e){return null==e?Ca.None:Ca.Some(new En(e))},isSystemMessageVisibled:function(){var e=at.map(this.groupTalkSettings,function(e){return e.systemMessageVisible});switch(e[1]){case 0:return e[2];case 1:return!0}},isAllowDisplayPastMessages:function(){var e=at.map(this.groupTalkSettings,function(e){return e.allowDisplayPastMessages});switch(e[1]){case 0:return e[2];case 1:return!1}},__class__:Tn};var En=function(e){null!=e&&(this.allowDisplayPastMessages=!!e.allow_display_past_messages,this.systemMessageVisible=null==e.system_message_visible||e.system_message_visible)};(n["albero.entity.GroupTalkSettings"]=En).__name__=["albero","entity","GroupTalkSettings"],En.createDefault=function(){var e=new En;return e.allowDisplayPastMessages=!0,e.systemMessageVisible=!0,e},En.prototype={__class__:En};var Nn=n["albero.entity.TalkType"]={__ename__:["albero","entity","TalkType"],__constructs__:["Unknown","PairTalk","GroupTalk"]};Nn.Unknown=["Unknown",0],Nn.Unknown.toString=s,(Nn.Unknown.__enum__=Nn).PairTalk=["PairTalk",1],Nn.PairTalk.toString=s,(Nn.PairTalk.__enum__=Nn).GroupTalk=["GroupTalk",2],Nn.GroupTalk.toString=s,(Nn.GroupTalk.__enum__=Nn).__empty_constructs__=[Nn.Unknown,Nn.PairTalk,Nn.GroupTalk];var An=n["albero.entity.TalkOrAnnoucements"]={__ename__:["albero","entity","TalkOrAnnoucements"],__constructs__:["talk","annoucements"]};An.talk=function(e){var t=["talk",0,e];return t.__enum__=An,t.toString=s,t},An.annoucements=["annoucements",1],An.annoucements.toString=s,(An.annoucements.__enum__=An).__empty_constructs__=[An.annoucements];function bn(){}(n["albero.entity.TalkOrAnncounementsHelper"]=bn).__name__=["albero","entity","TalkOrAnncounementsHelper"],bn.getTalkId=function(e){switch(e[1]){case 0:var t=e[2];return Ca.Some(t);case 1:return Ca.None}};function Dn(e,t){this.talk=e,this.status=t}(n["albero.entity.TalkPack"]=Dn).__name__=["albero","entity","TalkPack"],Dn.compareTalkOrderingTimestamp=function(e,t){var n=e.getTalkOrderingTimestamp(),i=t.getTalkOrderingTimestamp(),r=n.high-i.high|0;return r=0!=r?r:ga.ucompare(n.low,i.low),n.high<0?i.high<0?r:-1:0<=i.high?r:1},Dn.compareTalkConsideredFavorite=function(e,t){var n=e.getTalkOrderInFavorites(),i=t.getTalkOrderInFavorites();return null!=n&&null!=i?Dn.compareTalkOrderingTimestamp(e,t):null!=n?1:null!=i?-1:Dn.compareTalkOrderingTimestamp(e,t)},Dn.prototype={getTalkOrderingTimestamp:function(){return null!=this.status&&null!=this.status.talkOrderingTimestamp?this.status.talkOrderingTimestamp:this.talk.updatedAt},getTalkOrderInFavorites:function(){return null!=this.status?this.status.orderInFavorites:null},__class__:Dn};var kn=function(e,t){this.paneType=e,this.talkSelection=t};(n["albero.entity.TalkPaneSelection"]=kn).__name__=["albero","entity","TalkPaneSelection"],kn.createArrayForMultiPanes=function(e){return nt.mapi(e,function(e,t){return new kn(Ht.getMultiPaneType(e),t)})},kn.prototype={createUrls:function(e,t){switch(this.paneType[1]){case 0:return V.talks(e,C.single(this.talkSelection));case 1:var n=fo(t,t.getTalkSelection),i=e,r=Ht.getMultiPaneTypes().map(function(e){return n(i,e)});return r[0]=this.talkSelection,V.talks(e,C.multi(r));case 2:var a=fo(t,t.getTalkSelection),o=e,s=Ht.getMultiPaneTypes().map(function(e){return a(o,e)});return s[1]=this.talkSelection,V.talks(e,C.multi(s));case 3:var l=fo(t,t.getTalkSelection),u=e,c=Ht.getMultiPaneTypes().map(function(e){return l(u,e)});return c[2]=this.talkSelection,V.talks(e,C.multi(c))}},getTalkIdOrNull:function(){return Rn.getTalkIdOrNull(this.talkSelection)},__class__:kn};function Cn(){}(n["albero.entity.ITalkSelectionGetter"]=Cn).__name__=["albero","entity","ITalkSelectionGetter"],Cn.prototype={__class__:Cn};function On(e){null!=e&&(this.domainId=e.domain_id,this.talkId=e.talk_id,this.version=e.version)}(n["albero.entity.TalkPushNotificationEvent"]=On).__name__=["albero","entity","TalkPushNotificationEvent"],On.prototype={__class__:On};var Mn=n["albero.entity.TalkSelection"]={__ename__:["albero","entity","TalkSelection"],__constructs__:["NotSelected","TalkSelected","AnnouncementsSelected"]};Mn.NotSelected=["NotSelected",0],Mn.NotSelected.toString=s,(Mn.NotSelected.__enum__=Mn).TalkSelected=function(e,t){var n=["TalkSelected",1,e,t];return n.__enum__=Mn,n.toString=s,n},Mn.AnnouncementsSelected=["AnnouncementsSelected",2],Mn.AnnouncementsSelected.toString=s,(Mn.AnnouncementsSelected.__enum__=Mn).__empty_constructs__=[Mn.NotSelected,Mn.AnnouncementsSelected];var Rn=function(){};(n["albero.entity.TalkSelectionHelper"]=Rn).__name__=["albero","entity","TalkSelectionHelper"],Rn.eqTalkSelection=function(e,t){var n;if(e[0]==t[0]){var i=Rn.getTalkIdOrNull(e),r=Rn.getTalkIdOrNull(t);n=null==i&&null==r||null!=i&&null!=r&&i.high==r.high&&i.low==r.low}else n=!1;if(n){var a=Rn.getMessageIdOrNull(e),o=Rn.getMessageIdOrNull(t);return null==a&&null==o||null!=a&&null!=o&&a.high==o.high&&a.low==o.low}return!1},Rn.isSelected=function(e,t){switch(e[1]){case 0:return!1;case 1:e[3];var n=e[2],i=at.orNull(bn.getTalkId(t));return null!=n&&null!=i&&n.high==i.high&&n.low==i.low;case 2:return t==An.annoucements}},Rn.getTalkIdOrNull=function(e){switch(e[1]){case 0:return null;case 1:return e[2];case 2:return null}},Rn.getMessageIdOrNull=function(e){switch(e[1]){case 0:return null;case 1:var t=e[3];return at.orNull(t);case 2:return null}};function Fn(e){this.unreadCount=0,null!=e&&(this.id=e.talk_id,this.unreadCount=null!=e.unread_count?e.unread_count:0,this.maxMessageId=e.max_message_id,null!=e.max_message?this.maxMessage=new Mt(e.max_message):this.maxMessage=null,this.maxReadMessageId=e.max_read_message_id,this.maxEveryoneReadMessageId=e.max_everyone_read_message_id,this.talkOrderingTimestamp=e.talk_ordering_timestamp,this.orderInFavorites=e.order_in_favorites,this.favoriteVersion=e.favorite_version,this.pushNotificationSetting=new qt(e.push_notification))}(n["albero.entity.TalkStatus"]=Fn).__name__=["albero","entity","TalkStatus"],Fn.prototype={update:function(e){var t=this,n=!1;return this.needIdUpdate(this.maxEveryoneReadMessageId,e.maxEveryoneReadMessageId)&&(this.maxEveryoneReadMessageId=e.maxEveryoneReadMessageId,n=!0),at.foreach(e.maxReadMessageId,function(e){t.needIdUpdate(t.maxReadMessageId,e)&&(t.maxReadMessageId=e,n=!0)}),n},needIdUpdate:function(e,t){if(null==t)return!1;if(null==e)return!0;var n=e.high-t.high|0;return n=0!=n?n:ga.ucompare(e.low,t.low),(e.high<0?t.high<0?n:-1:0<=t.high?n:1)<0},read:function(e,t){this.maxReadMessageId=e,this.unreadCount-=t,this.unreadCount<0&&(this.unreadCount=0)},readAll:function(){this.maxReadMessageId=this.maxMessageId,this.unreadCount=0},applyNewMessage:function(e,t){t?xn.isUnread(this,e.id)&&this.readAll():this.unreadCount++,this.talkOrderingTimestamp=e.createdAt},isMessageAcceptable:function(e,t){if(xn.isUnread(this,e.id))return!0;var n=Nt.subTimestampPart(this.maxReadMessageId,e.id),i=n.high-t.high|0;return i=0!=i?i:ga.ucompare(n.low,t.low),(n.high<0?t.high<0?i:-1:0<=t.high?i:1)<=0},__class__:Fn};var xn=function(){};(n["albero.entity.TalkStatusHelper"]=xn).__name__=["albero","entity","TalkStatusHelper"],xn.isNotificationDisabled=function(e){return null!=e&&null!=e.pushNotificationSetting&&!e.pushNotificationSetting.enabled},xn.isFavoriteTalk=function(e){return null!=e&&null!=e.orderInFavorites},xn.isUnreadMesasgeExisted=function(e){return null!=e&&(null!=e.maxMessage&&xn.isUnread(e,e.maxMessage.id))},xn.isUnread=function(e,t){if(null==e.maxReadMessageId)return!0;var n=e.maxReadMessageId,i=n.high-t.high|0;return i=0!=i?i:ga.ucompare(n.low,t.low),(n.high<0?t.high<0?i:-1:0<=t.high?i:1)<0},xn.isNewMax=function(e,t){if(null==e.maxMessageId)return!0;var n=e.maxMessageId,i=n.high-t.high|0;return i=0!=i?i:ga.ucompare(n.low,t.low),(n.high<0?t.high<0?i:-1:0<=t.high?i:1)<0},xn.isMax=function(e,t){if(null==e.maxMessageId)return!1;var n=e.maxMessageId;return null!=n&&null!=t&&n.high==t.high&&n.low==t.low};function Un(e){null!=e&&(this.talkId=e.talk_id,this.maxEveryoneReadMessageId=e.max_everyone_read_message_id,this.maxReadMessageId=at.option(e.max_read_message_id))}(n["albero.entity.TalkStatusUpdate"]=Un).__name__=["albero","entity","TalkStatusUpdate"],Un.prototype={__class__:Un};function Pn(e,t,n){this.file=e,this.dimension=Ln.createWithSize(t,n),this.auth=null}(n["albero.entity.ThumbInfo"]=Pn).__name__=["albero","entity","ThumbInfo"],Pn.prototype={setAuth:function(e){this.auth=e},__class__:Pn};var Ln=function(e){null!=e&&(this.width=e.width,this.height=e.height)};(n["albero.entity.ThumbDimension"]=Ln).__name__=["albero","entity","ThumbDimension"],Ln.createWithSize=function(e,t){var n=new Ln;return n.width=e,n.height=t,n},Ln.prototype={toObject:function(){return{width:this.width,height:this.height}},__class__:Ln};function Bn(e,t,n){var i=new zn(0,0);this.domainId=i,this.domainId=e,this.oldSetting=t,this.newSetting=n}(n["albero.entity.UpdateDomainStampSettingEvent"]=Bn).__name__=["albero","entity","UpdateDomainStampSettingEvent"],Bn.prototype={isValid:function(){return this.newSetting.isNewerThan(this.oldSetting)},getStampsetIdsDiff:function(){return this.oldSetting.getStampsetIdsDiff(this.newSetting)},__class__:Bn};var Hn=n["albero.entity.UploadUseType"]={__ename__:["albero","entity","UploadUseType"],__constructs__:["PROFILE_IMAGE","MESSAGE","TALK_ICON","THUMBNAIL","NOTE_ATTACHMENT","NOTE_THUMBNAIL"]};Hn.PROFILE_IMAGE=["PROFILE_IMAGE",0],Hn.PROFILE_IMAGE.toString=s,(Hn.PROFILE_IMAGE.__enum__=Hn).MESSAGE=["MESSAGE",1],Hn.MESSAGE.toString=s,(Hn.MESSAGE.__enum__=Hn).TALK_ICON=["TALK_ICON",2],Hn.TALK_ICON.toString=s,(Hn.TALK_ICON.__enum__=Hn).THUMBNAIL=["THUMBNAIL",3],Hn.THUMBNAIL.toString=s,(Hn.THUMBNAIL.__enum__=Hn).NOTE_ATTACHMENT=["NOTE_ATTACHMENT",4],Hn.NOTE_ATTACHMENT.toString=s,(Hn.NOTE_ATTACHMENT.__enum__=Hn).NOTE_THUMBNAIL=["NOTE_THUMBNAIL",5],Hn.NOTE_THUMBNAIL.toString=s,(Hn.NOTE_THUMBNAIL.__enum__=Hn).__empty_constructs__=[Hn.PROFILE_IMAGE,Hn.MESSAGE,Hn.TALK_ICON,Hn.THUMBNAIL,Hn.NOTE_ATTACHMENT,Hn.NOTE_THUMBNAIL];function jn(){}(n["albero.entity.UploadUseTypeHelper"]=jn).__name__=["albero","entity","UploadUseTypeHelper"],jn.getUseTypeInt=function(e){switch(e[1]){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 4;case 4:return 5;case 5:return 6}};function Yn(e){null!=e&&(null!=e.user_id&&(this.userId=e.user_id),null!=e.email&&(this.email=e.email),null!=e.sub_email&&(this.subEmail=e.sub_email),null!=e.group_alias&&(this.groupAlias=e.group_alias),null!=e.signin_id&&(this.signinId=e.signin_id))}(n["albero.entity.UserIdentifier"]=Yn).__name__=["albero","entity","UserIdentifier"],Yn.prototype={__class__:Yn};var zn=function(e,t){this.high=e,this.low=t};(n["haxe._Int64.___Int64"]=zn).__name__=["haxe","_Int64","___Int64"],zn.prototype={__class__:zn};function Gn(e,t){this.lastUpdatedAt=t,null!=e&&(this.userId=e.user_id,this.lastUsedAtOpt=at.option(e.last_used_at))}(n["albero.entity.UserPresence"]=Gn).__name__=["albero","entity","UserPresence"],Gn.createUserPresenceState=function(e,t){var n=t.high-e.high|0,i=t.low-e.low|0;if(ga.ucompare(t.low,e.low)<0){n--;n|=0}var r=new zn(n,i),a=Gn.SIXTY_MINUTES,o=r.high-a.high|0;if(o=0!=o?o:ga.ucompare(r.low,a.low),0<(r.high<0?a.high<0?o:-1:0<=a.high?o:1))return Kn.GT_60;var s=Gn.FIFTEEN_MINUTES,l=r.high-s.high|0;return l=0!=l?l:ga.ucompare(r.low,s.low),0<(r.high<0?s.high<0?l:-1:0<=s.high?l:1)?Kn.LT_OR_EQ_60:Kn.LT_OR_EQ_15},Gn.prototype={toState:function(e){var t=e,n=at.map(this.lastUsedAtOpt,function(e){return Gn.createUserPresenceState(e,t)});switch(n[1]){case 0:return n[2];case 1:return Kn.GT_60}},isExpired:function(e,t){var n=this.lastUpdatedAt,i=e.high-n.high|0,r=e.low-n.low|0;if(ga.ucompare(e.low,n.low)<0){i--;i|=0}var a=new zn(i,r),o=a.high-t.high|0;return o=0!=o?o:ga.ucompare(a.low,t.low),0<(a.high<0?t.high<0?o:-1:0<=t.high?o:1)},__class__:Gn};var Kn=n["albero.entity.UserPresenceState"]={__ename__:["albero","entity","UserPresenceState"],__constructs__:["LT_OR_EQ_15","LT_OR_EQ_60","GT_60"]};Kn.LT_OR_EQ_15=["LT_OR_EQ_15",0],Kn.LT_OR_EQ_15.toString=s,(Kn.LT_OR_EQ_15.__enum__=Kn).LT_OR_EQ_60=["LT_OR_EQ_60",1],Kn.LT_OR_EQ_60.toString=s,(Kn.LT_OR_EQ_60.__enum__=Kn).GT_60=["GT_60",2],Kn.GT_60.toString=s,(Kn.GT_60.__enum__=Kn).__empty_constructs__=[Kn.LT_OR_EQ_15,Kn.LT_OR_EQ_60,Kn.GT_60];function Wn(e){this.success=e}(n["albero.entity.api.message.AddFavoriteMessageResult"]=Wn).__name__=["albero","entity","api","message","AddFavoriteMessageResult"],Wn.prototype={__class__:Wn};function Vn(e){this.success=e}(n["albero.entity.api.message.DeleteFavoriteMessageResult"]=Vn).__name__=["albero","entity","api","message","DeleteFavoriteMessageResult"],Vn.prototype={__class__:Vn};function qn(e,t,n,i,r){this.domainId=e,this.talkId=t,this.marker=n,this.nextMarker=i,this.messages=r}(n["albero.entity.api.message.GetFavoriteMessagesResultWithParams"]=qn).__name__=["albero","entity","api","message","GetFavoriteMessagesResultWithParams"],qn.prototype={getNextMarker:function(){return this.nextMarker},getMessages:function(){return this.messages},__class__:qn};function Qn(e,t,n){this.callerId=e,this.error=t,this.emitterKey=n}(n["albero.entity.api.note.CreateNoteError"]=Qn).__name__=["albero","entity","api","note","CreateNoteError"],Qn.prototype={__class__:Qn};function Jn(e){this.note=new gi(e),this.emitterKey=null}(n["albero.entity.api.note.CreateNoteResult"]=Jn).__name__=["albero","entity","api","note","CreateNoteResult"],Jn.prototype={updateWithEmitterKey:function(e){var t=new Jn;return t.note=this.note,t.emitterKey=e,t},__class__:Jn};function Xn(e){this.result=e}(n["albero.entity.api.note.DeleteNoteResult"]=Xn).__name__=["albero","entity","api","note","DeleteNoteResult"],Xn.prototype={__class__:Xn};function Zn(e){this.note=new gi(e)}(n["albero.entity.api.note.GetNoteResult"]=Zn).__name__=["albero","entity","api","note","GetNoteResult"],Zn.prototype={getNoteId:function(){return this.note.noteId},getNoteCreateUserId:function(){return this.note.createdBy},getRevisionCreateUserId:function(){return this.note.getRevisionCreateUserId()},getNoteCreateDate:function(){return this.note.createdAt},getRevisionCreateDate:function(){return this.note.getRevisionCreateDate()},getLockedUserIdWithoutSelf:function(e){return this.note.getLockedUserIdWithoutSelf(e)},__class__:Zn};function $n(e){null!=e&&(this.marker=e.marker,this.nextMarker=e.next_marker,this.noteStatuses=rt.asArray(e.contents).map(function(e){return new Ri(e)}))}(n["albero.entity.api.note.GetNoteStatusesResult"]=$n).__name__=["albero","entity","api","note","GetNoteStatusesResult"],$n.prototype={isNotEmptyNoteStatuses:function(){return 0<this.noteStatuses.length},__class__:$n};function ei(e){this.note=new gi(e)}(n["albero.entity.api.note.UpdateNoteResult"]=ei).__name__=["albero","entity","api","note","UpdateNoteResult"],ei.prototype={__class__:ei};function ti(e){this.note=new gi(e)}(n["albero.entity.api.note.UpdateNoteSettingResult"]=ti).__name__=["albero","entity","api","note","UpdateNoteSettingResult"],ti.prototype={__class__:ti};function ni(){}(n["albero.entity.file.DummyFileUtil"]=ni).__name__=["albero","entity","file","DummyFileUtil"],ni.getBlobFromUpdatableFile=function(e){return null==e.blob?e:e.blob};function ii(){}(n["albero.entity.file.StageType"]=ii).__name__=["albero","entity","file","StageType"],ii.prototype={__class__:ii};function ri(e,t){this.talkId=e,this.paneType=t}(n["albero.entity.file.StageTypeTalk"]=ri).__name__=["albero","entity","file","StageTypeTalk"],ri.__interfaces__=[ii],ri.prototype={toString:function(){var e=this.talkId;return"staged__"+e.high+"_"+e.low+Ht.toPanePrefix(this.paneType)},isForPane:function(e){return this.paneType==e},isForNote:function(){return!1},isForPreview:function(){return!1},__class__:ri};function ai(){}(n["albero.entity.file.StageTypeNote"]=ai).__name__=["albero","entity","file","StageTypeNote"],ai.__interfaces__=[ii],ai.prototype={toString:function(){return"staged_note_"},isForPane:function(e){return!1},isForNote:function(){return!0},isForPreview:function(){return!1},__class__:ai};function oi(){}(n["albero.entity.message.IFavoriteMessageEvent"]=oi).__name__=["albero","entity","message","IFavoriteMessageEvent"],oi.prototype={__class__:oi};function si(e){this.message=new Mt(e.message),this.domainId=e.domain_id,this.talkId=e.talk_id}(n["albero.entity.message.AddFavoriteMessageEvent"]=si).__name__=["albero","entity","message","AddFavoriteMessageEvent"],si.__interfaces__=[oi],si.prototype={getMessage:function(){return this.message},getMessageId:function(){return this.message.id},isFavorite:function(){return!0},getDomainId:function(){return this.domainId},getTalkId:function(){return this.talkId},__class__:si};function li(e){this.messageId=e.message_id,this.domainId=e.domain_id,this.talkId=e.talk_id}(n["albero.entity.message.DeleteFavoriteMessageEvent"]=li).__name__=["albero","entity","message","DeleteFavoriteMessageEvent"],li.__interfaces__=[oi],li.prototype={getMessageId:function(){return this.messageId},isFavorite:function(){return!1},__class__:li};function ui(){}(n["albero.entity.message.IMessageContentForActionReply"]=ui).__name__=["albero","entity","message","IMessageContentForActionReply"],ui.prototype={__class__:ui};var ci=function(e){null!=e&&(this.noteId=new Si(e.note_id),this.title=e.title,this.revision=e.revision,this.deleted=e.deleted,this.hasAttachments=!!e.has_attachments)};(n["albero.entity.message.MessageContentForNote"]=ci).__name__=["albero","entity","message","MessageContentForNote"],ci.prototype={__class__:ci};var _i=function(e){null!=e&&(this.noteId=new Si(e.note_id),this.title=e.title)};(n["albero.entity.message.MessageContentForNoteDeleted"]=_i).__name__=["albero","entity","message","MessageContentForNoteDeleted"],_i.prototype={__class__:_i};var hi=function(e){this.text=Ca.None,this.stampsetId=it.fromIntOrInt64(e.stampset_id),this.stampId=it.fromIntOrInt64(e.stamp_id),null!=e.text&&(this.text=Ca.Some(e.text))};(n["albero.entity.message.MessageContentForOriginalStamp"]=hi).__name__=["albero","entity","message","MessageContentForOriginalStamp"],hi.prototype={hasValidText:function(){return at.isDefined(this.getValidText())},getValidText:function(){return at.filter(this.text,k.isNotEmpty)},__class__:hi};var di=function(e){this.inReplyTo=e.in_reply_to,this.response=e.response,this.options=e.options,this.listing=null==e.listing||e.listing,this.closingType=null==e.closing_type?1:e.closing_type,this.closed=null!=e.closed&&e.closed};(n["albero.entity.message.MessageContentForSelectOneReply"]=di).__name__=["albero","entity","message","MessageContentForSelectOneReply"],di.__interfaces__=[ui],di.prototype={getResponseIndex:function(){return this.response},__class__:di};var fi=function(e){this.inReplyTo=e.in_reply_to,this.title=e.title,this.listing=null==e.listing||e.listing,this.closingType=null==e.closing_type?1:e.closing_type,this.done=e.done,this.closed=null!=e.closed&&e.closed};(n["albero.entity.message.MessageContentForTodoReply"]=fi).__name__=["albero","entity","message","MessageContentForTodoReply"],fi.__interfaces__=[ui],fi.prototype={getResponseIndex:function(){return this.done?0:1},__class__:fi};var mi=function(e){this.inReplyTo=e.in_reply_to,this.response=e.response,this.question=e.question,this.listing=null==e.listing||e.listing,this.closingType=null==e.closing_type?1:e.closing_type,this.closed=null!=e.closed&&e.closed};(n["albero.entity.message.MessageContentForYesNoReply"]=mi).__name__=["albero","entity","message","MessageContentForYesNoReply"],mi.__interfaces__=[ui],mi.prototype={getResponseIndex:function(){return this.response?0:1},__class__:mi};var pi=function(e){if(null==e)return this.favorite=!1,this.createdAt=null,void(this.tags=[]);this.favorite=!0,this.createdAt=e.created_at,this.tags=e.tags};(n["albero.entity.message.MessageFavorite"]=pi).__name__=["albero","entity","message","MessageFavorite"],pi.prototype={isFavorite:function(){return this.favorite},update:function(e){this.favorite=e.isFavorite()},__class__:pi};var gi=function(e){null!=e&&(this.noteId=new Si(e.note_id),this.talkId=e.talk_id,this.createdBy=e.created_by,this.createdAt=e.created_at,this.setting=new Mi(e.setting),this.noteRevision=new Ci(e.note_revision),this.noteLocked=new bi(e.locked))};(n["albero.entity.note.Note"]=gi).__name__=["albero","entity","note","Note"],gi.prototype={isSameNoteId:function(e){return this.noteId.equals(e)},getRevisionCreateUserId:function(){return this.noteRevision.createdBy},getRevisionCreateDate:function(){return this.noteRevision.createdAt},compareRevision:function(e){return this.noteRevision.compareRevision(e)},lock:function(e,t,n,i){this.noteRevision.revision==e&&this.noteLocked.lock(t,n,i)},unlock:function(e,t){this.noteRevision.revision==e&&this.noteLocked.unlock(t)},getLockedUserIdWithoutSelf:function(e){return this.noteLocked.getLockedUserIdWithoutSelf(e)},__class__:gi};var vi=n["albero.entity.note.NoteContentType"]={__ename__:["albero","entity","note","NoteContentType"],__constructs__:["TEXT","FILES"]};vi.TEXT=["TEXT",0],vi.TEXT.toString=s,(vi.TEXT.__enum__=vi).FILES=["FILES",1],vi.FILES.toString=s,(vi.FILES.__enum__=vi).__empty_constructs__=[vi.TEXT,vi.FILES];function yi(){}(n["albero.entity.note.NoteContentTypeHelper"]=yi).__name__=["albero","entity","note","NoteContentTypeHelper"],yi.createNoteContentType=function(e){if(null==e)return ji._e("["+tt.dateStr(new Date)+"] ","no value.","","","",""),null;switch(e){case 1:return vi.TEXT;case 5:return vi.FILES;default:return ji._e("["+tt.dateStr(new Date)+"] ","value is not expected.","","","",""),null}},yi.getValue=function(e){if(null==e)return ji._e("["+tt.dateStr(new Date)+"] ","no content type.","","","",""),null;switch(e[1]){case 0:return 1;case 1:return 5}};var Si=function(e){this.value=e};(n["albero.entity.note.NoteId"]=Si).__name__=["albero","entity","note","NoteId"],Si.__interfaces__=[At],Si.createDummyId=function(){var e,t=Si.nextDummyId,n=Si.nextDummyId;if(null==n)e=null;else{var i=new zn(0,1),r=n.high-i.high|0,a=n.low-i.low|0;if(ga.ucompare(n.low,i.low)<0){r--;r|=0}e=new zn(r,a)}return Si.nextDummyId=e,new Si(t)},Si.prototype={toString:function(){var e=this.value;return"_"+e.high+"_"+e.low},equals:function(e){if(null==e)return!1;var t=this.value,n=e.value;return null!=t&&null!=n&&t.high==n.high&&t.low==n.low},getHtmlAttributeId:function(){return"note-"+this.toString()},isDummy:function(){return this.value.high<0},__class__:Si};var wi=function(e,t,n,i,r,a){this.state=Ii.SENDING,this.talkId=e,this.noteId=t,this.title=n,this.text=i,this.fileInfos=r,this.emitterKey=a};(n["albero.entity.note.NoteLocalEdit"]=wi).__name__=["albero","entity","note","NoteLocalEdit"],wi.prototype={hasEmitterKey:function(){return null!=this.emitterKey},getEmitterKey:function(){return this.emitterKey},setState:function(e){this.state=e},getTalkId:function(){return this.talkId},getNoteId:function(){return this.noteId},getTitle:function(){return this.title},getText:function(){return this.text},getContent:function(){switch(this.getContentType()[1]){case 0:return this.text;case 1:return{files:this.getUploadedFilesData(),text:null==this.text?"":this.text}}},getFileInfos:function(){return this.fileInfos},getState:function(){return this.state},isSending:function(){return this.state==Ii.SENDING},isFailed:function(){switch(this.state[1]){case 0:case 5:return!1;case 1:case 2:case 3:case 4:return!0}},isForCreate:function(){return this.noteId.isDummy()},canNotSend:function(){return 0!=this.getUnuploadedFileInfos().length},getContentType:function(){return 0<this.fileInfos.length?vi.FILES:vi.TEXT},getUnuploadedFileInfos:function(){return this.fileInfos.filter(function(e){return e.isNotUploaded()})},getUploadedFilesData:function(){return this.fileInfos.map(function(e){return e.getUploadedFileData()}).filter(function(e){return null!=e})},createNoteRevisionSummary:function(e){var t=new Oi;return t.revision=0,t.contentType=this.getContentType(),t.title=this.title,t.contentSummary=this.text,t.createdBy=e,t.createdAt=T.nowAsInt64(),t.contentFiles=this.fileInfos,t},conflict:function(){this.state=Ii.FAILED_BY_CONFLICT},deleted:function(){this.state=Ii.FAILED_BY_NOT_FOUND},__class__:wi};var Ii=n["albero.entity.note.NoteLocalEditState"]={__ename__:["albero","entity","note","NoteLocalEditState"],__constructs__:["SENDING","FAILED_BY_CONFLICT","FAILED_BY_NOT_FOUND","FAILED_BY_FILE","FAILED_BY_UNKNOWN","COMPLETED"]};Ii.SENDING=["SENDING",0],Ii.SENDING.toString=s,(Ii.SENDING.__enum__=Ii).FAILED_BY_CONFLICT=["FAILED_BY_CONFLICT",1],Ii.FAILED_BY_CONFLICT.toString=s,(Ii.FAILED_BY_CONFLICT.__enum__=Ii).FAILED_BY_NOT_FOUND=["FAILED_BY_NOT_FOUND",2],Ii.FAILED_BY_NOT_FOUND.toString=s,(Ii.FAILED_BY_NOT_FOUND.__enum__=Ii).FAILED_BY_FILE=function(e,t){var n=["FAILED_BY_FILE",3,e,t];return n.__enum__=Ii,n.toString=s,n},Ii.FAILED_BY_UNKNOWN=["FAILED_BY_UNKNOWN",4],Ii.FAILED_BY_UNKNOWN.toString=s,(Ii.FAILED_BY_UNKNOWN.__enum__=Ii).COMPLETED=["COMPLETED",5],Ii.COMPLETED.toString=s,(Ii.COMPLETED.__enum__=Ii).__empty_constructs__=[Ii.SENDING,Ii.FAILED_BY_CONFLICT,Ii.FAILED_BY_NOT_FOUND,Ii.FAILED_BY_UNKNOWN,Ii.COMPLETED];function Ti(e){null!=e&&(this.noteId=new Si(e.note_id),this.revision=e.revision,this.userId=e.user_id,this.deviceId=e.device_id,this.expiredAt=e.expired_at)}(n["albero.entity.note.NoteLockEvent"]=Ti).__name__=["albero","entity","note","NoteLockEvent"],Ti.prototype={__class__:Ti};function Ei(e){this.value=e}(n["albero.entity.note.NoteLockExpiredAt"]=Ei).__name__=["albero","entity","note","NoteLockExpiredAt"],Ei.prototype={fromNow:function(){var e=this.value,t=4294967296,n=e.high,i=e.low;return n*t+(0<=i?i:i+t)-(new Date).getTime()|0},calcRelockDelay:function(){return.9*this.fromNow()|0},__class__:Ei};var Ni=n["albero.entity.note.NoteLockStateValue"]={__ename__:["albero","entity","note","NoteLockStateValue"],__constructs__:["FAILED_BY_CONFLICT","FAILED_BY_LOCKED","FAILED_BY_NOT_FOUND","FAILED_BY_UNKNOWN","COMPLETED","RELEASED"]};Ni.FAILED_BY_CONFLICT=["FAILED_BY_CONFLICT",0],Ni.FAILED_BY_CONFLICT.toString=s,(Ni.FAILED_BY_CONFLICT.__enum__=Ni).FAILED_BY_LOCKED=function(e){var t=["FAILED_BY_LOCKED",1,e];return t.__enum__=Ni,t.toString=s,t},Ni.FAILED_BY_NOT_FOUND=["FAILED_BY_NOT_FOUND",2],Ni.FAILED_BY_NOT_FOUND.toString=s,(Ni.FAILED_BY_NOT_FOUND.__enum__=Ni).FAILED_BY_UNKNOWN=["FAILED_BY_UNKNOWN",3],Ni.FAILED_BY_UNKNOWN.toString=s,(Ni.FAILED_BY_UNKNOWN.__enum__=Ni).COMPLETED=function(e){var t=["COMPLETED",4,e];return t.__enum__=Ni,t.toString=s,t},Ni.RELEASED=["RELEASED",5],Ni.RELEASED.toString=s,(Ni.RELEASED.__enum__=Ni).__empty_constructs__=[Ni.FAILED_BY_CONFLICT,Ni.FAILED_BY_NOT_FOUND,Ni.FAILED_BY_UNKNOWN,Ni.RELEASED];function Ai(e){this.value=e}(n["albero.entity.note.NoteLockState"]=Ai).__name__=["albero","entity","note","NoteLockState"],Ai.prototype={isCompleted:function(){return 4==this.value[1]},getExpiredAtOrNull:function(){var e=this.value;return 4!=e[1]?null:e[2]},isLockedByOther:function(){return 1==this.value[1]},getLockedUser:function(){var e=this.value;return 1!=e[1]?null:e[2]},__class__:Ai};var bi=function(e){null!=e&&(this.userId=e.user_id,this.deviceId=e.device_id,this.expiredAt=e.expired_at)};(n["albero.entity.note.NoteLocked"]=bi).__name__=["albero","entity","note","NoteLocked"],bi.prototype={lock:function(e,t,n){this.expiredAt=n,this.deviceId=t,this.userId=e},unlock:function(e){var t=this.userId;null!=t&&null!=e&&t.high==e.high&&t.low==e.low&&(this.expiredAt=null,this.userId=null,this.deviceId=null)},getLockedUserIdWithoutSelf:function(e){var t,n=this.deviceId;if(null!=n&&null!=e&&n.high==e.high&&n.low==e.low)return null;if(null!=this.expiredAt){var i=this.expiredAt,r=4294967296,a=i.high,o=i.low;t=a*r+(0<=o?o:o+r)<=(new Date).getTime()}else t=!0;return t?null:this.userId},__class__:bi};function Di(e){null!=e&&(this.noteId=new Si(e.note_id),this.talkId=e.talk_id,this.setting=new Mi(e.setting))}(n["albero.entity.note.NotePartialUpdateForSetting"]=Di).__name__=["albero","entity","note","NotePartialUpdateForSetting"],Di.prototype={__class__:Di};function ki(e){null!=e&&(this.noteId=new Si(e.note_id),this.talkId=e.talk_id,this.noteRevisionSummary=new Oi(e.note_revision_summary))}(n["albero.entity.note.NotePartialUpdateForSummary"]=ki).__name__=["albero","entity","note","NotePartialUpdateForSummary"],ki.prototype={getRevision:function(){return this.noteRevisionSummary.revision},getUpdatedBy:function(){return this.noteRevisionSummary.createdBy},getUpdatedAt:function(){return this.noteRevisionSummary.createdAt},__class__:ki};var Ci=function(e){if(this.contentFiles=[],null!=e){switch(this.revision=e.revision,this.title=e.title,this.contentType=yi.createNoteContentType(e.content_type),this.contentType[1]){case 0:this.contentText=e.content;break;case 1:if(this.contentText=null==e.content.text?"":e.content.text,null!=e.content.files)for(var t=0,n=Ga.__cast(e.content.files,Array);t<n.length;){var i=n[t];++t,this.contentFiles.push(new St(i))}}this.createdBy=e.created_by,this.createdAt=e.created_at}};(n["albero.entity.note.NoteRevision"]=Ci).__name__=["albero","entity","note","NoteRevision"],Ci.prototype={isEmptyTitle:function(){return""==this.title||null==this.title},compareRevision:function(e){return this.revision==e?0:this.revision<e?-1:1},__class__:Ci};var Oi=function(e){if(null!=e&&(this.revision=e.revision,this.title=e.title,this.contentType=yi.createNoteContentType(e.content_type),this.contentSummary=e.content_summary,this.createdBy=e.created_by,this.createdAt=e.created_at,this.contentFiles=[],null!=e.content_files))for(var t=0,n=Ga.__cast(e.content_files,Array);t<n.length;){var i=n[t];++t,this.contentFiles.push(new St(i))}};(n["albero.entity.note.NoteRevisionSummary"]=Oi).__name__=["albero","entity","note","NoteRevisionSummary"],Oi.prototype={isEmptyTitle:function(){return""==this.title||null==this.title},compareRevision:function(e){return this.revision==e?0:this.revision<e?-1:1},getContentSummaryWithEllipsis:function(){var e=W.replace(W.replace(this.contentSummary,"- [x] ",""),"- [ ] ","");return e.length<100?e:e.substring(0,99)+""},__class__:Oi};var Mi=function(e){null!=e&&(this.collaborativeEditing=e.collaborative_editing,this.version=e.version)};(n["albero.entity.note.NoteSetting"]=Mi).__name__=["albero","entity","note","NoteSetting"],Mi.prototype={__class__:Mi};var Ri=function(e){null!=e&&(this.noteId=new Si(e.note_id),this.noteSummary=new Fi(e.note_summary),this.commentIds=e.comment_ids,this.readUserIds=e.read_user_ids)};(n["albero.entity.note.NoteStatus"]=Ri).__name__=["albero","entity","note","NoteStatus"],Ri.prototype={getNoteRevisionSummary:function(){return this.noteSummary.noteRevisionSummary},__class__:Ri};var Fi=function(e){null!=e&&(this.noteId=new Si(e.note_id),this.talkId=e.talk_id,this.createdBy=e.created_by,this.createdAt=e.created_at,this.setting=new Mi(e.setting),this.noteRevisionSummary=new Oi(e.note_revision_summary),this.noteLocked=new bi(e.locked))};(n["albero.entity.note.NoteSummary"]=Fi).__name__=["albero","entity","note","NoteSummary"],Fi.prototype={getNoteIdByString:function(){return this.noteId.toString()},getRevisionCreatedAt:function(){return this.noteRevisionSummary.createdAt},getRevisionContentSummary:function(){return this.noteRevisionSummary.contentSummary},getRevisionTitle:function(){return this.noteRevisionSummary.isEmptyTitle()?"":this.noteRevisionSummary.title},getNoteIdJQueryId:function(){return this.noteId.getHtmlAttributeId()},lock:function(e,t,n,i){this.noteRevisionSummary.revision==e&&this.noteLocked.lock(t,n,i)},unlock:function(e,t){this.noteRevisionSummary.revision==e&&this.noteLocked.unlock(t)},__class__:Fi};function xi(){}(n["albero.entity.note.NoteTextParts"]=xi).__name__=["albero","entity","note","NoteTextParts"],xi.isUncheckedCheckBox=function(e){return W.startsWith(e,"- [ ] ")},xi.isCheckedCheckBox=function(e){return!!W.startsWith(e,"- [x] ")||W.startsWith(e,"- [x] ".toUpperCase())};function Ui(e){null!=e&&(this.noteId=new Si(e.note_id),this.revision=e.revision,this.userId=e.user_id)}(n["albero.entity.note.NoteUnlockEvent"]=Ui).__name__=["albero","entity","note","NoteUnlockEvent"],Ui.prototype={__class__:Ui};function Pi(){}(n["albero.js.KatakanaToRoman"]=Pi).__name__=["albero","js","KatakanaToRoman"],Pi.assureConvertTable=function(){return null!=Pi.convertTable||(Pi.convertTable=new Ma,nt.iter([["","A"],["","I"],["","U"],["","E"],["","O"],["","KA"],["","KI"],["","KU"],["","KE"],["","KO"],["","KYA"],["","KYU"],["","KYO"],["","SA"],["","SI"],["","SU"],["","SE"],["","SO"],["","SHA"],["","SHU"],["","SHO"],["","TA"],["","TI"],["","TU"],["","TE"],["","TO"],["","THA"],["","THU"],["","THO"],["","NA"],["","NI"],["","NU"],["","NE"],["","NO"],["","NYA"],["","NYU"],["","NYO"],["","HA"],["","HI"],["","FU"],["","HE"],["","HO"],["","HYA"],["","HYU"],["","HYO"],["","MA"],["","MI"],["","MU"],["","ME"],["","MO"],["","MYA"],["","MYU"],["","MYO"],["","YA"],["","YU"],["","YO"],["","RA"],["","RI"],["","RU"],["","RE"],["","RO"],["","RYA"],["","RYU"],["","RYO"],["","WA"],["","O"],["","N"],["","GA"],["","GI"],["","GU"],["","GE"],["","GO"],["","GYA"],["","GYU"],["","GYO"],["","ZA"],["","JI"],["","ZU"],["","ZE"],["","ZO"],["","ZYA"],["","ZYU"],["","ZYO"],["","DA"],["","JI"],["","ZU"],["","DE"],["","DO"],["","BA"],["","BI"],["","BU"],["","BE"],["","BO"],["","BYA"],["","BYU"],["","BYO"],["","PA"],["","PI"],["","PU"],["","PE"],["","PO"],["","PYA"],["","PYU"],["","PYO"],["",""],["",""]],function(e){var t=Pi.convertTable,n=e[0],i=e[1];null!=Io[n]?t.setReserved(n,i):t.h[n]=i})),Pi.convertTable},Pi.matchNext=function(e,t){var n=Pi.assureConvertTable();if(t+1<e.length){var i=e.substring(t,t+2),r=null!=Io[i]?n.getReserved(i):n.h[i];if(null!=r)return Li.MatchedToTwoCharsKey(r)}if(t<e.length){var a=e.substring(t,t+1),o=null!=Io[a]?n.getReserved(a):n.h[a];if(null!=o)return Li.MatchedToOneCharKey(o)}var s=t<e.length?e.substring(t,t+1):"";return Li.NotMatched(s)},Pi.prototype={convert:function(e){for(var t=0,n="";t<e.length;){var i=Pi.matchNext(e,t);switch(i[1]){case 0:t+=2,n+=i[2];break;case 1:++t,n+=i[2];break;case 2:++t,n+=i[2]}}return n=(n=n.replace(Pi.TU_REG.r,"$1$1")).replace(Pi.XTU_REG.r,"XTU")},__class__:Pi};var Li=n["albero.js.ResultOfMatchNext"]={__ename__:["albero","js","ResultOfMatchNext"],__constructs__:["MatchedToTwoCharsKey","MatchedToOneCharKey","NotMatched"]};Li.MatchedToTwoCharsKey=function(e){var t=["MatchedToTwoCharsKey",0,e];return t.__enum__=Li,t.toString=s,t},Li.MatchedToOneCharKey=function(e){var t=["MatchedToOneCharKey",1,e];return t.__enum__=Li,t.toString=s,t},Li.NotMatched=function(e){var t=["NotMatched",2,e];return t.__enum__=Li,t.toString=s,t},Li.__empty_constructs__=[];var Bi=function(e){this.isDirty=!1,this.key=e};(n["albero.js.LocalStorage"]=Bi).__name__=["albero","js","LocalStorage"],Bi.getLocalStorage=function(){return new(require("node-localstorage").LocalStorage)(null!=wo.storagePath?wo.storagePath:"./storage.local",null!=wo.storageQuota?K.parseInt(wo.storageQuota):null)},Bi.prototype={load:function(){var e=this.val();if(null==e||""==e)return null;var t=null;try{t=Ta.run(e),this.isDirty=!1}catch(e){e instanceof za&&(e=e.val),ji._w("["+tt.dateStr(new Date)+"] ",e,"","","","")}return t},save:function(e){try{this.val(Sa.run(e)),this.isDirty=!1}catch(e){e instanceof za&&(e=e.val),ji._w("["+tt.dateStr(new Date)+"] ",e,"","","","")}},setDirtyFlag:function(){if(!this.isDirty)try{this.val(""),this.isDirty=!0}catch(e){e instanceof za&&(e=e.val),ji._w("["+tt.dateStr(new Date)+"] ",e,"","","","")}},val:function(e){var t=Bi.getLocalStorage();return null!=t&&(null==e?e=t.getItem(this.key):""==e?t.removeItem(this.key):t.setItem(this.key,e)),e},__class__:Bi};var Hi=function(){};(n["albero.js.Localizer"]=Hi).__name__=["albero","js","Localizer"],Hi.setLocalizeForMock=function(e,t){null==Hi.mock&&(Hi.mock=new Ma);var n=Hi.mock;null!=Io[e]?n.setReserved(e,t):n.h[e]=t},Hi.setLocalizeValueForMock=function(e,t){Hi.setLocalizeForMock(e,function(e){return t})},Hi.localizeForMock=function(e,t){if(null==Hi.mock)return null;var n=Hi.mock,i=null!=Io[e]?n.getReserved(e):n.h[e];return null==i?null:i(t)},Hi.runOrReserve=function(e){e()},Hi.localize=function(e,t){return""},Hi.asyncPrepare=function(){return Promise.resolve()};var ji=e.AlberoLog=function(){};(n.AlberoLog=ji).__name__=["AlberoLog"],ji.getLogLevel=function(e){switch(e=null!=e?e.toUpperCase():"INFO"){case"ALERT":return 1;case"CRITICAL":return 2;case"EMERGENCY":return 0;case"ERROR":return 3;case"INFO":return 6;case"NOTICE":return 5;case"WARNING":return 4;default:return 7}},ji._nop=function(){},ji.dateStr=function(){return"["+tt.dateStr(new Date)+"] "};function Yi(e,t,n){this.ignoreCase=t,this.normalizeFunc=n,t&&(e=e.toUpperCase()),this.normalizedPattern=n(e)}(n["albero.js.NFKCTextSearch"]=Yi).__name__=["albero","js","NFKCTextSearch"],Yi.prototype={search:function(e){var t=new I,n=[];this.ignoreCase&&(e=e.toUpperCase()),this.normalize(e,t,n);for(var i,r=0,a=[],o=t.b;-1!=(i=o.indexOf(this.normalizedPattern,r));){r=i+this.normalizedPattern.length;for(var s=n[i],l=n[r-1],u=null,c=r,_=n.length;c<_;){if(l!=(u=n[c++]))break;u=null}null==u&&(u=e.length),a.push(new zi(s,u))}return a},normalize:function(e,t,n){for(var i=e.length,r=new I,a=0,o=0,s=i;o<s;){var l=o++,u=r.b.length,c=r.b,_=c+e.charAt(l),h=this.normalizeFunc(_);if(_!=h)if(W.startsWith(h,c)){var d=c.substring(0,u);t.b+=K.string(d),r=new I;var f=h.substring(u,h.length);r.b+=K.string(f);for(var m=0,p=u;m<p;){m++;n.push(a)}a=l}else(r=new I).b+=null==h?"null":""+h;else{t.b+=K.string(r),r=new I;var g=e.charAt(l);r.b+=K.string(g);for(var v=0,y=u;v<y;){v++;n.push(a)}a=l}}t.b+=K.string(r.b);for(var S=0,w=r.b.length;S<w;){S++;n.push(a)}},__class__:Yi};var zi=function(e,t){this.start=e,this.end=t};(n["albero.js.HitSpan"]=zi).__name__=["albero","js","HitSpan"],zi.prototype={__class__:zi};function Gi(){}(n["albero.js.PromiseHelper"]=Gi).__name__=["albero","js","PromiseHelper"],Gi.resolveVoid=function(e){e()},Gi.delay=function(n){return new Promise(function(e,t){wa.delay(function(){Gi.resolveVoid(e)},n)})};function Ki(){}(n["albero.js.ProxyHelper"]=Ki).__name__=["albero","js","ProxyHelper"],Ki.createAgent=function(e){var t=Qa.parse(e),n={host:t.hostname};null!=t.port&&(n.port=K.parseInt(t.port)),null!=t.auth&&(n.proxyAuth=t.auth);var i=require("tunnel-agent");return("https:"==t.protocol?i.httpsOverHttps:i.httpsOverHttp)({proxy:n})};function Wi(){}(n["albero.js.SettingsResolver"]=Wi).__name__=["albero","js","SettingsResolver"],Wi.get=function(e,t){return null!=e?e:t},Wi.getAcceptableEventTimeDiff=function(){return ya.parseString(Wi.get(wo.acceptableEventTimeDiff,"10000"))};var Vi=function(){};(n["albero.js.TextCanonicalizer"]=Vi).__name__=["albero","js","TextCanonicalizer"],Vi.canonicalize=function(e){return Vi.basicLatinAlphabetToUpperCase(Vi.hiraganaToKatakana(Vi.normalize(Vi.eraseInvisible(e))))},Vi.canonicalizeForRoman=function(e){return Vi.basicLatinAlphabetToUpperCase(Vi.katakanaToRoman(Vi.hiraganaToKatakana(Vi.normalize(Vi.eraseInvisible(e)))))},Vi.basicLatinAlphabetToUpperCase=function(e){return e.toUpperCase()},Vi.hiraganaToKatakana=function(e){for(var t=0,n="",i=0,r=e.length;i<r;){var a=i++,o=tt.cca(e,a);o>=Vi.HIRAGANA_SMALL_A&&o<=Vi.HIRAGANA_NN&&(n+=e.substring(t,a),n+=String.fromCharCode(o+(Vi.KATAKANA_SMALL_A-Vi.HIRAGANA_SMALL_A)),t=1+a)}return n+=e.substring(t,e.length)},Vi.katakanaToRoman=function(e){return(new Pi).convert(e)},Vi.normalize=function(e){return new qi(null).normalize(e)},Vi.normalizeForFile=function(e){return new qi(null).normalizeForFile(e)},Vi.asyncAssureNormalize=function(){return Promise.resolve()},Vi.eraseInvisible=function(e){var t=new RegExp("[\\u0000-\\u0020]","g".split("u").join(""));return e.replace(t,"")};var qi=function(e){this.beforeTask=null,this.beforeTask=e};(n["albero.js.Normalizer"]=qi).__name__=["albero","js","Normalizer"],qi.prototype={normalize:function(e){try{return null!=this.beforeTask&&this.beforeTask(),e.normalize("NFKC")}catch(e){return e instanceof za&&(e=e.val),ji._e("["+tt.dateStr(new Date)+"] ","invalid character:",e,"","",""),Hi.localize("TextCanonicalizer.invalid")}},normalizeForFile:function(e){try{return null!=this.beforeTask&&this.beforeTask(),e.normalize("NFC")}catch(e){return e instanceof za&&(e=e.val),ji._e("["+tt.dateStr(new Date)+"] ","invalid character:",e,"","",""),Hi.localize("TextCanonicalizer.invalid")}},__class__:qi};function Qi(e){var t=this,n=wo.wsConfig,i=require("websocket").client;this.ws=new i(n),this.ws.on("connectFailed",fo(this,this.onError)),this.ws.on("connect",function(e){(t.connection=e).on("error",fo(t,t.onError)),e.on("close",fo(t,t.onConnectionClose)),e.on("message",fo(t,t.onMessage)),e.on("pong",fo(t,t.onPong)),t.onOpen(null)});var r=null;null!=wo.proxyURL&&(r={agent:Ki.createAgent(wo.proxyURL)}),this.ws.connect(e,null,null,null,r)}(n["albero.js.WebSocket"]=Qi).__name__=["albero","js","WebSocket"],Qi.prototype={onOpen:function(e){ji._i("["+tt.dateStr(new Date)+"] ","WebSocket opened.","","","",""),null!=this.onopen&&this.onopen()},onMessage:function(e){if(null!=this.onmessage){var t;t=this.getBinaryDataForHubot(e),this.onmessage(t)}},getBinaryDataForHubot:function(e){return Ra.ofData(e.binaryData)},onPong:function(e){null!=this.onpong&&this.onpong(e)},onError:function(e){ji._e("["+tt.dateStr(new Date)+"] ","WebSocket error. event:",e,"","",""),null!=this.onerror&&this.onerror()},onClose:function(e){this.removeAllEventListenersForHubot();var t="WebSocket closed. "+K.string(e.code)+" "+K.string(e.reason)+" "+K.string(e.wasClean);ji._i("["+tt.dateStr(new Date)+"] ",t,"","","",""),null!=this.onclose&&this.onclose(e.code,e.reason,e.wasClean)},removeAllEventListenersForHubot:function(){null!=this.ws&&(this.ws.removeAllListeners(),this.ws=null),null!=this.connection&&(this.connection.removeAllListeners(),this.connection=null)},onConnectionClose:function(e,t){this.onClose({code:e,reason:t})},close:function(){if(!this.isClosed()){var e=this.connection;this.onConnectionClose(1e3,"Normal connection closure"),e.close()}},send:function(e){this.isClosed()||this.connection.sendBytes(new Ja(e.b.bufferValue))},ping:function(e){this.connection.ping(e)},isClosed:function(){return null==this.ws||null==this.connection||!this.connection.connected},__class__:Qi};function Ji(){}(n["albero.js.WebSocketFactory"]=Ji).__name__=["albero","js","WebSocketFactory"],Ji.newInstance=function(e){return new Qi(e)};function Xi(){}(n["puremvc.interfaces.IProxy"]=Xi).__name__=["puremvc","interfaces","IProxy"],Xi.prototype={__class__:Xi};function Zi(){}(n["albero.proxy.AccessTokenResolverProxy"]=Zi).__name__=["albero","proxy","AccessTokenResolverProxy"],Zi.__interfaces__=[Xi],Zi.prototype={__class__:Zi};var $i=function(){};(n["albero.proxy.AccessTokenResolverProxyFactory"]=$i).__name__=["albero","proxy","AccessTokenResolverProxyFactory"],$i.newInstance=function(){return new tr("accessTokenResolver")};var er=function(e,t){x.call(this),this.proxyName=null!=e?e:er.NAME,null!=t&&this.setData(t)};(n["puremvc.patterns.proxy.Proxy"]=er).__name__=["puremvc","patterns","proxy","Proxy"],er.__interfaces__=[Xi],er.__super__=x,er.prototype=i(x.prototype,{getProxyName:function(){return this.proxyName},setData:function(e){this.data=e},getData:function(){return this.data},onRegister:function(){},onRemove:function(){},__class__:er});var tr=function(e){er.call(this,e)};(n["albero.proxy.AccessTokenResolverProxyForDirectJsHubot"]=tr).__name__=["albero","proxy","AccessTokenResolverProxyForDirectJsHubot"],tr.__interfaces__=[Zi],tr.__super__=er,tr.prototype=i(er.prototype,{asyncGetAccessToken:function(e,t){var n=this.settings.getAccessToken();if(null==n){var i=null!=wo.account?wo.account.split(":"):null;null==i||2!=i.length?null!=(e=null==e?this.accountLoader.load():e)&&(null!=e.accessToken?(this.settings.setAccessToken(e.accessToken),t(e.accessToken)):this.api.createAccessToken(e.email,e.pass,t)):this.api.createAccessToken(i[0],i[1],t)}else t(n)},__class__:tr});function nr(){}(n["albero.proxy.AccountLoaderProxy"]=nr).__name__=["albero","proxy","AccountLoaderProxy"],nr.__interfaces__=[Xi],nr.prototype={__class__:nr};var ir=function(){};(n["albero.proxy.AccountLoaderProxyFactory"]=ir).__name__=["albero","proxy","AccountLoaderProxyFactory"],ir.newInstance=function(){var e=ee.resolveClass("albero.debug.proxy.AccountLoaderProxyImpl");return null!=e?ee.createInstance(e,["accountLoader"]):new rr("accountLoader")};var rr=function(e){er.call(this,e)};(n["albero.proxy.AccountLoaderProxyForHubot"]=rr).__name__=["albero","proxy","AccountLoaderProxyForHubot"],rr.__interfaces__=[nr],rr.__super__=er,rr.prototype=i(er.prototype,{load:function(){var i=this,t=require("read");return t({prompt:"Email: "},function(e,n){t({prompt:"Password: ",silent:!0},function(e,t){i.sendNotification("SignIn",new De(n,t))})}),null},__class__:rr});var ar=function(){er.call(this,"broadcast")};(n["albero.proxy.AlberoBroadcastProxy"]=ar).__name__=["albero","proxy","AlberoBroadcastProxy"],ar.__super__=er,ar.prototype=i(er.prototype,{handleNotification:function(n,e,i){var r=this;switch(ji._d("["+tt.dateStr(new Date)+"] ","Receive request from server. name:",n," body:",e,""),n){case"notify_add_account_control_request":var t=new lt(e);this.dataStore.setAccountControlRequest(t),this.sendNotification(n,t),i();break;case"notify_add_acquaintance":var a=this.dataFactory.newAcquaintance(e[1]);this.sendNotification(n,a),i();break;case"notify_add_acquaintances":for(var o=e[1].map(fo(_o=this.dataFactory,_o.newAcquaintance)),s=0;s<o.length;){var l=o[s];++s,this.sendNotification("notify_add_acquaintance",l)}this.sendNotification(n,o),i();break;case"notify_add_domain_invite":var u=new ft(e);this.dataStore.setDomainInvite(u),this.sendNotification(n,u),i();break;case"notify_add_favorite_message":var c=new si(e);this.messageStore.onAddFavoriteMessage(c),this.sendNotification(n,c),i();break;case"notify_add_favorite_talk":var _=new yt(e);this.updateTalkStatusByFavoriteTalkEvent(_),this.sendNotification(n,_),i();break;case"notify_add_friend":var h=this.dataFactory.newFriend(e[1]);this.sendNotification(n,h),i();break;case"notify_add_talkers":var d=new Tn(e);null==this.dataStore.getTalk(d.id)&&this.sendNotification("notify_add_talkers_including_me",d),this.dataStore.setTalk(d),this.sendNotification(n,d),i();break;case"notify_close_conference":var f=new ht(e);this.conferenceStore.removeConference(f),this.updateTalkStatusByConferenceClosedEvent(f),this.sendNotification(n,f),i();break;case"notify_conference_participant_join":var m,p=e[3],g=e[4],v=this.dataStore;if(null!=v.me){var y=v.me.id;m=null!=y&&null!=g&&y.high==g.high&&y.low==g.low}else m=!1;m&&this.dataStore.addReactedConfereceId(p),this.sendNotification(n,e),i();break;case"notify_conference_participant_reject":var S=e[3];this.dataStore.addReactedConfereceId(S),this.sendNotification(n,e),i();break;case"notify_create_announcement":var w=new ut(e);this.keywordWatcher.onAnnouncementCreated(w),this.sendNotification("notify_update_announcement_status",this.newAnnouncementStatus(w)),this.sendNotification(n,w),i();break;case"notify_create_message":var I=new Mt(e);this.messageStore.setMessage(I),this.keywordWatcher.onMessageCreated(I);var T=this.newTalkStatusByMessage(I);switch(null!=T&&this.sendNotification("notify_update_local_talk_status",T),I.type[1]){case 0:var E=I.content,N=null;switch(E.type){case"delete_talker":N=E.deleted_user_id;break;case"hide_pair_talk":N=E.user_id}if(null==N)return this.sendNotification(n,I),void i();for(var A=I.talkId,b=this.dataStore.getQuestions(A,N),D=0;D<b.length;){var k=b[D];++D,k.closed=!0,this.sendNotification("notify_update_question",k)}this.sendNotification(n,I),i();break;case 4:if(null!=I.content.file_id){var C=[St.fromMessageAndFile(I,I.content)];this.fileInfoStore.setMessageFileInfos(I.id,C),nt.iter(C,function(e){r.fileInfoStore.setTalkFileInfo(e,!1),r.sendNotification("notify_create_attachment",e)})}this.sendNotification(n,I),i();break;case 5:var O=I,M=rt.asArray(I.content.files).map(function(e){return St.fromMessageAndFile(O,e)});this.fileInfoStore.setMessageFileInfos(I.id,M),nt.iter(M,function(e){r.fileInfoStore.setTalkFileInfo(e,!1),r.sendNotification("notify_create_attachment",e)}),this.sendNotification(n,I),i();break;case 13:case 15:case 17:wa.delay(function(){var e=r.dataStore.getTalk(I.talkId);if(null!=e){var t=r.dataStore.setQuestion(Qt.fromMessageAndTalk(I,e));r.sendNotification("notify_update_question",t)}r.sendNotification(n,I),i()},500);break;case 14:case 16:case 18:case 19:case 20:case 21:var R=I.content.in_reply_to,F=this.dataStore.getTalk(I.talkId),x=this.dataStore.getQuestion(R);if(null!=F&&null!=x){var U,P=this.dataStore,L=I.userId;if(null!=P.me){var B=P.me.id;U=null!=B&&null!=L&&B.high==L.high&&B.low==L.low}else U=!1;x.updateByMessage(I,U),this.sendNotification("notify_update_question",x),I.isClosedActionStampMessage()&&this.messageStore.onActionStampClose(R),this.sendNotification(n,I),i()}else this.sendNotification(n,I),i();break;default:this.sendNotification(n,I),i()}break;case"notify_create_note":var H=new Fi(e);this.dataStore.setNoteRevisionSummary(H.noteId,H.noteRevisionSummary),this.sendNotification(n,H),i();break;case"notify_create_group_talk":case"notify_create_pair_talk":var j=new Tn(e);this.dataStore.setTalk(j),this.newTalkStatusByTalk(j),this.sendNotification(n,j),i();break;case"notify_delete_account_control_request":var Y=it.fromIntOrInt64(e);this.dataStore.removeAccountControlRequest(Y),this.sendNotification(n,Y),i();break;case"notify_delete_acquaintance":this.dataStore.removeAcquaintance(e[0],e[1]),this.sendNotification(n,e),i();break;case"notify_delete_acquaintances":for(var z=e[0],G=e[1],K=0;K<G.length;){var W=G[K];++K,this.dataStore.removeAcquaintance(z,W),this.sendNotification("notify_delete_acquaintance",[z,W])}this.sendNotification(n,e),i();break;case"notify_delete_announcement":var V=e[0],q=e[1],Q=this.dataStore.getAnnouncementStatus(V);if(null!=Q){var J;if(ct.isUnread(Q,q)&&(Q.unreadCount-=1,Q.unreadCount<0&&(Q.unreadCount=0)),null!=Q.maxAnnouncementId){var X=Q.maxAnnouncementId;J=null!=X&&null!=q&&X.high==q.high&&X.low==q.low}else J=!1;J&&null!=Q.maxAnnouncement&&(Q.maxAnnouncement.type=Rt.deleted,Q.maxAnnouncement.content=""),this.dataStore.setAnnouncementStatus(Q)}this.sendNotification(n,e),i();break;case"notify_delete_attachment":var Z=new It(e);this.messageStore.onFileDeleted(Z),this.fileInfoStore.onFileDeleted(Z),this.sendNotification(n,Z),i();break;case"notify_delete_domain_invite":var $=e;this.dataStore.removeDomainInvite($),this.sendNotification(n,$),i();break;case"notify_delete_favorite_message":var ee=new li(e);this.messageStore.onDeleteFavoriteMessage(ee),this.sendNotification(n,ee),i();break;case"notify_delete_favorite_talk":var te=new yt(e);this.updateTalkStatusByFavoriteTalkEvent(te),this.sendNotification(n,te),i();break;case"notify_delete_friend":this.dataStore.removeFriend(e[0],e[1]),this.sendNotification(n,e),i();break;case"notify_delete_message":var ne=new Ft(e);at.foreach(this.messageStore.getMessage(ne.messageId),function(e){e.type=Rt.deleted,e.content=""});var ie=this.updateTalkStatusOnMessageDelete(ne);null!=ie&&this.sendNotification("notify_update_local_talk_status",ie),this.sendNotification(n,ne),i();break;case"notify_delete_note":var re=new Si(e);this.dataStore.setNote(re,null),this.dataStore.setNoteRevisionSummary(re,null);var ae=this.dataStore.getNoteLocalEdit(re);null!=ae&&ae.deleted(),this.sendNotification(n,re),i();break;case"notify_delete_stampset":var oe=e;nt.iter(this.dataStore.getDomains(),function(e){e.deleteStampsetInfo(oe)}),this.stampsStore.removeStampsetInfo(oe),this.sendNotification(n,oe),i();break;case"notify_delete_talk":var se=e;this.dataStore.removeTalk(se),this.dataStore.removeTalkStatus(se),this.conferenceStore.removeConferencesOnLeaveTalk(se),this.sendNotification("brand_badge_changed"),this.sendNotification(n,e),i();break;case"notify_disable_push_notification":var le=new On(e);this.updateTalkStatusByTalkPushNotificationEvent(!1,le),this.sendNotification(n,le),i();break;case"notify_enable_push_notification":var ue=new On(e);this.updateTalkStatusByTalkPushNotificationEvent(!0,ue),this.sendNotification(n,ue),i();break;case"notify_join_account_control_group":var ce=new ot(e);this.dataStore.setAccountControlGroup(ce),this.dataStore.removeAccountControlRequests(),this.sendNotification("brand_badge_changed"),this.sendNotification(n,ce),i();break;case"notify_join_domain":var _e=this.dataStore.setDomainIfLatest(new dt(e));dt.isAllowReadAnnouncement(_e)&&wa.delay(function(){r.api.getAnnouncementStatus(_e.id)},500),this.sendNotification(n,[null,_e]),i();break;case"notify_leave_account_control_group":var he=e;this.dataStore.removeAccountControlGroup(he),this.sendNotification(n,he),i();break;case"notify_leave_domain":var de=e;this.dataStore.removeDomain(de),this.conferenceStore.removeConferencesOnLeaveDomain(de),this.sendNotification(n,de),i();break;case"notify_lock_note":var fe=new Ti(e),me=this.dataStore.getNote(fe.noteId);null!=me&&me.lock(fe.revision,fe.userId,fe.deviceId,fe.expiredAt),this.sendNotification(n,fe),i();break;case"notify_open_conference":var pe=this.dataFactory.newConference(e);this.sendNotification(n,pe),i();break;case"notify_unlock_note":var ge=new Ui(e),ve=this.dataStore.getNote(ge.noteId);null!=ve&&ve.unlock(ge.revision,ge.userId),this.sendNotification(n,ge),i();break;case"notify_update_account_control_group_partially":var ye=new st(e);this.dataStore.updateAccountControlGroup(ye),this.sendNotification(n,ye),i();break;case"notify_update_announcement_status":var Se=new _t(e),we=this.dataStore.getAnnouncementStatus(Se.domainId);null==we&&(we=this.assureAnnouncementStatus(Se.domainId)),we.updateReadWithStatusUpdate(Se),this.dataStore.setAnnouncementStatus(we),this.sendNotification(n,Se),i();break;case"notify_update_department_tree":var Ie=e;this.departmentStore.clearDomainDepartment(Ie),this.api.getDepartmentTree(Ie),this.sendNotification(n,Ie),i();break;case"notify_update_department_users":var Te=e;this.departmentStore.clearDomainDepartmentUsers(Te),this.api.getUsers(Te,this.dataStore.getFriendsOrAcquaintances(Te).map(function(e){return e.id})),this.api.getMe(),this.sendNotification(n,Te),i();break;case"notify_update_domain":var Ee=new dt(e),Ne=this.dataStore.getDomain(Ee.id),Ae=this.dataStore.setDomainIfLatest(Ee);if(null!=Ne&&dt.isAllowReadAnnouncement(Ne)&&!dt.isAllowReadAnnouncement(Ae)){this.dataStore.removeAnnouncementStatus(Ne.id);var be=new _t;be.domainId=Ae.id,this.sendNotification("notify_update_announcement_status",be)}if(!dt.isAllowReadAnnouncement(Ne)&&dt.isAllowReadAnnouncement(Ae)&&this.api.getAnnouncementStatus(Ae.id),dt.isChangedContractTreeEnabled(Ne,Ae)&&!dt.isDepartmentEnabled(Ae)){var De=Ae.id;this.departmentStore.clearDomainDepartment(De),this.dataStore.clearUsersDepartments(De)}this.sendNotification(n,[Ne,Ae]),i();break;case"notify_update_domain_stampsetting":var ke=e[0],Ce=this.dataStore.getDomain(ke);if(null!=Ce){var Oe=Ce.stampsetSetting;Ce.updateStampsetSetting(new Sn(e[1]));var Me=Ce.stampsetSetting,Re=new Bn(ke,Oe,Me);Re.isValid()&&this.sendNotification(n,Re)}i();break;case"notify_update_domain_users":for(var Fe=e,xe=0;xe<Fe.length;){var Ue=Fe[xe];++xe;var Pe=this.dataStore.getDomain(Ue);null!=Pe&&Pe.setting.contactTreeEnabled&&this.departmentStore.clearDomainDepartmentUsers(Ue)}this.sendNotification(n,e),i();break;case"notify_delete_talker":case"notify_update_group_talk":var Le=new Tn(e);this.dataStore.setTalk(Le),this.sendNotification(n,Le),i();break;case"notify_update_note_partially":if(null==e)return void ji._e("["+tt.dateStr(new Date)+"] ","notePartiallyUpdate is null.","","","","");if(null==e.note_id)return void ji._e("["+tt.dateStr(new Date)+"] ","noteId is null.","","","","");var Be=new Si(e.note_id),He=this.dataStore.getNote(Be);if(null!=He&&null!=e.note_revision_summary&&He.compareRevision(e.note_revision_summary.revision)<=-1&&this.dataStore.setNote(Be,null),null==e.note_revision_summary&&null==e.setting)return void ji._e("["+tt.dateStr(new Date)+"] ","noteSetting and noteRevisionSummary are null.","","","","");if(null!=e.setting&&this.sendNotification("notify_update_note_for_setting",new Di(e)),null!=e.note_revision_summary){var je=new ki(e),Ye=this.dataStore.getNoteRevisionSummary(Be);if(null!=Ye&&Ye.compareRevision(je.getRevision())<0){var ze=this.dataStore.getNoteLocalEdit(Be);null!=ze&&ze.conflict(),this.dataStore.setNoteRevisionSummary(Be,je.noteRevisionSummary),this.sendNotification("notify_update_note_for_revision",new ki(e))}}i();break;case"notify_update_read_statuses":var Ge=new Ut(e),Ke=this.updateTalkStatus(Ge);null!=Ke&&this.sendNotification("notify_update_local_talk_status",Ke),this.sendNotification(n,Ge),i();break;case"notify_update_stampset":var We=new yn(e);nt.iter(this.dataStore.getDomains(),function(e){e.updateStampsetInfo(We)}),this.stampsStore.updateStampsetInfo(We),this.sendNotification(n,We),i();break;case"notify_update_talk_status":var Ve=new Un(e),qe=this.dataStore.getTalkStatus(Ve.talkId);null!=qe&&qe.update(Ve)&&(this.dataStore.setTalkStatus(qe),this.sendNotification("notify_update_local_talk_status",qe)),this.sendNotification(n,Ve),i();break;case"notify_update_user":if(e instanceof Array&&null==e.__enum__){var Qe=this.dataFactory.newDomainUser(e[1]);this.dataStore.setUserIfLatest(null,Qe)}else{var Je=new Ot(e);ji._d("["+tt.dateStr(new Date)+"] ","Current user updated. user:",Je,"","","");var Xe=this.dataStore;Xe.me=Je;for(var Ze=0,$e=Xe.getDomains();Ze<$e.length;){var et=$e[Ze];++Ze,Xe.sendNotification("notify_update_user",Xe.me.toDomainUser(et.id))}Xe.sendNotification("current_user_changed",Je),Xe.storage.setDirtyFlag()}i();break;default:this.sendNotification(n,e),i()}},updateTalkStatusByFavoriteTalkEvent:function(e){var t=this.dataStore.getTalkStatus(e.talkId);if(null==t){var n=this.dataStore.getTalk(e.talkId);if(null==n)return void ji._e("["+tt.dateStr(new Date)+"] ","talk not found on change favorite talk.","","","","");(t=new Fn).id=e.talkId,t.talkOrderingTimestamp=n.updatedAt}(null==t.favoriteVersion||e.favoriteVersion>t.favoriteVersion)&&(t.favoriteVersion=e.favoriteVersion,t.orderInFavorites=e.orderInFavorites,this.dataStore.setTalkStatus(t))},updateTalkStatusByConferenceClosedEvent:function(e){var t=this.dataStore.getTalkStatus(e.talkId);if(null!=t&&null!=t.maxMessage){var n=t.maxMessage.id,i=e.messageId;null!=n&&null!=i&&n.high==i.high&&n.low==i.low&&(t.maxMessage.content.closed=!0,this.dataStore.setTalkStatus(t))}},updateTalkStatusByTalkPushNotificationEvent:function(e,t){var n=this.dataStore.getTalkStatus(t.talkId);if(null==n){var i=this.dataStore.getTalk(t.talkId);if(null==i)return void ji._e("["+tt.dateStr(new Date)+"] ","talk not found on change favorite talk.","","","","");(n=new Fn).id=t.talkId,n.talkOrderingTimestamp=i.updatedAt}(null==n.pushNotificationSetting||t.version>n.pushNotificationSetting.version)&&(n.pushNotificationSetting=qt.createWithParams(e,t.version),this.dataStore.setTalkStatus(n))},newTalkStatusByTalk:function(e){var t=this.dataStore.getTalkStatus(e.id);return null==t&&((t=new Fn).id=e.id),null==t.talkOrderingTimestamp&&(t.talkOrderingTimestamp=e.updatedAt),this.dataStore.setTalkStatus(t),t},newTalkStatusByMessage:function(e){var t=this.dataStore.getTalkStatus(e.talkId);if(null==t&&((t=new Fn).id=e.talkId),xn.isNewMax(t,e.id)&&(t.maxMessageId=e.id,t.maxMessage=e),e.isUnreadCountTarget){var n,i=this.dataStore,r=e.userId;if(null!=i.me){var a=i.me.id;n=null!=a&&null!=r&&a.high==r.high&&a.low==r.low}else n=!1;t.applyNewMessage(e,n)}return this.dataStore.setTalkStatus(t),t},updateTalkStatusOnMessageDelete:function(e){var t=this.dataStore.getTalkStatus(e.talkId);return null!=t&&(xn.isUnread(t,e.messageId)&&(t.unreadCount-=1,t.unreadCount<0&&(t.unreadCount=0)),xn.isMax(t,e.messageId)&&null!=t.maxMessage&&(t.maxMessage.type=Rt.deleted),this.dataStore.setTalkStatus(t)),t},updateTalkStatus:function(e){var i=this;if(!nt.exists(e.readUserIds,function(e){var t=i.dataStore;if(null==t.me)return!1;var n=t.me.id;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low}))return null;var t=this.dataStore.getTalkStatus(e.talkId);if(null==t)return ji._e("["+tt.dateStr(new Date)+"] ","talkStatus is not found.","","","",""),null;for(var n=e.messageIds[0],r=0,a=e.messageIds;r<a.length;){var o=a[r];if(++r,xn.isUnread(t,o)){var s=n.high-o.high|0;s=0!=s?s:ga.ucompare(n.low,o.low),(n.high<0?o.high<0?s:-1:0<=o.high?s:1)<0&&(n=o),it.notContains(e.messageIdsExcludingUnreadCountTargets,o)&&t.unreadCount--}}return xn.isUnread(t,n)&&(t.maxReadMessageId=n,this.dataStore.setTalkStatus(t)),t},newAnnouncementStatus:function(e){var t=this.dataStore.getAnnouncementStatus(e.domainId);return null==t&&((t=new Re).domainId=e.domainId),ct.isNewMax(t,e.id)&&(t.maxAnnouncementId=e.id,t.maxAnnouncement=e),null==t.unreadCount&&(t.unreadCount=0),t.unreadCount++,this.dataStore.setAnnouncementStatus(t),t},assureAnnouncementStatus:function(e){var t=this.dataStore.getAnnouncementStatus(e);return null==t&&(t=this.dataFactory.newAnnouncementStatusForDomain(e)),t},__class__:ar});var or=function(){er.call(this,"api")};(n["albero.proxy.AlberoServiceProxy"]=or).__name__=["albero","proxy","AlberoServiceProxy"],or.__super__=er,or.prototype=i(er.prototype,{getOSString:function(){return"bot"},createAccessToken:function(e,t,n){var i,r,a=this,o=this.settings.getOs(),s=this.settings.getIDFV(),l=e.split("$");r=-1==e.indexOf("@")&&2==l.length?(i="create_access_token_by_id",[l[1],l[0],t,s,o,""]):(i="create_access_token",[e,t,s,o,""]),this.apiCaller.callImmediately(i,r,function(e){ji._d("["+tt.dateStr(new Date)+"] ","access token:",e,"","",""),a.settings.setAccessToken(e),n(e)},function(e){a.sendNotification("Url",be.FORWARD(V.error))})},authorizeDevice:function(e,t){var n=this.settings.getIDFV();this.apiCaller.call("authorize_device",[e,n],function(e){t()})},createSession:function(e,i){var r=this,t=[e,"1.113",this.getOSString()];this.apiCaller.onSessionClear(),this.apiCaller.callImmediatelyReliable("create_session",t,function(e){var t=new cn(e),n=T.nowAsInt64();t.passwordExpiration.isExpired(n)?r.sendNotification("password_expiration_overed"):(t.passwordExpiration.needWarning(n,r.settings.getPasswordWarningSkipUntil())&&(r.settings.setPasswordWarningSkipUntil(T.oneDayAfterAsInt64()),r.sendNotification("password_expiration_warned")),r.apiCaller.onSessionCreated(),i(t),r.apiCaller.fireCallbacksWaitingForSession())},function(e){if(null!=e){if(401==e.code&&"expired password"==e.message)return void r.sendNotification("password_expiration_overed");if(401==e.code&&"deleted account"==e.message)return void r.sendNotification("SignOut");if(401==e.code&&"unauthorized device"==e.message)return void r.sendNotification("Device",q.AUTHORIZE);r.apiCaller.handleServerErrorDefault(e)}r.settings.clearAccessToken(),r.sendNotification("Url",be.FORWARD(V.error))},function(e){return r.shouldRetryCreateSession(e)?Ca.Some(r.apiCaller.retryTimeForReplicationLag()):Ca.None})},shouldRetryCreateSession:function(e){return 401==e.code&&"invalid token"==e.message},startNotification:function(){var t=this;this.apiCaller.call("start_notification",[],function(e){e||(t.dataStore.clear(!0),t.sendNotification("start_notification_failed"))})},resetNotification:function(e){this.apiCaller.call("reset_notification",[],e)},sendDomainNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_update_domain",[null,n])}},sendAnnouncementStatusNotification:function(e){var t=new _t;t.domainId=e.domainId,this.sendNotification("notify_update_announcement_status",t)},sendTalkNotification:function(e){var t=e.type==Nn.PairTalk?"notify_create_pair_talk":"notify_create_group_talk";this.sendNotification(t,e)},sendTalkNotifications:function(e){nt.iter(e,fo(this,this.sendTalkNotification))},sendTalkStatusNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_update_local_talk_status",n)}},deleteSession:function(){this.settings.clearSelectedStampsetType(),this.settings.clearDomainSelection(),this.settings.clearAccessToken(),this.apiCaller.restart()},updateUser:function(t,e,n,i,r){function a(e){s.sendNotification("update_user_errored",s.dataStore.me)}function o(e){s.apiCaller.call("update_user",[t,e,i,r],function(e){var t=s.dataStore,n=new Ot(e);t.me=n;for(var i=0,r=t.getDomains();i<r.length;){var a=r[i];++i,t.sendNotification("notify_update_user",t.me.toDomainUser(a.id))}t.sendNotification("current_user_changed",n),t.storage.setDirtyFlag(),s.sendNotification("update_user_responsed",s.dataStore.me)},function(e){a(),s.apiCaller.handleServerErrorDefault(e)})}var s=this;null!=n?o(n):null!=e?this.uploadFile(e,null,Hn.PROFILE_IMAGE,function(e){o(e.get_url)},a):o()},updateProfile:function(e){var o=this,t=Vt.convertToApiParams(e);this.apiCaller.call("update_profile",[t],function(e){ji._d("["+tt.dateStr(new Date)+"] ","update_profile_succeed",e,"","","");var t=o.dataStore,n=new Ot(e);t.me=n;for(var i=0,r=t.getDomains();i<r.length;){var a=r[i];++i,t.sendNotification("notify_update_user",t.me.toDomainUser(a.id))}t.sendNotification("current_user_changed",n),t.storage.setDirtyFlag(),o.sendNotification("update_profile_responsed",o.dataStore.me)},function(e){o.sendNotification("update_profile_errored",o.dataStore.me),o.apiCaller.handleServerErrorDefault(e)})},addFriend:function(e){var t=this.settings.getSelectedDomainId();this.apiCaller.call("add_friend",[t,e.id])},deleteFriend:function(e){var t=this.settings.getSelectedDomainId();this.apiCaller.call("delete_friend",[t,e.id])},getFriends:function(r){var a=this;this.apiCaller.call("get_friends",[],function(e){for(var t=0;t<e.length;){var n=e[t];++t;n[0];var i=n[1];nt.iter(i,function(e){var t=a.dataFactory.newFriend(e);a.sendNotification("notify_add_friend",t)})}null!=r&&r()})},getAcquaintances:function(r){var a=this;this.apiCaller.call("get_acquaintances",[],function(e){for(var t=0;t<e.length;){var n=e[t];++t;var i=n[1];nt.iter(i,function(e){var t=a.dataFactory.newAcquaintance(e);a.sendNotification("notify_add_acquaintance",t)})}null!=r&&r()})},getAllUsers:function(e,n){var i=this;null==n&&(n=this.settings.getSelectedDomainId());this.apiCaller.call("get_domain_users",[n,14,40,e],function(e){var t=rt.asArray(e.contents).map(fo(_o=i.dataFactory,_o.newDomainUser));i.dataStore.setUsersIfLatest(n,t),i.sendNotification("get_domain_users_responsed",[n,e.marker,e.next_marker,t])})},getUsers:function(e,t){this._getUsers(e,t.slice())},_getUsers:function(n,i){var r=this,e=i.splice(0,100);0!=e.length&&this.apiCaller.call("get_users",[n,e],function(e){var t=e.map(fo(_o=r.dataFactory,_o.newDomainUser));r.dataStore.setUsersIfLatest(n,t),r.sendNotification("get_users_responsed",[n,t]),r._getUsers(n,i)})},getProfile:function(e,t){var n=this;this.apiCaller.call("get_profile",[e,t],function(e){var t=new zt(e);n.sendNotification("get_profile_responsed",t)},function(e){403==e.code&&"invalid user"==e.message?null!=e.detail&&null!=e.detail.invalid_user_ids&&n.sendNotification("get_profile_errored",e.detail.invalid_user_ids):n.apiCaller.handleServerErrorDefault(e)})},searchDomainUsers:function(n,e){var i=this,r=this.settings.getSelectedDomainId();this.apiCaller.call("search_domain_users",[r,n,14,40,e],function(e){var t=rt.asArray(e.contents).map(fo(_o=i.dataFactory,_o.newDomainUser));i.dataStore.setUsersIfLatest(r,t),i.sendNotification("get_domain_users_responsed",[r,e.marker,e.next_marker,t,n])})},getUserIdentifiers:function(t,n,i){var r=this;if(0==n.length)null!=i&&i();else{var e=n.slice(0,100);this._getUserIdentifiers(t,e,function(){var e=n.slice(100);r.getUserIdentifiers(t,e,i)})}},_getUserIdentifiers:function(p,g,v){var y=this;this.apiCaller.call("get_user_identifiers",[p,g],function(e){for(var t=e.contents,n=new Ma,i=0,r=t.length;i<r;){var a=i++,o=new Yn(t[a]),s=o.userId,l="_"+s.high+"_"+s.low;null!=Io[l]?n.setReserved(l,o):n.h[l]=o}for(var u=0,c=g.length;u<c;){var _=u++,h=y.dataStore.getUser(p,g[_]);if(null!=h){var d=h.id,f="_"+d.high+"_"+d.low,m=null!=Io[f]?n.getReserved(f):n.h[f];null!=m&&(h.email=m.email,h.subEmail=m.subEmail,h.groupAlias=m.groupAlias,h.signinId=m.signinId),h.__uid_caching=!0}}null!=v&&v()},function(e){for(var t=0,n=g.length;t<n;){var i=t++,r=y.dataStore.getUser(p,g[i]);null!=r&&(r.__uid_caching=null)}null!=v&&v()})},getAllUserIdentifiers:function(i){var r=this,a=null,e=this.dataStore.getUsers();null==e&&(e=[]);for(var t=0;t<e.length;){var n=e[t];if(++t,null==n.__uid_caching){n.__uid_caching=!1;var o=n.domainId,s="_"+o.high+"_"+o.low;null==a&&(a=new Ma);var l=null!=Io[s]?a.getReserved(s):a.h[s];null==l&&(l=[],null!=Io[s]?a.setReserved(s,l):a.h[s]=l),l.push(n.id)}}if(null==a)i();else{var u=a.keys(),c=null;(c=function(){if(u.hasNext()){var e=u.next(),t=it.makeFromIdStr(e),n=null!=Io[e]?a.getReserved(e):a.h[e];r.getUserIdentifiers(t,n,c)}else i()})()}},getAllUserEmails:function(e){ji._w("["+tt.dateStr(new Date)+"] ","'getAllUserEmails' is deprecated, please use 'getAllUserIdentifiers' instead","","","",""),this.getAllUserIdentifiers(e)},getDepartmentTree:function(n){var i=this;this.apiCaller.call("get_department_tree",[n],function(e){nt.iter(new ze(e).departments,function(e){e.isRoot()&&i.departmentStore.setRootDepartmentId(n,e.id),i.departmentStore.setDepartment(e)});var t=i.settings.getSelectedDepartmentId(n);null!=t&&null==i.departmentStore.getDepartment(t)&&i.settings.setSelectedDepartmentId(n,null),i.sendNotification("get_department_tree_responsed",[n])},function(e){403!=e.code||"forbidden"!=e.message?i.apiCaller.handleServerErrorDefault(e):i.sendNotification("get_department_tree_canceled",[n])})},getDepartmentUsers:function(e,t){this._getDepartmentUsers(e,t,null)},getDepartmentAllUsers:function(l){var u=this,e=this.departmentStore.getDepartment(l);if(null==e||null==e.userIds){var c=new Ma,_=null;_=function(e,t,n){if(nt.iter(n,function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=e.id;null!=Io[n]?c.setReserved(n,i):c.h[n]=i}),null==t){for(var i=[],r=c.arrayKeys(),a=new Oa(c,r);a.hasNext();){var o=a.next();i.push(o)}var s=i.length;ji._d("["+tt.dateStr(new Date)+"] ","department all users prepared. [departmentId, users_count]:",l,s,"",""),u.departmentStore.setDepartmentUsers(l,i),u.sendNotification("department_user_ids_prepared",i)}else u._getDepartmentUsers(l,t,_)},this._getDepartmentUsers(l,null,_)}else this.sendNotification("department_user_ids_prepared",e.userIds)},_getDepartmentUsers:function(n,e,i){var r=this,a=this.settings.getSelectedDomainId(),t=this.departmentStore.getDepartment(n),o=null!=t&&null!=t.childrenIds;this.apiCaller.call("get_department_users",[a,n,o,100,e],function(e){var t=rt.asArray(e.contents).map(fo(_o=r.dataFactory,_o.newDomainUser));r.dataStore.setUsersIfLatest(a,t),r.sendNotification("get_department_users_responsed",[a,e.marker,e.next_marker,t,n]),null!=i&&i(e.marker,e.next_marker,t)},function(e){403!=e.code||"forbidden"!=e.message?r.apiCaller.handleServerErrorDefault(e):r.sendNotification("get_department_users_canceled",[a])})},getMe:function(){var o=this;this.apiCaller.call("get_me",[],function(e){var t=o.dataStore,n=new Ot(e);t.me=n;for(var i=0,r=t.getDomains();i<r.length;){var a=r[i];++i,t.sendNotification("notify_update_user",t.me.toDomainUser(a.id))}t.sendNotification("current_user_changed",n),t.storage.setDirtyFlag(),o.sendNotification("get_me_responsed")},function(e){o.apiCaller.handleServerErrorDefault(e)})},getDepartmentUserCount:function(e,t){var n=t.filter(fo(_o=this.departmentStore,_o.needUserCountLoading));this._getDepartmentUserCount(e,n)},_getDepartmentUserCount:function(n,i){var r=this,a=i.splice(0,100);0!=a.length&&(nt.iter(a,function(e){r.departmentStore.setUserCountLoading(e,!0)}),this.apiCaller.call("get_department_user_count",[n,a],function(e){var t=new Ke(e);nt.iter(t.departments,fo(_o=r.departmentStore,_o.setDepartmentUserCount)),r.sendNotification("get_department_user_count_responsed",{completed:a,remaining:i}),r._getDepartmentUserCount(n,i)},function(e){nt.iter(a,function(e){r.departmentStore.setUserCountLoading(e,!1)}),r.apiCaller.handleServerErrorDefault(e)}))},getDomains:function(n){var i=this;this.apiCaller.call("get_domains",[],function(e){nt.iter(e,fo(_o=i.dataFactory,_o.newDomain));var t=i.dataStore.getDomains();i.sendDomainNotifications(t),null!=n&&n()})},leaveDomain:function(e){var t=this;this.apiCaller.call("leave_domain",[e.id],function(e){t.dataStore.removeDomain(e)})},getDomainInvites:function(t){var e;e=null==t?function(e){}:function(e){t()},this._getDomainInvites(e)},_getDomainInvites:function(n){var i=this;this.apiCaller.call("get_domain_invites",[],function(e){var t=e.map(fo(_o=i.dataFactory,_o.newDomainInvite));nt.iter(t,function(e){i.sendNotification("notify_add_domain_invite",e)}),n(t)})},acceptDomainInvite:function(e){this.apiCaller.callApiReliable("accept_domain_invite",[e],function(e){})},deleteDomainInvite:function(e){this.apiCaller.callApiReliable("delete_domain_invite",[e],function(e){})},getAccountControlRequests:function(t){var n=this;this.apiCaller.call("get_account_control_requests",[],function(e){nt.iter(e.map(fo(_o=n.dataFactory,_o.newAccountControlRequest)),function(e){n.sendNotification("notify_add_account_control_request",e)}),null!=t&&t()})},acceptAccountControlRequest:function(e){if(null!=e){var t=this.dataStore.getAccountControlRequest(e);null!=t&&this.apiCaller.call("accept_account_control_request",[t.id,t.version],function(e){})}},rejectAccountControlRequest:function(e){if(null!=e){var t=this.dataStore.getAccountControlRequest(e);null!=t&&this.apiCaller.call("reject_account_control_request",[t.id,t.version],function(e){})}},getJoinedAccountControlGroup:function(t){var n=this;this.apiCaller.call("get_joined_account_control_group",[],function(e){nt.iter(e.map(fo(_o=n.dataFactory,_o.newAccountControlGroup)),function(e){n.sendNotification("notify_join_account_control_group",e)}),null!=t&&t()})},getTalks:function(i){var r=this;this.apiCaller.call("get_talks",[],function(e){nt.iter(e,fo(_o=r.dataFactory,_o.newTalk)),r.apiCaller.call("get_talk_statuses",[],function(e){nt.iter(e,fo(_o=r.dataFactory,_o.newTalkStatus));var t=r.dataStore.getTalks();r.sendTalkNotifications(t);var n=r.dataStore.getTalkStatuses();r.sendTalkStatusNotifications(n),null!=i&&i()})})},getReadStatus:function(e,t){var n=this;this.apiCaller.call("get_read_status",[e,t],function(e){n.sendNotification("notify_get_message_status",new xt(e))})},createGroupTalk:function(e,t,n,i){var o=this;null==e&&(e=this.settings.getSelectedDomainId()),0!=t.length&&this.apiCaller.call("create_group_talk",[e,t,n.allowDisplayPastMessages,!0],function(e){var t=o.dataFactory.newTalk(e);o.sendNotification("notify_create_group_talk",t),null!=i&&o.sendNotification("SelectTalk",ge.SelectTalk(i,t))},function(e){if(o.sendNotification("create_group_talk_fail"),null!=e&&500==e.code&&null!=e.detail&&"failure in adding some users"==e.message){var t=Or.toLocalError(kt.AddingSomeUsersFailure,e);o.sendNotification("error_occurred",t)}else if(null!=e&&502==e.code&&null!=e.detail&&"talks"==e.detail.limit_target){var n=e.detail.limit_max,i=Or.toLocalError(kt.TalksCountOvered(n),e);o.sendNotification("error_occurred",i)}else if(null!=e&&502==e.code&&null!=e.detail&&"talkers"==e.detail.limit_target){var r=e.detail.limit_max,a=Or.toLocalError(kt.TalkersCountOvered(r),e);o.sendNotification("error_occurred",a)}else o.apiCaller.handleServerErrorDefault(e)})},createPairTalk:function(e,t,n){var i=this;null==e&&(e=this.settings.getSelectedDomainId()),this.apiCaller.call("create_pair_talk",[e,t],function(e){var t=i.dataFactory.newTalk(e);i.sendNotification("notify_create_pair_talk",t),null!=n&&i.sendNotification("SelectTalk",ge.SelectTalk(n,t))},function(e){if(i.sendNotification("create_pair_talk_fail"),null!=e&&502==e.code&&null!=e.detail&&"talks"==e.detail.limit_target){var t=e.detail.limit_max,n=Or.toLocalError(kt.TalksCountOvered(t),e);i.sendNotification("error_occurred",n)}else i.apiCaller.handleServerErrorDefault(e)})},updateGroupTalk:function(e,t,n,i){var r=this;this.apiCaller.call("update_group_talk",[e.id,t,n,i],function(e){var t=r.dataFactory.newTalk(e);r.sendNotification("notify_update_group_talk",t)},function(e){r.sendNotification("notify_update_group_talk_ERRORED"),r.apiCaller.handleServerErrorDefault(e)})},addTalkers:function(e,t,n){var r=this;if(e.type!=Nn.PairTalk)0!=t.length&&this.apiCaller.call("add_talkers",[e.id,t,!0],function(e){var t=r.dataFactory.newTalk(e);r.sendNotification("notify_add_talkers",t),r.sendNotification("add_talkers_succeeded",t)},function(e){if(r.sendNotification("add_talkers_failed",e),null!=e&&500==e.code&&null!=e.detail&&"failure in adding some users"==e.message){var t=Or.toLocalError(kt.AddingSomeUsersFailure,e);r.sendNotification("error_occurred",t)}else if(null!=e&&502==e.code&&null!=e.detail&&"talkers"==e.detail.limit_target){var n=e.detail.limit_max,i=Or.toLocalError(kt.TalkersCountOvered(n),e);r.sendNotification("error_occurred",i)}else r.apiCaller.handleServerErrorDefault(e)});else{var i=e.userIds.concat(t);it.remove(i,this.dataStore.me.id);var a=this.settings.getSelectedDomainId();this.createGroupTalk(a,i,En.createDefault(),n)}},deleteTalker:function(t,n){var i,r=this,a=null,o=null,e=this.dataStore;if(null!=e.me){var s=e.me.id;i=null!=s&&null!=n&&s.high==n.high&&s.low==n.low}else i=!1;i&&(a=t,o=this.dataStore.getTalkStatus(t.id),this.dataStore.removeTalk(t.id),this.dataStore.removeTalkStatus(t.id)),this.apiCaller.call("delete_talker",[t.id,n],function(e){it.remove(t.userIds,n),i||r.dataStore.setTalk(t),i&&r.conferenceStore.removeConferencesOnLeaveTalk(t.id),r.sendNotification("notify_delete_talker",t)},function(e){null!=a&&r.dataStore.setTalk(a),null!=o&&r.dataStore.setTalkStatus(o),r.sendNotification("error_occurred",e)})},getMessages:function(n,e,i,r){var a=this;e=null==e?{sinceId:null,maxId:null}:e,null==i&&(i=Pt.desc);var t=this.apiCaller,o=e.sinceId,s=e.maxId,l=Lt.orderToInt(i);t.call("get_messages",[n,20,o,s,l],function(e){var t=e.map(fo(_o=a.dataFactory,_o.newMessage));a.sendNotification("notify_get_messages",{talkId:n,messages:t,sortOrder:i,callerKey:r})})},createMessage:function(e,t,n,i){var r=this,a=this.dataFactory.newDummyMessage(e,t,n);if(null==this.dataStore.getTalk(e)){var o={code:400,message:"invalid talk_id (deleted talk)"};return ji._w("["+tt.dateStr(new Date)+"] ","WARNING method: create_message",o,"","",""),void this.sendNotification("create_message_fail",[o,a],i)}this.sendNotification("create_message_start",a),this.apiCaller.call("create_message",[e,Mt.enumIndex(t),n],function(e){r.fileInfoStore.removeMessageFileInfos(a.id),r.messageStore.removeMessage(a.id);var t=r.dataFactory.newMessage(e);r.sendNotification("create_message_complete",[t,a.id],i)},function(e){if(r.sendNotification("create_message_fail",[e,a],i),null!=e&&409==e.code){var t=Or.toLocalError(kt.SendingMessageConflicted,e);r.sendNotification("error_occurred",t)}else r.sendNotification("error_occurred",e)})},forwardMessages:function(n,i,r){null==r&&(r=0);var a=this;if(!(r>=i.length)){var e=i[r],t=n.id,o=this.dataFactory.newDummyMessage(t,e.type,e.content);this.sendNotification("create_message_start",o),this.apiCaller.call("create_message",[t,Mt.enumIndex(e.type),e.content],function(e){var t=a.dataFactory.newMessage(e);a.sendNotification("create_message_complete",[t,o.id]),a.forwardMessages(n,i,r+1),a.fileInfoStore.removeMessageFileInfos(o.id),a.messageStore.removeMessage(o.id)},function(e){if(a.sendNotification("create_message_fail",[e,o]),null!=e&&409==e.code){var t=Or.toLocalError(kt.SendingMessageConflicted,e);a.sendNotification("error_occurred",t)}else a.sendNotification("error_occurred",e)})}},deleteMessage:function(n,i){var r=this;this.apiCaller.call("delete_message",[n,i],function(e){var t=new Ft;t.talkId=n,t.messageId=i,r.sendNotification("notify_delete_message",t)},function(e){if(null!=e){if(403==e.code&&"frozen domain"==e.message)return void r.sendNotification("error_occurred",e);if(409==e.code&&"conflict"==e.message){var t=Or.toLocalError(kt.DeletingMessageConflicted,e);return void r.sendNotification("error_occurred",t)}r.sendNotification("error_occurred",e)}})},updateReadStatuses:function(r,a){var o=this;this.apiCaller.callApiReliable("update_read_statuses",[r,a],function(e){var t,n=o.dataStore.getTalkStatus(r);if(null!=n){var i=n.maxReadMessageId;t=null!=i&&null!=a&&i.high==a.high&&i.low==a.low}else t=!1;t&&o.sendNotification("notify_update_local_talk_status",n)},null,function(e){return 429==e.code&&"too many requests"==e.message?Ca.Some(1e3*o.asInt(e.detail.retry_after)):Ca.None})},upload:function(t,n,i,r){var a=this,e=ni.getBlobFromUpdatableFile(i);this.fileService.asyncCreateThumbnail(e).catch(function(e){return null}).then(function(e){return{file:i,thumb:e}}).then(function(e){a.uploadV2(t,n,e,r)})},uploadV2:function(e,t,n,i){var r=this,a=this.dataFactory.newDummyFileMessage(t,n);this.sendNotification("create_message_start",a);var o=this.prepareMessageFileAsync(n.file,n.thumb,e);o.then(function(e){r.createMessageReliable(t,Rt.file,e,a,i)}),o.catch(function(e){r.sendNotification("create_message_fail",[e,a],i)})},uploadForHubot:function(e,t,n){var i=this.dataStore.getTalk(e),r={file:t,thumb:null};if(null==i){var a=this.dataFactory.newDummyFileMessage(e,r),o={code:400,message:"invalid talk_id (deleted talk)"};return ji._w("["+tt.dateStr(new Date)+"] ","WARNING method: upload",o,"","",""),void this.sendNotification("create_message_fail",[o,a],n)}this.uploadV2(i.domainId,i.id,r,n)},uploadMulti:function(n,i,r,e,a){var o=this,t=e.map(function(t){var e=ni.getBlobFromUpdatableFile(t);return o.fileService.asyncCreateThumbnail(e).catch(function(e){return null}).then(function(e){return{file:t,thumb:e}})});Promise.all(t).then(function(e){var t=e.map(function(e){return e});o.uploadMultiV2(n,i,r,t,a)})},uploadMultiV2:function(n,i,r,a,o){var s=this,l=this.dataFactory.newDummyMultipleFileMessage(i,r,a);this.sendNotification("create_message_start",l);for(var e=Promise.resolve([]),t=0;t<a.length;){var u=[a[t]];++t,e=e.then(function(e){return function(t){return s.prepareMessageFileAsync(e[0].file,e[0].thumb,n).then(function(e){return t.push(e),t})}}(u))}e.then(function(e){if(e.length==a.length){var t={files:e};null!=r&&0<r.length&&(t.text=r),s.createMessageReliable(i,Rt.textMultipleFile,t,l,o)}}),e.catch(function(e){s.sendNotification("create_message_fail",[e,l],o)})},uploadMultiForHubot:function(e,t,n,i){var r=this.dataStore.getTalk(e),a=n.map(function(e){return{file:e,thumb:null}});if(null==r){var o=this.dataFactory.newDummyMultipleFileMessage(e,t,a),s={code:400,message:"invalid talk_id (deleted talk)"};return ji._w("["+tt.dateStr(new Date)+"] ","WARNING method: uploadMulti",s,"","",""),void this.sendNotification("create_message_fail",[s,o],i)}this.uploadMultiV2(r.domainId,r.id,t,a,i)},prepareMessageFileAsync:function(a,n,o){var s=this;return new Promise(function(t,e){null!=n?s.uploadFile(n.file,o,Hn.THUMBNAIL,function(e){n.setAuth(e),t(Ca.Some(n))},function(e){t(Ca.None)}):t(Ca.None)}).then(function(r){return new Promise(function(i,e){s.uploadFile(a,o,Hn.MESSAGE,function(e){var t=Vi.normalizeForFile(a.name),n=E.createFileInfoDynamic(a,t,r,e);i(n)},e)})})},prepareNoteFileAsync:function(a,n,o){var s=this;return new Promise(function(t,e){null!=n?s.uploadFile(n.file,o,Hn.NOTE_THUMBNAIL,function(e){n.setAuth(e),t(Ca.Some(n))},function(e){t(Ca.None)}):t(Ca.None)}).then(function(r){return new Promise(function(i,e){s.uploadFile(a,o,Hn.NOTE_ATTACHMENT,function(e){var t=Vi.normalizeForFile(a.name),n=E.createFileInfoDynamic(a,t,r,e);i(n)},e)})})},createMessageReliable:function(e,t,n,i,r){var a=this;this.apiCaller.callApiReliable("create_message",[e,Mt.enumIndex(t),n],function(e){a.fileInfoStore.removeMessageFileInfos(i.id),a.messageStore.removeMessage(i.id);var t=a.dataFactory.newMessage(e);a.sendNotification("create_message_complete",[t,i.id],r)},function(e){if(a.sendNotification("create_message_fail",[e,i],r),null!=e&&409==e.code){var t=Or.toLocalError(kt.SendingMessageConflicted,e);a.sendNotification("error_occurred",t)}else a.sendNotification("error_occurred",e)},function(e){return a.shouldRetryCreateMessage(e)?Ca.Some(a.apiCaller.retryTimeForReplicationLag()):Ca.None})},shouldRetryCreateMessage:function(e){return null!=e.code&&(500==e.code?"Internal Error (IllegalStateException)"==e.message:400==e.code&&"invalid file_id"==e.message)},uploadFile:function(e,t,r,n,a){var o=this,i=e,s=Vi.normalizeForFile(i.name),l=i.type,u=i.size,c=this.apiCaller,_=jn.getUseTypeInt(r);c.call("create_upload_auth",[s,l,u,t,_],function(t){o.fileService.upload(t,l,e).then(function(e){n(t)},function(e){var t=new Cr({code:null,detail:null,message:e});if(r!=Hn.THUMBNAIL&&r!=Hn.NOTE_THUMBNAIL&&r!=Hn.NOTE_ATTACHMENT){var n=Or.toLocalError(kt.GeneralFileError,t);o.sendNotification("error_occurred",n)}a(t)})},function(e){if(r!=Hn.THUMBNAIL&&r!=Hn.NOTE_THUMBNAIL&&r!=Hn.NOTE_ATTACHMENT&&null!=e)if(502==e.code&&null!=e.detail){var t=it.fromIntOrInt64(e.detail.limit_max);if("file_size"==e.detail.limit_target){var n=Or.toLocalError(kt.UploadSizeOvered(t),e);o.sendNotification("error_occurred",n)}else if("storage_size"==e.detail.limit_target){var i=Or.toLocalError(kt.StorageSizeOvered(t),e);o.sendNotification("error_occurred",i)}}else o.sendNotification("error_occurred",e);a(e)})},createDownloadAuth:function(e,t,n,i,r){var a=this;this.apiCaller.callApiReliable("create_download_auth",[e,t,n],function(e){i(new gt(e))},function(e){r(e)},function(e){return 429==e.code&&"too many requests"==e.message?Ca.Some(1e3*a.asInt(e.detail.retry_after)):Ca.None})},deleteAttachment:function(e,t){this.apiCaller.call("delete_attachment",[e,t])},getAttachments:function(n,e){var i=this;null==e&&(e={sinceId:null,maxId:null}),this.apiCaller.call("get_attachments",[n,20,e.sinceId,e.maxId],function(e){var t=e.map(fo(_o=i.dataFactory,_o.newFileInfo));i.sendNotification("get_file_responsed",{talkId:n,files:t})})},createAnnouncement:function(e,t,n,i){var r=this;if(null!=e||null!=(e=this.settings.getSelectedDomainId())){var a=this.dataFactory.newDummyMessage(null,t,n);this.sendNotification("create_announcement_start",a),this.apiCaller.call("create_announcement",[e,Mt.enumIndex(t),n],function(e){var t=r.dataFactory.newAnnouncement(e);r.sendNotification("create_announcement_complete",[t,a.id],i)},function(e){r.sendNotification("create_announcement_fail",a),r.sendNotification("error_occurred",e)})}},getAnnouncements:function(e,n,i){var r=this,a=this.settings.getSelectedDomainId();if(null!=a){e=null==e?{sinceId:null,maxId:null}:e;var t=this.apiCaller,o=e.sinceId,s=e.maxId,l=Lt.orderToInt(n);t.call("get_announcements",[a,20,o,s,l],function(e){var t=e.map(fo(_o=r.dataFactory,_o.newAnnouncement));r.sendNotification("notify_get_announcements",{domainId:a,announcements:t,sortOrder:n,callerKey:i})})}},getAnnouncementStatuses:function(r){var a=this;this.apiCaller.call("get_announcement_statuses",[],function(e){for(var t=0;t<e.length;){var n=e[t];++t;var i=a.dataFactory.newAnnouncementStatus(n);a.sendAnnouncementStatusNotification(i),null!=r&&r()}})},getAnnouncementStatus:function(e,n){var i=this;this.apiCaller.callApiReliable("get_announcement_status",[e],function(e){var t=i.dataFactory.newAnnouncementStatus(e);i.sendAnnouncementStatusNotification(t),null!=n&&n()},null,function(e){return 400==e.code&&"invalid domain_id"==e.message?Ca.Some(i.apiCaller.retryTimeForReplicationLag()):Ca.None})},updateAnnouncementReadStatus:function(r,a){var o=this;this.apiCaller.call("update_announcement_status",[r,a],function(e){var t,n=o.dataStore.getAnnouncementStatus(r);if(null!=n){var i=n.maxReadAnnouncementId;t=null!=i&&null!=a&&i.high==a.high&&i.low==a.low}else t=!1;t&&o.sendAnnouncementStatusNotification(n)})},getQuestions:function(e,n,i,t){var r=this,a=this.settings.getSelectedDomainId(),o=null;null!=e&&(a=e.domainId,o=e.id);var s=Qt.fromTypeToInt(n),l=at.orNull(Qt.filterToOpBool(i));t=null==t?{sinceId:null,maxId:null}:t,this.apiCaller.call("get_actions",[a,o,s,l,20,t.sinceId,t.maxId],function(e){var t=e.map(fo(_o=r.dataFactory,_o.newQuestion));r.sendNotification("get_questions_responsed",{domainId:a,talkId:o,questions:t,fromType:n,filter:i})})},getQuestion:function(e,n){var i=this;this.apiCaller.callApiReliable("get_action",[e],function(e){var t=i.dataFactory.newQuestion(e);i.sendNotification("notify_update_question",t),null!=n&&n(t)})},searchMessages:function(t,n,i,r){var a=this;this.searchService.prepareForSearching(t,i),this.apiCaller.call("search_messages",[t.domainId,t.talkId,t.getQueryText(),n,i],function(e){a.searchService.isRecentParams(t)&&a.searchService.isSearching()&&a.searchService.saveSearchMessagesResult(new rn(e)),null!=r&&r()},function(e){a.searchService.notifySearchMessagesFail(),400!=e.code||null==i?a.sendNotification("error_occurred",e):a.searchMessages(t,n,null,r)})},searchAttachments:function(t,n,i,r){var a=this;this.searchService.prepareForSearching(t,i),this.apiCaller.call("search_attachments",[t.domainId,t.talkId,t.getQueryText(),n,i],function(e){a.searchService.isRecentParams(t)&&a.searchService.isSearching()&&a.searchService.saveSearchAttachmentsResult(new nn(e)),null!=r&&r()},function(e){a.searchService.notifySearchAttachmentsFail(),400!=e.code||null==i?a.sendNotification("error_occurred",e):a.searchAttachments(t,n,null,r)})},startUpdateLastUsedAtIfNeed:function(){this.lastUsedAtUpdater.startPolling(fo(this,this.updateLastUsedAt))},updateLastUsedAt:function(){var t=this;this.apiCaller.call("update_last_used_at",[],function(e){t.lastUsedAtUpdater.update()})},addFavoriteTalk:function(e,t){this.apiCaller.call("add_favorite_talk",[e,t])},deleteFavoriteTalk:function(e,t){this.apiCaller.call("delete_favorite_talk",[e,t])},disablePushNotification:function(e,t){this.apiCaller.call("disable_push_notification",[e,t])},enablePushNotification:function(e,t){this.apiCaller.call("enable_push_notification",[e,t])},getSolutions:function(e,t){var n=this;this.apiCaller.call("get_solutions",[e,t],function(e){nt.iter(e,fo(_o=n.dataFactory,_o.newSolution)),n.sendNotification("solutions_loaded")})},getPresences:function(e,a){var o=this;return new Promise(function(r,t){o.apiCaller.call("get_presences",[e,a],function(e){var t=T.nowAsInt64(),n=fo(_o=o.dataFactory,_o.newUserPresence),i=t;nt.iter(e,function(e){return n(e,i)}),o.sendNotification("presences_updated",a),r(a)},function(e){o.apiCaller.handleServerErrorDefault(e),t(e)})})},joinConference:function(n,e){var i=this;this.apiCaller.call("join_conference",[n,e],function(e){var t=new bt(e);i.sendNotification("join_conference_responsed",{talkId:n,joinConference:t})},function(e){i.sendNotification("join_conference_canceled",e)})},rejectConference:function(e){var t=this;this.apiCaller.call("reject_conference",[e],function(e){},function(e){404!=e.code?409!=e.code?t.sendNotification("error_occurred",e):ji._d("["+tt.dateStr(new Date)+"] ","joined.","","","",""):ji._d("["+tt.dateStr(new Date)+"] ","conference not found.","","","","")})},leaveConference:function(e){var t=this;this.apiCaller.call("leave_conference",[e],function(e){},function(e){404!=e.code?t.sendNotification("error_occurred",e):ji._d("["+tt.dateStr(new Date)+"] ","conference not found.","","","","")})},getConferences:function(){var n=this;this.apiCaller.call("get_conferences",[],function(e){var t=e.map(fo(_o=n.dataFactory,_o.newConference));nt.iter(t,function(e){n.sendNotification("notify_open_conference",e)}),n.dataStore.filterReactedConferenceIds(t.filter(function(e){return!n.dataStore.isReactedConferenceId(e.id)}).map(function(e){return e.id}))})},getConferenceParticipants:function(e){var n=this;this.apiCaller.call("get_conference_participants",[e],function(t){at.foreach(n.conferenceStore.getConference(e),function(e){e.participants=t})})},getNoteStatuses:function(e,t){var n=this.settings.getSelectedDomainId();this.apiNote.getNoteStatuses(n,e,t).catch(function(e){ji._d("["+tt.dateStr(new Date)+"] ","getNoteStatuses error:",e,"","","")})},getNote:function(e,t){var n=null!=t?t:function(e,t){};this.apiNote.getNote(e).then(function(e){n(null,e)}).catch(function(e){ji._d("["+tt.dateStr(new Date)+"] ","getNote error:",e,"","",""),n(e,null)})},createNote:function(e,t,n,i,r){ji._w("["+tt.dateStr(new Date)+"] ","'createNote' is deprecated, please use 'res.send' instead.","","","",""),this.apiNote.createNote(e,t,n,i,r).catch(function(e){ji._d("["+tt.dateStr(new Date)+"] ","createNote error:",e,"","","")})},createNoteV2:function(a,o,s,e){var l=this,t=this.dataStore.getTalk(o.getTalkId());if(null!=t){var r=t.domainId,u=o.getNoteId();this.dataStore.setNoteLocalEdit(u,o);for(var n=Promise.resolve(),i=0,c=o.getUnuploadedFileInfos();i<c.length;){var _=[c[i]];++i,n=n.then(function(n){return function(e){return l.prepareNoteFileAsync(n[0].file,n[0].localThumbInfo,r).then((t=n,function(e){t[0].setUploadResult(wt.SUCCESS(e))})).catch((i=n,function(e){i[0].setUploadResult(wt.FAILUER);var t=Ct.convertFileErrorForNote(u,e);if(null!=t){o.setState(Ii.FAILED_BY_FILE(i[0].id,t)),l.dataStore.setNoteLocalEdit(u,o);var n=Or.toLocalError(t,e);l.sendNotification("error_occurred",n)}return Promise.reject(e)}));var i,t}}(_))}var h=null!=e?e:function(e,t){};n.then(function(e){var t=l.apiNote,n=o.getTitle(),i=o.getContentType(),r=o.getContent();return t.createNote(a,n,i,r,s,o)}).then(function(e){h(null,e)}).catch(function(e){ji._d("["+tt.dateStr(new Date)+"] ","createNoteV2 error:",e,"","",""),h(e,null)})}},updateNoteSetting:function(e,t,n){this.apiNote.updateNoteSetting(e,t,n).catch(function(e){ji._d("["+tt.dateStr(new Date)+"] ","updateNoteSetting error:",e,"","","")})},updateNote:function(e,t,n,i,r,a){this.apiNote.updateNote(e,t,n,i,r,a).catch(function(e){ji._d("["+tt.dateStr(new Date)+"] ","updateNote error:",e,"","","")})},updateNoteV2:function(a,o,s,l,e){var u=this,t=this.dataStore.getTalk(s.getTalkId());if(null==t)return Promise.resolve();var r=t.domainId;this.dataStore.setNoteLocalEdit(a,s);for(var n=Promise.resolve(),i=0,c=s.getUnuploadedFileInfos();i<c.length;){var _=[c[i]];++i,n=n.then(function(n){return function(e){return u.prepareNoteFileAsync(n[0].file,n[0].localThumbInfo,r).then((t=n,function(e){t[0].setUploadResult(wt.SUCCESS(e))})).catch((i=n,function(e){i[0].setUploadResult(wt.FAILUER);var t=Ct.convertFileErrorForNote(a,e);if(null!=t){s.setState(Ii.FAILED_BY_FILE(i[0].id,t)),u.dataStore.setNoteLocalEdit(a,s);var n=Or.toLocalError(t,e);u.sendNotification("error_occurred",n)}return Promise.reject(e)}));var i,t}}(_))}var h=null!=e?e:function(e,t){};return n.then(function(e){var t=u.apiNote,n=s.getTitle(),i=s.getContentType(),r=s.getContent();return t.updateNote(a,o,n,i,r,l,s)}).then(function(e){h(null,e)}).catch(function(e){return ji._d("["+tt.dateStr(new Date)+"] ","updateNote error:",e,"","",""),h(e,null),409==e.code&&"locked by another user"==e.message?Promise.reject(e):u.unlockNote(a,o).then(function(e){})}).catch(function(e){})},deleteNote:function(e,t){var n=null!=t?t:function(e,t){};this.apiNote.deleteNote(e).then(function(e){n(null,e)}).catch(function(e){ji._d("["+tt.dateStr(new Date)+"] ","deleteNote error:",e,"","",""),n(e,null)})},lockNote:function(e,t){var n=this.settings.getSelectedDomainId();return this.apiNote.lockNote(n,e,t)},unlockNote:function(e,t){var n=this.settings.getSelectedDomainId();return this.apiNote.unlockNote(n,e,t)},addFavoriteMessage:function(e,t,n){var i=this;this.apiCaller.call("add_favorite_message",[e,t,n],function(e){i.sendNotification("add_favorite_message_completed",new Wn(e))},function(e){400==e.code&&"invalid message"==e.message&&ji._d("["+tt.dateStr(new Date)+"] ","invalid message.","","","",""),400==e.code&&"invalid message (not favoritable message)"==e.message&&ji._d("["+tt.dateStr(new Date)+"] ","invalid message (not favoritable message).","","","",""),403==e.code&&"forbidden"==e.message&&ji._d("["+tt.dateStr(new Date)+"] ","forbidden.","","","",""),404==e.code&&ji._d("["+tt.dateStr(new Date)+"] ","message is not found.","","","",""),409!=e.code||"conflict"!=e.message?i.sendNotification("error_occurred",e):ji._d("["+tt.dateStr(new Date)+"] ","conflict","","","","")})},deleteFavoriteMessage:function(e,t){var n=this;this.apiCaller.call("delete_favorite_message",[e,t],function(e){n.sendNotification("delete_favorite_message_completed",new Vn(e))},function(e){400==e.code&&ji._d("["+tt.dateStr(new Date)+"] ","invalid parameter.","","","",""),404==e.code&&ji._d("["+tt.dateStr(new Date)+"] ","message is not found.","","","",""),n.sendNotification("error_occurred",e)})},getFavoriteMessages:function(a,o,e){var s=this;this.apiCaller.call("get_favorite_messages",[a,o,20,e],function(e){var t=e.marker,n=e.next_marker,i=e.contents.map(fo(_o=s.dataFactory,_o.newMessage)),r=new qn(a,o,t,n,i);s.sendNotification("get_favorite_messages_completed",r)},function(e){400==e.code&&ji._d("["+tt.dateStr(new Date)+"] ","invalid parameter.","","","",""),s.sendNotification("error_occurred",e)})},getStampsets:function(e){var i=this;return new Promise(function(n,t){i.apiCaller.call("get_stampsets",[e],function(e){var t=e.map(vn.originalStampset);i.stampsStore.addStampsets(t),n(t)},function(e){t(e)})})},asInt:function(e){return Ga.__cast(e,mo)},__class__:or});var sr=function(){this.callbacksWhenCreateSessionSucceed=[],this.createSessionSucceed=!1,er.call(this,"apiCaller")};(n["albero.proxy.ApiCallerProxy"]=sr).__name__=["albero","proxy","ApiCallerProxy"],sr.delayForReplicationLag=function(){return Gi.delay(500)},sr.__super__=er,sr.prototype=i(er.prototype,{onSessionClear:function(){this.createSessionSucceed=!1},onSessionCreated:function(){this.createSessionSucceed=!0},fireCallbacksWaitingForSession:function(){nt.iter(this.callbacksWhenCreateSessionSucceed,function(e){e()}),this.callbacksWhenCreateSessionSucceed.splice(0,this.callbacksWhenCreateSessionSucceed.length)},callImmediately:function(e,t,n,i){this.rpc.call(e,t,n,i)},callImmediatelyReliable:function(t,n,i,r,a,o){null==o&&(o=3);var s=this,e=this.createOnErrorReliable(o,r,a,function(e){wa.delay(function(){s.callImmediatelyReliable(t,n,i,r,a,o-1)},e)});this.callImmediately(t,n,i,e)},call:function(e,t,n,i){function r(){a(o,s,l,u)}var a=fo(_o=this.rpc,_o.call),o=e,s=t,l=n,u=i;this.createSessionSucceed?r():this.callbacksWhenCreateSessionSucceed.push(r)},callApiReliable:function(t,n,i,r,a,o){null==o&&(o=3);var s=this,e=this.createOnErrorReliable(o,r,a,function(e){wa.delay(function(){s.callApiReliable(t,n,i,r,a,o-1)},e)});this.call(t,n,i,e)},createOnErrorReliable:function(n,i,r,a){var t=this;return null==r&&(r=function(e){return 404==e.code?Ca.Some(t.retryTimeForReplicationLag()):Ca.None}),null==i&&(i=fo(this,this.handleServerErrorDefault)),function(e){if(0!=n){var t=r(e);at.isEmpty(t)?i(e):at.foreach(t,a)}else i(e)}},handleServerErrorDefault:function(e){this.rpc.onServerError(e)},restart:function(){this.rpc.restart()},retryTimeForReplicationLag:function(){return 1e3},__class__:sr});var lr=function(){er.call(this,"apiNote")};(n["albero.proxy.ApiNoteProxy"]=lr).__name__=["albero","proxy","ApiNoteProxy"],lr.__super__=er,lr.prototype=i(er.prototype,{getNoteStatuses:function(n,r,i){var a=this;return new Promise(function(t,e){a.apiCaller.call("get_note_statuses",[n,r,60,i],function(e){t(new $n(e))},e)}).then(function(e){if(e.isNotEmptyNoteStatuses())for(var t=0,n=e.noteStatuses;t<n.length;){var i=n[t];++t,a.dataStore.setNoteRevisionSummary(i.noteId,i.getNoteRevisionSummary())}return a.sendNotification("get_note_statuses_loaded",{talkId:r,result:e}),e},function(e){return a.sendNotification("error_occurred",e),Promise.reject(e)})},getNote:function(n){var i=this;return new Promise(function(t,e){i.apiCaller.call("get_note",[n.value],function(e){t(new Zn(e))},e)}).then(function(e){return i.dataStore.setNote(e.getNoteId(),e.note),i.sendNotification("get_note_loaded",e),e},function(e){return 404==e.code?(i.dataStore.setNote(n,null),i.sendNotification("get_note_failed_by_note_not_found",n)):i.sendNotification("error_occurred",e),Promise.reject(e)})},createNote:function(i,r,a,o,s,l){var u=this;return new Promise(function(t,e){var n=yi.getValue(a);u.apiCaller.callApiReliable("create_note",[i,r,n,o,s],function(e){t(new Jn(e))},e,fo(u,u.retryTimeForCreateOrUpdateNoteFromError))}).then(function(e){var t;return null!=l&&u.dataStore.setNoteLocalEdit(l.getNoteId(),null),t=null!=l&&l.hasEmitterKey()?e.updateWithEmitterKey(l.getEmitterKey()):e,u.sendNotification("create_note_completed",t),e},function(e){if(null!=l&&(l.setState(Ii.FAILED_BY_UNKNOWN),u.dataStore.setNoteLocalEdit(l.getNoteId(),l)),null!=l&&l.hasEmitterKey()){var t=u.dataStore.me.id,n=l.getEmitterKey();u.sendNotification("create_note_failed",new Qn(t,e,n))}return u.sendNotification("error_occurred",e),Promise.reject(e)})},updateNoteSetting:function(n,i,r){var a=this;return new Promise(function(t,e){a.apiCaller.call("update_note_setting",[n.value,i,r],function(e){t(new ti(e))},e)}).then(function(e){return a.sendNotification("update_note_setting_completed",e),e},function(e){return 404==e.code?(a.dataStore.setNote(n,null),a.sendNotification("update_note_setting_failed_by_not_found",n)):409==e.code&&"conflict"==e.message?(a.dataStore.setNote(n,null),a.sendNotification("update_note_setting_failed_by_conflict",n)):409==e.code&&"locked by another user"==e.message&&null!=e.detail&&null!=e.detail.user_id&&null!=e.detail.device_id?a.sendNotification("update_note_setting_failed_by_editing",n):a.sendNotification("error_occurred",e),Promise.reject(e)})},updateNote:function(i,r,a,o,s,l,t){var u=this;return new Promise(function(t,e){var n=yi.getValue(o);u.apiCaller.callApiReliable("update_note",[i.value,r,a,n,s,l],function(e){t(new ei(e))},e,fo(u,u.retryTimeForCreateOrUpdateNoteFromError))}).then(function(e){return null!=t&&u.dataStore.setNoteLocalEdit(i,null),u.dataStore.setNote(i,e.note),u.sendNotification("update_note_completed",e),e},function(e){return 404==e.code?null!=t?(t.setState(Ii.FAILED_BY_NOT_FOUND),u.dataStore.setNoteLocalEdit(i,t)):u.dataStore.setNote(i,null):409==e.code&&"conflict"==e.message?null!=t?(t.setState(Ii.FAILED_BY_CONFLICT),u.dataStore.setNoteLocalEdit(i,t)):u.dataStore.setNote(i,null):409==e.code&&"locked by another user"==e.message&&null!=e.detail&&null!=e.detail.user_id&&null!=e.detail.device_id?null!=t&&(t.setState(Ii.FAILED_BY_CONFLICT),u.dataStore.setNoteLocalEdit(i,t)):(null!=t&&(t.setState(Ii.FAILED_BY_UNKNOWN),u.dataStore.setNoteLocalEdit(i,t)),u.sendNotification("error_occurred",e)),Promise.reject(e)})},deleteNote:function(n){var i=this;return new Promise(function(t,e){i.apiCaller.call("delete_note",[n.value],function(e){t(new Xn(e))},e)}).then(function(e){return i.sendNotification("delete_note_completed",e),e},function(e){return 404==e.code&&i.dataStore.setNote(n,null),i.sendNotification("error_occurred",e),Promise.reject(e)})},lockNote:function(n,r,a){var o=this;return new Promise(function(e,t){o.apiCaller.call("lock_note",[r.value,a],e,t)}).then(function(e){var t=o.dataStore.getNote(r);if(null!=t){var n=o.dataStore.me.id,i=o.settings.getDeviceId();t.lock(a,n,i,e)}return new Ai(Ni.COMPLETED(new Ei(e)))}).catch(function(e){if(400==e.code)return ji._d("["+tt.dateStr(new Date)+"] ","invalid parameter.","","","",""),o.sendNotification("error_occurred",e),new Ai(Ni.FAILED_BY_UNKNOWN);if(403==e.code)return ji._d("["+tt.dateStr(new Date)+"] ","forbidden.","","","",""),o.sendNotification("error_occurred",e),new Ai(Ni.FAILED_BY_UNKNOWN);if(404==e.code)return ji._d("["+tt.dateStr(new Date)+"] ","note is not found.","","","",""),o.dataStore.setNote(r,null),new Ai(Ni.FAILED_BY_NOT_FOUND);if(409!=e.code||"locked by another user"!=e.message||null==e.detail||null==e.detail.user_id||null==e.detail.device_id)return 409==e.code&&"conflict"==e.message?(ji._d("["+tt.dateStr(new Date)+"] ","conflict","","","",""),new Ai(Ni.FAILED_BY_CONFLICT)):(o.sendNotification("error_occurred",e),new Ai(Ni.FAILED_BY_UNKNOWN));var t=o.dataStore.getUser(n,e.detail.user_id);return new Ai(Ni.FAILED_BY_LOCKED(t))})},unlockNote:function(n,i,r){var a=this;return new Promise(function(e,t){a.apiCaller.call("unlock_note",[i.value,r],e,t)}).then(function(e){var t=a.dataStore.getNote(i);return null!=t&&t.unlock(r,a.dataStore.me.id),new Ai(Ni.RELEASED)}).catch(function(e){if(400==e.code)return ji._d("["+tt.dateStr(new Date)+"] ","invalid parameter.","","","",""),a.sendNotification("error_occurred",e),new Ai(Ni.FAILED_BY_UNKNOWN);if(403==e.code)return ji._d("["+tt.dateStr(new Date)+"] ","forbidden.","","","",""),a.sendNotification("error_occurred",e),new Ai(Ni.FAILED_BY_UNKNOWN);if(404==e.code)return ji._d("["+tt.dateStr(new Date)+"] ","note is not found.","","","",""),a.dataStore.setNote(i,null),new Ai(Ni.FAILED_BY_NOT_FOUND);if(409==e.code&&"conflict"==e.message)return new Ai(Ni.FAILED_BY_CONFLICT);if(409!=e.code||"locked by another user"!=e.message||null==e.detail||null==e.detail.user_id||null==e.detail.device_id)return a.sendNotification("error_occurred",e),new Ai(Ni.FAILED_BY_UNKNOWN);var t=a.dataStore.getUser(n,e.detail.user_id);return new Ai(Ni.FAILED_BY_LOCKED(t))})},retryTimeForCreateOrUpdateNoteFromError:function(e){return this.shouldRetryCreateOrUpdateNote(e)?Ca.Some(this.apiCaller.retryTimeForReplicationLag()):Ca.None},shouldRetryCreateOrUpdateNote:function(e){return null!=e.code&&(500==e.code?"Internal Error (IllegalStateException)"==e.message:400==e.code&&"invalid file_id"==e.message)},__class__:lr});var ur=function(){er.call(this,"appState")};(n["albero.proxy.AppStateProxy"]=ur).__name__=["albero","proxy","AppStateProxy"],ur.__super__=er,ur.prototype=i(er.prototype,{start:function(){this.updateLastActivityAt(),this.checkInactiveInterval()},activateAppIfNeed:function(){this.updateLastActivityAt(),this.appState==g.Inactive&&this.setAppState(g.Active)},setAppState:function(e){ji._d("["+tt.dateStr(new Date)+"] ","APP_STATE_CHANGED: ",e,"","",""),this.appState=e,this.sendNotification("app_state_changed",this.appState)},updateLastActivityAt:function(){this.lastActivityAt=new Date},checkInactiveInterval:function(){this.checkInactive(),new wa(500).run=fo(this,this.checkInactive)},checkInactive:function(){this.appState!=g.Inactive&&((new Date).getTime()-this.lastActivityAt.getTime()<2e3||this.setAppState(g.Inactive))},__class__:ur});var cr=function(){er.call(this,"conferenceStore"),this.conferencesMap=new Ma,this.talkIdConferenceIdMap=new Ma};(n["albero.proxy.ConferenceStoreProxy"]=cr).__name__=["albero","proxy","ConferenceStoreProxy"],cr.__super__=er,cr.prototype=i(er.prototype,{addConference:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.conferencesMap;null!=Io[n]?i.setReserved(n,e):i.h[n]=e;var r=e.talkId,a="_"+r.high+"_"+r.low,o=this.talkIdConferenceIdMap;null!=Io[a]?o.setReserved(a,n):o.h[a]=n},removeConference:function(e){this.dataStore.removeReactedConfereceId(e.id);var t=e.id,n="_"+t.high+"_"+t.low;this.conferencesMap.remove(n);var i=e.talkId,r="_"+i.high+"_"+i.low,a=this.talkIdConferenceIdMap;(null!=Io[r]?a.getReserved(r):a.h[r])==n&&this.talkIdConferenceIdMap.remove(r),this.messageStore.onConferenceClose(e)},getConference:function(e){var t="_"+e.high+"_"+e.low,n=this.conferencesMap;return at.option(null!=Io[t]?n.getReserved(t):n.h[t])},hasConference:function(e){if(null==e)return!1;var t="_"+e.high+"_"+e.low,n=this.talkIdConferenceIdMap;return null!=Io[t]?n.existsReserved(t):n.h.hasOwnProperty(t)},hasConferenceInDomain:function(n){return null!=nt.find(this.getConferenceTalkIds().map(it.makeFromIdStr).map(fo(_o=this.dataStore,_o.getTalk)),function(e){if(null==e)return!1;var t=e.domainId;return null!=t&&null!=n&&t.high==n.high&&t.low==n.low})},getConferenceTalkIds:function(){for(var e=[],t=this.talkIdConferenceIdMap.keys();t.hasNext();){var n=t.next();e.push(n)}return e},hasConferenceInAllDomains:function(i){return at.isEmpty(i)?this.talkIdConferenceIdMap.keys().hasNext():null!=nt.find(this.getConferenceTalkIds().map(it.makeFromIdStr).map(fo(_o=this.dataStore,_o.getTalk)),function(e){if(null==e)return!1;var t=e.domainId,n=at.get(i);return!(null!=t&&null!=n&&t.high==n.high&&t.low==n.low)})},removeConferencesOnLeaveDomain:function(e){for(var t=this.conferencesMap,n=new Oa(t,t.arrayKeys());n.hasNext();){var i=n.next(),r=i.domainId;null!=r&&null!=e&&r.high==e.high&&r.low==e.low&&(this.removeConference(i),this.sendNotification("notify_close_conference",i))}},removeConferencesOnLeaveTalk:function(e){for(var t=this.conferencesMap,n=new Oa(t,t.arrayKeys());n.hasNext();){var i=n.next(),r=i.talkId;null!=r&&null!=e&&r.high==e.high&&r.low==e.low&&(this.removeConference(i),this.sendNotification("notify_close_conference",i))}},updatePrevSelectedMic:function(e){var t=this.settings.getBrowserSettings().createCopy(),n=this.dataStore.me;if(null!=n){var i=n.id;t.setPrevSelectedMic("_"+i.high+"_"+i.low,e),this.settings.applyUserDataSettings(t)}},updatePrevSelectedSpeaker:function(e){var t=this.settings.getBrowserSettings().createCopy(),n=this.dataStore.me;if(null!=n){var i=n.id;t.setPrevSelectedSpeaker("_"+i.high+"_"+i.low,e),this.settings.applyUserDataSettings(t)}},updatePrevSelectedCamera:function(e){var t=this.settings.getBrowserSettings().createCopy(),n=this.dataStore.me;if(null!=n){var i=n.id;t.setPrevSelectedCamera("_"+i.high+"_"+i.low,e),this.settings.applyUserDataSettings(t)}},getPrevSelectedDevice:function(){var e=this.dataStore.me;if(null==e)return{mic:"",speaker:"",camera:""};var t=e.id,n="_"+t.high+"_"+t.low;return this.settings.getBrowserSettings().getPrevSelectedDevice(n)},__class__:cr});var _r=function(){var e=new zn(-1,-1);this.dummyFileId=e;var t=new zn(-1,-1);this.dummyMsgId=t,er.call(this,"dataFactory")};(n["albero.proxy.DataFactoryProxy"]=_r).__name__=["albero","proxy","DataFactoryProxy"],_r.__super__=er,_r.prototype=i(er.prototype,{onRegister:function(){},newAcquaintance:function(e){return this.dataStore.addAcquaintance(this.newDomainUser(e))},newFriend:function(e){return this.dataStore.addFriend(this.newDomainUser(e))},newDomainUser:function(e){return new et(e)},newDomain:function(e){return this.dataStore.setDomainIfLatest(new dt(e))},newDomainInvite:function(e){return this.dataStore.setDomainInvite(new ft(e))},newTalk:function(e){return this.dataStore.setTalk(new Tn(e))},newTalkStatus:function(e){return this.dataStore.setTalkStatus(new Fn(e))},newMessage:function(e){var t=new Mt(e);switch(t.type[1]){case 4:this.fileInfoStore.setMessageFileInfos(t.id,[St.fromMessageAndFile(t,t.content)]);break;case 5:var n=t;this.fileInfoStore.setMessageFileInfos(t.id,rt.asArray(t.content.files).map(function(e){return St.fromMessageAndFile(n,e)}))}return this.messageStore.setMessage(t),t},newDummyMessage:function(e,t,n){var i=this,r=new Mt;r.id=this.dummyMsgId,r.userId=this.dataStore.me.id,r.talkId=e,r.type=t,r.content=n;var a,o=this.dummyMsgId;if(null==o)a=null;else{var s=new zn(0,1),l=o.high-s.high|0,u=o.low-s.low|0;if(ga.ucompare(o.low,s.low)<0){l--;l|=0}a=new zn(l,u)}switch(this.dummyMsgId=a,r.type[1]){case 4:var c=[this.createDummyFileInfo(r,r.content)];this.fileInfoStore.setMessageFileInfos(r.id,c);break;case 5:var _=Ga.__cast(r.content.files,Array).map(function(e){return i.createDummyFileInfo(r,e)});this.fileInfoStore.setMessageFileInfos(r.id,_)}return this.messageStore.setMessage(r),r},newDummyFileMessage:function(e,t){var n=this.createFileInfoDynamic(t);return this.newDummyMessage(e,Rt.file,n)},newDummyMultipleFileMessage:function(e,t,n){var i=nt.array(n.filter(function(e){return null!=e.file}).map(fo(this,this.createFileInfoDynamic)));return this.newDummyMessage(e,Rt.textMultipleFile,{text:t,files:i})},createFileInfoDynamic:function(e){var t=e.file;return{content_type:t.type,content_size:t.size,name:Vi.normalizeForFile(t.name),file:t,localThumbInfo:e.thumb}},createDummyFileInfo:function(e,t){var n,i=St.fromMessageAndFileWithFileId(e,t,this.dummyFileId),r=this.dummyFileId;if(null==r)n=null;else{var a=new zn(0,1),o=r.high-a.high|0,s=r.low-a.low|0;if(ga.ucompare(r.low,a.low)<0){o--;o|=0}n=new zn(o,s)}return this.dummyFileId=n,i},newQuestion:function(e){return this.dataStore.setQuestion(new Qt(e))},newFileInfo:function(e){var t=new St(e);return this.fileInfoStore.setTalkFileInfo(t,!0),t},newAnnouncement:function(e){return new ut(e)},newAnnouncementStatus:function(e){return this.dataStore.setAnnouncementStatus(new Re(e))},newAnnouncementStatusForDomain:function(e){var t=new Re;return t.domainId=e,t.unreadCount=0,this.dataStore.setAnnouncementStatus(t)},newAccountControlRequest:function(e){return this.dataStore.setAccountControlRequest(new lt(e))},newAccountControlGroup:function(e){return this.dataStore.setAccountControlGroup(new ot(e))},newSolution:function(e){var t=new _n(e);return this.solutionsStore.setSolution(t),t},newUserPresence:function(e,t){var n=new Gn(e,t);return this.dataStore.setUserPresence(n),n},newConference:function(e){var t=new ht(e);return this.conferenceStore.addConference(t),t},__class__:_r});var hr=function(){er.call(this,"dataStore")};(n["albero.proxy.DataStoreProxy"]=hr).__name__=["albero","proxy","DataStoreProxy"],hr.__super__=er,hr.prototype=i(er.prototype,{onRegister:function(){this.init()},setMe:function(e){this.me=e;for(var t=0,n=this.getDomains();t<n.length;){var i=n[t];++t,this.sendNotification("notify_update_user",this.me.toDomainUser(i.id))}this.sendNotification("current_user_changed",e),this.storage.setDirtyFlag()},getMe:function(){return this.me},isMe:function(e){if(null==this.me)return!1;var t=this.me.id;return null!=t&&null!=e&&t.high==e.high&&t.low==e.low},getFriendsOrAcquaintances:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=Io[t]?n.getReserved(t):n.h[t],r=[];if(null!=i)for(var a=new Oa(i,i.arrayKeys());a.hasNext();){var o=a.next();0!=o.type&&1!=o.type||r.push(o.user)}return r},getFriends:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=Io[t]?n.getReserved(t):n.h[t],r=[];if(null!=i)for(var a=new Oa(i,i.arrayKeys());a.hasNext();){var o=a.next();0==o.type&&r.push(o.user)}return r},getAcquaintances:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=Io[t]?n.getReserved(t):n.h[t],r=[];if(null!=i)for(var a=new Oa(i,i.arrayKeys());a.hasNext();){var o=a.next();1==o.type&&r.push(o.user)}return r},isFriend:function(e,t){var n="_"+e.high+"_"+e.low,i=this.users,r=null!=Io[n]?i.getReserved(n):i.h[n];if(null==r)return!1;var a="_"+t.high+"_"+t.low,o=null!=Io[a]?r.getReserved(a):r.h[a];return null!=o&&0==o.type},addFriend:function(e){var t=this.ensureDomainUserMap(e.domainId),n=e.id,i="_"+n.high+"_"+n.low,r={type:0,user:e};return null!=Io[i]?t.setReserved(i,r):t.h[i]=r,this.storage.setDirtyFlag(),e},addAcquaintance:function(e){var t=this.ensureDomainUserMap(e.domainId),n=e.id,i="_"+n.high+"_"+n.low,r={type:1,user:e};return null!=Io[i]?t.setReserved(i,r):t.h[i]=r,this.storage.setDirtyFlag(),e},ensureDomainUserMap:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=Io[t]?n.getReserved(t):n.h[t];if(null==i){i=new Ma;var r=this.users;null!=Io[t]?r.setReserved(t,i):r.h[t]=i}return i},setUserIfLatest:function(e,t){null==e&&(e=this.ensureDomainUserMap(t.domainId));var n=t.id,i="_"+n.high+"_"+n.low,r=null!=Io[i]?e.getReserved(i):e.h[i];if(null!=r){var a=t.updatedAt,o=r.user.updatedAt,s=a.high-o.high|0;s=0!=s?s:ga.ucompare(a.low,o.low);var l=a.high<0?o.high<0?s:-1:0<=o.high?s:1;(1<l||2==r.type&&0!=l)&&(r.user=t,this.sendNotification("notify_update_user",t))}else{var u={type:2,user:t};null!=Io[i]?e.setReserved(i,u):e.h[i]=u}this.storage.setDirtyFlag()},setUserPresence:function(e){null==this.userPresences&&(this.userPresences=new Ma);var t=e.userId,n="_"+t.high+"_"+t.low,i=this.userPresences;null!=Io[n]?i.setReserved(n,e):i.h[n]=e,this.storage.setDirtyFlag()},getUserPresence:function(e){if(null==this.userPresences)return null;var t="_"+e.high+"_"+e.low,n=this.userPresences;return null!=Io[t]?n.getReserved(t):n.h[t]},isDepartmentsChanged:function(e,t){return!it.eqArray(e.departments,t.departments)},setUsersIfLatest:function(e,t){var n=this.ensureDomainUserMap(e),i=fo(this,this.setUserIfLatest),r=n;nt.iter(t,function(e){i(r,e)})},clearDomainUsers:function(e){this.users.remove("_"+e.high+"_"+e.low)&&this.storage.setDirtyFlag()},clearUsersDepartments:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=Io[t]?n.getReserved(t):n.h[t];if(null!=i)for(var r=new Oa(i,i.arrayKeys());r.hasNext();){var a=r.next();a.user.departments=null,this.sendNotification("notify_update_user",a.user)}this.storage.setDirtyFlag()},removeFriend:function(e,t){var n="_"+e.high+"_"+e.low,i=this.users,r=null!=Io[n]?i.getReserved(n):i.h[n];if(null!=r){var a="_"+t.high+"_"+t.low,o=null!=Io[a]?r.getReserved(a):r.h[a];null!=o&&(o.type=2)}this.storage.setDirtyFlag()},removeAcquaintance:function(e,t){this.removeFriend(e,t)},getUser:function(e,t){if(null==t)return null;var n,i=new zn(0,0);if(t.high==i.high&&t.low==i.low)return null;if(null!=this.me){var r=this.me.id;n=null!=r&&null!=t&&r.high==t.high&&r.low==t.low}else n=!1;if(n)return this.me.toDomainUser(e);var a="_"+e.high+"_"+e.low,o=this.users,s=null!=Io[a]?o.getReserved(a):o.h[a];if(null!=s){var l="_"+t.high+"_"+t.low,u=null!=Io[l]?s.getReserved(l):s.h[l];if(null!=u)return u.user}return null},getUsers:function(e,t){function n(a,e){var t="_"+a.high+"_"+a.low,n=l.users,o=null!=Io[t]?n.getReserved(t):n.h[t];if(null==o)return[];if(null!=e)return e.map(function(e){var t=new zn(0,0);if(e.high==t.high&&e.low==t.low)return null;var n=l.me.id;if(null!=n&&null!=e&&n.high==e.high&&n.low==e.low)return l.me.toDomainUser(a);var i="_"+e.high+"_"+e.low,r=null!=Io[i]?o.getReserved(i):o.h[i];return null!=r?r.user:null});for(var i=[],r=o.arrayKeys(),s=new Oa(o,r);s.hasNext();)i.push(s.next().user);return i}var l=this;if(null!=e)return n(e,t);for(var i=this.domains,r=new Oa(i,i.arrayKeys()),a=null;r.hasNext();)a=null==a?n(r.next().id,t):a.concat(n(r.next().id,t));return null==a?[]:a},getTalk:function(e){var t="_"+e.high+"_"+e.low,n=this.talks;return null!=Io[t]?n.getReserved(t):n.h[t]},getValidPairTalk:function(n,i){var r=this;return null==this.me?null:nt.find(this.getTalks(),function(e){if(!ee.enumEq(e.type,Nn.PairTalk))return!1;var t=e.domainId;return null!=t&&null!=i&&t.high==i.high&&t.low==i.low&&(!!nt.exists(e.userIds,function(e){return null!=e&&null!=n&&e.high==n.high&&e.low==n.low})&&!!nt.exists(e.userIds,function(e){var t=r.me.id;return null!=e&&null!=t&&e.high==t.high&&e.low==t.low}))})},setTalk:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.talks;if(null!=Io[n]?i.setReserved(n,e):i.h[n]=e,null!=e.leftUsers)for(var r=this.ensureDomainUserMap(e.domainId),a=0,o=e.leftUsers;a<o.length;){var s=o[a];++a;var l=s.id,u="_"+l.high+"_"+l.low,c=null!=Io[u]?r.getReserved(u):r.h[u];if(null!=c){var _;if(2==c.type){var h=s.updatedAt,d=c.user.updatedAt,f=h.high-d.high|0;f=0!=f?f:ga.ucompare(h.low,d.low),_=0<(h.high<0?d.high<0?f:-1:0<=d.high?f:1)}else _=!1;_&&(c.user=s,this.sendNotification("notify_update_user",s))}else{var m={type:2,user:s};null!=Io[u]?r.setReserved(u,m):r.h[u]=m,this.sendNotification("notify_update_user",s)}}return this.storage.setDirtyFlag(),e},getTalks:function(){for(var e=[],t=this.talks.keys();t.hasNext();){var n=t.next(),i=this.talks;e.push(null!=Io[n]?i.getReserved(n):i.h[n])}return e},setTalks:function(e){nt.iter(e,fo(this,this.setTalk))},removeTalk:function(e){if(null!=this.domainUnreadCounts){var t="_"+e.high+"_"+e.low,n=this.talks,i=null!=Io[t]?n.getReserved(t):n.h[t];if(null!=i){var r=i.domainId;this.domainUnreadCounts.remove("_"+r.high+"_"+r.low)}}if(null!=this.questions)for(var a=this.getQuestions(e),o=0;o<a.length;){var s=a[o];++o;var l=s.id;this.questions.remove("_"+l.high+"_"+l.low)}this.talks.remove("_"+e.high+"_"+e.low),this.storage.setDirtyFlag()},getTalkStatuses:function(){for(var e=[],t=this.talkStatuses.keys();t.hasNext();){var n=t.next(),i=this.talks;if(null!=Io[n]?i.existsReserved(n):i.h.hasOwnProperty(n)){var r=this.talkStatuses;e.push(null!=Io[n]?r.getReserved(n):r.h[n])}}return e},getTalkStatus:function(e){var t="_"+e.high+"_"+e.low,n=this.talkStatuses;return null!=Io[t]?n.getReserved(t):n.h[t]},setTalkStatus:function(e){var t=e.id,n="_"+t.high+"_"+t.low;if(null!=this.domainUnreadCounts){var i=this.talks,r=null!=Io[n]?i.getReserved(n):i.h[n];if(null!=r){var a=r.domainId;this.domainUnreadCounts.remove("_"+a.high+"_"+a.low)}}var o=this.talkStatuses;return null!=Io[n]?o.setReserved(n,e):o.h[n]=e,this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),e},removeTalkStatus:function(e){var t="_"+e.high+"_"+e.low;if(null!=this.domainUnreadCounts){var n=this.talks,i=null!=Io[t]?n.getReserved(t):n.h[t];if(null!=i){var r=i.domainId;this.domainUnreadCounts.remove("_"+r.high+"_"+r.low)}}this.talkStatuses.remove(t),this.storage.setDirtyFlag()},getDomains:function(){for(var e=[],t=this.domains,n=new Oa(t,t.arrayKeys());n.hasNext();){var i=n.next();e.push(i)}return e},getDomain:function(e){var t="_"+e.high+"_"+e.low,n=this.domains;return null!=Io[t]?n.getReserved(t):n.h[t]},setDomainIfLatest:function(e){var t,n=e.id,i="_"+n.high+"_"+n.low,r=this.domains,a=null!=Io[i]?r.getReserved(i):r.h[i];if(null!=a){var o=e.updatedAt,s=a.updatedAt,l=o.high-s.high|0;l=0!=l?l:ga.ucompare(o.low,s.low),t=0<=(o.high<0?s.high<0?l:-1:0<=s.high?l:1)}else t=!0;if(t){var u=this.domains;return null!=Io[i]?u.setReserved(i,e):u.h[i]=e,this.storage.setDirtyFlag(),e}return a},removeDomain:function(n){this.domains.remove("_"+n.high+"_"+n.low),this.storage.setDirtyFlag();for(var e=this.getTalks().filter(function(e){var t=e.domainId;return null!=t&&null!=n&&t.high==n.high&&t.low==n.low}),t=0;t<e.length;){var i=e[t];++t,this.removeTalk(i.id),this.removeTalkStatus(i.id)}},getUnreadCount:function(){for(var e=0,t=this.domains.keys();t.hasNext();){var n=t.next();e+=this._getDomainUnreadCount(n)}return e+=this.getDomainInvitesCount()},_getDomainUnreadCount:function(e){var t;if(null!=this.domainUnreadCounts){var n=this.domainUnreadCounts;t=null!=Io[e]?n.existsReserved(e):n.h.hasOwnProperty(e)}else t=!1;if(t){var i=this.domainUnreadCounts;return null!=Io[e]?i.getReserved(e):i.h[e]}null==this.domainUnreadCounts&&(this.domainUnreadCounts=new Ma);for(var r=0,a=this.talkStatuses,o=new Oa(a,a.arrayKeys());o.hasNext();){var s=o.next();if(null!=s.unreadCount&&0!=s.unreadCount){var l,u=s.id,c="_"+u.high+"_"+u.low,_=this.talks,h=null!=Io[c]?_.getReserved(c):_.h[c];if(null!=h){var d=h.domainId;l="_"+d.high+"_"+d.low==e}else l=!1;l&&(r+=s.unreadCount)}}var f=this.announcementStatuses,m=null!=Io[e]?f.getReserved(e):f.h[e];if(null!=m&&null!=m.unreadCount){var p=this.domains,g=null!=Io[e]?p.getReserved(e):p.h[e];null!=g&&g.role.allowReadAnnouncements&&(r+=m.unreadCount)}var v=this.domainUnreadCounts;return null!=Io[e]?v.setReserved(e,r):v.h[e]=r,r},getDomainUnreadCount:function(e){return null==e?0:this._getDomainUnreadCount("_"+e.high+"_"+e.low)},getDomainInvites:function(){for(var e=[],t=this.domainInvites.keys();t.hasNext();){var n=t.next(),i=this.domainInvites;e.push(null!=Io[n]?i.getReserved(n):i.h[n])}return e},getDomainInvitesCount:function(){var e=0;if(null==this.accountControlGroup)for(var t=this.domainInvites,n=new Oa(t,t.arrayKeys());n.hasNext();){var i=n.next();null!=i.accountControlRequestId&&null!=this.getAccountControlRequest(i.accountControlRequestId)||++e}else for(var r=this.domainInvites,a=new Oa(r,r.arrayKeys());a.hasNext();){a.next();++e}return e},getDomainInvite:function(e){var t="_"+e.high+"_"+e.low,n=this.domainInvites;return null!=Io[t]?n.getReserved(t):n.h[t]},setDomainInvite:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.domainInvites;return null!=Io[n]?i.setReserved(n,e):i.h[n]=e,this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),e},removeDomainInvite:function(e){this.domainInvites.remove("_"+e.high+"_"+e.low),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag()},getQuestions:function(e,t){var n=[];if(null!=this.questions)for(var i=this.questions,r=new Oa(i,i.arrayKeys());r.hasNext();){var a=r.next(),o=a.talkId;if(null!=o&&null!=e&&o.high==e.high&&o.low==e.low){var s;if(null!=t){var l=a.userId;s=!(null!=t&&null!=l&&t.high==l.high&&t.low==l.low)}else s=!1;s||n.push(a)}}return n},getQuestion:function(e){var t="_"+e.high+"_"+e.low,n=this.questions;return null!=Io[t]?n.getReserved(t):n.h[t]},setQuestion:function(e){return e},getAnnouncementStatus:function(e){var t="_"+e.high+"_"+e.low,n=this.announcementStatuses;return null!=Io[t]?n.getReserved(t):n.h[t]},setAnnouncementStatus:function(e){var t=e.domainId,n="_"+t.high+"_"+t.low,i=this.announcementStatuses;return null!=Io[n]?i.setReserved(n,e):i.h[n]=e,null!=this.domainUnreadCounts&&this.domainUnreadCounts.remove(n),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),e},removeAnnouncementStatus:function(e){var t="_"+e.high+"_"+e.low;this.announcementStatuses.remove(t),null!=this.domainUnreadCounts&&this.domainUnreadCounts.remove(t),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag()},getAccountControlRequests:function(){for(var e=[],t=this.accountControlRequests,n=new Oa(t,t.arrayKeys());n.hasNext();){var i=n.next();e.push(i)}return e},getAccountControlRequest:function(e){var t="_"+e.high+"_"+e.low,n=this.accountControlRequests;return null!=Io[t]?n.getReserved(t):n.h[t]},setAccountControlRequest:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.accountControlRequests,r=null!=Io[n]?i.getReserved(n):i.h[n];if(null!=r&&r.version>e.version)return r;var a=this.accountControlRequests;return null!=Io[n]?a.setReserved(n,e):a.h[n]=e,this.storage.setDirtyFlag(),e},removeAccountControlRequest:function(e){var t="_"+e.high+"_"+e.low;this.accountControlRequests.remove(t),this.storage.setDirtyFlag()},removeAccountControlRequests:function(){this.accountControlRequests=new Ma,this.storage.setDirtyFlag()},getAccountControlGroup:function(){return this.accountControlGroup},setAccountControlGroup:function(e){return this.accountControlGroup=e,this.storage.setDirtyFlag(),this.accountControlGroup},updateAccountControlGroup:function(e){if(null!=this.accountControlGroup){var t=this.accountControlGroup.id,n=e.id;if(null!=t&&null!=n&&t.high==n.high&&t.low==n.low){var i=e.group;null!=i&&this.accountControlGroup.group.version<i.version&&(this.accountControlGroup.group=i,this.storage.setDirtyFlag());var r=e.profilePolicy;null!=r&&this.accountControlGroup.profilePolicy.version<r.version&&(this.accountControlGroup.profilePolicy=r,this.storage.setDirtyFlag())}}},removeAccountControlGroup:function(e){var t;if(null!=this.accountControlGroup){var n=this.accountControlGroup.id;t=null!=n&&null!=e&&n.high==e.high&&n.low==e.low}else t=!1;t&&(this.accountControlGroup=null,this.storage.setDirtyFlag())},addReactedConfereceId:function(e){var t="_"+e.high+"_"+e.low,n=this.reactedConferenceIds;null!=Io[t]?n.setReserved(t,!0):n.h[t]=!0,this.storage.setDirtyFlag()},removeReactedConfereceId:function(e){this.reactedConferenceIds.remove("_"+e.high+"_"+e.low),this.storage.setDirtyFlag()},isReactedConferenceId:function(e){var t="_"+e.high+"_"+e.low,n=this.reactedConferenceIds;return null!=Io[t]?n.existsReserved(t):n.h.hasOwnProperty(t)},filterReactedConferenceIds:function(e){var n=this,t=new Ma;nt.iter(e.map(function(e){return"_"+e.high+"_"+e.low}).filter(function(e){var t=n.reactedConferenceIds;return null!=Io[e]?t.existsReserved(e):t.h.hasOwnProperty(e)}),function(e){null!=Io[e]?t.setReserved(e,!0):t.h[e]=!0}),this.reactedConferenceIds=t},getNote:function(e){if(null==this.notes)return null;var t=this.notes,n=e.toString(),i=t;return null!=Io[n]?i.getReserved(n):i.h[n]},setNote:function(e,t){if(null==this.notes&&(this.notes=new Ma),null==t)return this.fileInfoStore.setNoteFileInfos(e,null),this.notes.remove(e.toString()),t;this.fileInfoStore.setNoteFileInfos(e,t.noteRevision.contentFiles);var n=this.notes,i=e.toString(),r=n;return null!=Io[i]?r.setReserved(i,t):r.h[i]=t,t},setNoteRevisionSummary:function(e,t){if(null==this.noteRevisionSummaries&&(this.noteRevisionSummaries=new Ma),null==t)return this.noteRevisionSummaries.remove(e.toString()),void this.fileInfoStore.setNoteFileInfos(e,null);var n=this.noteRevisionSummaries,i=e.toString(),r=n;null!=Io[i]?r.setReserved(i,t):r.h[i]=t,this.fileInfoStore.setNoteFileInfos(e,t.contentFiles)},getNoteRevisionSummary:function(e){if(null==this.noteRevisionSummaries)return null;var t=this.noteRevisionSummaries,n=e.toString(),i=t;return null!=Io[n]?i.getReserved(n):i.h[n]},setNoteLocalEdit:function(e,t){if(null==this.noteLocalEdits&&(this.noteLocalEdits=new Ma),null==t){var n=this.noteLocalEdits,i=e.toString(),r=n,a=null!=Io[i]?r.getReserved(i):r.h[i];if(null==a)return;return this.noteLocalEdits.remove(e.toString()),this.fileInfoStore.setNoteFileInfosForEdit(e,null),void this.sendNotification("clear_note_local_edit",a)}var o=this.noteLocalEdits,s=e.toString(),l=o;null!=Io[s]?l.setReserved(s,t):l.h[s]=t,this.fileInfoStore.setNoteFileInfosForEdit(e,t.getFileInfos()),this.sendNotification("update_note_local_edit",t)},getNoteLocalEdit:function(e){if(null==this.noteLocalEdits)return null;var t=this.noteLocalEdits,n=e.toString(),i=t;return null!=Io[n]?i.getReserved(n):i.h[n]},getNoteLocalEdits:function(e){var t=[];if(null!=this.noteLocalEdits)for(var n=this.noteLocalEdits,i=new Oa(n,n.arrayKeys());i.hasNext();){var r=i.next(),a=r.getTalkId();null!=a&&null!=e&&a.high==e.high&&a.low==e.low&&t.push(r)}return t},clear:function(e){this.users=new Ma,this.talks=new Ma,this.talkStatuses=new Ma,this.domains=new Ma,this.domainInvites=new Ma,this.announcementStatuses=new Ma,this.accountControlRequests=new Ma,this.accountControlGroup=null,this.reactedConferenceIds=new Ma,e&&(this.me=null),this.storage.setDirtyFlag()},init:function(){this.storage=new Bi("dataStore"),this.questions=new Ma;var e=this.storage.load();if(null!=e&&"1.113_0"==e.shift())return this.me=e.shift(),this.users=e.shift(),this.talks=e.shift(),this.talkStatuses=e.shift(),this.domains=e.shift(),this.domainInvites=e.shift(),this.announcementStatuses=e.shift(),this.accountControlRequests=e.shift(),this.accountControlGroup=e.shift(),this.reactedConferenceIds=e.shift(),void ji._d("["+tt.dateStr(new Date)+"] ","dataStore is loaded.","","","","");this.clear(!0),ji._d("["+tt.dateStr(new Date)+"] ","dataStore is initialized.","","","","")},saveIfNeeded:function(){this.storage.isDirty&&(this.storage.save(["1.113_0",this.me,this.users,this.talks,this.talkStatuses,this.domains,this.domainInvites,this.announcementStatuses,this.accountControlRequests,this.accountControlGroup,this.reactedConferenceIds]),ji._d("["+tt.dateStr(new Date)+"] ","dataStore is saved.","","","",""))},__class__:hr});var dr=function(){er.call(this,"departmentStore"),this.departmentMap=new Ma,this.rootDepartmentIdMap=new Ma};(n["albero.proxy.DepartmentStoreProxy"]=dr).__name__=["albero","proxy","DepartmentStoreProxy"],dr.__super__=er,dr.prototype=i(er.prototype,{getDepartment:function(e){if(null==e)return null;var t="_"+e.high+"_"+e.low,n=this.departmentMap;return null!=Io[t]?n.getReserved(t):n.h[t]},setDepartment:function(e){if(null!=e.parentId){var t=this.getDepartment(e.parentId);null!=t&&(t.addChild(e.id),e.depth=t.depth+1)}var n=e.id,i="_"+n.high+"_"+n.low,r=this.departmentMap;null!=Io[i]?r.setReserved(i,e):r.h[i]=e},clearDomainDepartment:function(e){var n=this,t="_"+e.high+"_"+e.low,i=this.rootDepartmentIdMap,r=null!=Io[t]?i.getReserved(t):i.h[t];null!=r&&(nt.iter(this.getDepartmentsDescendantOrSelf(r),function(e){var t=e.id;n.departmentMap.remove("_"+t.high+"_"+t.low)}),this.rootDepartmentIdMap.remove(t))},getRootDepartmentId:function(e){var t="_"+e.high+"_"+e.low,n=this.rootDepartmentIdMap;return null!=Io[t]?n.getReserved(t):n.h[t]},setRootDepartmentId:function(e,t){var n="_"+e.high+"_"+e.low,i=this.rootDepartmentIdMap;null!=Io[n]?i.setReserved(n,t):i.h[n]=t},setDepartmentUserCount:function(e){var t=this.getDepartment(e.departmentId);null!=t&&(t.userCount=e,t.userCountLoading=!1)},setUserCountLoading:function(e,t){var n=this.getDepartment(e);null!=n&&(n.userCountLoading=t)},needUserCountLoading:function(e){var t=this.getDepartment(e);return null==t||null==t.userCount&&!t.userCountLoading},clearDomainDepartmentUsers:function(e){var t=this.getRootDepartmentId(e);null!=t&&(nt.iter(this.getDepartmentsDescendantOrSelf(t),function(e){e.userCount=null,e.userIds=null,e.userCountLoading=!1}),this.sendNotification("department_user_count_cleared",e))},setDepartmentUsers:function(e,t){var n=this.getDepartment(e);null!=n&&(n.userIds=t)},getDepartmentPath:function(e){return this.getDepartmentsAncestorOrSelf(e)},getDepartmentPathWithoutRoot:function(e){return this.getDepartmentPath(e).filter(function(e){return!e.isRoot()})},getDepartmentsAncestorOrSelf:function(e){var t=[];return this._getDepartmentsAncestorOrSelf(e,t),t},_getDepartmentsAncestorOrSelf:function(e,t){var n=this.getDepartment(e);null!=n&&(null!=n.parentId&&this._getDepartmentsAncestorOrSelf(n.parentId,t),t.push(n))},getDepartmentsDescendantOrSelf:function(e){var t=[];return this._getDepartmentsDescendantOrSelf(e,t),t},_getDepartmentsDescendantOrSelf:function(e,t){var n=this,i=this.getDepartment(e);null!=i&&(t.push(i),null!=i.childrenIds&&nt.iter(i.childrenIds,function(e){n._getDepartmentsDescendantOrSelf(e,t)}))},__class__:dr});var fr=function(){er.call(this,"features")};(n["albero.proxy.FeaturesProxy"]=fr).__name__=["albero","proxy","FeaturesProxy"],fr.__super__=er,fr.prototype=i(er.prototype,{canSendMessageOnMultiView:function(e){return!!this.settings.isOnPremises()||this.selectedDomainHasSolution(e,fn.MultiView)},canDetectKeyword:function(e){return!!this.settings.isOnPremises()||this.selectedDomainHasSolution(e,fn.KeywordWatching)},selectedDomainHasSolution:function(e,t){if(null==e)return!1;var n=this.dataStore.getDomain(e);return null!=n&&null!=n.contract&&null!=n.contract.solutionIds&&nt.exists(n.contract.solutionIds,function(e){return _n.getSolutionType(e)==t})},canConference:function(e){if(null==e)return!1;var t=this.dataStore.getDomain(e);return null!=t&&null!=t.contract&&t.contract.isConferenceEnalbed()},__class__:fr});var mr=function(){er.call(this,"fileInfoStore"),this.fileInfoMap=new Ma,this.fileIdStrsMap=new Ma,this.messageFileIdStrsMap=new Ma,this.noteFileIdStrsMap=new Ma,this.stagedFileInfosMaxId=0};(n["albero.proxy.FileInfoStoreProxy"]=mr).__name__=["albero","proxy","FileInfoStoreProxy"],mr.__super__=er,mr.prototype=i(er.prototype,{ensureStagedFileInfos:function(e){return this.ensureStagedFileIdStrs(e).map(it.makeFromIdStr).filter(function(e){return null!=e}).map(fo(this,this.getFileInfo))},moveStagedFile:function(e,t,n){var i=this.ensureStagedFileIdStrs(e);if(null!=i){var r=i[t];tt.remove(i,r),i.splice(n,0,r)}},ensureStagedFileIdStrs:function(e){var t=e.toString(),n=this.fileIdStrsMap,i=null!=Io[t]?n.getReserved(t):n.h[t];if(null==i){i=[];var r=this.fileIdStrsMap;null!=Io[t]?r.setReserved(t,i):r.h[t]=i}return i},addStagedFileInfo:function(e,t,n,i){var r=this.createStagedFileInfo(e,n,i),a=r.id,o="_"+a.high+"_"+a.low,s=this.fileInfoMap;null!=Io[o]?s.setReserved(o,r):s.h[o]=r;var l=r.id,u="_"+l.high+"_"+l.low;return this.ensureStagedFileIdStrs(t).push(u),r},replaceStagedFileInfo:function(e,t,n,i){var r=this.createStagedFileInfo(e.talkId,n,i);return this.replaceStagedFileInfoFromFileId(e.id,t,r),r},replaceStagedFileInfoFromFileId:function(e,t,n){var i=n.id,r="_"+i.high+"_"+i.low,a=this.fileInfoMap;null!=Io[r]?a.setReserved(r,n):a.h[r]=n;var o=this.ensureStagedFileIdStrs(t),s=o.indexOf("_"+e.high+"_"+e.low);if(-1!=s){o.splice(s,1);var l=n.id;o.splice(s,0,"_"+l.high+"_"+l.low),this.removeStagedFileInfo(t,e)}},createStagedFileInfo:function(e,t,n){var i=t,r=new St,a=new zn(0,--this.stagedFileInfosMaxId);return r.id=a,r.talkId=e,null!=t&&(r.contentType=i.type,r.contentSize=i.size,r.addLocalFile(t),r.name=i.name),null!=n&&r.addLocalThumbInfo(n),r},createStagedFileInfoFromDummyFile:function(e,t,n){var i=new St,r=new zn(0,--this.stagedFileInfosMaxId);return i.id=r,i.talkId=e,null!=t&&(i.contentType=t.type,i.contentSize=t.size,i.file=t,i.name=t.name),null!=n&&i.addLocalThumbInfo(n),i},createUploadedFileInfo:function(e){var t=new St;return t.id=e.id,t.contentType=e.content_type,t.contentSize=e.content_size,t.url=e.url,t.name=e.name,t},restoreStagedFile:function(e,t){var n=t.id,i="_"+n.high+"_"+n.low,r=this.fileInfoMap;null!=Io[i]?r.setReserved(i,t):r.h[i]=t;var a=t.id,o="_"+a.high+"_"+a.low;this.ensureStagedFileIdStrs(e).push(o)},removeStagedFileInfo:function(e,t){var n="_"+t.high+"_"+t.low;tt.remove(this.ensureStagedFileIdStrs(e),n);var i=this.fileInfoMap;(null!=Io[n]?i.getReserved(n):i.h[n]).isRemote()||this.fileInfoMap.remove(n)},removeStagedFileInfos:function(e){for(var t=0,n=this.ensureStagedFileIdStrs(e);t<n.length;){var i=n[t];++t,this.fileInfoMap.remove(i)}this.fileIdStrsMap.remove(e.toString())},ensureTalkFileInfos:function(e){return this.ensureTalkFileIds(e).map(fo(this,this.fileInfoGetter))},ensureTalkFileIds:function(e){var t="_"+e.high+"_"+e.low,n=this.fileIdStrsMap,i=null!=Io[t]?n.getReserved(t):n.h[t];if(null==i){i=[];var r=this.fileIdStrsMap;null!=Io[t]?r.setReserved(t,i):r.h[t]=i}return i},getTalkFileInfo:function(e,t,n){return this.getFileInfo(n)},setTalkFileInfo:function(e,t){var n=e.id,i="_"+n.high+"_"+n.low,r=this.fileInfoMap;null!=Io[i]?r.setReserved(i,e):r.h[i]=e;var a=this.ensureTalkFileIds(e.talkId);-1==a.indexOf(i)&&a.push(i)},onFileDeleted:function(e){var t=this.getTalkFileInfo(e.talkId,e.messageId,e.fileId);null!=t&&(t.deleted=!0)},getFileInfo:function(e){var t="_"+e.high+"_"+e.low,n=this.fileInfoMap;return null!=Io[t]?n.getReserved(t):n.h[t]},getMessageFileInfos:function(e){var t=this,n="_"+e.high+"_"+e.low,i=this.messageFileIdStrsMap;return at.map(at.option(null!=Io[n]?i.getReserved(n):i.h[n]),function(e){return e.map(fo(t,t.fileInfoGetter))})},setMessageFileInfos:function(e,t){for(var n=0;n<t.length;){var i=t[n];++n;var r=i.id,a="_"+r.high+"_"+r.low,o=this.fileInfoMap;null!=Io[a]?o.setReserved(a,i):o.h[a]=i}var s=this.messageFileIdStrsMap,l="_"+e.high+"_"+e.low,u=t.map(fo(this,this.fileIdStrGetter)),c=s;null!=Io[l]?c.setReserved(l,u):c.h[l]=u},removeMessageFileInfos:function(e){var t="_"+e.high+"_"+e.low,n=this.messageFileIdStrsMap,i=null!=Io[t]?n.getReserved(t):n.h[t];if(null!=i)for(var r=0;r<i.length;){var a=i[r];++r,this.fileInfoMap.remove(a)}this.messageFileIdStrsMap.remove("_"+e.high+"_"+e.low)},isAllFileDeletedOnMessage:function(e){var t,n=this.getMessageFileInfos(e);switch(n[1]){case 0:t=n[2];break;case 1:t=[]}return!nt.exists(t,function(e){return!e.deleted})},getNoteFileInfos:function(e){var t=this,n=e.toString(),i=this.noteFileIdStrsMap;return at.map(at.option(null!=Io[n]?i.getReserved(n):i.h[n]),function(e){return e.map(fo(t,t.fileInfoGetter))})},setNoteFileInfos:function(e,t){var n=e.toString(),i=this.noteFileIdStrsMap,r=null!=Io[n]?i.getReserved(n):i.h[n];if(null!=r)for(var a=0;a<r.length;){var o=r[a];++a,this.fileInfoMap.remove(o)}if(this.noteFileIdStrsMap.remove(n),null!=t&&0!=t.length){for(var s=0;s<t.length;){var l=t[s];++s;var u=l.id,c="_"+u.high+"_"+u.low,_=this.fileInfoMap;null!=Io[c]?_.setReserved(c,l):_.h[c]=l}var h=this.noteFileIdStrsMap,d=t.map(fo(this,this.fileIdStrGetter)),f=h;null!=Io[n]?f.setReserved(n,d):f.h[n]=d}},getNoteFileInfosForEdit:function(e){var t=this,n=e.toString()+"edit",i=this.noteFileIdStrsMap;return at.map(at.option(null!=Io[n]?i.getReserved(n):i.h[n]),function(e){return e.map(fo(t,t.fileInfoGetter))})},setNoteFileInfosForEdit:function(e,t){var n=e.toString()+"edit",i=this.noteFileIdStrsMap,r=null!=Io[n]?i.getReserved(n):i.h[n];if(null!=r)for(var a=0;a<r.length;){var o=r[a];++a,this.fileInfoMap.remove(o)}if(this.noteFileIdStrsMap.remove(n),null!=t&&0!=t.length){for(var s=0;s<t.length;){var l=t[s];++s;var u=l.id,c="_"+u.high+"_"+u.low,_=this.fileInfoMap;null!=Io[c]?_.setReserved(c,l):_.h[c]=l}var h=this.noteFileIdStrsMap,d=t.map(fo(this,this.fileIdStrGetter)),f=h;null!=Io[n]?f.setReserved(n,d):f.h[n]=d}},fileIdStrGetter:function(e){var t=e.id;return"_"+t.high+"_"+t.low},fileInfoGetter:function(e){var t=this.fileInfoMap;return null!=Io[e]?t.getReserved(e):t.h[e]},__class__:mr});var pr=function(){};(n["albero.proxy.FileServiceProxy"]=pr).__name__=["albero","proxy","FileServiceProxy"],pr.__interfaces__=[Xi],pr.prototype={__class__:pr};var gr=function(){};(n["albero.proxy.FileServiceProxyFactory"]=gr).__name__=["albero","proxy","FileServiceProxyFactory"],gr.newInstance=function(){return new vr("fileService")};var vr=function(e){er.call(this,e)};(n["albero.proxy.FileServiceProxyImplForHubot"]=vr).__name__=["albero","proxy","FileServiceProxyImplForHubot"],vr.__interfaces__=[pr],vr.getContentTypeByFileName=function(e,t){return(new w).resolve({name:e,type:t})},vr.__super__=er,vr.prototype=i(er.prototype,{downloadUrl:function(e,t){if(null==t&&(t=!1),null==e||0==e.length)return"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(W.startsWith(e,this.settings.getValidHost())){var n=this.settings.getAccessToken(),i=e;return-1!=e.indexOf("?")?i+="&":i+="?",i+="Authorization=ALB%20"+n,t&&(i+="&download=true"),i}return e},download:function(e,i,r){var a=this;if(e=this.downloadUrl(e),W.startsWith(e,"data:"))r(null,new Error("download URL was not resolved"));else{var t=Qa.parse(e);null!=wo.proxyURL&&(t.agent=Ki.createAgent(wo.proxyURL));var n=Wa.request(t,function(e){var t=e.headers.location;if(null==t)if(2==Math.floor(e.statusCode/100)){var n=Ka.createWriteStream(i);e.on("data",function(e){n.write(e)}),e.on("end",function(){n.end(),n.on("finish",function(){r(i,null)})}),e.on("error",function(e){r(null,e)}),n.on("error",function(e){r(null,e)})}else r(null,new Error("HTTP request failed ("+e.statusCode+" "+e.statusMessage+")"));else a.download(t,i,r)});n.on("error",function(e){r(null,e)}),n.end()}},uploadForNodeJS:function(e,t,r){var n=r,a=Qa.parse(e.put_url);a.method="PUT";a.headers={},a.headers["Content-Length"]=""+n.size;var i=e.post_form;return a.headers["Content-Type"]=i["Content-Type"],a.headers["Content-Disposition"]=i["Content-Disposition"],null!=wo.proxyURL&&(a.agent=Ki.createAgent(wo.proxyURL)),new Promise(function(n,i){var t=Wa.request(a,function(e){if(2!=Math.floor(e.statusCode/100)){var t="";return e.on("data",function(e){t+=e}),void e.on("end",function(){i(e.statusCode+": "+t)})}Gi.resolveVoid(n)});t.on("error",function(e){i(e.message)});var e=Ka.createReadStream(r.path);e.on("data",function(e){t.write(e)}),e.on("end",function(){t.end()}),e.on("error",function(){t.end()})})},upload:function(e,t,n){return this.uploadForNodeJS(e,t,n)},createDummyFile:function(e,t,n){var i=W.replace(e,"/","\\").split("\\");if(0==i.length)return null;var r=i[i.length-1];if(null!=t&&(r=t),0==r.length)return null;var a=vr.getContentTypeByFileName(r,n);return{name:r,size:0|Ka.statSync(e).size,type:a,path:e}},asyncCreateThumbnail:function(e){return Promise.reject(null)},__class__:vr});var yr=function(){er.call(this,"keywordWatcher")};(n["albero.proxy.KeywordWatcherProxy"]=yr).__name__=["albero","proxy","KeywordWatcherProxy"],yr.__super__=er,yr.prototype=i(er.prototype,{onMessageCreated:function(e){if(null!=e){var t,n=at.map(at.option(this.dataStore.getTalk(e.talkId)),function(e){return e.domainId});switch(n[1]){case 0:t=n[2];break;case 1:t=this.settings.getSelectedDomainId()}if(this.features.canDetectKeyword(t)){var i;if(this.settings.getBrowserSettings().keywordWatchingSelfMessage)i=!1;else{var r=this.dataStore,a=e.userId;if(null!=r.me){var o=r.me.id;i=null!=o&&null!=a&&o.high==a.high&&o.low==a.low}else i=!1}if(!i){var s=e.messageStringForKeywordDetection(this.settings.getBrowserSettings().keywordWatchingActionReply);this.detectKeyword(s,e.type,e.id,t,e.talkId)}}}},onAnnouncementCreated:function(e){if(null!=e&&this.features.canDetectKeyword(e.domainId)){var t=Mt.getDisplayTextWithoutEscape(e.type,e.content);this.detectKeyword(t,e.type,e.id,e.domainId,null)}},detectKeyword:function(s,l,u,c,_){var h=this;this.reserveOnNormalizedKeywordPrepared(function(e){for(var t=W.htmlEscape(s,!0),n=e.keys();n.hasNext();){var i=n.next(),r=e.get(i);if(null!=r&&0!=r.length&&Tr.match(l,i))for(var a=0;a<r.length;){var o=r[a];if(++a,0!=o.search(t).length)return void h.addkeywordDetection(c,_,u)}}})},reserveOnNormalizedKeywordPrepared:function(e){var t=this.settings.getBrowserSettings().keywordWatchingText;if(this.cachedKeyword!=t){this.cachedKeyword=t,this.cachedNormalizedKeywordsMap=new ba;for(var n=0,i=Ir.__empty_constructs__;n<i.length;){var r=i[n];++n,this.cachedNormalizedKeywordsMap.set(r,[])}for(var a=0,o=Sr.parse(t);a<o.length;){var s=o[a];++a,this.cachedNormalizedKeywordsMap.get(s.type).push(new Yi(s.word,!0,Vi.normalize))}}e(this.cachedNormalizedKeywordsMap)},addkeywordDetection:function(e,t,n){null==this.detectedDomainTalkIdStrings&&(this.detectedDomainTalkIdStrings=new Ma);var i=this.getKey(e,t);if(null!=i)if(this.hasKeywordDetection(e,t)){var r=this.detectedDomainTalkIdStrings;null!=Io[i]?r.setReserved(i,n):r.h[i]=n}else{var a=this.detectedDomainTalkIdStrings;null!=Io[i]?a.setReserved(i,n):a.h[i]=n;var o=this.settings.getBrowserSettings().keywordWatchingEmphasis;this.sendNotification("keyword_detaction_updated",{domainId:e,talkId:t,detected:!0,emphasis:o})}},readKeywordDetection:function(e,t,n){if(!this.settings.getBrowserSettings().keywordWatchingEmphasis){var i,r=this.getDetectId(e,t);if(ji._d("["+tt.dateStr(new Date)+"] ","readKeywordDetection",r,n,"",""),null!=r){var a=n.high-r.high|0;a=0!=a?a:ga.ucompare(n.low,r.low),i=0<=(n.high<0?r.high<0?a:-1:0<=r.high?a:1)}else i=!1;i&&this.removeKeywordDetection(e,t)}},removeKeywordDetection:function(e,t){if(null!=this.detectedDomainTalkIdStrings){var n=this.getKey(e,t);if(null!=n){this.detectedDomainTalkIdStrings.remove(n);var i=this.settings.getBrowserSettings().keywordWatchingEmphasis;this.sendNotification("keyword_detaction_updated",{domainId:e,talkId:t,detected:!1,emphasis:i})}}},removeKeywordDetectionAll:function(){if(null!=this.detectedDomainTalkIdStrings)for(var e=this.settings.getBrowserSettings().keywordWatchingEmphasis,t=this.detectedDomainTalkIdStrings.keys();t.hasNext();){var n=t.next();if(W.startsWith(n,"talk_")){var i=n.substring("talk_".length),r=it.makeFromIdStr(i);this.sendNotification("keyword_detaction_updated",{domainId:null,talkId:r,detected:!1,emphasis:e})}else if(W.startsWith(n,"announcement_")){var a=n.substring("announcement_".length),o=it.makeFromIdStr(a);this.sendNotification("keyword_detaction_updated",{domainId:o,talkId:null,detected:!1,emphasis:e})}this.detectedDomainTalkIdStrings.remove(n)}},getDetectId:function(e,t){if(null==this.detectedDomainTalkIdStrings)return null;var n=this.getKey(e,t);if(null==n)return null;var i=this.detectedDomainTalkIdStrings;return null!=Io[n]?i.getReserved(n):i.h[n]},hasKeywordDetection:function(e,t){return null!=this.getDetectId(e,t)},getKey:function(e,t){return null==e&&null==t?null:null!=t?"talk__"+t.high+"_"+t.low:"announcement__"+e.high+"_"+e.low},__class__:yr});var Sr=function(){};(n["albero.proxy.KeywordParser"]=Sr).__name__=["albero","proxy","KeywordParser"],Sr.parse=function(e){var t=W.htmlEscape(e,!0),n=new y("&quot;(.*?)&quot;","g").map(t,function(e){return Sr.encodeSpace(e.matched(1))});return new y("[ ]","g").split(n).filter(k.isNotEmpty).map(Sr.decodeSpace).map(Sr.createParsedKeyword)},Sr.encodeSpace=function(e){return W.replace(W.replace(e," ","&SPACE"),"","&FULL_PITCH_SPACE")},Sr.decodeSpace=function(e){return W.replace(W.replace(e,"&SPACE"," "),"&FULL_PITCH_SPACE","")},Sr.createParsedKeyword=function(e){var t=new y("\\[type:([A-Za-z]+)\\](.*)","g");if(t.match(e)){var n=t.matched(1),i=t.matched(2),r=Tr.getKeywordTypeByMessageTypeString(n);if(r!=Ir.normal)return new wr(r,i)}return new wr(Ir.normal,e)};var wr=function(e,t){this.type=e,this.word=t};(n["albero.proxy.ParsedKeyword"]=wr).__name__=["albero","proxy","ParsedKeyword"],wr.prototype={__class__:wr};var Ir=n["albero.proxy.KeywordType"]={__ename__:["albero","proxy","KeywordType"],__constructs__:["normal","selectOneReplyOnly","yesOrNoReplyOnly","todoDoneOnly"]};Ir.normal=["normal",0],Ir.normal.toString=s,(Ir.normal.__enum__=Ir).selectOneReplyOnly=["selectOneReplyOnly",1],Ir.selectOneReplyOnly.toString=s,(Ir.selectOneReplyOnly.__enum__=Ir).yesOrNoReplyOnly=["yesOrNoReplyOnly",2],Ir.yesOrNoReplyOnly.toString=s,(Ir.yesOrNoReplyOnly.__enum__=Ir).todoDoneOnly=["todoDoneOnly",3],Ir.todoDoneOnly.toString=s,(Ir.todoDoneOnly.__enum__=Ir).__empty_constructs__=[Ir.normal,Ir.selectOneReplyOnly,Ir.yesOrNoReplyOnly,Ir.todoDoneOnly];var Tr=function(){};(n["albero.proxy.KeywordTypeHelper"]=Tr).__name__=["albero","proxy","KeywordTypeHelper"],Tr.getKeywordType=function(e){return null!=e?Tr.getKeywordTypeByMessageTypeString(Mt.typeString(e)):Ir.normal},Tr.getKeywordTypeByMessageTypeString=function(e){if(null!=e)switch(e){case"selectOneReply":return Ir.selectOneReplyOnly;case"todoDone":return Ir.todoDoneOnly;case"yesOrNoReply":return Ir.yesOrNoReplyOnly}return Ir.normal},Tr.match=function(e,t){switch(t[1]){case 0:return!0;case 1:return e==Rt.selectOneReply;case 2:return e==Rt.yesOrNoReply;case 3:return e==Rt.todoDone}},Tr.createFilterClassStringFromMessageType=function(e){return Tr.createFilterClassString(Tr.getKeywordType(e))},Tr.createFilterClassString=function(e){return"keyword_type_"+K.string(e)};var Er=function(){er.call(this,"lastUsedAtUpdater")};(n["albero.proxy.LastUsedAtUpdaterProxy"]=Er).__name__=["albero","proxy","LastUsedAtUpdaterProxy"],Er.__super__=er,Er.prototype=i(er.prototype,{startPolling:function(e){if(null==this.pollingTimer){var t,n=this.getLastUsedExpiredAt();if(null==n)t=0;else{var i=n.high,r=n.low;t=4294967296*i+(0<=r?r:r+4294967296)-(new Date).getTime()|0}if(t<=0)e(),this.pollingTimer=new wa(6e5),this.pollingTimer.run=e;else{var a=fo(this,this.startPolling),o=e;wa.delay(function(){a(o)},t)}}},stopPolling:function(){null!=this.pollingTimer&&(this.pollingTimer.stop(),this.pollingTimer=null)},getLastUsedExpiredAt:function(){return null!=this.lastUsedExpiredAtCache?this.lastUsedExpiredAtCache:this.settings.getLastUsedExpiredAt()},update:function(){this.lastUsedExpiredAtCache=T.afterAsInt64(6e5),this.settings.setLastUsedExpiredAt(this.lastUsedExpiredAtCache)},__class__:Er});var Nr=function(){er.call(this,"limitations")};(n["albero.proxy.LimitationsProxy"]=Nr).__name__=["albero","proxy","LimitationsProxy"],Nr.__super__=er,Nr.prototype=i(er.prototype,{getMaxTalkers:function(){var t=this,e=at.flatMap(at.flatMap(at.option(this.settings.getSelectedDomainId()),function(e){return at.option(t.dataStore.getDomain(e))}),function(e){return e.getMaxTalkers()});switch(e[1]){case 0:return e[2];case 1:return this.settings.getConfiguration().maxTalkers}},__class__:Nr});var Ar=function(){er.call(this,"messageStore")};(n["albero.proxy.MessageStoreProxy"]=Ar).__name__=["albero","proxy","MessageStoreProxy"],Ar.__super__=er,Ar.prototype=i(er.prototype,{onRegister:function(){this.messages=new Ma},getMessage:function(e){if(null==e)return Ca.None;var t="_"+e.high+"_"+e.low,n=this.messages;return at.option(null!=Io[t]?n.getReserved(t):n.h[t])},setMessage:function(e){},removeMessage:function(e){this.messages.remove("_"+e.high+"_"+e.low)},onFileDeleted:function(t){at.foreach(this.getMessage(t.messageId),function(e){e.deleteFile(t)})},onConferenceClose:function(e){at.foreach(this.getMessage(e.messageId),function(e){e.close()})},onActionStampClose:function(e){at.foreach(this.getMessage(e),function(e){e.close()})},onDeleteFavoriteMessage:function(t){var e=this.getMessage(t.getMessageId());at.foreach(e,function(e){e.updateFavorite(t)})},onAddFavoriteMessage:function(t){var e=this.getMessage(t.getMessageId());at.foreach(e,function(e){e.updateFavorite(t)}),at.isEmpty(e)&&this.setMessage(t.getMessage())},__class__:Ar});var br=function(){this.connectionStatus=v.Ok,er.call(this,"rpc"),this.responseHandlers=new Da,this.errorHandler=fo(this,this.onServerErrorWithMethod),this.connectionKeeper=new Dr(fo(this,this.ping))};(n["albero.proxy.MsgPackRpcProxy"]=br).__name__=["albero","proxy","MsgPackRpcProxy"],br.__super__=er,br.prototype=i(er.prototype,{initWebSocket:function(){null==this.ws&&(this.ws=Ji.newInstance(wo.endpoint),this.ws.onopen=fo(this,this.onOpen),this.ws.onmessage=fo(this,this.onMessage),this.ws.onclose=fo(this,this.onClose),this.ws.onpong=fo(this,this.onPong),br.pingAt=null)},finishWebSocket:function(){if(null==this.ws)return null;this.ws.onopen=null,this.ws.onmessage=null,this.ws.onerror=null,this.ws.onclose=null,this.ws.onpong=null,this.ws.close();var e=this.ws;return this.ws=null,br.pingAt=null,this.lastUsedAtUpdater.stopPolling(),e},onRegister:function(){this.initWebSocket(),this.connectionKeeper.start()},onRemove:function(){this.connectionKeeper.stop(),this.finishWebSocket()},onOpen:function(){this.connectionStatus=v.Ok,this.connectionKeeper.setConnected(!0),this.sendNotification("SignIn")},onPong:function(e){br.pingAt=null;var t="PONG "+K.string(e);ji._d("["+tt.dateStr(new Date)+"] ",t,"","","","")},onMessage:function(e){var t=this,n=new Xa(e,!0).o,i=Ga.__cast(n[0],mo);if(1==i&&4==n.length){var r=Ga.__cast(n[1],mo),a=n[2],o=n[3],s=this.responseHandlers.h[r];if(null==s)return void ji._e("["+tt.dateStr(new Date)+"] ","No ResponseHandler prepared. msgId:%s error:%s result:",r,a,o,"");var l=s.method;if(ji._d("["+tt.dateStr(new Date)+"] ","response received. method:",l," data:",n,""),null==a){var u=s.onSuccess;null!=u&&u(o)}else{var c=s.method;ji._e("["+tt.dateStr(new Date)+"] ","Receive Error Response. method:",c," error:",a,"");var _=s.onError;null!=_?_(a):null!=this.errorHandler&&this.errorHandler(s.method,a)}this.responseHandlers.remove(r)}else if(0==i&&4==n.length){var h=Ga.__cast(n[1],mo),d=Ga.__cast(n[2],String),f=Ga.__cast(n[3],Array);if(ji._d("["+tt.dateStr(new Date)+"] ","request received. method:",d,"","",""),0==f.length)return void ji._e("["+tt.dateStr(new Date)+"] ","empty params.","","","","");this.broadcast.handleNotification(d,f[0],function(){ji._d("["+tt.dateStr(new Date)+"] ","response sent. method:",d,"","",""),t.ws.send(new Za([1,h,null,!0]).o.getBytes())})}},onClose:function(e,t,n){ji._i("["+tt.dateStr(new Date)+"] ","onClose. code:"+e+", reason:"+t+", wasClean:"+(null==n?"null":""+n),"","","",""),1001==e&&n||(this.connectionStatus=1e3!=e&&1005!=e||"concurrent access"!=t?1e3!=e&&1005!=e||"forcibly closed"!=t?v.Error:v.ForcibliyClosedError:v.ConcurrentAccessError,this.connectionStatus==v.ForcibliyClosedError?this.sendNotification("SignOut"):this.sendNotification("Url",be.FORWARD(V.error))),this.finishWebSocket(),this.connectionKeeper.setConnected(!1)},restart:function(e){null==e&&(e=500);for(var t=this,n=this.finishWebSocket(),i=this.responseHandlers.keys();i.hasNext();){var r=i.next();this.responseHandlers.remove(r)}var a=null;a=function(){null==n||n.isClosed()?t.initWebSocket():wa.delay(a,100)},wa.delay(a,e)},call:function(e,t,n,i){if(null!=this.ws){null==t&&(t=[]);var r=br.lastMsgId++,a=this.responseHandlers,o=new kr(e,n,i);a.h[r]=o;var s=[0,r,e,t],l=new Za(s).o.getBytes();this.ws.send(l),ji._d("["+tt.dateStr(new Date)+"] ","send request. data:",s,"","","")}else{var u=this.data;ji._e("["+tt.dateStr(new Date)+"] ","disconnected. data:",u,"","","")}},ping:function(){switch(this.connectionStatus[1]){case 2:case 3:return}if(null==this.ws||this.ws.isClosed()){this.restart();var e="restart connection. "+br.pingAt+" "+K.string(null==this.ws||this.ws.isClosed());ji._d("["+tt.dateStr(new Date)+"] ",e,"","","","")}else if(0<br.pingAt){this.restart();var t="restart connection. "+br.pingAt+" "+K.string(null==this.ws||this.ws.isClosed());ji._d("["+tt.dateStr(new Date)+"] ",t,"","","","")}else{var n="before pingAt "+br.pingAt;ji._d("["+tt.dateStr(new Date)+"] ",n,"","","",""),this.connectionKeeper.isConnected()&&(this.ws.ping("PING"),br.pingAt=(new Date).getTime(),ji._d("["+tt.dateStr(new Date)+"] ","send ping","","","",""))}},onServerErrorWithMethod:function(e,t){this.onServerError(t)},onServerError:function(e){if(this.sendNotification("error_occurred",e),503==e.code&&"service temporarily unavailable"==e.message){var t=e.detail.retry_after;this.restart(1e3*t)}"invalid session"==e.message&&this.restart()},__class__:br});var Dr=function(e){this.connected=!1,this.ping=e};(n["albero.proxy._MsgPackRpcProxy.ConnectionKeeper"]=Dr).__name__=["albero","proxy","_MsgPackRpcProxy","ConnectionKeeper"],Dr.prototype={start:function(){},stop:function(){this.deleteTimer()},setConnected:function(e){this.connected==e&&null!=this.timer||(this.connected=e,this.resetTimer())},isConnected:function(){return this.connected},resetTimer:function(){var i=this;if(this.deleteTimer(),this.connected)this.timer=new wa(45e3),this.timer.run=this.ping;else{var r=null;(r=function(t){var n=0|Math.min(2*t,45e3);return function(){i.ping();var e=r(n);i.timer=wa.delay(e,t)}})(3e3)()}},deleteTimer:function(){null!=this.timer&&(this.timer.stop(),this.timer=null)},__class__:Dr};var kr=function(e,t,n){this.method=e,this.onSuccess=t,this.onError=n};(n["albero.proxy._MsgPackRpcProxy.ResponseHandler"]=kr).__name__=["albero","proxy","_MsgPackRpcProxy","ResponseHandler"],kr.prototype={__class__:kr};var Cr=function(e){this.code=e.code,this.message=e.message,this.detail=e.detail};(n["albero.proxy.Error"]=Cr).__name__=["albero","proxy","Error"],Cr.prototype={__class__:Cr};var Or=function(){};(n["albero.proxy.ErrorConverter"]=Or).__name__=["albero","proxy","ErrorConverter"],Or.toLocalError=function(e,t){return{code:t.code,message:t.message,detail:t.detail,localErrorType:e}};var Mr=function(){er.call(this,"readStatusUpdater"),this.updateReadStatusesTimers=new Ma,this.updateReadAnnouncementStatusesTimers=new Ma};(n["albero.proxy.ReadStatusUpdaterProxy"]=Mr).__name__=["albero","proxy","ReadStatusUpdaterProxy"],Mr.__super__=er,Mr.prototype=i(er.prototype,{updateReadStatuses:function(e,t){var a=this,n=this.dataStore.getTalkStatus(e);if(null!=n){if(null==t||this.canRegardTalkReadCountZero(n,t)){if(!xn.isUnreadMesasgeExisted(n))return;if(null==n.maxMessageId)return;n.readAll(),this.dataStore.setTalkStatus(n)}else{var i=t.filter(function(e){return xn.isUnread(n,e.id)});if(0==i.length)return;var r=i.filter(function(e){if(e.isUnreadCountTarget){var t,n=a.dataStore,i=e.userId;if(null!=n.me){var r=n.me.id;t=null!=r&&null!=i&&r.high==i.high&&r.low==i.low}else t=!1;return!t}return!1}).length;n.read(i[i.length-1].id,r),this.dataStore.setTalkStatus(n)}var o="_"+e.high+"_"+e.low,s=this.updateReadStatusesTimers,l=null!=Io[o]?s.getReserved(o):s.h[o];null!=l&&l.stop();var u=n.maxReadMessageId,c=wa.delay(function(){a.updateReadStatusesTimers.remove(o),null!=a.dataStore.getTalkStatus(e)&&a.api.updateReadStatuses(e,u)},1e3),_=this.updateReadStatusesTimers;null!=Io[o]?_.setReserved(o,c):_.h[o]=c}},updateAnnouncementReadStatus:function(e,t){var n=this,i=this.dataStore.getAnnouncementStatus(e);if(null!=i){if(null==t||this.canRegardAnnouncementReadCountZero(i,t)){if(!ct.isUnreadAnnouncementExisted(i))return;if(null==i.maxAnnouncementId)return;i.readAll(),this.dataStore.setAnnouncementStatus(i)}else{var r=t.filter(function(e){return ct.isUnread(i,e)});if(0==r.length)return;i.read(r[r.length-1],r.length),this.dataStore.setAnnouncementStatus(i)}var a="_"+e.high+"_"+e.low,o=this.updateReadAnnouncementStatusesTimers,s=null!=Io[a]?o.getReserved(a):o.h[a];null!=s&&s.stop();var l=i.maxReadAnnouncementId;s=wa.delay(function(){n.updateReadAnnouncementStatusesTimers.remove(a),n.api.updateAnnouncementReadStatus(e,l)},1e3);var u=this.updateReadAnnouncementStatusesTimers;null!=Io[a]?u.setReserved(a,s):u.h[a]=s}},canRegardTalkReadCountZero:function(e,t){return this.canRegardReadCountZero(e.maxMessageId,t.map(function(e){return e.id}))},canRegardAnnouncementReadCountZero:function(e,t){return this.canRegardReadCountZero(e.maxAnnouncementId,t)},canRegardReadCountZero:function(e,t){var n=at.orNull(rt.lastOption(t));return null!=e&&null!=n&&e.high==n.high&&e.low==n.low},__class__:Mr});var Rr=function(){er.call(this,"routing")};(n["albero.proxy.RoutingProxy"]=Rr).__name__=["albero","proxy","RoutingProxy"],Rr.__super__=er,Rr.prototype=i(er.prototype,{onRegister:function(){},init:function(){null==this.router&&(this.router=new Fr(this,this.settings,this.dataStore),this.router.start())},forward:function(e){this.init(),this.router.forward(e)},redirect:function(e,t){this.init(),this.router.redirect(e,t)},back:function(){null!=this.router&&this.router.back()},stop:function(){null!=this.router&&this.router.started&&this.router.stop()},__class__:Rr});var Fr=function(e,t,n){this.proxy=e,this.settings=t,this.dataStore=n,this.started=!1,this.urlConverterDelegate=new xr(t,n)};(n["albero.proxy._RoutingProxy.LocalRouter"]=Fr).__name__=["albero","proxy","_RoutingProxy","LocalRouter"],Fr.prototype={notify:function(e){var t=this.getDomainId(e);this.settings.setSelectedDomainId(t),this.proxy.sendNotification("current_page_changed",e)},start:function(){this.started=!0},forward:function(e){0!=e[1]&&this.notify(e)},redirect:function(e,t){},redirectWithHash:function(){},back:function(){this.notify(this.prev)},stop:function(){this.started=!1},getDomainId:function(e){switch(e[1]){case 2:return e[2];case 3:return e[2];case 4:return e[2];case 5:return e[2];case 6:return e[2];case 7:return e[2];case 11:return e[2];default:return null}},parseFragment:function(e){return M.createUrls(e,this.urlConverterDelegate)},toFragment:function(e){return M.createFragment(e,this.urlConverterDelegate)},__class__:Fr};var xr=function(e,t){this.settings=e,this.dataStore=t};(n["albero.proxy.UrlConverterDelegate"]=xr).__name__=["albero","proxy","UrlConverterDelegate"],xr.__interfaces__=[R],xr.prototype={isMultiViewMode:function(){return this.settings.isMultiViewMode()},getLastSelectedDomainId:function(){return at.option(this.settings.getLastSelectedDomainId())},getFallbackDomainId:function(){var e;switch(at.flatMap(this.getLastSelectedDomainId(),fo(this,this.getDomain))[1]){case 0:e=at.flatMap(this.getLastSelectedDomainId(),fo(this,this.getDomain));break;case 1:e=this.getOldestDomain()}return at.map(e,function(e){return e.id})},getDomain:function(e){return at.option(this.dataStore.getDomain(e))},getOldestDomain:function(){return new mt(this.dataStore.getDomains()).getOldestDomain()},__class__:xr};var Ur=function(){er.call(this,"searchService")};(n["albero.proxy.SearchServiceProxy"]=Ur).__name__=["albero","proxy","SearchServiceProxy"],Ur.__super__=er,Ur.prototype=i(er.prototype,{isSearching:function(){return this.searching},clearSearching:function(){this.searching=!1},isRecentParams:function(e){return null!=this.recentParams&&null!=e&&this.recentParams.eq(e)},clearRecentParams:function(){this.recentParams=null},clearEditingParams:function(){this.editingParams=null},saveParams:function(e){this.editingParams=e,this.recentParams=e.copy()},updateTalkIdParam:function(e){this.assureParams(),this.editingParams.talkId=e},updateSearchTypeParam:function(e){this.assureParams(),this.editingParams.searchType=e},updateFromUserIdParam:function(e){this.assureParams(),this.editingParams.fromUserId=e},updateKeywordParam:function(e){this.assureParams(),this.editingParams.keyword=e},updateDomainIdParam:function(e){this.assureParams(),this.editingParams.domainId=e},updateSinceTextParam:function(e){this.assureParams(),this.editingParams.sinceText=e},updateUntilTextParam:function(e){this.assureParams(),this.editingParams.untilText=e},assureParams:function(){if(null==this.editingParams){var e=this.settings.getSelectedDomainId(),t={domain_id_str:"_"+e.high+"_"+e.low};this.editingParams=new an(t)}},prepareForSearching:function(e,t){this.searching=!0,null==t&&this.sendNotification("notify_search_prepare",{searching:!0,params:e})},notifySearchMessagesFail:function(){this.searching=!1,this.sendNotification("notify_search_messages_fail",{})},notifySearchAttachmentsFail:function(){this.searching=!1,this.sendNotification("notify_search_attachments_fail",{})},saveSearchMessagesResult:function(e){null==this.contextMap&&(this.contextMap=new Ma),this.messagesNextMarker=e.nextMarker,null==e.marker&&(this.hitMessageIdSet=new Ma);for(var t=0,n=e.contents;t<n.length;){var i=n[t];++t;var r=i.messages[0].id,a="_"+r.high+"_"+r.low,o=this.contextMap;null!=Io[a]?o.setReserved(a,i):o.h[a]=i,this.hitMessageIdSet=nt.fold(i.messages,function(e,t){if(e.hit){var n=e.id,i="_"+n.high+"_"+n.low;null!=Io[i]?t.setReserved(i,1):t.h[i]=1}return t},this.hitMessageIdSet)}this.searching=!1,this.sendNotification("notify_search_messages",e)},saveSearchAttachmentsResult:function(e){null==this.attachmentsMap&&(this.attachmentsMap=new Ma),this.attachmentsNextMarker=e.nextMarker;for(var t=0,n=e.contents;t<n.length;){var i=n[t];++t;var r=i.attachmentId,a="_"+r.high+"_"+r.low,o=this.attachmentsMap;null!=Io[a]?o.setReserved(a,i):o.h[a]=i}this.searching=!1,this.sendNotification("notify_search_attachments",e)},getHitContext:function(e){var t=this.contextMap;return null!=Io[e]?t.getReserved(e):t.h[e]},getFileInfo:function(e){var t=this.attachmentsMap;return null!=Io[e]?t.getReserved(e):t.h[e]},isHitMessage:function(e){var t="_"+e.high+"_"+e.low,n=this.hitMessageIdSet;return null!=Io[t]?n.existsReserved(t):n.h.hasOwnProperty(t)},reserveOnNormalizedKeywordPrepared:function(e){var t=this;if(null!=this.recentParams&&null!=this.recentParams.keyword){var n=null==this.recentParams?"":this.recentParams.keyword;if(this.cachedKeyword!=n){this.cachedKeyword=n,null==this.cachedNormalizedKeywords?this.cachedNormalizedKeywords=[]:this.cachedNormalizedKeywords.splice(0,this.cachedNormalizedKeywords.length);var i=new y("[ ]","g").split(W.htmlEscape(n,!0));nt.iter(i.filter(k.isNotEmpty),function(e){t.cachedNormalizedKeywords.push(new Yi(e,!0,Vi.normalize))})}e(this.cachedNormalizedKeywords)}},__class__:Ur});var Pr=function(){er.call(this,"session"),this.createSessionCount=0};(n["albero.proxy.SessionProxy"]=Pr).__name__=["albero","proxy","SessionProxy"],Pr.__super__=er,Pr.prototype=i(er.prototype,{start:function(e){this.api.createSession(e,fo(this,this.onSessionCreated))},onSessionCreated:function(e){var t,n=this;if(e.notification){var i=this.dataStore,r=e.user.id;if(null!=i.me){var a=i.me.id;t=null!=a&&null!=r&&a.high==r.high&&a.low==r.low}else t=!1}else t=!1;var o=this.dataStore,s=e.user;o.me=s;for(var l=0,u=o.getDomains();l<u.length;){var c=u[l];++l,o.sendNotification("notify_update_user",o.me.toDomainUser(c.id))}o.sendNotification("current_user_changed",s),o.storage.setDirtyFlag(),this.settings.setConfiguration(e.configuration),this.settings.setDeviceId(e.device.device_id),this.sendNotification("data_recovering"),Promise.all([Hi.asyncPrepare(),Vi.asyncAssureNormalize()]).then(function(e){t?n.prepareNecessaryDataFromCache():(n.dataStore.clear(!1),n.prepareNecessaryDataFromServer()),n.createSessionCount++})},prepareNecessaryDataFromServer:function(){var a=this;this.api.resetNotification(function(e){function r(){4==(t+=1)&&a.api.getAllUserIdentifiers(fo(a,a.onNecessaryDataPrepared))}var t=0;a.api.getDomains(function(){var e=a.dataStore.getDomains(),t=0;0<e.length?a.api.getAnnouncementStatuses(function(){(t+=1)==e.length&&r()}):r();function n(){2==(i+=1)&&a.api.getTalks(r)}var i=0;a.api.getFriends(n),a.api.getAcquaintances(n)}),a.api.getAccountControlRequests(function(){a.api.getDomainInvites(r)}),a.api.getJoinedAccountControlGroup(r)})},prepareNecessaryDataFromCache:function(){var e=rt.sortAndReturn(this.dataStore.getDomains(),function(e,t){var n=t.id,i=e.id,r=n.high-i.high|0;return r=0!=r?r:ga.ucompare(n.low,i.low),n.high<0?i.high<0?r:-1:0<=i.high?r:1});this.api.sendDomainNotifications(e);for(var t=0;t<e.length;){var n=e[t];++t;var i=this.dataStore.getAnnouncementStatus(n.id);null==i&&(i=this.dataFactory.newAnnouncementStatusForDomain(n.id)),this.api.sendAnnouncementStatusNotification(i);for(var r=0,a=this.dataStore.getFriends(n.id);r<a.length;){var o=a[r];++r,this.sendNotification("notify_add_friend",o)}for(var s=0,l=this.dataStore.getAcquaintances(n.id);s<l.length;){var u=l[s];++s,this.sendNotification("notify_add_acquaintance",u)}}this.api.sendTalkNotifications(this.dataStore.getTalks()),this.api.sendTalkStatusNotifications(this.dataStore.getTalkStatuses());for(var c=0,_=this.dataStore.getDomainInvites();c<_.length;){var h=_[c];++c,this.sendNotification("notify_add_domain_invite",h)}for(var d=0,f=this.dataStore.getAccountControlRequests();d<f.length;){var m=f[d];++d,this.sendNotification("notify_add_account_control_request",m)}var p=this.dataStore.getAccountControlGroup();null!=p&&this.sendNotification("notify_join_account_control_group",p),this.onNecessaryDataPrepared()},onNecessaryDataPrepared:function(){var e=this.settings.getConfiguration().botExpiredVersion;if(ji._d("["+tt.dateStr(new Date)+"] ","bot_expired_version",e,"","",""),null!=e){var t=require("../../package.json").version;if(ji._d("["+tt.dateStr(new Date)+"] ","current",t,"","",""),null!=t){var n=e.split("."),i=t.split(".");3==n.length&&3==i.length&&0<=1e4*(parseFloat(n[0])-parseFloat(i[0]))+100*(parseFloat(n[1])-parseFloat(i[1]))+(parseFloat(n[2])-parseFloat(i[2]))&&process.stderr.write("-----------------------------------------\nCurrent version is expired! (current: "+t+")\nRun 'npm install direct-js' to update\n-----------------------------------------\n")}}this.sendNotification("data_recovered"),this.api.startNotification(),this.api.startUpdateLastUsedAtIfNeed(),this.api.getConferences()},__class__:Pr});var Lr=function(){this.deviceId=null,this.selectedDomainIdOnTalkSelectionChanged=null,this.selectedDomainId=null,this.remember=!0,er.call(this,"settings")};(n["albero.proxy.SettingsProxy"]=Lr).__name__=["albero","proxy","SettingsProxy"],Lr.__interfaces__=[Cn],Lr.__super__=er,Lr.prototype=i(er.prototype,{onRegister:function(){this.loadBrowserSettings()},getValidHost:function(){return"https://"+wo.host},setAccessTokenRemember:function(e){this.remember=e},setAccessToken:function(e){this.remember&&(this.accessToken=e,this.sendNotification("access_token_changed",e))},getAccessToken:function(){return null==this.accessToken&&(this.accessToken=wo.accessToken),this.accessToken},clearAccessToken:function(){this.accessToken=null},getOs:function(){return"bot"},getIDFV:function(){var e=D.getItem("idfv");return null!=e&&""!=e||(e=k.randomString(),D.setItem("idfv",e)),e},setConfiguration:function(e){this.configuration=e,this.sendNotification("configuration_changed",e)},getConfiguration:function(){return this.configuration},setDeviceId:function(e){this.deviceId=e},getDeviceId:function(){return this.deviceId},setSelectedDomainId:function(e){var t=this.selectedDomainId;null!=t&&null!=e&&t.high==e.high&&t.low==e.low||(null!=e?(D.setItem("selected_domain_id_h",K.string(e.high)),D.setItem("selected_domain_id_l",K.string(e.low))):(D.removeItem("selected_domain_id_h"),D.removeItem("selected_domain_id_l")),this.selectedDomainId=e,this.sendNotification("domain_selection_changed",e))},getLastSelectedDomainId:function(){var e,t=D.getItemAsInt("selected_domain_id_h"),n=D.getItemAsInt("selected_domain_id_l");null!=t&&null!=n?e=new zn(t,n):e=null;return e},getSelectedDomainId:function(){return this.selectedDomainId},getSelectedDomainIdOnTalkSelectionChanged:function(){return this.selectedDomainIdOnTalkSelectionChanged},clearDomainSelection:function(){this.selectedDomainId=null,D.removeItem("selected_domain_id_h"),D.removeItem("selected_domain_id_l")},clearSelectedTalk:function(e){null==e&&(e=Bt.SingleTalkPane);var t=this.selectedDomainId;this.assureTalkSelectionMap("_"+t.high+"_"+t.low).remove(e),this.selectedDomainIdOnTalkSelectionChanged=this.selectedDomainId,this.sendNotification("talk_selection_changed",new kn(e,Mn.NotSelected))},selectTalk:function(e,t,n,i){var r="_"+t.high+"_"+t.low;if(null==r)return!1;var a=this.assureTalkSelectionMap(r),o=Mn.TalkSelected(n,i);a.set(e,o);var s=this.selectedDomainId;return null!=t&&null!=s&&t.high==s.high&&t.low==s.low&&(this.selectedDomainIdOnTalkSelectionChanged=this.selectedDomainId,this.sendNotification("talk_selection_changed",new kn(e,o)),!0)},selectAnnouncement:function(e){if(null==this.selectedDomainId)return!1;var t=this.selectedDomainId,n="_"+t.high+"_"+t.low;return this.assureTalkSelectionMap(n).set(e,Mn.AnnouncementsSelected),this.selectedDomainIdOnTalkSelectionChanged=this.selectedDomainId,this.sendNotification("talk_selection_changed",new kn(e,Mn.AnnouncementsSelected)),!0},hasSelectedTalkOrAnnouncements:function(e){null==e&&(e=Bt.SingleTalkPane);var t=this.getTalkSelectionMap(this.selectedDomainId);return null!=t&&t.get(e)!=Mn.NotSelected},hasSelectedTalk:function(e){null==e&&(e=Bt.SingleTalkPane);var t=this.getTalkSelectionMap(this.selectedDomainId);if(null==t)return!1;var n=t.get(e);return null!=n&&0!=n[1]},getTalkSelectionMap:function(e){if(null==this.paneTalkSelections)return null;if(null==e)return null;var t="_"+e.high+"_"+e.low,n=this.paneTalkSelections;return null!=Io[t]?n.getReserved(t):n.h[t]},assureTalkSelectionMap:function(e){null==this.paneTalkSelections&&(this.paneTalkSelections=new Ma);var t=this.paneTalkSelections,n=null!=Io[e]?t.getReserved(e):t.h[e];if(null==n){n=new ba;var i=this.paneTalkSelections;null!=Io[e]?i.setReserved(e,n):i.h[e]=n}return n},getSelectedTalkId:function(){var e=this.getTalkSelection(this.selectedDomainId,Bt.SingleTalkPane);if(1!=e[1])return null;e[3];return e[2]},isSelectedTalkOrAnnouncements:function(e,t){return Rn.isSelected(this.getTalkSelection(this.selectedDomainId,e),t)},getTalkSelection:function(e,t){if(null==this.paneTalkSelections)return Mn.NotSelected;var n=this.getTalkSelectionMap(e);if(null==n)return Mn.NotSelected;var i=n.get(t);return null==i?Mn.NotSelected:i},isSendByEnter:function(){return null==this.sendByEnter&&(this.sendByEnter=!0),this.sendByEnter},setSendByEnter:function(e){e!=this.sendByEnter&&(this.sendByEnter=e,this.sendNotification("send_by_enter_changed",e))},setSelectedStampsetType:function(e){D.setItem("selected_stamp_tab_id",e.toTabId())},getSelectedStampsetType:function(){return In.fromTabId(D.getItem("selected_stamp_tab_id"))},clearSelectedStampsetType:function(){D.removeItem("selected_stamp_tab_id")},setInputTextForTalkId:function(e,t){null==e||0==e.length?this.clearInputTextForTalkId(t):(this.loadInputTextForAll(),this.inputTexts["_"+t.high+"_"+t.low]=e)},getInputTextForTalkId:function(e){this.loadInputTextForAll();var t=this.inputTexts["_"+e.high+"_"+e.low];return null!=t?t:""},clearInputTextForTalkId:function(e){this.loadInputTextForAll(),delete this.inputTexts["_"+e.high+"_"+e.low]},loadInputTextForAll:function(){null==this.inputTexts&&(this.inputTexts=D.getItemAsJson("input_text"),null==this.inputTexts&&(this.inputTexts={}))},saveInputTextForAll:function(){if(null!=this.inputTexts){var e=JSON.stringify(this.inputTexts);D.setItem("input_text",e)}},clearInputTextForAll:function(){D.removeItem("input_text"),this.inputTexts=null},setCopyProfileToAllDomains:function(e){e?D.setItem("copy_profile_to_all_domains","true"):D.removeItem("copy_profile_to_all_domains")},isCopyProfileToAllDomains:function(){return null!=D.getItem("copy_profile_to_all_domains")},setSearchHistoriesForSelectedDomain:function(e){if(null!=this.selectedDomainId){if(this.loadSearchHistoryForAll(),null==e){var t=this.selectedDomainId;delete this.searchHistories["_"+t.high+"_"+t.low]}else{var n=this.selectedDomainId;this.searchHistories["_"+n.high+"_"+n.low]=e}this.saveSearchHistoryForAll()}},getSearchHistoriesForSelectedDomain:function(){if(null==this.selectedDomainId)return null;this.loadSearchHistoryForAll();var e=this.selectedDomainId;return this.searchHistories["_"+e.high+"_"+e.low]},loadSearchHistoryForAll:function(){null==this.searchHistories&&(this.searchHistories=D.getItemAsJson("search_histories"),null==this.searchHistories&&(this.searchHistories={}))},saveSearchHistoryForAll:function(){if(null!=this.searchHistories){var e=JSON.stringify(this.searchHistories);D.setItem("search_histories",e)}},setSelectedDepartmentId:function(e,t){if(null!=e){if(this.loadSelectedDepartmentIdsForAll(),null==t)this.selectedDepartmentIds.remove("_"+e.high+"_"+e.low);else{var n="_"+e.high+"_"+e.low,i=this.selectedDepartmentIds;null!=Io[n]?i.setReserved(n,t):i.h[n]=t}this.saveSelectedDepartmentIdsForAll()}},getSelectedDepartmentId:function(e){if(null==e)return null;this.loadSelectedDepartmentIdsForAll();var t="_"+e.high+"_"+e.low,n=this.selectedDepartmentIds;return null!=Io[t]?n.getReserved(t):n.h[t]},loadSelectedDepartmentIdsForAll:function(){null==this.selectedDepartmentIds&&(this.selectedDepartmentIds=D.getItemWithUnserialize("selected_department_ids"),null==this.selectedDepartmentIds&&(this.selectedDepartmentIds=new Ma))},saveSelectedDepartmentIdsForAll:function(){null!=this.selectedDepartmentIds&&D.setItemWithSerialize("selected_department_ids",this.selectedDepartmentIds)},setRightPanelOpened:function(e){e?D.removeItem("right_panel_opened"):D.setItem("right_panel_opened","false")},isRightPanelOpened:function(){return null==D.getItem("right_panel_opened")},setMultiViewMode:function(e){e?D.setItem("multi_view_mode","true"):D.removeItem("multi_view_mode")},isMultiViewMode:function(){return null!=D.getItem("multi_view_mode")},setPasswordWarningSkipUntil:function(e){null==e?D.removeItem("password_warning_skip_until"):D.setItem("password_warning_skip_until","_"+e.high+"_"+e.low)},getPasswordWarningSkipUntil:function(){var e=D.getItem("password_warning_skip_until");return null==e?null:it.makeFromIdStr(e)},setLastUsedExpiredAt:function(e){null==e?D.removeItem("last_used_expired_at"):D.setItem("last_used_expired_at","_"+e.high+"_"+e.low)},getLastUsedExpiredAt:function(){var e=D.getItem("last_used_expired_at");return null==e?null:it.makeFromIdStr(e)},setOnPremise:function(e){this.onPremises=e},isOnPremises:function(){return this.onPremises},getBrowserSettings:function(){return this.browserSettings},applyNotificationSettings:function(e){return e.copyNotificationSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyKeywordWatchingSettings:function(e){return e.copyKeywordSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyTalkSettings:function(e){return e.copyTalkSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyUserDataSettings:function(e){return e.copyUserDataContainerTo(this.browserSettings),this.saveBrowserSettings()},applyLanguageSettings:function(e){return e.copyLanguageSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyConferenceSettings:function(e){return e.copyConferenceSettingsTo(this.browserSettings),this.saveBrowserSettings()},loadBrowserSettings:function(){this.browserSettings=Fe.fromJson(D.getItemAsJson(Fe.NAME))},saveBrowserSettings:function(){var e=D.getItemAsJson(Fe.NAME);return null==e&&(e={}),this.browserSettings.copyTo(e),D.setItem(Fe.NAME,JSON.stringify(e))},__class__:Lr});var Br=function(){er.call(this,"solutionsStore")};(n["albero.proxy.SolutionsStoreProxy"]=Br).__name__=["albero","proxy","SolutionsStoreProxy"],Br.__super__=er,Br.prototype=i(er.prototype,{getSolutions:function(e){var t=this;return null==this.solutionsMap?[]:this.getSolutionIds(e).map(function(e){return t.solutionsMap.h[e]}).filter(function(e){return null!=e})},getSolution:function(e){return null==this.solutionsMap?null:this.solutionsMap.h[e]},getSolutionIds:function(e){return null==e?[]:null==e.contract?[]:null==e.contract.solutionIds?[]:e.contract.solutionIds},getSolutionIdsNotLoaded:function(e){var t=this;return this.getSolutionIds(e).filter(function(e){return null==t.solutionsMap||!t.solutionsMap.h.hasOwnProperty(e)})},setSolution:function(e){null==this.solutionsMap&&(this.solutionsMap=new Da),this.solutionsMap.h[e.solutionId]=e},__class__:Br});var Hr=function(){er.call(this,"stampsStore"),this.stampsetStore=new Ma,this.stampStore=new Ma};(n["albero.proxy.StampsStoreProxy"]=Hr).__name__=["albero","proxy","StampsStoreProxy"],Hr.__super__=er,Hr.prototype=i(er.prototype,{addStampsets:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.addStampset(n)}},addStampset:function(e){var t=this.stampsetStore,n=e.toTabId(),i=t;null!=Io[n]?i.setReserved(n,e):i.h[n]=e;for(var r=0,a=e.getStamps();r<a.length;){var o=a[r];++r;var s=this.stampStore,l=o.getKey(),u=s;null!=Io[l]?u.setReserved(l,o):u.h[l]=o}},updateStampsetInfo:function(e){var t=e.toTabId(),n=this.stampsetStore,i=null!=Io[t]?n.getReserved(t):n.h[t];if(null!=i&&i.isOlderThan(e)){this.stampsetStore.remove(t);for(var r=0,a=i.getStamps();r<a.length;){var o=a[r];++r,this.stampStore.remove(o.getKey())}}},removeStampsetInfo:function(e){var t=va.toString(e),n=this.stampsetStore,i=null!=Io[t]?n.getReserved(t):n.h[t];if(null!=i){this.stampsetStore.remove(t);for(var r=0,a=i.getStamps();r<a.length;){var o=a[r];++r,this.stampStore.remove(o.getKey())}}},addStampsetInfos:function(e){var a=this;nt.iter(e,function(e){var t=a.stampsetStore,n=e.toTabId(),i=t;if(null!=Io[n]?!i.existsReserved(n):!i.h.hasOwnProperty(n)){var r=vn.fromStampsetInfo(e);a.addStampset(r)}})},getStampsetByStampsetId:function(e){return this.getStampsetByTabId("_"+e.high+"_"+e.low)},getStampsetsByTabIds:function(e){return e.map(fo(this,this.getStampsetByTabId)).filter(function(e){return null!=e})},getStampsetByTabId:function(e){var t=this.stampsetStore;return null!=Io[e]?t.getReserved(e):t.h[e]},getStampByStampKey:function(e){var t=this.stampStore;return null!=Io[e]?t.getReserved(e):t.h[e]},getOriginalStamp:function(e){var t=this.getStampByStampKey(gn.createKey(e));return null==t?null:Ga.__cast(t,gn)},applyHistories:function(r,e){var t=e.map(function(e){var t=pn.fromJson(e);if(null!=t)return t;var n=gn.fromJson(e);if(null!=n){var i=Ga.__cast(n,gn);if(null!=r&&r.stampsetSetting.containSendableStampset(i.stampsetId))return n}return ji._d("["+tt.dateStr(new Date)+"] ","A history stamp is disabled.",e,r,"",""),null}).filter(function(e){return null!=e}),n=vn.historyStampset();n.setStamps(t),this.addStampset(n)},__class__:Hr});var jr=function(){er.call(this,"talksService")};(n["albero.proxy.TalksServiceProxy"]=jr).__name__=["albero","proxy","TalksServiceProxy"],jr.__super__=er,jr.prototype=i(er.prototype,{getDomainTalksOrderedByTimestamp:function(e){return rt.sortAndReturn(this.getDomainTalks(e).map(fo(this,this.createTalkPack)),Dn.compareTalkOrderingTimestamp).map(fo(this,this.getTalkFromTalkPack))},getDomainTalksCount:function(e){return this.getDomainTalks(e).length},hasConference:function(e){return null!=e&&this.conferenceStore.hasConference(e.id)},isFavoriteTalk:function(e){var t=this.dataStore.getTalkStatus(e.id);return null!=t&&null!=t.orderInFavorites},getTalkFromTalkPack:function(e){return e.talk},getTalkIdFromTalk:function(e){return e.id},getDomainTalks:function(n){return null==n?[]:this.dataStore.getTalks().filter(function(e){var t=e.domainId;return null!=t&&null!=n&&t.high==n.high&&t.low==n.low})},createTalkPack:function(e){return new Dn(e,this.dataStore.getTalkStatus(e.id))},__class__:jr});var Yr=function(){er.call(this,"ThumbnailExpansion")};(n["albero.proxy.ThumbnailExpansionProxy"]=Yr).__name__=["albero","proxy","ThumbnailExpansionProxy"],Yr.__super__=er,Yr.prototype=i(er.prototype,{onRegister:function(){var e=this;wa.delay(function(){e.workingBrowserSettings=e.settings.getBrowserSettings().createCopy()},0)},updateThumbnailExpansionEnabled:function(e){if(null!=this.workingBrowserSettings){var t=this.dataStore.me;if(null!=t){var n=t.id;this.workingBrowserSettings.setThumbnailExpansionEnabled("_"+n.high+"_"+n.low,e),this.settings.applyUserDataSettings(this.workingBrowserSettings)}}},isThumbnailExpansionEnabled:function(){if(null==this.workingBrowserSettings)return!1;var e=this.dataStore.me;if(null==e)return!1;var t=e.id;return this.workingBrowserSettings.isThumbnailExpansionEnabled("_"+t.high+"_"+t.low)},__class__:Yr});var zr=function(){er.call(this,"userPresences")};(n["albero.proxy.UserPresencesProxy"]=zr).__name__=["albero","proxy","UserPresencesProxy"],zr.__super__=er,zr.prototype=i(er.prototype,{getUserPresenceState:function(e,t){var n=at.map(this.getUserPresence(e),function(e){return e.toState(t)});switch(n[1]){case 0:return n[2];case 1:return Kn.GT_60}},getUserPresence:function(e){return at.option(this.dataStore.getUserPresence(e))},getLastUsedAtString:function(e){var t=at.map(at.flatMap(this.getUserPresence(e),function(e){return e.lastUsedAtOpt}),function(e){return T.datetimeString(e)});switch(t[1]){case 0:return t[2];case 1:return" - "}},__class__:zr});var Gr=n["albero_cli.UpdateNoteAttachment"]={__ename__:["albero_cli","UpdateNoteAttachment"],__constructs__:["LocalFileAttachment","RemoteFileAttachment"]};Gr.LocalFileAttachment=function(e){var t=["LocalFileAttachment",0,e];return t.__enum__=Gr,t.toString=s,t},Gr.RemoteFileAttachment=function(e){var t=["RemoteFileAttachment",1,e];return t.__enum__=Gr,t.toString=s,t},Gr.__empty_constructs__=[];function Kr(){}(n["albero_cli.INotes"]=Kr).__name__=["albero_cli","INotes"],Kr.prototype={__class__:Kr};var Wr=function(e,t){this.delegate=e;var n=null!=t?t:{max:24,interval:12e4};this.ratelimit=new _(n.max,n.interval)};(n["albero_cli.LimitedNotes"]=Wr).__name__=["albero_cli","LimitedNotes"],Wr.__interfaces__=[Kr],Wr.prototype={limit:function(e){return this.ratelimit.apply(e)},get:function(e){var t=this;return this.limit(function(){return t.delegate.get(e)})},update:function(e,t){var n=this;return this.limit(function(){return n.delegate.update(e,t)})},delete:function(e){var t=this;return this.limit(function(){return t.delegate.delete(e)})},__class__:Wr};var Vr=function(e,t,n,i){this.utils=e,this.api=t,this.fileInfoStore=n,this.fileService=i};(n["albero_cli.Notes"]=Vr).__name__=["albero_cli","Notes"],Vr.__interfaces__=[Kr],Vr.all=function(e,t){return nt.foreach(e,t)},Vr.isValidAsAttachment=function(e){return Vr.isStringNullOrEmpty(e.url)?!Vr.isStringNullOrEmpty(e.path):!Vr.isStringNullOrEmpty(e.id)&&!Vr.isStringNullOrEmpty(e.name)&&null!=e.content_size&&!Vr.isStringNullOrEmpty(e.content_type)},Vr.isStringNullOrEmpty=function(e){return null==e||0==e.length},Vr.prototype={toNoteId:function(e){return new Si(this.utils.parseInt64(e.id))},handleResponse:function(r,a,o){return function(e,t){if(null!=e){var n=_a.of(e);a(n)}else{var i=o(t);r(i)}}},get:function(e){var r=this,a=this.toNoteId(e);return new Promise(function(e,t){var n=r.api,i=r.handleResponse(e,t,fa.of);n.getNote(a,i)})},update:function(e,t){var a=this,n=e.talkId_i64,o=new Si(e.id_i64),i=this.validateUpdateNoteInput(t);switch(i[1]){case 0:var r=i[2];return Promise.reject(r);case 1:var s=i[2],l=this.mergeNoteObject(e,s),u=this.createNoteLocalEdit(n,o,l,null);return new Promise(function(e,t){var n=a.api,i=l.currentRevision,r=a.handleResponse(e,t,ma.of);n.updateNoteV2(o,i,u,!0,r)})}},validateUpdateNoteInput:function(e){if(null!=e.note_title){if("string"!=typeof e.note_title)return Aa.Left(_a.createInvalidParameterError("note_title is not String"));if(0==e.note_title.length)return Aa.Left(_a.createInvalidParameterError("note_title is empty"))}if(null!=e.note_content){if("string"!=typeof e.note_content)return Aa.Left(_a.createInvalidParameterError("note_content is not String"));if(0==e.note_content.length)return Aa.Left(_a.createInvalidParameterError("note_content is empty"))}var t=null;if(null!=e.note_attachments){if(!(e.note_attachments instanceof Array&&null==e.note_attachments.__enum__&&Vr.all(e.note_attachments,Vr.isValidAsAttachment))){var n="note_attachments is invalid: "+JSON.stringify(e.note_attachments);return Aa.Left(_a.createInvalidParameterError(n))}t=this.toUpdateNoteAttachmentArray(e.note_attachments)}return Aa.Right({title:e.note_title,content:e.note_content,attachments:t})},mergeNoteObject:function(e,t){var n={title:e.noteRevision.title,content:e.noteRevision.contentText,attachments:this.toUpdateNoteAttachmentArray(e.get_attachments()),currentRevision:e.noteRevision.revision};return null!=t.title&&(n.title=t.title),null!=t.content&&(n.content=t.content),null!=t.attachments&&(n.attachments=t.attachments),n},toUpdateNoteAttachmentArray:function(e){var n=fo(_o=this.utils,_o.parseInt64);return nt.array(nt.map(e,function(e){if(Vr.isStringNullOrEmpty(e.url))return Gr.LocalFileAttachment(e);var t=null==e?null:JSON.parse(JSON.stringify(e));return t.id=n(e.id),Gr.RemoteFileAttachment(t)}))},createNoteLocalEdit:function(e,t,n,i){var r=this.createNoteAttachmentFileInfoList(n.attachments);return new wi(e,t,n.title,n.content,r,i)},createNoteAttachmentFileInfoList:function(e){for(var t=[],n=0;n<e.length;){var i=e[n];++n;var r=null;switch(i[1]){case 0:var a=i[2],o=this.fileService.createDummyFile(a.path,a.name,a.type);r=this.fileInfoStore.createStagedFileInfoFromDummyFile(null,o,null);break;case 1:var s=i[2];r=this.fileInfoStore.createUploadedFileInfo(s)}t.push(r)}return t},delete:function(e){var r=this,a=this.toNoteId(e);return new Promise(function(e,t){var n=r.api,i=r.handleResponse(e,t,da.of);n.deleteNote(a,i)})},__class__:Vr};function qr(e,t){this.updatedAt=e.updatedAt,this.domainInfo=e.domainInfo,this.contract=e.contract,this.profileDefinition=e.profileDefinition,this.setting=e.setting,this.role=e.role,this.closed=e.closed,this.id=e.id,null!=t&&(this.talks=t)}(n["albero_cli.entity.Domain"]=qr).__name__=["albero_cli","entity","Domain"],qr.create=function(e,t){return new qr(e,t)},qr.prototype={toCompatibleData:function(){var e=JSON.parse(JSON.stringify(this));e.id_i64=this.id;var t=this.id;return e.id="_"+t.high+"_"+t.low,e.talks=this.talks,e},__class__:qr};function Qr(e){this.status=e.status,this.displayName=e.displayName,this.canonicalDisplayName=e.canonicalDisplayName,this.phoneticDisplayName=e.phoneticDisplayName,this.canonicalPhoneticDisplayName=e.canonicalPhoneticDisplayName,this.profileImageUrl=e.profileImageUrl,this.updatedAt=e.updatedAt,this.id=e.id}(n["albero_cli.entity.User"]=Qr).__name__=["albero_cli","entity","User"],Qr.of=function(e){return new Qr(e)},Qr.prototype={toCompatibleData:function(){var e=JSON.parse(JSON.stringify(this));e.id_i64=this.id;var t=this.id;return e.id="_"+t.high+"_"+t.low,e.name=this.displayName,e.profile_url=this.profileImageUrl,e},__class__:Qr};function Jr(e){Qr.call(this,e),this.domainId=e.domainId,this.profileContact=this.convertProfileContact(e.profileContact),this.departments=e.departments,this.email=e.email,this.subEmail=e.subEmail,this.groupAlias=e.groupAlias,this.signinId=e.signinId}(n["albero_cli.entity.DomainUser"]=Jr).__name__=["albero_cli","entity","DomainUser"],Jr.of=function(e){return new Jr(e)},Jr.__super__=Qr,Jr.prototype=i(Qr.prototype,{convertProfileContact:function(e){return null==e?null:e.map(function(e){return Zr.of(e)})},__class__:Jr});function Xr(e){Qr.call(this,e),this.email=e.email,this.signinId=e.signinId,this.profiles=e.profiles,this.departments=e.departments}(n["albero_cli.entity.Me"]=Xr).__name__=["albero_cli","entity","Me"],Xr.of=function(e){return new Xr(e)},Xr.__super__=Qr,Xr.prototype=i(Qr.prototype,{__class__:Xr});var Zr=function(e){this.profileItemId=e.profileItemId,this.value=e.value,this.canonicalValue=e.canonicalValue};(n["albero_cli.entity.ProfileItemValue"]=Zr).__name__=["albero_cli","entity","ProfileItemValue"],Zr.of=function(e){return new Zr(e)},Zr.prototype={__class__:Zr};function $r(e){var t=e.id;this.id="_"+t.high+"_"+t.low,this.id_i64=e.id,this.name=e.name,this.content_type=e.contentType,this.content_size=e.contentSize,this.url=e.url}(n["albero_cli.entity.RemoteFileInfo"]=$r).__name__=["albero_cli","entity","RemoteFileInfo"],$r.of=function(e){return new $r(e)},$r.prototype={__class__:$r};function ea(e,t,n){this.name=e.name,this.iconUrl=e.iconUrl,this.updatedAt=e.updatedAt,this.leftUsers=e.leftUsers,this.groupTalkSettings=e.groupTalkSettings,this.id=e.id,this.type=e.type,this.userIds=e.userIds,this.users=t,this.domain=n,this.domainId=e.domainId}(n["albero_cli.entity.Talk"]=ea).__name__=["albero_cli","entity","Talk"],ea.talkType=function(e){switch(e[1]){case 1:return 1;case 2:return 2;default:return 0}},ea.create=function(e,t,n){return new ea(e,t,n)},ea.prototype={toCompatibleData:function(){var e=JSON.parse(JSON.stringify(this));e.id_i64=this.id;var t=this.id;e.id="_"+t.high+"_"+t.low,e.topic=this.name,e.type=ea.talkType(this.type),e.userIds=this.userIds,e.users=this.users,e.domain=this.domain,e.domainId_i64=this.domainId;var n=this.domainId;return e.domainId="_"+n.high+"_"+n.low,e},__class__:ea};function ta(e){this.id=e.noteId.toString(),this.id_i64=e.noteId.value;var t=e.talkId;this.talkId="_"+t.high+"_"+t.low,this.talkId_i64=e.talkId,this.createdBy=e.createdBy,this.createdAt=e.createdAt,this.noteRevision=na.of(e.noteRevision),Object.defineProperty(this,"attachments",{get:this.get_attachments})}(n["albero_cli.entity.note.Note"]=ta).__name__=["albero_cli","entity","note","Note"],ta.of=function(e){return new ta(e)},ta.prototype={get_attachments:function(){return this.noteRevision.contentFiles},__class__:ta};var na=function(e){this.revision=e.revision,this.title=e.title,this.contentType=yi.getValue(e.contentType),this.contentText=e.contentText,this.contentFiles=this.convertFiles(e.contentFiles),this.createdBy=e.createdBy,this.createdAt=e.createdAt};(n["albero_cli.entity.note.NoteRevision"]=na).__name__=["albero_cli","entity","note","NoteRevision"],na.of=function(e){return new na(e)},na.prototype={convertFiles:function(e){return null==e||e.length<=0?[]:e.map(function(e){return $r.of(e)})},__class__:na};function ia(){}(n["puremvc.interfaces.IMediator"]=ia).__name__=["puremvc","interfaces","IMediator"],ia.prototype={__class__:ia};var ra=function(e,t){x.call(this),this.mediatorName=null!=e?e:ra.NAME,null!=t&&(this.viewComponent=t)};(n["puremvc.patterns.mediator.Mediator"]=ra).__name__=["puremvc","patterns","mediator","Mediator"],ra.__interfaces__=[ia],ra.__super__=x,ra.prototype=i(x.prototype,{getMediatorName:function(){return this.mediatorName},setViewComponent:function(e){this.viewComponent=e},getViewComponent:function(){return this.viewComponent},listNotificationInterests:function(){return[]},handleNotification:function(e){},onRegister:function(){},onRemove:function(){},__class__:ra});var aa=function(){ra.call(this,"commandline",null)};(n["albero_cli.mediator.CommandLineMediator"]=aa).__name__=["albero_cli","mediator","CommandLineMediator"],aa.__super__=ra,aa.prototype=i(ra.prototype,{onRegister:function(){this.getViewComponent();this.eventEmitter=r.getInstance(),this.dataRecovered=!1,this.startDataSaver()},listNotificationInterests:function(){return["app_state_changed","access_token_changed","current_user_changed","configuration_changed","domain_selection_changed","talk_selection_changed","talk_list_scroll_to_talk_top_needed","user_selection_needed","user_selection_changed","friend_selection_needed","common_stamp_set_loaded","stamp_selection_started","stamp_selection_ended","stamp_selection_changed","action_selection_changed","current_page_changed","current_page_reassgined","fileinfo_selection_changed","message_fileinfo_selection_changed","staged_fileinfo_selection_changed","staged_fileinfos_added","staged_fileinfos_moved","error_occurred","brand_badge_changed","send_form_top_changed","solutions_loaded","right_pane_opened","right_pane_closed","password_expiration_overed","password_expiration_warned","photo_editor_saved","mc_authenticated_user_received","keyword_watching_updated","keyword_detaction_updated","send_by_enter_changed","department_selection_changed_for_members_page","presences_updated","noteinfo_selection_changed","start_note_editing","start_notification_failed","data_recovering","data_recovered","notify_update_user","notify_add_friend","notify_add_acquaintance","notify_add_acquaintances","notify_delete_friend","notify_delete_acquaintance","notify_delete_acquaintances","notify_update_domain_users","get_domain_users_responsed","get_users_responsed","get_profile_responsed","get_profile_errored","update_user_responsed","update_user_errored","update_profile_responsed","update_profile_errored","notify_update_department_tree","notify_update_department_users","get_department_tree_responsed","get_department_tree_canceled","get_department_users_responsed","get_department_users_canceled","get_department_user_count_responsed","get_me_responsed","department_user_count_cleared","department_user_ids_prepared","notify_add_domain_invite","notify_accept_domain_invite","notify_delete_domain_invite","notify_join_domain","notify_update_domain","notify_leave_domain","notify_add_domain_members","notify_create_pair_talk","notify_create_group_talk","notify_update_group_talk","notify_update_group_talk_ERRORED","notify_add_talkers","notify_add_talkers_including_me","notify_delete_talker","notify_delete_talk","notify_create_message","notify_delete_message","notify_update_read_statuses","notify_update_talk_status","notify_update_local_talk_status","notify_get_messages","notify_get_message_status","notify_add_favorite_talk","notify_delete_favorite_talk","notify_disable_push_notification","notify_enable_push_notification","create_message_start","create_message_complete","create_message_fail","notify_create_announcement","notify_delete_announcement","notify_update_announcement_status","notify_get_announcements","create_announcement_start","create_announcement_complete","create_announcement_fail","notify_update_question","get_questions_responsed","notify_create_attachment","notify_delete_attachment","get_note_statuses_loaded","get_note_loaded","get_note_failed_by_note_not_found","create_note_completed","create_note_failed","update_note_local_edit","clear_note_local_edit","update_note_setting_completed","update_note_setting_failed_by_not_found","update_note_setting_failed_by_conflict","update_note_setting_failed_by_editing","update_note_completed","delete_note_completed","notify_create_note","notify_update_note_partially","notify_delete_note","notify_update_note_for_setting","notify_update_note_for_revision","create_note_button_clicked","notify_lock_note","notify_unlock_note","get_file_responsed","notify_search_messages","notify_search_attachments","notify_search_messages_fail","notify_search_attachments_fail","notify_search_prepare","notify_search_clear","notify_filter_box_text_changed","notify_search_box_popup","notify_add_account_control_request","notify_delete_account_control_request","notify_join_account_control_group","notify_update_account_control_group_partially","notify_leave_account_control_group","prepare_conference_from_message","join_conference_responsed","join_conference_canceled","notify_open_conference","notify_close_conference","notify_conference_participant_join","notify_conference_participant_limit","notify_conference_participant_reject","notify_all_talk_members_rejected_conference"]},handleNotification:function(e){var t=this,n=e.getName();switch(n){case"current_page_changed":var i=e.getBody();ee.enumEq(i,V.error)&&(this.dataRecovered=!1),this.eventEmitter.emit(e.getName(),e.getBody());break;case"data_recovered":if(this.dataRecovered)return;this.dataRecovered=!0,this.eventEmitter.emit(e.getName());break;case"data_recovering":this.dataRecovered=!1,this.eventEmitter.emit(e.getName());break;case"error_occurred":this.eventEmitter.emit(e.getName(),new Error("AdapterError"),e.getBody());break;case"start_notification_failed":ji._e("["+tt.dateStr(new Date)+"] ","start_notification failed.","","","",""),process.exit(1);break;default:this.eventEmitter.emit(e.getName(),e.getBody())}this.getViewComponent();switch(e.getName()){case"access_token_changed":this.dataStore.clear(!0),console.log(e.getBody()),process.exit(0);break;case"create_announcement_complete":case"create_message_complete":var r,a=e.getBody(),o=a[0],s=(a[1],this.dataStore),l=o.userId;if(null!=s.me){var u=s.me.id;r=null!=u&&null!=l&&u.high==l.high&&u.low==l.low}else r=!1;if(r)return this.messageEvent.messageCreated(o,e.getType()),void this.sendQueue.sendNext(o);break;case"create_message_fail":var c,_=e.getBody()[0],h=e.getBody()[1],d=this.dataStore,f=h.userId;if(null!=d.me){var m=d.me.id;c=null!=m&&null!=f&&m.high==f.high&&m.low==f.low}else c=!1;if(c)return this.messageEvent.messageCreated(null,e.getType()),void(null!=_&&429==_.code?this.sendQueue.retryAfter(1e3*(0|_.detail.retry_after)):null!=_&&503==_.code?this.sendQueue.retryAfter(1e3*(0|_.detail.retry_after)):this.sendQueue.sendNext(h));break;case"create_note_completed":var p,g=e.getBody(),v=this.dataStore,y=g.note.createdBy;if(null!=v.me){var S=v.me.id;p=null!=S&&null!=y&&S.high==y.high&&S.low==y.low}else p=!1;if(p)return this.messageEvent.noteCreated(g.note,g.emitterKey),void this.sendQueue.sendNextTalkMessage();break;case"create_note_failed":var w,I=e.getBody(),T=this.dataStore,E=I.callerId;if(null!=T.me){var N=T.me.id;w=null!=N&&null!=E&&N.high==E.high&&N.low==E.low}else w=!1;if(w){this.messageEvent.noteCreated(null,I.emitterKey),this.sendQueue.sendNextTalkMessage();var A="failed to create note: "+K.string(I.error);return void ji._d("["+tt.dateStr(new Date)+"] ",A,"","","","")}break;case"current_user_changed":e.getBody();this.sendQueue.restart();break;case"notify_add_domain_invite":e.getBody();break;case"notify_create_group_talk":case"notify_create_pair_talk":if(!this.dataRecovered)return;var b=e.getBody();wa.delay(function(){t.emitWithMe(b,"JoinMessage",t.dataStore.me)},500);break;case"notify_create_message":var D,k=e.getBody(),C=this.dataStore,O=k.userId;if(null!=C.me){var M=C.me.id;D=null!=M&&null!=O&&M.high==O.high&&M.low==O.low}else D=!1;if(D)return;if(k.isBotMessage&&!wo.talkWithBot)return;var R=this.dataStore.getTalkStatus(k.talkId),F=Wi.getAcceptableEventTimeDiff();if(null!=R&&!R.isMessageAcceptable(k,F))return;wa.delay(function(){null!=t.dataStore.getTalk(k.talkId)&&(t.sendNotification("Read",_e.TALK(k.talkId)),t.dispatch(k))},200);break;case"notify_delete_talk":var x=e.getBody();this.messageEvent.deleteTalk(x);break;case"notify_get_message_status":var U=e.getBody();this.messageEvent.messageRead(U.talkId,U.id,U.readUserIds,U.unreadUserIds);break;case"notify_leave_domain":var P=e.getBody();this.messageEvent.leaveDomain(P);break;case"notify_update_group_talk":if(!this.dataRecovered)return;var L=e.getBody(),B=null!=L.name?L.name:"";wa.delay(function(){t.emitWithMe(L,"TopicChangeMessage",t.dataStore.me,B)},500);break;case"notify_update_local_talk_status":var H=e.getBody();this.messageEvent.messageReadEveryone(H.id,H.maxEveryoneReadMessageId);break;case"notify_update_read_statuses":for(var j=e.getBody(),Y=0,z=j.messageIds;Y<z.length;){var G=z[Y];++Y,this.messageEvent.messageRead(j.talkId,G,j.readUserIds)}}},emitWithUser:function(e,t,n,i){this.emit(e,t,this.hubotObject.userObject(n),i)},emitWithMe:function(e,t,n,i){this.emit(e,t,this.hubotObject.meObject(n),i)},emit:function(r,a,o,s){var l=this;null!=a&&null!=r&&null!=o&&this.api.getAllUserIdentifiers(function(){var e=l.eventEmitter,t=r.id,n="_"+t.high+"_"+t.low,i=l.hubotObject.talkObjects();e.emit(a,{room:n,rooms:i},o,s)})},leave:function(e){var t=this;wa.delay(function(){null!=t.dataStore.getTalk(e.id)&&t.sendNotification("Talk",Ie.DELETE(null,e))},500)},dispatch:function(a){function e(e,t,n){var i=o.dataStore.getUser(s.domainId,t),r=a.id;o.emitWithUser(s,e,i,{id:"_"+r.high+"_"+r.low,content:n})}var o=this,t=a.content,s=this.dataStore.getTalk(a.talkId);if(a.type==Rt.system){var n=t.type;if("add_talkers"==n){var i=t.added_user_ids,r=this.dataStore.me.id;if(it.contains(i,r))return void e("JoinMessage",r);for(var l=0;l<i.length;){var u=i[l];++l,e("EnterMessage",u)}}else"delete_talker"==n?(e("LeaveMessage",t.deleted_user_id),t.user_ids.length<=1&&this.leave(s)):"hide_pair_talk"==n&&(e("LeaveMessage",t.user_id),this.leave(s))}else{var c=null;if(1==a.type[1])c=t;else{for(var _=a.content,h=null==_?null:JSON.parse(JSON.stringify(_)),d=0,f=z.fields(h);d<f.length;){var m=f[d];++d;var p=z.field(h,m);if(z.isObject(h)&&null!=p.high&&null!=p.low){var g=new zn(p.high,p.low);h[m]="stamp_index"==m?va.toString(g):"_"+g.high+"_"+g.low}else"stamp_set"==m&&(h[m]=K.string(p))}a.type!=Rt.textMultipleFile||null!=h.text&&0!=h.text.length||null==h.files||1!=h.files.length||(h=h.files[0]),c=JSON.stringify(h)}if(null!=c){if(s.type==Nn.PairTalk){var v=null!=wo.name?wo.name:"Hubot";W.startsWith(c,v)||(c=v+" "+c)}e("TextMessage",a.userId,c)}}},startDataSaver:function(){var e=this;wa.delay(function(){e.dataRecovered&&e.dataStore.saveIfNeeded(),e.startDataSaver()},5e3)},__class__:aa});var oa=function(){er.call(this,"hubotObject")};(n["albero_cli.proxy.HubotObjectProxy"]=oa).__name__=["albero_cli","proxy","HubotObjectProxy"],oa.__super__=er,oa.prototype=i(er.prototype,{userObject:function(e){return Jr.of(e).toCompatibleData()},meObject:function(e){return Xr.of(e).toCompatibleData()},userObjectByIdStr:function(e,t){var n,i=t.split("_");2<i.length?n=new zn(K.parseInt(i[1]),K.parseInt(i[2])):n=null;var r=this.userObjectsByIds(e,[n]);return 0<r.length?r[0]:null},userObjectsByIds:function(e,t,n){for(var i=[],r=0,a=this.dataStore.getUsers(e,t);r<a.length;){var o=a[r];if(++r,null!=o){var s=o.id,l="u_"+s.high+"_"+s.low,u=null!=n?null!=Io[l]?n.getReserved(l):n.h[l]:null;if(null==u&&(u=this.userObject(o),null!=n)){var c=u;null!=Io[l]?n.setReserved(l,c):n.h[l]=c}null!=u&&i.push(u)}}return i},userObjects:function(e){for(var t={},n=new Ma,i=0,r=this.dataStore.getUsers(e);i<r.length;){var a=r[i];++i;var o,s=a.id,l="_"+s.high+"_"+s.low;if(null!=t[l]){var u=(null!=Io[l]?n.getReserved(l):n.h[l]).updatedAt,c=a.updatedAt,_=u.high-c.high|0;_=0!=_?_:ga.ucompare(u.low,c.low),o=(u.high<0?c.high<0?_:-1:0<=c.high?_:1)<=0}else o=!0;o&&(t[l]=this.userObject(a),null!=Io[l]?n.setReserved(l,a):n.h[l]=a)}return t},talkObject:function(e,t){var n=this.userObjectsByIds(e.domainId,e.userIds,t),i=this.domainObjectById(e.domainId,t);return ea.create(e,n,i).toCompatibleData()},talkObjects:function(e){for(var t=new Ma,n={},i=0,r=this.dataStore.getTalks();i<r.length;){var a,o=r[i];if(++i,null!=e){var s=o.domainId;a=!(null!=e&&null!=s&&e.high==s.high&&e.low==s.low)}else a=!1;if(!a){var l=o.id;n["_"+l.high+"_"+l.low]=this.talkObject(o,t)}}return n},domainObjectById:function(e,t){if(null==e)return null;var n="d_"+e.high+"_"+e.low,i=null!=Io[n]?t.getReserved(n):t.h[n];if(null==i){var r=i=this.domainObject(this.dataStore.getDomain(e));null!=Io[n]?t.setReserved(n,r):t.h[n]=r}return i},domainObject:function(e,t){null==t&&(t=!1);var n=null;return t&&(n=this.talkObjects(e.id)),qr.create(e,n).toCompatibleData()},domainObjects:function(){for(var e={},t=0,n=this.dataStore.getDomains();t<n.length;){var i=n[t];++t;var r=i.id;e["_"+r.high+"_"+r.low]=this.domainObject(i)}return e},noteObject:function(e){return ta.of(e)},messageObject:function(e){var t=new Ma,n=this.dataStore.getTalk(e.talkId),i=this.userObjectsByIds(n.domainId,[e.userId],t),r={};r.type=Mt.enumIndex(e.type);var a=e.content;r.content=null==a?null:JSON.parse(JSON.stringify(a));var o=e.createdAt;r.createdAt=null==o?null:JSON.parse(JSON.stringify(o));var s=e.id;r.id_i64=null==s?null:JSON.parse(JSON.stringify(s));var l=e.id;r.id="_"+l.high+"_"+l.low,r.user=0<i.length?i[0]:null;var u=e.userId;r.userId="_"+u.high+"_"+u.low,r.talk=this.talkObject(n,t);var c=e.talkId;return r.talkId="_"+c.high+"_"+c.low,r},__class__:oa});var sa=function(){er.call(this,"messageEvent"),this.emitters=new Ma};(n["albero_cli.proxy.MessageEventProxy"]=sa).__name__=["albero_cli","proxy","MessageEventProxy"],sa.__super__=er,sa.prototype=i(er.prototype,{registEmitter:function(e,t){la.factory=this;var n=la.createInstance(t);if(null!=n){var i=this.emitters;null!=Io[e]?i.setReserved(e,n):i.h[e]=n}},noteCreated:function(e,t){var n=this.emitters,i=null!=Io[t]?n.getReserved(t):n.h[t];if(null!=i&&(this.emitters.remove(t),null!=e)){var r=e.noteId.toString(),a=this.emitters;null!=Io[r]?a.setReserved(r,i):a.h[r]=i,i.talk=this.dataStore.getTalk(e.talkId),i.setFirstReader(this.dataStore.me),i.onceOnSend(e),i.hasEventListener()||this.emitters.remove(r)}},messageCreated:function(e,t){var n=this.emitters,i=null!=Io[t]?n.getReserved(t):n.h[t];if(null!=i&&(this.emitters.remove(t),null!=e)){var r=e.id,a="_"+r.high+"_"+r.low,o=this.emitters;if(null!=Io[a]?o.setReserved(a,i):o.h[a]=i,i.talk=this.dataStore.getTalk(e.talkId),i.setFirstReader(this.dataStore.me),i.emitOnSend(e),i.removeEventListener("send"),!i.hasEventListener()){var s=e.id;this.emitters.remove("_"+s.high+"_"+s.low)}}},messageRead:function(t,n,e,i){var r=this,a="_"+n.high+"_"+n.low,o=this.emitters,s=null!=Io[a]?o.getReserved(a):o.h[a];if(null!=s){s.emitOnRead(e,i);var l=16<=s.__readerIds.length;s.startTimer(l,function(e){e?r.messageReadEveryone(t,n):r.sendNotification("Read",_e.READ_STATUS(t,n))}),0==s.__unreadIds.length&&this.messageReadEveryone(t,n)}},messageReadEveryone:function(e,t){if(null!=t)for(var n=this.emitters.keys();n.hasNext();){var i,r=n.next(),a=this.emitters,o=null!=Io[r]?a.getReserved(r):a.h[r];if(null!=o.talk){var s=o.talk.id;i=null!=s&&null!=e&&s.high==e.high&&s.low==e.low}else i=!1;if(i){var l=it.makeFromIdStr(r),u=l.high-t.high|0;u=0!=u?u:ga.ucompare(l.low,t.low),(l.high<0?t.high<0?u:-1:0<=t.high?u:1)<=0&&this._messageReadEveryone(e,r)}}},_messageReadEveryone:function(e,t){var n=this.emitters,i=null!=Io[t]?n.getReserved(t):n.h[t];null!=i&&(0<i.__unreadIds.length&&i.emitOnRead(i.__unreadIds),i.stopTimer(),i.removeEventListener("read"),i.hasEventListener()||this.emitters.remove(t))},deleteTalk:function(e){for(var t=this.emitters.keys();t.hasNext();){var n,i=t.next(),r=this.emitters,a=null!=Io[i]?r.getReserved(i):r.h[i];if(null!=a.talk){var o=a.talk.id;n=null!=o&&null!=e&&o.high==e.high&&o.low==e.low}else n=!1;n&&(a.stopTimer(),this.emitters.remove(i))}},leaveDomain:function(e){for(var t=this.emitters.keys();t.hasNext();){var n,i=t.next(),r=this.emitters,a=null!=Io[i]?r.getReserved(i):r.h[i];if(null!=a.talk){var o=a.talk.domainId;n=null!=o&&null!=e&&o.high==e.high&&o.low==e.low}else n=!1;n&&(a.stopTimer(),this.emitters.remove(i))}},__class__:sa});var la=function(e){this.context=e,this.listeners=new Ma,Object.defineProperty(this,"readUsers",{get:this.get_readUsers}),Object.defineProperty(this,"unreadUsers",{get:this.get_unreadUsers})};(n["albero_cli.proxy.Emitter"]=la).__name__=["albero_cli","proxy","Emitter"],la.createInstance=function(e){for(var t=null,n=z.fields(e),i=0;i<n.length;){var r=n[i];if(++i,W.startsWith(r,"on")){var a=z.field(e,r);z.isFunction(a)&&(z.deleteField(e,r),null==t&&(t=new la(e)),t.addEventListener(tt.substr(r,2,null),a))}}return t},la.prototype={addEventListener:function(e,t){var n=this.listeners,i=t;null!=Io[e]?n.setReserved(e,i):n.h[e]=i},hasEventListener:function(){var e=this.listeners;return new Oa(e,e.arrayKeys()).hasNext()},removeEventListener:function(e){this.listeners.remove(e)},emit:function(e,t){var n=this.listeners,i=null!=Io[e]?n.getReserved(e):n.h[e];null!=i&&i.apply(this,t)},onceOnSend:function(e){this.note=this.createNoteObjectForHubot(e),this.emit("send",[this]),this.removeEventListener("send")},emitOnSend:function(e){this.message=this.get_message(e),this.emit("send",[this,e])},emitOnRead:function(e,t){var n=[];null!=t&&(this.__unreadIds=t);for(var i=0;i<e.length;){var r=e[i];++i,it.contains(this.__readerIds,r)||(this.__readerIds.push(r),n.push(r)),it.remove(this.__unreadIds,r)}0<n.length&&this.emit("read",[this.users(n),this.get_readUsers(),this.get_unreadUsers()])},setFirstReader:function(e){this.__readerIds=[e.id],this.__unreadIds=this.talk.userIds.slice(),it.remove(this.__unreadIds,e.id)},get_readUsers:function(){return this.users(this.__readerIds)},get_unreadUsers:function(){return this.users(this.__unreadIds)},users:function(e){return null==e?[]:la.factory.hubotObject.userObjectsByIds(this.talk.domainId,e)},createNoteObjectForHubot:function(e){return la.factory.hubotObject.noteObject(e)},get_message:function(e){return la.factory.hubotObject.messageObject(e)},answer:function(s){var e,l=this,u=Mt.typeOf(this.message.type),t=this.message.id.split("_");2<t.length?e=new zn(K.parseInt(t[1]),K.parseInt(t[2])):e=null;switch(u[1]){case 14:case 16:case 18:case 19:case 20:case 21:var n=this.message.content.in_reply_to;e=new zn(n.high,n.low)}var i=de.Question(e,function(e){var t=e.responses;switch(u[1]){case 13:case 14:case 19:var n=l.users(t[0].userIds),i=l.users(t[1].userIds);s(n,i);break;case 17:case 18:case 21:var r=l.users(t[0].userIds),a=l.users(t[1].userIds);s(r,a);break;case 15:case 16:case 20:var o=t.map(function(e){return l.users(e.userIds)});s(o)}});la.factory.sendNotification("ReloadData",i)},startTimer:function(e,t){var n=this;null!=this.__readerTimer&&this.stopTimer(),this.__readerTimerWait=e?1:1440;var i=null;i=function(){n.__readerTimerWait*=2,n.__readerTimerWait<1440?(t(!1),n.__readerTimer=wa.delay(i,60*n.__readerTimerWait*1e3|0)):(t(!0),n.__readerTimer=null)},this.__readerTimer=wa.delay(i,60*this.__readerTimerWait*1e3|0)},stopTimer:function(){null!=this.__readerTimer&&(this.__readerTimer.stop(),this.__readerTimer=null)},__class__:la};var ua=function(){er.call(this,"sendQueue"),this.sendCount=0,this.sendMsgQueue=new ca(this,550,new Bi("sendQueueMessage")),this.sendAnnounceQueue=new ca(this,5050,new Bi("sendQueueAnnounce"))};(n["albero_cli.proxy.SendQueueProxy"]=ua).__name__=["albero_cli","proxy","SendQueueProxy"],ua.__super__=er,ua.prototype=i(er.prototype,{restart:function(){this.sendMsgQueue.sendNext(),this.sendAnnounceQueue.sendNext()},retryAfter:function(e){this.sendMsgQueue.retryAfter(e),this.sendAnnounceQueue.retryAfter(e)},sendNextTalkMessage:function(){this.sendMsgQueue.sendNext()},sendNext:function(e){null!=e.talkId?this.sendMsgQueue.sendNext():this.sendAnnounceQueue.sendNext()},sendAnnouncement:function(e,t){this.send(e,null,t)},sendMessage:function(e,t){this.send(null,e,t)},send:function(e,t,n){if("string"!=typeof n){var i=new zn(0,this.sendCount++);this.messageEvent.registEmitter("_"+i.high+"_"+i.low,n);var r=new Mt;if(r.id=i,r.domainId=e,r.talkId=t,r.content=this.parseContent(n),r.type=this.detectType(r.content),r.type==Rt.unknown)return;if(r.type==Rt.file&&null!=r.content.path)return void this.sendFile(t,r.content,"_"+i.high+"_"+i.low);if(r.type==Rt.noteCreated)return void this.sendNote(t,r.content,"_"+i.high+"_"+i.low);r.type!=Rt.yesOrNo&&r.type!=Rt.selectOne||null!=r.content.listing||(r.content.listing=!1),this.applyLimitToMessage(r),this.pushQueue(r)}else for(var a=0,o=h.slice(n,1024);a<o.length;){var s=o[a];++a;var l=new Mt;l.domainId=e,l.talkId=t,l.type=Rt.text,l.content=s,this.pushQueue(l)}},sendNote:function(e,t,n){var i=this.validateNoteObject(t);switch(i[1]){case 0:var r=i[2];ji._e("["+tt.dateStr(new Date)+"] ","validation error: "+r,"","","","");break;case 1:var a=i[2];this.sendMsgQueue.pushQueue("Note",ue.CREATE_NOTE_FOR_HUBOT(e,a,!0,n))}},validateNoteObject:function(e){if(this.isStringEmpty(e.note_title))return Aa.Left("note_title is empty");if(this.isStringEmpty(e.note_content))return Aa.Left("note_content is empty");var t=null;if(e.note_attachments instanceof Array&&null==e.note_attachments.__enum__&&this.hasPathField(e.note_attachments))t=e.note_attachments;else{if(null!=e.note_attachments)return Aa.Left("note_attachments is invalid: "+K.string(e.note_attachments));t=[]}return Aa.Right({title:e.note_title,content:e.note_content,attachments:t})},hasPathField:function(e){var t=this;return nt.foreach(e,function(e){return!t.isStringEmpty(e.path)})},isStringEmpty:function(e){return null==e||0==e.length},sendFile:function(e,t,n){var i,r=null,a=null;if("string"==typeof t)i=t;else{if(t.path instanceof Array&&null==t.path.__enum__)return void this.sendFiles(e,t.path,t.name,t.type,t.text,n);if(null!=t.text)return void this.sendFiles(e,[t.path],[t.name],[t.type],t.text,n);i=t.path,r=t.name,a=t.type}null!=i&&Ka.existsSync(i)?this.sendMsgQueue.pushQueue("File",Z.UPLOAD_PATH(e,i,r,a,n)):ji._e("["+tt.dateStr(new Date)+"] ","File not found: ",i,"","","")},sendFiles:function(e,t,n,i,r,a){for(var o=0;o<t.length;){var s=t[o];if(++o,!Ka.existsSync(s))return void ji._e("["+tt.dateStr(new Date)+"] ","File not found: ",s,"","","")}var l=t.length;if(null==n){for(var u=[],c=0,_=l;c<_;){c++;u.push(null)}n=u}if(null==i){for(var h=[],d=0,f=l;d<f;){d++;h.push(null)}i=h}n.length==l&&i.length==l?this.sendMsgQueue.pushQueue("File",Z.UPLOAD_MULTI_PATH(e,r,t,n,i,a)):ji._e("["+tt.dateStr(new Date)+"] ","The length of name or type must be the same as path length.","","","","")},pushQueue:function(e){null==e.talkId?this.sendAnnounceQueue.pushQueue("Send",e):this.sendMsgQueue.pushQueue("Send",e)},parseContent:function(e){if(null==e)return null;for(var t=z.fields(e),n=0;n<t.length;){var i=t[n];++n;var r=z.field(e,i);if("string"==typeof r){var a=null;if("stamp_set"==i)a=K.parseInt(r);else if("stamp_index"==i)a=it.parse(r);else if("file_id"==i||"in_reply_to"==i){var o=r.split("_");if(2<o.length)a=new zn(K.parseInt(o[1]),K.parseInt(o[2]));else a=null}else if("close_yesno"==i||"close_select"==i||"close_task"==i){e.close=tt.substr(i,6,null),i="in_reply_to";var s=r.split("_");if(2<s.length)a=new zn(K.parseInt(s[1]),K.parseInt(s[2]));else a=null}null!=a&&(e[i]=a)}else if(null!=r&&z.isObject(e)&&null!=r.high&&null!=r.low){var l=new zn(r.high,r.low);e[i]=l}}return 1==t.length&&null!=e.text?e.text:e},detectType:function(e){if(null==e)return Rt.unknown;if("string"==typeof e)return Rt.text;if(null!=e.stamp_set)return Rt.stamp;if(null!=e.lat)return Rt.geo;if(null!=e.file_id||null!=e.path)return Rt.file;if(null!=e.close){var t=e.close;if(z.deleteField(e,"close"),"yesno"==t)return Rt.yesOrNoClosed;if("select"==t)return Rt.selectOneClosed;if("task"==t)return Rt.todoClosed}else if(null!=e.in_reply_to){if("boolean"==typeof e.response)return Rt.yesOrNoReply;var n=e.response;if("number"==typeof n&&(0|n)===n)return Rt.selectOneReply;if(null!=e.done)return Rt.todoDone}else{if(null!=e.question)return null==e.options?Rt.yesOrNo:Rt.selectOne;if(null!=e.title)return Rt.todo;if(null!=e.note_title)return Rt.noteCreated}return Rt.unknown},applyLimitToMessage:function(e){switch(e.type[1]){case 1:var t=e.content;null!=t&&1024<t.length&&(e.content=t.substring(0,1024));break;case 2:case 5:var n=e.content.text;null!=n&&1024<n.length&&(e.content.text=n.substring(0,1024));break;case 13:case 15:var i=e.content.question;if(null!=i&&1024<i.length&&(e.content.question=i.substring(0,1024)),e.type==Rt.selectOne){var r=e.content.options;9<r.length&&(r=r.slice(0,9),e.content.options=r);for(var a=0,o=r.length;a<o;){var s=a++;64<r[s].length&&(r[s]=r[s].substring(0,64))}}break;case 17:var l=e.content.title;null!=l&&1024<l.length&&(e.content.title=l.substring(0,1024))}},__class__:ua});var ca=function(e,t,n){this.proxy=e,this.sendSpan=t,this.storage=n,this.sendQueue=this.loadQueue(),this.sending=0<this.sendQueue.length,this.lastSendNode=null,this.lastSendTime=new Date(0)};(n["albero_cli.proxy._SendQueueProxy.SendQueue"]=ca).__name__=["albero_cli","proxy","_SendQueueProxy","SendQueue"],ca.prototype={pushQueue:function(e,t){this.sendQueue.push({name:e,param:t}),this.saveQueue(),this.sending||(this.sending=!0,this.sendNext())},sendNext:function(){if(this.sending&&0!=this.sendQueue.length){var e=(new Date).getTime()-this.lastSendTime.getTime(),t=0|Math.max(this.sendSpan-e,100);wa.delay(fo(this,this.sendNotification),t)}else this.closeQueue()},retryAfter:function(e){this.sending&&null!=this.lastSendNode?(this.sendQueue.unshift(this.lastSendNode),this.saveQueue(),wa.delay(fo(this,this.sendNotification),e)):this.closeQueue()},sendNotification:function(){var e=this.sendQueue.shift();this.saveQueue(),this.proxy.sendNotification(e.name,e.param),this.lastSendNode=e,this.lastSendTime=new Date},closeQueue:function(){this.sending=!1,this.lastSendNode=null},saveQueue:function(){null!=this.storage&&this.storage.save(this.sendQueue)},loadQueue:function(){if(null!=this.storage){var e=this.storage.load();if(null!=e)return e}return[]},__class__:ca};var _a=function(e,t,n){this.code=e,this.message=t,this.detail=n};(n["albero_cli.value.ApiErrorResponse"]=_a).__name__=["albero_cli","value","ApiErrorResponse"],_a.of=function(e){switch(e.code){case 400:if("invalid parameter"==e.message)return new _a(ha.INVALID_PARAMETER);break;case 403:if("forbidden"==e.message)return new _a(ha.FORBIDDEN);break;case 404:if("not found"==e.message)return new _a(ha.NOT_FOUND);break;case 409:switch(e.message){case"conflict":return new _a(ha.CONFLICT);case"locked by another user":return new _a(ha.LOCKED_BY_ANOTHER_USER,null,{userId:e.detail.user_id})}break;case 429:return _a.createTooManyRequestsError(e.message,e.detail.retry_after)}var t="please contact us: error = "+K.string(e);return ji._w("["+tt.dateStr(new Date)+"] ",t,"","","",""),new _a(ha.UNKNOWN)},_a.createInvalidParameterError=function(e){return new _a(ha.INVALID_PARAMETER,e)},_a.createTooManyRequestsError=function(e,t){return new _a(ha.TOO_MANY_REQUESTS,e,{retryAfter:t})},_a.prototype={__class__:_a};var ha=function(){};(n["albero_cli.value.ApiErrorCode"]=ha).__name__=["albero_cli","value","ApiErrorCode"];var da=function(){};(n["albero_cli.value.note.DeleteNoteResult"]=da).__name__=["albero_cli","value","note","DeleteNoteResult"],da.of=function(e){return new da},da.prototype={__class__:da};var fa=function(e){this.note=e};(n["albero_cli.value.note.GetNoteResult"]=fa).__name__=["albero_cli","value","note","GetNoteResult"],fa.of=function(e){return new fa(ta.of(e.note))},fa.prototype={__class__:fa};var ma=function(e){this.note=e};(n["albero_cli.value.note.UpdateNoteResult"]=ma).__name__=["albero_cli","value","note","UpdateNoteResult"],ma.of=function(e){return new ma(ta.of(e.note))},ma.prototype={__class__:ma};function pa(){}(n["haxe.IMap"]=pa).__name__=["haxe","IMap"];var ga={};(n["haxe._Int32.Int32_Impl_"]=ga).__name__=["haxe","_Int32","Int32_Impl_"],ga.ucompare=function(e,t){return e<0?t<0?~t-~e|0:1:t<0?-1:e-t|0};var va={};(n["haxe._Int64.Int64_Impl_"]=va).__name__=["haxe","_Int64","Int64_Impl_"],va.toString=function(e){var t=e,n=new zn(0,0);if(t.high==n.high&&t.low==n.low)return"0";var i="",r=!1;t.high<0&&(r=!0);for(var a=new zn(0,10);;){var o=new zn(0,0);if(t.high==o.high&&t.low==o.low)break;var s=va.divMod(t,a);if(s.modulus.high<0){var l=s.modulus,u=~l.high,c=-l.low;if(0==c){u++;u|=0}i=new zn(u,c).low+i;var _=s.quotient,h=~_.high,d=-_.low;if(0==d){h++;h|=0}t=new zn(h,d)}else i=s.modulus.low+i,t=s.quotient}return r&&(i="-"+i),i},va.divMod=function(e,t){if(0==t.high)switch(t.low){case 0:throw new za("divide by zero");case 1:return{quotient:new zn(e.high,e.low),modulus:new zn(0,0)}}var n,i=e.high<0!=t.high<0;if(e.high<0){var r=~e.high,a=-e.low;if(0==a){r++;r|=0}n=new zn(r,a)}else{n=new zn(e.high,e.low)}if(t.high<0){var o=~t.high,s=-t.low;if(0==s){o++;o|=0}t=new zn(o,s)}else t=t;for(var l=new zn(0,0),u=new zn(0,1);!(t.high<0);){var c=ga.ucompare(t.high,n.high),_=0!=c?c:ga.ucompare(t.low,n.low);63,t=new zn(t.high<<1|t.low>>>31,t.low<<1);if(63,u=new zn(u.high<<1|u.low>>>31,u.low<<1),0<=_)break}for(;;){var h=new zn(0,0);if(u.high==h.high&&u.low==h.low)break;var d=ga.ucompare(n.high,t.high);if(0<=(0!=d?d:ga.ucompare(n.low,t.low))){l=new zn(l.high|u.high,l.low|u.low);var f=n.high-t.high|0,m=n.low-t.low|0;if(ga.ucompare(n.low,t.low)<0){f--;f|=0}n=new zn(f,m)}63,u=new zn(u.high>>>1,u.high<<31|u.low>>>1);63,t=new zn(t.high>>>1,t.high<<31|t.low>>>1)}if(i){var p=~l.high,g=-l.low;if(0==g){p++;p|=0}l=new zn(p,g)}if(e.high<0){var v=~n.high,y=-n.low;if(0==y){v++;v|=0}n=new zn(v,y)}return{quotient:l,modulus:n}};var ya=function(){};(n["haxe.Int64Helper"]=ya).__name__=["haxe","Int64Helper"],ya.parseString=function(e){var t=new zn(0,10),n=new zn(0,0),i=new zn(0,1),r=!1,a=W.trim(e);"-"==a.charAt(0)&&(r=!0,a=a.substring(1,a.length));for(var o=a.length,s=0,l=o;s<l;){var u=s++,c=tt.cca(a,o-1-u)-48;if(c<0||9<c)throw new za("NumberFormatError");var _=new zn(c>>31,c);if(r){var h=65535&i.low,d=i.low>>>16,f=65535&_.low,m=_.low>>>16,p=ga._mul(h,f),g=ga._mul(d,f),v=ga._mul(h,m),y=p,S=(ga._mul(d,m)+(v>>>16)|0)+(g>>>16)|0;if(y=y+(v<<=16)|0,ga.ucompare(y,v)<0){S++;S|=0}if(y=y+(g<<=16)|0,ga.ucompare(y,g)<0){S++;S|=0}S=S+(ga._mul(i.low,_.high)+ga._mul(i.high,_.low)|0)|0;var w=new zn(S,y),I=n.high-w.high|0,T=n.low-w.low|0;if(ga.ucompare(n.low,w.low)<0){I--;I|=0}if(!((n=new zn(I,T)).high<0))throw new za("NumberFormatError: Underflow")}else{var E=65535&i.low,N=i.low>>>16,A=65535&_.low,b=_.low>>>16,D=ga._mul(E,A),k=ga._mul(N,A),C=ga._mul(E,b),O=D,M=(ga._mul(N,b)+(C>>>16)|0)+(k>>>16)|0;if(O=O+(C<<=16)|0,ga.ucompare(O,C)<0){M++;M|=0}if(O=O+(k<<=16)|0,ga.ucompare(O,k)<0){M++;M|=0}M=M+(ga._mul(i.low,_.high)+ga._mul(i.high,_.low)|0)|0;var R=new zn(M,O),F=n.high+R.high|0,x=n.low+R.low|0;if(ga.ucompare(x,n.low)<0){F++;F|=0}if((n=new zn(F,x)).high<0)throw new za("NumberFormatError: Overflow")}var U=65535&i.low,P=i.low>>>16,L=65535&t.low,B=t.low>>>16,H=ga._mul(U,L),j=ga._mul(P,L),Y=ga._mul(U,B),z=H,G=(ga._mul(P,B)+(Y>>>16)|0)+(j>>>16)|0;if(z=z+(Y<<=16)|0,ga.ucompare(z,Y)<0){G++;G|=0}if(z=z+(j<<=16)|0,ga.ucompare(z,j)<0){G++;G|=0}G=G+(ga._mul(i.low,t.high)+ga._mul(i.high,t.low)|0)|0,i=new zn(G,z)}return n};var Sa=function(){this.buf=new I,this.cache=[],this.useCache=Sa.USE_CACHE,this.useEnumIndex=Sa.USE_ENUM_INDEX,this.shash=new Ma,this.scount=0};(n["haxe.Serializer"]=Sa).__name__=["haxe","Serializer"],Sa.run=function(e){var t=new Sa;return t.serialize(e),t.toString()},Sa.prototype={toString:function(){return this.buf.b},serializeString:function(e){var t=this.shash,n=null!=Io[e]?t.getReserved(e):t.h[e];if(null!=n)return this.buf.b+="R",void(this.buf.b+=null==n?"null":""+n);var i=this.shash,r=this.scount++;null!=Io[e]?i.setReserved(e,r):i.h[e]=r,this.buf.b+="y",e=encodeURIComponent(e),this.buf.b+=K.string(e.length),this.buf.b+=":",this.buf.b+=null==e?"null":""+e},serializeRef:function(e){for(var t=typeof e,n=0,i=this.cache.length;n<i;){var r=n++,a=this.cache[r];if(typeof a==t&&a==e)return this.buf.b+="r",this.buf.b+=null==r?"null":""+r,!0}return this.cache.push(e),!1},serializeFields:function(e){for(var t=0,n=z.fields(e);t<n.length;){var i=n[t];++t,this.serializeString(i),this.serialize(z.field(e,i))}this.buf.b+="g"},serialize:function(e){var t=ee.typeof(e);switch(t[1]){case 0:this.buf.b+="n";break;case 1:var n=e;if(0==n)return void(this.buf.b+="z");this.buf.b+="i",this.buf.b+=null==n?"null":""+n;break;case 2:var i=e;isNaN(i)?this.buf.b+="k":isFinite(i)?(this.buf.b+="d",this.buf.b+=null==i?"null":""+i):this.buf.b+=i<0?"m":"p";break;case 3:this.buf.b+=e?"t":"f";break;case 4:if(Ga.__instanceof(e,yo)){var r=ee.getClassName(e);this.buf.b+="A",this.serializeString(r)}else if(Ga.__instanceof(e,So))this.buf.b+="B",this.serializeString(ee.getEnumName(e));else{if(this.useCache&&this.serializeRef(e))return;this.buf.b+="o",this.serializeFields(e)}break;case 5:throw new za("Cannot serialize function");case 6:var a=t[2];if(a==String)return void this.serializeString(e);if(this.useCache&&this.serializeRef(e))return;switch(a){case Array:var o=0;this.buf.b+="a";for(var s=0,l=e.length;s<l;){var u=s++;null==e[u]?++o:(0<o&&(1==o?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==o?"null":""+o),o=0),this.serialize(e[u]))}0<o&&(1==o?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==o?"null":""+o)),this.buf.b+="h";break;case Date:var c=e;this.buf.b+="v",this.buf.b+=K.string(c.getTime());break;case $:this.buf.b+="l";for(var _=e.h;null!=_;){var h=_.item;_=_.next;var d=h;this.serialize(d)}this.buf.b+="h";break;case Da:this.buf.b+="q";for(var f=e,m=f.keys();m.hasNext();){var p=m.next();this.buf.b+=":",this.buf.b+=null==p?"null":""+p,this.serialize(f.h[p])}this.buf.b+="h";break;case ka:this.buf.b+="M";for(var g=e,v=g.keys();v.hasNext();){var y=v.next(),S=z.field(y,"__id__");z.deleteField(y,"__id__"),this.serialize(y),y.__id__=S,this.serialize(g.h[y.__id__])}this.buf.b+="h";break;case Ma:this.buf.b+="b";for(var w=e,I=w.keys();I.hasNext();){var T=I.next();this.serializeString(T),this.serialize(null!=Io[T]?w.getReserved(T):w.h[T])}this.buf.b+="h";break;case Ra:var E=e;this.buf.b+="s",this.buf.b+=K.string(Math.ceil(8*E.length/6)),this.buf.b+=":";var N=0,A=E.length-2,b=Sa.BASE64_CODES;if(null==b){var D=Sa.BASE64.length;b=new Array(D);for(var k=0,C=Sa.BASE64.length;k<C;){var O=k++;b[O]=tt.cca(Sa.BASE64,O)}Sa.BASE64_CODES=b}for(;N<A;){var M=E.b[N++],R=E.b[N++],F=E.b[N++];this.buf.b+=String.fromCharCode(b[M>>2]),this.buf.b+=String.fromCharCode(b[63&(M<<4|R>>4)]),this.buf.b+=String.fromCharCode(b[63&(R<<2|F>>6)]),this.buf.b+=String.fromCharCode(b[63&F])}if(N==A){var x=E.b[N++],U=E.b[N++];this.buf.b+=String.fromCharCode(b[x>>2]),this.buf.b+=String.fromCharCode(b[63&(x<<4|U>>4)]),this.buf.b+=String.fromCharCode(b[U<<2&63])}else if(N==1+A){var P=E.b[N++];this.buf.b+=String.fromCharCode(b[P>>2]),this.buf.b+=String.fromCharCode(b[P<<4&63])}break;default:this.useCache&&this.cache.pop(),null!=e.hxSerialize?(this.buf.b+="C",this.serializeString(ee.getClassName(a)),this.useCache&&this.cache.push(e),e.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(ee.getClassName(a)),this.useCache&&this.cache.push(e),this.serializeFields(e))}break;case 7:var L=t[2];if(this.useCache){if(this.serializeRef(e))return;this.cache.pop()}this.buf.b+=K.string(this.useEnumIndex?"j":"w"),this.serializeString(ee.getEnumName(L)),this.useEnumIndex?(this.buf.b+=":",this.buf.b+=K.string(e[1])):this.serializeString(e[0]),this.buf.b+=":";var B=e.length;this.buf.b+=K.string(B-2);for(var H=2,j=B;H<j;){var Y=H++;this.serialize(e[Y])}this.useCache&&this.cache.push(e);break;default:throw new za("Cannot serialize "+K.string(e))}},__class__:Sa};var wa=function(e){var t=this;this.id=setInterval(function(){t.run()},e)};(n["haxe.Timer"]=wa).__name__=["haxe","Timer"],wa.delay=function(e,t){var n=new wa(t);return n.run=function(){n.stop(),e()},n},wa.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:wa};function Ia(){}(n["haxe._Unserializer.DefaultResolver"]=Ia).__name__=["haxe","_Unserializer","DefaultResolver"],Ia.prototype={resolveClass:function(e){return ee.resolveClass(e)},resolveEnum:function(e){return ee.resolveEnum(e)},__class__:Ia};var Ta=function(e){this.buf=e,this.length=e.length,this.pos=0,this.scache=[],this.cache=[];var t=Ta.DEFAULT_RESOLVER;null==t&&(t=new Ia,Ta.DEFAULT_RESOLVER=t),this.resolver=t};(n["haxe.Unserializer"]=Ta).__name__=["haxe","Unserializer"],Ta.initCodes=function(){for(var e=[],t=0,n=Ta.BASE64.length;t<n;){var i=t++;e[Ta.BASE64.charCodeAt(i)]=i}return e},Ta.run=function(e){return new Ta(e).unserialize()},Ta.prototype={readDigits:function(){for(var e=0,t=!1,n=this.pos;;){var i=this.buf.charCodeAt(this.pos);if(i!=i)break;if(45!=i){if(i<48||57<i)break;e=10*e+(i-48),this.pos++}else{if(this.pos!=n)break;t=!0,this.pos++}}return t&&(e*=-1),e},readFloat:function(){for(var e=this.pos;;){var t=this.buf.charCodeAt(this.pos);if(t!=t)break;if(!(43<=t&&t<58||101==t||69==t))break;this.pos++}return parseFloat(tt.substr(this.buf,e,this.pos-e))},unserializeObject:function(e){for(;;){if(this.pos>=this.length)throw new za("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var t=this.unserialize();if("string"!=typeof t)throw new za("Invalid object key");var n=this.unserialize();e[t]=n}this.pos++},unserializeEnum:function(e,t){if(58!=this.buf.charCodeAt(this.pos++))throw new za("Invalid enum format");var n=this.readDigits();if(0==n)return ee.createEnum(e,t);for(var i=[];0<n--;)i.push(this.unserialize());return ee.createEnum(e,t,i)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var e=this.unserialize(),t=this.resolver.resolveClass(e);if(null==t)throw new za("Class not found "+e);return t;case 66:var n=this.unserialize(),i=this.resolver.resolveEnum(n);if(null==i)throw new za("Enum not found "+n);return i;case 67:var r=this.unserialize(),a=this.resolver.resolveClass(r);if(null==a)throw new za("Class not found "+r);var o=ee.createEmptyInstance(a);if(this.cache.push(o),o.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new za("Invalid custom data");return o;case 77:var s=new ka;this.cache.push(s);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var l=this.unserialize();s.set(l,this.unserialize())}return this.pos++,s;case 82:var u=this.readDigits();if(u<0||u>=this.scache.length)throw new za("Invalid string reference");return this.scache[u];case 97:this.buf;var c=[];for(this.cache.push(c);;){var _=this.buf.charCodeAt(this.pos);if(104==_){this.pos++;break}if(117==_){this.pos++;var h=this.readDigits();c[c.length+h-1]=null}else c.push(this.unserialize())}return c;case 98:var d=new Ma;this.cache.push(d);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var f=this.unserialize(),m=this.unserialize();null!=Io[f]?d.setReserved(f,m):d.h[f]=m}return this.pos++,d;case 99:var p=this.unserialize(),g=this.resolver.resolveClass(p);if(null==g)throw new za("Class not found "+p);var v=ee.createEmptyInstance(g);return this.cache.push(v),this.unserializeObject(v),v;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var y=this.unserialize(),S=this.resolver.resolveEnum(y);if(null==S)throw new za("Enum not found "+y);this.pos++;var w=this.readDigits(),I=S.__constructs__.slice()[w];if(null==I)throw new za("Unknown enum index "+y+"@"+w);var T=this.unserializeEnum(S,I);return this.cache.push(T),T;case 107:return NaN;case 108:var E=new $;this.cache.push(E);for(this.buf;104!=this.buf.charCodeAt(this.pos);)E.add(this.unserialize());return this.pos++,E;case 109:return-1/0;case 110:return null;case 111:var N={};return this.cache.push(N),this.unserializeObject(N),N;case 112:return 1/0;case 113:var A=new Da;this.cache.push(A);this.buf;for(var b=this.buf.charCodeAt(this.pos++);58==b;){var D=this.readDigits(),k=this.unserialize();A.h[D]=k,b=this.buf.charCodeAt(this.pos++)}if(104!=b)throw new za("Invalid IntMap format");return A;case 114:var C=this.readDigits();if(C<0||C>=this.cache.length)throw new za("Invalid reference");return this.cache[C];case 115:var O=this.readDigits(),M=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<O)throw new za("Invalid bytes length");var R=Ta.CODES;null==R&&(R=Ta.initCodes(),Ta.CODES=R);for(var F=this.pos,x=3&O,U=F+(O-x),P=new Ra(new ArrayBuffer(3*(O>>2)+(2<=x?x-1:0))),L=0;F<U;){var B=R[M.charCodeAt(F++)],H=R[M.charCodeAt(F++)];P.b[L++]=255&(B<<2|H>>4);var j=R[M.charCodeAt(F++)];P.b[L++]=255&(H<<4|j>>2);var Y=R[M.charCodeAt(F++)];P.b[L++]=255&(j<<6|Y)}if(2<=x){var z=R[M.charCodeAt(F++)],G=R[M.charCodeAt(F++)];if(P.b[L++]=255&(z<<2|G>>4),3==x){var K=R[M.charCodeAt(F++)];P.b[L++]=255&(G<<4|K>>2)}}return this.pos+=O,this.cache.push(P),P;case 116:return!0;case 118:var W;if(48<=this.buf.charCodeAt(this.pos)&&this.buf.charCodeAt(this.pos)<=57&&48<=this.buf.charCodeAt(this.pos+1)&&this.buf.charCodeAt(this.pos+1)<=57&&48<=this.buf.charCodeAt(this.pos+2)&&this.buf.charCodeAt(this.pos+2)<=57&&48<=this.buf.charCodeAt(this.pos+3)&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4))W=tt.strDate(tt.substr(this.buf,this.pos,19)),this.pos+=19;else{var V=this.readFloat();W=new Date(V)}return this.cache.push(W),W;case 119:var q=this.unserialize(),Q=this.resolver.resolveEnum(q);if(null==Q)throw new za("Enum not found "+q);var J=this.unserializeEnum(Q,this.unserialize());return this.cache.push(J),J;case 120:throw za.wrap(this.unserialize());case 121:var X=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<X)throw new za("Invalid string length");var Z=tt.substr(this.buf,this.pos,X);return this.pos+=X,Z=decodeURIComponent(Z.split("+").join(" ")),this.scache.push(Z),Z;case 122:return 0}throw this.pos--,new za("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:Ta};function Ea(){}(n["haxe.ds.BalancedTree"]=Ea).__name__=["haxe","ds","BalancedTree"],Ea.prototype={set:function(e,t){this.root=this.setLoop(e,t,this.root)},get:function(e){for(var t=this.root;null!=t;){var n=this.compare(e,t.key);if(0==n)return t.value;t=n<0?t.left:t.right}return null},remove:function(e){try{return this.root=this.removeLoop(e,this.root),!0}catch(e){if(e instanceof za&&(e=e.val),Ga.__instanceof(e,String))return!1;throw e}},keys:function(){var e=[];return this.keysLoop(this.root,e),tt.iter(e)},setLoop:function(e,t,n){if(null==n)return new Na(null,e,t,null);var i=this.compare(e,n.key);if(0==i)return new Na(n.left,e,t,n.right,null==n?0:n._height);if(i<0){var r=this.setLoop(e,t,n.left);return this.balance(r,n.key,n.value,n.right)}var a=this.setLoop(e,t,n.right);return this.balance(n.left,n.key,n.value,a)},removeLoop:function(e,t){if(null==t)throw new za("Not_found");var n=this.compare(e,t.key);return 0==n?this.merge(t.left,t.right):n<0?this.balance(this.removeLoop(e,t.left),t.key,t.value,t.right):this.balance(t.left,t.key,t.value,this.removeLoop(e,t.right))},keysLoop:function(e,t){null!=e&&(this.keysLoop(e.left,t),t.push(e.key),this.keysLoop(e.right,t))},merge:function(e,t){if(null==e)return t;if(null==t)return e;var n=this.minBinding(t);return this.balance(e,n.key,n.value,this.removeMinBinding(t))},minBinding:function(e){if(null==e)throw new za("Not_found");return null==e.left?e:this.minBinding(e.left)},removeMinBinding:function(e){return null==e.left?e.right:this.balance(this.removeMinBinding(e.left),e.key,e.value,e.right)},balance:function(e,t,n,i){var r=null==e?0:e._height,a=null==i?0:i._height;if(a+2<r){var o=e.left,s=e.right;return(null==o?0:o._height)>=(null==s?0:s._height)?new Na(e.left,e.key,e.value,new Na(e.right,t,n,i)):new Na(new Na(e.left,e.key,e.value,e.right.left),e.right.key,e.right.value,new Na(e.right.right,t,n,i))}if(r+2<a){var l=i.right,u=i.left;return(null==l?0:l._height)>(null==u?0:u._height)?new Na(new Na(e,t,n,i.left),i.key,i.value,i.right):new Na(new Na(e,t,n,i.left.left),i.left.key,i.left.value,new Na(i.left.right,i.key,i.value,i.right))}return new Na(e,t,n,i,(a<r?r:a)+1)},compare:function(e,t){return z.compare(e,t)},__class__:Ea};var Na=function(e,t,n,i,r){if(null==r&&(r=-1),this.left=e,this.key=t,this.value=n,this.right=i,-1==r){var a,o=this.left,s=this.right;if((null==o?0:o._height)>(null==s?0:s._height)){var l=this.left;a=null==l?0:l._height}else{var u=this.right;a=null==u?0:u._height}this._height=a+1}else this._height=r};(n["haxe.ds.TreeNode"]=Na).__name__=["haxe","ds","TreeNode"],Na.prototype={__class__:Na};var Aa=n["haxe.ds.Either"]={__ename__:["haxe","ds","Either"],__constructs__:["Left","Right"]};Aa.Left=function(e){var t=["Left",0,e];return t.__enum__=Aa,t.toString=s,t},Aa.Right=function(e){var t=["Right",1,e];return t.__enum__=Aa,t.toString=s,t},Aa.__empty_constructs__=[];var ba=function(){Ea.call(this)};(n["haxe.ds.EnumValueMap"]=ba).__name__=["haxe","ds","EnumValueMap"],ba.__interfaces__=[pa],ba.__super__=Ea,ba.prototype=i(Ea.prototype,{compare:function(e,t){var n=e[1]-t[1];if(0!=n)return n;var i=e.slice(2),r=t.slice(2);return 0==i.length&&0==r.length?0:this.compareArgs(i,r)},compareArgs:function(e,t){var n=e.length-t.length;if(0!=n)return n;for(var i=0,r=e.length;i<r;){var a=i++,o=this.compareArg(e[a],t[a]);if(0!=o)return o}return 0},compareArg:function(e,t){return z.isEnumValue(e)&&z.isEnumValue(t)?this.compare(e,t):e instanceof Array&&null==e.__enum__&&t instanceof Array&&null==t.__enum__?this.compareArgs(e,t):z.compare(e,t)},__class__:ba});var Da=function(){this.h={}};(n["haxe.ds.IntMap"]=Da).__name__=["haxe","ds","IntMap"],Da.__interfaces__=[pa],Da.prototype={remove:function(e){return!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(0|t);return tt.iter(e)},__class__:Da};var ka=function(){this.h={__keys__:{}}};(n["haxe.ds.ObjectMap"]=ka).__name__=["haxe","ds","ObjectMap"],ka.__interfaces__=[pa],ka.assignId=function(e){return e.__id__=++ka.count},ka.getId=function(e){return e.__id__},ka.prototype={set:function(e,t){var n=e.__id__||(e.__id__=++ka.count);this.h[n]=t,this.h.__keys__[n]=e},keys:function(){var e=[];for(var t in this.h.__keys__)this.h.hasOwnProperty(t)&&e.push(this.h.__keys__[t]);return tt.iter(e)},__class__:ka};var Ca=n["haxe.ds.Option"]={__ename__:["haxe","ds","Option"],__constructs__:["Some","None"]};Ca.Some=function(e){var t=["Some",0,e];return t.__enum__=Ca,t.toString=s,t},Ca.None=["None",1],Ca.None.toString=s,(Ca.None.__enum__=Ca).__empty_constructs__=[Ca.None];var Oa=function(e,t){this.map=e,this.keys=t,this.index=0,this.count=t.length};(n["haxe.ds._StringMap.StringMapIterator"]=Oa).__name__=["haxe","ds","_StringMap","StringMapIterator"],Oa.prototype={hasNext:function(){return this.index<this.count},next:function(){var e=this.map,t=this.keys[this.index++];return null!=Io[t]?e.getReserved(t):e.h[t]},__class__:Oa};var Ma=function(){this.h={}};(n["haxe.ds.StringMap"]=Ma).__name__=["haxe","ds","StringMap"],Ma.__interfaces__=[pa],Ma.prototype={setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},getReserved:function(e){return null==this.rh?null:this.rh["$"+e]},existsReserved:function(e){return null!=this.rh&&this.rh.hasOwnProperty("$"+e)},remove:function(e){return null!=Io[e]?(e="$"+e,!(null==this.rh||!this.rh.hasOwnProperty(e))&&(delete this.rh[e],!0)):!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){return tt.iter(this.arrayKeys())},arrayKeys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(t);if(null!=this.rh)for(var t in this.rh)36==t.charCodeAt(0)&&e.push(t.substr(1));return e},iterator:function(){return new Oa(this,this.arrayKeys())},__class__:Ma};var Ra=function(e){this.length=e.byteLength,this.b=new Uint8Array(e),(this.b.bufferValue=e).hxBytes=this,e.bytes=this.b};(n["haxe.io.Bytes"]=Ra).__name__=["haxe","io","Bytes"],Ra.alloc=function(e){return new Ra(new ArrayBuffer(e))},Ra.ofString=function(e){for(var t=[],n=0;n<e.length;){var i=e.charCodeAt(n++);55296<=i&&i<=56319&&(i=i-55232<<10|1023&e.charCodeAt(n++)),i<=127?t.push(i):(i<=2047?t.push(192|i>>6):(i<=65535?t.push(224|i>>12):(t.push(240|i>>18),t.push(128|i>>12&63)),t.push(128|i>>6&63)),t.push(128|63&i))}return new Ra(new Uint8Array(t).buffer)},Ra.ofData=function(e){var t=e.hxBytes;return null!=t?t:new Ra(e)},Ra.fastGet=function(e,t){return e.bytes[t]},Ra.prototype={getString:function(e,t){if(e<0||t<0||e+t>this.length)throw new za(Ha.OutsideBounds);for(var n="",i=this.b,r=String.fromCharCode,a=e,o=e+t;a<o;){var s=i[a++];if(s<128){if(0==s)break;n+=r(s)}else if(s<224)n+=r((63&s)<<6|127&i[a++]);else if(s<240){n+=r((31&s)<<12|(127&i[a++])<<6|127&i[a++])}else{var l=(15&s)<<18|(127&i[a++])<<12|(127&i[a++])<<6|127&i[a++];n+=r(55232+(l>>10)),n+=r(1023&l|56320)}}return n},toString:function(){return this.getString(0,this.length)},__class__:Ra};function Fa(){this.b=[]}(n["haxe.io.BytesBuffer"]=Fa).__name__=["haxe","io","BytesBuffer"],Fa.prototype={getBytes:function(){var e=new Ra(new Uint8Array(this.b).buffer);return this.b=null,e},__class__:Fa};function xa(){}(n["haxe.io.Input"]=xa).__name__=["haxe","io","Input"],xa.prototype={readByte:function(){throw new za("Not implemented")},readBytes:function(e,t,n){var i=n,r=e.b;if(t<0||n<0||t+n>e.length)throw new za(Ha.OutsideBounds);try{for(;0<i;)r[t]=this.readByte(),++t,--i}catch(e){if(e instanceof za&&(e=e.val),!Ga.__instanceof(e,Ba))throw e}return n-i},set_bigEndian:function(e){return this.bigEndian=e},read:function(e){for(var t=new Ra(new ArrayBuffer(e)),n=0;0<e;){var i=this.readBytes(t,n,e);if(0==i)throw new za(Ha.Blocked);n+=i,e-=i}return t},readFloat:function(){return ja.i32ToFloat(this.readInt32())},readDouble:function(){var e=this.readInt32(),t=this.readInt32();return this.bigEndian?ja.i64ToDouble(t,e):ja.i64ToDouble(e,t)},readInt8:function(){var e=this.readByte();return 128<=e?e-256:e},readInt16:function(){var e=this.readByte(),t=this.readByte(),n=this.bigEndian?t|e<<8:e|t<<8;return 0!=(32768&n)?n-65536:n},readUInt16:function(){var e=this.readByte(),t=this.readByte();return this.bigEndian?t|e<<8:e|t<<8},readInt32:function(){var e=this.readByte(),t=this.readByte(),n=this.readByte(),i=this.readByte();return this.bigEndian?i|n<<8|t<<16|e<<24:e|t<<8|n<<16|i<<24},__class__:xa};function Ua(e,t,n){if(null==t&&(t=0),null==n&&(n=e.length-t),t<0||n<0||t+n>e.length)throw new za(Ha.OutsideBounds);this.b=e.b,this.pos=t,this.len=n,this.totlen=n}(n["haxe.io.BytesInput"]=Ua).__name__=["haxe","io","BytesInput"],Ua.__super__=xa,Ua.prototype=i(xa.prototype,{readByte:function(){if(0==this.len)throw new za(new Ba);return this.len--,this.b[this.pos++]},readBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw new za(Ha.OutsideBounds);if(0==this.len&&0<n)throw new za(new Ba);this.len<n&&(n=this.len);for(var i=this.b,r=e.b,a=0,o=n;a<o;){var s=a++;r[t+s]=i[this.pos+s]}return this.pos+=n,this.len-=n,n},__class__:Ua});function Pa(){}(n["haxe.io.Output"]=Pa).__name__=["haxe","io","Output"],Pa.prototype={writeByte:function(e){throw new za("Not implemented")},writeBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw new za(Ha.OutsideBounds);for(var i=e.b,r=n;0<r;)this.writeByte(i[t]),++t,--r;return n},set_bigEndian:function(e){return this.bigEndian=e},write:function(e){for(var t=e.length,n=0;0<t;){var i=this.writeBytes(e,n,t);if(0==i)throw new za(Ha.Blocked);n+=i,t-=i}},writeFloat:function(e){this.writeInt32(ja.floatToI32(e))},writeDouble:function(e){var t=ja.doubleToI64(e);this.bigEndian?(this.writeInt32(t.high),this.writeInt32(t.low)):(this.writeInt32(t.low),this.writeInt32(t.high))},writeInt8:function(e){if(e<-128||128<=e)throw new za(Ha.Overflow);this.writeByte(255&e)},writeInt16:function(e){if(e<-32768||32768<=e)throw new za(Ha.Overflow);this.writeUInt16(65535&e)},writeUInt16:function(e){if(e<0||65536<=e)throw new za(Ha.Overflow);this.bigEndian?(this.writeByte(e>>8),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8))},writeInt32:function(e){this.bigEndian?(this.writeByte(e>>>24),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8&255),this.writeByte(e>>16&255),this.writeByte(e>>>24))},__class__:Pa};function La(){this.b=new Fa}(n["haxe.io.BytesOutput"]=La).__name__=["haxe","io","BytesOutput"],La.__super__=Pa,La.prototype=i(Pa.prototype,{writeByte:function(e){this.b.b.push(e)},writeBytes:function(e,t,n){var i=this.b;if(t<0||n<0||t+n>e.length)throw new za(Ha.OutsideBounds);i.b;for(var r=e.b,a=t,o=t+n;a<o;){var s=a++;i.b.push(r[s])}return n},getBytes:function(){return this.b.getBytes()},__class__:La});var Ba=function(){};(n["haxe.io.Eof"]=Ba).__name__=["haxe","io","Eof"],Ba.prototype={toString:function(){return"Eof"},__class__:Ba};var Ha=n["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};Ha.Blocked=["Blocked",0],Ha.Blocked.toString=s,(Ha.Blocked.__enum__=Ha).Overflow=["Overflow",1],Ha.Overflow.toString=s,(Ha.Overflow.__enum__=Ha).OutsideBounds=["OutsideBounds",2],Ha.OutsideBounds.toString=s,(Ha.OutsideBounds.__enum__=Ha).Custom=function(e){var t=["Custom",3,e];return t.__enum__=Ha,t.toString=s,t},Ha.__empty_constructs__=[Ha.Blocked,Ha.Overflow,Ha.OutsideBounds];var ja=function(){};(n["haxe.io.FPHelper"]=ja).__name__=["haxe","io","FPHelper"],ja.i32ToFloat=function(e){var t=e>>>23&255,n=8388607&e;return 0==n&&0==t?0:(1-(e>>>31<<1))*(1+Math.pow(2,-23)*n)*Math.pow(2,t-127)},ja.floatToI32=function(e){if(0==e)return 0;var t=e<0?-e:e,n=Math.floor(Math.log(t)/.6931471805599453);n<-127?n=-127:128<n&&(n=128);var i=Math.round(8388608*(t/Math.pow(2,n)-1));return 8388608==i&&n<128&&(i=0,++n),(e<0?-2147483648:0)|n+127<<23|i},ja.i64ToDouble=function(e,t){var n=(t>>20&2047)-1023,i=4294967296*(1048575&t)+2147483648*(e>>>31)+(2147483647&e);return 0==i&&-1023==n?0:(1-(t>>>31<<1))*(1+Math.pow(2,-52)*i)*Math.pow(2,n)},ja.doubleToI64=function(e){var t=ja.i64tmp;if(0==e)t.low=0,t.high=0;else if(isFinite(e)){var n=e<0?-e:e,i=Math.floor(Math.log(n)/.6931471805599453),r=Math.round(4503599627370496*(n/Math.pow(2,i)-1)),a=0|r,o=r/4294967296|0;t.low=a,t.high=(e<0?-2147483648:0)|i+1023<<20|o}else 0<e?(t.low=0,t.high=2146435072):(t.low=0,t.high=-1048576);return t};var Ya=function(){};(n["haxe.rtti.Meta"]=Ya).__name__=["haxe","rtti","Meta"],Ya.getMeta=function(e){return e.__meta__},Ya.getFields=function(e){var t=Ya.getMeta(e);return null==t||null==t.fields?{}:t.fields};var za=function(e){Error.call(this),this.val=e,this.message=String(e),Error.captureStackTrace&&Error.captureStackTrace(this,za)};(n["js._Boot.HaxeError"]=za).__name__=["js","_Boot","HaxeError"],za.wrap=function(e){return e instanceof Error?e:new za(e)},za.__super__=Error,za.prototype=i(Error.prototype,{__class__:za});var Ga=function(){};(n["js.Boot"]=Ga).__name__=["js","Boot"],Ga.getClass=function(e){if(e instanceof Array&&null==e.__enum__)return Array;var t=e.__class__;if(null!=t)return t;var n=Ga.__nativeClassName(e);return null!=n?Ga.__resolveNativeClass(n):null},Ga.__string_rec=function(e,t){if(null==e)return"null";if(5<=t.length)return"<...>";var n=typeof e;switch("function"==n&&(e.__name__||e.__ename__)&&(n="object"),n){case"function":return"<function>";case"object":if(e instanceof Array){if(e.__enum__){if(2==e.length)return e[0];var i=e[0]+"(";t+="\t";for(var r=2,a=e.length;r<a;){var o=r++;i+=2!=o?","+Ga.__string_rec(e[o],t):Ga.__string_rec(e[o],t)}return i+")"}var s="[";t+="\t";for(var l=0,u=e.length;l<u;){var c=l++;s+=(0<c?",":"")+Ga.__string_rec(e[c],t)}return s+="]"}var _;try{_=e.toString}catch(e){return"???"}if(null!=_&&_!=Object.toString&&"function"==typeof _){var h=e.toString();if("[object Object]"!=h)return h}var d=null,f="{\n";t+="\t";var m=null!=e.hasOwnProperty;for(var d in e)m&&!e.hasOwnProperty(d)||"prototype"!=d&&"__class__"!=d&&"__super__"!=d&&"__interfaces__"!=d&&"__properties__"!=d&&(2!=f.length&&(f+=", \n"),f+=t+d+" : "+Ga.__string_rec(e[d],t));return f+="\n"+(t=t.substring(1))+"}";case"string":return e;default:return String(e)}},Ga.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;var n=e.__interfaces__;if(null!=n)for(var i=0,r=n.length;i<r;){var a=n[i++];if(a==t||Ga.__interfLoop(a,t))return!0}return Ga.__interfLoop(e.__super__,t)},Ga.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array&&null==e.__enum__;case vo:return"boolean"==typeof e;case po:return!0;case go:return"number"==typeof e;case mo:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(e instanceof t)return!0;if(Ga.__interfLoop(Ga.getClass(e),t))return!0}else if("object"==typeof t&&Ga.__isNativeObj(t)&&e instanceof t)return!0;return t==yo&&null!=e.__name__||(t==So&&null!=e.__ename__||e.__enum__==t)}},Ga.__cast=function(e,t){if(Ga.__instanceof(e,t))return e;throw new za("Cannot cast "+K.string(e)+" to "+K.string(t))},Ga.__nativeClassName=function(e){var t=Ga.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},Ga.__isNativeObj=function(e){return null!=Ga.__nativeClassName(e)},Ga.__resolveNativeClass=function(e){return t[e]};var Ka=require("fs"),Wa=require("https"),Va=require("os"),qa=require("path"),Qa=require("url"),Ja=require("buffer").Buffer,Xa=function(e,t){var n=new Ua(e);n.set_bigEndian(!0),this.o=this.decode(n,t)};(n["msgpack.Decoder"]=Xa).__name__=["msgpack","Decoder"],Xa.prototype={decode:function(e,t){try{var n=e.readByte();switch(n){case 192:return null;case 194:return!1;case 195:return!0;case 202:return e.readFloat();case 203:return e.readDouble();case 204:return e.readByte();case 205:return e.readUInt16();case 206:return e.readInt32();case 207:return new zn(e.readInt32(),e.readInt32());case 208:return e.readInt8();case 209:return e.readInt16();case 210:return e.readInt32();case 211:return new zn(e.readInt32(),e.readInt32());case 218:case 219:return e.read(218==n?e.readUInt16():e.readInt32()).toString();case 220:case 221:return this.readArray(e,220==n?e.readUInt16():e.readInt32(),t);case 222:case 223:return this.readMap(e,222==n?e.readUInt16():e.readInt32(),t);default:if(n<128)return n;if(n<144)return this.readMap(e,15&n,t);if(n<160)return this.readArray(e,15&n,t);if(n<192)return e.read(31&n).toString();if(223<n)return-256|n}}catch(e){if(e instanceof za&&(e=e.val),!Ga.__instanceof(e,Ba))throw e}return null},readArray:function(e,t,n){for(var i=[],r=0,a=t;r<a;){r++;i.push(this.decode(e,n))}return i},readMap:function(e,t,n){if(n){for(var i={},r=0,a=t;r<a;){r++;var o=this.decode(e,n),s=this.decode(e,n);i[o]=s}return i}for(var l=new ka,u=0,c=t;u<c;){u++;var _=this.decode(e,n),h=this.decode(e,n);l.set(_,h)}return l},getResult:function(){return this.o},__class__:Xa};var Za=function(e){this.o=new La,this.o.set_bigEndian(!0),this.encode(e)};(n["msgpack.Encoder"]=Za).__name__=["msgpack","Encoder"],Za.prototype={encode:function(e){var t=ee.typeof(e);switch(t[1]){case 0:this.o.writeByte(192);break;case 1:var n=e;n<-32?n<-32768?(this.o.writeByte(210),this.o.writeInt32(n)):n<-128?(this.o.writeByte(209),this.o.writeInt16(n)):(this.o.writeByte(208),this.o.writeInt8(n)):n<128?this.o.writeByte(255&n):n<256?(this.o.writeByte(204),this.o.writeByte(n)):n<65536?(this.o.writeByte(205),this.o.writeUInt16(n)):(this.o.writeByte(206),this.o.writeInt32(n));break;case 2:var i=e,r=Math.abs(i);1401298464324817e-60<r&&r<34028234663852886e22?(this.o.writeByte(202),this.o.writeFloat(i)):(this.o.writeByte(203),this.o.writeDouble(i));break;case 3:this.o.writeByte(e?195:194);break;case 4:var a=z.fields(e),o=nt.count(a);o<16?this.o.writeByte(128|o):o<65536?(this.o.writeByte(222),this.o.writeUInt16(o)):(this.o.writeByte(223),this.o.writeInt32(o));for(var s=0;s<a.length;){var l=a[s];++s;var u=Ra.ofString(l),c=u.length;c<32?this.o.writeByte(160|c):c<65536?(this.o.writeByte(218),this.o.writeUInt16(c)):(this.o.writeByte(219),this.o.writeInt32(c)),this.o.write(u),this.encode(z.field(e,l))}break;case 5:throw new za("Error: Function not supported");case 6:var _=t[2];switch(ee.getClassName(_)){case"Array":var h=e,d=h.length;d<16?this.o.writeByte(144|d):d<65536?(this.o.writeByte(220),this.o.writeUInt16(d)):(this.o.writeByte(221),this.o.writeInt32(d));for(var f=0;f<h.length;){var m=h[f];++f,this.encode(m)}break;case"Hash":var p=e,g=nt.count(p);g<16?this.o.writeByte(128|g):g<65536?(this.o.writeByte(222),this.o.writeUInt16(g)):(this.o.writeByte(223),this.o.writeInt32(g));for(var v=p.keys();v.hasNext();){var y=v.next(),S=Ra.ofString(y),w=S.length;w<32?this.o.writeByte(160|w):w<65536?(this.o.writeByte(218),this.o.writeUInt16(w)):(this.o.writeByte(219),this.o.writeInt32(w)),this.o.write(S),this.encode(null!=Io[y]?p.getReserved(y):p.h[y])}break;case"String":var I=Ra.ofString(e),T=I.length;T<32?this.o.writeByte(160|T):T<65536?(this.o.writeByte(218),this.o.writeUInt16(T)):(this.o.writeByte(219),this.o.writeInt32(T)),this.o.write(I);break;case"haxe._Int64.___Int64":var E=e;this.o.writeByte(E.high<0?211:207),this.o.writeInt32(E.high),this.o.writeInt32(E.low)}break;case 7:throw new za("Error: Enum not supported");case 8:throw new za("Error: Unknown Data Type")}},writeInt:function(e){e<-32?e<-32768?(this.o.writeByte(210),this.o.writeInt32(e)):e<-128?(this.o.writeByte(209),this.o.writeInt16(e)):(this.o.writeByte(208),this.o.writeInt8(e)):e<128?this.o.writeByte(255&e):e<256?(this.o.writeByte(204),this.o.writeByte(e)):e<65536?(this.o.writeByte(205),this.o.writeUInt16(e)):(this.o.writeByte(206),this.o.writeInt32(e))},writeInt64:function(e){this.o.writeByte(e.high<0?211:207),this.o.writeInt32(e.high),this.o.writeInt32(e.low)},writeFloat:function(e){var t=Math.abs(e);1401298464324817e-60<t&&t<34028234663852886e22?(this.o.writeByte(202),this.o.writeFloat(e)):(this.o.writeByte(203),this.o.writeDouble(e))},writeRaw:function(e){var t=e.length;t<32?this.o.writeByte(160|t):t<65536?(this.o.writeByte(218),this.o.writeUInt16(t)):(this.o.writeByte(219),this.o.writeInt32(t)),this.o.write(e)},writeArray:function(e){var t=e.length;t<16?this.o.writeByte(144|t):t<65536?(this.o.writeByte(220),this.o.writeUInt16(t)):(this.o.writeByte(221),this.o.writeInt32(t));for(var n=0;n<e.length;){var i=e[n];++n,this.encode(i)}},writeMapLength:function(e){e<16?this.o.writeByte(128|e):e<65536?(this.o.writeByte(222),this.o.writeUInt16(e)):(this.o.writeByte(223),this.o.writeInt32(e))},writeHashMap:function(e){var t=nt.count(e);t<16?this.o.writeByte(128|t):t<65536?(this.o.writeByte(222),this.o.writeUInt16(t)):(this.o.writeByte(223),this.o.writeInt32(t));for(var n=e.keys();n.hasNext();){var i=n.next(),r=Ra.ofString(i),a=r.length;a<32?this.o.writeByte(160|a):a<65536?(this.o.writeByte(218),this.o.writeUInt16(a)):(this.o.writeByte(219),this.o.writeInt32(a)),this.o.write(r),this.encode(null!=Io[i]?e.getReserved(i):e.h[i])}},writeObjectMap:function(e){var t=z.fields(e),n=nt.count(t);n<16?this.o.writeByte(128|n):n<65536?(this.o.writeByte(222),this.o.writeUInt16(n)):(this.o.writeByte(223),this.o.writeInt32(n));for(var i=0;i<t.length;){var r=t[i];++i;var a=Ra.ofString(r),o=a.length;o<32?this.o.writeByte(160|o):o<65536?(this.o.writeByte(218),this.o.writeUInt16(o)):(this.o.writeByte(219),this.o.writeInt32(o)),this.o.write(a),this.encode(z.field(e,r))}},getBytes:function(){return this.o.getBytes()},__class__:Za};function $a(){}(n["msgpack.MsgPack"]=$a).__name__=["msgpack","MsgPack"],$a.encode=function(e){return new Za(e).o.getBytes()},$a.decode=function(e,t){return null==t&&(t=!0),new Xa(e,t).o};function eo(){}(n["puremvc.interfaces.IController"]=eo).__name__=["puremvc","interfaces","IController"],eo.prototype={__class__:eo};var to=function(){(to.instance=this).commandMap=new Ma,this.initializeController()};(n["puremvc.core.Controller"]=to).__name__=["puremvc","core","Controller"],to.__interfaces__=[eo],to.getInstance=function(){return null==to.instance&&(to.instance=new to),to.instance},to.prototype={initializeController:function(){this.view=ao.getInstance()},executeCommand:function(e){var t=this.commandMap,n=e.getName(),i=null!=Io[n]?t.getReserved(n):t.h[n];null!=i&&ee.createInstance(i,[]).execute(e)},registerCommand:function(e,t){var n=this.commandMap;(null!=Io[e]?n.existsReserved(e):n.h.hasOwnProperty(e))||this.view.registerObserver(e,new uo(fo(this,this.executeCommand),this));var i=this.commandMap;null!=Io[e]?i.setReserved(e,t):i.h[e]=t},hasCommand:function(e){var t=this.commandMap;return null!=Io[e]?t.existsReserved(e):t.h.hasOwnProperty(e)},removeCommand:function(e){this.hasCommand(e)&&(this.view.removeObserver(e,this),this.commandMap.remove(e))},__class__:to};function no(){}(n["puremvc.interfaces.IModel"]=no).__name__=["puremvc","interfaces","IModel"],no.prototype={__class__:no};var io=function(){(io.instance=this).proxyMap=new Ma,this.initializeModel()};(n["puremvc.core.Model"]=io).__name__=["puremvc","core","Model"],io.__interfaces__=[no],io.getInstance=function(){return null==io.instance&&(io.instance=new io),io.instance},io.prototype={initializeModel:function(){},registerProxy:function(e){var t=this.proxyMap,n=e.getProxyName();null!=Io[n]?t.setReserved(n,e):t.h[n]=e,e.onRegister()},retrieveProxy:function(e){var t=this.proxyMap;return null!=Io[e]?t.getReserved(e):t.h[e]},hasProxy:function(e){var t=this.proxyMap;return null!=Io[e]?t.existsReserved(e):t.h.hasOwnProperty(e)},removeProxy:function(e){var t=this.proxyMap,n=null!=Io[e]?t.getReserved(e):t.h[e];return null!=n&&(this.proxyMap.remove(e),n.onRemove()),n},__class__:io};function ro(){}(n["puremvc.interfaces.IView"]=ro).__name__=["puremvc","interfaces","IView"],ro.prototype={__class__:ro};var ao=function(){(ao.instance=this).mediatorMap=new Ma,this.observerMap=new Ma,this.initializeView()};(n["puremvc.core.View"]=ao).__name__=["puremvc","core","View"],ao.__interfaces__=[ro],ao.getInstance=function(){return null==ao.instance&&(ao.instance=new ao),ao.instance},ao.prototype={initializeView:function(){},registerObserver:function(e,t){var n=this.observerMap;if(!(null!=Io[e]?n.existsReserved(e):n.h.hasOwnProperty(e))){var i=this.observerMap,r=new $;null!=Io[e]?i.setReserved(e,r):i.h[e]=r}var a=this.observerMap;(null!=Io[e]?a.getReserved(e):a.h[e]).add(t)},notifyObservers:function(e){var t=this.observerMap,n=e.getName();if(null!=Io[n]?t.existsReserved(n):t.h.hasOwnProperty(n)){for(var i=this.observerMap,r=e.getName(),a=null!=Io[r]?i.getReserved(r):i.h[r],o=new $,s=new c(a.h);s.hasNext();){var l=s.next();o.add(l)}for(var u=new c(o.h);u.hasNext();){u.next().notifyObserver(e)}}},removeObserver:function(e,t){for(var n=this.observerMap,i=null!=Io[e]?n.getReserved(e):n.h[e],r=i.h;null!=r;){var a=r.item;r=r.next;var o=a;if(1==o.compareNotifyContext(t)){i.remove(o);break}}i.isEmpty()&&this.observerMap.remove(e)},registerMediator:function(e){var t=this.mediatorMap,n=e.getMediatorName();if(null!=Io[n]?!t.existsReserved(n):!t.h.hasOwnProperty(n)){var i=this.mediatorMap,r=e.getMediatorName();null!=Io[r]?i.setReserved(r,e):i.h[r]=e;var a=e.listNotificationInterests();if(0<a.length)for(var o=new uo(fo(e,e.handleNotification),e),s=0,l=a.length;s<l;){var u=s++;this.registerObserver(a[u],o)}e.onRegister()}},retrieveMediator:function(e){var t=this.mediatorMap;return null!=Io[e]?t.getReserved(e):t.h[e]},removeMediator:function(e){var t=this.mediatorMap,n=null!=Io[e]?t.getReserved(e):t.h[e];if(null!=n){for(var i=n.listNotificationInterests(),r=0,a=i.length;r<a;){var o=r++;this.removeObserver(i[o],n)}this.mediatorMap.remove(e),n.onRemove()}return n},hasMediator:function(e){var t=this.mediatorMap;return null!=Io[e]?t.existsReserved(e):t.h.hasOwnProperty(e)},__class__:ao};function oo(){}(n["puremvc.interfaces.INotification"]=oo).__name__=["puremvc","interfaces","INotification"],oo.prototype={__class__:oo};function so(){}(n["puremvc.interfaces.IObserver"]=so).__name__=["puremvc","interfaces","IObserver"],so.prototype={__class__:so};var lo=function(e,t,n){this.name=e,null!=t&&(this.body=t),null!=n&&(this.type=n)};(n["puremvc.patterns.observer.Notification"]=lo).__name__=["puremvc","patterns","observer","Notification"],lo.__interfaces__=[oo],lo.prototype={getName:function(){return this.name},setBody:function(e){this.body=e},getBody:function(){return this.body},setType:function(e){this.type=e},getType:function(){return this.type},toString:function(){var e="Notification Name: "+this.getName();return e+="\nBody:"+(null==this.body?"null":this.body.toString()),e+="\nType:"+(null==this.type?"null":this.type)},__class__:lo};var uo=function(e,t){this.setNotifyMethod(e),this.setNotifyContext(t)};function co(e){return e instanceof Array?function(){return tt.iter(e)}:"function"==typeof e.iterator?fo(e,e.iterator):e.iterator}(n["puremvc.patterns.observer.Observer"]=uo).__name__=["puremvc","patterns","observer","Observer"],uo.__interfaces__=[so],uo.prototype={setNotifyMethod:function(e){this.notify=e},setNotifyContext:function(e){this.context=e},getNotifyMethod:function(){return this.notify},getNotifyContext:function(){return this.context},notifyObserver:function(e){this.getNotifyMethod()(e)},compareNotifyContext:function(e){return e==this.context},__class__:uo};var _o,ho=0;function fo(e,t){return null==t?null:(null==t.__id__&&(t.__id__=ho++),null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[t.__id__],null==n&&((n=function(){return n.method.apply(n.scope,arguments)}).scope=e,n.method=t,e.hx__closures__[t.__id__]=n),n);var n}n.Math=Math,String.prototype.__class__=n.String=String,String.__name__=["String"],n.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=n.Date=Date,Date.__name__=["Date"];var mo=n.Int={__name__:["Int"]},po=n.Dynamic={__name__:["Dynamic"]},go=n.Float=Number;go.__name__=["Float"];var vo=n.Bool=Boolean;vo.__ename__=["Bool"];var yo=n.Class={__name__:["Class"]},So={},wo={},Io={};p.APP_STATE_CHANGED="app_state_changed",p.ACCESS_TOKEN_CHANGED="access_token_changed",p.CURRENT_USER_CHANGED="current_user_changed",p.CONFIGURATION_CHANGED="configuration_changed",p.DOMAIN_SELECTION_CHANGED="domain_selection_changed",p.TALK_SELECTION_CHANGED="talk_selection_changed",p.TALK_LIST_SCROLL_TO_TALK_TOP_NEEDED="talk_list_scroll_to_talk_top_needed",p.USER_SELECTION_NEEDED="user_selection_needed",p.USER_SELECTION_CHANGED="user_selection_changed",p.FRIEND_SELECTION_NEEDED="friend_selection_needed",p.COMMON_STAMP_SET_LOADED="common_stamp_set_loaded",p.STAMP_SELECTION_STARTED="stamp_selection_started",p.STAMP_SELECTION_ENDED="stamp_selection_ended",p.STAMP_SELECTION_CHANGED="stamp_selection_changed",p.ACTION_SELECTION_CHANGED="action_selection_changed",p.CURRENT_PAGE_CHANGED="current_page_changed",p.CURRENT_PAGE_REASSIGNED="current_page_reassgined",p.FILEINFO_SELECTION_CHANGED="fileinfo_selection_changed",p.NOTE_FILEINFO_SELECTION_CHANGED="note_fileinfo_selection_changed",p.MESSAGE_FILEINFO_SELECTION_CHANGED="message_fileinfo_selection_changed",p.STAGED_FILEINFO_SELECTION_CHANGED="staged_fileinfo_selection_changed",p.STAGED_FILEINFOS_ADDED="staged_fileinfos_added",p.STAGED_FILEINFOS_MOVED="staged_fileinfos_moved",p.CLOSE_FILEPREVIEW_MODAL="close_filepreview_modal",p.ERROR_OCCURRED="error_occurred",p.UNREAD_COUNT_CHANGED="brand_badge_changed",p.SEND_FORM_TOP_CHANGED="send_form_top_changed",p.SOLUTIONS_LOADED="solutions_loaded",p.RIGHT_PANE_OPENED="right_pane_opened",p.RIGHT_PANE_CLOSED="right_pane_closed",p.PASSWORD_EXPIRATION_OVERED="password_expiration_overed",p.PASSWORD_EXPIRATION_WARNED="password_expiration_warned",p.PHOTO_EDITOR_SAVED="photo_editor_saved",p.MC_AUTHENTICATED_USER_RECEIVED="mc_authenticated_user_received",p.KEYWORD_WATCHING_UPDATED="keyword_watching_updated",p.KEYWORD_DETECTION_UPDATED="keyword_detaction_updated",p.SEND_BY_ENTER_CHANGED="send_by_enter_changed",p.DEPARTMENT_SELECTION_CHANGED_FOR_MEMBERS_PAGE="department_selection_changed_for_members_page",p.PRESENCES_UPDATED="presences_updated",p.NOTEINFO_SELECTION_CHANGED="noteinfo_selection_changed",p.START_NOTE_EDITING="start_note_editing",p.OPEN_EXISTING_PAIR_TALK_COMPLETED="open_existing_pair_talk_completed",p.DATA_RECOVERING="data_recovering",p.DATA_RECOVERED="data_recovered",p.NOTIFY_UPDATE_USER="notify_update_user",p.NOTIFY_ADD_FRIEND="notify_add_friend",p.NOTIFY_ADD_ACQUAINTANCE="notify_add_acquaintance",p.NOTIFY_ADD_ACQUAINTANCES="notify_add_acquaintances",p.NOTIFY_DELETE_FRIEND="notify_delete_friend",p.NOTIFY_DELETE_ACQUAINTANCE="notify_delete_acquaintance",p.NOTIFY_DELETE_ACQUAINTANCES="notify_delete_acquaintances",p.NOTIFY_UPDATE_DOMAIN_USERS="notify_update_domain_users",p.GET_DOMAIN_USERS_RESPONSED="get_domain_users_responsed",p.GET_USERS_RESPONSED="get_users_responsed",p.GET_PROFILE_RESPONSED="get_profile_responsed",p.GET_PROFILE_ERRORED="get_profile_errored",p.UPDATE_USER_RESPONSED="update_user_responsed",p.UPDATE_USER_ERRORED="update_user_errored",p.UPDATE_PROFILE_RESPONSED="update_profile_responsed",p.UPDATE_PROFILE_ERRORED="update_profile_errored",p.NOTIFY_UPDATE_DEPARTMENT_TREE="notify_update_department_tree",p.NOTIFY_UPDATE_DEPARTMENT_USERS="notify_update_department_users",p.GET_DEPARTMENT_TREE_RESPONSED="get_department_tree_responsed",p.GET_DEPARTMENT_TREE_CANCELED="get_department_tree_canceled",p.GET_DEPARTMENT_USERS_RESPONSED="get_department_users_responsed",p.GET_DEPARTMENT_USERS_CANCELED="get_department_users_canceled",p.GET_DEPARTMENT_USER_COUNT_RESPONSED="get_department_user_count_responsed",p.GET_ME_RESPONSED="get_me_responsed",p.DEPARTMENT_USER_COUNT_CLEARED="department_user_count_cleared",p.DEPARTMENT_USER_IDS_PREPARED="department_user_ids_prepared",p.NOTIFY_ADD_DOMAIN_INVITE="notify_add_domain_invite",p.NOTIFY_ACCEPT_DOMAIN_INVITE="notify_accept_domain_invite",p.NOTIFY_DELETE_DOMAIN_INVITE="notify_delete_domain_invite",p.NOTIFY_JOIN_DOMAIN="notify_join_domain",p.NOTIFY_UPDATE_DOMAIN="notify_update_domain",p.NOTIFY_LEAVE_DOMAIN="notify_leave_domain",p.NOTIFY_ADD_DOMAIN_MEMBERS="notify_add_domain_members",p.NOTIFY_CREATE_PAIR_TALK="notify_create_pair_talk",p.CREATE_PAIR_TALK_FAIL="create_pair_talk_fail",p.NOTIFY_CREATE_GROUP_TALK="notify_create_group_talk",p.CREATE_GROUP_TALK_FAIL="create_group_talk_fail",p.NOTIFY_UPDATE_GROUP_TALK="notify_update_group_talk",p.NOTIFY_UPDATE_GROUP_TALK_ERRORED="notify_update_group_talk_ERRORED",p.NOTIFY_ADD_TALKERS="notify_add_talkers",p.NOTIFY_ADD_TALKERS_INCLUDING_ME="notify_add_talkers_including_me",p.NOTIFY_DELETE_TALKER="notify_delete_talker",p.NOTIFY_DELETE_TALK="notify_delete_talk",p.NOTIFY_UPDATE_READ_STATUSES="notify_update_read_statuses",p.NOTIFY_UPDATE_TALK_STATUS="notify_update_talk_status",p.NOTIFY_UPDATE_LOCAL_TALK_STATUS="notify_update_local_talk_status",p.NOTIFY_ADD_FAVORITE_TALK="notify_add_favorite_talk",p.NOTIFY_DELETE_FAVORITE_TALK="notify_delete_favorite_talk",p.NOTIFY_DISABLE_PUSH_NOTIFICATION="notify_disable_push_notification",p.NOTIFY_ENABLE_PUSH_NOTIFICATION="notify_enable_push_notification",p.ADD_TALKERS_SUCCEEDED="add_talkers_succeeded",p.ADD_TALKERS_FAILED="add_talkers_failed",p.NOTIFY_CREATE_MESSAGE="notify_create_message",p.NOTIFY_DELETE_MESSAGE="notify_delete_message",p.NOTIFY_GET_MESSAGES="notify_get_messages",p.NOTIFY_GET_MESSAGE_READ_STATUS="notify_get_message_status",p.CREATE_MESSAGE_START="create_message_start",p.CREATE_MESSAGE_COMPLETE="create_message_complete",p.CREATE_MESSAGE_FAIL="create_message_fail",p.ADD_FAVORITE_MESSAGE_COMPLETED="add_favorite_message_completed",p.DELETE_FAVORITE_MESSAGE_COMPLETED="delete_favorite_message_completed",p.GET_FAVORITE_MESSAGES_COMPLETED="get_favorite_messages_completed",p.NOTIFY_ADD_FAVORITE_MESSAGE="notify_add_favorite_message",p.NOTIFY_DELETE_FAVORITE_MESSAGE="notify_delete_favorite_message",p.NOTIFY_CREATE_ANNOUNCEMENT="notify_create_announcement",p.NOTIFY_DELETE_ANNOUNCEMENT="notify_delete_announcement",p.NOTIFY_UPDATE_ANNOUNCEMENT_STATUS="notify_update_announcement_status",p.NOTIFY_GET_ANNOUNCEMENTS="notify_get_announcements",p.CREATE_ANNOUNCEMENT_START="create_announcement_start",p.CREATE_ANNOUNCEMENT_COMPLETE="create_announcement_complete",p.CREATE_ANNOUNCEMENT_FAIL="create_announcement_fail",p.NOTIFY_UPDATE_QUESTION="notify_update_question",p.NOTIFY_GET_QUESTIONS="get_questions_responsed",p.NOTIFY_CREATE_ATTACHMENT="notify_create_attachment",p.NOTIFY_DELETE_ATTACHMENT="notify_delete_attachment",p.GET_FILE_RESPONSED="get_file_responsed",p.GET_NOTE_STATUSES_LOADED="get_note_statuses_loaded",p.GET_NOTE_LOADED="get_note_loaded",p.GET_NOTE_FAILED_BY_NOTE_NOT_FOUND="get_note_failed_by_note_not_found",p.CREATE_NOTE_COMPLETED="create_note_completed",p.CREATE_NOTE_FAILED="create_note_failed",p.UPDATE_NOTE_LOCAL_EDIT="update_note_local_edit",p.CLEAR_NOTE_LOCAL_EDIT="clear_note_local_edit",p.UPDATE_NOTE_SETTING_COMPLETED="update_note_setting_completed",p.UPDATE_NOTE_SETTING_FAILED_BY_NOT_FOUND="update_note_setting_failed_by_not_found",p.UPDATE_NOTE_SETTING_FAILED_BY_CONFLICT="update_note_setting_failed_by_conflict",p.UPDATE_NOTE_SETTING_FAILED_BY_EDITING="update_note_setting_failed_by_editing",p.UPDATE_NOTE_COMPLETED="update_note_completed",p.DELETE_NOTE_COMPLETED="delete_note_completed",p.NOTIFY_CREATE_NOTE="notify_create_note",p.NOTIFY_UPDATE_NOTE_PARTIALLY="notify_update_note_partially",p.NOTIFY_DELETE_NOTE="notify_delete_note",p.NOTIFY_UPDATE_NOTE_FOR_SETTING="notify_update_note_for_setting",p.NOTIFY_UPDATE_NOTE_FOR_SUMMARY="notify_update_note_for_revision",p.CREATE_NOTE_BUTTON_CLICKED="create_note_button_clicked",p.NOTIFY_LOCK_NOTE="notify_lock_note",p.NOTIFY_UNLOCK_NOTE="notify_unlock_note",p.NOTIFY_SEARCH_MESSAGES="notify_search_messages",p.NOTIFY_SEARCH_ATTACHMENTS="notify_search_attachments",p.NOTIFY_SEARCH_MESSAGES_FAIL="notify_search_messages_fail",p.NOTIFY_SEARCH_ATTACHMENTS_FAIL="notify_search_attachments_fail",p.NOTIFY_SEARCH_PREPARE="notify_search_prepare",p.NOTIFY_SEARCH_CLEAR="notify_search_clear",p.NOTIFY_FILTER_BOX_TEXT_CHANGED="notify_filter_box_text_changed",p.NOTIFY_SEARCH_BOX_POPUP="notify_search_box_popup",p.NOTIFY_ADD_ACCOUNT_CONTROL_REQUEST="notify_add_account_control_request",p.NOTIFY_DELETE_ACCOUNT_CONTROL_REQUEST="notify_delete_account_control_request",p.NOTIFY_JOIN_ACCOUNT_CONTROL_GROUP="notify_join_account_control_group",p.NOTIFY_UPDATE_ACCOUNT_CONTROL_GROUP_PARTIALLY="notify_update_account_control_group_partially",p.NOTIFY_LEAVE_ACCOUNT_CONTROL_GROUP="notify_leave_account_control_group",p.PREPARE_CONFERENCE_FROM_MESSAGE="prepare_conference_from_message",p.JOIN_CONFERENCE_RESPONSED="join_conference_responsed",p.JOIN_CONFERENCE_CANCELED="join_conference_canceled",p.NOTIFY_OPEN_CONFERENCE="notify_open_conference",p.NOTIFY_CLOSE_CONFERENCE="notify_close_conference",p.NOTIFY_CONFERENCE_PARTICIPANT_JOIN="notify_conference_participant_join",p.NOTIFY_CONFERENCE_PARTICIPANT_LIMIT="notify_conference_participant_limit",p.NOTIFY_CONFERENCE_PARTICIPANT_REJECT="notify_conference_participant_reject",p.NOTIFY_ALL_TALK_MEMBERS_REJECTED_CONFERENCE="notify_all_talk_members_rejected_conference",p.NOTIFY_UPDATE_DOMAIN_STAMP_SETTING="notify_update_domain_stampsetting",p.NOTIFY_UPDATE_STAMPSET="notify_update_stampset",p.NOTIFY_DELETE_STAMPSET="notify_delete_stampset",p.START_NOTIFICATION_FAILED="start_notification_failed",M.ANNOUNCEMENTS_KEY="-1",B.__meta__={fields:{api:{inject:null}}},B.NAME="AccountControlRequest",j.__meta__={fields:{api:{inject:null},conferenceStore:{inject:null}}},j.NAME="Conference",G.__meta__={fields:{api:{inject:null}}},G.NAME="Device",Q.__meta__={fields:{api:{inject:null}}},Q.NAME="Domain",X.__meta__={fields:{api:{inject:null},dataStore:{inject:null},fileService:{inject:null}}},X.NAME="File",te.__meta__={fields:{api:{inject:null},stampsStore:{inject:null}}},te.NAME="LoadStampset",te.STAMP_VERSION=1,te.TAB_URL="./json/app_ja.json?version=1",te.TAB_PANE_URL="./json/illust_category_ja.json?version=1",re.__meta__={fields:{api:{inject:null}}},re.NAME="ManageFriends",oe.__meta__={fields:{api:{inject:null}}},oe.NAME="Message",le.__meta__={fields:{api:{inject:null},dataStore:{inject:null},fileService:{inject:null},fileInfoStore:{inject:null}}},le.NAME="Note",ce.__meta__={fields:{api:{inject:null},keywordWatcher:{inject:null},readStatusUpdater:{inject:null}}},ce.NAME="Read",he.__meta__={fields:{api:{inject:null}}},he.NAME="ReloadData",fe.__meta__={fields:{api:{inject:null},searchService:{inject:null}}},fe.NAME="Search",pe.__meta__={fields:{dataStore:{inject:null},settings:{inject:null}}},pe.NAME="SelectTalk",ve.__meta__={fields:{api:{inject:null}}},ve.NAME="Send",ye.__meta__={fields:{accessTokenResolver:{inject:null},session:{inject:null}}},ye.NAME="SignIn",Se.__meta__={fields:{api:{inject:null},settings:{inject:null},dataStore:{inject:null}}},Se.NAME="SignOut",we.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},we.NAME="Talk",Te.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},Te.NAME="UpdateProfile",Ee.__meta__={fields:{api:{inject:null}}},Ee.NAME="UpdateUser",Ne.__meta__={fields:{userPresences:{inject:null},api:{inject:null},settings:{inject:null}}},Ne.NAME="UpdateUserPresences",Ne.MAX_USERS_PER_API=100,Ae.__meta__={fields:{routing:{inject:null}}},Ae.NAME="Url",Fe.TalkAutoScrollDelay=1,Fe.TalkAutoScrollImmediately=2,Fe.TalkAutoScrollNone=3,Fe.NAME="browser_settings",Ue.MAX_SIZE=72,ht.INCOMING_TIME=6e4,Pe.DEFAULT_PRESENCE_EXPIRATION=3e5,Be.DEFAULT_TTL=3600,Be.DEFAULT_MAX_PARTICIPANTS=8,Nt.TIMESTAMP_SHIFT=22,Mt.MAX_READ_USER_IDS_COUNT=16,an.QUERY_DATE_TODAY="t",an.QUERY_DATE_YESTERDAY="-1d",an.QUERY_DATE_THREE_DAYS_BEFORE="-3d",vn.HISTORY_TAB_NAME="stamp-history",Gn.SIXTY_MINUTES=new zn(0,36e5),Gn.FIFTEEN_MINUTES=new zn(0,9e5),Si.PREFIX="note-",Si.nextDummyId=new zn(-1,-1),Ei.CONTINUE_MARGIN_RATE=.1,xi.CHEKBOX_UNCHECKED="- [ ] ",xi.CHEKBOX_CHECKED="- [x] ",Pi.TU_REG=new y("([BCDFGHIJKLMNOPQRSTUVWYZ])","gm"),Pi.XTU_REG=new y("","gm"),ji.EMERGENCY=0,ji.ALERT=1,ji.CRITICAL=2,ji.ERROR=3,ji.WARNING=4,ji.NOTICE=5,ji.INFO=6,ji.DEBUG=7,ji.level=ji.getLogLevel(process.env.HUBOT_LOG_LEVEL),ji._d=7<=ji.level&&null!=console?console.log.bind(console):ji._nop,ji._i=6<=ji.level&&null!=console?console.info.bind(console):ji._nop,ji._w=4<=ji.level&&null!=console?console.warn.bind(console):ji._nop,ji._e=3<=ji.level&&null!=console?console.error.bind(console):ji._nop,Vi.HIRAGANA_SMALL_A=12353,Vi.HIRAGANA_NN=12435,Vi.KATAKANA_SMALL_A=12449,$i.NAME="accessTokenResolver",er.NAME="Proxy",tr.__meta__={fields:{settings:{inject:null},accountLoader:{inject:null},api:{inject:null}}},ir.NAME="accountLoader",ar.__meta__={fields:{api:{inject:null},dataStore:{inject:null},settings:{inject:null},fileInfoStore:{inject:null},departmentStore:{inject:null},messageStore:{inject:null},dataFactory:{inject:null},keywordWatcher:{inject:null},conferenceStore:{inject:null},stampsStore:{inject:null}}},ar.NAME="broadcast",or.__meta__={fields:{apiCaller:{inject:null},apiNote:{inject:null},settings:{inject:null},dataStore:{inject:null},dataFactory:{inject:null},fileService:{inject:null},searchService:{inject:null},fileInfoStore:{inject:null},messageStore:{inject:null},departmentStore:{inject:null},conferenceStore:{inject:null},lastUsedAtUpdater:{inject:null},stampsStore:{inject:null}}},or.NAME="api",or.API_VERSION="1.113",or.UPDATE_VERSION="1.113_0",or.ACTIONS_COUNT_PER_API=20,sr.__meta__={fields:{rpc:{inject:null}}},sr.NAME="apiCaller",sr.DELAY_FOR_DB_REPLICATION=500,sr.DELAY_FOR_DB_REPLICATION_FOR_RETRY=1e3,sr.API_TRY_COUNT=3,lr.__meta__={fields:{apiCaller:{inject:null},dataStore:{inject:null},settings:{inject:null}}},lr.NAME="apiNote",ur.NAME="appState",cr.__meta__={fields:{dataStore:{inject:null},messageStore:{inject:null},settings:{inject:null}}},cr.NAME="conferenceStore",_r.__meta__={fields:{dataStore:{inject:null},fileInfoStore:{inject:null},messageStore:{inject:null},solutionsStore:{inject:null},conferenceStore:{inject:null}}},_r.NAME="dataFactory",hr.__meta__={fields:{fileInfoStore:{inject:null}}},hr.NAME="dataStore",hr.TYPE_FRIEND=0,hr.TYPE_ACQUAINSTANCE=1,hr.TYPE_NONE=2,dr.__meta__={fields:{dataStore:{inject:null}}},dr.NAME="departmentStore",fr.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},fr.NAME="features",mr.NAME="fileInfoStore",gr.NAME="fileService",vr.__meta__={fields:{settings:{inject:null}}},yr.__meta__={fields:{settings:{inject:null},features:{inject:null},dataStore:{inject:null}}},yr.NAME="keywordWatcher",yr.TALK_KEY_PREFIX="talk_",yr.ANNOUNCEMENT_KEY_PREFIX="announcement_",Sr.TEMP_HALF_SPACE="&SPACE",Sr.TEMP_FULL_SPACE="&FULL_PITCH_SPACE",Er.__meta__={fields:{settings:{inject:null}}},Er.NAME="lastUsedAtUpdater",Er.UPDATE_LAST_USED_AT_INTERVAL=6e5,Nr.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},Nr.NAME="limitations",Ar.NAME="messageStore",br.__meta__={fields:{broadcast:{inject:null},lastUsedAtUpdater:{inject:null}}},br.NAME="rpc",br.lastMsgId=0,Dr.PING_INTERVAL_ON_CONNECTED=45e3,Mr.__meta__={fields:{dataStore:{inject:null},api:{inject:null}}},Mr.NAME="readStatusUpdater",Rr.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},Rr.NAME="routing",Ur.__meta__={fields:{settings:{inject:null}}},Ur.NAME="searchService",Ur.LOAD_SIZE=20,Ur.DUMMY_VALUE_FOR_SET=1,Pr.__meta__={fields:{settings:{inject:null},dataStore:{inject:null},dataFactory:{inject:null},api:{inject:null}}},Pr.NAME="session",Lr.NAME="settings",Lr.KEY_ACCESS_TOKEN="access_token",Lr.KEY_ACCESS_TOKEN_WITHOUT_MANAGEMENT_CONSOLE="access_token_without_management_console",Lr.KEY_SELECTED_DOMAIN_ID_H="selected_domain_id_h",Lr.KEY_SELECTED_DOMAIN_ID_L="selected_domain_id_l",Lr.COOKIE_KEY_SEND_BY_ENTER="send-by-enter",Lr.COOKIE_EXPIRES_SEND_BY_ENTER=31536e3,Lr.KEY_SELECTED_STAMP_TAB_ID="selected_stamp_tab_id",Lr.KEY_INPUT_TEXT="input_text",Lr.KEY_COPY_PROFILE_TO_ALL_DOMAINS="copy_profile_to_all_domains",Lr.KEY_SELECTED_DEPARTMENT_IDS="selected_department_ids",Lr.KEY_SEARCH_HISTORIES="search_histories",Lr.KEY_RIGHT_PANEL_OPENED="right_panel_opened",Lr.KEY_MULTI_VIEW_MODE="multi_view_mode",Lr.KEY_PASSWORD_WARNING_SKIP_UNTIL="password_warning_skip_until",Lr.KEY_LAST_USED_EXPIRED_AT="last_used_expired_at",Lr.KEY_IDFV="idfv",Br.NAME="solutionsStore",Hr.NAME="stampsStore",jr.__meta__={fields:{dataStore:{inject:null},conferenceStore:{inject:null}}},jr.NAME="talksService",Yr.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},Yr.NAME="ThumbnailExpansion",zr.__meta__={fields:{dataStore:{inject:null}}},zr.NAME="userPresences",ra.NAME="Mediator",aa.__meta__={fields:{dataStore:{inject:null},api:{inject:null},hubotObject:{inject:null},messageEvent:{inject:null},sendQueue:{inject:null}}},aa.NAME="commandline",aa.DATA_SAVE_SPAN=5e3,oa.__meta__={fields:{dataStore:{inject:null}}},oa.NAME="hubotObject",sa.__meta__={fields:{dataStore:{inject:null},hubotObject:{inject:null}}},sa.NAME="messageEvent",la.minWaitMinute=1,la.maxWaitMinute=1440,la.SEND_EVENT_NAME="send",ua.__meta__={fields:{messageEvent:{inject:null}}},ua.NAME="sendQueue",ua.MIN_SEND_SPAN_MESSAGE=550,ua.MIN_SEND_SPAN_ANNOUNCE=5050,ua.MAX_TEXT_LENGTH=1024,ua.MAX_FIELD_COUNT=9,ua.MAX_FIELD_LENGTH=64,ha.INVALID_PARAMETER="INVALID_PARAMETER",ha.FORBIDDEN="FORBIDDEN",ha.NOT_FOUND="NOT_FOUND",ha.LOCKED_BY_ANOTHER_USER="LOCKED_BY_ANOTHER_USER",ha.CONFLICT="CONFLICT",ha.TOO_MANY_REQUESTS="TOO_MANY_REQUESTS",ha.UNKNOWN="UNKNOWN",ga._mul=null!=Math.imul?Math.imul:function(e,t){return e*(65535&t)+(e*(t>>>16)<<16|0)|0},Sa.USE_CACHE=!1,Sa.USE_ENUM_INDEX=!1,Sa.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",Ta.DEFAULT_RESOLVER=new Ia,Ta.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",ka.count=0,ja.i64tmp=new zn(0,0),Ga.__toStr={}.toString,Za.FLOAT_SINGLE_MIN=1401298464324817e-60,Za.FLOAT_SINGLE_MAX=34028234663852886e22,Za.FLOAT_DOUBLE_MIN=5e-324,Za.FLOAT_DOUBLE_MAX=17976931348623157e292,r.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);