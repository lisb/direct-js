!function(e,t){"use strict";function n(e,t){function n(){}n.prototype=e;var i=new n;for(var r in t)i[r]=t[r];return t.toString!==Object.prototype.toString&&(i.toString=t.toString),i}function i(e){return e instanceof Array?function(){return _.iter(e)}:"function"==typeof e.iterator?r(e,e.iterator):e.iterator}function r(e,t){if(null==t)return null;null==t.__id__&&(t.__id__=sa++);var n;return null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[t.__id__],null==n&&(n=function(){return n.method.apply(n.scope,arguments)},n.scope=e,n.method=t,e.hx__closures__[t.__id__]=n),n}var a={},o=function(){return jr.__string_rec(this,"")},s=e.DirectAPI=function(){this.eventEmitter=new c,require("unorm")};a.DirectAPI=s,s.__name__=["DirectAPI"],s.getInstance=function(){return null==s.instance&&(s.instance=new s),s.instance},s.main=function(){},s.prototype={setOptions:function(e){null!=e&&(la.host=e.host,la.endpoint=e.endpoint,la.accessToken=e.access_token,la.proxyURL=e.proxyURL,la.account=e.account,la.talkWithBot=e.talkWithBot,la.name=e.name,la.storagePath=e.storage_path,la.storageQuota=e.storage_quota,la.wsConfig=e.ws_config),si._d("["+_.dateStr(new Date)+"] ","current settings",la,"","",""),null==la.accessToken&&si._e("["+_.dateStr(new Date)+"] ","Not enough parameters provided. I need a access token","","","","")},announce:function(e,t){var n,i=e.room;if(null!=i){var r,a=i.split("_");if(a.length>2){r=new Cn(v.parseInt(a[1]),v.parseInt(a[2]))}else r=null;if(null==r||null==t)return;var o=this.data.getTalk(r);if(null==o)return;n=o.domainId}else{var s=e.id.split("_");if(s.length>2){n=new Cn(v.parseInt(s[1]),v.parseInt(s[2]))}else n=null}null!=n&&this.sendQueue.sendAnnouncement(n,t)},send:function(e,t){var n,i=e.room,r=i.split("_");if(r.length>2){n=new Cn(v.parseInt(r[1]),v.parseInt(r[2]))}else n=null;null!=n&&null!=t&&this.sendQueue.sendMessage(n,t)},topic:function(e,t){var n,i=e.room,r=i.split("_");if(r.length>2){n=new Cn(v.parseInt(r[1]),v.parseInt(r[2]))}else n=null;this.facade.sendNotification("Talk",Ee.UPDATE(n,null,t))},download:function(e,t,n){var i,r=null,a=null;if("string"==typeof t?i=t:(i=t.url,r=t.path,a=t.name),null==i)return void n(null);null==a&&(a=Wr.basename(i)),null==r&&(r=Wr.join(Gr.tmpdir(),a)),this.facade.sendNotification("File",re.DOWNLOAD_PATH(i,r,n))},leave:function(e,t){var n,i=this,r=e.room,a=r.split("_");if(a.length>2){var o=new Cn(v.parseInt(a[1]),v.parseInt(a[2]));n=o}else n=null;var s;if(null==t)s=null;else{var l=t.id.split("_");if(l.length>2){var u=new Cn(v.parseInt(l[1]),v.parseInt(l[2]));s=u}else s=null}vr.delay(function(){i.facade.sendNotification("Talk",Ee.DELETE(n,null,s))},500)},userForId:function(e){return this.hubotObject.userObjectByIdStr(null,e)},userObjects:function(){return this.hubotObject.userObjects(null)},talkObjects:function(){return this.hubotObject.talkObjects()},domainObjects:function(){return this.hubotObject.domainObjects()},parseInt64:function(e){return e.length>0&&"_"==e.charAt(0)?M.makeFromIdStr(e):M.parse(e)},stringifyInt64:function(e,t){return null==t&&(t=!1),t?"_"+e.high+"_"+e.low:pr.toString(e)},listen:function(){this.facade=A.getInstance(),this.api=jr.__cast(this.facade.retrieveProxy("api"),Ei),this.data=jr.__cast(this.facade.retrieveProxy("dataStore"),Di),this.hubotObject=jr.__cast(this.facade.retrieveProxy("hubotObject"),ur),this.sendQueue=jr.__cast(this.facade.retrieveProxy("sendQueue"),hr),this.facade.startup()},emit:function(e,t,n,i){this.eventEmitter.emit(e,t,n,i)},on:function(e,t){return this.eventEmitter.on(e,t)},getDomainInvites:function(e){this.api._getDomainInvites(e)},acceptDomainInvite:function(e){this.api.acceptDomainInvite(e)},__class__:s};var l=function(e,t){this.r=new RegExp(e,t.split("u").join(""))};a.EReg=l,l.__name__=["EReg"],l.prototype={match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&e>=0&&e<this.r.m.length)return this.r.m[e];throw new Br("EReg::matched")},matchedPos:function(){if(null==this.r.m)throw new Br("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(e,t,n){if(null==n&&(n=-1),this.r.global){this.r.lastIndex=t;var i=this.r,r=n<0?e:_.substr(e,0,t+n);this.r.m=i.exec(r);var a=null!=this.r.m;return a&&(this.r.s=e),a}var o=this.match(n<0?_.substr(e,t,null):_.substr(e,t,n));return o&&(this.r.s=e,this.r.m.index+=t),o},split:function(e){var t="#__delim__#";return e.replace(this.r,t).split(t)},map:function(e,t){for(var n=0,i="";;){if(n>=e.length)break;if(!this.matchSub(e,n)){i+=v.string(_.substr(e,n,null));break}var r=this.matchedPos();if(i+=v.string(_.substr(e,n,r.pos-n)),i+=v.string(t(this)),0==r.len?(i+=v.string(_.substr(e,r.pos,1)),n=r.pos+1):n=r.pos+r.len,!this.r.global)break}return!this.r.global&&n>0&&n<e.length&&(i+=v.string(_.substr(e,n,null))),i},__class__:l};var u=require("events").EventEmitter,c=function(){u.call(this)};a.EventEmitter=c,c.__name__=["EventEmitter"],c.__super__=u,c.prototype=n(u.prototype,{__class__:c});var _=function(){};a.HxOverrides=_,_.__name__=["HxOverrides"],_.dateStr=function(e){var t=e.getMonth()+1,n=e.getDate(),i=e.getHours(),r=e.getMinutes(),a=e.getSeconds();return e.getFullYear()+"-"+(t<10?"0"+t:""+t)+"-"+(n<10?"0"+n:""+n)+" "+(i<10?"0"+i:""+i)+":"+(r<10?"0"+r:""+r)+":"+(a<10?"0"+a:""+a)},_.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),n=new Date;return n.setTime(0),n.setUTCHours(t[0]),n.setUTCMinutes(t[1]),n.setUTCSeconds(t[2]),n;case 10:var i=e.split("-");return new Date(i[0],i[1]-1,i[2],0,0,0);case 19:var r=e.split(" "),a=r[0].split("-"),o=r[1].split(":");return new Date(a[0],a[1]-1,a[2],o[0],o[1],o[2]);default:throw new Br("Invalid date format : "+e)}},_.cca=function(e,t){var n=e.charCodeAt(t);if(n==n)return n},_.substr=function(e,t,n){if(null==n)n=e.length;else if(n<0){if(0!=t)return"";n=e.length+n}return e.substr(t,n)},_.remove=function(e,t){var n=e.indexOf(t);return-1!=n&&(e.splice(n,1),!0)},_.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var h=function(){};a.Lambda=h,h.__name__=["Lambda"],h.array=function(e){for(var t=[],n=i(e)();n.hasNext();){var r=n.next();t.push(r)}return t},h.mapi=function(e,t){for(var n=new d,r=0,a=i(e)();a.hasNext();){var o=a.next();n.add(t(r++,o))}return n},h.exists=function(e,t){for(var n=i(e)();n.hasNext();){if(t(n.next()))return!0}return!1},h.iter=function(e,t){for(var n=i(e)();n.hasNext();){t(n.next())}},h.filter=function(e,t){for(var n=new d,r=i(e)();r.hasNext();){var a=r.next();t(a)&&n.add(a)}return n},h.fold=function(e,t,n){for(var r=i(e)();r.hasNext();){n=t(r.next(),n)}return n},h.count=function(e,t){var n=0;if(null==t)for(var r=i(e)();r.hasNext();){r.next();++n}else for(var a=i(e)();a.hasNext();){var o=a.next();t(o)&&++n}return n},h.find=function(e,t){for(var n=i(e)();n.hasNext();){var r=n.next();if(t(r))return r}return null};var d=function(){this.length=0};a.List=d,d.__name__=["List"],d.prototype={add:function(e){var t=new f(e,null);null==this.h?this.h=t:this.q.next=t,this.q=t,this.length++},isEmpty:function(){return null==this.h},remove:function(e){for(var t=null,n=this.h;null!=n;){if(n.item==e)return null==t?this.h=n.next:t.next=n.next,this.q==n&&(this.q=t),this.length--,!0;t=n,n=n.next}return!1},iterator:function(){return new m(this.h)},map:function(e){for(var t=new d,n=this.h;null!=n;){var i=n.item;n=n.next,t.add(e(i))}return t},__class__:d};var f=function(e,t){this.item=e,this.next=t};a["_List.ListNode"]=f,f.__name__=["_List","ListNode"],f.prototype={__class__:f};var m=function(e){this.head=e};a["_List.ListIterator"]=m,m.__name__=["_List","ListIterator"],m.prototype={hasNext:function(){return null!=this.head},next:function(){var e=this.head.item;return this.head=this.head.next,e},__class__:m},Math.__name__=["Math"];var p=function(){};a.ObjectHelper=p,p.__name__=["ObjectHelper"],p.deepCopy=function(e){return null==e?null:JSON.parse(JSON.stringify(e))};var g=function(){};a.Reflect=g,g.__name__=["Reflect"],g.field=function(e,t){try{return e[t]}catch(e){return null}},g.fields=function(e){var t=[];if(null!=e){var n=Object.prototype.hasOwnProperty;for(var i in e)"__id__"!=i&&"hx__closures__"!=i&&n.call(e,i)&&t.push(i)}return t},g.isFunction=function(e){return"function"==typeof e&&!(e.__name__||e.__ename__)},g.compare=function(e,t){return e==t?0:e>t?1:-1},g.isObject=function(e){if(null==e)return!1;var t=typeof e;return"string"==t||"object"==t&&null==e.__enum__||"function"==t&&null!=(e.__name__||e.__ename__)},g.isEnumValue=function(e){return null!=e&&null!=e.__enum__},g.deleteField=function(e,t){return!!Object.prototype.hasOwnProperty.call(e,t)&&(delete e[t],!0)};var v=function(){};a.Std=v,v.__name__=["Std"],v.string=function(e){return jr.__string_rec(e,"")},v.parseInt=function(e){var t=parseInt(e,10);return 0!=t||120!=_.cca(e,1)&&88!=_.cca(e,1)||(t=parseInt(e)),isNaN(t)?null:t};var y=function(){this.b=""};a.StringBuf=y,y.__name__=["StringBuf"],y.prototype={toString:function(){return this.b},__class__:y};var S=function(){};a.StringTools=S,S.__name__=["StringTools"],S.htmlEscape=function(e,t){return e=e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;"),t?e.split('"').join("&quot;").split("'").join("&#039;"):e},S.startsWith=function(e,t){return e.length>=t.length&&_.substr(e,0,t.length)==t},S.replace=function(e,t,n){return e.split(t).join(n)},S.hex=function(e,t){for(var n="",i="0123456789ABCDEF";;)if(n=i.charAt(15&e)+n,!((e>>>=4)>0))break;if(null!=t)for(;n.length<t;)n="0"+n;return n};var w=function(){};a.TextHelper=w,w.__name__=["TextHelper"],w.slice=function(e,t){for(var n=[],i=function(e){for(;e.length>t;){var i=_.substr(e,0,t);n.push(i),e=_.substr(e,t,null)}e.length>0&&n.push(e)},r="",a=e.split("\n");a.length>0;){var o=a.shift();r.length+o.length>t&&(i(r),r=""),r.length>0&&(r+="\n"),r+=o}return i(r),n};var T=a.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};T.TNull=["TNull",0],T.TNull.toString=o,T.TNull.__enum__=T,T.TInt=["TInt",1],T.TInt.toString=o,T.TInt.__enum__=T,T.TFloat=["TFloat",2],T.TFloat.toString=o,T.TFloat.__enum__=T,T.TBool=["TBool",3],T.TBool.toString=o,T.TBool.__enum__=T,T.TObject=["TObject",4],T.TObject.toString=o,T.TObject.__enum__=T,T.TFunction=["TFunction",5],T.TFunction.toString=o,T.TFunction.__enum__=T,T.TClass=function(e){var t=["TClass",6,e];return t.__enum__=T,t.toString=o,t},T.TEnum=function(e){var t=["TEnum",7,e];return t.__enum__=T,t.toString=o,t},T.TUnknown=["TUnknown",8],T.TUnknown.toString=o,T.TUnknown.__enum__=T,T.__empty_constructs__=[T.TNull,T.TInt,T.TFloat,T.TBool,T.TObject,T.TFunction,T.TUnknown];var I=function(){};a.Type=I,I.__name__=["Type"],I.getClassName=function(e){var t=e.__name__;return null==t?null:t.join(".")},I.getEnumName=function(e){return e.__ename__.join(".")},I.resolveClass=function(e){var t=a[e];return null!=t&&t.__name__?t:null},I.resolveEnum=function(e){var t=a[e];return null!=t&&t.__ename__?t:null},I.createInstance=function(e,t){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);case 9:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]);case 10:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);case 11:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10]);case 12:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11]);case 13:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12]);case 14:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13]);default:throw new Br("Too many arguments")}},I.createEmptyInstance=function(e){function t(){}return t.prototype=e.prototype,new t},I.createEnum=function(e,t,n){var i=g.field(e,t);if(null==i)throw new Br("No such constructor "+t);if(g.isFunction(i)){if(null==n)throw new Br("Constructor "+t+" need parameters");return i.apply(e,n)}if(null!=n&&0!=n.length)throw new Br("Constructor "+t+" does not need parameters");return i},I.typeof=function(e){switch(typeof e){case"boolean":return T.TBool;case"function":return e.__name__||e.__ename__?T.TObject:T.TFunction;case"number":return Math.ceil(e)==e%2147483648?T.TInt:T.TFloat;case"object":if(null==e)return T.TNull;var t=e.__enum__;if(null!=t)return T.TEnum(t);var n=jr.getClass(e);return null!=n?T.TClass(n):T.TObject;case"string":return T.TClass(String);case"undefined":return T.TNull;default:return T.TUnknown}},I.enumEq=function(e,t){if(e==t)return!0;try{if(e[0]!=t[0])return!1;for(var n=2,i=e.length;n<i;){var r=n++;if(!I.enumEq(e[r],t[r]))return!1}var a=e.__enum__;if(a!=t.__enum__||null==a)return!1}catch(e){return!1}return!0};var E=function(){};a["puremvc.interfaces.IFacade"]=E,E.__name__=["puremvc","interfaces","IFacade"],E.prototype={__class__:E};var b=function(){b.instance=this,this.initializeFacade()};a["puremvc.patterns.facade.Facade"]=b,b.__name__=["puremvc","patterns","facade","Facade"],b.__interfaces__=[E],b.getInstance=function(){return null==b.instance&&(b.instance=new b),b.instance},b.prototype={initializeFacade:function(){this.initializeModel(),this.initializeController(),this.initializeView()},initializeController:function(){null==this.controller&&(this.controller=Xr.getInstance())},initializeModel:function(){null==this.model&&(this.model=$r.getInstance())},initializeView:function(){null==this.view&&(this.view=ta.getInstance())},registerCommand:function(e,t){this.controller.registerCommand(e,t)},removeCommand:function(e){this.controller.removeCommand(e)},hasCommand:function(e){return this.controller.hasCommand(e)},registerProxy:function(e){this.model.registerProxy(e)},retrieveProxy:function(e){return this.model.retrieveProxy(e)},removeProxy:function(e){var t=null;return null!=this.model&&(t=this.model.removeProxy(e)),t},hasProxy:function(e){return this.model.hasProxy(e)},registerMediator:function(e){null!=this.view&&this.view.registerMediator(e)},retrieveMediator:function(e){return this.view.retrieveMediator(e)},removeMediator:function(e){var t=null;return null!=this.view&&(t=this.view.removeMediator(e)),t},hasMediator:function(e){return this.view.hasMediator(e)},sendNotification:function(e,t,n){this.notifyObservers(new ra(e,t,n))},notifyObservers:function(e){null!=this.view&&this.view.notifyObservers(e)},__class__:b};var A=function(){b.call(this)};a["albero.AppFacade"]=A,A.__name__=["albero","AppFacade"],A.getInstance=function(){return null==b.instance&&(b.instance=new A),jr.__cast(b.instance,A)},A.__super__=b,A.prototype=n(b.prototype,{initializeModel:function(){b.prototype.initializeModel.call(this);var e=[new ur,new hr,new cr,new Hi,new Ai,new Di,new ki,new Ci,new Zi,new Ii,new Ei,new bi,new Mi,new Vi,new Ri,new Ji,new $i,new xi,new Oi,new ji,new tr,new Xi,new Yi,new Bi,new nr,new Ni,new er,gi.newInstance()];e.push(wi.newInstance());for(var t=0;t<e.length;){var n=e[t];++t,this.registerProxy(n)}for(var i=0;i<e.length;){var r=e[i];++i,this.autoBind(r)}},initializeView:function(){b.prototype.initializeView.call(this);for(var e=[new lr],t=0;t<e.length;){var n=e[t];++t,this.registerMediator(n)}},initializeController:function(){b.prototype.initializeController.call(this);for(var e=[te,we,Te,fe,Se,Ie,oe,he,ae,ie,ve,Ae,be,Ne,ke,pe,Q,le,$,X,ce],t=0;t<e.length;){var n=e[t];++t;var i=S.replace(I.getClassName(n).split(".").pop(),"Command","");this.registerCommand(i,n)}},registerMediator:function(e){this.autoBind(e),b.prototype.registerMediator.call(this,e)},autoBind:function(e){for(var t=e,n=Lr.getFields(null==t?null:jr.getClass(t)),i=0,r=g.fields(n);i<r.length;){var a=r[i];++i;var o=g.field(n,a);if(Object.prototype.hasOwnProperty.call(o,"inject")){var s=this.retrieveProxy(a);null!=s&&(e[a]=s)}}},startup:function(){jr.__cast(this.retrieveProxy("appState"),Ai).start()},__class__:A});var N=a["albero.AppState"]={__ename__:["albero","AppState"],__constructs__:["Active","Inactive"]};N.Active=["Active",0],N.Active.toString=o,N.Active.__enum__=N,N.Inactive=["Inactive",1],N.Inactive.toString=o,N.Inactive.__enum__=N,N.__empty_constructs__=[N.Active,N.Inactive];var k=a["albero.ConnectionStatus"]={__ename__:["albero","ConnectionStatus"],__constructs__:["Ok","Error","ConcurrentAccessError","ForcibliyClosedError"]};k.Ok=["Ok",0],k.Ok.toString=o,k.Ok.__enum__=k,k.Error=["Error",1],k.Error.toString=o,k.Error.__enum__=k,k.ConcurrentAccessError=["ConcurrentAccessError",2],k.ConcurrentAccessError.toString=o,k.ConcurrentAccessError.__enum__=k,k.ForcibliyClosedError=["ForcibliyClosedError",3],k.ForcibliyClosedError.toString=o,k.ForcibliyClosedError.__enum__=k,k.__empty_constructs__=[k.Ok,k.Error,k.ConcurrentAccessError,k.ForcibliyClosedError];var D=function(){};a["albero.DateTimeHelper"]=D,D.__name__=["albero","DateTimeHelper"],D.isSameDate=function(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()},D.dateString=function(e,t){var n=new Date,i="";return e.getFullYear()!=n.getFullYear()&&(i+=e.getFullYear()+"/"),i+=e.getMonth()+1+"/"+e.getDate(),t&&(i+=" ("+D.dayOfWeekString(e)+")"),i},D.dayOfWeekString=function(e){switch(e.getDay()){case 0:return oi.localize("DateTimeHelper.sun");case 1:return oi.localize("DateTimeHelper.mon");case 2:return oi.localize("DateTimeHelper.tue");case 3:return oi.localize("DateTimeHelper.wed");case 4:return oi.localize("DateTimeHelper.thu");case 5:return oi.localize("DateTimeHelper.fri");default:return oi.localize("DateTimeHelper.sat")}},D.getDateStringForFile=function(){var e=new Date;return e.getFullYear()+D.toDoubleDigits(e.getMonth()+1)+D.toDoubleDigits(e.getDate())+"_"+D.toDoubleDigits(e.getHours())+D.toDoubleDigits(e.getMinutes())+D.toDoubleDigits(e.getSeconds())},D.getTimeStringForVoice=function(e){return D.toDoubleDigits(e/60|0)+":"+D.toDoubleDigits((0|e)%60)},D.toDoubleDigits=function(e){var t=null==e?"null":""+e;return 1==t.length&&(t="0"+t),t},D.nowAsInt64=function(){return D.dateAsInt64((new Date).getTime())},D.oneDayAfterAsInt64=function(){return D.dateAsInt64((new Date).getTime()+864e5)},D.afterAsInt64=function(e){return D.dateAsInt64((new Date).getTime()+e)},D.dateAsInt64=function(e){return new Cn(e/4294967296|0,e%4294967296|0)},D.abbreviateDatetimeString=function(e){if(null==e)return"";var t=new Date,n=e.high,i=e.low,r=4294967296*n+(i>=0?i:i+4294967296),a=new Date(r);return t.getFullYear()==a.getFullYear()&&t.getMonth()==a.getMonth()&&t.getDate()==a.getDate()?a.getHours()+":"+(a.getMinutes()<10?"0":"")+a.getMinutes():D.dateString(a,!1)},D.datetimeStringIn11Chars=function(e){if(null==e)return"";var t=new Date,n=e.high,i=e.low,r=4294967296*n+(i>=0?i:i+4294967296),a=new Date(r),o=D.dateString(a,!1);return t.getFullYear()==a.getFullYear()&&(o+=" "+a.getHours()+":"+(a.getMinutes()<10?"0":"")+a.getMinutes()),o},D.timeString=function(e){if(null==e)return"";var t=e.high,n=e.low,i=4294967296*t+(n>=0?n:n+4294967296),r=new Date(i);return r.getHours()+":"+(r.getMinutes()<10?"0":"")+r.getMinutes()},D.datetimeString=function(e){if(null==e)return"";var t=parseFloat(pr.toString(e)),n=new Date(t);return n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate()+" "+n.getHours()+":"+(n.getMinutes()<10?"0":"")+n.getMinutes()};var C=function(){};a["albero.FileDynamicHelper"]=C,C.__name__=["albero","FileDynamicHelper"],C.filterDeleted=function(e){return null==e?[]:e.filter(C.isNotDeleted)},C.isNotDeleted=function(e){return null==e.deleted||!e.deleted},C.createFileInfoDynamic=function(e,t,n,i){var r={url:i.get_url,content_type:e.type,content_size:e.size,name:t,file_id:i.file_id};return U.foreach(n,function(e){null!=e.auth&&(r.thumbnail_url=e.auth.get_url),null!=e.dimension&&(r.thumbnail_dimension=e.dimension.toObject())}),r};var O=function(){};a["albero.FileHelper"]=O,O.__name__=["albero","FileHelper"],O.createByteSizeStringWithUnit=function(e){for(var t,n=["","K","M","G","T"];;){if(!((t=e/1024|0)>0))break;e=t,n.shift()}return e+" "+n.shift()+"B"};var R=function(){};a["albero.History"]=R,R.__name__=["albero","History"],R.replaceState=function(e,t,n){return null!=window.history&&(window.history.replaceState(e,t,n),!0)};var M=function(){};a["albero.Int64Helper"]=M,M.__name__=["albero","Int64Helper"],M.parse=function(e){if(!new l("^\\d+$","").match(e))return null;for(var t=new Cn(0,0),n=t,i=new Cn(0,10),r=i,a=0,o=e.length;a<o;){var s=a++,u=65535&n.low,c=n.low>>>16,_=65535&r.low,h=r.low>>>16,d=mr._mul(u,_),f=mr._mul(c,_),m=mr._mul(u,h),p=mr._mul(c,h),g=d,y=(p+(m>>>16)|0)+(f>>>16)|0;if(m<<=16,g=g+m|0,mr.ucompare(g,m)<0){y++;y|=0}if(f<<=16,g=g+f|0,mr.ucompare(g,f)<0){y++;y|=0}y=y+(mr._mul(n.low,r.high)+mr._mul(n.high,r.low)|0)|0;var S=new Cn(y,g),w=S,T=new Cn(0,v.parseInt(e.charAt(s))),I=T,E=w.high+I.high|0,b=w.low+I.low|0;if(mr.ucompare(b,w.low)<0){E++;E|=0}n=new Cn(E,b)}return n},M.getHigh=function(e){return e.high},M.getLow=function(e){return e.low},M.idStr=function(e){return"_"+e.high+"_"+e.low},M.makeFromIdStr=function(e){var t=new l("^_(-?\\d*)_(-?\\d*)$","");return t.match(e)?new Cn(v.parseInt(t.matched(1)),v.parseInt(t.matched(2))):null},M.toStr=function(e){return pr.toString(e)},M.isNeg=function(e){return e.high<0},M.add=function(e,t){var n=e.high+t.high|0,i=e.low+t.low|0;if(mr.ucompare(i,e.low)<0){n++;n|=0}return new Cn(n,i)},M.sub=function(e,t){var n=e.high-t.high|0,i=e.low-t.low|0;if(mr.ucompare(e.low,t.low)<0){n--;n|=0}return new Cn(n,i)},M.compare=function(e,t){var n=e.high-t.high|0;return n=0!=n?n:mr.ucompare(e.low,t.low),e.high<0?t.high<0?n:-1:t.high>=0?n:1},M.eq=function(e,t){return null!=e&&null!=t&&e.high==t.high&&e.low==t.low},M.eqOrBothNull=function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.high==t.high&&e.low==t.low},M.toFloat=function(e){var t=e.high,n=e.low;return 4294967296*t+(n>=0?n:n+4294967296)},M.idStrToInt64=function(e){var t=e.split("_");if(t.length>2){return new Cn(v.parseInt(t[1]),v.parseInt(t[2]))}return null},M.decrement=function(e){if(null==e)return null;var t=new Cn(0,1),n=t,i=e.high-n.high|0,r=e.low-n.low|0;if(mr.ucompare(e.low,n.low)<0){i--;i|=0}return new Cn(i,r)},M.increment=function(e){if(null==e)return null;var t=new Cn(0,1),n=t,i=e.high+n.high|0,r=e.low+n.low|0;if(mr.ucompare(r,e.low)<0){i++;i|=0}return new Cn(i,r)},M.unique=function(e){if(null==e)return[];for(var t=[],n=0,i=e.length;n<i;){var r=n++,a=e[r];M.indexOf(e,a)==r&&t.push(a)}return t},M.indexOf=function(e,t){if(null==e)return-1;for(var n=0,i=e.length;n<i;){var r=n++,a=e[r];if(null!=a&&null!=t&&a.high==t.high&&a.low==t.low)return r}return-1},M.contains=function(e,t){if(null==e)return!1;for(var n=0;n<e.length;){var i=e[n];if(++n,null!=i&&null!=t&&i.high==t.high&&i.low==t.low)return!0}return!1},M.notContains=function(e,t){return!M.contains(e,t)},M.remove=function(e,t){if(null==e)return!1;for(var n=0;n<e.length;){var i=e[n];if(++n,null!=i&&null!=t&&i.high==t.high&&i.low==t.low)return _.remove(e,i),!0}return!1},M.fromIntOrInt64=function(e){if(null==e||jr.__instanceof(e,Cn))return e;var t=jr.__cast(e,ua);return new Cn(t>>31,t)},M.eqArray=function(e,t){if(e!=t){if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var n=0,i=e.length;n<i;){var r=n++,a=e[r],o=t[r];if(null==a||null==o||a.high!=o.high||a.low!=o.low)return!1}}return!0};var x=function(){};a["albero.LambdaHelper"]=x,x.__name__=["albero","LambdaHelper"],x.flatten=function(e){return h.filter(e,function(e){return U.isDefined(e)}).map(function(e){return U.get(e)})},x.headOption=function(e){for(var t=i(e)();t.hasNext();){var n=t.next();return Ar.Some(n)}return Ar.None},x.lastOption=function(e){for(var t=Ar.None,n=i(e)();n.hasNext();){var r=n.next();t=Ar.Some(r)}return t},x.findOption=function(e,t){return U.option(h.find(e,t))},x.indexWhere=function(e,t){for(var n=0,r=i(e)();r.hasNext();){if(t(r.next()))return n;++n}return-1},x.forall=function(e,t){return!h.exists(e,function(e){return!t(e)})};var F=function(){};a["albero.ArrayHelper"]=F,F.__name__=["albero","ArrayHelper"],F.lastOption=function(e){return 0==e.length?Ar.None:Ar.Some(e[e.length-1])},F.sortAndReturn=function(e,t){return e.sort(t),e},F.reverseAndReturn=function(e){return e.reverse(),e},F.asArray=function(e){return jr.__cast(e,Array)};var U=function(){};a["albero.OptionHelper"]=U,U.__name__=["albero","OptionHelper"],U.map=function(e,t){switch(e[1]){case 0:var n=e[2];return Ar.Some(t(n));case 1:return Ar.None}},U.flatMap=function(e,t){switch(e[1]){case 0:return t(e[2]);case 1:return Ar.None}},U.foreach=function(e,t){switch(e[1]){case 0:t(e[2])}},U.filter=function(e,t){switch(e[1]){case 0:return t(e[2])?e:Ar.None;case 1:return Ar.None}},U.exists=function(e,t){return U.isDefined(U.filter(e,t))},U.isDefined=function(e){switch(e[1]){case 0:return!0;case 1:return!1}},U.isEmpty=function(e){switch(e[1]){case 0:return!1;case 1:return!0}},U.get=function(e){switch(e[1]){case 0:return e[2];case 1:throw new Br("None.get called")}},U.orNull=function(e){switch(e[1]){case 0:return e[2];case 1:return null}},U.flatten=function(e){return U.flatMap(e,function(e){return e})},U.eq=function(e,t){return I.enumEq(e,t)},U.option=function(e){return null!=e?Ar.Some(e):Ar.None};var P=function(){};a["albero.StorageHelper"]=P,P.__name__=["albero","StorageHelper"],P.getItemAsJson=function(e){var t=P.getItem(e);if(null==t)return null;try{return JSON.parse(t)}catch(e){return null}},P.getItemAsInt=function(e){var t=P.getItem(e);return null==t?null:v.parseInt(t)},P.getItem=function(e){var t=ai.getLocalStorage();if(null==t)si._e("["+_.dateStr(new Date)+"] ","storage not found","","","","");else try{return t.getItem(e)}catch(e){e instanceof Br&&(e=e.val),si._e("["+_.dateStr(new Date)+"] ","storage error occered.",e,"","","")}return null},P.removeItem=function(e){var t=ai.getLocalStorage();if(null==t)si._e("["+_.dateStr(new Date)+"] ","storage not found","","","","");else try{return t.removeItem(e),!0}catch(e){e instanceof Br&&(e=e.val),si._e("["+_.dateStr(new Date)+"] ","storage error occered.",e,"","","")}return!1},P.setItem=function(e,t){var n=ai.getLocalStorage();if(null==n)si._e("["+_.dateStr(new Date)+"] ","storage not found","","","","");else try{return n.setItem(e,t),!0}catch(e){e instanceof Br&&(e=e.val),si._e("["+_.dateStr(new Date)+"] ","storage error occered.",e,"","","")}return!1},P.getItemWithUnserialize=function(e){var t=P.getItem(e);if(null!=t)try{return Sr.run(t)}catch(e){e instanceof Br&&(e=e.val),si._w("["+_.dateStr(new Date)+"] ",e,"","","","")}return null},P.setItemWithSerialize=function(e,t){P.setItem(e,gr.run(t))};var L=function(){};a["albero.StringHelper"]=L,L.__name__=["albero","StringHelper"],L.trim=function(e){return e.trim()},L.compare=function(e,t){return e>t?1:e<t?-1:0},L.isEmpty=function(e){return null==e||0==e.length},L.isNotEmpty=function(e){return!L.isEmpty(e)},L.randomString=function(){var e="",t=8;for(e+=v.string(S.hex(0|(new Date).getTime(),8));t++<36;)e+=v.string(0!=(51*t&52)?S.hex(0!=(15^t)?8^(Math.random()*(0!=(20^t)?16:4)|0):4):"-");return e.toLowerCase()};var B=a["albero.Urls"]={__ename__:["albero","Urls"],__constructs__:["auto","domains","domain","members","talks","actions","settings","announcements","error","loading","environment","unknown"]};B.auto=["auto",0],B.auto.toString=o,B.auto.__enum__=B,B.domains=["domains",1],B.domains.toString=o,B.domains.__enum__=B,B.domain=function(e){var t=["domain",2,e];return t.__enum__=B,t.toString=o,t},B.members=function(e){var t=["members",3,e];return t.__enum__=B,t.toString=o,t},B.talks=function(e,t){var n=["talks",4,e,t];return n.__enum__=B,n.toString=o,n},B.actions=function(e){var t=["actions",5,e];return t.__enum__=B,t.toString=o,t},B.settings=function(e){var t=["settings",6,e];return t.__enum__=B,t.toString=o,t},B.announcements=["announcements",7],B.announcements.toString=o,B.announcements.__enum__=B,B.error=["error",8],B.error.toString=o,B.error.__enum__=B,B.loading=["loading",9],B.loading.toString=o,B.loading.__enum__=B,B.environment=function(e){var t=["environment",10,e];return t.__enum__=B,t.toString=o,t},B.unknown=["unknown",11],B.unknown.toString=o,B.unknown.__enum__=B,B.__empty_constructs__=[B.auto,B.domains,B.announcements,B.error,B.loading,B.unknown];var j=a["albero.TalkUrlParam"]={__ename__:["albero","TalkUrlParam"],__constructs__:["multi","single"]};j.multi=function(e){var t=["multi",0,e];return t.__enum__=j,t.toString=o,t},j.single=function(e){var t=["single",1,e];return t.__enum__=j,t.toString=o,t},j.__empty_constructs__=[];var H=function(){};a["albero.TalkUrlParamHelper"]=H,H.__name__=["albero","TalkUrlParamHelper"],H.getTalkSelectionForSingle=function(e){switch(e[1]){case 0:return Ar.None;case 1:var t=e[2];return Ar.Some(t)}},H.getTalkSelectionsForMulti=function(e){switch(e[1]){case 0:var t=e[2];return Ar.Some(t);case 1:return Ar.None}};var z=function(){};a["albero.UrlConverter"]=z,z.__name__=["albero","UrlConverter"],z.createUrls=function(e,t){if(null==e)return B.unknown;var n=e.split("/");return""!=n[0]?B.unknown:n.length<2?B.unknown:2==n.length?z.createUrlsWithoutDomain(n,t):z.createUrlsWithDomain(n,t)},z.createUrlsWithoutDomain=function(e,t){switch(e[1]){case"":return B.domains;case"environment":var n=t.getFallbackDomainId();return U.foreach(n,function(e){R.replaceState("environment",null,"#"+z.createFragment(B.environment(e),t))}),B.environment(U.orNull(n));case"error":return B.error;case"loading":return B.loading;case"settings":var i=t.getFallbackDomainId();return U.foreach(i,function(e){R.replaceState("settings",null,"#"+z.createFragment(B.settings(e),t))}),B.settings(U.orNull(i));default:return B.unknown}},z.createUrlsWithDomain=function(e,t){var n=M.parse(e[1]);if(null==n)return B.unknown;switch(e[2]){case"":return B.domain(n);case"actions":return B.actions(n);case"environment":return B.environment(n);case"members":return B.members(n);case"settings":return B.settings(n);case"talks":if(e.length<4)return B.talks(n,j.single(Sn.NotSelected));if("multi"==e[3]||",,"==e[3])return B.talks(n,j.multi([Sn.NotSelected,Sn.NotSelected,Sn.NotSelected]));if("single"==e[3]||""==e[3])return B.talks(n,j.single(Sn.NotSelected));var i=e[3].split(",");if(1==i.length){var r=e.length<5?Ar.None:U.option(M.parse(e[4])),a=z.createTalkSelection(i[0],r);return B.talks(n,j.single(a))}if(3==i.length){var o=i.map(function(e){return z.createTalkSelection(e,Ar.None)});return B.talks(n,j.multi(o))}}return B.unknown},z.createTalkSelection=function(e,t){if(e==z.ANNOUNCEMENTS_KEY)return Sn.AnnouncementsSelected;var n=M.parse(e);return null==n?Sn.NotSelected:Sn.TalkSelected(n,t)},z.createFragment=function(e,t){switch(e[1]){case 1:return"/";case 2:var n=e[2];return"/"+pr.toString(n)+"/";case 3:var i=e[2];return"/"+pr.toString(i)+"/members";case 4:var r=e[3],a=e[2];switch(r[1]){case 0:var o=r[2],s="/"+o.map(z.createTalkPartFragment).join(",");return"/"+pr.toString(a)+"/talks"+s;case 1:var l=r[2],u=z.createTalkPartFragment(l),c=L.isEmpty(u)?"":"/"+u;return"/"+pr.toString(a)+"/talks"+c}break;case 5:var h=e[2];return"/"+pr.toString(h)+"/actions";case 6:var d=e[2];si._d("["+_.dateStr(new Date)+"] ","convert urls.settings to fragment. domainId:",null!=d?d:"","","","");var f,m=U.option(d);switch(m[1]){case 0:f=U.option(d);break;case 1:f=t.getLastSelectedDomainId()}var p=U.map(f,function(e){return"/"+pr.toString(e)+"/settings"});switch(p[1]){case 0:return p[2];case 1:return"/settings"}break;case 8:case 9:return"/"+v.string(e);case 10:var g=e[2];si._d("["+_.dateStr(new Date)+"] ","convert urls.environment to fragment. domainId:",null!=g?g:"","","","");var y,S=U.option(g);switch(S[1]){case 0:y=U.option(g);break;case 1:y=t.getLastSelectedDomainId()}var w=U.map(y,function(e){return"/"+pr.toString(e)+"/environment"});switch(w[1]){case 0:return w[2];case 1:return"/environment"}break;default:return null}},
z.createTalkPartFragment=function(e){switch(e[1]){case 0:return"";case 1:var t,n=e[3],i=e[2],r=U.map(n,function(e){return"/"+pr.toString(e)});switch(r[1]){case 0:t=r[2];break;case 1:t=""}return pr.toString(i)+t;case 2:return z.ANNOUNCEMENTS_KEY}};var G=function(){};a["albero.IUrlConverterDelegate"]=G,G.__name__=["albero","IUrlConverterDelegate"],G.prototype={__class__:G};var W=function(){};a["puremvc.interfaces.INotifier"]=W,W.__name__=["puremvc","interfaces","INotifier"],W.prototype={__class__:W};var K=function(){this.facade=b.getInstance()};a["puremvc.patterns.observer.Notifier"]=K,K.__name__=["puremvc","patterns","observer","Notifier"],K.__interfaces__=[W],K.prototype={sendNotification:function(e,t,n){this.facade.sendNotification(e,t,n)},__class__:K};var Y=function(){};a["puremvc.interfaces.ICommand"]=Y,Y.__name__=["puremvc","interfaces","ICommand"],Y.prototype={__class__:Y};var V=function(){K.call(this)};a["puremvc.patterns.command.SimpleCommand"]=V,V.__name__=["puremvc","patterns","command","SimpleCommand"],V.__interfaces__=[Y],V.__super__=K,V.prototype=n(K.prototype,{execute:function(e){},__class__:V});var q=function(){V.call(this),A.getInstance().autoBind(this)};a["albero.command.AutoBindCommand"]=q,q.__name__=["albero","command","AutoBindCommand"],q.__super__=V,q.prototype=n(V.prototype,{__class__:q});var Q=function(){q.call(this)};a["albero.command.AccountControlRequestCommand"]=Q,Q.__name__=["albero","command","AccountControlRequestCommand"],Q.__super__=q,Q.prototype=n(q.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.api.acceptAccountControlRequest(n);break;case 1:var i=t[2];this.api.rejectAccountControlRequest(i)}},__class__:Q});var J=a["albero.command.AccountControlRequestAction"]={__ename__:["albero","command","AccountControlRequestAction"],__constructs__:["ACCEPT_REQUEST","REJECT_REQUEST"]};J.ACCEPT_REQUEST=function(e){var t=["ACCEPT_REQUEST",0,e];return t.__enum__=J,t.toString=o,t},J.REJECT_REQUEST=function(e){var t=["REJECT_REQUEST",1,e];return t.__enum__=J,t.toString=o,t},J.__empty_constructs__=[];var X=function(){q.call(this)};a["albero.command.ConferenceCommand"]=X,X.__name__=["albero","command","ConferenceCommand"],X.__super__=q,X.prototype=n(q.prototype,{execute:function(e){var t=this,n=e.getBody();switch(n[1]){case 0:var i=n[3],r=n[2];this.api.joinConference(r,i);break;case 1:var a=n[2];this.api.leaveConference(a);var o=U.filter(this.conferenceStore.getConference(a),function(e){return e.isExpired()});U.foreach(o,function(e){t.conferenceStore.removeConference(e),t.sendNotification("notify_close_conference",e)});break;case 2:var s=n[2];this.api.rejectConference(s)}},__class__:X});var Z=a["albero.command.ConferenceAction"]={__ename__:["albero","command","ConferenceAction"],__constructs__:["JOIN_CONFERENCE","LEAVE_CONFERENCE","REJECT_CONFERENCE"]};Z.JOIN_CONFERENCE=function(e,t){var n=["JOIN_CONFERENCE",0,e,t];return n.__enum__=Z,n.toString=o,n},Z.LEAVE_CONFERENCE=function(e){var t=["LEAVE_CONFERENCE",1,e];return t.__enum__=Z,t.toString=o,t},Z.REJECT_CONFERENCE=function(e){var t=["REJECT_CONFERENCE",2,e];return t.__enum__=Z,t.toString=o,t},Z.__empty_constructs__=[];var $=function(){q.call(this)};a["albero.command.DeviceCommand"]=$,$.__name__=["albero","command","DeviceCommand"],$.__super__=q,$.prototype=n(q.prototype,{execute:function(e){var t=this;e.getBody();require("read")({prompt:"Code: "},function(e,n){t.api.authorizeDevice(n,function(){t.sendNotification("SignIn")})})},__class__:$});var ee=a["albero.command.DeviceAction"]={__ename__:["albero","command","DeviceAction"],__constructs__:["AUTHORIZE"]};ee.AUTHORIZE=["AUTHORIZE",0],ee.AUTHORIZE.toString=o,ee.AUTHORIZE.__enum__=ee,ee.__empty_constructs__=[ee.AUTHORIZE];var te=function(){q.call(this)};a["albero.command.DomainCommand"]=te,te.__name__=["albero","command","DomainCommand"],te.__super__=q,te.prototype=n(q.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.api.acceptDomainInvite(n);break;case 1:var i=t[2];this.api.deleteDomainInvite(i);break;case 2:var r=t[2];this.api.leaveDomain(r)}},__class__:te});var ne=a["albero.command.DomainAction"]={__ename__:["albero","command","DomainAction"],__constructs__:["ACCEPT_INVITE","DELETE_INVITE","LEAVE"]};ne.ACCEPT_INVITE=function(e){var t=["ACCEPT_INVITE",0,e];return t.__enum__=ne,t.toString=o,t},ne.DELETE_INVITE=function(e){var t=["DELETE_INVITE",1,e];return t.__enum__=ne,t.toString=o,t},ne.LEAVE=function(e){var t=["LEAVE",2,e];return t.__enum__=ne,t.toString=o,t},ne.__empty_constructs__=[];var ie=function(){q.call(this)};a["albero.command.FileCommand"]=ie,ie.__name__=["albero","command","FileCommand"],ie.__super__=q,ie.prototype=n(q.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.api.upload(i.domainId,i.id,n);break;case 1:var r=t[4],a=t[3],o=t[2];this.api.uploadMulti(o.domainId,o.id,a,r);break;case 2:var s=t[2];s.deleted=!0,this.api.deleteAttachment(s.id,s.messageId);break;case 3:var l=t[6],u=t[5],c=t[4],_=t[3],h=t[2];this.api.createDownloadAuth(h,_,c,u,l);break;case 4:var d=t[6],f=t[5],m=t[4],p=t[3],g=t[2],v=this.fileService.createDummyFile(p,m,f),y=this.dataStore.getTalk(g);this.api.upload(y.domainId,y.id,v,d);break;case 5:for(var S=t[7],w=t[6],T=t[5],I=t[4],E=t[3],b=t[2],A=[],N=0,k=I.length;N<k;){var D=N++;A.push(this.fileService.createDummyFile(I[D],T[D],w[D]))}var C=this.dataStore.getTalk(b);this.api.uploadMulti(C.domainId,C.id,E,A,S);break;case 6:var O=t[4],R=t[3],M=t[2];this.fileService.download(M,R,O)}},__class__:ie});var re=a["albero.command.FileAction"]={__ename__:["albero","command","FileAction"],__constructs__:["UPLOAD","UPLOAD_MULTI","DELETE","AUTH","UPLOAD_PATH","UPLOAD_MULTI_PATH","DOWNLOAD_PATH"]};re.UPLOAD=function(e,t){var n=["UPLOAD",0,e,t];return n.__enum__=re,n.toString=o,n},re.UPLOAD_MULTI=function(e,t,n){var i=["UPLOAD_MULTI",1,e,t,n];return i.__enum__=re,i.toString=o,i},re.DELETE=function(e){var t=["DELETE",2,e];return t.__enum__=re,t.toString=o,t},re.AUTH=function(e,t,n,i,r){var a=["AUTH",3,e,t,n,i,r];return a.__enum__=re,a.toString=o,a},re.UPLOAD_PATH=function(e,t,n,i,r){var a=["UPLOAD_PATH",4,e,t,n,i,r];return a.__enum__=re,a.toString=o,a},re.UPLOAD_MULTI_PATH=function(e,t,n,i,r,a){var s=["UPLOAD_MULTI_PATH",5,e,t,n,i,r,a];return s.__enum__=re,s.toString=o,s},re.DOWNLOAD_PATH=function(e,t,n){var i=["DOWNLOAD_PATH",6,e,t,n];return i.__enum__=re,i.toString=o,i},re.__empty_constructs__=[];var ae=function(){q.call(this)};a["albero.command.LoadStampSetCommand"]=ae,ae.__name__=["albero","command","LoadStampSetCommand"],ae.__super__=q,ae.prototype=n(q.prototype,{execute:function(e){},__class__:ae});var oe=function(){q.call(this)};a["albero.command.ManageFriendsCommand"]=oe,oe.__name__=["albero","command","ManageFriendsCommand"],oe.__super__=q,oe.prototype=n(q.prototype,{execute:function(e){var t=e.getBody();switch(t.action[1]){case 0:for(var n=0,i=t.users;n<i.length;){var r=i[n];++n,this.api.addFriend(r)}break;case 1:for(var a=0,o=t.users;a<o.length;){var s=o[a];++a,this.api.deleteFriend(s)}}},__class__:oe});var se=a["albero.command.ManageFriendsAction"]={__ename__:["albero","command","ManageFriendsAction"],__constructs__:["ADD","DELETE"]};se.ADD=["ADD",0],se.ADD.toString=o,se.ADD.__enum__=se,se.DELETE=["DELETE",1],se.DELETE.toString=o,se.DELETE.__enum__=se,se.__empty_constructs__=[se.ADD,se.DELETE];var le=function(){q.call(this)};a["albero.command.MessageCommand"]=le,le.__name__=["albero","command","MessageCommand"],le.__super__=q,le.prototype=n(q.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.api.deleteMessage(i,n);break;case 1:var r=t[3],a=t[2];this.api.forwardMessages(a,r,0);break;case 2:var o=t[4],s=t[3],l=t[2];this.api.addFavoriteMessage(l,s,o);break;case 3:var u=t[3],c=t[2];this.api.deleteFavoriteMessage(c,u);break;case 4:var _=t[4],h=t[3],d=t[2];this.api.getFavoriteMessages(d,h,_)}},__class__:le});var ue=a["albero.command.MessageAction"]={__ename__:["albero","command","MessageAction"],__constructs__:["DELETE","FORWARD","ADD_FAVORITE","DELETE_FAVORITE","GET_FAVORITES"]};ue.DELETE=function(e,t){var n=["DELETE",0,e,t];return n.__enum__=ue,n.toString=o,n},ue.FORWARD=function(e,t){var n=["FORWARD",1,e,t];return n.__enum__=ue,n.toString=o,n},ue.ADD_FAVORITE=function(e,t,n){var i=["ADD_FAVORITE",2,e,t,n];return i.__enum__=ue,i.toString=o,i},ue.DELETE_FAVORITE=function(e,t){var n=["DELETE_FAVORITE",3,e,t];return n.__enum__=ue,n.toString=o,n},ue.GET_FAVORITES=function(e,t,n){var i=["GET_FAVORITES",4,e,t,n];return i.__enum__=ue,i.toString=o,i},ue.__empty_constructs__=[];var ce=function(){q.call(this)};a["albero.command.NoteCommand"]=ce,ce.__name__=["albero","command","NoteCommand"],ce.__super__=q,ce.prototype=n(q.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.api.getNoteStatuses(i,n);break;case 1:var r=t[2];this.api.getNote(r);break;case 2:var a=t[6],o=t[5],s=t[4],l=t[3],u=t[2];this.api.createNote(u,l,s,o,a);break;case 3:var c=t[4],_=t[3],h=t[2];this.api.updateNoteSetting(h,_,c);break;case 4:var d=t[7],f=t[6],m=t[5],p=t[4],g=t[3],v=t[2];this.api.updateNote(v,g,p,m,f,d);break;case 5:var y=t[2];this.api.deleteNote(y)}},__class__:ce});var _e=a["albero.command.NoteAction"]={__ename__:["albero","command","NoteAction"],__constructs__:["GET_NOTE_STATUSES","GET_NOTE","CREATE_NOTE","UPDATE_NOTE_SETTING","UPDATE_NOTE","DELETE_NOTE"]};_e.GET_NOTE_STATUSES=function(e,t){var n=["GET_NOTE_STATUSES",0,e,t];return n.__enum__=_e,n.toString=o,n},_e.GET_NOTE=function(e){var t=["GET_NOTE",1,e];return t.__enum__=_e,t.toString=o,t},_e.CREATE_NOTE=function(e,t,n,i,r){var a=["CREATE_NOTE",2,e,t,n,i,r];return a.__enum__=_e,a.toString=o,a},_e.UPDATE_NOTE_SETTING=function(e,t,n){var i=["UPDATE_NOTE_SETTING",3,e,t,n];return i.__enum__=_e,i.toString=o,i},_e.UPDATE_NOTE=function(e,t,n,i,r,a){var s=["UPDATE_NOTE",4,e,t,n,i,r,a];return s.__enum__=_e,s.toString=o,s},_e.DELETE_NOTE=function(e){var t=["DELETE_NOTE",5,e];return t.__enum__=_e,t.toString=o,t},_e.__empty_constructs__=[];var he=function(){q.call(this)};a["albero.command.ReadCommand"]=he,he.__name__=["albero","command","ReadCommand"],he.__super__=q,he.prototype=n(q.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.readStatusUpdater.updateReadStatuses(i,n);break;case 1:var r=t[3],a=t[2];this.readStatusUpdater.updateAnnouncementReadStatus(a,r);break;case 2:var o=t[3],s=t[2];this.api.getReadStatus(s,o);break;case 3:var l=t[3],u=t[2];this.keywordWatcher.readKeywordDetection(u,null,l);break;case 4:var c=t[3],_=t[2];this.keywordWatcher.readKeywordDetection(null,_,c)}},__class__:he});var de=a["albero.command.ReadType"]={__ename__:["albero","command","ReadType"],__constructs__:["TALK","ANNOUNCEMENT","READ_STATUS","KEYWORD_IN_ANNOUNCEMENTS","KEYWORD_IN_MESSAGES"]};de.TALK=function(e,t){var n=["TALK",0,e,t];return n.__enum__=de,n.toString=o,n},de.ANNOUNCEMENT=function(e,t){var n=["ANNOUNCEMENT",1,e,t];return n.__enum__=de,n.toString=o,n},de.READ_STATUS=function(e,t){var n=["READ_STATUS",2,e,t];return n.__enum__=de,n.toString=o,n},de.KEYWORD_IN_ANNOUNCEMENTS=function(e,t){var n=["KEYWORD_IN_ANNOUNCEMENTS",3,e,t];return n.__enum__=de,n.toString=o,n},de.KEYWORD_IN_MESSAGES=function(e,t){var n=["KEYWORD_IN_MESSAGES",4,e,t];return n.__enum__=de,n.toString=o,n},de.__empty_constructs__=[];var fe=function(){q.call(this)};a["albero.command.ReloadDataCommand"]=fe,fe.__name__=["albero","command","ReloadDataCommand"],fe.__super__=q,fe.prototype=n(q.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:this.api.getDomains();break;case 1:this.api.getFriends(),this.api.getAcquaintances();break;case 2:this.api.getTalks();break;case 3:var n=t[5],i=t[4],r=t[3],a=t[2];this.api.getMessages(a,r,i,n);break;case 4:var o=t[2];this.api.getAllUsers(o);break;case 5:var s=t[3],l=t[2];this.api.getUsers(l,s);break;case 6:var u=t[3],c=t[2];this.api.getProfile(c,u);break;case 7:var _=t[3],h=t[2];this.api.searchDomainUsers(h,_);break;case 8:var d=t[4],f=t[3],m=t[2];this.api.getAnnouncements(m,f,d);break;case 9:var p=t[5],g=t[4],v=t[3],y=t[2];this.api.getQuestions(y,v,g,p);break;case 10:var S=t[3],w=t[2];this.api.getQuestion(w,S);break;case 11:var T=t[3],I=t[2];this.api.getAttachments(I,T);break;case 12:var E=t[3],b=t[2];this.api.getSolutions(b,E);break;case 13:this.api.getMe();break;case 14:var A=t[2];this.api.getDepartmentTree(A);break;case 15:var N=t[3],k=t[2];this.api.getDepartmentUsers(k,N);break;case 16:var D=t[2];this.api.getDepartmentAllUsers(D);break;case 17:var C=t[3],O=t[2];this.api.getDepartmentUserCount(O,C)}},__class__:fe});var me=a["albero.command.ReloadDataType"]={__ename__:["albero","command","ReloadDataType"],__constructs__:["Domains","Friends","Talks","Messages","AllUsers","GetUsers","GetProfile","SearchDomainUsers","Announcements","Questions","Question","Files","Solutions","Me","DepartmentTree","DepartmentUsers","DepartmentAllUsers","DepartmentUserCount"]};me.Domains=["Domains",0],me.Domains.toString=o,me.Domains.__enum__=me,me.Friends=["Friends",1],me.Friends.toString=o,me.Friends.__enum__=me,me.Talks=["Talks",2],me.Talks.toString=o,me.Talks.__enum__=me,me.Messages=function(e,t,n,i){var r=["Messages",3,e,t,n,i];return r.__enum__=me,r.toString=o,r},me.AllUsers=function(e){var t=["AllUsers",4,e];return t.__enum__=me,t.toString=o,t},me.GetUsers=function(e,t){var n=["GetUsers",5,e,t];return n.__enum__=me,n.toString=o,n},me.GetProfile=function(e,t){var n=["GetProfile",6,e,t];return n.__enum__=me,n.toString=o,n},me.SearchDomainUsers=function(e,t){var n=["SearchDomainUsers",7,e,t];return n.__enum__=me,n.toString=o,n},me.Announcements=function(e,t,n){var i=["Announcements",8,e,t,n];return i.__enum__=me,i.toString=o,i},me.Questions=function(e,t,n,i){var r=["Questions",9,e,t,n,i];return r.__enum__=me,r.toString=o,r},me.Question=function(e,t){var n=["Question",10,e,t];return n.__enum__=me,n.toString=o,n},me.Files=function(e,t){var n=["Files",11,e,t];return n.__enum__=me,n.toString=o,n},me.Solutions=function(e,t){var n=["Solutions",12,e,t];return n.__enum__=me,n.toString=o,n},me.Me=["Me",13],me.Me.toString=o,me.Me.__enum__=me,me.DepartmentTree=function(e){var t=["DepartmentTree",14,e];return t.__enum__=me,t.toString=o,t},me.DepartmentUsers=function(e,t){var n=["DepartmentUsers",15,e,t];return n.__enum__=me,n.toString=o,n},me.DepartmentAllUsers=function(e){var t=["DepartmentAllUsers",16,e];return t.__enum__=me,t.toString=o,t},me.DepartmentUserCount=function(e,t){var n=["DepartmentUserCount",17,e,t];return n.__enum__=me,n.toString=o,n},me.__empty_constructs__=[me.Domains,me.Friends,me.Talks,me.Me];var pe=function(){q.call(this)};a["albero.command.SearchCommand"]=pe,pe.__name__=["albero","command","SearchCommand"],pe.__super__=q,pe.prototype=n(q.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[4],i=t[3],r=t[2];if(this.searchService.isSearching())return;null==n&&this.searchService.saveParams(r);switch(r.searchType[1]){case 0:this.api.searchMessages(r.copy(),i,n);break;case 1:this.api.searchAttachments(r.copy(),i,n)}break;case 1:this.searchService.clearEditingParams(),this.searchService.clearRecentParams(),this.searchService.clearSearching(),this.sendNotification("notify_search_clear",{})}},__class__:pe});var ge=a["albero.command.SearchAction"]={__ename__:["albero","command","SearchAction"],__constructs__:["SEARCH","CLEAR"]};ge.SEARCH=function(e,t,n){var i=["SEARCH",0,e,t,n];return i.__enum__=ge,i.toString=o,i},ge.CLEAR=["CLEAR",1],ge.CLEAR.toString=o,ge.CLEAR.__enum__=ge,ge.__empty_constructs__=[ge.CLEAR];var ve=function(){q.call(this)};a["albero.command.SelectTalkCommand"]=ve,ve.__name__=["albero","command","SelectTalkCommand"],ve.__super__=q,ve.prototype=n(q.prototype,{execute:function(e){var t=this,n=e.getBody();switch(n[1]){case 0:var i=n[3],a=n[2],o=new gn(a,Sn.NotSelected);this.sendNotification("Url",De.REDIRECT(o.createUrls(i,this.settings)));break;case 1:var s=n[4],l=n[3],u=n[2],c=new gn(u,Sn.TalkSelected(l.id,Ar.Some(s)));this.sendNotification("Url",De.REDIRECT(c.createUrls(l.domainId,this.settings)));break;case 2:var _=n[3],d=n[2],f=new gn(d,Sn.TalkSelected(_.id,Ar.None));this.sendNotification("Url",De.REDIRECT(f.createUrls(_.domainId,this.settings)));break;case 3:var m=n[3],p=n[2],g=new gn(p,Sn.AnnouncementsSelected);this.sendNotification("Url",De.REDIRECT(g.createUrls(m,this.settings)));break;case 4:var v=n[4],y=n[3],S=n[2],w=this.getFallbackUrls(S,h.array(y));if(U.foreach(w,function(e){t.sendNotification("Url",De.REDIRECT(e))}),U.isEmpty(w)){var T=r(this,this.updateSelectionIfNeed),I=S,E=v;h.iter(y,function(e){T(I,E,e)})}}},updateSelectionIfNeed:function(e,t,n){if(t||!this.isSelectionParametersNotChanged(e,n)){var i=n.talkSelection;switch(i[1]){case 0:this.settings.clearSelectedTalk(n.paneType);break;case 1:var r=i[3],a=i[2];this.settings.selectTalk(n.paneType,e,a,r);break;case 2:this.settings.selectAnnouncement(n.paneType)}}},isSelectionParametersNotChanged:function(e,t){var n=this.settings.getSelectedDomainIdOnTalkSelectionChanged();return null!=e&&null!=n&&e.high==n.high&&e.low==n.low&&wn.eqTalkSelection(t.talkSelection,this.settings.getTalkSelection(e,t.paneType))},getFallbackUrls:function(e,t){var n=r(this,this.getValidTalkSelection),i=e,a=t.map(function(e){return n(i,e)});if(!h.exists(a,U.isEmpty))return Ar.None;var o=a.map(r(this,this.getOrNotSelected)),s=1==a.length?j.single(o[0]):j.multi(o);return Ar.Some(B.talks(e,s))},getOrNotSelected:function(e){switch(e[1]){case 0:return e[2];case 1:return Sn.NotSelected}},getValidTalkSelection:function(e,t){var n=t.talkSelection;switch(n[1]){case 0:break;case 1:var i,r=(n[3],n[2]),a=this.dataStore.getTalk(r);if(null!=a){var o=a.domainId;i=!(null!=o&&null!=e&&o.high==e.high&&o.low==e.low)}else i=!0;if(i)return Ar.None;break;case 2:var s=this.dataStore.getDomain(e),l=this.dataStore.getAnnouncementStatus(e);if(!je.hasAnnouncement(s,l))return Ar.None}return Ar.Some(t.talkSelection)},__class__:ve});var ye=a["albero.command.SelectTalkAction"]={__ename__:["albero","command","SelectTalkAction"],__constructs__:["SelectNone","SelectTalkAndMessage","SelectTalk","SelectAnnouncement","UpdateSelection"]};ye.SelectNone=function(e,t){var n=["SelectNone",0,e,t];return n.__enum__=ye,n.toString=o,n},ye.SelectTalkAndMessage=function(e,t,n){var i=["SelectTalkAndMessage",1,e,t,n];return i.__enum__=ye,i.toString=o,i},ye.SelectTalk=function(e,t){var n=["SelectTalk",2,e,t];return n.__enum__=ye,n.toString=o,n},ye.SelectAnnouncement=function(e,t){var n=["SelectAnnouncement",3,e,t];return n.__enum__=ye,n.toString=o,n},ye.UpdateSelection=function(e,t,n){var i=["UpdateSelection",4,e,t,n];return i.__enum__=ye,i.toString=o,i},ye.__empty_constructs__=[];var Se=function(){q.call(this)};a["albero.command.SendCommand"]=Se,Se.__name__=["albero","command","SendCommand"],Se.__super__=q,Se.prototype=n(q.prototype,{execute:function(e){var t,n=e.getBody();if(null!=n.id){var i=n.id;t="_"+i.high+"_"+i.low}else t=null;null!=n.talkId?this.api.createMessage(n.talkId,n.type,n.content,t):this.api.createAnnouncement(n.domainId,n.type,n.content,t)},__class__:Se});var we=function(){q.call(this)};a["albero.command.SignInCommand"]=we,we.__name__=["albero","command","SignInCommand"],we.__super__=q,we.prototype=n(q.prototype,{execute:function(e){this.accessTokenResolver.asyncGetAccessToken(e.getBody(),(oa=this.session,r(oa,oa.start)))},__class__:we});var Te=function(){q.call(this)};a["albero.command.SignOutCommand"]=Te,Te.__name__=["albero","command","SignOutCommand"],Te.__super__=q,Te.prototype=n(q.prototype,{execute:function(e){this.api.deleteSession(),this.settings.clearInputTextForAll(),this.dataStore.clear(!0),si._e("["+_.dateStr(new Date)+"] ","signout","","","",""),process.exit(1)},__class__:Te});var Ie=function(){q.call(this)};a["albero.command.TalkCommand"]=Ie,Ie.__name__=["albero","command","TalkCommand"],Ie.__super__=q,Ie.prototype=n(q.prototype,{execute:function(e){var t=this,n=e.getBody();switch(n[1]){case 0:var i=n[4],r=n[3],a=n[2],o=this.dataStore.getValidPairTalk(r,a);null!=o?this.sendNotification("SelectTalk",ye.SelectTalk(i,o)):this.api.createPairTalk(a,r,i);break;case 1:var s=n[5],l=n[4],u=n[3],c=n[2];this.api.createGroupTalk(c,u,l,s);break;case 2:var _=n[4],h=n[3],d=n[2];this.api.addTalkers(d,h,_);break;case 3:var f=n[4],m=n[3],p=n[2];null==m&&(m=this.dataStore.getTalk(p)),null==f&&(f=this.dataStore.me.id),this.api.deleteTalker(m,f);break;case 4:var g=n[7],v=n[6],y=n[5],S=n[4],w=n[3],T=n[2];if(null==w&&(w=this.dataStore.getTalk(T)),w.type!=dn.GroupTalk)return;null==g&&(g=jr.__cast(w,_n).isSystemMessageVisibled()),this.prepareIconUrl(w.domainId,y,v,function(e){t.api.updateGroupTalk(w,S,e,g)});break;case 5:var I=n[3],E=n[2];this.api.addFavoriteTalk(E,I);break;case 6:var b=n[3],A=n[2];this.api.deleteFavoriteTalk(A,b);break;case 7:var N=n[3],k=n[2];this.api.disablePushNotification(k,N);break;case 8:var D=n[3],C=n[2];this.api.enablePushNotification(C,D)}},prepareIconUrl:function(e,t,n,i){var r=this;null==n&&null!=t?this.api.uploadFile(t,e,Nn.TALK_ICON,function(e){i(e.get_url)},function(e){r.sendNotification("notify_update_group_talk_ERRORED")}):i(n)},__class__:Ie});var Ee=a["albero.command.TalkAction"]={__ename__:["albero","command","TalkAction"],__constructs__:["OPEN_PAIR_TALK","OPEN_GROUP_TALK","ADD","DELETE","UPDATE","ADD_FAVORITE","DELETE_FAVORITE","DISABLE_PUSH_NOTIFICATION","ENABLE_PUSH_NOTIFICATION"]};Ee.OPEN_PAIR_TALK=function(e,t,n){var i=["OPEN_PAIR_TALK",0,e,t,n];return i.__enum__=Ee,i.toString=o,i},Ee.OPEN_GROUP_TALK=function(e,t,n,i){var r=["OPEN_GROUP_TALK",1,e,t,n,i];return r.__enum__=Ee,r.toString=o,r},Ee.ADD=function(e,t,n){var i=["ADD",2,e,t,n];return i.__enum__=Ee,i.toString=o,i},Ee.DELETE=function(e,t,n){var i=["DELETE",3,e,t,n];return i.__enum__=Ee,i.toString=o,i},Ee.UPDATE=function(e,t,n,i,r,a){var s=["UPDATE",4,e,t,n,i,r,a];return s.__enum__=Ee,s.toString=o,s},Ee.ADD_FAVORITE=function(e,t){var n=["ADD_FAVORITE",5,e,t];return n.__enum__=Ee,n.toString=o,n},Ee.DELETE_FAVORITE=function(e,t){var n=["DELETE_FAVORITE",6,e,t];return n.__enum__=Ee,n.toString=o,n},Ee.DISABLE_PUSH_NOTIFICATION=function(e,t){var n=["DISABLE_PUSH_NOTIFICATION",7,e,t];return n.__enum__=Ee,n.toString=o,n},Ee.ENABLE_PUSH_NOTIFICATION=function(e,t){var n=["ENABLE_PUSH_NOTIFICATION",8,e,t];return n.__enum__=Ee,n.toString=o,n},Ee.__empty_constructs__=[];var be=function(){q.call(this)};a["albero.command.UpdateProfileCommand"]=be,be.__name__=["albero","command","UpdateProfileCommand"],be.__super__=q,be.prototype=n(q.prototype,{execute:function(e){var t=e.getBody().domainId,n=e.getBody().profileItemValues,i=e.getBody().copyToAllDomains,r=this.dataStore.getDomain(t);if(null!=r&&null!=r.profileDefinition.itemDefinitions){var a=[];if(i){for(var o=[],s=0;s<n.length;){var l=n[s];++s;var u=Ht.findById(r.profileDefinition.itemDefinitions,l.profileItemId);null!=u&&o.push({name:u.name,value:l.value})}for(var c=0,h=this.dataStore.getDomains();c<h.length;){var d=h[c];if(++c,!d.domainInfo.frozen){for(var f=[],m=0,p=d.profileDefinition.itemDefinitions;m<p.length;){var g=p[m];if(++m,g.visible&&!g.locked)for(var v=0;v<o.length;){var y=o[v];if(++v,y.name==g.name){var S=new zt;S.profileItemId=g.profileItemId,S.value=y.value,f.push(S);break}}}f.length>0&&a.push(new Gt(d.id,f))}}}else{for(var w=[],T=(_.iter(n),0);T<n.length;){var I=n[T];++T;var E=Ht.findById(r.profileDefinition.itemDefinitions,I.profileItemId);null!=E&&E.visible&&!E.locked&&w.push(I)}w.length>0&&a.push(new Gt(r.id,w))}0==a.length?this.sendNotification("update_profile_responsed",this.dataStore.me):this.api.updateProfile(a)}},__class__:be});var Ae=function(){q.call(this)};a["albero.command.UpdateUserCommand"]=Ae,Ae.__name__=["albero","command","UpdateUserCommand"],Ae.__super__=q,Ae.prototype=n(q.prototype,{execute:function(e){var t=e.getBody();(null==t.profileImage||S.startsWith(t.profileImage.type,"image/"))&&this.api.updateUser(t.displayName,t.profileImage,t.profileImageUrl,t.phoneticDisplayName,t.status)},__class__:Ae});var Ne=function(){q.call(this)};a["albero.command.UpdateUserPresencesCommand"]=Ne,Ne.__name__=["albero","command","UpdateUserPresencesCommand"],Ne.__super__=q,Ne.prototype=n(q.prototype,{execute:function(e){var t=e.getBody().domainId,n=e.getBody().userIds;if(null!=t&&null!=n){var i=this.filterOnlyExpired(M.unique(n));0!=i.length&&this.updateIfNeedPerSub(t,i)}},filterOnlyExpired:function(e){var t=this,n=D.nowAsInt64(),i=this.settings.getConfiguration().presenceExpiration,r=new Cn(i>>31,i),a=r;return e.filter(function(e){var i=U.map(t.userPresences.getUserPresence(e),function(e){return e.isExpired(n,a)});switch(i[1]){case 0:return i[2];case 1:return!0}})},updateIfNeedPerSub:function(e,t){var n=t.splice(0,100);0!=n.length&&this.api.getPresences(e,n),0!=t.length&&this.updateIfNeedPerSub(e,t)},__class__:Ne});var ke=function(){q.call(this)};a["albero.command.UrlCommand"]=ke,ke.__name__=["albero","command","UrlCommand"],ke.__super__=q,ke.prototype=n(q.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.routing.forward(n);break;case 1:var i=t[2];this.routing.redirect(i);break;case 2:this.routing.back()}},__class__:ke});var De=a["albero.command.UrlAction"]={__ename__:["albero","command","UrlAction"],__constructs__:["FORWARD","REDIRECT","BACK"]};De.FORWARD=function(e){var t=["FORWARD",0,e];return t.__enum__=De,t.toString=o,t},De.REDIRECT=function(e){var t=["REDIRECT",1,e];return t.__enum__=De,t.toString=o,t},De.BACK=["BACK",2],De.BACK.toString=o,De.BACK.__enum__=De,De.__empty_constructs__=[De.BACK];var Ce=function(e,t,n){this.email=e,this.pass=t,this.accessToken=n};a["albero.entity.Account"]=Ce,Ce.__name__=["albero","entity","Account"],Ce.prototype={__class__:Ce};var Oe=function(e){null!=e&&(this.id=e.id,this.group=new Re(e.group),this.profilePolicy=new Me(e.profile_policy))};a["albero.entity.AccountControlGroup"]=Oe,Oe.__name__=["albero","entity","AccountControlGroup"],Oe.prototype={isAllowedUpdateProfileImage:function(){return null==this.profilePolicy||this.profilePolicy.allowUpdateProfileImage},isAllowedUpdateDisplayName:function(){return null==this.profilePolicy||this.profilePolicy.allowUpdateDisplayName},__class__:Oe};var Re=function(e){null!=e&&(this.name=e.name,this.alias=e.alias,this.ownerName=e.owner_name,this.version=e.version)};a["albero.entity.AccountControlGroupGroup"]=Re,Re.__name__=["albero","entity","AccountControlGroupGroup"],Re.prototype={__class__:Re};var Me=function(e){null!=e&&(this.allowUpdateDisplayName=e.allow_update_display_name,this.allowUpdateProfileImage=e.allow_update_profile_image,this.version=e.version)};a["albero.entity.AccountControlGroupProfilePolicy"]=Me,Me.__name__=["albero","entity","AccountControlGroupProfilePolicy"],Me.prototype={__class__:Me};var xe=function(e){null!=e&&(this.id=e.id,null!=e.group&&(this.group=new Re(e.group)),null!=e.profile_policy&&(this.profilePolicy=new Me(e.profile_policy)))};a["albero.entity.AccountControlGroupPartialUpdate"]=xe,xe.__name__=["albero","entity","AccountControlGroupPartialUpdate"],xe.prototype={__class__:xe};var Fe=function(e){null!=e&&(this.id=M.fromIntOrInt64(e.id),this.groupName=e.group_name,this.groupOwnerName=e.group_owner_name,this.groupOwnerEmail=e.group_owner_email,this.hasDomainInvite=e.has_domain_invite,this.updatedAt=e.updated_at,this.version=e.version)};a["albero.entity.AccountControlRequest"]=Fe,Fe.__name__=["albero","entity","AccountControlRequest"],Fe.prototype={__class__:Fe};var Ue=a["albero.entity.AllowAttachmentTypeValue"]={__ename__:["albero","entity","AllowAttachmentTypeValue"],__constructs__:["ng","ok","image","imageOrVideo","imageOrVideoOrAudio","other"]};Ue.ng=["ng",0],Ue.ng.toString=o,Ue.ng.__enum__=Ue,Ue.ok=["ok",1],Ue.ok.toString=o,Ue.ok.__enum__=Ue,Ue.image=["image",2],Ue.image.toString=o,Ue.image.__enum__=Ue,Ue.imageOrVideo=["imageOrVideo",3],Ue.imageOrVideo.toString=o,Ue.imageOrVideo.__enum__=Ue,Ue.imageOrVideoOrAudio=["imageOrVideoOrAudio",4],Ue.imageOrVideoOrAudio.toString=o,Ue.imageOrVideoOrAudio.__enum__=Ue,Ue.other=["other",5],Ue.other.toString=o,Ue.other.__enum__=Ue,Ue.__empty_constructs__=[Ue.ng,Ue.ok,Ue.image,Ue.imageOrVideo,Ue.imageOrVideoOrAudio,Ue.other];var Pe=function(e){this.value=e};a["albero.entity.AllowAttachmentType"]=Pe,Pe.__name__=["albero","entity","AllowAttachmentType"],Pe.fromInt=function(e){if(null==e)return new Pe(Ue.other);var t;if(null==e)t=Ue.other;else switch(e){case 0:t=Ue.ng;break;case 1:t=Ue.ok;break;case 2:t=Ue.image;break;case 3:t=Ue.imageOrVideo;break;case 4:t=Ue.imageOrVideoOrAudio;break;default:t=Ue.other}return new Pe(t)},Pe.fromValue=function(e){return new Pe(e)},Pe.createAttachmentErrorMessage=function(e,t,n){return null==n&&(n=""),e.compareStrongness(t)>0?e.createAttachmentErrorMessageByNetwork(n):t.createAttachmentErrorMessageByDomain(n)},Pe.prototype={compareStrongness:function(e){return this.getStrongness()-e.getStrongness()},getStrongness:function(){switch(this.value[1]){case 0:return 40;case 2:return 30;case 3:return 20;case 4:return 10;case 1:case 5:return 0}},createAttachmentErrorMessageByDomain:function(e){switch(null==e&&(e=""),this.value[1]){case 0:return oi.localize("AllowAttachmentType.ban_attach_file")+e;case 2:return oi.localize("AllowAttachmentType.ban_attach_file_without_img")+e;case 3:return oi.localize("AllowAttachmentType.ban_attach_file_without_img_movie")+e;case 4:return oi.localize("AllowAttachmentType.ban_attach_file_without_img_movie_sound")+e;default:return""}},createAttachmentErrorMessageByNetwork:function(e){switch(null==e&&(e=""),this.value[1]){case 0:return oi.localize("AllowAttachmentType.network_ban_attach_file")+e;case 2:return oi.localize("AllowAttachmentType.network_ban_attach_file_without_img")+e;case 3:return oi.localize("AllowAttachmentType.network_ban_attach_file_without_img_movie")+e;case 4:return oi.localize("AllowAttachmentType.network_ban_attach_file_without_img_movie_sound")+e;default:return""}},__class__:Pe};var Le=function(e){null!=e&&(this.id=e.announcement_id,this.domainId=e.domain_id,this.groupId=e.group_id,this.groupName=e.group_name,this.type=At.typeOf(e.type),this.content=e.content,this.userId=e.user_id,this.userName=e.user_name,this.createdAt=e.created_at)};a["albero.entity.Announcement"]=Le,Le.__name__=["albero","entity","Announcement"],Le.prototype={getDisplayTextWithoutEscape:function(){return At.getDisplayTextWithoutEscape(this.type,this.content)},getNotificatoinTextWithoutEscape:function(e){switch(null==e&&(e=this.userName),null==e&&(e=""),this.type[1]){case 1:case 6:return e+":"+this.getDisplayTextWithoutEscape();default:return si._e("["+_.dateStr(new Date)+"] ","Unsupported announcement.type is detected. announcment:%o",this,"","",""),At.getUnsupportText()}},__class__:Le};var Be=function(e){this.unreadCount=0,null!=e&&(this.domainId=e.domain_id,this.unreadCount=null!=e.unread_count?e.unread_count:0,this.maxAnnouncementId=e.max_announcement_id,null!=e.max_announcement&&(this.maxAnnouncement=new Le(e.max_announcement)),this.maxReadAnnouncementId=e.max_read_announcement_id)};a["albero.entity.AnnouncementStatus"]=Be,Be.__name__=["albero","entity","AnnouncementStatus"],Be.prototype={updateReadWithStatusUpdate:function(e){var t=0,n=null;if(null!=e.readAnnouncementIds)for(var i=0,r=e.readAnnouncementIds;i<r.length;){var a=r[i];++i;var o;if(null!=this.maxReadAnnouncementId){var s=this.maxReadAnnouncementId,l=a.high-s.high|0;l=0!=l?l:mr.ucompare(a.low,s.low),o=(a.high<0?s.high<0?l:-1:s.high>=0?l:1)>0}else o=!0;if(o){var u;if(null!=n){var c=a.high-n.high|0;c=0!=c?c:mr.ucompare(a.low,n.low),u=(a.high<0?n.high<0?c:-1:n.high>=0?c:1)>0}else u=!0;u&&(n=a),++t}}null!=n&&this.read(n,t)},read:function(e,t){this.maxReadAnnouncementId=e,this.unreadCount-=t,this.unreadCount<0&&(this.unreadCount=0);var n=this.domainId,i=this.maxReadAnnouncementId,r=this.unreadCount;si._d("["+_.dateStr(new Date)+"] ","Announcement status is updated. [domainId, maxReadAnnoundementId, unreadCount]:",n,i,r,"")},
readAll:function(){this.maxReadAnnouncementId=this.maxAnnouncementId,this.unreadCount=0},__class__:Be};var je=function(){};a["albero.entity.AnnouncementStatusHelper"]=je,je.__name__=["albero","entity","AnnouncementStatusHelper"],je.isUnreadAnnouncementExisted=function(e){if(null==e)return!1;if(null==e.maxAnnouncement)return!1;if(null==e.maxReadAnnouncementId)return!0;var t=e.maxAnnouncement.id,n=e.maxReadAnnouncementId,i=t.high-n.high|0;return i=0!=i?i:mr.ucompare(t.low,n.low),(t.high<0?n.high<0?i:-1:n.high>=0?i:1)>0},je.isUnread=function(e,t){if(null!=e.maxReadAnnouncementId){var n=e.maxReadAnnouncementId,i=n.high-t.high|0;return i=0!=i?i:mr.ucompare(n.low,t.low),(n.high<0?t.high<0?i:-1:t.high>=0?i:1)<0}return!0},je.isNewMax=function(e,t){if(null!=e.maxAnnouncementId){var n=e.maxAnnouncementId,i=n.high-t.high|0;return i=0!=i?i:mr.ucompare(n.low,t.low),(n.high<0?t.high<0?i:-1:t.high>=0?i:1)<0}return!0},je.isMax=function(e,t){if(null!=e.maxAnnouncementId){var n=e.maxAnnouncementId;return null!=n&&null!=t&&n.high==t.high&&n.low==t.low}return!1},je.hasAnnouncement=function(e,t){return!(null==e||!e.role.allowReadAnnouncements||null==t)&&null!=t.maxAnnouncementId};var He=function(e){null!=e&&(this.domainId=e.domain_id,this.readAnnouncementIds=e.read_announcement_ids)};a["albero.entity.AnnouncementStatusUpdate"]=He,He.__name__=["albero","entity","AnnouncementStatusUpdate"],He.prototype={__class__:He};var ze=function(e){if(this.notificationInvisibleTalkSound=!0,this.notificationInvisibleTalkPopup=!1,this.notificationVisibleTalkSound=!1,this.notificationVisibleTalkPopup=!1,this.talkAutoScroll=1,this.keywordWatchingText="",this.keywordWatchingEmphasis=!1,this.keywordWatchingSelfMessage=!1,this.keywordWatchingActionReply=!1,this.userDataContainer=[],this.language="ja",this.conferenceIncomingSound=!0,null!=e){if(null!=e.notificationInvisibleTalkSound&&(this.notificationInvisibleTalkSound=e.notificationInvisibleTalkSound),null!=e.notificationInvisibleTalkPopup&&(this.notificationInvisibleTalkPopup=e.notificationInvisibleTalkPopup),null!=e.notificationVisibleTalkSound&&(this.notificationVisibleTalkSound=e.notificationVisibleTalkSound),null!=e.notificationVisibleTalkPopup&&(this.notificationVisibleTalkPopup=e.notificationVisibleTalkPopup),null!=e.notificationVisibleTalkAutoScroll&&(this.talkAutoScroll=e.notificationVisibleTalkAutoScroll?1:3),null!=e.talkAutoScroll&&(this.talkAutoScroll=e.talkAutoScroll),null!=e.keywordWatchingText&&(this.keywordWatchingText=e.keywordWatchingText),null!=e.keywordWatchingEmphasis&&(this.keywordWatchingEmphasis=e.keywordWatchingEmphasis),null!=e.keywordWatchingSelfMessage&&(this.keywordWatchingSelfMessage=e.keywordWatchingSelfMessage),null!=e.keywordWatchingActionReply&&(this.keywordWatchingActionReply=e.keywordWatchingActionReply),null!=e.userDataContainer)for(var t=0,n=jr.__cast(e.userDataContainer,Array);t<n.length;){var i=n[t];++t,this.userDataContainer.push(Ge.fromJson(i))}null!=e.language&&(this.language=e.language),null!=e.conferenceIncomingSound&&(this.conferenceIncomingSound=e.conferenceIncomingSound)}};a["albero.entity.BrowserSettings"]=ze,ze.__name__=["albero","entity","BrowserSettings"],ze.fromJson=function(e){return new ze(e)},ze.prototype={createCopy:function(){var e=new ze(null);return this.copyTo(e),e},equalNotificationSettings:function(e){return e.notificationInvisibleTalkSound==this.notificationInvisibleTalkSound&&e.notificationInvisibleTalkPopup==this.notificationInvisibleTalkPopup&&e.notificationVisibleTalkSound==this.notificationVisibleTalkSound&&e.notificationVisibleTalkPopup==this.notificationVisibleTalkPopup},equalTalkSettings:function(e){return e.talkAutoScroll==this.talkAutoScroll},equalKeywordWatching:function(e){return e.keywordWatchingText==this.keywordWatchingText&&e.keywordWatchingEmphasis==this.keywordWatchingEmphasis&&e.keywordWatchingSelfMessage==this.keywordWatchingSelfMessage&&e.keywordWatchingActionReply==this.keywordWatchingActionReply},equalLanguageSettings:function(e){return e.language==this.language},equalConferenceSettings:function(e){return e.conferenceIncomingSound==this.conferenceIncomingSound},equalUserData:function(e,t){var n=e.getUserData(t),i=this.getUserData(t);if(null==n||null==n)return!0;var r=i.stampHistories.length;if(n.stampHistories.length!=r)return!0;for(var a=0,o=r;a<o;){var s=a++;if(n.stampHistories[s]!=i.stampHistories[s])return!0}return!1},copyTo:function(e){this.copyNotificationSettingsTo(e),this.copyKeywordSettingsTo(e),this.copyTalkSettingsTo(e),this.copyUserDataContainerTo(e),this.copyLanguageSettingsTo(e),this.copyConferenceSettingsTo(e)},copyNotificationSettingsTo:function(e){e.notificationInvisibleTalkSound=this.notificationInvisibleTalkSound,e.notificationInvisibleTalkPopup=this.notificationInvisibleTalkPopup,e.notificationVisibleTalkSound=this.notificationVisibleTalkSound,e.notificationVisibleTalkPopup=this.notificationVisibleTalkPopup},copyKeywordSettingsTo:function(e){e.keywordWatchingText=this.keywordWatchingText,e.keywordWatchingEmphasis=this.keywordWatchingEmphasis,e.keywordWatchingSelfMessage=this.keywordWatchingSelfMessage,e.keywordWatchingActionReply=this.keywordWatchingActionReply},copyTalkSettingsTo:function(e){e.talkAutoScroll=this.talkAutoScroll},copyUserDataContainerTo:function(e){e.userDataContainer=this.userDataContainer},getUserData:function(e){return h.find(this.userDataContainer,function(t){return t.userIdString==e})},copyLanguageSettingsTo:function(e){e.language=this.language},copyConferenceSettingsTo:function(e){e.conferenceIncomingSound=this.conferenceIncomingSound},assureUserData:function(e){var t=this.getUserData(e);return null==t&&(t=Ge.fromUserIdString(e),this.userDataContainer.push(t)),t},__class__:ze};var Ge=function(){};a["albero.entity.UserData"]=Ge,Ge.__name__=["albero","entity","UserData"],Ge.fromUserIdString=function(e){var t=new Ge;return t.userIdString=e,t.stampHistories=[],t.useThumbnailExpansion=!1,t},Ge.fromJson=function(e){var t=new Ge;return null!=e&&(null!=e.userIdString&&(t.userIdString=e.userIdString),null!=e.stampHistories&&(t.stampHistories=e.stampHistories),null!=e.useThumbnailExpansion&&(t.useThumbnailExpansion=e.useThumbnailExpansion)),t},Ge.prototype={__class__:Ge};var We=function(e){null!=e&&(this.userId=e.user_id,this.id=e.conference_id,this.domainId=e.domain_id,this.talkId=e.talk_id,this.messageId=e.message_id,this.createdAt=e.created_at,this.expiredAt=e.expired_at,this.participants=e.participants)};a["albero.entity.Conference"]=We,We.__name__=["albero","entity","Conference"],We.prototype={isIncomingExpired:function(){var e=this.createdAt,t=e.high,n=e.low;return 4294967296*t+(n>=0?n:n+4294967296)+We.INCOMING_TIME<(new Date).getTime()},isExpired:function(){var e=this.expiredAt,t=e.high,n=e.low;return 4294967296*t+(n>=0?n:n+4294967296)<(new Date).getTime()},__class__:We};var Ke=function(e){null!=e&&(this.maxFriends=e.max_friends,this.maxTalks=e.max_talks,this.maxTalkers=e.max_talkers,this.maxMessageContentLength=e.max_message_content_length,this.botExpiredVersion=e.bot_expired_version,this.presenceExpiration=null!=e.presence_expiration?e.presence_expiration:Ke.DEFAULT_PRESENCE_EXPIRATION,this.allowAttachmentType=Pe.fromInt(e.allow_attachment_type))};a["albero.entity.Configuration"]=Ke,Ke.__name__=["albero","entity","Configuration"],Ke.prototype={__class__:Ke};var Ye=function(e){this.contractConference=Ar.None,null!=e&&(this.id=e.contract_id,this.plan=new Lt(e.plan),this.quota=new Jt(e.quota),this.solutionIds=e.solution_ids,null!=e.conference&&(this.contractConference=Ar.Some(new Ve(e.conference))))};a["albero.entity.Contract"]=Ye,Ye.__name__=["albero","entity","Contract"],Ye.prototype={getMaxMessageContentLength:function(){return U.map(U.option(this.quota),function(e){return e.maxMessageContentLength})},getMaxTalkers:function(){return U.flatMap(U.option(this.quota),function(e){return U.option(e.maxTalkers)})},isConferenceEnalbed:function(){return U.isDefined(this.contractConference)},isVideoEnalbed:function(){var e=U.map(this.contractConference,function(e){return e.videoEnabled});switch(e[1]){case 0:return e[2];case 1:return!1}},getConferenceTtl:function(){return U.map(this.contractConference,function(e){return e.ttl})},getConferenceMaxParticipants:function(){return U.map(this.contractConference,function(e){return e.maxConferenceParticipants})},__class__:Ye};var Ve=function(e){this.maxConferenceParticipants=Ve.DEFAULT_MAX_PARTICIPANTS,this.ttl=Ve.DEFAULT_TTL,this.videoEnabled=!1,null!=e&&(this.videoEnabled=e.video_enabled,this.ttl=e.ttl,this.maxConferenceParticipants=e.max_conference_participants)};a["albero.entity.ContractConference"]=Ve,Ve.__name__=["albero","entity","ContractConference"],Ve.prototype={__class__:Ve};var qe=function(e){if(null!=e){this.id=e.department_id,this.order=e.order,this.parentId=e.parent,this.nodeType=null==e.node?Je.Normal:this.parseDepartmentNodeType(e.node);switch(this.nodeType[1]){case 0:this.name=e.name;break;case 1:this.name=qe.getLabelRoot();break;case 2:this.name=qe.getLabelFree()}this.depth=0,this.childrenIds=null,this.userCount=null,this.userIds=null,this.userCountLoading=!1}};a["albero.entity.Department"]=qe,qe.__name__=["albero","entity","Department"],qe.getLabelFree=function(){return oi.localize("Department.label_free")},qe.getLabelRoot=function(){return oi.localize("Department.label_root")},qe.prototype={addChild:function(e){null==this.childrenIds&&(this.childrenIds=[]),this.childrenIds.push(e)},isRoot:function(){return this.nodeType==Je.Root},isFree:function(){return this.nodeType==Je.Free},parseDepartmentNodeType:function(e){switch(e){case 1:return Je.Root;case 2:return Je.Free;default:return Je.Normal}},__class__:qe};var Qe=function(){};a["albero.entity.DepartmentHelper"]=Qe,Qe.__name__=["albero","entity","DepartmentHelper"],Qe.getName=function(e){return null==e?null:e.name};var Je=a["albero.entity.DepartmentNodeType"]={__ename__:["albero","entity","DepartmentNodeType"],__constructs__:["Normal","Root","Free"]};Je.Normal=["Normal",0],Je.Normal.toString=o,Je.Normal.__enum__=Je,Je.Root=["Root",1],Je.Root.toString=o,Je.Root.__enum__=Je,Je.Free=["Free",2],Je.Free.toString=o,Je.Free.__enum__=Je,Je.__empty_constructs__=[Je.Normal,Je.Root,Je.Free];var Xe=function(e){null!=e&&(this.domainId=e.domain_id,this.departments=this.getDepartments(e.departments))};a["albero.entity.DepartmentList"]=Xe,Xe.__name__=["albero","entity","DepartmentList"],Xe.prototype={getDepartments:function(e){return null==e?[]:e.map(function(e){return new qe(e)})},__class__:Xe};var Ze=function(e){null!=e&&(this.departmentId=e.department_id,this.all=e.all,this.partial=e.partial)};a["albero.entity.DepartmentUserCount"]=Ze,Ze.__name__=["albero","entity","DepartmentUserCount"],Ze.prototype={__class__:Ze};var $e=function(e){null!=e&&(this.departments=this.getDepartmentUserCounts(e.departments))};a["albero.entity.DepartmentUserCountList"]=$e,$e.__name__=["albero","entity","DepartmentUserCountList"],$e.prototype={getDepartmentUserCounts:function(e){return null==e?[]:e.map(function(e){return new Ze(e)})},__class__:$e};var et=function(e){null!=e&&(this.id=e.domain_id,this.updatedAt=e.updated_at,this.domainInfo=new tt(e.domain),this.contract=new Ye(e.contract),this.profileDefinition=new jt(e.profile_definition),this.setting=new nt(e.setting),this.role=new rt(e.role),this.closed=!1)};a["albero.entity.Domain"]=et,et.__name__=["albero","entity","Domain"],et.isChangedContractTreeEnabled=function(e,t){return et.isDepartmentEnabled(e)!=et.isDepartmentEnabled(t)},et.isDepartmentEnabled=function(e){return null!=e&&(!!et.isAllowListUser(e)&&!!e.setting.contactTreeEnabled)},et.isAllowListUser=function(e){return null==e||e.role.allowListUsers},et.isChangedRoleType=function(e,t){return(null==e?at.user:e.role.type)!=(null==t?at.user:t.role.type)},et.isChangedMaxTalkers=function(e,t){var n,i=U.flatMap(U.option(e),function(e){return e.getMaxTalkers()});switch(i[1]){case 0:n=i[2];break;case 1:n=0}var r,a=U.flatMap(U.option(t),function(e){return e.getMaxTalkers()});switch(a[1]){case 0:r=a[2];break;case 1:r=0}return n!=r},et.isAllowReadAnnouncement=function(e){return null!=e&&!!e.role.allowReadAnnouncements},et.prototype={getMaxMessageContentLengthOrElse:function(e){var t=U.flatMap(U.option(this.contract),function(e){return e.getMaxMessageContentLength()});switch(t[1]){case 0:return t[2];case 1:return e}},getMaxTalkers:function(){return U.flatMap(U.option(this.contract),function(e){return e.getMaxTalkers()})},__class__:et};var tt=function(e){null!=e&&(this.name=e.domain_name,this.logoUrl=e.logo_url,this.frozen=e.frozen)};a["albero.entity.DomainInfo"]=tt,tt.__name__=["albero","entity","DomainInfo"],tt.prototype={__class__:tt};var nt=function(e){null!=e&&(this.allowAttachmentType=Pe.fromInt(e.allow_attachment_type),this.allowSaveAttachmentsToDevice=e.allow_save_attachments_to_device,null!=e.allow_save_attachments&&(this.allowSaveAttachments=new it(e.allow_save_attachments)),this.allowForwardMessageType=this.allowForwardMessageTypeOf(e.allow_forward_message_type),this.contactTreeEnabled=!!e.contact_tree_enabled)};a["albero.entity.DomainSetting"]=nt,nt.__name__=["albero","entity","DomainSetting"],nt.prototype={allowForwardMessageTypeOf:function(e){switch(e){case 0:return ot.ng;case 1:return ot.ok;case 2:return ot.onlyTextOrStamp;default:return ot.other}},__class__:nt};var it=function(e){null!=e&&(this.web=null==e.web||e.web,this.ios=null==e.ios||e.ios,this.android=null==e.android||e.android,this.desktop=null==e.desktop||e.desktop)};a["albero.entity.DomainSettingAllowSaveAttachments"]=it,it.__name__=["albero","entity","DomainSettingAllowSaveAttachments"],it.prototype={__class__:it};var rt=function(e){if(null!=e){this.type=this.typeOf(e.type);var t=e.allow_guests;this.allowGuests=t||!0;var n=e.allow_create_attachments;this.allowCreateAttachments=n||!0;var i=e.allow_read_attachments;this.allowReadAttachments=i||!0;var r=e.allow_create_announcement;this.allowCreateAnnouncement=r&&r,this.allowReadAnnouncements=e.allow_read_announcements,null==this.allowReadAnnouncements&&(this.allowReadAnnouncements=!0),this.allowListUsers=e.allow_list_users,null==this.allowListUsers&&(this.allowListUsers=!0)}};a["albero.entity.DomainRole"]=rt,rt.__name__=["albero","entity","DomainRole"],rt.prototype={def:function(e,t){return e||t},typeOf:function(e){switch(e){case 10:return at.owner;case 20:return at.manager;case 30:return at.user;default:return at.guest}},__class__:rt};var at=a["albero.entity.DomainRoleType"]={__ename__:["albero","entity","DomainRoleType"],__constructs__:["owner","manager","user","guest"]};at.owner=["owner",0],at.owner.toString=o,at.owner.__enum__=at,at.manager=["manager",1],at.manager.toString=o,at.manager.__enum__=at,at.user=["user",2],at.user.toString=o,at.user.__enum__=at,at.guest=["guest",3],at.guest.toString=o,at.guest.__enum__=at,at.__empty_constructs__=[at.owner,at.manager,at.user,at.guest];var ot=a["albero.entity.DomainAllowForwardMessageType"]={__ename__:["albero","entity","DomainAllowForwardMessageType"],__constructs__:["ng","ok","onlyTextOrStamp","other"]};ot.ng=["ng",0],ot.ng.toString=o,ot.ng.__enum__=ot,ot.ok=["ok",1],ot.ok.toString=o,ot.ok.__enum__=ot,ot.onlyTextOrStamp=["onlyTextOrStamp",2],ot.onlyTextOrStamp.toString=o,ot.onlyTextOrStamp.__enum__=ot,ot.other=["other",3],ot.other.toString=o,ot.other.__enum__=ot,ot.__empty_constructs__=[ot.ng,ot.ok,ot.onlyTextOrStamp,ot.other];var st=function(e){null!=e&&(this.domainId=e.domain_id,this.departments=e.departments)};a["albero.entity.DomainDepartmentPath"]=st,st.__name__=["albero","entity","DomainDepartmentPath"],st.prototype={__class__:st};var lt=function(e){null!=e&&(this.id=e.domain_id,this.name=e.domain_name,this.accountControlRequestId=M.fromIntOrInt64(e.account_control_request_id),this.updatedAt=e.updated_at)};a["albero.entity.DomainInvite"]=lt,lt.__name__=["albero","entity","DomainInvite"],lt.prototype={__class__:lt};var ut=function(e){null!=e&&(this.id=e.user_id,this.status=e.status,this.displayName=e.display_name,this.canonicalDisplayName=e.canonical_display_name,this.phoneticDisplayName=e.phonetic_display_name,this.canonicalPhoneticDisplayName=e.canonical_phonetic_display_name,this.profileImageUrl=e.profile_image_url,this.updatedAt=e.updated_at)};a["albero.entity.User"]=ut,ut.__name__=["albero","entity","User"],ut.prototype={__class__:ut};var ct=function(e){ut.call(this,e),null!=e&&(this.domainId=e.domain_id,null!=e.profile_contact&&(this.profileContact=jr.__cast(e.profile_contact,Array).map(function(e){return new zt(e)})),this.departments=e.departments)};a["albero.entity.DomainUser"]=ct,ct.__name__=["albero","entity","DomainUser"],ct.__super__=ut,ct.prototype=n(ut.prototype,{match:function(e,t){if(this.matchNameOrPhonetic(e))return!0;if(null!=this.profileContact&&null!=t.profileDefinition.itemDefinitions)for(var n=0,i=this.profileContact;n<i.length;){var r=i[n];++n;for(var a=0,o=t.profileDefinition.itemDefinitions;a<o.length;){var s=o[a];if(++a,s.profileItemId==r.profileItemId){if(s.visible&&10==s.group&&r.canonicalValue.indexOf(e)>-1)return!0;break}}}return!1},matchNameOrPhonetic:function(e){if(L.isEmpty(e))return!0;if(L.isEmpty(this.canonicalDisplayName)){this.canonicalDisplayName=hi.canonicalize(this.displayName);var t=this.canonicalDisplayName,n=this.displayName;si._d("["+_.dateStr(new Date)+"] ","create canonical display name from %s to %s.",t,n,"","")}return this.canonicalDisplayName.indexOf(e)>-1||null!=this.canonicalPhoneticDisplayName&&this.canonicalPhoneticDisplayName.indexOf(e)>-1},matchNameOrPhoneticRoman:function(e){if(this.matchNameOrPhonetic(e))return!0;if(L.isEmpty(this.canonicalDisplayNameRoman)){this.canonicalDisplayNameRoman=hi.canonicalizeForRoman(this.displayName);var t=this.canonicalDisplayNameRoman,n=this.displayName;si._d("["+_.dateStr(new Date)+"] ","create canonical display name(roman) from %s to %s.",t,n,"","")}return this.canonicalDisplayNameRoman.indexOf(e)>-1||null!=this.canonicalPhoneticDisplayName&&(L.isEmpty(this.canonicalPhoneticDisplayNameRoman)&&(this.canonicalPhoneticDisplayNameRoman=hi.canonicalizeForRoman(this.canonicalPhoneticDisplayName)),this.canonicalPhoneticDisplayNameRoman.indexOf(e)>-1)},__class__:ct});var _t=function(e){this.values=e};a["albero.entity.Domains"]=_t,_t.__name__=["albero","entity","Domains"],_t.prototype={orderByName:function(){var e=F.sortAndReturn(this.values.map(ht.fromDomain),ht.compare).map(ht.toDomain);return new _t(e)},getOldestDomain:function(){return null==this.values||0==this.values.length?Ar.None:h.fold(this.values,function(e,t){switch(U.filter(t,function(t){var n=t.id,i=e.id,r=n.high-i.high|0;return r=0!=r?r:mr.ucompare(n.low,i.low),(n.high<0?i.high<0?r:-1:i.high>=0?r:1)<=0})[1]){case 0:return U.filter(t,function(t){var n=t.id,i=e.id,r=n.high-i.high|0;return r=0!=r?r:mr.ucompare(n.low,i.low),(n.high<0?i.high<0?r:-1:i.high>=0?r:1)<=0});case 1:return Ar.Some(e)}},Ar.None)},__class__:_t};var ht=function(e){this.domain=e,this.name=e.domainInfo.name,this.canonicalizedName=hi.canonicalize(this.name)};a["albero.entity.DomainForSort"]=ht,ht.__name__=["albero","entity","DomainForSort"],ht.fromDomain=function(e){return new ht(e)},ht.toDomain=function(e){return e.domain},ht.compare=function(e,t){var n=L.compare(e.canonicalizedName,t.canonicalizedName);return 0!=n?n:L.compare(e.name,t.name)},ht.prototype={__class__:ht};var dt=function(e){null!=e&&(this.fileId=e.file_id,this.url=e.get_url,this.headers=new ft(e.get_headers))};a["albero.entity.DownloadAuth"]=dt,dt.__name__=["albero","entity","DownloadAuth"],dt.prototype={__class__:dt};var ft=function(e){this.rawData=e};a["albero.entity.DownloadAuthHeaders"]=ft,ft.__name__=["albero","entity","DownloadAuthHeaders"],ft.prototype={createGetRequest:function(e){var t=new XMLHttpRequest;t.open("GET",e);for(var n=0,i=g.fields(this.rawData);n<i.length;){var r=i[n];++n;var a=g.field(this.rawData,r);t.setRequestHeader(r,a)}return t},__class__:ft};var mt=function(e){null!=e&&(this.domainId=e.domain_id,this.talkId=e.talk_id,this.orderInFavorites=e.order_in_favorites,this.favoriteVersion=e.favorite_version)};a["albero.entity.FavoriteTalkEvent"]=mt,mt.__name__=["albero","entity","FavoriteTalkEvent"],mt.prototype={__class__:mt};var pt=function(e){this.thumbnailDimension=Ar.None,null!=e&&(this.attachmentId=e.attachment_id,this.messageId=e.message_id,this.talkId=e.talk_id,this.id=e.file_id,this.userId=e.user_id,this.name=e.name,this.contentType=e.content_type,this.contentSize=e.content_size,this.url=e.url,this.thumbUrl=e.thumbnail_url,this.updatedAt=e.updated_at,this.file=e.file,this.thumbFile=e.thumbnail_file,this.thumbnailDimension=Ar.None,this.deleted=null!=e.deleted&&e.deleted)};a["albero.entity.FileInfo"]=pt,pt.__name__=["albero","entity","FileInfo"],pt.fromMessageAndFile=function(e,t){var n=new pt;return n.messageId=e.id,n.talkId=e.talkId,n.userId=e.userId,n.updatedAt=e.createdAt,n.id=t.file_id,n.name=t.name,n.contentType=t.content_type,n.contentSize=t.content_size,n.url=t.url,n.thumbUrl=t.thumbnail_url,n.thumbnailDimension=null==t.thumbnail_dimension?Ar.None:Ar.Some(new An(t.thumbnail_dimension)),n.deleted=null!=t.deleted&&t.deleted,n.file=t.file,n},pt.fromMessageAndFileWithFileId=function(e,t,n){var i=pt.fromMessageAndFile(e,t);return i.id=n,i},pt.prototype={hasThumb:function(){return null!=this.thumbUrl||null!=this.thumbFile},isImage:function(){return S.startsWith(this.contentType,"image/")},isImageGif:function(){return S.startsWith(this.contentType,"image/gif")},isPdf:function(){return S.startsWith(this.contentType,"application/pdf")},isVideo:function(){return S.startsWith(this.contentType,"video/")},canDisplayAsThumb:function(){return!!this.hasThumb()||this.isImage()},getNoThumbText:function(){return null!=this.name?this.name:this.url},setDummyThumbnail:function(e){this.thumbFile=e.file,this.thumbnailDimension=Ar.Some(e.dimension)},__class__:pt};var gt=function(e){null!=e&&(this.messageId=e[0],this.talkId=e[1],this.fileId=e[2])};a["albero.entity.FileInfoDeletion"]=gt,gt.__name__=["albero","entity","FileInfoDeletion"],gt.prototype={__class__:gt};var vt=function(e){null!=e&&(this.talkId=e.talk_id,null!=e.messages&&(this.messages=jr.__cast(e.messages,Array).map(function(e){return new yt(e)})))};a["albero.entity.HitContext"]=vt,vt.__name__=["albero","entity","HitContext"],vt.prototype={findHitMessage:function(e){return h.find(this.messages,function(t){var n=t.id;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low})},__class__:vt};var yt=function(e){null!=e&&(this.id=e.message_id,this.talkId=e.talk_id,this.userId=e.user_id,this.type=At.typeOf(e.type),this.content=e.content,this.createdAt=e.created_at,this.hit=e.hit)};a["albero.entity.HitMessage"]=yt,yt.__name__=["albero","entity","HitMessage"],yt.prototype={__class__:yt};var St=function(){};a["albero.entity.IdValue"]=St,St.__name__=["albero","entity","IdValue"],St.prototype={__class__:St};var wt=function(e){null!=e&&(this.conferenceId=e.conference_id,this.roomName=e.room_name,this.credential=e.credential,this.mode=this.parseMode(e.mode),this.timestamp=e.timestamp)};a["albero.entity.JoinConference"]=wt,wt.__name__=["albero","entity","JoinConference"],wt.prototype={parseMode:function(e){return"sfu"==e?Tt.sfu:"fullMesh"==e?Tt.fullMesh:Tt.unknown},isSfu:function(e){switch(this.mode[1]){case 0:return!0;case 1:return!1;case 2:return e.type==dn.GroupTalk}},getEllaspedSecOnJoin:function(){var e=M.fromIntOrInt64(this.credential.timestamp),t=M.fromIntOrInt64(this.timestamp),n=t.high-e.high|0,i=t.low-e.low|0;if(mr.ucompare(t.low,e.low)<0){n--;n|=0}var r=new Cn(n,i),a=r;return a.high<0?0:a.high>0||this.credential.ttl<a.low?this.credential.ttl:a.low},__class__:wt};var Tt=a["albero.entity.JoinConferenceMode"]={__ename__:["albero","entity","JoinConferenceMode"],__constructs__:["sfu","fullMesh","unknown"]};Tt.sfu=["sfu",0],Tt.sfu.toString=o,Tt.sfu.__enum__=Tt,Tt.fullMesh=["fullMesh",1],Tt.fullMesh.toString=o,Tt.fullMesh.__enum__=Tt,Tt.unknown=["unknown",2],Tt.unknown.toString=o,Tt.unknown.__enum__=Tt,Tt.__empty_constructs__=[Tt.sfu,Tt.fullMesh,Tt.unknown];var It=a["albero.entity.LocalErrorType"]={__ename__:["albero","entity","LocalErrorType"],__constructs__:["TalksCountOvered","TalkersCountOvered","SendingMessageConflicted","DeletingMessageConflicted","UploadSizeOvered","StorageSizeOvered","AddingSomeUsersFailure"]};It.TalksCountOvered=function(e){var t=["TalksCountOvered",0,e];return t.__enum__=It,t.toString=o,t},It.TalkersCountOvered=function(e){var t=["TalkersCountOvered",1,e];return t.__enum__=It,t.toString=o,t},It.SendingMessageConflicted=["SendingMessageConflicted",2],It.SendingMessageConflicted.toString=o,It.SendingMessageConflicted.__enum__=It,It.DeletingMessageConflicted=["DeletingMessageConflicted",3],It.DeletingMessageConflicted.toString=o,It.DeletingMessageConflicted.__enum__=It,It.UploadSizeOvered=function(e){var t=["UploadSizeOvered",4,e];return t.__enum__=It,t.toString=o,t},It.StorageSizeOvered=function(e){var t=["StorageSizeOvered",5,e];return t.__enum__=It,t.toString=o,t},It.AddingSomeUsersFailure=["AddingSomeUsersFailure",6],It.AddingSomeUsersFailure.toString=o,It.AddingSomeUsersFailure.__enum__=It,It.__empty_constructs__=[It.SendingMessageConflicted,It.DeletingMessageConflicted,It.AddingSomeUsersFailure];var Et=function(){};a["albero.entity.LocalErrorTypeMixin"]=Et,Et.__name__=["albero","entity","LocalErrorTypeMixin"],Et.toMessage=function(e){switch(e[1]){case 0:var t=e[2];return Ar.Some(oi.localize("LocalErrorType.number_of_talks",{limitMax:t}));case 1:var n=e[2];return Ar.Some(oi.localize("LocalErrorType.number_of_talkers",{limitMax:n}));case 2:return Ar.Some(oi.localize("LocalErrorType.retry_sending"));case 3:return Ar.Some(oi.localize("LocalErrorType.retry_deletion"));case 4:var i=e[2],r=O.createByteSizeStringWithUnit(i);return Ar.Some(oi.localize("LocalErrorType.file_size",{sizeString:r}));case 5:var a=e[2],o=O.createByteSizeStringWithUnit(a);return Ar.Some(oi.localize("LocalErrorType.storage_size",{sizeString:o}));case 6:return Ar.Some(oi.localize("LocalErrorType.adding_users"))}};var bt=function(e){ut.call(this,e),null!=e&&(this.email=e.email,this.signinId=e.signin_id,null!=e.profiles&&(this.profiles=jr.__cast(e.profiles,Array).map(function(e){return new Bt(e)})),null!=e.departments&&(this.departments=jr.__cast(e.departments,Array).map(function(e){return new st(e)})))};a["albero.entity.Me"]=bt,bt.__name__=["albero","entity","Me"],bt.__super__=ut,bt.prototype=n(ut.prototype,{toDomainUser:function(e){var t=new ct;if(t.id=this.id,t.status=this.status,t.domainId=e,t.displayName=this.displayName,t.canonicalDisplayName=this.canonicalDisplayName,t.phoneticDisplayName=this.phoneticDisplayName,t.canonicalPhoneticDisplayName=this.canonicalPhoneticDisplayName,t.profileImageUrl=this.profileImageUrl,t.updatedAt=this.updatedAt,t.email=this.email,null!=this.profiles)for(var n=0,i=this.profiles;n<i.length;){var r=i[n];++n;var a=r.domainId;if(null!=a&&null!=e&&a.high==e.high&&a.low==e.low){t.profileContact=r.itemValues;break}}if(null!=this.departments)for(var o=0,s=this.departments;o<s.length;){var l=s[o];++o;var u=l.domainId;if(null!=u&&null!=e&&u.high==e.high&&u.low==e.low){t.departments=l.departments;break}}return t},__class__:bt});var At=function(e){if(null==e)return this.readUserIds=[],void(this.favorite=new Kn(null));this.id=e.message_id,this.talkId=e.talk_id,this.userId=e.user_id,this.type=At.typeOf(e.type),this.content=e.content,this.createdAt=e.created_at,this.readCount=e.read_count,this.readUserIds=null==e.read_user_ids?[]:e.read_user_ids,this.isUnreadCountTarget=null==e.is_unread_count_target||e.is_unread_count_target,this.isBotMessage=null!=e.bot_message&&e.bot_message,this.favorite=new Kn(e.favorite)};a["albero.entity.Message"]=At,At.__name__=["albero","entity","Message"],At.typeOf=function(e){switch(e){case 0:return Nt.system;case 1:return Nt.text;case 2:return Nt.stamp;case 3:return Nt.geo;case 4:return Nt.file;case 5:return Nt.textMultipleFile;case 7:return Nt.deleted;case 8:return Nt.noteShared;case 9:return Nt.noteDeleted;case 10:return Nt.noteCreated;case 11:return Nt.noteUpdated;case 500:return Nt.yesOrNo;case 501:return Nt.yesOrNoReply;case 502:return Nt.selectOne;case 503:return Nt.selectOneReply;case 504:return Nt.todo;case 505:return Nt.todoDone;case 506:return Nt.yesOrNoClosed;case 507:return Nt.selectOneClosed;case 508:return Nt.todoClosed;case 509:return Nt.openConference;case 600:return Nt.phoneCall;case 601:return Nt.phoneReceive;default:return Nt.unknown}},At.enumIndex=function(e){switch(e[1]){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return e[1];case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:return 500+e[1]-11;case 21:case 22:return 600+e[1]-21;default:return-1}},At.typeString=function(e){return v.string(e)},At.getDisplayTextWithoutEscape=function(e,t){switch(e[1]){case 1:return t;case 6:return At.getDeletedText();default:return si._e("["+_.dateStr(new Date)+"] ","Unsupported message.type is detected.",e,"","",""),At.getUnsupportText()}},At.getDeletedText=function(){return oi.localize("MessageHelper.deleted")},At.getUnsupportText=function(){return oi.localize("MessageHelper.not_support")},At.prototype={getFilesDynamic:function(){switch(this.type[1]){case 4:return[this.content];case 5:return this.content.files;default:return[]}},isDummy:function(){return null!=this.id&&this.id.high<0},messageStringForKeywordDetection:function(e){switch(this.type[1]){case 0:return"";case 1:return this.content;case 2:return null!=this.content.text&&this.content.text.length>0?this.content.text:"";case 3:case 4:return"";case 5:return null!=this.content.text&&this.content.text.length>0?this.content.text:"";case 6:return"";case 11:return[this.content.question,oi.localize("MessageStringMaker.yes"),oi.localize("MessageStringMaker.no")].join(" ");case 12:return e&&null!=this.content.response?this.content.response?oi.localize("MessageStringMaker.yes"):oi.localize("MessageStringMaker.no"):"";case 13:return null!=this.content.options?v.string(this.content.question)+" "+v.string(this.content.options.join(" ")):this.content.question;case 14:return e&&null!=this.content.response&&null!=this.content.options&&this.content.options.length>this.content.response?this.content.options[this.content.response]:"";case 15:return[this.content.title,oi.localize("MessageStringMaker.achieve"),oi.localize("MessageStringMaker.remand")].join(" ");case 16:return e&&null!=this.content.done?this.content.done?oi.localize("MessageStringMaker.achieve"):oi.localize("MessageStringMaker.remand"):"";case 17:case 18:case 19:default:return""}},messageStringForBookmarkWithEllipsis:function(){var e=this.messageStringForBookmark();return e.length<100?e:e.substring(0,99)+""},messageStringForBookmark:function(){switch(this.type[1]){case 1:return this.content;case 2:if(null!=this.content.text&&this.content.text.length>0)return[oi.localize("Message.bookmark_label_stamp"),this.content.text].join(" ");break;case 5:if(null!=this.content.text&&this.content.text.length>0)return this.content.text;break;case 6:return oi.localize("Message.bookmark_label_deleted");case 7:return[oi.localize("Message.bookmark_label_note_shared"),new kt(this.content).title].join(" ");case 9:return[oi.localize("Message.bookmark_label_note_created"),new kt(this.content).title].join(" ");case 10:return[oi.localize("Message.bookmark_label_note_updated"),new kt(this.content).title].join(" ");case 11:case 13:return[oi.localize("Message.bookmark_label_question"),this.content.question].join(" ");case 12:case 14:return[oi.localize("Message.bookmark_label_answer"),this.content.question].join(" ");case 15:return[oi.localize("Message.bookmark_label_task"),this.content.title].join(" ");case 16:return[this.content.done?oi.localize("Message.bookmark_label_completed"):oi.localize("Message.bookmark_label_reverted"),this.content.title].join(" ");case 17:case 18:return[oi.localize("Message.bookmark_label_closed"),this.content.question].join(" ");case 19:
return[oi.localize("Message.bookmark_label_closed"),this.content.title].join(" ")}return""},getContentsForNote:function(){switch(this.type[1]){case 7:case 9:case 10:return Ar.Some(new kt(this.content));default:return Ar.None}},getContentsForNoteDelete:function(){return 8==this.type[1]?Ar.Some(new Dt(this.content)):Ar.None},isAllowedToDelete:function(e){return!!(this.isSentBy(e)&&this.isNotSystemMessage()&&this.isNotActionStampMessage()&&this.isNotNoteMessage())&&this.isNotDeletedMessage()},isAllowedToReply:function(e){return!(!this.isNotSentBy(e)||!this.isNotSystemMessage())&&this.isNotDeletedMessage()},isAllowedToQuote:function(e){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotFileMessage()&&this.isNotStampMessageWithEmptyText())&&this.isNotTextMultipleFileWithEmptyText()},isAllowedToCopy:function(){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotFileMessage()&&this.isNotStampMessageWithEmptyText())&&this.isNotTextMultipleFileWithEmptyText()},isAllowedToForward:function(e){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotActionStampMessage()&&this.isNotDeletedFileMessage(e)&&this.isNotTextMultipleFileAllDeletedWithEmptyText(e)&&this.isNotNoteMessage())&&this.isNotOpenConference()},isAllowedToForwardOnOnlyTextOrStamp:function(){return!(!this.isTextMessage()&&!this.isStampMessage())||this.isTextMultipleFileWithText()},isAllowedToAddToFavorites:function(){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotOpenConference()&&this.isNotStampMessageWithEmptyText()&&this.isNotNoteDeletedMessage())&&this.isNotFavorite()},isAllowedToRemoveFromFavorites:function(){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotOpenConference()&&this.isNotStampMessageWithEmptyText()&&this.isNotNoteDeletedMessage())&&this.isFavorite()},isSentBy:function(e){var t=this.userId;return null!=e&&null!=t&&e.high==t.high&&e.low==t.low},isNotSentBy:function(e){return!this.isSentBy(e)},isSystemMessage:function(){return this.type==Nt.system},isNotSystemMessage:function(){return!this.isSystemMessage()},isActionStampMessage:function(){return this.type==Nt.yesOrNo||this.type==Nt.yesOrNoReply||this.type==Nt.selectOne||this.type==Nt.selectOneReply||this.type==Nt.todo||this.type==Nt.todoDone||this.type==Nt.yesOrNoClosed||this.type==Nt.selectOneClosed||this.type==Nt.todoClosed},isNotActionStampMessage:function(){return!this.isActionStampMessage()},isReplyActionStampMessage:function(){return this.type==Nt.selectOneReply||this.type==Nt.yesOrNoReply||this.type==Nt.todoDone},isClosedActionStampMessage:function(){return this.type==Nt.yesOrNoClosed||this.type==Nt.selectOneClosed||this.type==Nt.todoClosed},isSendingActionStampMessage:function(){return this.type==Nt.yesOrNo||this.type==Nt.selectOne||this.type==Nt.todo},isNoteMessage:function(){return this.type==Nt.noteShared||this.type==Nt.noteDeleted||this.type==Nt.noteCreated||this.type==Nt.noteUpdated},isNoteDeletedMessage:function(){return this.type==Nt.noteDeleted},isNotNoteMessage:function(){return!this.isNoteMessage()},isNotNoteDeletedMessage:function(){return!this.isNoteDeletedMessage()},isDeletedMessage:function(){return this.type==Nt.deleted},isNotDeletedMessage:function(){return!this.isDeletedMessage()},isFileMessage:function(){return this.type==Nt.file},isNotFileMessage:function(){return!this.isFileMessage()},isStampMessage:function(){return this.type==Nt.stamp},isNotStampMessage:function(){return!this.isStampMessage()},isStampMessageWithEmptyText:function(){return!!this.isStampMessage()&&this.isObjectWithEmptyText()},isNotStampMessageWithEmptyText:function(){return!!this.isNotStampMessage()||this.isNotObjectWithEmptyText()},isObjectWithEmptyText:function(){return L.isEmpty(this.content.text)},isNotObjectWithEmptyText:function(){return!this.isObjectWithEmptyText()},isTextMultipleFile:function(){return this.type==Nt.textMultipleFile},isNotTextMultipleFile:function(){return!this.isTextMultipleFile()},isTextMultipleFileWithText:function(){return!!this.isTextMultipleFile()&&this.isNotObjectWithEmptyText()},isTextMultipleFileWithEmptyText:function(){return!!this.isTextMultipleFile()&&this.isObjectWithEmptyText()},isNotTextMultipleFileWithEmptyText:function(){return!!this.isNotTextMultipleFile()||this.isNotObjectWithEmptyText()},isNotDeletedFileMessage:function(e){return!!this.isNotFileMessage()||!e},isNotTextMultipleFileAllDeletedWithEmptyText:function(e){return!!this.isNotTextMultipleFileWithEmptyText()||!e},isTextMessage:function(){return this.type==Nt.text},isOpenConference:function(){return this.type==Nt.openConference},isNotOpenConference:function(){return!this.isOpenConference()},getInReplyTo:function(){var e=this.type;return si._i("["+_.dateStr(new Date)+"] ",e,"","","",""),this.isReplyActionStampMessage()||this.isClosedActionStampMessage()?Ar.Some(this.content.in_reply_to):Ar.None},isNotFavorite:function(){return!this.isFavorite()},isFavorite:function(){return this.favorite.isFavorite()},isNotCalloutHolder:function(){return!(!this.isFileMessage()&&!this.isTextMultipleFileWithEmptyText())||this.isStampMessageWithEmptyText()},close:function(){this.content.closed=!0},updateFavorite:function(e){this.favorite.update(e)},addReadUsersUntillMaxCount:function(e){var t=this;if(!(this.readUserIds.length>=16)){var n=e.filter(function(e){return M.notContains(t.readUserIds,e)});this.readUserIds=this.readUserIds.concat(n).slice(0,16)}},createReadCountText:function(){return this.readUserIds.length>=16?"15+":v.string(this.readUserIds.length)},hasNoReadUsers:function(){return 0==this.readUserIds.length},__class__:At};var Nt=a["albero.entity.MessageType"]={__ename__:["albero","entity","MessageType"],__constructs__:["system","text","stamp","geo","file","textMultipleFile","deleted","noteShared","noteDeleted","noteCreated","noteUpdated","yesOrNo","yesOrNoReply","selectOne","selectOneReply","todo","todoDone","yesOrNoClosed","selectOneClosed","todoClosed","openConference","phoneCall","phoneReceive","unknown"]};Nt.system=["system",0],Nt.system.toString=o,Nt.system.__enum__=Nt,Nt.text=["text",1],Nt.text.toString=o,Nt.text.__enum__=Nt,Nt.stamp=["stamp",2],Nt.stamp.toString=o,Nt.stamp.__enum__=Nt,Nt.geo=["geo",3],Nt.geo.toString=o,Nt.geo.__enum__=Nt,Nt.file=["file",4],Nt.file.toString=o,Nt.file.__enum__=Nt,Nt.textMultipleFile=["textMultipleFile",5],Nt.textMultipleFile.toString=o,Nt.textMultipleFile.__enum__=Nt,Nt.deleted=["deleted",6],Nt.deleted.toString=o,Nt.deleted.__enum__=Nt,Nt.noteShared=["noteShared",7],Nt.noteShared.toString=o,Nt.noteShared.__enum__=Nt,Nt.noteDeleted=["noteDeleted",8],Nt.noteDeleted.toString=o,Nt.noteDeleted.__enum__=Nt,Nt.noteCreated=["noteCreated",9],Nt.noteCreated.toString=o,Nt.noteCreated.__enum__=Nt,Nt.noteUpdated=["noteUpdated",10],Nt.noteUpdated.toString=o,Nt.noteUpdated.__enum__=Nt,Nt.yesOrNo=["yesOrNo",11],Nt.yesOrNo.toString=o,Nt.yesOrNo.__enum__=Nt,Nt.yesOrNoReply=["yesOrNoReply",12],Nt.yesOrNoReply.toString=o,Nt.yesOrNoReply.__enum__=Nt,Nt.selectOne=["selectOne",13],Nt.selectOne.toString=o,Nt.selectOne.__enum__=Nt,Nt.selectOneReply=["selectOneReply",14],Nt.selectOneReply.toString=o,Nt.selectOneReply.__enum__=Nt,Nt.todo=["todo",15],Nt.todo.toString=o,Nt.todo.__enum__=Nt,Nt.todoDone=["todoDone",16],Nt.todoDone.toString=o,Nt.todoDone.__enum__=Nt,Nt.yesOrNoClosed=["yesOrNoClosed",17],Nt.yesOrNoClosed.toString=o,Nt.yesOrNoClosed.__enum__=Nt,Nt.selectOneClosed=["selectOneClosed",18],Nt.selectOneClosed.toString=o,Nt.selectOneClosed.__enum__=Nt,Nt.todoClosed=["todoClosed",19],Nt.todoClosed.toString=o,Nt.todoClosed.__enum__=Nt,Nt.openConference=["openConference",20],Nt.openConference.toString=o,Nt.openConference.__enum__=Nt,Nt.phoneCall=["phoneCall",21],Nt.phoneCall.toString=o,Nt.phoneCall.__enum__=Nt,Nt.phoneReceive=["phoneReceive",22],Nt.phoneReceive.toString=o,Nt.phoneReceive.__enum__=Nt,Nt.unknown=["unknown",23],Nt.unknown.toString=o,Nt.unknown.__enum__=Nt,Nt.__empty_constructs__=[Nt.system,Nt.text,Nt.stamp,Nt.geo,Nt.file,Nt.textMultipleFile,Nt.deleted,Nt.noteShared,Nt.noteDeleted,Nt.noteCreated,Nt.noteUpdated,Nt.yesOrNo,Nt.yesOrNoReply,Nt.selectOne,Nt.selectOneReply,Nt.todo,Nt.todoDone,Nt.yesOrNoClosed,Nt.selectOneClosed,Nt.todoClosed,Nt.openConference,Nt.phoneCall,Nt.phoneReceive,Nt.unknown];var kt=function(e){null!=e&&(this.noteId=new Qn(e.note_id),this.title=e.title,this.revision=e.revision,this.deleted=e.deleted)};a["albero.entity.MessageContentForNote"]=kt,kt.__name__=["albero","entity","MessageContentForNote"],kt.prototype={__class__:kt};var Dt=function(e){null!=e&&(this.noteId=new Qn(e.note_id),this.title=e.title)};a["albero.entity.MessageContentForNoteDeleted"]=Dt,Dt.__name__=["albero","entity","MessageContentForNoteDeleted"],Dt.prototype={__class__:Dt};var Ct=function(e){null!=e&&(this.talkId=e[0],this.messageId=e[1])};a["albero.entity.MessageDeletion"]=Ct,Ct.__name__=["albero","entity","MessageDeletion"],Ct.prototype={__class__:Ct};var Ot=function(e){this.id=e.message_id,this.talkId=e.talk_id,this.readUserIds=null==e.read_user_ids?[]:e.read_user_ids,this.unreadUserIds=null==e.unread_user_ids?[]:e.unread_user_ids};a["albero.entity.MessageReadStatus"]=Ot,Ot.__name__=["albero","entity","MessageReadStatus"],Ot.prototype={__class__:Ot};var Rt=function(e){this.talkId=e.talk_id,this.messageIds=e.message_ids,this.readUserIds=null==e.read_user_ids?[]:e.read_user_ids,this.messageIdsExcludingUnreadCountTargets=e.message_ids_excluding_unread_count_targets,null==this.messageIdsExcludingUnreadCountTargets&&(this.messageIdsExcludingUnreadCountTargets=[])};a["albero.entity.MessageReadStatusesUpdate"]=Rt,Rt.__name__=["albero","entity","MessageReadStatusesUpdate"],Rt.prototype={__class__:Rt};var Mt=a["albero.entity.MessagesOrder"]={__ename__:["albero","entity","MessagesOrder"],__constructs__:["asc","desc"]};Mt.asc=["asc",0],Mt.asc.toString=o,Mt.asc.__enum__=Mt,Mt.desc=["desc",1],Mt.desc.toString=o,Mt.desc.__enum__=Mt,Mt.__empty_constructs__=[Mt.asc,Mt.desc];var xt=function(){};a["albero.entity.MessagesOrderProc"]=xt,xt.__name__=["albero","entity","MessagesOrderProc"],xt.orderToInt=function(e){switch(e[1]){case 0:return 1;case 1:return 2}};var Ft=a["albero.entity.PaneType"]={__ename__:["albero","entity","PaneType"],__constructs__:["SingleTalkPane","MultiTalkPane1","MultiTalkPane2","MultiTalkPane3"]};Ft.SingleTalkPane=["SingleTalkPane",0],Ft.SingleTalkPane.toString=o,Ft.SingleTalkPane.__enum__=Ft,Ft.MultiTalkPane1=["MultiTalkPane1",1],Ft.MultiTalkPane1.toString=o,Ft.MultiTalkPane1.__enum__=Ft,Ft.MultiTalkPane2=["MultiTalkPane2",2],Ft.MultiTalkPane2.toString=o,Ft.MultiTalkPane2.__enum__=Ft,Ft.MultiTalkPane3=["MultiTalkPane3",3],Ft.MultiTalkPane3.toString=o,Ft.MultiTalkPane3.__enum__=Ft,Ft.__empty_constructs__=[Ft.SingleTalkPane,Ft.MultiTalkPane1,Ft.MultiTalkPane2,Ft.MultiTalkPane3];var Ut=function(){};a["albero.entity.PaneTypeHelper"]=Ut,Ut.__name__=["albero","entity","PaneTypeHelper"],Ut.toPanePrefix=function(e){switch(e[1]){case 0:return"";case 1:return"multi1-";case 2:return"multi2-";case 3:return"multi3-"}},Ut.getPaneType=function(e){switch(e){case 0:return Ft.SingleTalkPane;case 1:return Ft.MultiTalkPane1;case 2:return Ft.MultiTalkPane2;case 3:return Ft.MultiTalkPane3;default:return null}},Ut.getMultiPaneType=function(e){switch(e){case 0:return Ft.MultiTalkPane1;case 1:return Ft.MultiTalkPane2;case 2:return Ft.MultiTalkPane3;default:return Ft.MultiTalkPane1}},Ut.getMultiPaneTypes=function(){return[Ft.MultiTalkPane1,Ft.MultiTalkPane2,Ft.MultiTalkPane3]};var Pt=function(e){null!=e&&(this.expiration=e.expiration,this.warning=e.warning)};a["albero.entity.PasswordExpiration"]=Pt,Pt.__name__=["albero","entity","PasswordExpiration"],Pt.prototype={isExpired:function(e){return this.timeOvered(this.expiration,e)},needWarning:function(e,t){return!!this.timeOveredOrNotExist(t,e)&&this.timeOvered(this.warning,e)},timeOvered:function(e,t){if(null!=e){var n=t.high-e.high|0;return n=0!=n?n:mr.ucompare(t.low,e.low),(t.high<0?e.high<0?n:-1:e.high>=0?n:1)>0}return!1},timeOveredOrNotExist:function(e,t){return null==e||this.timeOvered(e,t)},__class__:Pt};var Lt=function(e){null!=e&&(this.name=e.plan_name,this.trial=e.trial)};a["albero.entity.Plan"]=Lt,Lt.__name__=["albero","entity","Plan"],Lt.prototype={__class__:Lt};var Bt=function(e){null!=e&&(this.domainId=e.domain_id,this.userId=e.user_id,this.itemValues=null,null!=e.item_values&&(this.itemValues=jr.__cast(e.item_values,Array).map(function(e){return new zt(e)})))};a["albero.entity.Profile"]=Bt,Bt.__name__=["albero","entity","Profile"],Bt.prototype={__class__:Bt};var jt=function(e){if(null!=e&&(this.domainId=e.domain_id,null!=e.item_definitions)){this.itemDefinitions=[];for(var t=0,n=jr.__cast(e.item_definitions,Array);t<n.length;){var i=n[t];++t,this.itemDefinitions.push(new Ht(i))}}};a["albero.entity.ProfileDefinition"]=jt,jt.__name__=["albero","entity","ProfileDefinition"],jt.isSameProfileItemDefinitions=function(e,t){if(t.length!=e.length)return!1;for(var n=0,i=t.length;n<i;){var r=n++;if(t[r].profileItemId!=e[r].profileItemId)return!1}return!0},jt.prototype={getVisibleItemDefinitions:function(e,t){return null==t&&(t=!1),null==e&&(e=!1),null==this.itemDefinitions?[]:this.itemDefinitions.filter(function(n){return!!n.visible&&(!(!e&&10!=n.group)&&(!t||1!=n.profileItemId&&2!=n.profileItemId))})},__class__:jt};var Ht=function(e){this.locked=!1,this.visible=!0,null!=e&&(this.profileItemId=e.profile_item_id,this.group=e.group,this.name=e.name,this.valueType=e.value_type,null!=e.visible&&(this.visible=e.visible),null!=e.locked&&(this.locked=e.locked))};a["albero.entity.ProfileItemDefinition"]=Ht,Ht.__name__=["albero","entity","ProfileItemDefinition"],Ht.findById=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.profileItemId==t)return i}return null},Ht.prototype={__class__:Ht};var zt=function(e){null!=e&&(this.profileItemId=e.profile_item_id,this.value=e.value,this.canonicalValue=e.canonical_value)};a["albero.entity.ProfileItemValue"]=zt,zt.__name__=["albero","entity","ProfileItemValue"],zt.findById=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.profileItemId==t)return i}return null},zt.prototype={__class__:zt};var Gt=function(e,t){this.domainId=e,this.profileItemValues=t};a["albero.entity.ProfileItemValuesPerDomain"]=Gt,Gt.__name__=["albero","entity","ProfileItemValuesPerDomain"],Gt.convertToApiParams=function(e){return e.map(function(e){return e.convertToApiParamsPerDomain()})},Gt.prototype={convertToApiParamsPerDomain:function(){return[this.domainId,this.profileItemValues.map(function(e){return{profile_item_id:e.profileItemId,value:e.value}})]},__class__:Gt};var Wt=function(e){if(null==e)return this.enabled=!0,void(this.version=0);this.enabled=null==e.enabled||e.enabled,this.version=e.version};a["albero.entity.PushNotificationSetting"]=Wt,Wt.__name__=["albero","entity","PushNotificationSetting"],Wt.createWithParams=function(e,t){var n=new Wt;return n.enabled=e,n.version=t,n},Wt.prototype={__class__:Wt};var Kt=function(e){null!=e&&(this.id=e.message_id,this.talkId=e.talk_id,this.type=At.typeOf(e.type),this.content=e.content,this.userId=e.user_id,this.recipientIds=e.assigned_user_ids,this.responses=Kt.createResponses(e.responses),this.listing=e.listing,this.closingType=Kt.closeingTypeOf(e.closing_type),this.maxResponseId=e.max_response_id,this.lastResponse=e.last_response,this.lastResponseUserId=e.last_response_user_id,this.createdAt=e.created_at,this.updatedAt=e.updated_at,this.responded=e.responded,this.closed=e.closed)};a["albero.entity.Question"]=Kt,Kt.__name__=["albero","entity","Question"],Kt.createResponses=function(e){var t,n=U.option(e);switch(n[1]){case 0:t=n[2];break;case 1:t=[]}return t.map(function(e){return new Yt(e)})},Kt.createResponsesFromStrings=function(e){var t,n=U.option(e);switch(n[1]){case 0:t=n[2];break;case 1:t=[]}return t.map(function(e){var t=new Yt;return t.content=e,t})},Kt.closeingTypeOf=function(e){switch(e){case 0:return Vt.any;case 1:return Vt.all;default:return Vt.unknown}},Kt.createResponseTexts=function(e,t){switch(e[1]){case 11:return["YES","NO"];case 13:return t;case 15:return["DONE","UNDONE"];default:return[]}},Kt.fromMessageAndTalk=function(e,t){var n=new Kt;n.id=e.id,n.talkId=e.talkId,n.type=e.type;var i,r=U.option(e.content.title);switch(r[1]){case 0:i=r[2];break;case 1:i=e.content.question}n.content=i,n.userId=e.userId,n.recipientIds=t.userIds,n.responses=Kt.createResponsesFromStrings(Kt.createResponseTexts(e.type,e.content.options));var a,o=U.option(e.content.listing);switch(o[1]){case 0:a=o[2];break;case 1:a=!0}n.listing=a,n.closingType=Kt.closeingTypeOf(e.content.closing_type),n.maxResponseId=null,n.lastResponse=null,n.lastResponseUserId=null,n.updatedAt=n.createdAt=e.createdAt,n.responded=!1;var s,l=U.option(e.content.closed);switch(l[1]){case 0:s=l[2];break;case 1:s=!1}return n.closed=s,n},Kt.createTodoDoneMessageWithParams=function(e,t,n){var i=new At;return i.talkId=e,i.type=Nt.todoDone,i.content={in_reply_to:t,done:n},i},Kt.createYesOrNoReplyMessageWithParams=function(e,t,n){var i=new At;return i.talkId=e,i.content={in_reply_to:t,response:n},i.type=Nt.yesOrNoReply,i},Kt.createSelectOneReplyMessageWithParams=function(e,t,n){var i=new At;return i.talkId=e,i.content={in_reply_to:t,response:n},i.type=Nt.selectOneReply,i},Kt.fromTypeToInt=function(e){switch(e[1]){case 0:return 0;case 1:return 1}},Kt.filterToOpBool=function(e){switch(e[1]){case 0:return Ar.Some(!0);case 1:return Ar.Some(!1);case 2:return Ar.None}},Kt.isDoneResponse=function(e){return"DONE"==e.content},Kt.prototype={isCompleted:function(e){if(I.enumEq(this.type,Nt.todo)){if(I.enumEq(this.closingType,Vt.any)){if(null!=this.lastResponse&&"DONE"==this.responses[this.lastResponse].content)return!0}else{if(!this.responded)return!1;for(var t=0,n=this.responses;t<n.length;){var i=n[t];if(++t,M.contains(i.userIds,e))return"DONE"==i.content}}return!1}return I.enumEq(this.closingType,Vt.any)?null!=this.lastResponse:this.responded},createTodoDoneMessage:function(e){return Kt.createTodoDoneMessageWithParams(this.talkId,this.id,e)},createYesOrNoReplyMessage:function(e){return Kt.createYesOrNoReplyMessageWithParams(this.talkId,this.id,e)},createSelectOneReplyMessage:function(e){return Kt.createSelectOneReplyMessageWithParams(this.talkId,this.id,e)},createActionCloseMessage:function(){var e=new At;switch(e.talkId=this.talkId,e.content={in_reply_to:this.id},this.type[1]){case 11:e.type=Nt.yesOrNoClosed;break;case 13:e.type=Nt.selectOneClosed;break;case 15:e.type=Nt.todoClosed;break;default:si._e("["+_.dateStr(new Date)+"] ","message type is not action.","","","","")}return e},getLastResponse:function(){var e=this;return U.map(U.option(this.lastResponse),function(t){return e.responses[t]})},getLastDoneResponse:function(){return U.filter(this.getLastResponse(),Kt.isDoneResponse)},getDoneResponse:function(){return U.option(h.find(this.responses,Kt.isDoneResponse))},isSendingQuestion:function(){return this.type==Nt.yesOrNo||this.type==Nt.selectOne||this.type==Nt.todo},isNotSendingQuestion:function(){return!this.isSendingQuestion()},__class__:Kt};var Yt=function(e){null!=e&&(this.content=e.content,this.count=e.count,this.userIds=e.user_ids)};a["albero.entity.QuestionResponse"]=Yt,Yt.__name__=["albero","entity","QuestionResponse"],Yt.prototype={__class__:Yt};var Vt=a["albero.entity.QuestionClosingType"]={__ename__:["albero","entity","QuestionClosingType"],__constructs__:["any","all","unknown"]};Vt.any=["any",0],Vt.any.toString=o,Vt.any.__enum__=Vt,Vt.all=["all",1],Vt.all.toString=o,Vt.all.__enum__=Vt,Vt.unknown=["unknown",2],Vt.unknown.toString=o,Vt.unknown.__enum__=Vt,Vt.__empty_constructs__=[Vt.any,Vt.all,Vt.unknown];var qt=a["albero.entity.QuestionFromType"]={__ename__:["albero","entity","QuestionFromType"],__constructs__:["fromSelf","fromOther"]};qt.fromSelf=["fromSelf",0],qt.fromSelf.toString=o,qt.fromSelf.__enum__=qt,qt.fromOther=["fromOther",1],qt.fromOther.toString=o,qt.fromOther.__enum__=qt,qt.__empty_constructs__=[qt.fromSelf,qt.fromOther];var Qt=a["albero.entity.QuestionFilter"]={__ename__:["albero","entity","QuestionFilter"],__constructs__:["onlyClosed","onlyUnclosed","noFilter"]};Qt.onlyClosed=["onlyClosed",0],Qt.onlyClosed.toString=o,Qt.onlyClosed.__enum__=Qt,Qt.onlyUnclosed=["onlyUnclosed",1],Qt.onlyUnclosed.toString=o,Qt.onlyUnclosed.__enum__=Qt,Qt.noFilter=["noFilter",2],Qt.noFilter.toString=o,Qt.noFilter.__enum__=Qt,Qt.__empty_constructs__=[Qt.onlyClosed,Qt.onlyUnclosed,Qt.noFilter];var Jt=function(e){null!=e&&(this.msgRetentionPeriod=e.msg_retention_period,this.msgFileSize=e.msg_file_size,this.maxMessageContentLength=e.max_message_content_length,this.maxTalkers=e.max_talkers,this.maxTalks=e.max_talks)};a["albero.entity.Quota"]=Jt,Jt.__name__=["albero","entity","Quota"],Jt.prototype={__class__:Jt};var Xt=function(e){if(null!=e&&(this.total=e.total,this.marker=e.marker,this.nextMarker=e.next_marker,this.contents=[],null!=e.contents))for(var t=0,n=jr.__cast(e.contents,Array);t<n.length;){var i=n[t];++t,this.contents.push(new pt(i))}};a["albero.entity.SearchAttachmentsResult"]=Xt,Xt.__name__=["albero","entity","SearchAttachmentsResult"],Xt.prototype={__class__:Xt};var Zt=function(e){null!=e&&(this.total=e.total,this.marker=e.marker,this.nextMarker=e.next_marker,this.contents=[],null!=e.contents&&(this.contents=jr.__cast(e.contents,Array).map(function(e){return new vt(e)})))};a["albero.entity.SearchMessagesResult"]=Zt,Zt.__name__=["albero","entity","SearchMessagesResult"],Zt.prototype={__class__:Zt};var $t=function(e){null!=e&&(null!=e.domain_id_str&&(this.domainId=M.makeFromIdStr(e.domain_id_str)),null!=e.talk_id_str&&(this.talkId=M.makeFromIdStr(e.talk_id_str)),this.keyword=e.keyword,null==e.search_type||e.search_type==tn.toLocalizeText(en.MESSAGES)?this.searchType=en.MESSAGES:this.searchType=en.ATTACHMENTS,this.sinceText=e.since,this.untilText=e.until,null!=e.from_id_str&&(this.fromUserId=M.makeFromIdStr(e.from_id_str)))};a["albero.entity.SearchParams"]=$t,$t.__name__=["albero","entity","SearchParams"],$t.dateQueryToText=function(e,t){if(null==e)return t;switch(e){case"-1d":return oi.localize("SearchParams.text_date_yesterday");case"-3d":return oi.localize("SearchParams.text_date_three_days_before");case"t":return oi.localize("SearchParams.text_date_today");default:return S.replace(e,"-","/")}},$t.prototype={toProps:function(){var e={};if(null!=this.domainId){var t=this.domainId;e.domain_id_str="_"+t.high+"_"+t.low}if(null!=this.talkId){var n=this.talkId;e.talk_id_str="_"+n.high+"_"+n.low}if(e.keyword=this.keyword,e.search_type=tn.toLocalizeText(this.searchType),e.since=this.sinceText,e.until=this.untilText,null!=this.fromUserId){var i=this.fromUserId;e.from_id_str="_"+i.high+"_"+i.low}return e},copy:function(){return new $t(this.toProps())},eq:function(e){return!!this.isSameInt64(this.domainId,e.domainId)&&(!!this.isSameInt64(this.talkId,e.talkId)&&(this.keyword==e.keyword&&(!!I.enumEq(this.searchType,e.searchType)&&(this.sinceText==e.sinceText&&(this.untilText==e.untilText&&!!this.isSameInt64(this.fromUserId,e.fromUserId))))))},isSameInt64:function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.high==t.high&&e.low==t.low},getQueryText:function(){var e=[];return null!=this.keyword&&0!=this.keyword.length&&e.push(this.keyword),null!=this.sinceText&&e.push("since:"+this.sinceText),null!=this.untilText&&e.push("until:"+this.untilText),null!=this.fromUserId&&e.push("from:"+pr.toString(this.fromUserId)),e.join(" ")},getPeriodText:function(){return $t.dateQueryToText(this.sinceText,"")+"~"+$t.dateQueryToText(this.untilText,"")},__class__:$t};var en=a["albero.entity.SearchType"]={__ename__:["albero","entity","SearchType"],__constructs__:["MESSAGES","ATTACHMENTS"]};en.MESSAGES=["MESSAGES",0],en.MESSAGES.toString=o,en.MESSAGES.__enum__=en,en.ATTACHMENTS=["ATTACHMENTS",1],en.ATTACHMENTS.toString=o,en.ATTACHMENTS.__enum__=en,en.__empty_constructs__=[en.MESSAGES,en.ATTACHMENTS];var tn=function(){};a["albero.entity.SearchTypeUtil"]=tn,tn.__name__=["albero","entity","SearchTypeUtil"],tn.toLocalizeText=function(e){switch(e[1]){case 0:return oi.localize("SearchParams.text_type_messages");case 1:return oi.localize("SearchParams.text_type_attachments")}};var nn=a["albero.entity.SearchDate"]={__ename__:["albero","entity","SearchDate"],__constructs__:["DATE_NONE","DATE_TODAY","DATE_YESTERDAY","DATE_THREE_DAYS_BEFORE","DATE_CALENDAR"]};nn.DATE_NONE=["DATE_NONE",0],nn.DATE_NONE.toString=o,nn.DATE_NONE.__enum__=nn,nn.DATE_TODAY=["DATE_TODAY",1],nn.DATE_TODAY.toString=o,nn.DATE_TODAY.__enum__=nn,nn.DATE_YESTERDAY=["DATE_YESTERDAY",2],nn.DATE_YESTERDAY.toString=o,nn.DATE_YESTERDAY.__enum__=nn,nn.DATE_THREE_DAYS_BEFORE=["DATE_THREE_DAYS_BEFORE",3],nn.DATE_THREE_DAYS_BEFORE.toString=o,nn.DATE_THREE_DAYS_BEFORE.__enum__=nn,nn.DATE_CALENDAR=["DATE_CALENDAR",4],nn.DATE_CALENDAR.toString=o,nn.DATE_CALENDAR.__enum__=nn,nn.__empty_constructs__=[nn.DATE_NONE,nn.DATE_TODAY,nn.DATE_YESTERDAY,nn.DATE_THREE_DAYS_BEFORE,nn.DATE_CALENDAR];var rn=function(){};a["albero.entity.SearchDateUtil"]=rn,rn.__name__=["albero","entity","SearchDateUtil"],rn.createSearchDateArray=function(e){return e?[nn.DATE_TODAY,nn.DATE_YESTERDAY,nn.DATE_THREE_DAYS_BEFORE,nn.DATE_CALENDAR]:[nn.DATE_YESTERDAY,nn.DATE_THREE_DAYS_BEFORE,nn.DATE_CALENDAR]},rn.toLocalizeText=function(e){switch(e[1]){case 0:return oi.localize("SearchParams.text_date_none");case 1:return oi.localize("SearchParams.text_date_today");case 2:return oi.localize("SearchParams.text_date_yesterday");case 3:return oi.localize("SearchParams.text_date_three_days_before");case 4:return oi.localize("SearchParams.text_date_calendar")}};var an=function(e){null!=e&&(this.user=new bt(e.user),this.device=e.device,this.notification=e.notification,this.passwordExpiration=new Pt(e.password_expiration),this.configuration=new Ke(e.configuration))};a["albero.entity.Session"]=an,an.__name__=["albero","entity","Session"],an.prototype={__class__:an};var on=function(e){null!=e&&(this.solutionId=e.solution_id,this.name=e.name,null!=e.link&&(this.link=new sn(e.link)),null!=e.plugin&&(this.plugin=new ln(e.plugin)))};a["albero.entity.Solution"]=on,on.__name__=["albero","entity","Solution"],on.getSolutionType=function(e){switch(e){case 1:return un.PhotoViewTrial;case 2:return un.PhotoView;case 3:return un.MultiView;case 4:return un.KeywordWatching;default:return un.Unknown}},on.prototype={__class__:on};var sn=function(e){null!=e&&(this.iconUrl=e.icon_url,this.url=e.url)};a["albero.entity.SolutionLink"]=sn,sn.__name__=["albero","entity","SolutionLink"],sn.prototype={__class__:sn};var ln=function(e){null!=e&&(this.url=e.url,this.loaded=!1)};a["albero.entity.SolutionPlugin"]=ln,ln.__name__=["albero","entity","SolutionPlugin"],ln.prototype={__class__:ln};var un=a["albero.entity.SolutionType"]={__ename__:["albero","entity","SolutionType"],__constructs__:["PhotoViewTrial","PhotoView","MultiView","KeywordWatching","Unknown"]};un.PhotoViewTrial=["PhotoViewTrial",0],un.PhotoViewTrial.toString=o,un.PhotoViewTrial.__enum__=un,un.PhotoView=["PhotoView",1],un.PhotoView.toString=o,un.PhotoView.__enum__=un,un.MultiView=["MultiView",2],un.MultiView.toString=o,un.MultiView.__enum__=un,un.KeywordWatching=["KeywordWatching",3],un.KeywordWatching.toString=o,un.KeywordWatching.__enum__=un,un.Unknown=["Unknown",4],un.Unknown.toString=o,un.Unknown.__enum__=un,un.__empty_constructs__=[un.PhotoViewTrial,un.PhotoView,un.MultiView,un.KeywordWatching,un.Unknown];var cn=function(){};a["albero.entity.StampSet"]=cn,cn.__name__=["albero","entity","StampSet"],cn.prototype={__class__:cn};var _n=function(e){null!=e&&(this.id=e.talk_id,this.domainId=e.domain_id,this.type=this.typeOf(e.type),this.name=e.talk_name,this.iconUrl=e.icon_url,this.userIds=e.user_ids,this.updatedAt=e.updated_at,this.leftUsers=this.getUsers(e.left_users),this.groupTalkSettings=this.getGroupTalkSetting(e.settings))};a["albero.entity.Talk"]=_n,_n.__name__=["albero","entity","Talk"],_n.prototype={typeOf:function(e){switch(e){case 1:return dn.PairTalk;case 2:return dn.GroupTalk;default:return dn.Unknown}},getUsers:function(e){return null==e?null:e.map(function(e){return new ct(e)})},getGroupTalkSetting:function(e){return null==e?Ar.None:Ar.Some(new hn(e))},isSystemMessageVisibled:function(){var e=U.map(this.groupTalkSettings,function(e){return e.systemMessageVisible});switch(e[1]){case 0:return e[2];case 1:return!0}},isAllowDisplayPastMessages:function(){var e=U.map(this.groupTalkSettings,function(e){return e.allowDisplayPastMessages});switch(e[1]){case 0:return e[2];case 1:return!1}},__class__:_n};var hn=function(e){null!=e&&(this.allowDisplayPastMessages=!!e.allow_display_past_messages,this.systemMessageVisible=null==e.system_message_visible||e.system_message_visible)};a["albero.entity.GroupTalkSettings"]=hn,hn.__name__=["albero","entity","GroupTalkSettings"],hn.createDefault=function(){var e=new hn;return e.allowDisplayPastMessages=!0,e.systemMessageVisible=!0,e},hn.prototype={__class__:hn};var dn=a["albero.entity.TalkType"]={__ename__:["albero","entity","TalkType"],__constructs__:["Unknown","PairTalk","GroupTalk"]};dn.Unknown=["Unknown",0],dn.Unknown.toString=o,dn.Unknown.__enum__=dn,dn.PairTalk=["PairTalk",1],dn.PairTalk.toString=o,dn.PairTalk.__enum__=dn,dn.GroupTalk=["GroupTalk",2],dn.GroupTalk.toString=o,dn.GroupTalk.__enum__=dn,dn.__empty_constructs__=[dn.Unknown,dn.PairTalk,dn.GroupTalk];var fn=a["albero.entity.TalkOrAnnoucements"]={__ename__:["albero","entity","TalkOrAnnoucements"],__constructs__:["talk","annoucements"]};fn.talk=function(e){var t=["talk",0,e];return t.__enum__=fn,t.toString=o,t},fn.annoucements=["annoucements",1],fn.annoucements.toString=o,fn.annoucements.__enum__=fn,fn.__empty_constructs__=[fn.annoucements];var mn=function(){};a["albero.entity.TalkOrAnncounementsHelper"]=mn,mn.__name__=["albero","entity","TalkOrAnncounementsHelper"],mn.getTalkId=function(e){switch(e[1]){case 0:var t=e[2];return Ar.Some(t);case 1:return Ar.None}};var pn=function(e,t){this.talk=e,this.status=t};a["albero.entity.TalkPack"]=pn,pn.__name__=["albero","entity","TalkPack"],pn.compareTalkOrderingTimestamp=function(e,t){var n=e.getTalkOrderingTimestamp(),i=t.getTalkOrderingTimestamp(),r=n.high-i.high|0;return r=0!=r?r:mr.ucompare(n.low,i.low),n.high<0?i.high<0?r:-1:i.high>=0?r:1},pn.compareTalkConsideredFavorite=function(e,t){var n=e.getTalkOrderInFavorites(),i=t.getTalkOrderInFavorites();return null!=n&&null!=i?pn.compareTalkOrderingTimestamp(e,t):null!=n?1:null!=i?-1:pn.compareTalkOrderingTimestamp(e,t)},pn.prototype={getTalkOrderingTimestamp:function(){return null!=this.status&&null!=this.status.talkOrderingTimestamp?this.status.talkOrderingTimestamp:this.talk.updatedAt},getTalkOrderInFavorites:function(){return null!=this.status?this.status.orderInFavorites:null},__class__:pn};var gn=function(e,t){this.paneType=e,this.talkSelection=t};a["albero.entity.TalkPaneSelection"]=gn,gn.__name__=["albero","entity","TalkPaneSelection"],gn.createArrayForMultiPanes=function(e){return h.mapi(e,function(e,t){return new gn(Ut.getMultiPaneType(e),t)})},gn.prototype={createUrls:function(e,t){switch(this.paneType[1]){case 0:return B.talks(e,j.single(this.talkSelection));case 1:var n=r(t,t.getTalkSelection),i=e,a=function(e){return n(i,e)},o=Ut.getMultiPaneTypes().map(a);return o[0]=this.talkSelection,B.talks(e,j.multi(o));case 2:var s=r(t,t.getTalkSelection),l=e,u=function(e){return s(l,e)},c=Ut.getMultiPaneTypes().map(u);return c[1]=this.talkSelection,B.talks(e,j.multi(c));case 3:var _=r(t,t.getTalkSelection),h=e,d=function(e){return _(h,e)},f=Ut.getMultiPaneTypes().map(d);return f[2]=this.talkSelection,B.talks(e,j.multi(f))}},__class__:gn};var vn=function(){};a["albero.entity.ITalkSelectionGetter"]=vn,vn.__name__=["albero","entity","ITalkSelectionGetter"],vn.prototype={__class__:vn};var yn=function(e){null!=e&&(this.domainId=e.domain_id,this.talkId=e.talk_id,this.version=e.version)};a["albero.entity.TalkPushNotificationEvent"]=yn,
yn.__name__=["albero","entity","TalkPushNotificationEvent"],yn.prototype={__class__:yn};var Sn=a["albero.entity.TalkSelection"]={__ename__:["albero","entity","TalkSelection"],__constructs__:["NotSelected","TalkSelected","AnnouncementsSelected"]};Sn.NotSelected=["NotSelected",0],Sn.NotSelected.toString=o,Sn.NotSelected.__enum__=Sn,Sn.TalkSelected=function(e,t){var n=["TalkSelected",1,e,t];return n.__enum__=Sn,n.toString=o,n},Sn.AnnouncementsSelected=["AnnouncementsSelected",2],Sn.AnnouncementsSelected.toString=o,Sn.AnnouncementsSelected.__enum__=Sn,Sn.__empty_constructs__=[Sn.NotSelected,Sn.AnnouncementsSelected];var wn=function(){};a["albero.entity.TalkSelectionHelper"]=wn,wn.__name__=["albero","entity","TalkSelectionHelper"],wn.eqTalkSelection=function(e,t){var n;if(e[0]==t[0]){var i=wn.getTalkIdOrNull(e),r=wn.getTalkIdOrNull(t);n=null==i&&null==r||null!=i&&null!=r&&i.high==r.high&&i.low==r.low}else n=!1;if(n){var a=wn.getMessageIdOrNull(e),o=wn.getMessageIdOrNull(t);return null==a&&null==o||null!=a&&null!=o&&a.high==o.high&&a.low==o.low}return!1},wn.isSelected=function(e,t){switch(e[1]){case 0:return!1;case 1:var n=(e[3],e[2]),i=U.orNull(mn.getTalkId(t));return null!=n&&null!=i&&n.high==i.high&&n.low==i.low;case 2:return t==fn.annoucements}},wn.getTalkIdOrNull=function(e){switch(e[1]){case 0:return null;case 1:return e[2];case 2:return null}},wn.getMessageIdOrNull=function(e){switch(e[1]){case 0:return null;case 1:var t=e[3];return U.orNull(t);case 2:return null}};var Tn=function(e){this.unreadCount=0,null!=e&&(this.id=e.talk_id,this.unreadCount=null!=e.unread_count?e.unread_count:0,this.maxMessageId=e.max_message_id,null!=e.max_message?this.maxMessage=new At(e.max_message):this.maxMessage=null,this.maxReadMessageId=e.max_read_message_id,this.maxEveryoneReadMessageId=e.max_everyone_read_message_id,this.talkOrderingTimestamp=e.talk_ordering_timestamp,this.orderInFavorites=e.order_in_favorites,this.favoriteVersion=e.favorite_version,this.pushNotificationSetting=new Wt(e.push_notification))};a["albero.entity.TalkStatus"]=Tn,Tn.__name__=["albero","entity","TalkStatus"],Tn.prototype={update:function(e){var t=this,n=!1;return this.needIdUpdate(this.maxEveryoneReadMessageId,e.maxEveryoneReadMessageId)&&(this.maxEveryoneReadMessageId=e.maxEveryoneReadMessageId,n=!0),U.foreach(e.maxReadMessageId,function(e){t.needIdUpdate(t.maxReadMessageId,e)&&(t.maxReadMessageId=e,n=!0)}),n},needIdUpdate:function(e,t){if(null!=t){if(null!=e){var n=e.high-t.high|0;return n=0!=n?n:mr.ucompare(e.low,t.low),(e.high<0?t.high<0?n:-1:t.high>=0?n:1)<0}return!0}return!1},read:function(e,t){this.maxReadMessageId=e,this.unreadCount-=t,this.unreadCount<0&&(this.unreadCount=0)},readAll:function(){this.maxReadMessageId=this.maxMessageId,this.unreadCount=0},__class__:Tn};var In=function(){};a["albero.entity.TalkStatusHelper"]=In,In.__name__=["albero","entity","TalkStatusHelper"],In.isNotificationDisabled=function(e){return null!=e&&null!=e.pushNotificationSetting&&!e.pushNotificationSetting.enabled},In.isFavoriteTalk=function(e){return null!=e&&null!=e.orderInFavorites},In.isUnreadMesasgeExisted=function(e){return null!=e&&(null!=e.maxMessage&&In.isUnread(e,e.maxMessage.id))},In.isUnread=function(e,t){if(null!=e.maxReadMessageId){var n=e.maxReadMessageId,i=n.high-t.high|0;return i=0!=i?i:mr.ucompare(n.low,t.low),(n.high<0?t.high<0?i:-1:t.high>=0?i:1)<0}return!0},In.isNewMax=function(e,t){if(null!=e.maxMessageId){var n=e.maxMessageId,i=n.high-t.high|0;return i=0!=i?i:mr.ucompare(n.low,t.low),(n.high<0?t.high<0?i:-1:t.high>=0?i:1)<0}return!0},In.isMax=function(e,t){if(null!=e.maxMessageId){var n=e.maxMessageId;return null!=n&&null!=t&&n.high==t.high&&n.low==t.low}return!1};var En=function(e){null!=e&&(this.talkId=e.talk_id,this.maxEveryoneReadMessageId=e.max_everyone_read_message_id,this.maxReadMessageId=U.option(e.max_read_message_id))};a["albero.entity.TalkStatusUpdate"]=En,En.__name__=["albero","entity","TalkStatusUpdate"],En.prototype={__class__:En};var bn=function(e,t,n){this.file=e,this.dimension=An.createWithSize(t,n),this.auth=null};a["albero.entity.ThumbInfo"]=bn,bn.__name__=["albero","entity","ThumbInfo"],bn.prototype={setAuth:function(e){this.auth=e},__class__:bn};var An=function(e){null!=e&&(this.width=e.width,this.height=e.height)};a["albero.entity.ThumbDimension"]=An,An.__name__=["albero","entity","ThumbDimension"],An.createWithSize=function(e,t){var n=new An;return n.width=e,n.height=t,n},An.prototype={toObject:function(){return{width:this.width,height:this.height}},__class__:An};var Nn=a["albero.entity.UploadUseType"]={__ename__:["albero","entity","UploadUseType"],__constructs__:["PROFILE_IMAGE","MESSAGE","TALK_ICON","THUMBNAIL"]};Nn.PROFILE_IMAGE=["PROFILE_IMAGE",0],Nn.PROFILE_IMAGE.toString=o,Nn.PROFILE_IMAGE.__enum__=Nn,Nn.MESSAGE=["MESSAGE",1],Nn.MESSAGE.toString=o,Nn.MESSAGE.__enum__=Nn,Nn.TALK_ICON=["TALK_ICON",2],Nn.TALK_ICON.toString=o,Nn.TALK_ICON.__enum__=Nn,Nn.THUMBNAIL=["THUMBNAIL",3],Nn.THUMBNAIL.toString=o,Nn.THUMBNAIL.__enum__=Nn,Nn.__empty_constructs__=[Nn.PROFILE_IMAGE,Nn.MESSAGE,Nn.TALK_ICON,Nn.THUMBNAIL];var kn=function(){};a["albero.entity.UploadUseTypeHelper"]=kn,kn.__name__=["albero","entity","UploadUseTypeHelper"],kn.getUseTypeInt=function(e){switch(e[1]){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 4}};var Dn=function(e){null!=e&&(null!=e.user_id&&(this.userId=e.user_id),null!=e.email&&(this.email=e.email),null!=e.sub_email&&(this.subEmail=e.sub_email),null!=e.group_alias&&(this.groupAlias=e.group_alias),null!=e.signin_id&&(this.signinId=e.signin_id))};a["albero.entity.UserIdentifier"]=Dn,Dn.__name__=["albero","entity","UserIdentifier"],Dn.prototype={__class__:Dn};var Cn=function(e,t){this.high=e,this.low=t};a["haxe._Int64.___Int64"]=Cn,Cn.__name__=["haxe","_Int64","___Int64"],Cn.prototype={__class__:Cn};var On=function(e,t){this.lastUpdatedAt=t,null!=e&&(this.userId=e.user_id,this.lastUsedAtOpt=U.option(e.last_used_at))};a["albero.entity.UserPresence"]=On,On.__name__=["albero","entity","UserPresence"],On.createUserPresenceState=function(e,t){var n=t.high-e.high|0,i=t.low-e.low|0;if(mr.ucompare(t.low,e.low)<0){n--;n|=0}var r=new Cn(n,i),a=r,o=On.SIXTY_MINUTES,s=a.high-o.high|0;if(s=0!=s?s:mr.ucompare(a.low,o.low),(a.high<0?o.high<0?s:-1:o.high>=0?s:1)>0)return Rn.GT_60;var l=On.FIFTEEN_MINUTES,u=a.high-l.high|0;return u=0!=u?u:mr.ucompare(a.low,l.low),(a.high<0?l.high<0?u:-1:l.high>=0?u:1)>0?Rn.LT_OR_EQ_60:Rn.LT_OR_EQ_15},On.prototype={toState:function(e){var t=e,n=function(e){return On.createUserPresenceState(e,t)},i=U.map(this.lastUsedAtOpt,n);switch(i[1]){case 0:return i[2];case 1:return Rn.GT_60}},isExpired:function(e,t){var n=this.lastUpdatedAt,i=e.high-n.high|0,r=e.low-n.low|0;if(mr.ucompare(e.low,n.low)<0){i--;i|=0}var a=new Cn(i,r),o=a,s=o.high-t.high|0;return s=0!=s?s:mr.ucompare(o.low,t.low),(o.high<0?t.high<0?s:-1:t.high>=0?s:1)>0},__class__:On};var Rn=a["albero.entity.UserPresenceState"]={__ename__:["albero","entity","UserPresenceState"],__constructs__:["LT_OR_EQ_15","LT_OR_EQ_60","GT_60"]};Rn.LT_OR_EQ_15=["LT_OR_EQ_15",0],Rn.LT_OR_EQ_15.toString=o,Rn.LT_OR_EQ_15.__enum__=Rn,Rn.LT_OR_EQ_60=["LT_OR_EQ_60",1],Rn.LT_OR_EQ_60.toString=o,Rn.LT_OR_EQ_60.__enum__=Rn,Rn.GT_60=["GT_60",2],Rn.GT_60.toString=o,Rn.GT_60.__enum__=Rn,Rn.__empty_constructs__=[Rn.LT_OR_EQ_15,Rn.LT_OR_EQ_60,Rn.GT_60];var Mn=function(e){this.success=e};a["albero.entity.api.message.AddFavoriteMessageResult"]=Mn,Mn.__name__=["albero","entity","api","message","AddFavoriteMessageResult"],Mn.prototype={__class__:Mn};var xn=function(e){this.success=e};a["albero.entity.api.message.DeleteFavoriteMessageResult"]=xn,xn.__name__=["albero","entity","api","message","DeleteFavoriteMessageResult"],xn.prototype={__class__:xn};var Fn=function(e,t,n,i,r){this.domainId=e,this.talkId=t,this.marker=n,this.nextMarker=i,this.messages=r};a["albero.entity.api.message.GetFavoriteMessagesResultWithParams"]=Fn,Fn.__name__=["albero","entity","api","message","GetFavoriteMessagesResultWithParams"],Fn.prototype={getNextMarker:function(){return this.nextMarker},getMessages:function(){return this.messages},__class__:Fn};var Un=function(e){this.note=new Yn(e)};a["albero.entity.api.note.CreateNoteResult"]=Un,Un.__name__=["albero","entity","api","note","CreateNoteResult"],Un.prototype={__class__:Un};var Pn=function(e){this.result=e};a["albero.entity.api.note.DeleteNoteResult"]=Pn,Pn.__name__=["albero","entity","api","note","DeleteNoteResult"],Pn.prototype={__class__:Pn};var Ln=function(e){this.note=new Yn(e)};a["albero.entity.api.note.GetNoteResult"]=Ln,Ln.__name__=["albero","entity","api","note","GetNoteResult"],Ln.prototype={getNoteId:function(){return this.note.noteId},getNoteCreateUserId:function(){return this.note.createdBy},getRevisionCreateUserId:function(){return this.note.getRevisionCreateUserId()},getNoteCreateDate:function(){return this.note.createdAt},getRevisionCreateDate:function(){return this.note.getRevisionCreateDate()},__class__:Ln};var Bn=function(e){null!=e&&(this.marker=e.marker,this.nextMarker=e.next_marker,this.noteStatuses=F.asArray(e.contents).map(function(e){return new ti(e)}))};a["albero.entity.api.note.GetNoteStatusesResult"]=Bn,Bn.__name__=["albero","entity","api","note","GetNoteStatusesResult"],Bn.prototype={isNotEmptyNoteStatuses:function(){return this.noteStatuses.length>0},__class__:Bn};var jn=function(e){this.note=new Yn(e)};a["albero.entity.api.note.UpdateNoteResult"]=jn,jn.__name__=["albero","entity","api","note","UpdateNoteResult"],jn.prototype={__class__:jn};var Hn=function(e){this.note=new Yn(e)};a["albero.entity.api.note.UpdateNoteSettingResult"]=Hn,Hn.__name__=["albero","entity","api","note","UpdateNoteSettingResult"],Hn.prototype={__class__:Hn};var zn=function(){};a["albero.entity.message.IFavoriteMessageEvent"]=zn,zn.__name__=["albero","entity","message","IFavoriteMessageEvent"],zn.prototype={__class__:zn};var Gn=function(e){this.message=new At(e.message),this.domainId=e.domain_id,this.talkId=e.talk_id};a["albero.entity.message.AddFavoriteMessageEvent"]=Gn,Gn.__name__=["albero","entity","message","AddFavoriteMessageEvent"],Gn.__interfaces__=[zn],Gn.prototype={getMessage:function(){return this.message},getMessageId:function(){return this.message.id},isFavorite:function(){return!0},getDomainId:function(){return this.domainId},__class__:Gn};var Wn=function(e){this.messageId=e.message_id,this.domainId=e.domain_id,this.talkId=e.talk_id};a["albero.entity.message.DeleteFavoriteMessageEvent"]=Wn,Wn.__name__=["albero","entity","message","DeleteFavoriteMessageEvent"],Wn.__interfaces__=[zn],Wn.prototype={getMessageId:function(){return this.messageId},isFavorite:function(){return!1},__class__:Wn};var Kn=function(e){if(null==e)return this.favorite=!1,this.createdAt=null,void(this.tags=[]);this.favorite=!0,this.createdAt=e.created_at,this.tags=e.tags};a["albero.entity.message.MessageFavorite"]=Kn,Kn.__name__=["albero","entity","message","MessageFavorite"],Kn.prototype={isFavorite:function(){return this.favorite},update:function(e){this.favorite=e.isFavorite()},__class__:Kn};var Yn=function(e){null!=e&&(this.noteId=new Qn(e.note_id),this.talkId=e.talk_id,this.createdBy=e.created_by,this.createdAt=e.created_at,this.setting=new ei(e.setting),this.noteRevision=new Zn(e.note_revision))};a["albero.entity.note.Note"]=Yn,Yn.__name__=["albero","entity","note","Note"],Yn.prototype={isSameNoteId:function(e){return this.noteId.equals(e)},getRevisionCreateUserId:function(){return this.noteRevision.createdBy},getRevisionCreateDate:function(){return this.noteRevision.createdAt},compareRevision:function(e){return this.noteRevision.compareRevision(e)},__class__:Yn};var Vn=a["albero.entity.note.NoteContentType"]={__ename__:["albero","entity","note","NoteContentType"],__constructs__:["TEXT"]};Vn.TEXT=["TEXT",0],Vn.TEXT.toString=o,Vn.TEXT.__enum__=Vn,Vn.__empty_constructs__=[Vn.TEXT];var qn=function(){};a["albero.entity.note.NoteContentTypeHelper"]=qn,qn.__name__=["albero","entity","note","NoteContentTypeHelper"],qn.createNoteContentType=function(e){return null==e?(si._e("["+_.dateStr(new Date)+"] ","no value.","","","",""),null):1==e?Vn.TEXT:(si._e("["+_.dateStr(new Date)+"] ","value is not expected.","","","",""),null)},qn.getValue=function(e){return null==e?(si._e("["+_.dateStr(new Date)+"] ","no content type.","","","",""),null):1};var Qn=function(e){this.value=e};a["albero.entity.note.NoteId"]=Qn,Qn.__name__=["albero","entity","note","NoteId"],Qn.__interfaces__=[St],Qn.prototype={toString:function(){var e=this.value;return"_"+e.high+"_"+e.low},equals:function(e){if(null==e)return!1;var t=this.value,n=e.value;return null!=t&&null!=n&&t.high==n.high&&t.low==n.low},getHtmlAttributeId:function(){return"note-"+this.toString()},__class__:Qn};var Jn=function(e){null!=e&&(this.noteId=new Qn(e.note_id),this.talkId=e.talk_id,this.setting=new ei(e.setting))};a["albero.entity.note.NotePartialUpdateForSetting"]=Jn,Jn.__name__=["albero","entity","note","NotePartialUpdateForSetting"],Jn.prototype={__class__:Jn};var Xn=function(e){null!=e&&(this.noteId=new Qn(e.note_id),this.talkId=e.talk_id,this.noteRevisionSummary=new $n(e.note_revision_summary))};a["albero.entity.note.NotePartialUpdateForSummary"]=Xn,Xn.__name__=["albero","entity","note","NotePartialUpdateForSummary"],Xn.prototype={getRevision:function(){return this.noteRevisionSummary.revision},getUpdatedBy:function(){return this.noteRevisionSummary.createdBy},getUpdatedAt:function(){return this.noteRevisionSummary.createdAt},__class__:Xn};var Zn=function(e){null!=e&&(this.revision=e.revision,this.title=e.title,this.contentType=qn.createNoteContentType(e.content_type),this.content=e.content,this.createdBy=e.created_by,this.createdAt=e.created_at)};a["albero.entity.note.NoteRevision"]=Zn,Zn.__name__=["albero","entity","note","NoteRevision"],Zn.prototype={isEmptyTitle:function(){return""==this.title||null==this.title},compareRevision:function(e){return this.revision==e?0:this.revision<e?-1:1},__class__:Zn};var $n=function(e){null!=e&&(this.revision=e.revision,this.title=e.title,this.contentType=qn.createNoteContentType(e.content_type),this.contentSummary=e.content_summary,this.createdBy=e.created_by,this.createdAt=e.created_at)};a["albero.entity.note.NoteRevisionSummary"]=$n,$n.__name__=["albero","entity","note","NoteRevisionSummary"],$n.prototype={isEmptyTitle:function(){return""==this.title||null==this.title},compareRevision:function(e){return this.revision==e?0:this.revision<e?-1:1},getContentSummaryWithEllipsis:function(){return this.contentSummary.length<100?this.contentSummary:this.contentSummary.substring(0,99)+""},__class__:$n};var ei=function(e){null!=e&&(this.collaborativeEditing=e.collaborative_editing,this.version=e.version)};a["albero.entity.note.NoteSetting"]=ei,ei.__name__=["albero","entity","note","NoteSetting"],ei.prototype={__class__:ei};var ti=function(e){null!=e&&(this.noteId=new Qn(e.note_id),this.noteSummary=new ni(e.note_summary),this.commentIds=e.comment_ids,this.readUserIds=e.read_user_ids)};a["albero.entity.note.NoteStatus"]=ti,ti.__name__=["albero","entity","note","NoteStatus"],ti.prototype={getNoteRevisionSummary:function(){return this.noteSummary.noteRevisionSummary},__class__:ti};var ni=function(e){null!=e&&(this.noteId=new Qn(e.note_id),this.talkId=e.talk_id,this.createdBy=e.created_by,this.createdAt=e.created_at,this.setting=new ei(e.setting),this.noteRevisionSummary=new $n(e.note_revision_summary))};a["albero.entity.note.NoteSummary"]=ni,ni.__name__=["albero","entity","note","NoteSummary"],ni.prototype={getNoteIdByString:function(){return this.noteId.toString()},getRevisionCreatedAt:function(){return this.noteRevisionSummary.createdAt},getRevisionContentSummary:function(){return this.noteRevisionSummary.contentSummary},getRevisionTitle:function(){return this.noteRevisionSummary.isEmptyTitle()?"":this.noteRevisionSummary.title},getNoteIdJQueryId:function(){return this.noteId.getHtmlAttributeId()},__class__:ni};var ii=function(){};a["albero.js.KatakanaToRoman"]=ii,ii.__name__=["albero","js","KatakanaToRoman"],ii.assureConvertTable=function(){return null!=ii.convertTable?ii.convertTable:(ii.convertTable=new kr,h.iter([["","A"],["","I"],["","U"],["","E"],["","O"],["","KA"],["","KI"],["","KU"],["","KE"],["","KO"],["","KYA"],["","KYU"],["","KYO"],["","SA"],["","SI"],["","SU"],["","SE"],["","SO"],["","SHA"],["","SHU"],["","SHO"],["","TA"],["","TI"],["","TU"],["","TE"],["","TO"],["","THA"],["","THU"],["","THO"],["","NA"],["","NI"],["","NU"],["","NE"],["","NO"],["","NYA"],["","NYU"],["","NYO"],["","HA"],["","HI"],["","FU"],["","HE"],["","HO"],["","HYA"],["","HYU"],["","HYO"],["","MA"],["","MI"],["","MU"],["","ME"],["","MO"],["","MYA"],["","MYU"],["","MYO"],["","YA"],["","YU"],["","YO"],["","RA"],["","RI"],["","RU"],["","RE"],["","RO"],["","RYA"],["","RYU"],["","RYO"],["","WA"],["","O"],["","N"],["","GA"],["","GI"],["","GU"],["","GE"],["","GO"],["","GYA"],["","GYU"],["","GYO"],["","ZA"],["","JI"],["","ZU"],["","ZE"],["","ZO"],["","ZYA"],["","ZYU"],["","ZYO"],["","DA"],["","JI"],["","ZU"],["","DE"],["","DO"],["","BA"],["","BI"],["","BU"],["","BE"],["","BO"],["","BYA"],["","BYU"],["","BYO"],["","PA"],["","PI"],["","PU"],["","PE"],["","PO"],["","PYA"],["","PYU"],["","PYO"],["",""],["",""]],function(e){var t=ii.convertTable,n=e[0],i=e[1];null!=ma[n]?t.setReserved(n,i):t.h[n]=i}),ii.convertTable)},ii.matchNext=function(e,t){var n=ii.assureConvertTable();if(t+1<e.length){var i=e.substring(t,t+2),r=null!=ma[i]?n.getReserved(i):n.h[i];if(null!=r)return ri.MatchedToTwoCharsKey(r)}if(t<e.length){var a=e.substring(t,t+1),o=null!=ma[a]?n.getReserved(a):n.h[a];if(null!=o)return ri.MatchedToOneCharKey(o)}var s=t<e.length?e.substring(t,t+1):"";return ri.NotMatched(s)},ii.prototype={convert:function(e){for(var t=0,n="";t<e.length;){var i=ii.matchNext(e,t);switch(i[1]){case 0:var r=i[2];t+=2,n+=r;break;case 1:var a=i[2];++t,n+=a;break;case 2:var o=i[2];++t,n+=o}}return n=n.replace(ii.TU_REG.r,"$1$1"),n=n.replace(ii.XTU_REG.r,"XTU")},__class__:ii};var ri=a["albero.js.ResultOfMatchNext"]={__ename__:["albero","js","ResultOfMatchNext"],__constructs__:["MatchedToTwoCharsKey","MatchedToOneCharKey","NotMatched"]};ri.MatchedToTwoCharsKey=function(e){var t=["MatchedToTwoCharsKey",0,e];return t.__enum__=ri,t.toString=o,t},ri.MatchedToOneCharKey=function(e){var t=["MatchedToOneCharKey",1,e];return t.__enum__=ri,t.toString=o,t},ri.NotMatched=function(e){var t=["NotMatched",2,e];return t.__enum__=ri,t.toString=o,t},ri.__empty_constructs__=[];var ai=function(e){this.isDirty=!1,this.key=e};a["albero.js.LocalStorage"]=ai,ai.__name__=["albero","js","LocalStorage"],ai.getLocalStorage=function(){return new(0,require("node-localstorage").LocalStorage)(null!=la.storagePath?la.storagePath:"./storage.local",null!=la.storageQuota?v.parseInt(la.storageQuota):null)},ai.prototype={load:function(){var e=this.val();if(null==e||""==e)return null;var t=null;try{t=Sr.run(e),this.isDirty=!1}catch(e){e instanceof Br&&(e=e.val),si._w("["+_.dateStr(new Date)+"] ",e,"","","","")}return t},save:function(e){try{this.val(gr.run(e)),this.isDirty=!1}catch(e){e instanceof Br&&(e=e.val),si._w("["+_.dateStr(new Date)+"] ",e,"","","","")}},setDirtyFlag:function(){if(!this.isDirty)try{this.val(""),this.isDirty=!0}catch(e){e instanceof Br&&(e=e.val),si._w("["+_.dateStr(new Date)+"] ",e,"","","","")}},val:function(e){var t=ai.getLocalStorage();return null!=t&&(null==e?e=t.getItem(this.key):""==e?t.removeItem(this.key):t.setItem(this.key,e)),e},__class__:ai};var oi=function(){};a["albero.js.Localizer"]=oi,oi.__name__=["albero","js","Localizer"],oi.runOrReserve=function(e){e()},oi.localize=function(e,t){return""},oi.asyncPrepare=function(){return Promise.resolve()};var si=e.AlberoLog=function(){};a.AlberoLog=si,si.__name__=["AlberoLog"],si.getLogLevel=function(e){switch(e=null!=e?e.toUpperCase():"INFO"){case"ALERT":return 1;case"CRITICAL":return 2;case"EMERGENCY":return 0;case"ERROR":return 3;case"INFO":return 6;case"NOTICE":return 5;case"WARNING":return 4;default:return 7}},si._nop=function(){},si.dateStr=function(){return"["+_.dateStr(new Date)+"] "};var li=function(e,t,n){this.ignoreCase=t,this.normalizeFunc=n,t&&(e=e.toUpperCase()),this.normalizedPattern=n(e)};a["albero.js.NFKCTextSearch"]=li,li.__name__=["albero","js","NFKCTextSearch"],li.prototype={search:function(e){var t=new y,n=[];this.ignoreCase&&(e=e.toUpperCase()),this.normalize(e,t,n);for(var i,r=0,a=[],o=t.b;;){if(-1==(i=o.indexOf(this.normalizedPattern,r)))break;r=i+this.normalizedPattern.length;for(var s=n[i],l=n[r-1],u=null,c=r,_=n.length;c<_;){if(u=n[c++],l!=u)break;u=null}null==u&&(u=e.length),a.push(new ui(s,u))}return a},normalize:function(e,t,n){for(var i=e.length,r=new y,a=0,o=0,s=i;o<s;){var l=o++,u=r.b.length,c=r.b,_=c+e.charAt(l),h=this.normalizeFunc(_);if(_!=h)if(S.startsWith(h,c)){var d=c.substring(0,u);t.b+=v.string(d),r=new y;var f=h.substring(u,h.length);r.b+=v.string(f);for(var m=0,p=u;m<p;){m++;n.push(a)}a=l}else r=new y,r.b+=null==h?"null":""+h;else{t.b+=v.string(r),r=new y;var g=e.charAt(l);r.b+=v.string(g);for(var w=0,T=u;w<T;){w++;n.push(a)}a=l}}t.b+=v.string(r.b);for(var I=0,E=r.b.length;I<E;){I++;n.push(a)}},__class__:li};var ui=function(e,t){this.start=e,this.end=t};a["albero.js.HitSpan"]=ui,ui.__name__=["albero","js","HitSpan"],ui.prototype={__class__:ui};var ci=function(){};a["albero.js.PromiseHelper"]=ci,ci.__name__=["albero","js","PromiseHelper"],ci.resolveVoid=function(e){e()};var _i=function(){};a["albero.js.ProxyHelper"]=_i,_i.__name__=["albero","js","ProxyHelper"],_i.createAgent=function(e){var t=Kr.parse(e),n={host:t.hostname};null!=t.port&&(n.port=v.parseInt(t.port)),null!=t.auth&&(n.proxyAuth=t.auth);var i=require("tunnel-agent");return("https:"==t.protocol?i.httpsOverHttps:i.httpsOverHttp)({proxy:n})};var hi=function(){};a["albero.js.TextCanonicalizer"]=hi,hi.__name__=["albero","js","TextCanonicalizer"],hi.canonicalize=function(e){return hi.basicLatinAlphabetToUpperCase(hi.hiraganaToKatakana(hi.normalize(hi.eraseInvisible(e))))},hi.canonicalizeForRoman=function(e){return hi.basicLatinAlphabetToUpperCase(hi.katakanaToRoman(hi.hiraganaToKatakana(hi.normalize(hi.eraseInvisible(e)))))},hi.basicLatinAlphabetToUpperCase=function(e){return e.toUpperCase()},hi.hiraganaToKatakana=function(e){for(var t=0,n="",i=0,r=e.length;i<r;){var a=i++,o=_.cca(e,a);o>=hi.HIRAGANA_SMALL_A&&o<=hi.HIRAGANA_NN&&(n+=e.substring(t,a),n+=String.fromCharCode(o+(hi.KATAKANA_SMALL_A-hi.HIRAGANA_SMALL_A)),t=a+1)}return n+=e.substring(t,e.length)},hi.katakanaToRoman=function(e){return(new ii).convert(e)},hi.normalize=function(e){return new di(null).normalize(e)},hi.asyncAssureNormalize=function(){return Promise.resolve()},hi.eraseInvisible=function(e){var t=new RegExp("[\\u0000-\\u0020]","g".split("u").join(""));return e.replace(t,"")};var di=function(e){this.beforeTask=null,this.beforeTask=e};a["albero.js.Normalizer"]=di,di.__name__=["albero","js","Normalizer"],di.prototype={normalize:function(e){try{return null!=this.beforeTask&&this.beforeTask(),e.normalize("NFKC")}catch(e){return e instanceof Br&&(e=e.val),si._e("["+_.dateStr(new Date)+"] ","invalid character:",e,"","",""),oi.localize("TextCanonicalizer.invalid")}},__class__:di};var fi=function(e){var t=this,n=la.wsConfig,i=require("websocket").client;this.ws=new i(n),this.ws.on("connectFailed",r(this,this.onError)),this.ws.on("connect",function(e){t.connection=e,e.on("error",r(t,t.onError)),e.on("close",r(t,t.onConnectionClose)),e.on("message",r(t,t.onMessage)),e.on("pong",r(t,t.onPong)),t.onOpen(null)});var a=null;null!=la.proxyURL&&(a={agent:_i.createAgent(la.proxyURL)}),this.ws.connect(e,null,null,null,a)};a["albero.js.WebSocket"]=fi,fi.__name__=["albero","js","WebSocket"],fi.prototype={onOpen:function(e){si._i("["+_.dateStr(new Date)+"] ","WebSocket opened.","","","",""),null!=this.onopen&&this.onopen()},onMessage:function(e){if(null!=this.onmessage){var t=null;t=Dr.ofData(e.binaryData),this.onmessage(t)}},onPong:function(e){null!=this.onpong&&this.onpong(e)},onError:function(e){si._e("["+_.dateStr(new Date)+"] ","WebSocket error. event:",e,"","",""),null!=this.onerror&&this.onerror()},onClose:function(e){null!=this.ws&&(this.ws.removeAllListeners(),this.ws=null),null!=this.connection&&(this.connection.removeAllListeners(),this.connection=null);var t="WebSocket closed. "+v.string(e.code)+" "+v.string(e.reason)+" "+v.string(e.wasClean);si._i("["+_.dateStr(new Date)+"] ",t,"","","",""),null!=this.onclose&&this.onclose(e.code,e.reason,e.wasClean)},onConnectionClose:function(e,t){this.onClose({code:e,reason:t})},close:function(){if(!this.isClosed()){var e=this.connection;this.onConnectionClose(1e3,"Normal connection closure"),e.close()}},send:function(e){this.isClosed()||this.connection.sendBytes(new Yr(e.b.bufferValue))},ping:function(e){this.connection.ping(e)},isClosed:function(){return null==this.ws||null==this.connection||!this.connection.connected},__class__:fi};var mi=function(){};a["puremvc.interfaces.IProxy"]=mi,mi.__name__=["puremvc","interfaces","IProxy"],mi.prototype={__class__:mi};var pi=function(){};a["albero.proxy.AccessTokenResolverProxy"]=pi,pi.__name__=["albero","proxy","AccessTokenResolverProxy"],pi.__interfaces__=[mi],pi.prototype={__class__:pi};var gi=function(){};a["albero.proxy.AccessTokenResolverProxyFactory"]=gi,gi.__name__=["albero","proxy","AccessTokenResolverProxyFactory"],gi.newInstance=function(){return new yi("accessTokenResolver")};var vi=function(e,t){K.call(this),this.proxyName=null!=e?e:vi.NAME,null!=t&&this.setData(t)};a["puremvc.patterns.proxy.Proxy"]=vi,vi.__name__=["puremvc","patterns","proxy","Proxy"],vi.__interfaces__=[mi],vi.__super__=K,vi.prototype=n(K.prototype,{getProxyName:function(){return this.proxyName},setData:function(e){this.data=e},getData:function(){return this.data},onRegister:function(){},onRemove:function(){},__class__:vi});var yi=function(e){vi.call(this,e)};a["albero.proxy.AccessTokenResolverProxyForDirectJsHubot"]=yi,yi.__name__=["albero","proxy","AccessTokenResolverProxyForDirectJsHubot"],yi.__interfaces__=[pi],yi.__super__=vi,yi.prototype=n(vi.prototype,{asyncGetAccessToken:function(e,t){var n=this.settings.getAccessToken();if(null!=n)return void t(n);var i=null!=la.account?la.account.split(":"):null;if(null!=i&&2==i.length)return void this.api.createAccessToken(i[0],i[1],t);null!=(e=null==e?this.accountLoader.load():e)&&(null!=e.accessToken?(this.settings.setAccessToken(e.accessToken),t(e.accessToken)):this.api.createAccessToken(e.email,e.pass,t))},__class__:yi});var Si=function(){};a["albero.proxy.AccountLoaderProxy"]=Si,Si.__name__=["albero","proxy","AccountLoaderProxy"],Si.__interfaces__=[mi],Si.prototype={__class__:Si};var wi=function(){};a["albero.proxy.AccountLoaderProxyFactory"]=wi,wi.__name__=["albero","proxy","AccountLoaderProxyFactory"],wi.newInstance=function(){var e=I.resolveClass("albero.debug.proxy.AccountLoaderProxyImpl");return null!=e?I.createInstance(e,["accountLoader"]):new Ti("accountLoader")};var Ti=function(e){vi.call(this,e)};a["albero.proxy.AccountLoaderProxyForHubot"]=Ti,Ti.__name__=["albero","proxy","AccountLoaderProxyForHubot"],Ti.__interfaces__=[Si],Ti.__super__=vi,Ti.prototype=n(vi.prototype,{load:function(){var e=this,t=require("read");return t({prompt:"Email: "},function(n,i){t({prompt:"Password: ",silent:!0},function(t,n){e.sendNotification("SignIn",new Ce(i,n))})}),null},__class__:Ti});var Ii=function(){vi.call(this,"broadcast")};a["albero.proxy.AlberoBroadcastProxy"]=Ii,Ii.__name__=["albero","proxy","AlberoBroadcastProxy"],Ii.__super__=vi,Ii.prototype=n(vi.prototype,{handleNotification:function(e,t,n){var i=this;switch(si._d("["+_.dateStr(new Date)+"] ","Receive request from server. name:",e," body:",t,""),e){case"notify_add_account_control_request":var r=new Fe(t);this.dataStore.setAccountControlRequest(r),this.sendNotification(e,r),n();break;case"notify_add_acquaintance":var a=this.dataFactory.newAcquaintance(t[1]);this.sendNotification(e,a),n();break;case"notify_add_domain_invite":var o=new lt(t);this.dataStore.setDomainInvite(o),this.sendNotification(e,o),n();break;case"notify_add_favorite_message":var s=new Gn(t);this.messageStore.onAddFavoriteMessage(s),this.sendNotification(e,s),n();break;case"notify_add_favorite_talk":var l=new mt(t);this.updateTalkStatusByFavoriteTalkEvent(l),this.sendNotification(e,l),n();break;case"notify_add_friend":var u=this.dataFactory.newFriend(t[1]);this.sendNotification(e,u),n();break;case"notify_add_talkers":var c=new _n(t);null==this.dataStore.getTalk(c.id)&&this.sendNotification("notify_add_talkers_including_me",c),this.dataStore.setTalk(c),this.sendNotification(e,c),n();break;case"notify_close_conference":var d=new We(t);this.conferenceStore.removeConference(d),this.updateTalkStatusByConferenceClosedEvent(d),this.sendNotification(e,d),n();break;case"notify_conference_participant_join":var f,m=t[3],p=t[4],g=this.dataStore;if(null!=g.me){var v=g.me.id;f=null!=v&&null!=p&&v.high==p.high&&v.low==p.low}else f=!1;f&&this.dataStore.addReactedConfereceId(m),this.sendNotification(e,t),n();break;case"notify_conference_participant_reject":var y=t[3];this.dataStore.addReactedConfereceId(y),this.sendNotification(e,t),n();break;case"notify_create_announcement":var S=new Le(t);this.keywordWatcher.onAnnouncementCreated(S),this.sendNotification("notify_update_announcement_status",this.newAnnouncementStatus(S)),this.sendNotification(e,S),n();break;case"notify_create_message":var w=new At(t);this.messageStore.setMessage(w),this.keywordWatcher.onMessageCreated(w);var T=this.newTalkStatusByMessage(w);null!=T&&this.sendNotification("notify_update_local_talk_status",T);switch(w.type[1]){case 0:var I=w.content,E=null;switch(I.type){case"delete_talker":E=I.deleted_user_id;break;case"hide_pair_talk":E=I.user_id}if(null==E)return this.sendNotification(e,w),void n();for(var b=w.talkId,A=this.dataStore.getQuestions(b,E),N=0;N<A.length;){var k=A[N];++N,k.closed=!0,this.sendNotification("notify_update_question",k)}this.sendNotification(e,w),n();break;case 4:if(null!=w.content.file_id){var D=[pt.fromMessageAndFile(w,w.content)];this.fileInfoStore.setMessageFileInfos(w.id,D),h.iter(D,function(e){i.fileInfoStore.setTalkFileInfo(e,!1),i.sendNotification("notify_create_attachment",e)})}this.sendNotification(e,w),n();break;case 5:var C=w,O=function(e){return pt.fromMessageAndFile(C,e)},R=F.asArray(w.content.files).map(O);this.fileInfoStore.setMessageFileInfos(w.id,R),h.iter(R,function(e){i.fileInfoStore.setTalkFileInfo(e,!1),i.sendNotification("notify_create_attachment",e)}),this.sendNotification(e,w),n();break;case 11:case 13:case 15:vr.delay(function(){var t=i.dataStore.getTalk(w.talkId);if(null!=t){var r=i.dataStore.setQuestion(Kt.fromMessageAndTalk(w,t));i.sendNotification("notify_update_question",r)}i.sendNotification(e,w),n()},500);break;case 12:case 14:case 16:case 17:case 18:case 19:vr.delay(function(){var t=w.content.in_reply_to;if(null!=i.dataStore.getTalk(w.talkId)&&null!=i.dataStore.getQuestion(t)){var r=me.Question(t,function(r){w.isClosedActionStampMessage()&&i.messageStore.onActionStampClose(t),i.sendNotification(e,w),n()});i.sendNotification("ReloadData",r)}else i.sendNotification(e,w),n()},500);break;default:this.sendNotification(e,w),n()}break;case"notify_create_note":var x=new ni(t);this.sendNotification(e,x),n();break;case"notify_create_group_talk":case"notify_create_pair_talk":var P=new _n(t);this.dataStore.setTalk(P),this.newTalkStatusByTalk(P),this.sendNotification(e,P),n();break;case"notify_delete_account_control_request":var L=M.fromIntOrInt64(t);this.dataStore.removeAccountControlRequest(L),this.sendNotification(e,L),n();break;case"notify_delete_acquaintance":this.dataStore.removeAcquaintance(t[0],t[1]),this.sendNotification(e,t),n();break;case"notify_delete_announcement":
var B=t[0],j=t[1],H=this.dataStore.getAnnouncementStatus(B);if(null!=H){je.isUnread(H,j)&&(H.unreadCount-=1,H.unreadCount<0&&(H.unreadCount=0));var z;if(null!=H.maxAnnouncementId){var G=H.maxAnnouncementId;z=null!=G&&null!=j&&G.high==j.high&&G.low==j.low}else z=!1;z&&null!=H.maxAnnouncement&&(H.maxAnnouncement.type=Nt.deleted,H.maxAnnouncement.content=""),this.dataStore.setAnnouncementStatus(H)}this.sendNotification(e,t),n();break;case"notify_delete_attachment":var W=new gt(t);this.messageStore.onFileDeleted(W),this.fileInfoStore.onFileDeleted(W),this.sendNotification(e,W),n();break;case"notify_delete_domain_invite":var K=t;this.dataStore.removeDomainInvite(K),this.sendNotification(e,K),n();break;case"notify_delete_favorite_message":var Y=new Wn(t);this.messageStore.onDeleteFavoriteMessage(Y),this.sendNotification(e,Y),n();break;case"notify_delete_favorite_talk":var V=new mt(t);this.updateTalkStatusByFavoriteTalkEvent(V),this.sendNotification(e,V),n();break;case"notify_delete_friend":this.dataStore.removeFriend(t[0],t[1]),this.sendNotification(e,t),n();break;case"notify_delete_message":var q=new Ct(t);U.foreach(this.messageStore.getMessage(q.messageId),function(e){e.type=Nt.deleted,e.content=""});var Q=this.updateTalkStatusOnMessageDelete(q);null!=Q&&this.sendNotification("notify_update_local_talk_status",Q),this.sendNotification(e,q),n();break;case"notify_delete_note":var J=new Qn(t);this.dataStore.setNote(J,null),this.sendNotification(e,J),n();break;case"notify_delete_talk":var X=t;this.dataStore.removeTalk(X),this.dataStore.removeTalkStatus(X),this.conferenceStore.removeConferencesOnLeaveTalk(X),this.sendNotification("brand_badge_changed"),this.sendNotification(e,t),n();break;case"notify_disable_push_notification":var Z=new yn(t);this.updateTalkStatusByTalkPushNotificationEvent(!1,Z),this.sendNotification(e,Z),n();break;case"notify_enable_push_notification":var $=new yn(t);this.updateTalkStatusByTalkPushNotificationEvent(!0,$),this.sendNotification(e,$),n();break;case"notify_join_account_control_group":var ee=new Oe(t);this.dataStore.setAccountControlGroup(ee),this.dataStore.removeAccountControlRequests(),this.sendNotification("brand_badge_changed"),this.sendNotification(e,ee),n();break;case"notify_join_domain":var te=this.dataStore.setDomainIfLatest(new et(t));et.isAllowReadAnnouncement(te)&&vr.delay(function(){i.api.getAnnouncementStatus(te.id)},500),this.sendNotification(e,[null,te]),n();break;case"notify_leave_account_control_group":var ne=t;this.dataStore.removeAccountControlGroup(ne),this.sendNotification(e,ne),n();break;case"notify_leave_domain":var ie=t;this.dataStore.removeDomain(ie),this.conferenceStore.removeConferencesOnLeaveDomain(ie),this.sendNotification(e,ie),n();break;case"notify_open_conference":var re=this.dataFactory.newConference(t);this.sendNotification(e,re),n();break;case"notify_update_account_control_group_partially":var ae=new xe(t);this.dataStore.updateAccountControlGroup(ae),this.sendNotification(e,ae),n();break;case"notify_update_announcement_status":var oe=new He(t),se=this.dataStore.getAnnouncementStatus(oe.domainId);null==se&&(se=this.assureAnnouncementStatus(oe.domainId)),se.updateReadWithStatusUpdate(oe),this.dataStore.setAnnouncementStatus(se),this.sendNotification(e,oe),n();break;case"notify_update_department_tree":var le=t;this.departmentStore.clearDomainDepartment(le),this.api.getDepartmentTree(le),this.sendNotification(e,le),n();break;case"notify_update_department_users":var ue=t;this.departmentStore.clearDomainDepartmentUsers(ue),this.api.getUsers(ue,this.dataStore.getFriendsOrAcquaintances(ue).map(function(e){return e.id})),this.api.getMe(),this.sendNotification(e,ue),n();break;case"notify_update_domain":var ce=new et(t),_e=this.dataStore.getDomain(ce.id),he=this.dataStore.setDomainIfLatest(ce);if(null!=_e&&et.isAllowReadAnnouncement(_e)&&!et.isAllowReadAnnouncement(he)){this.dataStore.removeAnnouncementStatus(_e.id);var de=new He;de.domainId=he.id,this.sendNotification("notify_update_announcement_status",de)}if(!et.isAllowReadAnnouncement(_e)&&et.isAllowReadAnnouncement(he)&&this.api.getAnnouncementStatus(he.id),et.isChangedContractTreeEnabled(_e,he)&&!et.isDepartmentEnabled(he)){var fe=he.id;this.departmentStore.clearDomainDepartment(fe),this.dataStore.clearUsersDepartments(fe)}this.sendNotification(e,[_e,he]),n();break;case"notify_update_domain_users":for(var pe=t,ge=0;ge<pe.length;){var ve=pe[ge];++ge;var ye=this.dataStore.getDomain(ve);null!=ye&&ye.setting.contactTreeEnabled&&this.departmentStore.clearDomainDepartmentUsers(ve)}this.sendNotification(e,t),n();break;case"notify_delete_talker":case"notify_update_group_talk":var Se=new _n(t);this.dataStore.setTalk(Se),this.sendNotification(e,Se),n();break;case"notify_update_note_partially":if(null==t)return void si._e("["+_.dateStr(new Date)+"] ","notePartiallyUpdate is null.","","","","");if(null==t.note_id)return void si._e("["+_.dateStr(new Date)+"] ","noteId is null.","","","","");var we=new Qn(t.note_id),Te=this.dataStore.getNote(we);if(null!=Te&&null!=t.note_revision_summary&&Te.compareRevision(t.note_revision_summary.revision)<=-1&&this.dataStore.setNote(we,null),null==t.note_revision_summary&&null==t.setting)return void si._e("["+_.dateStr(new Date)+"] ","noteSetting and noteRevisionSummary are null.","","","","");null!=t.setting&&this.sendNotification("notify_update_note_for_setting",new Jn(t)),null!=t.note_revision_summary&&this.sendNotification("notify_update_note_for_revision",new Xn(t)),n();break;case"notify_update_read_statuses":var Ie=new Rt(t),Ee=this.updateTalkStatus(Ie);null!=Ee&&this.sendNotification("notify_update_local_talk_status",Ee),this.sendNotification(e,Ie),n();break;case"notify_update_talk_status":var be=new En(t),Ae=this.dataStore.getTalkStatus(be.talkId);null!=Ae&&Ae.update(be)&&(this.dataStore.setTalkStatus(Ae),this.sendNotification("notify_update_local_talk_status",Ae)),this.sendNotification(e,be),n();break;case"notify_update_user":if(t instanceof Array&&null==t.__enum__){var Ne=this.dataFactory.newDomainUser(t[1]);this.dataStore.setUserIfLatest(null,Ne)}else{var ke=new bt(t);si._d("["+_.dateStr(new Date)+"] ","Current user updated. user:",ke,"","","");var De=this.dataStore;De.me=ke;for(var Ce=0,Re=De.getDomains();Ce<Re.length;){var Me=Re[Ce];++Ce,De.sendNotification("notify_update_user",De.me.toDomainUser(Me.id))}De.sendNotification("current_user_changed",ke),De.storage.setDirtyFlag()}n();break;default:this.sendNotification(e,t),n()}},updateTalkStatusByFavoriteTalkEvent:function(e){var t=this.dataStore.getTalkStatus(e.talkId);if(null==t){var n=this.dataStore.getTalk(e.talkId);if(null==n)return void si._e("["+_.dateStr(new Date)+"] ","talk not found on change favorite talk.","","","","");t=new Tn,t.id=e.talkId,t.talkOrderingTimestamp=n.updatedAt}(null==t.favoriteVersion||e.favoriteVersion>t.favoriteVersion)&&(t.favoriteVersion=e.favoriteVersion,t.orderInFavorites=e.orderInFavorites,this.dataStore.setTalkStatus(t))},updateTalkStatusByConferenceClosedEvent:function(e){var t=this.dataStore.getTalkStatus(e.talkId);if(null!=t&&null!=t.maxMessage){var n=t.maxMessage.id,i=e.messageId;null!=n&&null!=i&&n.high==i.high&&n.low==i.low&&(t.maxMessage.content.closed=!0,this.dataStore.setTalkStatus(t))}},updateTalkStatusByTalkPushNotificationEvent:function(e,t){var n=this.dataStore.getTalkStatus(t.talkId);if(null==n){var i=this.dataStore.getTalk(t.talkId);if(null==i)return void si._e("["+_.dateStr(new Date)+"] ","talk not found on change favorite talk.","","","","");n=new Tn,n.id=t.talkId,n.talkOrderingTimestamp=i.updatedAt}(null==n.pushNotificationSetting||t.version>n.pushNotificationSetting.version)&&(n.pushNotificationSetting=Wt.createWithParams(e,t.version),this.dataStore.setTalkStatus(n))},newTalkStatusByTalk:function(e){var t=this.dataStore.getTalkStatus(e.id);return null==t&&(t=new Tn,t.id=e.id),null==t.talkOrderingTimestamp&&(t.talkOrderingTimestamp=e.updatedAt),this.dataStore.setTalkStatus(t),t},newTalkStatusByMessage:function(e){var t=this.dataStore.getTalkStatus(e.talkId);if(null==t&&(t=new Tn,t.id=e.talkId),In.isNewMax(t,e.id)&&(t.maxMessageId=e.id,t.maxMessage=e),e.isUnreadCountTarget){var n,i=this.dataStore,r=e.userId;if(null!=i.me){var a=i.me.id;n=null!=a&&null!=r&&a.high==r.high&&a.low==r.low}else n=!1;n||t.unreadCount++,t.talkOrderingTimestamp=e.createdAt}return this.dataStore.setTalkStatus(t),t},updateTalkStatusOnMessageDelete:function(e){var t=this.dataStore.getTalkStatus(e.talkId);return null!=t&&(In.isUnread(t,e.messageId)&&(t.unreadCount-=1,t.unreadCount<0&&(t.unreadCount=0)),In.isMax(t,e.messageId)&&null!=t.maxMessage&&(t.maxMessage.type=Nt.deleted),this.dataStore.setTalkStatus(t)),t},updateTalkStatus:function(e){var t=this;if(!h.exists(e.readUserIds,function(e){var n=t.dataStore;if(null!=n.me){var i=n.me.id;return null!=i&&null!=e&&i.high==e.high&&i.low==e.low}return!1}))return null;var n=this.dataStore.getTalkStatus(e.talkId);if(null==n)return si._e("["+_.dateStr(new Date)+"] ","talkStatus is not found.","","","",""),null;for(var i=e.messageIds[0],r=0,a=e.messageIds;r<a.length;){var o=a[r];if(++r,In.isUnread(n,o)){var s=i.high-o.high|0;s=0!=s?s:mr.ucompare(i.low,o.low),(i.high<0?o.high<0?s:-1:o.high>=0?s:1)<0&&(i=o),M.notContains(e.messageIdsExcludingUnreadCountTargets,o)&&n.unreadCount--}}return In.isUnread(n,i)&&(n.maxReadMessageId=i,this.dataStore.setTalkStatus(n)),n},newAnnouncementStatus:function(e){var t=this.dataStore.getAnnouncementStatus(e.domainId);return null==t&&(t=new Be,t.domainId=e.domainId),je.isNewMax(t,e.id)&&(t.maxAnnouncementId=e.id,t.maxAnnouncement=e),null==t.unreadCount&&(t.unreadCount=0),t.unreadCount++,this.dataStore.setAnnouncementStatus(t),t},assureAnnouncementStatus:function(e){var t=this.dataStore.getAnnouncementStatus(e);return null==t&&(t=this.dataFactory.newAnnouncementStatusForDomain(e)),t},__class__:Ii});var Ei=function(){vi.call(this,"api")};a["albero.proxy.AlberoServiceProxy"]=Ei,Ei.__name__=["albero","proxy","AlberoServiceProxy"],Ei.__super__=vi,Ei.prototype=n(vi.prototype,{getOSString:function(){return"bot"},createAccessToken:function(e,t,n){var i,r,a=this,o=this.settings.getOs(),s=this.settings.getIDFV(),l=e.split("$");-1==e.indexOf("@")&&2==l.length?(i="create_access_token_by_id",r=[l[1],l[0],t,s,o,""]):(i="create_access_token",r=[e,t,s,o,""]),this.apiCaller.callImmediately(i,r,function(e){si._d("["+_.dateStr(new Date)+"] ","access token:",e,"","",""),a.settings.setAccessToken(e),n(e)},function(e){a.sendNotification("Url",De.FORWARD(B.error))})},authorizeDevice:function(e,t){var n=this.settings.getIDFV();this.apiCaller.call("authorize_device",[e,n],function(e){t()})},createSession:function(e,t){var n=this,i=[e,"1.105",this.getOSString()];this.apiCaller.callCreateSession(i,function(e){var i=new an(e),r=D.nowAsInt64();if(i.passwordExpiration.isExpired(r))return void n.sendNotification("password_expiration_overed");i.passwordExpiration.needWarning(r,n.settings.getPasswordWarningSkipUntil())&&(n.settings.setPasswordWarningSkipUntil(D.oneDayAfterAsInt64()),n.sendNotification("password_expiration_warned")),t(i)},function(e){if(null!=e){if(401==e.code&&"expired password"==e.message)return void n.sendNotification("password_expiration_overed");if(401==e.code&&"deleted account"==e.message)return void n.sendNotification("SignOut");if(401==e.code&&"unauthorized device"==e.message)return void n.sendNotification("Device",ee.AUTHORIZE);n.apiCaller.handleServerErrorDefault(e)}n.settings.clearAccessToken(),n.sendNotification("Url",De.FORWARD(B.error))})},startNotification:function(){var e=this;this.apiCaller.call("start_notification",[],function(t){t||(e.dataStore.clear(!0),si._e("["+_.dateStr(new Date)+"] ","start_notification failed.","","","",""),process.exit(1))})},resetNotification:function(e){this.apiCaller.call("reset_notification",[],e)},sendDomainNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_update_domain",[null,n])}},sendAnnouncementStatusNotification:function(e){var t=new He;t.domainId=e.domainId,this.sendNotification("notify_update_announcement_status",t)},sendTalkNotification:function(e){var t=e.type==dn.PairTalk?"notify_create_pair_talk":"notify_create_group_talk";this.sendNotification(t,e)},sendTalkNotifications:function(e){h.iter(e,r(this,this.sendTalkNotification))},sendTalkStatusNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_update_local_talk_status",n)}},deleteSession:function(){this.settings.clearSelectedStampTabId(),this.settings.clearDomainSelection(),this.settings.clearAccessToken(),this.apiCaller.restart()},updateUser:function(e,t,n,i,r){var a=this,o=function(e){a.sendNotification("update_user_errored",a.dataStore.me)},s=function(t){a.apiCaller.call("update_user",[e,t,i,r],function(e){var t=a.dataStore,n=new bt(e);t.me=n;for(var i=0,r=t.getDomains();i<r.length;){var o=r[i];++i,t.sendNotification("notify_update_user",t.me.toDomainUser(o.id))}t.sendNotification("current_user_changed",n),t.storage.setDirtyFlag(),a.sendNotification("update_user_responsed",a.dataStore.me)},function(e){o(),a.apiCaller.handleServerErrorDefault(e)})};null!=n?s(n):null!=t?this.uploadFile(t,null,Nn.PROFILE_IMAGE,function(e){s(e.get_url)},o):s()},updateProfile:function(e){var t=this,n=Gt.convertToApiParams(e);this.apiCaller.call("update_profile",[n],function(e){si._d("["+_.dateStr(new Date)+"] ","update_profile_succeed",e,"","","");var n=t.dataStore,i=new bt(e);n.me=i;for(var r=0,a=n.getDomains();r<a.length;){var o=a[r];++r,n.sendNotification("notify_update_user",n.me.toDomainUser(o.id))}n.sendNotification("current_user_changed",i),n.storage.setDirtyFlag(),t.sendNotification("update_profile_responsed",t.dataStore.me)},function(e){t.sendNotification("update_profile_errored",t.dataStore.me),t.apiCaller.handleServerErrorDefault(e)})},addFriend:function(e){var t=this.settings.getSelectedDomainId();this.apiCaller.call("add_friend",[t,e.id])},deleteFriend:function(e){var t=this.settings.getSelectedDomainId();this.apiCaller.call("delete_friend",[t,e.id])},getFriends:function(e){var t=this;this.apiCaller.call("get_friends",[],function(n){for(var i=0;i<n.length;){var r=n[i];++i;var a=(r[0],r[1]);h.iter(a,function(e){var n=t.dataFactory.newFriend(e);t.sendNotification("notify_add_friend",n)})}null!=e&&e()})},getAcquaintances:function(e){var t=this;this.apiCaller.call("get_acquaintances",[],function(n){for(var i=0;i<n.length;){var r=n[i];++i;var a=r[1];h.iter(a,function(e){var n=t.dataFactory.newAcquaintance(e);t.sendNotification("notify_add_acquaintance",n)})}null!=e&&e()})},getAllUsers:function(e){var t=this,n=this.settings.getSelectedDomainId();this.apiCaller.call("get_domain_users",[n,14,40,e],function(e){var i=F.asArray(e.contents).map((oa=t.dataFactory,r(oa,oa.newDomainUser)));t.dataStore.setUsersIfLatest(n,i),t.sendNotification("get_domain_users_responsed",[n,e.marker,e.next_marker,i])})},getUsers:function(e,t){this._getUsers(e,t.slice())},_getUsers:function(e,t){var n=this,i=t.splice(0,100);0!=i.length&&this.apiCaller.call("get_users",[e,i],function(i){var a=i.map((oa=n.dataFactory,r(oa,oa.newDomainUser)));n.dataStore.setUsersIfLatest(e,a),n.sendNotification("get_users_responsed",[e,a]),n._getUsers(e,t)})},getProfile:function(e,t){var n=this;this.apiCaller.call("get_profile",[e,t],function(e){var t=new Bt(e);n.sendNotification("get_profile_responsed",t)},function(e){403==e.code&&"invalid user"==e.message?null!=e.detail&&null!=e.detail.invalid_user_ids&&n.sendNotification("get_profile_errored",e.detail.invalid_user_ids):n.apiCaller.handleServerErrorDefault(e)})},searchDomainUsers:function(e,t){var n=this,i=this.settings.getSelectedDomainId();this.apiCaller.call("search_domain_users",[i,e,14,40,t],function(t){var a=F.asArray(t.contents).map((oa=n.dataFactory,r(oa,oa.newDomainUser)));n.dataStore.setUsersIfLatest(i,a),n.sendNotification("get_domain_users_responsed",[i,t.marker,t.next_marker,a,e])})},getUserIdentifiers:function(e,t,n){var i=this;if(0==t.length)null!=n&&n();else{var r=t.slice(0,100);this._getUserIdentifiers(e,r,function(){var r=t.slice(100);i.getUserIdentifiers(e,r,n)})}},_getUserIdentifiers:function(e,t,n){var i=this;this.apiCaller.call("get_user_identifiers",[e,t],function(r){for(var a=r.contents,o=new kr,s=0,l=a.length;s<l;){var u=s++,c=new Dn(a[u]),_=c.userId,h="_"+_.high+"_"+_.low;null!=ma[h]?o.setReserved(h,c):o.h[h]=c}for(var d=0,f=t.length;d<f;){var m=d++,p=i.dataStore.getUser(e,t[m]);if(null!=p){var g=p.id,v="_"+g.high+"_"+g.low,y=null!=ma[v]?o.getReserved(v):o.h[v];null!=y&&(p.email=y.email,p.subEmail=y.subEmail,p.groupAlias=y.groupAlias,p.signinId=y.signinId),p.__uid_caching=!0}}null!=n&&n()},function(r){for(var a=0,o=t.length;a<o;){var s=a++,l=i.dataStore.getUser(e,t[s]);null!=l&&(l.__uid_caching=null)}null!=n&&n()})},getAllUserIdentifiers:function(e){var t=this,n=null,i=this.dataStore.getUsers();null==i&&(i=[]);for(var r=0;r<i.length;){var a=i[r];if(++r,null==a.__uid_caching){a.__uid_caching=!1;var o=a.domainId,s="_"+o.high+"_"+o.low;null==n&&(n=new kr);var l=null!=ma[s]?n.getReserved(s):n.h[s];null==l&&(l=[],null!=ma[s]?n.setReserved(s,l):n.h[s]=l),l.push(a.id)}}if(null==n)e();else{var u=n.keys(),c=null;c=function(){if(u.hasNext()){var i=u.next(),r=M.makeFromIdStr(i),a=null!=ma[i]?n.getReserved(i):n.h[i];t.getUserIdentifiers(r,a,c)}else e()},c()}},getAllUserEmails:function(e){si._w("["+_.dateStr(new Date)+"] ","'getAllUserEmails' is deprecated, please use 'getAllUserIdentifiers' instead","","","",""),this.getAllUserIdentifiers(e)},getDepartmentTree:function(e){var t=this;this.apiCaller.call("get_department_tree",[e],function(n){h.iter(new Xe(n).departments,function(n){n.isRoot()&&t.departmentStore.setRootDepartmentId(e,n.id),t.departmentStore.setDepartment(n)});var i=t.settings.getSelectedDepartmentId(e);null!=i&&null==t.departmentStore.getDepartment(i)&&t.settings.setSelectedDepartmentId(e,null),t.sendNotification("get_department_tree_responsed",[e])},function(n){if(403==n.code&&"forbidden"==n.message)return void t.sendNotification("get_department_tree_canceled",[e]);t.apiCaller.handleServerErrorDefault(n)})},getDepartmentUsers:function(e,t){this._getDepartmentUsers(e,t,null)},getDepartmentAllUsers:function(e){var t=this,n=this.departmentStore.getDepartment(e);if(null!=n&&null!=n.userIds)return void this.sendNotification("department_user_ids_prepared",n.userIds);var i=new kr,r=null;r=function(n,a,o){if(h.iter(o,function(e){var t=e.id,n="_"+t.high+"_"+t.low,r=e.id;null!=ma[n]?i.setReserved(n,r):i.h[n]=r}),null==a){for(var s=[],l=i.arrayKeys(),u=new Nr(i,l);u.hasNext();){var c=u.next();s.push(c)}var d=s.length;si._d("["+_.dateStr(new Date)+"] ","department all users prepared. [departmentId, users_count]:",e,d,"",""),t.departmentStore.setDepartmentUsers(e,s),t.sendNotification("department_user_ids_prepared",s)}else t._getDepartmentUsers(e,a,r)},this._getDepartmentUsers(e,null,r)},_getDepartmentUsers:function(e,t,n){var i=this,a=this.settings.getSelectedDomainId(),o=this.departmentStore.getDepartment(e),s=null!=o&&null!=o.childrenIds;this.apiCaller.call("get_department_users",[a,e,s,100,t],function(t){var o=F.asArray(t.contents).map((oa=i.dataFactory,r(oa,oa.newDomainUser)));i.dataStore.setUsersIfLatest(a,o),i.sendNotification("get_department_users_responsed",[a,t.marker,t.next_marker,o,e]),null!=n&&n(t.marker,t.next_marker,o)},function(e){if(403==e.code&&"forbidden"==e.message)return void i.sendNotification("get_department_users_canceled",[a]);i.apiCaller.handleServerErrorDefault(e)})},getMe:function(){var e=this;this.apiCaller.call("get_me",[],function(t){var n=e.dataStore,i=new bt(t);n.me=i;for(var r=0,a=n.getDomains();r<a.length;){var o=a[r];++r,n.sendNotification("notify_update_user",n.me.toDomainUser(o.id))}n.sendNotification("current_user_changed",i),n.storage.setDirtyFlag(),e.sendNotification("get_me_responsed")},function(t){e.apiCaller.handleServerErrorDefault(t)})},getDepartmentUserCount:function(e,t){var n=t.filter((oa=this.departmentStore,r(oa,oa.needUserCountLoading)));this._getDepartmentUserCount(e,n)},_getDepartmentUserCount:function(e,t){var n=this,i=t.splice(0,100);0!=i.length&&(h.iter(i,function(e){n.departmentStore.setUserCountLoading(e,!0)}),this.apiCaller.call("get_department_user_count",[e,i],function(a){var o=new $e(a);h.iter(o.departments,(oa=n.departmentStore,r(oa,oa.setDepartmentUserCount))),n.sendNotification("get_department_user_count_responsed",{completed:i,remaining:t}),n._getDepartmentUserCount(e,t)},function(e){h.iter(i,function(e){n.departmentStore.setUserCountLoading(e,!1)}),n.apiCaller.handleServerErrorDefault(e)}))},getDomains:function(e){var t=this;this.apiCaller.call("get_domains",[],function(n){h.iter(n,(oa=t.dataFactory,r(oa,oa.newDomain)));var i=t.dataStore.getDomains();t.sendDomainNotifications(i),null!=e&&e()})},leaveDomain:function(e){var t=this;this.apiCaller.call("leave_domain",[e.id],function(e){t.dataStore.removeDomain(e)})},getDomainInvites:function(e){var t;t=null==e?function(e){}:function(t){e()},this._getDomainInvites(t)},_getDomainInvites:function(e){var t=this;this.apiCaller.call("get_domain_invites",[],function(n){var i=n.map((oa=t.dataFactory,r(oa,oa.newDomainInvite)));h.iter(i,function(e){t.sendNotification("notify_add_domain_invite",e)}),e(i)})},acceptDomainInvite:function(e){this.apiCaller.callApiReliable("accept_domain_invite",[e],function(e){})},deleteDomainInvite:function(e){this.apiCaller.callApiReliable("delete_domain_invite",[e],function(e){})},getAccountControlRequests:function(e){var t=this;this.apiCaller.call("get_account_control_requests",[],function(n){h.iter(n.map((oa=t.dataFactory,r(oa,oa.newAccountControlRequest))),function(e){t.sendNotification("notify_add_account_control_request",e)}),null!=e&&e()})},acceptAccountControlRequest:function(e){if(null!=e){var t=this.dataStore.getAccountControlRequest(e);null!=t&&this.apiCaller.call("accept_account_control_request",[t.id,t.version],function(e){})}},rejectAccountControlRequest:function(e){if(null!=e){var t=this.dataStore.getAccountControlRequest(e);null!=t&&this.apiCaller.call("reject_account_control_request",[t.id,t.version],function(e){})}},getJoinedAccountControlGroup:function(e){var t=this;this.apiCaller.call("get_joined_account_control_group",[],function(n){h.iter(n.map((oa=t.dataFactory,r(oa,oa.newAccountControlGroup))),function(e){t.sendNotification("notify_join_account_control_group",e)}),null!=e&&e()})},getTalks:function(e){var t=this;this.apiCaller.call("get_talks",[],function(n){h.iter(n,(oa=t.dataFactory,r(oa,oa.newTalk))),t.apiCaller.call("get_talk_statuses",[],function(n){h.iter(n,(oa=t.dataFactory,r(oa,oa.newTalkStatus)));var i=t.dataStore.getTalks();t.sendTalkNotifications(i);var a=t.dataStore.getTalkStatuses();t.sendTalkStatusNotifications(a),null!=e&&e()})})},getReadStatus:function(e,t){var n=this;this.apiCaller.call("get_read_status",[e,t],function(e){n.sendNotification("notify_get_message_status",new Ot(e))})},createGroupTalk:function(e,t,n,i){var r=this;null==e&&(e=this.settings.getSelectedDomainId()),0!=t.length&&this.apiCaller.call("create_group_talk",[e,t,n.allowDisplayPastMessages,!0],function(e){var t=r.dataFactory.newTalk(e);r.sendNotification("notify_create_group_talk",t)},function(e){if(null!=e&&500==e.code&&null!=e.detail&&"failure in adding some users"==e.message){var t=Ki.toLocalError(It.AddingSomeUsersFailure,e);r.sendNotification("error_occurred",t)}else if(null!=e&&502==e.code&&null!=e.detail&&"talks"==e.detail.limit_target){var n=e.detail.limit_max,i=Ki.toLocalError(It.TalksCountOvered(n),e);r.sendNotification("error_occurred",i)}else if(null!=e&&502==e.code&&null!=e.detail&&"talkers"==e.detail.limit_target){var a=e.detail.limit_max,o=Ki.toLocalError(It.TalkersCountOvered(a),e);r.sendNotification("error_occurred",o)}else r.apiCaller.handleServerErrorDefault(e)})},createPairTalk:function(e,t,n){var i=this;null==e&&(e=this.settings.getSelectedDomainId()),this.apiCaller.call("create_pair_talk",[e,t],function(e){var t=i.dataFactory.newTalk(e);i.sendNotification("notify_create_pair_talk",t)},function(e){if(null!=e&&502==e.code&&null!=e.detail&&"talks"==e.detail.limit_target){var t=e.detail.limit_max,n=Ki.toLocalError(It.TalksCountOvered(t),e);i.sendNotification("error_occurred",n)}else i.apiCaller.handleServerErrorDefault(e)})},updateGroupTalk:function(e,t,n,i){var r=this;this.apiCaller.call("update_group_talk",[e.id,t,n,i],function(e){var t=r.dataFactory.newTalk(e);r.sendNotification("notify_update_group_talk",t)},function(e){r.sendNotification("notify_update_group_talk_ERRORED"),r.apiCaller.handleServerErrorDefault(e)})},addTalkers:function(e,t,n){var i=this;if(e.type==dn.PairTalk){var r=e.userIds.concat(t);M.remove(r,this.dataStore.me.id);var a=this.settings.getSelectedDomainId();return void this.createGroupTalk(a,r,hn.createDefault(),n)}0!=t.length&&this.apiCaller.call("add_talkers",[e.id,t,!0],function(e){var t=i.dataFactory.newTalk(e);i.sendNotification("notify_add_talkers",t)},function(e){if(null!=e&&500==e.code&&null!=e.detail&&"failure in adding some users"==e.message){var t=Ki.toLocalError(It.AddingSomeUsersFailure,e);i.sendNotification("error_occurred",t)}else if(null!=e&&502==e.code&&null!=e.detail&&"talkers"==e.detail.limit_target){var n=e.detail.limit_max,r=Ki.toLocalError(It.TalkersCountOvered(n),e);i.sendNotification("error_occurred",r)}else i.apiCaller.handleServerErrorDefault(e)})},deleteTalker:function(e,t){var n,i=this,r=null,a=null,o=this.dataStore;if(null!=o.me){var s=o.me.id;n=null!=s&&null!=t&&s.high==t.high&&s.low==t.low}else n=!1;n&&(r=e,a=this.dataStore.getTalkStatus(e.id),this.dataStore.removeTalk(e.id),this.dataStore.removeTalkStatus(e.id)),this.apiCaller.call("delete_talker",[e.id,t],function(r){M.remove(e.userIds,t),n||i.dataStore.setTalk(e),n&&i.conferenceStore.removeConferencesOnLeaveTalk(e.id),i.sendNotification("notify_delete_talker",e)},function(e){null!=r&&i.dataStore.setTalk(r),null!=a&&i.dataStore.setTalkStatus(a),i.sendNotification("error_occurred",e)})},getMessages:function(e,t,n,i){var a=this;t=null==t?{sinceId:null,maxId:null}:t,null==n&&(n=Mt.desc);var o=this.apiCaller,s=t.sinceId,l=t.maxId,u=xt.orderToInt(n);o.call("get_messages",[e,20,s,l,u],function(t){var o=t.map((oa=a.dataFactory,r(oa,oa.newMessage)));a.sendNotification("notify_get_messages",{talkId:e,messages:o,sortOrder:n,callerKey:i})})},createMessage:function(e,t,n,i){var r=this,a=this.dataFactory.newDummyMessage(e,t,n);if(null==this.dataStore.getTalk(e)){var o={code:400,message:"invalid talk_id (deleted talk)"};return si._w("["+_.dateStr(new Date)+"] ","WARNING method: create_message",o,"","",""),void this.sendNotification("create_message_fail",[o,a],i)}this.sendNotification("create_message_start",a),this.apiCaller.call("create_message",[e,At.enumIndex(t),n],function(e){r.fileInfoStore.removeMessageFileInfos(a.id);var t=r.dataFactory.newMessage(e);r.sendNotification("create_message_complete",[t,a.id],i)},function(e){if(r.sendNotification("create_message_fail",[e,a],i),null!=e&&409==e.code){var t=Ki.toLocalError(It.SendingMessageConflicted,e);r.sendNotification("error_occurred",t)}else r.sendNotification("error_occurred",e)})},forwardMessages:function(e,t,n){null==n&&(n=0);var i=this;if(!(n>=t.length)){var r=t[n],a=e.id,o=this.dataFactory.newDummyMessage(a,r.type,r.content);this.sendNotification("create_message_start",o),this.apiCaller.call("create_message",[a,At.enumIndex(r.type),r.content],function(r){var a=i.dataFactory.newMessage(r);i.sendNotification("create_message_complete",[a,o.id]),i.forwardMessages(e,t,n+1)},function(e){if(i.sendNotification("create_message_fail",[e,o]),null!=e&&409==e.code){var t=Ki.toLocalError(It.SendingMessageConflicted,e);i.sendNotification("error_occurred",t)}else i.sendNotification("error_occurred",e)})}},deleteMessage:function(e,t){var n=this;this.apiCaller.call("delete_message",[e,t],function(i){var r=new Ct;r.talkId=e,r.messageId=t,n.sendNotification("notify_delete_message",r)},function(e){if(null!=e){if(403==e.code&&"frozen domain"==e.message)return void n.sendNotification("error_occurred",e);if(409==e.code&&"conflict"==e.message){var t=Ki.toLocalError(It.DeletingMessageConflicted,e);return void n.sendNotification("error_occurred",t)}n.sendNotification("error_occurred",e)}})},updateReadStatuses:function(e,t){var n=this;this.apiCaller.callApiReliable("update_read_statuses",[e,t],function(i){var r,a=n.dataStore.getTalkStatus(e);if(null!=a){var o=a.maxReadMessageId;r=null!=o&&null!=t&&o.high==t.high&&o.low==t.low}else r=!1;r&&n.sendNotification("notify_update_local_talk_status",a)},null,function(e){return 429==e.code&&"too many requests"==e.message?Ar.Some(1e3*n.asInt(e.detail.retry_after)):Ar.None})},upload:function(e,t,n,i){var r=this,a=this.dataFactory.newDummyFileMessage(t,n),o=function(e){r.sendNotification("create_message_fail",[e,a],i)};this.prepareFileMessage(n,e,t,a,function(e){r.createMessageReliable(t,Nt.file,e,a,i)},o)},uploadMulti:function(e,t,n,i,r){var a=this,o=this.dataFactory.newDummyMultipleFileMessage(t,n,i);this.sendNotification("create_message_start",o);var s=function(e){a.sendNotification("create_message_fail",[e,o],r)},l=[],u=function(){if(l.length==i.length){var e={files:l};null!=n&&n.length>0&&(e.text=n),a.createMessageReliable(t,Nt.textMultipleFile,e,o,r)}},c=null;c=function(n){if(n.hasNext()){var i=n.next();a.prepareFileMessage(i,e,t,null,function(e){l.push(e),c(n)},s)}else u()};var h=_.iter(i);c(h)},prepareFileMessage:function(e,t,n,i,r,a){var o=this;this.uploadThumbnail(e,t,n,null,function(n){o.uploadFile(e,t,Nn.MESSAGE,function(t){var i=hi.normalize(e.name),a=C.createFileInfoDynamic(e,i,n,t);r(a)},a)},a)},createMessageReliable:function(e,t,n,i,r){var a=this;this.apiCaller.callApiReliable("create_message",[e,At.enumIndex(t),n],function(e){var t=a.dataFactory.newMessage(e);a.sendNotification("create_message_complete",[t,i.id],r)},function(e){if(a.sendNotification("create_message_fail",[e,i],r),null!=e&&409==e.code){var t=Ki.toLocalError(It.SendingMessageConflicted,e);a.sendNotification("error_occurred",t)}else a.sendNotification("error_occurred",e)},function(e){return 500==e.code&&"Internal Error (IllegalStateException)"==e.message?Ar.Some(1e3):Ar.None})},uploadThumbnail:function(e,t,n,i,r,a){var o=this,s=Mi.getBlobFromUpdatableFile(e);this.fileService.asyncCreateThumbnail(s).then(function(e){null!=i&&(U.foreach(o.fileInfoStore.getMessageFileInfos(i.id),function(t){t[0].setDummyThumbnail(e)}),o.sendNotification("create_message_start",i)),o.uploadFile(e.file,t,Nn.THUMBNAIL,function(t){e.setAuth(t),r(Ar.Some(e))},a)},function(e){null!=i&&o.sendNotification("create_message_start",i),r(Ar.None)})},uploadFile:function(e,t,n,i,r){var a=this,o=hi.normalize(e.name);this.apiCaller.call("create_upload_auth",[o,e.type,e.size,t,kn.getUseTypeInt(n)],function(t){var n=i,o=t,s=function(){n(o)};a.fileService.upload(t,e.type,e,s,r)},function(e){if(null!=e)if(502==e.code&&null!=e.detail){var t=e.detail.limit_max;if("file_size"==e.detail.limit_target){var n=Ki.toLocalError(It.UploadSizeOvered(t),e);a.sendNotification("error_occurred",n)}else if("storage_size"==e.detail.limit_target){var i=Ki.toLocalError(It.StorageSizeOvered(t),e);a.sendNotification("error_occurred",i)}}else a.sendNotification("error_occurred",e);r(e)})},createDownloadAuth:function(e,t,n,i,r){var a=this;this.apiCaller.callApiReliable("create_download_auth",[e,t,n],function(e){i(new dt(e))},function(e){r(e)},function(e){return 429==e.code&&"too many requests"==e.message?Ar.Some(1e3*a.asInt(e.detail.retry_after)):Ar.None})},deleteAttachment:function(e,t){this.apiCaller.call("delete_attachment",[e,t])},getAttachments:function(e,t){var n=this;null==t&&(t={sinceId:null,maxId:null}),this.apiCaller.call("get_attachments",[e,20,t.sinceId,t.maxId],function(t){var i=t.map((oa=n.dataFactory,r(oa,oa.newFileInfo)));n.sendNotification("get_file_responsed",{talkId:e,files:i})})},createAnnouncement:function(e,t,n,i){var r=this
;if(null!=e||null!=(e=this.settings.getSelectedDomainId())){var a=this.dataFactory.newDummyMessage(null,t,n);this.sendNotification("create_announcement_start",a),this.apiCaller.call("create_announcement",[e,At.enumIndex(t),n],function(e){var t=r.dataFactory.newAnnouncement(e);r.sendNotification("create_announcement_complete",[t,a.id],i)},function(e){r.sendNotification("create_announcement_fail",a),r.sendNotification("error_occurred",e)})}},getAnnouncements:function(e,t,n){var i=this,a=this.settings.getSelectedDomainId();if(null!=a){e=null==e?{sinceId:null,maxId:null}:e;var o=this.apiCaller,s=e.sinceId,l=e.maxId,u=xt.orderToInt(t);o.call("get_announcements",[a,20,s,l,u],function(e){var o=e.map((oa=i.dataFactory,r(oa,oa.newAnnouncement)));i.sendNotification("notify_get_announcements",{domainId:a,announcements:o,sortOrder:t,callerKey:n})})}},getAnnouncementStatuses:function(e){var t=this;this.apiCaller.call("get_announcement_statuses",[],function(n){for(var i=0;i<n.length;){var r=n[i];++i;var a=t.dataFactory.newAnnouncementStatus(r);t.sendAnnouncementStatusNotification(a),null!=e&&e()}})},getAnnouncementStatus:function(e,t){var n=this;this.apiCaller.callApiReliable("get_announcement_status",[e],function(e){var i=n.dataFactory.newAnnouncementStatus(e);n.sendAnnouncementStatusNotification(i),null!=t&&t()},null,function(e){return 400==e.code&&"invalid domain_id"==e.message?Ar.Some(1e3):Ar.None})},updateAnnouncementReadStatus:function(e,t){var n=this;this.apiCaller.call("update_announcement_status",[e,t],function(i){var r,a=n.dataStore.getAnnouncementStatus(e);if(null!=a){var o=a.maxReadAnnouncementId;r=null!=o&&null!=t&&o.high==t.high&&o.low==t.low}else r=!1;r&&n.sendAnnouncementStatusNotification(a)})},getQuestions:function(e,t,n,i){var a=this,o=this.settings.getSelectedDomainId(),s=null;null!=e&&(o=e.domainId,s=e.id);var l=Kt.fromTypeToInt(t),u=U.orNull(Kt.filterToOpBool(n));i=null==i?{sinceId:null,maxId:null}:i,this.apiCaller.call("get_actions",[o,s,l,u,20,i.sinceId,i.maxId],function(e){var i=e.map((oa=a.dataFactory,r(oa,oa.newQuestion)));a.sendNotification("get_questions_responsed",{domainId:o,talkId:s,questions:i,fromType:t,filter:n})})},getQuestion:function(e,t){var n=this;this.apiCaller.callApiReliable("get_action",[e],function(e){var i=n.dataFactory.newQuestion(e);n.sendNotification("notify_update_question",i),null!=t&&t(i)})},searchMessages:function(e,t,n,i){var r=this;this.searchService.prepareForSearching(e,n),this.apiCaller.call("search_messages",[e.domainId,e.talkId,e.getQueryText(),t,n],function(t){r.searchService.isRecentParams(e)&&r.searchService.isSearching()&&r.searchService.saveSearchMessagesResult(new Zt(t)),null!=i&&i()},function(a){if(r.searchService.notifySearchMessagesFail(),400==a.code&&null!=n)return void r.searchMessages(e,t,null,i);r.sendNotification("error_occurred",a)})},searchAttachments:function(e,t,n,i){var r=this;this.searchService.prepareForSearching(e,n),this.apiCaller.call("search_attachments",[e.domainId,e.talkId,e.getQueryText(),t,n],function(t){r.searchService.isRecentParams(e)&&r.searchService.isSearching()&&r.searchService.saveSearchAttachmentsResult(new Xt(t)),null!=i&&i()},function(a){if(r.searchService.notifySearchAttachmentsFail(),400==a.code&&null!=n)return void r.searchAttachments(e,t,null,i);r.sendNotification("error_occurred",a)})},startUpdateLastUsedAtIfNeed:function(){if(null==this.lastUsedExpiredAtTimer){var e,t=this.settings.getLastUsedExpiredAt();if(null==t)e=0;else{var n=t.high,i=t.low;e=4294967296*n+(i>=0?i:i+4294967296)-(new Date).getTime()|0}e<=0?(this.updateLastUsedAt(),this.lastUsedExpiredAtTimer=new vr(6e5),this.lastUsedExpiredAtTimer.run=r(this,this.updateLastUsedAt)):vr.delay(r(this,this.startUpdateLastUsedAtIfNeed),e)}},updateLastUsedAt:function(){var e=this;this.apiCaller.call("update_last_used_at",[],function(t){e.settings.setLastUsedExpiredAt(D.afterAsInt64(6e5))})},addFavoriteTalk:function(e,t){this.apiCaller.call("add_favorite_talk",[e,t])},deleteFavoriteTalk:function(e,t){this.apiCaller.call("delete_favorite_talk",[e,t])},disablePushNotification:function(e,t){this.apiCaller.call("disable_push_notification",[e,t])},enablePushNotification:function(e,t){this.apiCaller.call("enable_push_notification",[e,t])},getSolutions:function(e,t){var n=this;this.apiCaller.call("get_solutions",[e,t],function(e){h.iter(e,(oa=n.dataFactory,r(oa,oa.newSolution))),n.sendNotification("solutions_loaded")})},getPresences:function(e,t){var n=this;this.apiCaller.call("get_presences",[e,t],function(e){var i=D.nowAsInt64(),a=(oa=n.dataFactory,r(oa,oa.newUserPresence)),o=i;h.iter(e,function(e){return a(e,o)}),n.sendNotification("presences_updated",t)})},joinConference:function(e,t){var n=this;this.apiCaller.call("join_conference",[e,t],function(t){var i=new wt(t);n.sendNotification("join_conference_responsed",{talkId:e,joinConference:i})},function(e){n.sendNotification("join_conference_canceled",e)})},rejectConference:function(e){var t=this;this.apiCaller.call("reject_conference",[e],function(e){},function(e){return 404==e.code?void si._d("["+_.dateStr(new Date)+"] ","conference not found.","","","",""):409==e.code?void si._d("["+_.dateStr(new Date)+"] ","joined.","","","",""):void t.sendNotification("error_occurred",e)})},leaveConference:function(e){var t=this;this.apiCaller.call("leave_conference",[e],function(e){},function(e){if(404==e.code)return void si._d("["+_.dateStr(new Date)+"] ","conference not found.","","","","");t.sendNotification("error_occurred",e)})},getConferences:function(){var e=this;this.apiCaller.call("get_conferences",[],function(t){var n=t.map((oa=e.dataFactory,r(oa,oa.newConference)));h.iter(n,function(t){e.sendNotification("notify_open_conference",t)}),e.dataStore.filterReactedConferenceIds(n.filter(function(t){return!e.dataStore.isReactedConferenceId(t.id)}).map(function(e){return e.id}))})},getConferenceParticipants:function(e){var t=this;this.apiCaller.call("get_conference_participants",[e],function(n){U.foreach(t.conferenceStore.getConference(e),function(e){e.participants=n})})},getNoteStatuses:function(e,t){var n=this,i=this.settings.getSelectedDomainId();this.apiCaller.call("get_note_statuses",[i,e,60,t],function(t){n.sendNotification("get_note_statuses_loaded",{talkId:e,result:new Bn(t)})},function(e){400==e.code&&si._d("["+_.dateStr(new Date)+"] ","invalid parameter.","","","",""),n.sendNotification("error_occurred",e)})},getNote:function(e){var t=this;this.apiCaller.call("get_note",[e.value],function(e){var n=new Ln(e);t.dataStore.setNote(n.getNoteId(),n.note),t.sendNotification("get_note_loaded",n)},function(n){if(404==n.code)return si._d("["+_.dateStr(new Date)+"] ","note is not found.","","","",""),t.dataStore.setNote(e,null),void t.sendNotification("get_note_failed_by_note_not_found",e);400==n.code&&(si._d("["+_.dateStr(new Date)+"] ","invalid parameter.","","","",""),t.sendNotification("error_occurred",n))})},createNote:function(e,t,n,i,r){var a=this;this.apiCaller.call("create_note",[e,t,qn.getValue(n),i,r],function(e){a.sendNotification("create_note_completed",new Un(e))},function(e){400==e.code&&si._d("["+_.dateStr(new Date)+"] ","invalid parameter.","","","",""),a.sendNotification("error_occurred",e)})},updateNoteSetting:function(e,t,n){var i=this;this.apiCaller.call("update_note_setting",[e.value,t,n],function(e){i.sendNotification("update_note_setting_completed",new Hn(e))},function(t){return 404==t.code?(si._d("["+_.dateStr(new Date)+"] ","note is not found.","","","",""),i.dataStore.setNote(e,null),void i.sendNotification("update_note_setting_failed_by_not_found",e)):409==t.code?(si._d("["+_.dateStr(new Date)+"] ","conflict.","","","",""),i.dataStore.setNote(e,null),void i.sendNotification("update_note_setting_failed_by_conflict",e)):(400==t.code&&si._d("["+_.dateStr(new Date)+"] ","invalid parameter.","","","",""),403==t.code&&si._d("["+_.dateStr(new Date)+"] ","forbidden.","","","",""),void i.sendNotification("error_occurred",t))})},updateNote:function(e,t,n,i,r,a){var o=this,s=qn.getValue(i);this.apiCaller.call("update_note",[e.value,t,n,s,r,a],function(t){var n=new jn(t);o.dataStore.setNote(e,n.note),o.sendNotification("update_note_completed",n)},function(t){return 404==t.code?(si._d("["+_.dateStr(new Date)+"] ","note is not found.","","","",""),o.dataStore.setNote(e,null),void o.sendNotification("update_note_failed_by_not_found",e)):409==t.code?(si._d("["+_.dateStr(new Date)+"] ","conflict.","","","",""),o.dataStore.setNote(e,null),void o.sendNotification("update_note_failed_by_conflict",e)):(400==t.code&&si._d("["+_.dateStr(new Date)+"] ","invalid parameter.","","","",""),403==t.code&&si._d("["+_.dateStr(new Date)+"] ","forbidden.","","","",""),void o.sendNotification("error_occurred",t))})},deleteNote:function(e){var t=this;this.apiCaller.call("delete_note",[e.value],function(e){t.sendNotification("delete_note_completed",new Pn(e))},function(n){404==n.code&&(si._d("["+_.dateStr(new Date)+"] ","note is not found.","","","",""),t.dataStore.setNote(e,null)),400==n.code&&si._d("["+_.dateStr(new Date)+"] ","invalid parameter.","","","",""),403==n.code&&si._d("["+_.dateStr(new Date)+"] ","forbidden.","","","",""),t.sendNotification("error_occurred",n)})},addFavoriteMessage:function(e,t,n){var i=this;this.apiCaller.call("add_favorite_message",[e,t,n],function(e){i.sendNotification("add_favorite_message_completed",new Mn(e))},function(e){if(400==e.code&&"invalid message"==e.message&&si._d("["+_.dateStr(new Date)+"] ","invalid message.","","","",""),400==e.code&&"invalid message (not favoritable message)"==e.message&&si._d("["+_.dateStr(new Date)+"] ","invalid message (not favoritable message).","","","",""),403==e.code&&"forbidden"==e.message&&si._d("["+_.dateStr(new Date)+"] ","forbidden.","","","",""),404==e.code&&si._d("["+_.dateStr(new Date)+"] ","message is not found.","","","",""),409==e.code&&"conflict"==e.message)return void si._d("["+_.dateStr(new Date)+"] ","conflict","","","","");i.sendNotification("error_occurred",e)})},deleteFavoriteMessage:function(e,t){var n=this;this.apiCaller.call("delete_favorite_message",[e,t],function(e){n.sendNotification("delete_favorite_message_completed",new xn(e))},function(e){400==e.code&&si._d("["+_.dateStr(new Date)+"] ","invalid parameter.","","","",""),404==e.code&&si._d("["+_.dateStr(new Date)+"] ","message is not found.","","","",""),n.sendNotification("error_occurred",e)})},getFavoriteMessages:function(e,t,n){var i=this;this.apiCaller.call("get_favorite_messages",[e,t,20,n],function(n){var a=n.marker,o=n.next_marker,s=n.contents.map((oa=i.dataFactory,r(oa,oa.newMessage))),l=new Fn(e,t,a,o,s);i.sendNotification("get_favorite_messages_completed",l)},function(e){400==e.code&&si._d("["+_.dateStr(new Date)+"] ","invalid parameter.","","","",""),i.sendNotification("error_occurred",e)})},asInt:function(e){return jr.__cast(e,ua)},__class__:Ei});var bi=function(){this.callbacksWhenCreateSessionSucceed=[],this.createSessionSucceed=!1,vi.call(this,"apiCaller")};a["albero.proxy.ApiCallerProxy"]=bi,bi.__name__=["albero","proxy","ApiCallerProxy"],bi.__super__=vi,bi.prototype=n(vi.prototype,{callCreateSession:function(e,t,n){var i=this;this.createSessionSucceed=!1,this.rpc.call("create_session",e,function(e){i.createSessionSucceed=!0,null!=t&&t(e),h.iter(i.callbacksWhenCreateSessionSucceed,function(e){e()}),i.callbacksWhenCreateSessionSucceed.splice(0,i.callbacksWhenCreateSessionSucceed.length)},n)},callImmediately:function(e,t,n,i){this.rpc.call(e,t,n,i)},call:function(e,t,n,i){var a=(oa=this.rpc,r(oa,oa.call)),o=e,s=t,l=n,u=i,c=function(){a(o,s,l,u)};this.createSessionSucceed?c():this.callbacksWhenCreateSessionSucceed.push(c)},callApiReliable:function(e,t,n,i,r,a){null==a&&(a=3);var o=this,s=this.createOnErrorReliable(a,i,r,function(s){vr.delay(function(){o.callApiReliable(e,t,n,i,r,a-1)},s)});this.call(e,t,n,s)},createOnErrorReliable:function(e,t,n,i){return null==n&&(n=function(e){return 404==e.code?Ar.Some(1e3):Ar.None}),null==t&&(t=r(this,this.handleServerErrorDefault)),function(r){if(0==e)return void t(r);var a=n(r);if(U.isEmpty(a))return void t(r);U.foreach(a,i)}},handleServerErrorDefault:function(e){this.rpc.onServerError(e)},restart:function(){this.rpc.restart()},__class__:bi});var Ai=function(){vi.call(this,"appState")};a["albero.proxy.AppStateProxy"]=Ai,Ai.__name__=["albero","proxy","AppStateProxy"],Ai.__super__=vi,Ai.prototype=n(vi.prototype,{start:function(){this.updateLastActivityAt(),this.checkInactiveInterval()},activateAppIfNeed:function(){this.updateLastActivityAt(),this.appState==N.Inactive&&this.setAppState(N.Active)},setAppState:function(e){si._d("["+_.dateStr(new Date)+"] ","APP_STATE_CHANGED: ",e,"","",""),this.appState=e,this.sendNotification("app_state_changed",this.appState)},updateLastActivityAt:function(){this.lastActivityAt=new Date},checkInactiveInterval:function(){var e=this;this.checkInactive(),vr.delay(function(){e.checkInactiveInterval()},500)},checkInactive:function(){if(this.appState!=N.Inactive){(new Date).getTime()-this.lastActivityAt.getTime()<2e3||this.setAppState(N.Inactive)}},__class__:Ai});var Ni=function(){vi.call(this,"conferenceStore"),this.conferencesMap=new kr,this.talkIdConferenceIdMap=new kr};a["albero.proxy.ConferenceStoreProxy"]=Ni,Ni.__name__=["albero","proxy","ConferenceStoreProxy"],Ni.__super__=vi,Ni.prototype=n(vi.prototype,{addConference:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.conferencesMap;null!=ma[n]?i.setReserved(n,e):i.h[n]=e;var r=e.talkId,a="_"+r.high+"_"+r.low,o=this.talkIdConferenceIdMap;null!=ma[a]?o.setReserved(a,n):o.h[a]=n},removeConference:function(e){this.dataStore.removeReactedConfereceId(e.id);var t=e.id,n="_"+t.high+"_"+t.low;this.conferencesMap.remove(n);var i=e.talkId,r="_"+i.high+"_"+i.low,a=this.talkIdConferenceIdMap;(null!=ma[r]?a.getReserved(r):a.h[r])==n&&this.talkIdConferenceIdMap.remove(r),this.messageStore.onConferenceClose(e)},getConference:function(e){var t="_"+e.high+"_"+e.low,n=this.conferencesMap;return U.option(null!=ma[t]?n.getReserved(t):n.h[t])},hasConference:function(e){if(null!=e){var t="_"+e.high+"_"+e.low,n=this.talkIdConferenceIdMap;return null!=ma[t]?n.existsReserved(t):n.h.hasOwnProperty(t)}return!1},hasConferenceInDomain:function(e){return null!=h.find(this.getConferenceTalkIds().map(M.makeFromIdStr).map((oa=this.dataStore,r(oa,oa.getTalk))),function(t){if(null!=t){var n=t.domainId;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low}return!1})},getConferenceTalkIds:function(){for(var e=[],t=this.talkIdConferenceIdMap.keys();t.hasNext();){var n=t.next();e.push(n)}return e},hasConferenceInAllDomains:function(e){return U.isEmpty(e)?this.talkIdConferenceIdMap.keys().hasNext():null!=h.find(this.getConferenceTalkIds().map(M.makeFromIdStr).map((oa=this.dataStore,r(oa,oa.getTalk))),function(t){if(null!=t){var n=t.domainId,i=U.get(e);return!(null!=n&&null!=i&&n.high==i.high&&n.low==i.low)}return!1})},removeConferencesOnLeaveDomain:function(e){for(var t=this.conferencesMap,n=new Nr(t,t.arrayKeys());n.hasNext();){var i=n.next(),r=i.domainId;null!=r&&null!=e&&r.high==e.high&&r.low==e.low&&(this.removeConference(i),this.sendNotification("notify_close_conference",i))}},removeConferencesOnLeaveTalk:function(e){for(var t=this.conferencesMap,n=new Nr(t,t.arrayKeys());n.hasNext();){var i=n.next(),r=i.talkId;null!=r&&null!=e&&r.high==e.high&&r.low==e.low&&(this.removeConference(i),this.sendNotification("notify_close_conference",i))}},__class__:Ni});var ki=function(){var e=new Cn(-1,-1);this.dummyFileId=e;var t=new Cn(-1,-1);this.dummyMsgId=t,vi.call(this,"dataFactory")};a["albero.proxy.DataFactoryProxy"]=ki,ki.__name__=["albero","proxy","DataFactoryProxy"],ki.__super__=vi,ki.prototype=n(vi.prototype,{onRegister:function(){},newAcquaintance:function(e){return this.dataStore.addAcquaintance(this.newDomainUser(e))},newFriend:function(e){return this.dataStore.addFriend(this.newDomainUser(e))},newDomainUser:function(e){return new ct(e)},newDomain:function(e){return this.dataStore.setDomainIfLatest(new et(e))},newDomainInvite:function(e){return this.dataStore.setDomainInvite(new lt(e))},newTalk:function(e){return this.dataStore.setTalk(new _n(e))},newTalkStatus:function(e){return this.dataStore.setTalkStatus(new Tn(e))},newMessage:function(e){var t=new At(e);switch(t.type[1]){case 4:this.fileInfoStore.setMessageFileInfos(t.id,[pt.fromMessageAndFile(t,t.content)]);break;case 5:var n=t,i=function(e){return pt.fromMessageAndFile(n,e)};this.fileInfoStore.setMessageFileInfos(t.id,F.asArray(t.content.files).map(i))}return this.messageStore.setMessage(t),t},newDummyMessage:function(e,t,n){var i=this,r=new At;r.id=this.dummyMsgId,r.userId=this.dataStore.me.id,r.talkId=e,r.type=t,r.content=n;var a,o=this.dummyMsgId;if(null==o)a=null;else{var s=new Cn(0,1),l=s,u=o.high-l.high|0,c=o.low-l.low|0;if(mr.ucompare(o.low,l.low)<0){u--;u|=0}a=new Cn(u,c)}switch(this.dummyMsgId=a,r.type[1]){case 4:var _=[this.createDummyFileInfo(r,r.content)];this.fileInfoStore.setMessageFileInfos(r.id,_);break;case 5:var h=jr.__cast(r.content.files,Array).map(function(e){return i.createDummyFileInfo(r,e)});this.fileInfoStore.setMessageFileInfos(r.id,h)}return this.messageStore.setMessage(r),r},newDummyFileMessage:function(e,t){var n=this.createFileInfoDynamic(t);return this.newDummyMessage(e,Nt.file,n)},newDummyMultipleFileMessage:function(e,t,n){var i=h.array(n.filter(function(e){return null!=e}).map(r(this,this.createFileInfoDynamic)));return this.newDummyMessage(e,Nt.textMultipleFile,{text:t,files:i})},createFileInfoDynamic:function(e){return{content_type:e.type,content_size:e.size,name:hi.normalize(e.name),file:e}},createDummyFileInfo:function(e,t){var n,i=pt.fromMessageAndFileWithFileId(e,t,this.dummyFileId),r=this.dummyFileId;if(null==r)n=null;else{var a=new Cn(0,1),o=a,s=r.high-o.high|0,l=r.low-o.low|0;if(mr.ucompare(r.low,o.low)<0){s--;s|=0}n=new Cn(s,l)}return this.dummyFileId=n,i},newQuestion:function(e){return this.dataStore.setQuestion(new Kt(e))},newFileInfo:function(e){var t=new pt(e);return this.fileInfoStore.setTalkFileInfo(t,!0),t},newAnnouncement:function(e){return new Le(e)},newAnnouncementStatus:function(e){return this.dataStore.setAnnouncementStatus(new Be(e))},newAnnouncementStatusForDomain:function(e){var t=new Be;return t.domainId=e,t.unreadCount=0,this.dataStore.setAnnouncementStatus(t)},newAccountControlRequest:function(e){return this.dataStore.setAccountControlRequest(new Fe(e))},newAccountControlGroup:function(e){return this.dataStore.setAccountControlGroup(new Oe(e))},newSolution:function(e){var t=new on(e);return this.solutionsStore.setSolution(t),t},newUserPresence:function(e,t){var n=new On(e,t);return this.dataStore.setUserPresence(n),n},newConference:function(e){var t=new We(e);return this.conferenceStore.addConference(t),t},__class__:ki});var Di=function(){vi.call(this,"dataStore")};a["albero.proxy.DataStoreProxy"]=Di,Di.__name__=["albero","proxy","DataStoreProxy"],Di.__super__=vi,Di.prototype=n(vi.prototype,{onRegister:function(){this.init()},setMe:function(e){this.me=e;for(var t=0,n=this.getDomains();t<n.length;){var i=n[t];++t,this.sendNotification("notify_update_user",this.me.toDomainUser(i.id))}this.sendNotification("current_user_changed",e),this.storage.setDirtyFlag()},getMe:function(){return this.me},isMe:function(e){if(null!=this.me){var t=this.me.id;return null!=t&&null!=e&&t.high==e.high&&t.low==e.low}return!1},getFriendsOrAcquaintances:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=ma[t]?n.getReserved(t):n.h[t],r=[];if(null!=i)for(var a=new Nr(i,i.arrayKeys());a.hasNext();){var o=a.next();0!=o.type&&1!=o.type||r.push(o.user)}return r},getFriends:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=ma[t]?n.getReserved(t):n.h[t],r=[];if(null!=i)for(var a=new Nr(i,i.arrayKeys());a.hasNext();){var o=a.next();0==o.type&&r.push(o.user)}return r},getAcquaintances:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=ma[t]?n.getReserved(t):n.h[t],r=[];if(null!=i)for(var a=new Nr(i,i.arrayKeys());a.hasNext();){var o=a.next();1==o.type&&r.push(o.user)}return r},isFriend:function(e,t){var n="_"+e.high+"_"+e.low,i=this.users,r=null!=ma[n]?i.getReserved(n):i.h[n];if(null!=r){var a="_"+t.high+"_"+t.low,o=null!=ma[a]?r.getReserved(a):r.h[a];return null!=o&&0==o.type}return!1},addFriend:function(e){var t=this.ensureDomainUserMap(e.domainId),n=e.id,i="_"+n.high+"_"+n.low,r={type:0,user:e};return null!=ma[i]?t.setReserved(i,r):t.h[i]=r,this.storage.setDirtyFlag(),e},addAcquaintance:function(e){var t=this.ensureDomainUserMap(e.domainId),n=e.id,i="_"+n.high+"_"+n.low,r={type:1,user:e};return null!=ma[i]?t.setReserved(i,r):t.h[i]=r,this.storage.setDirtyFlag(),e},ensureDomainUserMap:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=ma[t]?n.getReserved(t):n.h[t];if(null==i){i=new kr;var r=this.users;null!=ma[t]?r.setReserved(t,i):r.h[t]=i}return i},setUserIfLatest:function(e,t){null==e&&(e=this.ensureDomainUserMap(t.domainId));var n=t.id,i="_"+n.high+"_"+n.low,r=null!=ma[i]?e.getReserved(i):e.h[i];if(null!=r){var a=t.updatedAt,o=r.user.updatedAt,s=a.high-o.high|0;s=0!=s?s:mr.ucompare(a.low,o.low);var l=a.high<0?o.high<0?s:-1:o.high>=0?s:1;(l>1||2==r.type&&0!=l)&&(r.user=t,this.sendNotification("notify_update_user",t))}else{var u={type:2,user:t};null!=ma[i]?e.setReserved(i,u):e.h[i]=u}this.storage.setDirtyFlag()},setUserPresence:function(e){null==this.userPresences&&(this.userPresences=new kr);var t=e.userId,n="_"+t.high+"_"+t.low,i=this.userPresences;null!=ma[n]?i.setReserved(n,e):i.h[n]=e,this.storage.setDirtyFlag()},getUserPresence:function(e){if(null==this.userPresences)return null;var t="_"+e.high+"_"+e.low,n=this.userPresences;return null!=ma[t]?n.getReserved(t):n.h[t]},isDepartmentsChanged:function(e,t){return!M.eqArray(e.departments,t.departments)},setUsersIfLatest:function(e,t){var n=this.ensureDomainUserMap(e),i=r(this,this.setUserIfLatest),a=n;h.iter(t,function(e){i(a,e)})},clearUsersDepartments:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=ma[t]?n.getReserved(t):n.h[t];if(null!=i)for(var r=new Nr(i,i.arrayKeys());r.hasNext();){var a=r.next();a.user.departments=null,this.sendNotification("notify_update_user",a.user)}this.storage.setDirtyFlag()},removeFriend:function(e,t){var n="_"+e.high+"_"+e.low,i=this.users,r=null!=ma[n]?i.getReserved(n):i.h[n];if(null!=r){var a="_"+t.high+"_"+t.low,o=null!=ma[a]?r.getReserved(a):r.h[a];null!=o&&(o.type=2)}this.storage.setDirtyFlag()},removeAcquaintance:function(e,t){this.removeFriend(e,t)},getUser:function(e,t){if(null==t)return null;var n=new Cn(0,0),i=n;if(t.high==i.high&&t.low==i.low)return null;var r;if(null!=this.me){var a=this.me.id;r=null!=a&&null!=t&&a.high==t.high&&a.low==t.low}else r=!1;if(r)return this.me.toDomainUser(e);var o="_"+e.high+"_"+e.low,s=this.users,l=null!=ma[o]?s.getReserved(o):s.h[o];if(null!=l){var u="_"+t.high+"_"+t.low,c=null!=ma[u]?l.getReserved(u):l.h[u];if(null!=c)return c.user}return null},getUsers:function(e,t){var n=this,i=function(e,t){var i="_"+e.high+"_"+e.low,r=n.users,a=null!=ma[i]?r.getReserved(i):r.h[i];if(null!=a){if(null!=t)return t.map(function(t){var i=new Cn(0,0),r=i;if(t.high==r.high&&t.low==r.low)return null;var o=n.me.id;if(null!=o&&null!=t&&o.high==t.high&&o.low==t.low)return n.me.toDomainUser(e);var s="_"+t.high+"_"+t.low,l=null!=ma[s]?a.getReserved(s):a.h[s];return null!=l?l.user:null});for(var o=[],s=a.arrayKeys(),l=new Nr(a,s);l.hasNext();)o.push(l.next().user);return o}return[]};if(null!=e)return i(e,t);for(var r=this.domains,a=new Nr(r,r.arrayKeys()),o=null;a.hasNext();)o=null==o?i(a.next().id,t):o.concat(i(a.next().id,t));return null==o?[]:o},getTalk:function(e){var t="_"+e.high+"_"+e.low,n=this.talks;return null!=ma[t]?n.getReserved(t):n.h[t]},getValidPairTalk:function(e,t){var n=this;return null==this.me?null:h.find(this.getTalks(),function(i){if(!I.enumEq(i.type,dn.PairTalk))return!1;var r=i.domainId;return null!=r&&null!=t&&r.high==t.high&&r.low==t.low&&(!!h.exists(i.userIds,function(t){return null!=t&&null!=e&&t.high==e.high&&t.low==e.low})&&!!h.exists(i.userIds,function(e){var t=n.me.id;return null!=e&&null!=t&&e.high==t.high&&e.low==t.low}))})},setTalk:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.talks;if(null!=ma[n]?i.setReserved(n,e):i.h[n]=e,null!=e.leftUsers)for(var r=this.ensureDomainUserMap(e.domainId),a=0,o=e.leftUsers;a<o.length;){var s=o[a];++a;var l=s.id,u="_"+l.high+"_"+l.low,c=null!=ma[u]?r.getReserved(u):r.h[u];if(null!=c){var _;if(2==c.type){var h=s.updatedAt,d=c.user.updatedAt,f=h.high-d.high|0;f=0!=f?f:mr.ucompare(h.low,d.low),_=(h.high<0?d.high<0?f:-1:d.high>=0?f:1)>0}else _=!1;_&&(c.user=s,this.sendNotification("notify_update_user",s))}else{var m={type:2,user:s};null!=ma[u]?r.setReserved(u,m):r.h[u]=m,this.sendNotification("notify_update_user",s)}}return this.storage.setDirtyFlag(),e},getTalks:function(){for(var e=[],t=this.talks.keys();t.hasNext();){var n=t.next(),i=this.talks;e.push(null!=ma[n]?i.getReserved(n):i.h[n])}return e},setTalks:function(e){h.iter(e,r(this,this.setTalk))},removeTalk:function(e){if(null!=this.domainUnreadCounts){var t="_"+e.high+"_"+e.low,n=this.talks,i=null!=ma[t]?n.getReserved(t):n.h[t];if(null!=i){var r=i.domainId;this.domainUnreadCounts.remove("_"+r.high+"_"+r.low)}}if(null!=this.questions)for(var a=this.getQuestions(e),o=0;o<a.length;){var s=a[o];++o;var l=s.id;this.questions.remove("_"+l.high+"_"+l.low)}this.talks.remove("_"+e.high+"_"+e.low),this.storage.setDirtyFlag()},getTalkStatuses:function(){for(var e=[],t=this.talkStatuses.keys();t.hasNext();){var n=t.next(),i=this.talks;if(null!=ma[n]?i.existsReserved(n):i.h.hasOwnProperty(n)){var r=this.talkStatuses;e.push(null!=ma[n]?r.getReserved(n):r.h[n])}}return e},getTalkStatus:function(e){var t="_"+e.high+"_"+e.low,n=this.talkStatuses;return null!=ma[t]?n.getReserved(t):n.h[t]},setTalkStatus:function(e){var t=e.id,n="_"+t.high+"_"+t.low;if(null!=this.domainUnreadCounts){var i=this.talks,r=null!=ma[n]?i.getReserved(n):i.h[n];if(null!=r){var a=r.domainId;this.domainUnreadCounts.remove("_"+a.high+"_"+a.low)}}var o=this.talkStatuses;return null!=ma[n]?o.setReserved(n,e):o.h[n]=e,this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),e},removeTalkStatus:function(e){var t="_"+e.high+"_"+e.low;if(null!=this.domainUnreadCounts){var n=this.talks,i=null!=ma[t]?n.getReserved(t):n.h[t];if(null!=i){var r=i.domainId;this.domainUnreadCounts.remove("_"+r.high+"_"+r.low)}}this.talkStatuses.remove(t),this.storage.setDirtyFlag()},getDomains:function(){for(var e=[],t=this.domains,n=new Nr(t,t.arrayKeys());n.hasNext();){var i=n.next();e.push(i)}return e},getDomain:function(e){var t="_"+e.high+"_"+e.low,n=this.domains;return null!=ma[t]?n.getReserved(t):n.h[t]},setDomainIfLatest:function(e){var t,n=e.id,i="_"+n.high+"_"+n.low,r=this.domains,a=null!=ma[i]?r.getReserved(i):r.h[i];if(null!=a){var o=e.updatedAt,s=a.updatedAt,l=o.high-s.high|0;l=0!=l?l:mr.ucompare(o.low,s.low),t=(o.high<0?s.high<0?l:-1:s.high>=0?l:1)>=0}else t=!0;if(t){var u=this.domains;return null!=ma[i]?u.setReserved(i,e):u.h[i]=e,this.storage.setDirtyFlag(),e}return a},removeDomain:function(e){this.domains.remove("_"+e.high+"_"+e.low),this.storage.setDirtyFlag();for(var t=this.getTalks().filter(function(t){var n=t.domainId;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low}),n=0;n<t.length;){var i=t[n];++n,this.removeTalk(i.id),this.removeTalkStatus(i.id)}},getUnreadCount:function(){for(var e=0,t=this.domains.keys();t.hasNext();){var n=t.next();e+=this._getDomainUnreadCount(n)}return e+=this.getDomainInvitesCount()},_getDomainUnreadCount:function(e){var t;if(null!=this.domainUnreadCounts){var n=this.domainUnreadCounts;t=null!=ma[e]?n.existsReserved(e):n.h.hasOwnProperty(e)}else t=!1;if(t){var i=this.domainUnreadCounts;return null!=ma[e]?i.getReserved(e):i.h[e]}null==this.domainUnreadCounts&&(this.domainUnreadCounts=new kr);for(var r=0,a=this.talkStatuses,o=new Nr(a,a.arrayKeys());o.hasNext();){var s=o.next();if(null!=s.unreadCount&&0!=s.unreadCount){var l,u=s.id,c="_"+u.high+"_"+u.low,_=this.talks,h=null!=ma[c]?_.getReserved(c):_.h[c];if(null!=h){var d=h.domainId;l="_"+d.high+"_"+d.low==e}else l=!1;l&&(r+=s.unreadCount)}}var f=this.announcementStatuses,m=null!=ma[e]?f.getReserved(e):f.h[e];if(null!=m&&null!=m.unreadCount){var p=this.domains,g=null!=ma[e]?p.getReserved(e):p.h[e];null!=g&&g.role.allowReadAnnouncements&&(r+=m.unreadCount)}var v=this.domainUnreadCounts;return null!=ma[e]?v.setReserved(e,r):v.h[e]=r,r},getDomainUnreadCount:function(e){return null==e?0:this._getDomainUnreadCount("_"+e.high+"_"+e.low)},getDomainInvites:function(){for(var e=[],t=this.domainInvites.keys();t.hasNext();){var n=t.next(),i=this.domainInvites;e.push(null!=ma[n]?i.getReserved(n):i.h[n])}return e},getDomainInvitesCount:function(){var e=0;if(null==this.accountControlGroup)for(var t=this.domainInvites,n=new Nr(t,t.arrayKeys());n.hasNext();){var i=n.next();null!=i.accountControlRequestId&&null!=this.getAccountControlRequest(i.accountControlRequestId)||++e}else for(var r=this.domainInvites,a=new Nr(r,r.arrayKeys());a.hasNext();){a.next();++e}return e},getDomainInvite:function(e){var t="_"+e.high+"_"+e.low,n=this.domainInvites;return null!=ma[t]?n.getReserved(t):n.h[t]},setDomainInvite:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.domainInvites;return null!=ma[n]?i.setReserved(n,e):i.h[n]=e,this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),e},removeDomainInvite:function(e){this.domainInvites.remove("_"+e.high+"_"+e.low),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag()},getQuestions:function(e,t){var n=[];if(null!=this.questions)for(var i=this.questions,r=new Nr(i,i.arrayKeys());r.hasNext();){var a=r.next(),o=a.talkId;if(null!=o&&null!=e&&o.high==e.high&&o.low==e.low){var s;if(null!=t){var l=a.userId;s=!(null!=t&&null!=l&&t.high==l.high&&t.low==l.low)}else s=!1;s||n.push(a)}}return n},getQuestion:function(e){var t="_"+e.high+"_"+e.low,n=this.questions;return null!=ma[t]?n.getReserved(t):n.h[t]},setQuestion:function(e){return e},getAnnouncementStatus:function(e){var t="_"+e.high+"_"+e.low,n=this.announcementStatuses;return null!=ma[t]?n.getReserved(t):n.h[t]},setAnnouncementStatus:function(e){var t=e.domainId,n="_"+t.high+"_"+t.low,i=this.announcementStatuses;return null!=ma[n]?i.setReserved(n,e):i.h[n]=e,null!=this.domainUnreadCounts&&this.domainUnreadCounts.remove(n),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),e},removeAnnouncementStatus:function(e){var t="_"+e.high+"_"+e.low;this.announcementStatuses.remove(t),null!=this.domainUnreadCounts&&this.domainUnreadCounts.remove(t),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag()},getAccountControlRequests:function(){for(var e=[],t=this.accountControlRequests,n=new Nr(t,t.arrayKeys());n.hasNext();){var i=n.next();e.push(i)}return e},getAccountControlRequest:function(e){var t="_"+e.high+"_"+e.low,n=this.accountControlRequests;return null!=ma[t]?n.getReserved(t):n.h[t]},setAccountControlRequest:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.accountControlRequests,r=null!=ma[n]?i.getReserved(n):i.h[n];if(null!=r&&r.version>e.version)return r;var a=this.accountControlRequests;return null!=ma[n]?a.setReserved(n,e):a.h[n]=e,this.storage.setDirtyFlag(),e},removeAccountControlRequest:function(e){var t="_"+e.high+"_"+e.low;this.accountControlRequests.remove(t),this.storage.setDirtyFlag()},removeAccountControlRequests:function(){this.accountControlRequests=new kr,this.storage.setDirtyFlag()},getAccountControlGroup:function(){return this.accountControlGroup},setAccountControlGroup:function(e){return this.accountControlGroup=e,this.storage.setDirtyFlag(),this.accountControlGroup},updateAccountControlGroup:function(e){if(null!=this.accountControlGroup){var t=this.accountControlGroup.id,n=e.id;if(null!=t&&null!=n&&t.high==n.high&&t.low==n.low){var i=e.group
;null!=i&&this.accountControlGroup.group.version<i.version&&(this.accountControlGroup.group=i,this.storage.setDirtyFlag());var r=e.profilePolicy;null!=r&&this.accountControlGroup.profilePolicy.version<r.version&&(this.accountControlGroup.profilePolicy=r,this.storage.setDirtyFlag())}}},removeAccountControlGroup:function(e){var t;if(null!=this.accountControlGroup){var n=this.accountControlGroup.id;t=null!=n&&null!=e&&n.high==e.high&&n.low==e.low}else t=!1;t&&(this.accountControlGroup=null,this.storage.setDirtyFlag())},addReactedConfereceId:function(e){var t="_"+e.high+"_"+e.low,n=this.reactedConferenceIds;null!=ma[t]?n.setReserved(t,!0):n.h[t]=!0,this.storage.setDirtyFlag()},removeReactedConfereceId:function(e){this.reactedConferenceIds.remove("_"+e.high+"_"+e.low),this.storage.setDirtyFlag()},isReactedConferenceId:function(e){var t="_"+e.high+"_"+e.low,n=this.reactedConferenceIds;return null!=ma[t]?n.existsReserved(t):n.h.hasOwnProperty(t)},filterReactedConferenceIds:function(e){var t=this,n=new kr;h.iter(e.map(function(e){return"_"+e.high+"_"+e.low}).filter(function(e){var n=t.reactedConferenceIds;return null!=ma[e]?n.existsReserved(e):n.h.hasOwnProperty(e)}),function(e){null!=ma[e]?n.setReserved(e,!0):n.h[e]=!0}),this.reactedConferenceIds=n},getNote:function(e){if(null==this.notes)return null;var t=this.notes,n=e.toString(),i=t;return null!=ma[n]?i.getReserved(n):i.h[n]},setNote:function(e,t){if(null==this.notes&&(this.notes=new kr),null==t)return this.notes.remove(e.toString()),t;var n=this.notes,i=e.toString(),r=n;return null!=ma[i]?r.setReserved(i,t):r.h[i]=t,t},clear:function(e){this.users=new kr,this.talks=new kr,this.talkStatuses=new kr,this.domains=new kr,this.domainInvites=new kr,this.questions=new kr,this.announcementStatuses=new kr,this.accountControlRequests=new kr,this.accountControlGroup=null,this.reactedConferenceIds=new kr,e&&(this.me=null),this.storage.setDirtyFlag()},init:function(){this.storage=new ai("dataStore");var e=this.storage.load();if(null!=e){if("1.105_1"==e.shift())return this.me=e.shift(),this.users=e.shift(),this.talks=e.shift(),this.talkStatuses=e.shift(),this.domains=e.shift(),this.domainInvites=e.shift(),this.questions=e.shift(),this.announcementStatuses=e.shift(),this.accountControlRequests=e.shift(),this.accountControlGroup=e.shift(),this.reactedConferenceIds=e.shift(),void si._d("["+_.dateStr(new Date)+"] ","dataStore is loaded.","","","","")}this.clear(!0),si._d("["+_.dateStr(new Date)+"] ","dataStore is initialized.","","","","")},saveIfNeeded:function(){this.storage.isDirty&&(this.storage.save(["1.105_1",this.me,this.users,this.talks,this.talkStatuses,this.domains,this.domainInvites,this.questions,this.announcementStatuses,this.accountControlRequests,this.accountControlGroup,this.reactedConferenceIds]),si._d("["+_.dateStr(new Date)+"] ","dataStore is saved.","","","",""))},__class__:Di});var Ci=function(){vi.call(this,"departmentStore"),this.departmentMap=new kr,this.rootDepartmentIdMap=new kr};a["albero.proxy.DepartmentStoreProxy"]=Ci,Ci.__name__=["albero","proxy","DepartmentStoreProxy"],Ci.__super__=vi,Ci.prototype=n(vi.prototype,{getDepartment:function(e){if(null==e)return null;var t="_"+e.high+"_"+e.low,n=this.departmentMap;return null!=ma[t]?n.getReserved(t):n.h[t]},setDepartment:function(e){if(null!=e.parentId){var t=this.getDepartment(e.parentId);null!=t&&(t.addChild(e.id),e.depth=t.depth+1)}var n=e.id,i="_"+n.high+"_"+n.low,r=this.departmentMap;null!=ma[i]?r.setReserved(i,e):r.h[i]=e},clearDomainDepartment:function(e){var t=this,n="_"+e.high+"_"+e.low,i=this.rootDepartmentIdMap,r=null!=ma[n]?i.getReserved(n):i.h[n];null!=r&&(h.iter(this.getDepartmentsDescendantOrSelf(r),function(e){var n=e.id;t.departmentMap.remove("_"+n.high+"_"+n.low)}),this.rootDepartmentIdMap.remove(n))},getRootDepartmentId:function(e){var t="_"+e.high+"_"+e.low,n=this.rootDepartmentIdMap;return null!=ma[t]?n.getReserved(t):n.h[t]},setRootDepartmentId:function(e,t){var n="_"+e.high+"_"+e.low,i=this.rootDepartmentIdMap;null!=ma[n]?i.setReserved(n,t):i.h[n]=t},setDepartmentUserCount:function(e){var t=this.getDepartment(e.departmentId);null!=t&&(t.userCount=e,t.userCountLoading=!1)},setUserCountLoading:function(e,t){var n=this.getDepartment(e);null!=n&&(n.userCountLoading=t)},needUserCountLoading:function(e){var t=this.getDepartment(e);return null==t||null==t.userCount&&!t.userCountLoading},clearDomainDepartmentUsers:function(e){var t=this.getRootDepartmentId(e);null!=t&&(h.iter(this.getDepartmentsDescendantOrSelf(t),function(e){e.userCount=null,e.userIds=null,e.userCountLoading=!1}),this.sendNotification("department_user_count_cleared",e))},setDepartmentUsers:function(e,t){var n=this.getDepartment(e);null!=n&&(n.userIds=t)},getDepartmentPath:function(e){return this.getDepartmentsAncestorOrSelf(e)},getDepartmentPathWithoutRoot:function(e){return this.getDepartmentPath(e).filter(function(e){return!e.isRoot()})},getDepartmentsAncestorOrSelf:function(e){var t=[];return this._getDepartmentsAncestorOrSelf(e,t),t},_getDepartmentsAncestorOrSelf:function(e,t){var n=this.getDepartment(e);null!=n&&(null!=n.parentId&&this._getDepartmentsAncestorOrSelf(n.parentId,t),t.push(n))},getDepartmentsDescendantOrSelf:function(e){var t=[];return this._getDepartmentsDescendantOrSelf(e,t),t},_getDepartmentsDescendantOrSelf:function(e,t){var n=this,i=this.getDepartment(e);null!=i&&(t.push(i),null!=i.childrenIds&&h.iter(i.childrenIds,function(e){n._getDepartmentsDescendantOrSelf(e,t)}))},__class__:Ci});var Oi=function(){vi.call(this,"features")};a["albero.proxy.FeaturesProxy"]=Oi,Oi.__name__=["albero","proxy","FeaturesProxy"],Oi.__super__=vi,Oi.prototype=n(vi.prototype,{canSendMessageOnMultiView:function(e){return!!this.settings.isOnPremises()||this.selectedDomainHasSolution(e,un.MultiView)},canDetectKeyword:function(e){return!!this.settings.isOnPremises()||this.selectedDomainHasSolution(e,un.KeywordWatching)},selectedDomainHasSolution:function(e,t){if(null==e)return!1;var n=this.dataStore.getDomain(e);return null!=n&&null!=n.contract&&null!=n.contract.solutionIds&&h.exists(n.contract.solutionIds,function(e){return on.getSolutionType(e)==t})},canConference:function(e){if(null==e)return!1;var t=this.dataStore.getDomain(e);return null!=t&&null!=t.contract&&t.contract.isConferenceEnalbed()},__class__:Oi});var Ri=function(){vi.call(this,"fileInfoStore"),this.fileInfoMap=new kr,this.fileIdStrsMap=new kr,this.messageFileIdStrsMap=new kr,this.stagedFileInfosMaxId=0};a["albero.proxy.FileInfoStoreProxy"]=Ri,Ri.__name__=["albero","proxy","FileInfoStoreProxy"],Ri.__super__=vi,Ri.prototype=n(vi.prototype,{getStagedFileIdsKey:function(e,t){return"staged__"+e.high+"_"+e.low+Ut.toPanePrefix(t)},ensureStagedFileInfos:function(e,t){return this.ensureStagedFileIdStrs(e,t).map(M.makeFromIdStr).filter(function(e){return null!=e}).map(r(this,this.getFileInfo))},moveStagedFile:function(e,t,n,i){var r=this.ensureStagedFileIdStrs(e,t);if(null!=r){var a=r[n];_.remove(r,a),r.splice(i,0,a)}},ensureStagedFileIdStrs:function(e,t){var n=this.getStagedFileIdsKey(e,t),i=this.fileIdStrsMap,r=null!=ma[n]?i.getReserved(n):i.h[n];if(null==r){r=[];var a=this.fileIdStrsMap;null!=ma[n]?a.setReserved(n,r):a.h[n]=r}return r},addStagedFileInfo:function(e,t,n,i){var r=new pt,a=new Cn(0,--this.stagedFileInfosMaxId);r.id=a,r.talkId=e,null!=n&&(r.contentType=n.type,r.contentSize=n.size,r.url=URL.createObjectURL(Mi.getBlobFromUpdatableFile(n)),r.file=n,r.name=n.name),null!=i&&(r.thumbUrl=URL.createObjectURL(i.blob));var o=r.id,s="_"+o.high+"_"+o.low,l=this.fileInfoMap;null!=ma[s]?l.setReserved(s,r):l.h[s]=r;var u=r.id,c="_"+u.high+"_"+u.low;return this.ensureStagedFileIdStrs(e,t).push(c),r},removeStagedFileInfo:function(e,t,n){var i="_"+n.high+"_"+n.low;_.remove(this.ensureStagedFileIdStrs(e,t),i),this.fileInfoMap.remove(i)},removeStagedFileInfos:function(e,t){for(var n=0,i=this.ensureStagedFileIdStrs(e,t);n<i.length;){var r=i[n];++n,this.fileInfoMap.remove(r)}this.fileIdStrsMap.remove(this.getStagedFileIdsKey(e,t))},ensureTalkFileInfos:function(e){return this.ensureTalkFileIds(e).map(r(this,this.fileInfoGetter))},ensureTalkFileIds:function(e){var t="_"+e.high+"_"+e.low,n=this.fileIdStrsMap,i=null!=ma[t]?n.getReserved(t):n.h[t];if(null==i){i=[];var r=this.fileIdStrsMap;null!=ma[t]?r.setReserved(t,i):r.h[t]=i}return i},getTalkFileInfo:function(e,t,n){return this.getFileInfo(n)},setTalkFileInfo:function(e,t){var n=e.id,i="_"+n.high+"_"+n.low,r=this.fileInfoMap;null!=ma[i]?r.setReserved(i,e):r.h[i]=e;var a=this.ensureTalkFileIds(e.talkId);-1==a.indexOf(i)&&a.push(i)},onFileDeleted:function(e){var t=this.getTalkFileInfo(e.talkId,e.messageId,e.fileId);null!=t&&(t.deleted=!0)},getFileInfo:function(e){var t="_"+e.high+"_"+e.low,n=this.fileInfoMap;return null!=ma[t]?n.getReserved(t):n.h[t]},getMessageFileInfos:function(e){var t=this,n="_"+e.high+"_"+e.low,i=this.messageFileIdStrsMap;return U.map(U.option(null!=ma[n]?i.getReserved(n):i.h[n]),function(e){return e.map(r(t,t.fileInfoGetter))})},setMessageFileInfos:function(e,t){for(var n=0;n<t.length;){var i=t[n];++n;var a=i.id,o="_"+a.high+"_"+a.low,s=this.fileInfoMap;null!=ma[o]?s.setReserved(o,i):s.h[o]=i}var l=this.messageFileIdStrsMap,u="_"+e.high+"_"+e.low,c=t.map(r(this,this.fileIdStrGetter)),_=l;null!=ma[u]?_.setReserved(u,c):_.h[u]=c},removeMessageFileInfos:function(e){this.messageFileIdStrsMap.remove("_"+e.high+"_"+e.low)},isAllFileDeletedOnMessage:function(e){var t,n=this.getMessageFileInfos(e);switch(n[1]){case 0:t=n[2];break;case 1:t=[]}return!h.exists(t,function(e){return!e.deleted})},fileIdStrGetter:function(e){var t=e.id;return"_"+t.high+"_"+t.low},fileInfoGetter:function(e){var t=this.fileInfoMap;return null!=ma[e]?t.getReserved(e):t.h[e]},__class__:Ri});var Mi=function(){vi.call(this,"fileService"),this.validHost=this.getValidHost()};a["albero.proxy.FileServiceProxy"]=Mi,Mi.__name__=["albero","proxy","FileServiceProxy"],Mi.createByteSizeStringWithUnit=function(e){return O.createByteSizeStringWithUnit(e)},Mi.convertUploadableFile=function(e){if(null==e)return e;var t=!1,n=e.name;L.isEmpty(n)&&(n="clipboard_"+D.getDateStringForFile()+".png",t=!0);var i=Mi.getContentTypeByFileName(n,e.type);return i!=e.type&&(t=!0),t?{name:n,type:i,file:n,blob:e,size:e.size}:e},Mi.getBlobFromUpdatableFile=function(e){return null==e.blob?e:e.blob},Mi.getContentTypeByFileName=function(e,t){if(L.isNotEmpty(t))return"csv"==Mi.getExtension(e)?"text/csv":t;switch(Mi.getExtension(e)){case"csv":return"text/csv";case"doc":return"application/msword";case"docm":return"application/vnd.ms-word.document.macroenabled.12";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case"gif":return"image/gif";case"htm":case"html":return"text/html";case"jpeg":case"jpg":return"image/jpeg";case"md":return"text/markdown";case"pdf":return"application/pdf";case"png":return"image/png";case"ppt":return"application/vnd.ms-powerpoint";case"pptm":return"application/vnd.ms-powerpoint.presentation.macroenabled.12";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation";case"txt":return"text/plain";case"xls":return"application/vnd.ms-excel";case"xlsb":return"application/vnd.ms-excel.sheet.binary.macroenabled.12";case"xlsm":return"application/vnd.ms-excel.sheet.macroenabled.12";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"xml":return"text/xml";default:return"application/octet-stream"}},Mi.getExtension=function(e){if(null==e)return"";var t=e.split("."),n=t.length;return 0==n?"":t[n-1]},Mi.__super__=vi,Mi.prototype=n(vi.prototype,{getValidHost:function(){return"https://"+la.host},downloadUrl:function(e,t){if(null==t&&(t=!1),null==e||0==e.length)return"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(S.startsWith(e,this.validHost)){var n=this.settings.getAccessToken(),i=e;return-1!=e.indexOf("?")?i+="&":i+="?",i+="Authorization=ALB%20"+n,t&&(i+="&download=true"),i}return e},download:function(e,t,n){var i=this;if(e=this.downloadUrl(e),S.startsWith(e,"data:"))return void n(null);var r=Kr.parse(e);null!=la.proxyURL&&(r.agent=_i.createAgent(la.proxyURL));var a=zr.request(r,function(e){var r=e.headers.location;if(null!=r)return void i.download(r,t,n);if(2!=Math.floor(e.statusCode/100))return void n(null);var a=Hr.createWriteStream(t);e.on("data",function(e){a.write(e)}),e.on("end",function(){a.end(),a.on("finish",function(){n(t)})}),e.on("error",function(e){n(null)}),a.on("error",function(e){n(null)})});a.on("error",function(e){n(null)}),a.end()},upload:function(e,t,n,i,r){var a=this;this.uploadForNodeJS(e,t,n).then(function(e){i()},function(e){var t=oi.localize("FileServiceProxy.failed_send_file");a.sendNotification("error_occurred",{message:t}),r(null)})},uploadForNodeJS:function(e,t,n){var i=Kr.parse(e.put_url);i.method="PUT";var r={};i.headers=r,i.headers["Content-Length"]=""+n.size;var a=e.post_form;return i.headers["Content-Type"]=a["Content-Type"],i.headers["Content-Disposition"]=a["Content-Disposition"],null!=la.proxyURL&&(i.agent=_i.createAgent(la.proxyURL)),new Promise(function(e,t){var r=zr.request(i,function(n){if(2!=Math.floor(n.statusCode/100)){var i="";return n.on("data",function(e){i+=e}),void n.on("end",function(){t(n.statusCode+": "+i)})}ci.resolveVoid(e)});r.on("error",function(e){t(e.message)});var a=Hr.createReadStream(n.path);a.on("data",function(e){r.write(e)}),a.on("end",function(){r.end()}),a.on("error",function(){r.end()})})},createDummyFile:function(e,t,n){var i=S.replace(e,"/","\\").split("\\");if(0==i.length)return null;var r=i[i.length-1];if(null!=t&&(r=t),0==r.length)return null;var a=Mi.getContentTypeByFileName(r,n),o=1;return o=Hr.statSync(e).size,{name:r,size:o,type:a,path:e}},asyncCreateThumbnail:function(e){return Promise.reject(null)},asyncCaptureVideo:function(e,t){var n=e.width,i=e.height,r=t.videoWidth,a=t.videoHeight;return a<r?n<r&&(a*=n/r,r=n):i<a&&(r*=i/a,a=i),a<1&&(a=1),r<1&&(r=1),e.height=0|a,e.width=0|r,e.getContext("2d").drawImage(t,0,0,r,a),this.asyncCreateThumbFromCanvas(e)},asyncNormalizeImage:function(e,t){var n=e.width,i=e.height,r=t.width,a=t.height;return a<r?n<r&&(a*=n/r,r=n):i<a&&(r*=i/a,a=i),a<1&&(a=1),r<1&&(r=1),e.height=0|a,e.width=0|r,this.drawImageWithAntialias(e,t),this.asyncCreateThumbFromCanvas(e)},asyncCreateThumbFromCanvas:function(e){return new Promise(function(t,n){try{e.toBlob(function(n){var i={name:"thumb.jpeg",type:"image/jpeg",file:"thumb.jpeg",blob:n,size:n.size};t(new bn(i,e.width,e.height))},"image/jpeg",.6)}catch(e){e instanceof Br&&(e=e.val),si._e("["+_.dateStr(new Date)+"] ","failed to create thumbnail. error:",e,"","",""),n(e)}})},drawImageWithAntialias:function(e,t){var n=e.width,i=e.height,r=0|t.width,a=0|t.height;r<1&&(r=1),a<1&&(a=1),si._d("["+_.dateStr(new Date)+"] ","drawImageWithAntialias",r,n,a,i);var o=window.document.createElement("canvas"),s=o.getContext("2d");o.width=r,o.height=a,s.drawImage(t,0,0);var l=window.document.createElement("canvas"),u=l.getContext("2d");l.width=r,l.height=a;for(var c=this.getOptSize(r,n),h=this.getOptSize(a,i);c>n||h>i;)si._d("["+_.dateStr(new Date)+"] ","downsize",r,c,a,h),u.clearRect(0,0,r,a),u.drawImage(o,0,0,r,a,0,0,c,h),s.clearRect(0,0,r,a),s.drawImage(l,0,0,c,h,0,0,c,h),r=c,c=this.getOptSize(r,n),a=h,h=this.getOptSize(a,i);var d=e.getContext("2d");d.fillStyle="rgb(255, 255, 255)",d.fillRect(0,0,n,i),d.drawImage(o,0,0,r,a,0,0,n,i)},getOptSize:function(e,t){return t*Math.ceil(Math.log(e/t)/Math.log(2))},__class__:Mi});var xi=function(){vi.call(this,"keywordWatcher")};a["albero.proxy.KeywordWatcherProxy"]=xi,xi.__name__=["albero","proxy","KeywordWatcherProxy"],xi.__super__=vi,xi.prototype=n(vi.prototype,{onMessageCreated:function(e){if(null!=e){var t,n=U.map(U.option(this.dataStore.getTalk(e.talkId)),function(e){return e.domainId});switch(n[1]){case 0:t=n[2];break;case 1:t=this.settings.getSelectedDomainId()}if(this.features.canDetectKeyword(t)){var i;if(this.settings.getBrowserSettings().keywordWatchingSelfMessage)i=!1;else{var r=this.dataStore,a=e.userId;if(null!=r.me){var o=r.me.id;i=null!=o&&null!=a&&o.high==a.high&&o.low==a.low}else i=!1}if(!i){var s=e.messageStringForKeywordDetection(this.settings.getBrowserSettings().keywordWatchingActionReply);this.detectKeyword(s,e.type,e.id,t,e.talkId)}}}},onAnnouncementCreated:function(e){if(null!=e&&this.features.canDetectKeyword(e.domainId)){var t=At.getDisplayTextWithoutEscape(e.type,e.content);this.detectKeyword(t,e.type,e.id,e.domainId,null)}},detectKeyword:function(e,t,n,i,r){var a=this;this.reserveOnNormalizedKeywordPrepared(function(o){for(var s=o.keys();s.hasNext();){var l=s.next(),u=o.get(l);if(null!=u&&0!=u.length&&Li.match(t,l))for(var c=0;c<u.length;){var _=u[c];if(++c,0!=_.search(e).length)return void a.addkeywordDetection(i,r,n)}}})},reserveOnNormalizedKeywordPrepared:function(e){var t=this.settings.getBrowserSettings().keywordWatchingText;if(this.cachedKeyword!=t){this.cachedKeyword=t,this.cachedNormalizedKeywordsMap=new Ir;for(var n=0,i=Pi.__empty_constructs__;n<i.length;){var r=i[n];++n,this.cachedNormalizedKeywordsMap.set(r,[])}for(var a=0,o=Fi.parse(t);a<o.length;){var s=o[a];++a,this.cachedNormalizedKeywordsMap.get(s.type).push(new li(s.word,!0,hi.normalize))}}e(this.cachedNormalizedKeywordsMap)},addkeywordDetection:function(e,t,n){null==this.detectedDomainTalkIdStrings&&(this.detectedDomainTalkIdStrings=new kr);var i=this.getKey(e,t);if(null!=i)if(this.hasKeywordDetection(e,t)){var r=this.detectedDomainTalkIdStrings;null!=ma[i]?r.setReserved(i,n):r.h[i]=n}else{var a=this.detectedDomainTalkIdStrings;null!=ma[i]?a.setReserved(i,n):a.h[i]=n;var o=this.settings.getBrowserSettings().keywordWatchingEmphasis;this.sendNotification("keyword_detaction_updated",{domainId:e,talkId:t,detected:!0,emphasis:o})}},readKeywordDetection:function(e,t,n){if(!this.settings.getBrowserSettings().keywordWatchingEmphasis){var i=this.getDetectId(e,t);si._d("["+_.dateStr(new Date)+"] ","readKeywordDetection",i,n,"","");var r;if(null!=i){var a=n.high-i.high|0;a=0!=a?a:mr.ucompare(n.low,i.low),r=(n.high<0?i.high<0?a:-1:i.high>=0?a:1)>=0}else r=!1;r&&this.removeKeywordDetection(e,t)}},removeKeywordDetection:function(e,t){if(null!=this.detectedDomainTalkIdStrings){var n=this.getKey(e,t);if(null!=n){this.detectedDomainTalkIdStrings.remove(n);var i=this.settings.getBrowserSettings().keywordWatchingEmphasis;this.sendNotification("keyword_detaction_updated",{domainId:e,talkId:t,detected:!1,emphasis:i})}}},removeKeywordDetectionAll:function(){if(null!=this.detectedDomainTalkIdStrings)for(var e=this.settings.getBrowserSettings().keywordWatchingEmphasis,t=this.detectedDomainTalkIdStrings.keys();t.hasNext();){var n=t.next();if(S.startsWith(n,"talk_")){var i=n.substring("talk_".length),r=M.makeFromIdStr(i);this.sendNotification("keyword_detaction_updated",{domainId:null,talkId:r,detected:!1,emphasis:e})}else if(S.startsWith(n,"announcement_")){var a=n.substring("announcement_".length),o=M.makeFromIdStr(a);this.sendNotification("keyword_detaction_updated",{domainId:o,talkId:null,detected:!1,emphasis:e})}this.detectedDomainTalkIdStrings.remove(n)}},getDetectId:function(e,t){if(null==this.detectedDomainTalkIdStrings)return null;var n=this.getKey(e,t);if(null==n)return null;var i=this.detectedDomainTalkIdStrings;return null!=ma[n]?i.getReserved(n):i.h[n]},hasKeywordDetection:function(e,t){return null!=this.getDetectId(e,t)},getKey:function(e,t){return null==e&&null==t?null:null!=t?"talk__"+t.high+"_"+t.low:"announcement__"+e.high+"_"+e.low},__class__:xi});var Fi=function(){};a["albero.proxy.KeywordParser"]=Fi,Fi.__name__=["albero","proxy","KeywordParser"],Fi.parse=function(e){var t=S.htmlEscape(e,!0),n=new l("&quot;(.*?)&quot;","g").map(t,function(e){return Fi.encodeSpace(e.matched(1))});return new l("[ ]","g").split(n).filter(L.isNotEmpty).map(Fi.decodeSpace).map(Fi.createParsedKeyword)},Fi.encodeSpace=function(e){return S.replace(S.replace(e," ","&SPACE"),"","&FULL_PITCH_SPACE")},Fi.decodeSpace=function(e){return S.replace(S.replace(e,"&SPACE"," "),"&FULL_PITCH_SPACE","")},Fi.createParsedKeyword=function(e){var t=new l("\\[type:([A-Za-z]+)\\](.*)","g");if(t.match(e)){var n=t.matched(1),i=t.matched(2),r=Li.getKeywordTypeByMessageTypeString(n);if(r!=Pi.normal)return new Ui(r,i)}return new Ui(Pi.normal,e)};var Ui=function(e,t){this.type=e,this.word=t};a["albero.proxy.ParsedKeyword"]=Ui,Ui.__name__=["albero","proxy","ParsedKeyword"],Ui.prototype={__class__:Ui};var Pi=a["albero.proxy.KeywordType"]={__ename__:["albero","proxy","KeywordType"],__constructs__:["normal","selectOneReplyOnly","yesOrNoReplyOnly","todoDoneOnly"]};Pi.normal=["normal",0],Pi.normal.toString=o,Pi.normal.__enum__=Pi,Pi.selectOneReplyOnly=["selectOneReplyOnly",1],Pi.selectOneReplyOnly.toString=o,Pi.selectOneReplyOnly.__enum__=Pi,Pi.yesOrNoReplyOnly=["yesOrNoReplyOnly",2],Pi.yesOrNoReplyOnly.toString=o,Pi.yesOrNoReplyOnly.__enum__=Pi,Pi.todoDoneOnly=["todoDoneOnly",3],Pi.todoDoneOnly.toString=o,Pi.todoDoneOnly.__enum__=Pi,Pi.__empty_constructs__=[Pi.normal,Pi.selectOneReplyOnly,Pi.yesOrNoReplyOnly,Pi.todoDoneOnly];var Li=function(){};a["albero.proxy.KeywordTypeHelper"]=Li,Li.__name__=["albero","proxy","KeywordTypeHelper"],Li.getKeywordType=function(e){return null!=e?Li.getKeywordTypeByMessageTypeString(At.typeString(e)):Pi.normal},Li.getKeywordTypeByMessageTypeString=function(e){if(null!=e)switch(e){case"selectOneReply":return Pi.selectOneReplyOnly;case"todoDone":return Pi.todoDoneOnly;case"yesOrNoReply":return Pi.yesOrNoReplyOnly}return Pi.normal},Li.match=function(e,t){switch(t[1]){case 0:return!0;case 1:return e==Nt.selectOneReply;case 2:return e==Nt.yesOrNoReply;case 3:return e==Nt.todoDone}},Li.createFilterClassStringFromMessageType=function(e){return Li.createFilterClassString(Li.getKeywordType(e))},Li.createFilterClassString=function(e){return"keyword_type_"+v.string(e)};var Bi=function(){vi.call(this,"limitations")};a["albero.proxy.LimitationsProxy"]=Bi,Bi.__name__=["albero","proxy","LimitationsProxy"],Bi.__super__=vi,Bi.prototype=n(vi.prototype,{getMaxTalkers:function(){var e=this,t=U.flatMap(U.flatMap(U.option(this.settings.getSelectedDomainId()),function(t){return U.option(e.dataStore.getDomain(t))}),function(e){return e.getMaxTalkers()});switch(t[1]){case 0:return t[2];case 1:return this.settings.getConfiguration().maxTalkers}},__class__:Bi});var ji=function(){vi.call(this,"messageStore")};a["albero.proxy.MessageStoreProxy"]=ji,ji.__name__=["albero","proxy","MessageStoreProxy"],ji.__super__=vi,ji.prototype=n(vi.prototype,{onRegister:function(){this.messages=new kr},getMessage:function(e){if(null==e)return Ar.None;var t="_"+e.high+"_"+e.low,n=this.messages;return U.option(null!=ma[t]?n.getReserved(t):n.h[t])},setMessage:function(e){},removeMessage:function(e){this.messages.remove("_"+e.high+"_"+e.low)},onFileDeleted:function(e){U.foreach(this.getMessage(e.messageId),function(t){var n=t.getFilesDynamic();if(0!=n.length){var i=h.find(n,function(t){var n=t.file_id,i=e.fileId;return null!=n&&null!=i&&n.high==i.high&&n.low==i.low});null!=i&&(i.deleted=!0)}})},onConferenceClose:function(e){U.foreach(this.getMessage(e.messageId),function(e){e.close()})},onActionStampClose:function(e){U.foreach(this.getMessage(e),function(e){e.close()})},onDeleteFavoriteMessage:function(e){var t=this.getMessage(e.getMessageId());U.foreach(t,function(t){t.updateFavorite(e)})},onAddFavoriteMessage:function(e){var t=this.getMessage(e.getMessageId());U.foreach(t,function(t){t.updateFavorite(e)}),U.isEmpty(t)&&this.setMessage(e.getMessage())},__class__:ji});var Hi=function(){this.connectionStatus=k.Ok,vi.call(this,"rpc"),this.responseHandlers=new Er,this.errorHandler=r(this,this.onServerErrorWithMethod),this.connectionKeeper=new zi(r(this,this.ping))};a["albero.proxy.MsgPackRpcProxy"]=Hi,Hi.__name__=["albero","proxy","MsgPackRpcProxy"],Hi.__super__=vi,Hi.prototype=n(vi.prototype,{initWebSocket:function(){null==this.ws&&(this.ws=new fi(la.endpoint),this.ws.onopen=r(this,this.onOpen),this.ws.onmessage=r(this,this.onMessage),this.ws.onclose=r(this,this.onClose),this.ws.onpong=r(this,this.onPong),Hi.pingAt=null)},finishWebSocket:function(){if(null==this.ws)return null;this.ws.onopen=null,this.ws.onmessage=null,this.ws.onerror=null,this.ws.onclose=null,this.ws.onpong=null,this.ws.close();var e=this.ws;return this.ws=null,Hi.pingAt=null,e},onRegister:function(){this.initWebSocket(),this.connectionKeeper.start()},onRemove:function(){this.connectionKeeper.stop(),this.finishWebSocket()},onOpen:function(){this.connectionStatus=k.Ok,this.connectionKeeper.setConnected(!0),this.sendNotification("SignIn")},onPong:function(e){Hi.pingAt=null;var t="PONG "+v.string(e);si._d("["+_.dateStr(new Date)+"] ",t,"","","","")},onMessage:function(e){var t=this,n=new Vr(e,!0).o,i=jr.__cast(n[0],ua);if(1==i&&4==n.length){var r=jr.__cast(n[1],ua),a=n[2],o=n[3],s=this.responseHandlers.h[r];if(null==s)return void si._e("["+_.dateStr(new Date)+"] ","No ResponseHandler prepared. msgId:%s error:%s result:",r,a,o,"");var l=s.method;if(si._d("["+_.dateStr(new Date)+"] ","response received. method:",l," data:",n,""),null==a){var u=s.onSuccess;null!=u&&u(o)}else{var c=s.method;si._e("["+_.dateStr(new Date)+"] ","Receive Error Response. method:",c," error:",a,"");var h=s.onError;null!=h?h(a):null!=this.errorHandler&&this.errorHandler(s.method,a)}this.responseHandlers.remove(r)}else if(0==i&&4==n.length){var d=jr.__cast(n[1],ua),f=jr.__cast(n[2],String),m=jr.__cast(n[3],Array);si._d("["+_.dateStr(new Date)+"] ","request received. method:",f,"","","");for(var p=0;p<m.length;){var g=m[p];++p,this.broadcast.handleNotification(f,g,function(){si._d("["+_.dateStr(new Date)+"] ","response sent. method:",f,"","",""),t.ws.send(new qr([1,d,null,!0]).o.getBytes())})}}},onClose:function(e,t,n){si._i("["+_.dateStr(new Date)+"] ","onClose. code:"+e+", reason:"+t+", wasClean:"+(null==n?"null":""+n),"","","",""),1001==e&&n||(this.connectionStatus=1e3!=e&&1005!=e||"concurrent access"!=t?1e3!=e&&1005!=e||"forcibly closed"!=t?k.Error:k.ForcibliyClosedError:k.ConcurrentAccessError,this.connectionStatus==k.ForcibliyClosedError?this.sendNotification("SignOut"):this.sendNotification("Url",De.FORWARD(B.error))),this.finishWebSocket(),this.connectionKeeper.setConnected(!1)},restart:function(e){null==e&&(e=500);for(var t=this,n=this.finishWebSocket(),i=this.responseHandlers.keys();i.hasNext();){var r=i.next();this.responseHandlers.remove(r)}var a=null;a=function(){if(null!=n&&!n.isClosed())return void vr.delay(a,100);t.initWebSocket()},vr.delay(a,e)},call:function(e,t,n,i){if(null==this.ws){var r=this.data;return void si._e("["+_.dateStr(new Date)+"] ","disconnected. data:",r,"","","")}null==t&&(t=[]);var a=Hi.lastMsgId++,o=this.responseHandlers,s=new Gi(e,n,i);o.h[a]=s;var l=[0,a,e,t],u=new qr(l).o.getBytes();this.ws.send(u),si._d("["+_.dateStr(new Date)+"] ","send request. data:",l,"","","")},ping:function(){switch(this.connectionStatus[1]){case 2:case 3:return}if(null==this.ws||this.ws.isClosed()){this.restart();var e="restart connection. "+Hi.pingAt+" "+v.string(null==this.ws||this.ws.isClosed());si._d("["+_.dateStr(new Date)+"] ",e,"","","","")}else if(Hi.pingAt>0){this.restart();var t="restart connection. "+Hi.pingAt+" "+v.string(null==this.ws||this.ws.isClosed());si._d("["+_.dateStr(new Date)+"] ",t,"","","","")}else{var n="before pingAt "+Hi.pingAt;si._d("["+_.dateStr(new Date)+"] ",n,"","","",""),this.connectionKeeper.isConnected()&&(this.ws.ping("PING"),Hi.pingAt=(new Date).getTime(),si._d("["+_.dateStr(new Date)+"] ","send ping","","","",""))}},onServerErrorWithMethod:function(e,t){this.onServerError(t)},onServerError:function(e){if(this.sendNotification("error_occurred",e),503==e.code&&"service temporarily unavailable"==e.message){var t=e.detail.retry_after;this.restart(1e3*t)}"invalid session"==e.message&&this.restart()},__class__:Hi});var zi=function(e){this.connected=!1,this.ping=e};a["albero.proxy._MsgPackRpcProxy.ConnectionKeeper"]=zi,zi.__name__=["albero","proxy","_MsgPackRpcProxy","ConnectionKeeper"],zi.prototype={start:function(){},stop:function(){this.deleteTimer()},setConnected:function(e){this.connected==e&&null!=this.timer||(this.connected=e,this.resetTimer())},isConnected:function(){return this.connected},resetTimer:function(){var e=this;if(this.deleteTimer(),this.connected)this.timer=new vr(45e3),this.timer.run=this.ping;else{var t=null;t=function(n){var i=0|Math.min(2*n,45e3);return function(){e.ping();var r=t(i);e.timer=vr.delay(r,n)}},t(3e3)()}},deleteTimer:function(){null!=this.timer&&(this.timer.stop(),this.timer=null)},__class__:zi};var Gi=function(e,t,n){this.method=e,this.onSuccess=t,this.onError=n};a["albero.proxy._MsgPackRpcProxy.ResponseHandler"]=Gi,Gi.__name__=["albero","proxy","_MsgPackRpcProxy","ResponseHandler"],Gi.prototype={__class__:Gi};var Wi=function(e){this.code=e.code,this.message=e.message,this.detail=e.detail};a["albero.proxy.Error"]=Wi,Wi.__name__=["albero","proxy","Error"],Wi.prototype={__class__:Wi};var Ki=function(){};a["albero.proxy.ErrorConverter"]=Ki,Ki.__name__=["albero","proxy","ErrorConverter"],Ki.toLocalError=function(e,t){return{code:t.code,message:t.message,detail:t.detail,localErrorType:e}};var Yi=function(){vi.call(this,"readStatusUpdater"),this.updateReadStatusesTimers=new kr,this.updateReadAnnouncementStatusesTimers=new kr};a["albero.proxy.ReadStatusUpdaterProxy"]=Yi,Yi.__name__=["albero","proxy","ReadStatusUpdaterProxy"],Yi.__super__=vi,Yi.prototype=n(vi.prototype,{updateReadStatuses:function(e,t){var n=this,i=this.dataStore.getTalkStatus(e);if(null!=i){if(null==t||this.canRegardTalkReadCountZero(i,t)){if(!In.isUnreadMesasgeExisted(i))return;if(null==i.maxMessageId)return;i.readAll(),this.dataStore.setTalkStatus(i)}else{var r=t.filter(function(e){return In.isUnread(i,e.id)});if(0==r.length)return;var a=r.filter(function(e){if(e.isUnreadCountTarget){var t,i=n.dataStore,r=e.userId;if(null!=i.me){var a=i.me.id;t=null!=a&&null!=r&&a.high==r.high&&a.low==r.low}else t=!1;return!t}return!1}).length;i.read(r[r.length-1].id,a),this.dataStore.setTalkStatus(i)}var o="_"+e.high+"_"+e.low,s=this.updateReadStatusesTimers,l=null!=ma[o]?s.getReserved(o):s.h[o];null!=l&&l.stop();var u=i.maxReadMessageId,c=vr.delay(function(){n.updateReadStatusesTimers.remove(o),null!=n.dataStore.getTalkStatus(e)&&n.api.updateReadStatuses(e,u)},1e3),_=this.updateReadStatusesTimers;null!=ma[o]?_.setReserved(o,c):_.h[o]=c}},updateAnnouncementReadStatus:function(e,t){var n=this,i=this.dataStore.getAnnouncementStatus(e);if(null!=i){if(null==t||this.canRegardAnnouncementReadCountZero(i,t)){if(!je.isUnreadAnnouncementExisted(i))return;if(null==i.maxAnnouncementId)return;i.readAll(),this.dataStore.setAnnouncementStatus(i)}else{var r=t.filter(function(e){return je.isUnread(i,e)});if(0==r.length)return;i.read(r[r.length-1],r.length),this.dataStore.setAnnouncementStatus(i)}var a="_"+e.high+"_"+e.low,o=this.updateReadAnnouncementStatusesTimers,s=null!=ma[a]?o.getReserved(a):o.h[a];null!=s&&s.stop();var l=i.maxReadAnnouncementId;s=vr.delay(function(){n.updateReadAnnouncementStatusesTimers.remove(a),n.api.updateAnnouncementReadStatus(e,l)},1e3);var u=this.updateReadAnnouncementStatusesTimers;null!=ma[a]?u.setReserved(a,s):u.h[a]=s}},canRegardTalkReadCountZero:function(e,t){return this.canRegardReadCountZero(e.maxMessageId,t.map(function(e){return e.id}))},canRegardAnnouncementReadCountZero:function(e,t){return this.canRegardReadCountZero(e.maxAnnouncementId,t)},canRegardReadCountZero:function(e,t){var n=U.orNull(F.lastOption(t));return null!=e&&null!=n&&e.high==n.high&&e.low==n.low},__class__:Yi});var Vi=function(){vi.call(this,"routing")};a["albero.proxy.RoutingProxy"]=Vi,Vi.__name__=["albero","proxy","RoutingProxy"],Vi.__super__=vi,Vi.prototype=n(vi.prototype,{onRegister:function(){},init:function(){null==this.router&&(this.router=new qi(this,this.settings,this.dataStore),this.router.start())},forward:function(e){this.init(),this.router.forward(e)},
redirect:function(e,t){this.init(),this.router.redirect(e,t)},back:function(){null!=this.router&&this.router.back()},stop:function(){null!=this.router&&this.router.started&&this.router.stop()},__class__:Vi});var qi=function(e,t,n){this.proxy=e,this.settings=t,this.dataStore=n,this.started=!1,this.urlConverterDelegate=new Qi(t,n)};a["albero.proxy._RoutingProxy.LocalRouter"]=qi,qi.__name__=["albero","proxy","_RoutingProxy","LocalRouter"],qi.prototype={notify:function(e){var t=this.getDomainId(e);this.settings.setSelectedDomainId(t),this.proxy.sendNotification("current_page_changed",e)},start:function(){this.started=!0},forward:function(e){0!=e[1]&&this.notify(e)},redirect:function(e,t){},redirectWithHash:function(){},back:function(){this.notify(this.prev)},stop:function(){this.started=!1},getDomainId:function(e){switch(e[1]){case 2:return e[2];case 3:return e[2];case 4:return e[2];case 5:return e[2];case 6:return e[2];case 10:return e[2];default:return null}},parseFragment:function(e){return z.createUrls(e,this.urlConverterDelegate)},toFragment:function(e){return z.createFragment(e,this.urlConverterDelegate)},__class__:qi};var Qi=function(e,t){this.settings=e,this.dataStore=t};a["albero.proxy.UrlConverterDelegate"]=Qi,Qi.__name__=["albero","proxy","UrlConverterDelegate"],Qi.__interfaces__=[G],Qi.prototype={isMultiViewMode:function(){return this.settings.isMultiViewMode()},getLastSelectedDomainId:function(){return U.option(this.settings.getLastSelectedDomainId())},getFallbackDomainId:function(){var e,t=U.flatMap(this.getLastSelectedDomainId(),r(this,this.getDomain));switch(t[1]){case 0:e=U.flatMap(this.getLastSelectedDomainId(),r(this,this.getDomain));break;case 1:e=this.getOldestDomain()}return U.map(e,function(e){return e.id})},getDomain:function(e){return U.option(this.dataStore.getDomain(e))},getOldestDomain:function(){return new _t(this.dataStore.getDomains()).getOldestDomain()},__class__:Qi};var Ji=function(){vi.call(this,"searchService")};a["albero.proxy.SearchServiceProxy"]=Ji,Ji.__name__=["albero","proxy","SearchServiceProxy"],Ji.__super__=vi,Ji.prototype=n(vi.prototype,{isSearching:function(){return this.searching},clearSearching:function(){this.searching=!1},isRecentParams:function(e){return null!=this.recentParams&&null!=e&&this.recentParams.eq(e)},clearRecentParams:function(){this.recentParams=null},clearEditingParams:function(){this.editingParams=null},saveParams:function(e){this.editingParams=e,this.recentParams=e.copy()},updateTalkIdParam:function(e){this.assureParams(),this.editingParams.talkId=e},updateSearchTypeParam:function(e){this.assureParams(),this.editingParams.searchType=e},updateFromUserIdParam:function(e){this.assureParams(),this.editingParams.fromUserId=e},updateKeywordParam:function(e){this.assureParams(),this.editingParams.keyword=e},updateDomainIdParam:function(e){this.assureParams(),this.editingParams.domainId=e},updateSinceTextParam:function(e){this.assureParams(),this.editingParams.sinceText=e},updateUntilTextParam:function(e){this.assureParams(),this.editingParams.untilText=e},assureParams:function(){if(null==this.editingParams){var e=this.settings.getSelectedDomainId(),t={domain_id_str:"_"+e.high+"_"+e.low};this.editingParams=new $t(t)}},prepareForSearching:function(e,t){this.searching=!0,null==t&&this.sendNotification("notify_search_prepare",{searching:!0,params:e})},notifySearchMessagesFail:function(){this.searching=!1,this.sendNotification("notify_search_messages_fail",{})},notifySearchAttachmentsFail:function(){this.searching=!1,this.sendNotification("notify_search_attachments_fail",{})},saveSearchMessagesResult:function(e){null==this.contextMap&&(this.contextMap=new kr),this.messagesNextMarker=e.nextMarker,null==e.marker&&(this.hitMessageIdSet=new kr);for(var t=0,n=e.contents;t<n.length;){var i=n[t];++t;var r=i.messages[0].id,a="_"+r.high+"_"+r.low,o=this.contextMap;null!=ma[a]?o.setReserved(a,i):o.h[a]=i,this.hitMessageIdSet=h.fold(i.messages,function(e,t){if(e.hit){var n=e.id,i="_"+n.high+"_"+n.low;null!=ma[i]?t.setReserved(i,1):t.h[i]=1}return t},this.hitMessageIdSet)}this.searching=!1,this.sendNotification("notify_search_messages",e)},saveSearchAttachmentsResult:function(e){null==this.attachmentsMap&&(this.attachmentsMap=new kr),this.attachmentsNextMarker=e.nextMarker;for(var t=0,n=e.contents;t<n.length;){var i=n[t];++t;var r=i.attachmentId,a="_"+r.high+"_"+r.low,o=this.attachmentsMap;null!=ma[a]?o.setReserved(a,i):o.h[a]=i}this.searching=!1,this.sendNotification("notify_search_attachments",e)},getHitContext:function(e){var t=this.contextMap;return null!=ma[e]?t.getReserved(e):t.h[e]},getFileInfo:function(e){var t=this.attachmentsMap;return null!=ma[e]?t.getReserved(e):t.h[e]},isHitMessage:function(e){var t="_"+e.high+"_"+e.low,n=this.hitMessageIdSet;return null!=ma[t]?n.existsReserved(t):n.h.hasOwnProperty(t)},reserveOnNormalizedKeywordPrepared:function(e){var t=this;if(null!=this.recentParams&&null!=this.recentParams.keyword){var n=null==this.recentParams?"":this.recentParams.keyword;if(this.cachedKeyword!=n){this.cachedKeyword=n,null==this.cachedNormalizedKeywords?this.cachedNormalizedKeywords=[]:this.cachedNormalizedKeywords.splice(0,this.cachedNormalizedKeywords.length);var i=new l("[ ]","g").split(S.htmlEscape(n,!0));h.iter(i.filter(L.isNotEmpty),function(e){t.cachedNormalizedKeywords.push(new li(e,!0,hi.normalize))})}e(this.cachedNormalizedKeywords)}},__class__:Ji});var Xi=function(){vi.call(this,"session"),this.createSessionCount=0};a["albero.proxy.SessionProxy"]=Xi,Xi.__name__=["albero","proxy","SessionProxy"],Xi.__super__=vi,Xi.prototype=n(vi.prototype,{start:function(e){this.api.createSession(e,r(this,this.onSessionCreated))},onSessionCreated:function(e){var t,n=this;if(e.notification){var i=this.dataStore,r=e.user.id;if(null!=i.me){var a=i.me.id;t=null!=a&&null!=r&&a.high==r.high&&a.low==r.low}else t=!1}else t=!1;var o=this.dataStore,s=e.user;o.me=s;for(var l=0,u=o.getDomains();l<u.length;){var c=u[l];++l,o.sendNotification("notify_update_user",o.me.toDomainUser(c.id))}o.sendNotification("current_user_changed",s),o.storage.setDirtyFlag(),this.settings.setConfiguration(e.configuration),this.sendNotification("data_recovering"),Promise.all([oi.asyncPrepare(),hi.asyncAssureNormalize()]).then(function(e){t?n.prepareNecessaryDataFromCache():(n.dataStore.clear(!1),n.prepareNecessaryDataFromServer()),n.createSessionCount++})},prepareNecessaryDataFromServer:function(){var e=this;this.api.resetNotification(function(t){var n=0,i=function(){5==(n+=1)&&e.api.getAllUserIdentifiers(r(e,e.onNecessaryDataPrepared))};e.api.getDomains(function(){var t=e.dataStore.getDomains(),n=0,r=function(){(n+=1)==t.length&&i()};t.length>0?e.api.getAnnouncementStatuses(r):i();var a=0,o=function(){2==(a+=1)&&e.api.getTalks(i)};e.api.getFriends(o),e.api.getAcquaintances(o)}),e.api.getDomainInvites(i),e.api.getAccountControlRequests(i),e.api.getJoinedAccountControlGroup(i)})},prepareNecessaryDataFromCache:function(){var e=F.sortAndReturn(this.dataStore.getDomains(),function(e,t){var n=t.id,i=e.id,r=n.high-i.high|0;return r=0!=r?r:mr.ucompare(n.low,i.low),n.high<0?i.high<0?r:-1:i.high>=0?r:1});this.api.sendDomainNotifications(e);for(var t=0;t<e.length;){var n=e[t];++t;var i=this.dataStore.getAnnouncementStatus(n.id);null==i&&(i=this.dataFactory.newAnnouncementStatusForDomain(n.id)),this.api.sendAnnouncementStatusNotification(i);for(var r=0,a=this.dataStore.getFriends(n.id);r<a.length;){var o=a[r];++r,this.sendNotification("notify_add_friend",o)}for(var s=0,l=this.dataStore.getAcquaintances(n.id);s<l.length;){var u=l[s];++s,this.sendNotification("notify_add_acquaintance",u)}}this.api.sendTalkNotifications(this.dataStore.getTalks()),this.api.sendTalkStatusNotifications(this.dataStore.getTalkStatuses());for(var c=0,_=this.dataStore.getDomainInvites();c<_.length;){var h=_[c];++c,this.sendNotification("notify_add_domain_invite",h)}for(var d=0,f=this.dataStore.getAccountControlRequests();d<f.length;){var m=f[d];++d,this.sendNotification("notify_add_account_control_request",m)}var p=this.dataStore.getAccountControlGroup();null!=p&&this.sendNotification("notify_join_account_control_group",p),this.onNecessaryDataPrepared()},onNecessaryDataPrepared:function(){var e=this.settings.getConfiguration().botExpiredVersion;if(si._d("["+_.dateStr(new Date)+"] ","bot_expired_version",e,"","",""),null!=e){var t=require("../../package.json").version;if(si._d("["+_.dateStr(new Date)+"] ","current",t,"","",""),null!=t){var n=e.split("."),i=t.split(".");3==n.length&&3==i.length&&1e4*(parseFloat(n[0])-parseFloat(i[0]))+100*(parseFloat(n[1])-parseFloat(i[1]))+(parseFloat(n[2])-parseFloat(i[2]))>=0&&process.stderr.write("-----------------------------------------\nCurrent version is expired! (current: "+t+")\nRun 'npm install direct-js' to update\n-----------------------------------------\n")}}this.sendNotification("data_recovered"),this.api.startNotification(),this.api.startUpdateLastUsedAtIfNeed(),this.api.getConferences()},__class__:Xi});var Zi=function(){this.selectedDomainIdOnTalkSelectionChanged=null,this.selectedDomainId=null,this.remember=!0,vi.call(this,"settings")};a["albero.proxy.SettingsProxy"]=Zi,Zi.__name__=["albero","proxy","SettingsProxy"],Zi.__interfaces__=[vn],Zi.__super__=vi,Zi.prototype=n(vi.prototype,{onRegister:function(){this.loadBrowserSettings()},setAccessTokenRemember:function(e){this.remember=e},setAccessToken:function(e){this.remember&&(this.accessToken=e,this.sendNotification("access_token_changed",e))},getAccessToken:function(){return null==this.accessToken&&(this.accessToken=la.accessToken),this.accessToken},clearAccessToken:function(){this.accessToken=null},getOs:function(){return"bot"},getIDFV:function(){var e=P.getItem("idfv");return null!=e&&""!=e||(e=L.randomString(),P.setItem("idfv",e)),e},setConfiguration:function(e){this.configuration=e,this.sendNotification("configuration_changed",e)},getConfiguration:function(){return this.configuration},setSelectedDomainId:function(e){var t=this.selectedDomainId;null!=t&&null!=e&&t.high==e.high&&t.low==e.low||(null!=e?(P.setItem("selected_domain_id_h",v.string(e.high)),P.setItem("selected_domain_id_l",v.string(e.low))):(P.removeItem("selected_domain_id_h"),P.removeItem("selected_domain_id_l")),this.selectedDomainId=e,this.sendNotification("domain_selection_changed",e))},getLastSelectedDomainId:function(){var e,t=P.getItemAsInt("selected_domain_id_h"),n=P.getItemAsInt("selected_domain_id_l");if(null!=t&&null!=n){e=new Cn(t,n)}else e=null;return e},getSelectedDomainId:function(){return this.selectedDomainId},getSelectedDomainIdOnTalkSelectionChanged:function(){return this.selectedDomainIdOnTalkSelectionChanged},clearDomainSelection:function(){this.selectedDomainId=null,P.removeItem("selected_domain_id_h"),P.removeItem("selected_domain_id_l")},clearSelectedTalk:function(e){null==e&&(e=Ft.SingleTalkPane);var t=this.selectedDomainId;this.assureTalkSelectionMap("_"+t.high+"_"+t.low).remove(e),this.selectedDomainIdOnTalkSelectionChanged=this.selectedDomainId,this.sendNotification("talk_selection_changed",new gn(e,Sn.NotSelected))},selectTalk:function(e,t,n,i){var r="_"+t.high+"_"+t.low;if(null==r)return!1;var a=this.assureTalkSelectionMap(r),o=Sn.TalkSelected(n,i);a.set(e,o);var s=this.selectedDomainId;return null!=t&&null!=s&&t.high==s.high&&t.low==s.low&&(this.selectedDomainIdOnTalkSelectionChanged=this.selectedDomainId,this.sendNotification("talk_selection_changed",new gn(e,o)),!0)},selectAnnouncement:function(e){if(null==this.selectedDomainId)return!1;var t=this.selectedDomainId,n="_"+t.high+"_"+t.low;return this.assureTalkSelectionMap(n).set(e,Sn.AnnouncementsSelected),this.selectedDomainIdOnTalkSelectionChanged=this.selectedDomainId,this.sendNotification("talk_selection_changed",new gn(e,Sn.AnnouncementsSelected)),!0},hasSelectedTalkOrAnnouncements:function(e){null==e&&(e=Ft.SingleTalkPane);var t=this.getTalkSelectionMap(this.selectedDomainId);return null!=t&&t.get(e)!=Sn.NotSelected},hasSelectedTalk:function(e){null==e&&(e=Ft.SingleTalkPane);var t=this.getTalkSelectionMap(this.selectedDomainId);if(null==t)return!1;var n=t.get(e);return null!=n&&0!=n[1]},getTalkSelectionMap:function(e){if(null==this.paneTalkSelections)return null;if(null==e)return null;var t="_"+e.high+"_"+e.low,n=this.paneTalkSelections;return null!=ma[t]?n.getReserved(t):n.h[t]},assureTalkSelectionMap:function(e){null==this.paneTalkSelections&&(this.paneTalkSelections=new kr);var t=this.paneTalkSelections,n=null!=ma[e]?t.getReserved(e):t.h[e];if(null==n){n=new Ir;var i=this.paneTalkSelections;null!=ma[e]?i.setReserved(e,n):i.h[e]=n}return n},getSelectedTalkId:function(){var e=this.getTalkSelection(this.selectedDomainId,Ft.SingleTalkPane);if(1==e[1]){e[3];return e[2]}return null},isSelectedTalkOrAnnouncements:function(e,t){return wn.isSelected(this.getTalkSelection(this.selectedDomainId,e),t)},getTalkSelection:function(e,t){if(null==this.paneTalkSelections)return Sn.NotSelected;var n=this.getTalkSelectionMap(e);if(null==n)return Sn.NotSelected;var i=n.get(t);return null==i?Sn.NotSelected:i},isSendByEnter:function(){return null==this.sendByEnter&&(this.sendByEnter=!0),this.sendByEnter},setSendByEnter:function(e){e!=this.sendByEnter&&(this.sendByEnter=e,this.sendNotification("send_by_enter_changed",e))},setSelectedStampTabId:function(e){P.setItem("selected_stamp_tab_id",null==e?"null":""+e)},getSelectedStampTabId:function(){var e=P.getItemAsInt("selected_stamp_tab_id");return null==e?0:e},clearSelectedStampTabId:function(){P.removeItem("selected_stamp_tab_id")},setInputTextForTalkId:function(e,t){null==e||0==e.length?this.clearInputTextForTalkId(t):(this.loadInputTextForAll(),this.inputTexts["_"+t.high+"_"+t.low]=e)},getInputTextForTalkId:function(e){this.loadInputTextForAll();var t=this.inputTexts["_"+e.high+"_"+e.low];return null!=t?t:""},clearInputTextForTalkId:function(e){this.loadInputTextForAll(),delete this.inputTexts["_"+e.high+"_"+e.low]},loadInputTextForAll:function(){null==this.inputTexts&&(this.inputTexts=P.getItemAsJson("input_text"),null==this.inputTexts&&(this.inputTexts={}))},saveInputTextForAll:function(){if(null!=this.inputTexts){var e=JSON.stringify(this.inputTexts);P.setItem("input_text",e)}},clearInputTextForAll:function(){P.removeItem("input_text"),this.inputTexts=null},setCopyProfileToAllDomains:function(e){e?P.setItem("copy_profile_to_all_domains","true"):P.removeItem("copy_profile_to_all_domains")},isCopyProfileToAllDomains:function(){return null!=P.getItem("copy_profile_to_all_domains")},setSearchHistoriesForSelectedDomain:function(e){if(null!=this.selectedDomainId){if(this.loadSearchHistoryForAll(),null==e){var t=this.selectedDomainId;delete this.searchHistories["_"+t.high+"_"+t.low]}else{var n=this.selectedDomainId;this.searchHistories["_"+n.high+"_"+n.low]=e}this.saveSearchHistoryForAll()}},getSearchHistoriesForSelectedDomain:function(){if(null==this.selectedDomainId)return null;this.loadSearchHistoryForAll();var e=this.selectedDomainId;return this.searchHistories["_"+e.high+"_"+e.low]},loadSearchHistoryForAll:function(){null==this.searchHistories&&(this.searchHistories=P.getItemAsJson("search_histories"),null==this.searchHistories&&(this.searchHistories={}))},saveSearchHistoryForAll:function(){if(null!=this.searchHistories){var e=JSON.stringify(this.searchHistories);P.setItem("search_histories",e)}},setSelectedDepartmentId:function(e,t){if(null!=e){if(this.loadSelectedDepartmentIdsForAll(),null==t)this.selectedDepartmentIds.remove("_"+e.high+"_"+e.low);else{var n="_"+e.high+"_"+e.low,i=this.selectedDepartmentIds;null!=ma[n]?i.setReserved(n,t):i.h[n]=t}this.saveSelectedDepartmentIdsForAll()}},getSelectedDepartmentId:function(e){if(null==e)return null;this.loadSelectedDepartmentIdsForAll();var t="_"+e.high+"_"+e.low,n=this.selectedDepartmentIds;return null!=ma[t]?n.getReserved(t):n.h[t]},loadSelectedDepartmentIdsForAll:function(){null==this.selectedDepartmentIds&&(this.selectedDepartmentIds=P.getItemWithUnserialize("selected_department_ids"),null==this.selectedDepartmentIds&&(this.selectedDepartmentIds=new kr))},saveSelectedDepartmentIdsForAll:function(){null!=this.selectedDepartmentIds&&P.setItemWithSerialize("selected_department_ids",this.selectedDepartmentIds)},setRightPanelOpened:function(e){e?P.removeItem("right_panel_opened"):P.setItem("right_panel_opened","false")},isRightPanelOpened:function(){return null==P.getItem("right_panel_opened")},setMultiViewMode:function(e){e?P.setItem("multi_view_mode","true"):P.removeItem("multi_view_mode")},isMultiViewMode:function(){return null!=P.getItem("multi_view_mode")},setPasswordWarningSkipUntil:function(e){null==e?P.removeItem("password_warning_skip_until"):P.setItem("password_warning_skip_until","_"+e.high+"_"+e.low)},getPasswordWarningSkipUntil:function(){var e=P.getItem("password_warning_skip_until");return null==e?null:M.makeFromIdStr(e)},setLastUsedExpiredAt:function(e){null==e?P.removeItem("last_used_expired_at"):P.setItem("last_used_expired_at","_"+e.high+"_"+e.low)},getLastUsedExpiredAt:function(){var e=P.getItem("last_used_expired_at");return null==e?null:M.makeFromIdStr(e)},setOnPremise:function(e){this.onPremises=e},isOnPremises:function(){return this.onPremises},getBrowserSettings:function(){return this.browserSettings},applyNotificationSettings:function(e){return e.copyNotificationSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyKeywordWatchingSettings:function(e){return e.copyKeywordSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyTalkSettings:function(e){return e.copyTalkSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyUserDataSettings:function(e){return e.copyUserDataContainerTo(this.browserSettings),this.saveBrowserSettings()},applyLanguageSettings:function(e){return e.copyLanguageSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyConferenceSettings:function(e){return e.copyConferenceSettingsTo(this.browserSettings),this.saveBrowserSettings()},loadBrowserSettings:function(){this.browserSettings=ze.fromJson(P.getItemAsJson(ze.NAME))},saveBrowserSettings:function(){var e=P.getItemAsJson(ze.NAME);return null==e&&(e={}),this.browserSettings.copyTo(e),P.setItem(ze.NAME,JSON.stringify(e))},__class__:Zi});var $i=function(){vi.call(this,"solutionsStore")};a["albero.proxy.SolutionsStoreProxy"]=$i,$i.__name__=["albero","proxy","SolutionsStoreProxy"],$i.__super__=vi,$i.prototype=n(vi.prototype,{getSolutions:function(e){var t=this;return null==this.solutionsMap?[]:this.getSolutionIds(e).map(function(e){return t.solutionsMap.h[e]}).filter(function(e){return null!=e})},getSolution:function(e){return null==this.solutionsMap?null:this.solutionsMap.h[e]},getSolutionIds:function(e){return null==e?[]:null==e.contract?[]:null==e.contract.solutionIds?[]:e.contract.solutionIds},getSolutionIdsNotLoaded:function(e){var t=this;return this.getSolutionIds(e).filter(function(e){return null==t.solutionsMap||!t.solutionsMap.h.hasOwnProperty(e)})},setSolution:function(e){null==this.solutionsMap&&(this.solutionsMap=new Er),this.solutionsMap.h[e.solutionId]=e},__class__:$i});var er=function(){vi.call(this,"talksService")};a["albero.proxy.TalksServiceProxy"]=er,er.__name__=["albero","proxy","TalksServiceProxy"],er.__super__=vi,er.prototype=n(vi.prototype,{getDomainTalksOrderedByTimestamp:function(e){return F.sortAndReturn(this.getDomainTalks(e).map(r(this,this.createTalkPack)),pn.compareTalkOrderingTimestamp).map(r(this,this.getTalkFromTalkPack))},hasConference:function(e){return null!=e&&this.conferenceStore.hasConference(e.id)},isFavoriteTalk:function(e){var t=this.dataStore.getTalkStatus(e.id);return null!=t&&null!=t.orderInFavorites},getTalkFromTalkPack:function(e){return e.talk},getTalkIdFromTalk:function(e){return e.id},getDomainTalks:function(e){return null==e?[]:this.dataStore.getTalks().filter(function(t){var n=t.domainId;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low})},createTalkPack:function(e){return new pn(e,this.dataStore.getTalkStatus(e.id))},__class__:er});var tr=function(){vi.call(this,"ThumbnailExpansion")};a["albero.proxy.ThumbnailExpansionProxy"]=tr,tr.__name__=["albero","proxy","ThumbnailExpansionProxy"],tr.__super__=vi,tr.prototype=n(vi.prototype,{onRegister:function(){var e=this;vr.delay(function(){e.workingBrowserSettings=e.settings.getBrowserSettings().createCopy()},0)},updateThumbnailExpansionEnabled:function(e){if(null!=this.workingBrowserSettings){var t=this.dataStore.me;if(null!=t){var n=t.id;this.workingBrowserSettings.assureUserData("_"+n.high+"_"+n.low).useThumbnailExpansion=e,this.settings.applyUserDataSettings(this.workingBrowserSettings)}}},isThumbnailExpansionEnabled:function(){if(null==this.workingBrowserSettings)return!1;var e=this.dataStore.me;if(null==e)return!1;var t=e.id;return this.workingBrowserSettings.assureUserData("_"+t.high+"_"+t.low).useThumbnailExpansion},__class__:tr});var nr=function(){vi.call(this,"userPresences")};a["albero.proxy.UserPresencesProxy"]=nr,nr.__name__=["albero","proxy","UserPresencesProxy"],nr.__super__=vi,nr.prototype=n(vi.prototype,{getUserPresenceState:function(e,t){var n=U.map(this.getUserPresence(e),function(e){return e.toState(t)});switch(n[1]){case 0:return n[2];case 1:return Rn.GT_60}},getUserPresence:function(e){return U.option(this.dataStore.getUserPresence(e))},getLastUsedAtString:function(e){var t=U.map(U.flatMap(this.getUserPresence(e),function(e){return e.lastUsedAtOpt}),function(e){return D.datetimeString(e)});switch(t[1]){case 0:return t[2];case 1:return" - "}},__class__:nr});var ir=function(){};a["albero.proxy.helper.AnnouncementHelper"]=ir,ir.__name__=["albero","proxy","helper","AnnouncementHelper"],ir.getDisplayTextWithoutEscape=function(e){return 1==e.type[1]?e.content:""};var rr=function(){};a["albero.proxy.helper.DomainHelper"]=rr,rr.__name__=["albero","proxy","helper","DomainHelper"],rr.isAllowReadAnnouncement=function(e){return null!=e&&!!e.role.allowReadAnnouncements};var ar=function(){};a["albero.proxy.helper.MessageStringMaker"]=ar,ar.__name__=["albero","proxy","helper","MessageStringMaker"],ar.messageStringForKeywordDetection=function(e,t){return null==e?"":1==e.type[1]?e.content:""};var or=function(){};a["puremvc.interfaces.IMediator"]=or,or.__name__=["puremvc","interfaces","IMediator"],or.prototype={__class__:or};var sr=function(e,t){K.call(this),this.mediatorName=null!=e?e:sr.NAME,null!=t&&(this.viewComponent=t)};a["puremvc.patterns.mediator.Mediator"]=sr,sr.__name__=["puremvc","patterns","mediator","Mediator"],sr.__interfaces__=[or],sr.__super__=K,sr.prototype=n(K.prototype,{getMediatorName:function(){return this.mediatorName},setViewComponent:function(e){this.viewComponent=e},getViewComponent:function(){return this.viewComponent},listNotificationInterests:function(){return[]},handleNotification:function(e){},onRegister:function(){},onRemove:function(){},__class__:sr});var lr=function(){sr.call(this,"commandline",null)};a["albero_cli.mediator.CommandLineMediator"]=lr,lr.__name__=["albero_cli","mediator","CommandLineMediator"],lr.__super__=sr,lr.prototype=n(sr.prototype,{onRegister:function(){this.getViewComponent();this.eventEmitter=s.getInstance(),this.dataRecovered=!1,this.startDataSaver()},listNotificationInterests:function(){return["app_state_changed","access_token_changed","current_user_changed","configuration_changed","domain_selection_changed","talk_selection_changed","talk_list_scroll_to_talk_top_needed","user_selection_needed","user_selection_changed","friend_selection_needed","stamp_set_changed","stamp_selection_started","stamp_selection_ended","stamp_selection_changed","action_selection_changed","current_page_changed","fileinfo_selection_changed","message_fileinfo_selection_changed","staged_fileinfo_selection_changed","staged_fileinfos_added","staged_fileinfos_moved","error_occurred","brand_badge_changed","send_form_top_changed","solutions_loaded","right_pane_opened","right_pane_closed","password_expiration_overed","password_expiration_warned","photo_editor_saved","mc_authenticated_user_received","keyword_watching_updated","keyword_detaction_updated","send_by_enter_changed","department_selection_changed_for_members_page","presences_updated","noteinfo_selection_changed","start_note_editing","data_recovering","data_recovered","notify_update_user","notify_add_friend","notify_add_acquaintance","notify_delete_friend","notify_delete_acquaintance","notify_update_domain_users","get_domain_users_responsed","get_users_responsed","get_profile_responsed","get_profile_errored","update_user_responsed","update_user_errored","update_profile_responsed","update_profile_errored","notify_update_department_tree","notify_update_department_users","get_department_tree_responsed","get_department_tree_canceled","get_department_users_responsed","get_department_users_canceled","get_department_user_count_responsed","get_me_responsed","department_user_count_cleared","department_user_ids_prepared","notify_add_domain_invite","notify_accept_domain_invite","notify_delete_domain_invite","notify_join_domain","notify_update_domain","notify_leave_domain","notify_create_pair_talk","notify_create_group_talk","notify_update_group_talk","notify_update_group_talk_ERRORED","notify_add_talkers","notify_add_talkers_including_me","notify_delete_talker","notify_delete_talk","notify_create_message","notify_delete_message","notify_update_read_statuses","notify_update_talk_status","notify_update_local_talk_status","notify_get_messages","notify_get_message_status","notify_add_favorite_talk","notify_delete_favorite_talk","notify_disable_push_notification","notify_enable_push_notification","create_message_start","create_message_complete","create_message_fail","notify_create_announcement","notify_delete_announcement","notify_update_announcement_status","notify_get_announcements","create_announcement_start","create_announcement_complete","create_announcement_fail","notify_update_question","get_questions_responsed","notify_create_attachment","notify_delete_attachment","get_note_statuses_loaded","get_note_loaded","get_note_failed_by_note_not_found","create_note_completed","update_note_setting_completed","update_note_setting_failed_by_not_found","update_note_setting_failed_by_conflict","update_note_completed","update_note_failed_by_not_found","update_note_failed_by_conflict","delete_note_completed","notify_create_note","notify_update_note_partially","notify_delete_note","notify_update_note_for_setting","notify_update_note_for_revision","create_note_button_clicked","get_file_responsed","notify_search_messages","notify_search_attachments","notify_search_messages_fail","notify_search_attachments_fail","notify_search_prepare","notify_search_clear","notify_filter_box_text_changed","notify_search_box_popup","notify_add_account_control_request","notify_delete_account_control_request","notify_join_account_control_group","notify_update_account_control_group_partially","notify_leave_account_control_group","prepare_conference_from_message","join_conference_responsed","join_conference_canceled","notify_open_conference","notify_close_conference","notify_conference_participant_join","notify_conference_participant_limit","notify_conference_participant_reject","notify_all_talk_members_rejected_conference"]},handleNotification:function(e){var t=this,n=e.getName();switch(n){case"current_page_changed":var i=e.getBody();I.enumEq(i,B.error)&&(this.dataRecovered=!1),this.eventEmitter.emit(e.getName(),e.getBody());break;case"data_recovered":if(this.dataRecovered)return;this.dataRecovered=!0,this.eventEmitter.emit(e.getName());break;case"data_recovering":this.dataRecovered=!1,this.eventEmitter.emit(e.getName());break;case"error_occurred":this.eventEmitter.emit(e.getName(),new Error("AdapterError"),e.getBody());break;default:;this.eventEmitter.emit(e.getName(),e.getBody())}this.getViewComponent();switch(e.getName()){case"access_token_changed":this.dataStore.clear(!0),console.log(e.getBody()),process.exit(0);break;case"create_announcement_complete":case"create_message_complete":var r,a=e.getBody(),o=a[0],s=(a[1],this.dataStore),l=o.userId;if(null!=s.me){var u=s.me.id;r=null!=u&&null!=l&&u.high==l.high&&u.low==l.low}else r=!1;if(r)return this.messageEvent.messageCreated(o,e.getType()),void this.sendQueue.sendNext(o);break;case"create_message_fail":var c,_=e.getBody()[0],h=e.getBody()[1],d=this.dataStore,f=h.userId;if(null!=d.me){var m=d.me.id;c=null!=m&&null!=f&&m.high==f.high&&m.low==f.low}else c=!1;if(c)return this.messageEvent.messageCreated(null,e.getType()),void(null!=_&&429==_.code?this.sendQueue.retryAfter(1e3*(0|_.detail.retry_after)):null!=_&&503==_.code?this.sendQueue.retryAfter(1e3*(0|_.detail.retry_after)):this.sendQueue.sendNext(h));break;case"current_user_changed":e.getBody(),this.sendQueue.restart();break;case"notify_add_domain_invite":e.getBody();break;case"notify_create_group_talk":case"notify_create_pair_talk":if(!this.dataRecovered)return;var p=e.getBody();vr.delay(function(){t.emit(p,"JoinMessage",t.dataStore.me)},500);break;case"notify_create_message":var g,v=e.getBody(),y=this.dataStore,S=v.userId;if(null!=y.me){var w=y.me.id;g=null!=w&&null!=S&&w.high==S.high&&w.low==S.low}else g=!1;if(g)return;if(v.isBotMessage&&!la.talkWithBot)return;var T,E=this.dataStore.getTalkStatus(v.talkId);if(null!=E&&null!=E.maxReadMessageId){var b=E.maxReadMessageId,A=v.id,N=b.high-A.high|0;N=0!=N?N:mr.ucompare(b.low,A.low),T=(b.high<0?A.high<0?N:-1:A.high>=0?N:1)>=0}else T=!1;if(T)return;vr.delay(function(){null!=t.dataStore.getTalk(v.talkId)&&(t.sendNotification("Read",de.TALK(v.talkId)),t.dispatch(v))},200);break;case"notify_delete_talk":var k=e.getBody();this.messageEvent.deleteTalk(k);break;case"notify_get_message_status":var D=e.getBody();this.messageEvent.messageRead(D.talkId,D.id,D.readUserIds,D.unreadUserIds);break;case"notify_leave_domain":var C=e.getBody();this.messageEvent.leaveDomain(C);break;case"notify_update_group_talk":if(!this.dataRecovered)return;var O=e.getBody(),R=null!=O.name?O.name:"";vr.delay(function(){t.emit(O,"TopicChangeMessage",t.dataStore.me,R)},500);break;case"notify_update_local_talk_status":var M=e.getBody();this.messageEvent.messageReadEveryone(M.id,M.maxEveryoneReadMessageId);break;case"notify_update_read_statuses":for(var x=e.getBody(),F=0,U=x.messageIds;F<U.length;){var P=U[F];++F,this.messageEvent.messageRead(x.talkId,P,x.readUserIds)}}},emit:function(e,t,n,i){var r=this;null!=t&&null!=e&&null!=n&&this.api.getAllUserIdentifiers(function(){var a=r.eventEmitter,o=e.id,s={room:"_"+o.high+"_"+o.low,rooms:r.hubotObject.talkObjects()},l=r.hubotObject.userObject(n);a.emit(t,s,l,i)})},leave:function(e){var t=this;vr.delay(function(){null!=t.dataStore.getTalk(e.id)&&t.sendNotification("Talk",Ee.DELETE(null,e))},500)},dispatch:function(e){var t=this,n=e.content,i=this.dataStore.getTalk(e.talkId),r=function(n,r,a){var o=t.dataStore.getUser(i.domainId,r),s=e.id;t.emit(i,n,o,{id:"_"+s.high+"_"+s.low,content:a})};if(e.type==Nt.system){var a=n.type;if("add_talkers"==a){var o=n.added_user_ids,s=this.dataStore.me.id;if(M.contains(o,s))return void r("JoinMessage",s);for(var l=0;l<o.length;){var u=o[l];++l,r("EnterMessage",u)}}else"delete_talker"==a?(r("LeaveMessage",n.deleted_user_id),n.user_ids.length<=1&&this.leave(i)):"hide_pair_talk"==a&&(r("LeaveMessage",n.user_id),this.leave(i))}else{var c=null;if(1==e.type[1])c=n;else{for(var _=e.content,h=null==_?null:JSON.parse(JSON.stringify(_)),d=0,f=g.fields(h);d<f.length;){var m=f[d];++d;var p=g.field(h,m);if(g.isObject(h)&&null!=p.high&&null!=p.low){var y=new Cn(p.high,p.low),w=y;h[m]="stamp_index"==m?pr.toString(w):"_"+w.high+"_"+w.low}else"stamp_set"==m&&(h[m]=v.string(p))}e.type!=Nt.textMultipleFile||null!=h.text&&0!=h.text.length||null==h.files||1!=h.files.length||(h=h.files[0]),c=JSON.stringify(h)}if(null!=c){if(i.type==dn.PairTalk){var T=null!=la.name?la.name:"Hubot";S.startsWith(c,T)||(c=T+" "+c)}r("TextMessage",e.userId,c)}}},startDataSaver:function(){var e=this;vr.delay(function(){
e.dataRecovered&&e.dataStore.saveIfNeeded(),e.startDataSaver()},5e3)},__class__:lr});var ur=function(){vi.call(this,"hubotObject")};a["albero_cli.proxy.HubotObjectProxy"]=ur,ur.__name__=["albero_cli","proxy","HubotObjectProxy"],ur.__super__=vi,ur.prototype=n(vi.prototype,{userObject:function(e){var t=null==e?null:JSON.parse(JSON.stringify(e));t.id_i64=e.id;var n=e.id;return t.id="_"+n.high+"_"+n.low,t.name=e.displayName,t.profile_url=e.profileImageUrl,t},userObjectByIdStr:function(e,t){var n,i=t.split("_");if(i.length>2){n=new Cn(v.parseInt(i[1]),v.parseInt(i[2]))}else n=null;var r=this.userObjectsByIds(e,[n]);return r.length>0?r[0]:null},userObjectsByIds:function(e,t,n){for(var i=[],r=0,a=this.dataStore.getUsers(e,t);r<a.length;){var o=a[r];if(++r,null!=o){var s=o.id,l="u_"+s.high+"_"+s.low,u=null!=n?null!=ma[l]?n.getReserved(l):n.h[l]:null;if(null==u&&(u=this.userObject(o),null!=n)){var c=u;null!=ma[l]?n.setReserved(l,c):n.h[l]=c}i.push(u)}}return i},userObjects:function(e){for(var t={},n=new kr,i=0,r=this.dataStore.getUsers(e);i<r.length;){var a=r[i];++i;var o,s=a.id,l="_"+s.high+"_"+s.low;if(null!=t[l]){var u=(null!=ma[l]?n.getReserved(l):n.h[l]).updatedAt,c=a.updatedAt,_=u.high-c.high|0;_=0!=_?_:mr.ucompare(u.low,c.low),o=(u.high<0?c.high<0?_:-1:c.high>=0?_:1)<=0}else o=!0;o&&(t[l]=this.userObject(a),null!=ma[l]?n.setReserved(l,a):n.h[l]=a)}return t},talkObject:function(e,t){var n=null==e?null:JSON.parse(JSON.stringify(e));n.id_i64=e.id;var i=e.id;n.id="_"+i.high+"_"+i.low,n.topic=e.name,n.type=e.type==dn.Unknown?0:e.type==dn.PairTalk?1:2,n.userIds=e.userIds,n.users=this.userObjectsByIds(e.domainId,e.userIds,t),n.domain=this.domainObjectById(e.domainId,t),n.domainId_i64=e.domainId;var r=e.domainId;return n.domainId="_"+r.high+"_"+r.low,n},talkObjects:function(e){for(var t=new kr,n={},i=0,r=this.dataStore.getTalks();i<r.length;){var a=r[i];++i;var o;if(null!=e){var s=a.domainId;o=!(null!=e&&null!=s&&e.high==s.high&&e.low==s.low)}else o=!1;if(!o){var l=a.id;n["_"+l.high+"_"+l.low]=this.talkObject(a,t)}}return n},domainObjectById:function(e,t){if(null==e)return null;var n="d_"+e.high+"_"+e.low,i=null!=ma[n]?t.getReserved(n):t.h[n];if(null==i){i=this.domainObject(this.dataStore.getDomain(e));var r=i;null!=ma[n]?t.setReserved(n,r):t.h[n]=r}return i},domainObject:function(e,t){null==t&&(t=!1);var n=null==e?null:JSON.parse(JSON.stringify(e));n.id_i64=e.id;var i=e.id;return n.id="_"+i.high+"_"+i.low,t&&(n.talks=this.talkObjects(e.id)),n},domainObjects:function(){for(var e={},t=0,n=this.dataStore.getDomains();t<n.length;){var i=n[t];++t;var r=i.id;e["_"+r.high+"_"+r.low]=this.domainObject(i)}return e},messageObject:function(e){var t=new kr,n=this.dataStore.getTalk(e.talkId),i=this.userObjectsByIds(n.domainId,[e.userId],t),r={};r.type=At.enumIndex(e.type);var a=e.content;r.content=null==a?null:JSON.parse(JSON.stringify(a));var o=e.createdAt;r.createdAt=null==o?null:JSON.parse(JSON.stringify(o));var s=e.id;r.id_i64=null==s?null:JSON.parse(JSON.stringify(s));var l=e.id;r.id="_"+l.high+"_"+l.low,r.user=i.length>0?i[0]:null;var u=e.userId;r.userId="_"+u.high+"_"+u.low,r.talk=this.talkObject(n,t);var c=e.talkId;return r.talkId="_"+c.high+"_"+c.low,r},__class__:ur});var cr=function(){vi.call(this,"messageEvent"),this.emitters=new kr};a["albero_cli.proxy.MessageEventProxy"]=cr,cr.__name__=["albero_cli","proxy","MessageEventProxy"],cr.__super__=vi,cr.prototype=n(vi.prototype,{registEmitter:function(e,t){_r.factory=this;var n=_r.createInstance(t);if(null!=n){var i=this.emitters;null!=ma[e]?i.setReserved(e,n):i.h[e]=n}},messageCreated:function(e,t){var n=this.emitters,i=null!=ma[t]?n.getReserved(t):n.h[t];if(null!=i&&(this.emitters.remove(t),null!=e)){var r=e.id,a="_"+r.high+"_"+r.low,o=this.emitters;if(null!=ma[a]?o.setReserved(a,i):o.h[a]=i,i.talk=this.dataStore.getTalk(e.talkId),i.setFirstReader(this.dataStore.me),i.emitOnSend(e),i.removeEventListener("send"),!i.hasEventListener()){var s=e.id;this.emitters.remove("_"+s.high+"_"+s.low)}}},messageRead:function(e,t,n,i){var r=this,a="_"+t.high+"_"+t.low,o=this.emitters,s=null!=ma[a]?o.getReserved(a):o.h[a];if(null!=s){s.emitOnRead(n,i);var l=s.__readerIds.length>=16;s.startTimer(l,function(n){n?r.messageReadEveryone(e,t):r.sendNotification("Read",de.READ_STATUS(e,t))}),0==s.__unreadIds.length&&this.messageReadEveryone(e,t)}},messageReadEveryone:function(e,t){if(null!=t)for(var n=this.emitters.keys();n.hasNext();){var i,r=n.next(),a=this.emitters,o=null!=ma[r]?a.getReserved(r):a.h[r];if(null!=o.talk){var s=o.talk.id;i=null!=s&&null!=e&&s.high==e.high&&s.low==e.low}else i=!1;if(i){var l=M.makeFromIdStr(r),u=l.high-t.high|0;u=0!=u?u:mr.ucompare(l.low,t.low),(l.high<0?t.high<0?u:-1:t.high>=0?u:1)<=0&&this._messageReadEveryone(e,r)}}},_messageReadEveryone:function(e,t){var n=this.emitters,i=null!=ma[t]?n.getReserved(t):n.h[t];null!=i&&(i.__unreadIds.length>0&&i.emitOnRead(i.__unreadIds),i.stopTimer(),i.removeEventListener("read"),i.hasEventListener()||this.emitters.remove(t))},deleteTalk:function(e){for(var t=this.emitters.keys();t.hasNext();){var n,i=t.next(),r=this.emitters,a=null!=ma[i]?r.getReserved(i):r.h[i];if(null!=a.talk){var o=a.talk.id;n=null!=o&&null!=e&&o.high==e.high&&o.low==e.low}else n=!1;n&&(a.stopTimer(),this.emitters.remove(i))}},leaveDomain:function(e){for(var t=this.emitters.keys();t.hasNext();){var n,i=t.next(),r=this.emitters,a=null!=ma[i]?r.getReserved(i):r.h[i];if(null!=a.talk){var o=a.talk.domainId;n=null!=o&&null!=e&&o.high==e.high&&o.low==e.low}else n=!1;n&&(a.stopTimer(),this.emitters.remove(i))}},__class__:cr});var _r=function(e){this.context=e,this.listeners=new kr,Object.defineProperty(this,"readUsers",{get:this.get_readUsers}),Object.defineProperty(this,"unreadUsers",{get:this.get_unreadUsers})};a["albero_cli.proxy.Emitter"]=_r,_r.__name__=["albero_cli","proxy","Emitter"],_r.createInstance=function(e){for(var t=null,n=g.fields(e),i=0;i<n.length;){var r=n[i];if(++i,S.startsWith(r,"on")){var a=g.field(e,r);g.isFunction(a)&&(g.deleteField(e,r),null==t&&(t=new _r(e)),t.addEventListener(_.substr(r,2,null),a))}}return t},_r.prototype={addEventListener:function(e,t){var n=this.listeners,i=t;null!=ma[e]?n.setReserved(e,i):n.h[e]=i},hasEventListener:function(){var e=this.listeners;return new Nr(e,e.arrayKeys()).hasNext()},removeEventListener:function(e){this.listeners.remove(e)},emit:function(e,t){var n=this.listeners,i=null!=ma[e]?n.getReserved(e):n.h[e];null!=i&&i.apply(this,t)},emitOnSend:function(e){this.message=this.get_message(e),this.emit("send",[this,e])},emitOnRead:function(e,t){var n=[];null!=t&&(this.__unreadIds=t);for(var i=0;i<e.length;){var r=e[i];++i,M.contains(this.__readerIds,r)||(this.__readerIds.push(r),n.push(r)),M.remove(this.__unreadIds,r)}n.length>0&&this.emit("read",[this.users(n),this.get_readUsers(),this.get_unreadUsers()])},setFirstReader:function(e){this.__readerIds=[e.id],this.__unreadIds=this.talk.userIds.slice(),M.remove(this.__unreadIds,e.id)},get_readUsers:function(){return this.users(this.__readerIds)},get_unreadUsers:function(){return this.users(this.__unreadIds)},users:function(e){return null==e?[]:_r.factory.hubotObject.userObjectsByIds(this.talk.domainId,e)},get_message:function(e){return _r.factory.hubotObject.messageObject(e)},answer:function(e){var t,n=this,i=At.typeOf(this.message.type),r=this.message.id.split("_");if(r.length>2){t=new Cn(v.parseInt(r[1]),v.parseInt(r[2]))}else t=null;switch(i[1]){case 12:case 14:case 16:case 17:case 18:case 19:var a=this.message.content.in_reply_to;t=new Cn(a.high,a.low)}var o=me.Question(t,function(t){var r=t.responses;switch(i[1]){case 11:case 12:case 17:var a=n.users(r[0].userIds),o=n.users(r[1].userIds);e(a,o);break;case 13:case 14:case 18:var s=r.map(function(e){return n.users(e.userIds)});e(s);break;case 15:case 16:case 19:var l=n.users(r[0].userIds),u=n.users(r[1].userIds);e(l,u)}});_r.factory.sendNotification("ReloadData",o)},startTimer:function(e,t){var n=this;null!=this.__readerTimer&&this.stopTimer(),this.__readerTimerWait=e?1:1440;var i=null;i=function(){n.__readerTimerWait*=2,n.__readerTimerWait<1440?(t(!1),n.__readerTimer=vr.delay(i,60*n.__readerTimerWait*1e3|0)):(t(!0),n.__readerTimer=null)},this.__readerTimer=vr.delay(i,60*this.__readerTimerWait*1e3|0)},stopTimer:function(){null!=this.__readerTimer&&(this.__readerTimer.stop(),this.__readerTimer=null)},__class__:_r};var hr=function(){vi.call(this,"sendQueue"),this.sendCount=0,this.sendMsgQueue=new dr(this,550,new ai("sendQueueMessage")),this.sendAnnounceQueue=new dr(this,5050,new ai("sendQueueAnnounce"))};a["albero_cli.proxy.SendQueueProxy"]=hr,hr.__name__=["albero_cli","proxy","SendQueueProxy"],hr.__super__=vi,hr.prototype=n(vi.prototype,{restart:function(){this.sendMsgQueue.sendNext(),this.sendAnnounceQueue.sendNext()},retryAfter:function(e){this.sendMsgQueue.retryAfter(e),this.sendAnnounceQueue.retryAfter(e)},sendNext:function(e){null!=e.talkId?this.sendMsgQueue.sendNext():this.sendAnnounceQueue.sendNext()},sendAnnouncement:function(e,t){this.send(e,null,t)},sendMessage:function(e,t){this.send(null,e,t)},send:function(e,t,n){if("string"!=typeof n){var i=new Cn(0,this.sendCount++),r=i;this.messageEvent.registEmitter("_"+r.high+"_"+r.low,n);var a=new At;if(a.id=r,a.domainId=e,a.talkId=t,a.content=this.parseContent(n),a.type=this.detectType(a.content),a.type==Nt.unknown)return;if(a.type==Nt.file&&null!=a.content.path)return void this.sendFile(t,a.content,"_"+r.high+"_"+r.low);a.type!=Nt.yesOrNo&&a.type!=Nt.selectOne||null!=a.content.listing||(a.content.listing=!1),this.applyLimitToMessage(a),this.pushQueue(a)}else for(var o=n,s=0,l=w.slice(o,1024);s<l.length;){var u=l[s];++s;var c=new At;c.domainId=e,c.talkId=t,c.type=Nt.text,c.content=u,this.pushQueue(c)}},sendFile:function(e,t,n){var i,r=null,a=null;if("string"==typeof t)i=t;else{if(t.path instanceof Array&&null==t.path.__enum__)return void this.sendFiles(e,t.path,t.name,t.type,t.text,n);if(null!=t.text)return void this.sendFiles(e,[t.path],[t.name],[t.type],t.text,n);i=t.path,r=t.name,a=t.type}if(null==i||!Hr.existsSync(i))return void si._e("["+_.dateStr(new Date)+"] ","File not found: ",i,"","","");this.sendMsgQueue.pushQueue("File",re.UPLOAD_PATH(e,i,r,a,n))},sendFiles:function(e,t,n,i,r,a){for(var o=0;o<t.length;){var s=t[o];if(++o,!Hr.existsSync(s))return void si._e("["+_.dateStr(new Date)+"] ","File not found: ",s,"","","")}var l=t.length;if(null==n){for(var u=[],c=0,h=l;c<h;){c++;u.push(null)}n=u}if(null==i){for(var d=[],f=0,m=l;f<m;){f++;d.push(null)}i=d}if(n.length!=l||i.length!=l)return void si._e("["+_.dateStr(new Date)+"] ","The length of name or type must be the same as path length.","","","","");this.sendMsgQueue.pushQueue("File",re.UPLOAD_MULTI_PATH(e,r,t,n,i,a))},pushQueue:function(e){null==e.talkId?this.sendAnnounceQueue.pushQueue("Send",e):this.sendMsgQueue.pushQueue("Send",e)},parseContent:function(e){if(null==e)return null;for(var t=g.fields(e),n=0;n<t.length;){var i=t[n];++n;var r=g.field(e,i);if("string"==typeof r){var a=null;if("stamp_set"==i)a=v.parseInt(r);else if("stamp_index"==i)a=M.parse(r);else if("file_id"==i||"in_reply_to"==i){var o=r.split("_");if(o.length>2){var s=new Cn(v.parseInt(o[1]),v.parseInt(o[2]));a=s}else a=null}else if("close_yesno"==i||"close_select"==i||"close_task"==i){e.close=_.substr(i,6,null),i="in_reply_to";var l=r.split("_");if(l.length>2){var u=new Cn(v.parseInt(l[1]),v.parseInt(l[2]));a=u}else a=null}null!=a&&(e[i]=a)}else if(null!=r&&g.isObject(e)&&null!=r.high&&null!=r.low){var c=new Cn(r.high,r.low);e[i]=c}}return 1==t.length&&null!=e.text?e.text:e},detectType:function(e){if(null==e)return Nt.unknown;if("string"==typeof e)return Nt.text;if(null!=e.stamp_set)return Nt.stamp;if(null!=e.lat)return Nt.geo;if(null!=e.file_id||null!=e.path)return Nt.file;if(null!=e.close){var t=e.close;if(g.deleteField(e,"close"),"yesno"==t)return Nt.yesOrNoClosed;if("select"==t)return Nt.selectOneClosed;if("task"==t)return Nt.todoClosed}else if(null!=e.in_reply_to){if("boolean"==typeof e.response)return Nt.yesOrNoReply;var n=e.response;if("number"==typeof n&&(0|n)===n)return Nt.selectOneReply;if(null!=e.done)return Nt.todoDone}else{if(null!=e.question)return null==e.options?Nt.yesOrNo:Nt.selectOne;if(null!=e.title)return Nt.todo}return Nt.unknown},applyLimitToMessage:function(e){switch(e.type[1]){case 1:var t=e.content;null!=t&&t.length>1024&&(e.content=t.substring(0,1024));break;case 2:case 5:var n=e.content.text;null!=n&&n.length>1024&&(e.content.text=n.substring(0,1024));break;case 11:case 13:var i=e.content.question;if(null!=i&&i.length>1024&&(e.content.question=i.substring(0,1024)),e.type==Nt.selectOne){var r=e.content.options;r.length>9&&(r=r.slice(0,9),e.content.options=r);for(var a=0,o=r.length;a<o;){var s=a++;r[s].length>64&&(r[s]=r[s].substring(0,64))}}break;case 15:var l=e.content.title;null!=l&&l.length>1024&&(e.content.title=l.substring(0,1024))}},__class__:hr});var dr=function(e,t,n){this.proxy=e,this.sendSpan=t,this.storage=n,this.sendQueue=this.loadQueue(),this.sending=this.sendQueue.length>0,this.lastSendNode=null,this.lastSendTime=new Date(0)};a["albero_cli.proxy._SendQueueProxy.SendQueue"]=dr,dr.__name__=["albero_cli","proxy","_SendQueueProxy","SendQueue"],dr.prototype={pushQueue:function(e,t){this.sendQueue.push({name:e,param:t}),this.saveQueue(),this.sending||(this.sending=!0,this.sendNext())},sendNext:function(){if(!this.sending||0==this.sendQueue.length)return void this.closeQueue();var e=(new Date).getTime()-this.lastSendTime.getTime(),t=0|Math.max(this.sendSpan-e,100);vr.delay(r(this,this.sendNotification),t)},retryAfter:function(e){if(!this.sending||null==this.lastSendNode)return void this.closeQueue();this.sendQueue.unshift(this.lastSendNode),this.saveQueue(),vr.delay(r(this,this.sendNotification),e)},sendNotification:function(){var e=this.sendQueue.shift();this.saveQueue(),this.proxy.sendNotification(e.name,e.param),this.lastSendNode=e,this.lastSendTime=new Date},closeQueue:function(){this.sending=!1,this.lastSendNode=null},saveQueue:function(){null!=this.storage&&this.storage.save(this.sendQueue)},loadQueue:function(){if(null!=this.storage){var e=this.storage.load();if(null!=e)return e}return[]},__class__:dr};var fr=function(){};a["haxe.IMap"]=fr,fr.__name__=["haxe","IMap"];var mr={};a["haxe._Int32.Int32_Impl_"]=mr,mr.__name__=["haxe","_Int32","Int32_Impl_"],mr.ucompare=function(e,t){return e<0?t<0?~t-~e|0:1:t<0?-1:e-t|0};var pr={};a["haxe._Int64.Int64_Impl_"]=pr,pr.__name__=["haxe","_Int64","Int64_Impl_"],pr.toString=function(e){var t=e,n=new Cn(0,0),i=n;if(t.high==i.high&&t.low==i.low)return"0";var r="",a=!1;t.high<0&&(a=!0);for(var o=new Cn(0,10),s=o;;){var l=new Cn(0,0),u=l;if(t.high==u.high&&t.low==u.low)break;var c=pr.divMod(t,s);if(c.modulus.high<0){var _=c.modulus,h=~_.high,d=-_.low;if(0==d){h++;h|=0}r=new Cn(h,d).low+r;var f=c.quotient,m=~f.high,p=-f.low;if(0==p){m++;m|=0}t=new Cn(m,p)}else r=c.modulus.low+r,t=c.quotient}return a&&(r="-"+r),r},pr.divMod=function(e,t){if(0==t.high){switch(t.low){case 0:throw new Br("divide by zero");case 1:return{quotient:new Cn(e.high,e.low),modulus:new Cn(0,0)}}}var n,i=e.high<0!=t.high<0;if(e.high<0){var r=~e.high,a=-e.low;if(0==a){r++;r|=0}n=new Cn(r,a)}else{n=new Cn(e.high,e.low)}if(t.high<0){var o=~t.high,s=-t.low;if(0==s){o++;o|=0}t=new Cn(o,s)}else t=t;for(var l=new Cn(0,0),u=l,c=new Cn(0,1),_=c;!(t.high<0);){var h=mr.ucompare(t.high,n.high),d=0!=h?h:mr.ucompare(t.low,n.low),f=1;if(0==(f&=63)){t=new Cn(t.high,t.low)}else if(f<32){var m=new Cn(t.high<<f|t.low>>>32-f,t.low<<f);t=m}else{var p=new Cn(t.low<<f-32,0);t=p}var g=1;if(0==(g&=63)){_=new Cn(_.high,_.low)}else if(g<32){var v=new Cn(_.high<<g|_.low>>>32-g,_.low<<g);_=v}else{var y=new Cn(_.low<<g-32,0);_=y}if(d>=0)break}for(;;){var S=new Cn(0,0),w=S;if(_.high==w.high&&_.low==w.low)break;var T=mr.ucompare(n.high,t.high);if((0!=T?T:mr.ucompare(n.low,t.low))>=0){u=new Cn(u.high|_.high,u.low|_.low);var I=n.high-t.high|0,E=n.low-t.low|0;if(mr.ucompare(n.low,t.low)<0){I--;I|=0}n=new Cn(I,E)}var b=1;if(0==(b&=63)){_=new Cn(_.high,_.low)}else if(b<32){var A=new Cn(_.high>>>b,_.high<<32-b|_.low>>>b);_=A}else{var N=new Cn(0,_.high>>>b-32);_=N}var k=1;if(0==(k&=63)){t=new Cn(t.high,t.low)}else if(k<32){var D=new Cn(t.high>>>k,t.high<<32-k|t.low>>>k);t=D}else{var C=new Cn(0,t.high>>>k-32);t=C}}if(i){var O=~u.high,R=-u.low;if(0==R){O++;O|=0}u=new Cn(O,R)}if(e.high<0){var M=~n.high,x=-n.low;if(0==x){M++;M|=0}n=new Cn(M,x)}return{quotient:u,modulus:n}};var gr=function(){this.buf=new y,this.cache=[],this.useCache=gr.USE_CACHE,this.useEnumIndex=gr.USE_ENUM_INDEX,this.shash=new kr,this.scount=0};a["haxe.Serializer"]=gr,gr.__name__=["haxe","Serializer"],gr.run=function(e){var t=new gr;return t.serialize(e),t.toString()},gr.prototype={toString:function(){return this.buf.b},serializeString:function(e){var t=this.shash,n=null!=ma[e]?t.getReserved(e):t.h[e];if(null!=n)return this.buf.b+="R",void(this.buf.b+=null==n?"null":""+n);var i=this.shash,r=this.scount++;null!=ma[e]?i.setReserved(e,r):i.h[e]=r,this.buf.b+="y",e=encodeURIComponent(e),this.buf.b+=v.string(e.length),this.buf.b+=":",this.buf.b+=null==e?"null":""+e},serializeRef:function(e){for(var t=typeof e,n=0,i=this.cache.length;n<i;){var r=n++,a=this.cache[r];if(typeof a==t&&a==e)return this.buf.b+="r",this.buf.b+=null==r?"null":""+r,!0}return this.cache.push(e),!1},serializeFields:function(e){for(var t=0,n=g.fields(e);t<n.length;){var i=n[t];++t,this.serializeString(i),this.serialize(g.field(e,i))}this.buf.b+="g"},serialize:function(e){var t=I.typeof(e);switch(t[1]){case 0:this.buf.b+="n";break;case 1:var n=e;if(0==n)return void(this.buf.b+="z");this.buf.b+="i",this.buf.b+=null==n?"null":""+n;break;case 2:var i=e;isNaN(i)?this.buf.b+="k":isFinite(i)?(this.buf.b+="d",this.buf.b+=null==i?"null":""+i):this.buf.b+=i<0?"m":"p";break;case 3:this.buf.b+=e?"t":"f";break;case 4:if(jr.__instanceof(e,da)){var r=I.getClassName(e);this.buf.b+="A",this.serializeString(r)}else if(jr.__instanceof(e,fa))this.buf.b+="B",this.serializeString(I.getEnumName(e));else{if(this.useCache&&this.serializeRef(e))return;this.buf.b+="o",this.serializeFields(e)}break;case 5:throw new Br("Cannot serialize function");case 6:var a=t[2];if(a==String)return void this.serializeString(e);if(this.useCache&&this.serializeRef(e))return;switch(a){case Array:var o=0;this.buf.b+="a";for(var s=e.length,l=0,u=s;l<u;){var c=l++;null==e[c]?++o:(o>0&&(1==o?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==o?"null":""+o),o=0),this.serialize(e[c]))}o>0&&(1==o?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==o?"null":""+o)),this.buf.b+="h";break;case Date:var h=e;this.buf.b+="v",this.buf.b+=v.string(h.getTime());break;case d:this.buf.b+="l";for(var f=e,m=f.h;null!=m;){var p=m.item;m=m.next;var y=p;this.serialize(y)}this.buf.b+="h";break;case Er:this.buf.b+="q";for(var S=e,w=S.keys();w.hasNext();){var T=w.next();this.buf.b+=":",this.buf.b+=null==T?"null":""+T,this.serialize(S.h[T])}this.buf.b+="h";break;case br:this.buf.b+="M";for(var E=e,b=E.keys();b.hasNext();){var A=b.next(),N=g.field(A,"__id__");g.deleteField(A,"__id__"),this.serialize(A),A.__id__=N,this.serialize(E.h[A.__id__])}this.buf.b+="h";break;case kr:this.buf.b+="b";for(var k=e,D=k.keys();D.hasNext();){var C=D.next();this.serializeString(C),this.serialize(null!=ma[C]?k.getReserved(C):k.h[C])}this.buf.b+="h";break;case Dr:var O=e;this.buf.b+="s",this.buf.b+=v.string(Math.ceil(8*O.length/6)),this.buf.b+=":";var R=0,M=O.length-2,x=gr.BASE64_CODES;if(null==x){var F=gr.BASE64.length;x=new Array(F);for(var U=0,P=gr.BASE64.length;U<P;){var L=U++;x[L]=_.cca(gr.BASE64,L)}gr.BASE64_CODES=x}for(;R<M;){var B=O.b[R++],j=O.b[R++],H=O.b[R++];this.buf.b+=String.fromCharCode(x[B>>2]),this.buf.b+=String.fromCharCode(x[63&(B<<4|j>>4)]),this.buf.b+=String.fromCharCode(x[63&(j<<2|H>>6)]),this.buf.b+=String.fromCharCode(x[63&H])}if(R==M){var z=O.b[R++],G=O.b[R++];this.buf.b+=String.fromCharCode(x[z>>2]),this.buf.b+=String.fromCharCode(x[63&(z<<4|G>>4)]),this.buf.b+=String.fromCharCode(x[G<<2&63])}else if(R==M+1){var W=O.b[R++];this.buf.b+=String.fromCharCode(x[W>>2]),this.buf.b+=String.fromCharCode(x[W<<4&63])}break;default:this.useCache&&this.cache.pop(),null!=e.hxSerialize?(this.buf.b+="C",this.serializeString(I.getClassName(a)),this.useCache&&this.cache.push(e),e.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(I.getClassName(a)),this.useCache&&this.cache.push(e),this.serializeFields(e))}break;case 7:var K=t[2];if(this.useCache){if(this.serializeRef(e))return;this.cache.pop()}this.buf.b+=v.string(this.useEnumIndex?"j":"w"),this.serializeString(I.getEnumName(K)),this.useEnumIndex?(this.buf.b+=":",this.buf.b+=v.string(e[1])):this.serializeString(e[0]),this.buf.b+=":";var Y=e.length;this.buf.b+=v.string(Y-2);for(var V=2,q=Y;V<q;){var Q=V++;this.serialize(e[Q])}this.useCache&&this.cache.push(e);break;default:throw new Br("Cannot serialize "+v.string(e))}},__class__:gr};var vr=function(e){var t=this;this.id=setInterval(function(){t.run()},e)};a["haxe.Timer"]=vr,vr.__name__=["haxe","Timer"],vr.delay=function(e,t){var n=new vr(t);return n.run=function(){n.stop(),e()},n},vr.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:vr};var yr=function(){};a["haxe._Unserializer.DefaultResolver"]=yr,yr.__name__=["haxe","_Unserializer","DefaultResolver"],yr.prototype={resolveClass:function(e){return I.resolveClass(e)},resolveEnum:function(e){return I.resolveEnum(e)},__class__:yr};var Sr=function(e){this.buf=e,this.length=e.length,this.pos=0,this.scache=[],this.cache=[];var t=Sr.DEFAULT_RESOLVER;null==t&&(t=new yr,Sr.DEFAULT_RESOLVER=t),this.resolver=t};a["haxe.Unserializer"]=Sr,Sr.__name__=["haxe","Unserializer"],Sr.initCodes=function(){for(var e=[],t=0,n=Sr.BASE64.length;t<n;){var i=t++;e[Sr.BASE64.charCodeAt(i)]=i}return e},Sr.run=function(e){return new Sr(e).unserialize()},Sr.prototype={readDigits:function(){for(var e=0,t=!1,n=this.pos;;){var i=this.buf.charCodeAt(this.pos);if(i!=i)break;if(45!=i){if(i<48||i>57)break;e=10*e+(i-48),this.pos++}else{if(this.pos!=n)break;t=!0,this.pos++}}return t&&(e*=-1),e},readFloat:function(){for(var e=this.pos;;){var t=this.buf.charCodeAt(this.pos);if(t!=t)break;if(!(t>=43&&t<58||101==t||69==t))break;this.pos++}return parseFloat(_.substr(this.buf,e,this.pos-e))},unserializeObject:function(e){for(;;){if(this.pos>=this.length)throw new Br("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var t=this.unserialize();if("string"!=typeof t)throw new Br("Invalid object key");var n=this.unserialize();e[t]=n}this.pos++},unserializeEnum:function(e,t){if(58!=this.buf.charCodeAt(this.pos++))throw new Br("Invalid enum format");var n=this.readDigits();if(0==n)return I.createEnum(e,t);for(var i=[];n-- >0;)i.push(this.unserialize());return I.createEnum(e,t,i)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var e=this.unserialize(),t=this.resolver.resolveClass(e);if(null==t)throw new Br("Class not found "+e);return t;case 66:var n=this.unserialize(),i=this.resolver.resolveEnum(n);if(null==i)throw new Br("Enum not found "+n);return i;case 67:var r=this.unserialize(),a=this.resolver.resolveClass(r);if(null==a)throw new Br("Class not found "+r);var o=I.createEmptyInstance(a);if(this.cache.push(o),o.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new Br("Invalid custom data");return o;case 77:var s=new br;for(this.cache.push(s),this.buf;104!=this.buf.charCodeAt(this.pos);){var l=this.unserialize();s.set(l,this.unserialize())}return this.pos++,s;case 82:var u=this.readDigits();if(u<0||u>=this.scache.length)throw new Br("Invalid string reference");return this.scache[u];case 97:var c=(this.buf,[]);for(this.cache.push(c);;){var h=this.buf.charCodeAt(this.pos);if(104==h){this.pos++;break}if(117==h){this.pos++;var f=this.readDigits();c[c.length+f-1]=null}else c.push(this.unserialize())}return c;case 98:var m=new kr;for(this.cache.push(m),this.buf;104!=this.buf.charCodeAt(this.pos);){var p=this.unserialize(),g=this.unserialize();null!=ma[p]?m.setReserved(p,g):m.h[p]=g}return this.pos++,m;case 99:var v=this.unserialize(),y=this.resolver.resolveClass(v);if(null==y)throw new Br("Class not found "+v);var S=I.createEmptyInstance(y);return this.cache.push(S),this.unserializeObject(S),S;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var w=this.unserialize(),T=this.resolver.resolveEnum(w);if(null==T)throw new Br("Enum not found "+w);this.pos++;var E=this.readDigits(),b=T.__constructs__.slice()[E];if(null==b)throw new Br("Unknown enum index "+w+"@"+E);var A=this.unserializeEnum(T,b);return this.cache.push(A),A;case 107:return NaN;case 108:var N=new d;for(this.cache.push(N),this.buf;104!=this.buf.charCodeAt(this.pos);)N.add(this.unserialize());return this.pos++,N;case 109:return-1/0;case 110:return null;case 111:var k={};return this.cache.push(k),this.unserializeObject(k),k;case 112:return 1/0;case 113:var D=new Er;this.cache.push(D);for(var C=(this.buf,this.buf.charCodeAt(this.pos++));58==C;){var O=this.readDigits(),R=this.unserialize();D.h[O]=R,C=this.buf.charCodeAt(this.pos++)}if(104!=C)throw new Br("Invalid IntMap format");return D;case 114:var M=this.readDigits();if(M<0||M>=this.cache.length)throw new Br("Invalid reference");return this.cache[M];case 115:var x=this.readDigits(),F=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<x)throw new Br("Invalid bytes length");var U=Sr.CODES;null==U&&(U=Sr.initCodes(),Sr.CODES=U);for(var P=this.pos,L=3&x,B=3*(x>>2)+(L>=2?L-1:0),j=P+(x-L),H=new Dr(new ArrayBuffer(B)),z=0;P<j;){var G=U[F.charCodeAt(P++)],W=U[F.charCodeAt(P++)];H.b[z++]=255&(G<<2|W>>4);var K=U[F.charCodeAt(P++)];H.b[z++]=255&(W<<4|K>>2);var Y=U[F.charCodeAt(P++)];H.b[z++]=255&(K<<6|Y)}if(L>=2){var V=U[F.charCodeAt(P++)],q=U[F.charCodeAt(P++)];if(H.b[z++]=255&(V<<2|q>>4),3==L){var Q=U[F.charCodeAt(P++)];H.b[z++]=255&(q<<4|Q>>2)}}return this.pos+=x,this.cache.push(H),H;case 116:return!0;case 118:var J;if(this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4))J=_.strDate(_.substr(this.buf,this.pos,19)),this.pos+=19;else{var X=this.readFloat();J=new Date(X)}return this.cache.push(J),J;case 119:var Z=this.unserialize(),$=this.resolver.resolveEnum(Z);if(null==$)throw new Br("Enum not found "+Z);var ee=this.unserializeEnum($,this.unserialize());return this.cache.push(ee),ee;case 120:throw Br.wrap(this.unserialize());case 121:var te=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<te)throw new Br("Invalid string length");var ne=_.substr(this.buf,this.pos,te);return this.pos+=te,ne=decodeURIComponent(ne.split("+").join(" ")),this.scache.push(ne),ne;case 122:return 0}throw this.pos--,new Br("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:Sr};var wr=function(){};a["haxe.ds.BalancedTree"]=wr,wr.__name__=["haxe","ds","BalancedTree"],wr.prototype={set:function(e,t){this.root=this.setLoop(e,t,this.root)},get:function(e){for(var t=this.root;null!=t;){var n=this.compare(e,t.key);if(0==n)return t.value;t=n<0?t.left:t.right}return null},remove:function(e){try{return this.root=this.removeLoop(e,this.root),!0}catch(e){if(e instanceof Br&&(e=e.val),jr.__instanceof(e,String))return!1;throw e}},keys:function(){var e=[];return this.keysLoop(this.root,e),_.iter(e)},setLoop:function(e,t,n){if(null==n)return new Tr(null,e,t,null);var i=this.compare(e,n.key);if(0==i)return new Tr(n.left,e,t,n.right,null==n?0:n._height);if(i<0){var r=this.setLoop(e,t,n.left);return this.balance(r,n.key,n.value,n.right)}var a=this.setLoop(e,t,n.right);return this.balance(n.left,n.key,n.value,a)},removeLoop:function(e,t){if(null==t)throw new Br("Not_found");var n=this.compare(e,t.key);return 0==n?this.merge(t.left,t.right):n<0?this.balance(this.removeLoop(e,t.left),t.key,t.value,t.right):this.balance(t.left,t.key,t.value,this.removeLoop(e,t.right))},keysLoop:function(e,t){null!=e&&(this.keysLoop(e.left,t),t.push(e.key),this.keysLoop(e.right,t))},merge:function(e,t){if(null==e)return t;if(null==t)return e;var n=this.minBinding(t);return this.balance(e,n.key,n.value,this.removeMinBinding(t))},minBinding:function(e){if(null==e)throw new Br("Not_found");return null==e.left?e:this.minBinding(e.left)},removeMinBinding:function(e){return null==e.left?e.right:this.balance(this.removeMinBinding(e.left),e.key,e.value,e.right)},balance:function(e,t,n,i){var r=null==e?0:e._height,a=null==i?0:i._height;if(r>a+2){var o=e.left,s=e.right;return(null==o?0:o._height)>=(null==s?0:s._height)?new Tr(e.left,e.key,e.value,new Tr(e.right,t,n,i)):new Tr(new Tr(e.left,e.key,e.value,e.right.left),e.right.key,e.right.value,new Tr(e.right.right,t,n,i))}if(a>r+2){var l=i.right,u=i.left;return(null==l?0:l._height)>(null==u?0:u._height)?new Tr(new Tr(e,t,n,i.left),i.key,i.value,i.right):new Tr(new Tr(e,t,n,i.left.left),i.left.key,i.left.value,new Tr(i.left.right,i.key,i.value,i.right))}return new Tr(e,t,n,i,(r>a?r:a)+1)},compare:function(e,t){return g.compare(e,t)},__class__:wr};var Tr=function(e,t,n,i,r){if(null==r&&(r=-1),this.left=e,this.key=t,this.value=n,this.right=i,-1==r){var a,o=this.left,s=this.right;if((null==o?0:o._height)>(null==s?0:s._height)){var l=this.left;a=null==l?0:l._height}else{var u=this.right;a=null==u?0:u._height}this._height=a+1}else this._height=r};a["haxe.ds.TreeNode"]=Tr,Tr.__name__=["haxe","ds","TreeNode"],Tr.prototype={__class__:Tr};var Ir=function(){wr.call(this)};a["haxe.ds.EnumValueMap"]=Ir,Ir.__name__=["haxe","ds","EnumValueMap"],Ir.__interfaces__=[fr],Ir.__super__=wr,Ir.prototype=n(wr.prototype,{compare:function(e,t){var n=e[1]-t[1];if(0!=n)return n;var i=e.slice(2),r=t.slice(2);return 0==i.length&&0==r.length?0:this.compareArgs(i,r)},compareArgs:function(e,t){var n=e.length-t.length;if(0!=n)return n;for(var i=0,r=e.length;i<r;){var a=i++,o=this.compareArg(e[a],t[a]);if(0!=o)return o}return 0},compareArg:function(e,t){return g.isEnumValue(e)&&g.isEnumValue(t)?this.compare(e,t):e instanceof Array&&null==e.__enum__&&t instanceof Array&&null==t.__enum__?this.compareArgs(e,t):g.compare(e,t)},__class__:Ir});var Er=function(){this.h={}};a["haxe.ds.IntMap"]=Er,Er.__name__=["haxe","ds","IntMap"],Er.__interfaces__=[fr],Er.prototype={remove:function(e){return!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(0|t);return _.iter(e)},__class__:Er};var br=function(){this.h={__keys__:{}}};a["haxe.ds.ObjectMap"]=br,br.__name__=["haxe","ds","ObjectMap"],br.__interfaces__=[fr],br.assignId=function(e){return e.__id__=++br.count},br.getId=function(e){return e.__id__},br.prototype={set:function(e,t){var n=e.__id__||(e.__id__=++br.count);this.h[n]=t,this.h.__keys__[n]=e},keys:function(){var e=[];for(var t in this.h.__keys__)this.h.hasOwnProperty(t)&&e.push(this.h.__keys__[t]);return _.iter(e)},__class__:br};var Ar=a["haxe.ds.Option"]={__ename__:["haxe","ds","Option"],__constructs__:["Some","None"]};Ar.Some=function(e){var t=["Some",0,e];return t.__enum__=Ar,t.toString=o,t},Ar.None=["None",1],Ar.None.toString=o,Ar.None.__enum__=Ar,Ar.__empty_constructs__=[Ar.None];var Nr=function(e,t){this.map=e,this.keys=t,this.index=0,this.count=t.length};a["haxe.ds._StringMap.StringMapIterator"]=Nr,Nr.__name__=["haxe","ds","_StringMap","StringMapIterator"],Nr.prototype={hasNext:function(){return this.index<this.count},next:function(){var e=this.map,t=this.keys[this.index++];return null!=ma[t]?e.getReserved(t):e.h[t]},__class__:Nr};var kr=function(){this.h={}};a["haxe.ds.StringMap"]=kr,kr.__name__=["haxe","ds","StringMap"],kr.__interfaces__=[fr],kr.prototype={setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},
getReserved:function(e){return null==this.rh?null:this.rh["$"+e]},existsReserved:function(e){return null!=this.rh&&this.rh.hasOwnProperty("$"+e)},remove:function(e){return null!=ma[e]?(e="$"+e,!(null==this.rh||!this.rh.hasOwnProperty(e))&&(delete this.rh[e],!0)):!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){return _.iter(this.arrayKeys())},arrayKeys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(t);if(null!=this.rh)for(var t in this.rh)36==t.charCodeAt(0)&&e.push(t.substr(1));return e},iterator:function(){return new Nr(this,this.arrayKeys())},__class__:kr};var Dr=function(e){this.length=e.byteLength,this.b=new Uint8Array(e),this.b.bufferValue=e,e.hxBytes=this,e.bytes=this.b};a["haxe.io.Bytes"]=Dr,Dr.__name__=["haxe","io","Bytes"],Dr.alloc=function(e){return new Dr(new ArrayBuffer(e))},Dr.ofString=function(e){for(var t=[],n=0;n<e.length;){var i=e.charCodeAt(n++);55296<=i&&i<=56319&&(i=i-55232<<10|1023&e.charCodeAt(n++)),i<=127?t.push(i):i<=2047?(t.push(192|i>>6),t.push(128|63&i)):i<=65535?(t.push(224|i>>12),t.push(128|i>>6&63),t.push(128|63&i)):(t.push(240|i>>18),t.push(128|i>>12&63),t.push(128|i>>6&63),t.push(128|63&i))}return new Dr(new Uint8Array(t).buffer)},Dr.ofData=function(e){var t=e.hxBytes;return null!=t?t:new Dr(e)},Dr.fastGet=function(e,t){return e.bytes[t]},Dr.prototype={getString:function(e,t){if(e<0||t<0||e+t>this.length)throw new Br(Ur.OutsideBounds);for(var n="",i=this.b,r=String.fromCharCode,a=e,o=e+t;a<o;){var s=i[a++];if(s<128){if(0==s)break;n+=r(s)}else if(s<224)n+=r((63&s)<<6|127&i[a++]);else if(s<240){var l=i[a++];n+=r((31&s)<<12|(127&l)<<6|127&i[a++])}else{var u=i[a++],c=i[a++],_=(15&s)<<18|(127&u)<<12|(127&c)<<6|127&i[a++];n+=r(55232+(_>>10)),n+=r(1023&_|56320)}}return n},toString:function(){return this.getString(0,this.length)},__class__:Dr};var Cr=function(){this.b=[]};a["haxe.io.BytesBuffer"]=Cr,Cr.__name__=["haxe","io","BytesBuffer"],Cr.prototype={getBytes:function(){var e=new Dr(new Uint8Array(this.b).buffer);return this.b=null,e},__class__:Cr};var Or=function(){};a["haxe.io.Input"]=Or,Or.__name__=["haxe","io","Input"],Or.prototype={readByte:function(){throw new Br("Not implemented")},readBytes:function(e,t,n){var i=n,r=e.b;if(t<0||n<0||t+n>e.length)throw new Br(Ur.OutsideBounds);try{for(;i>0;)r[t]=this.readByte(),++t,--i}catch(e){if(e instanceof Br&&(e=e.val),!jr.__instanceof(e,Fr))throw e}return n-i},set_bigEndian:function(e){return this.bigEndian=e,e},read:function(e){for(var t=new Dr(new ArrayBuffer(e)),n=0;e>0;){var i=this.readBytes(t,n,e);if(0==i)throw new Br(Ur.Blocked);n+=i,e-=i}return t},readFloat:function(){return Pr.i32ToFloat(this.readInt32())},readDouble:function(){var e=this.readInt32(),t=this.readInt32();return this.bigEndian?Pr.i64ToDouble(t,e):Pr.i64ToDouble(e,t)},readInt8:function(){var e=this.readByte();return e>=128?e-256:e},readInt16:function(){var e=this.readByte(),t=this.readByte(),n=this.bigEndian?t|e<<8:e|t<<8;return 0!=(32768&n)?n-65536:n},readUInt16:function(){var e=this.readByte(),t=this.readByte();return this.bigEndian?t|e<<8:e|t<<8},readInt32:function(){var e=this.readByte(),t=this.readByte(),n=this.readByte(),i=this.readByte();return this.bigEndian?i|n<<8|t<<16|e<<24:e|t<<8|n<<16|i<<24},__class__:Or};var Rr=function(e,t,n){if(null==t&&(t=0),null==n&&(n=e.length-t),t<0||n<0||t+n>e.length)throw new Br(Ur.OutsideBounds);this.b=e.b,this.pos=t,this.len=n,this.totlen=n};a["haxe.io.BytesInput"]=Rr,Rr.__name__=["haxe","io","BytesInput"],Rr.__super__=Or,Rr.prototype=n(Or.prototype,{readByte:function(){if(0==this.len)throw new Br(new Fr);return this.len--,this.b[this.pos++]},readBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw new Br(Ur.OutsideBounds);if(0==this.len&&n>0)throw new Br(new Fr);this.len<n&&(n=this.len);for(var i=this.b,r=e.b,a=0,o=n;a<o;){var s=a++;r[t+s]=i[this.pos+s]}return this.pos+=n,this.len-=n,n},__class__:Rr});var Mr=function(){};a["haxe.io.Output"]=Mr,Mr.__name__=["haxe","io","Output"],Mr.prototype={writeByte:function(e){throw new Br("Not implemented")},writeBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw new Br(Ur.OutsideBounds);for(var i=e.b,r=n;r>0;)this.writeByte(i[t]),++t,--r;return n},set_bigEndian:function(e){return this.bigEndian=e,e},write:function(e){for(var t=e.length,n=0;t>0;){var i=this.writeBytes(e,n,t);if(0==i)throw new Br(Ur.Blocked);n+=i,t-=i}},writeFloat:function(e){this.writeInt32(Pr.floatToI32(e))},writeDouble:function(e){var t=Pr.doubleToI64(e);this.bigEndian?(this.writeInt32(t.high),this.writeInt32(t.low)):(this.writeInt32(t.low),this.writeInt32(t.high))},writeInt8:function(e){if(e<-128||e>=128)throw new Br(Ur.Overflow);this.writeByte(255&e)},writeInt16:function(e){if(e<-32768||e>=32768)throw new Br(Ur.Overflow);this.writeUInt16(65535&e)},writeUInt16:function(e){if(e<0||e>=65536)throw new Br(Ur.Overflow);this.bigEndian?(this.writeByte(e>>8),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8))},writeInt32:function(e){this.bigEndian?(this.writeByte(e>>>24),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8&255),this.writeByte(e>>16&255),this.writeByte(e>>>24))},__class__:Mr};var xr=function(){this.b=new Cr};a["haxe.io.BytesOutput"]=xr,xr.__name__=["haxe","io","BytesOutput"],xr.__super__=Mr,xr.prototype=n(Mr.prototype,{writeByte:function(e){this.b.b.push(e)},writeBytes:function(e,t,n){var i=this.b;if(t<0||n<0||t+n>e.length)throw new Br(Ur.OutsideBounds);for(var r=(i.b,e.b),a=t,o=t+n;a<o;){var s=a++;i.b.push(r[s])}return n},getBytes:function(){return this.b.getBytes()},__class__:xr});var Fr=function(){};a["haxe.io.Eof"]=Fr,Fr.__name__=["haxe","io","Eof"],Fr.prototype={toString:function(){return"Eof"},__class__:Fr};var Ur=a["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};Ur.Blocked=["Blocked",0],Ur.Blocked.toString=o,Ur.Blocked.__enum__=Ur,Ur.Overflow=["Overflow",1],Ur.Overflow.toString=o,Ur.Overflow.__enum__=Ur,Ur.OutsideBounds=["OutsideBounds",2],Ur.OutsideBounds.toString=o,Ur.OutsideBounds.__enum__=Ur,Ur.Custom=function(e){var t=["Custom",3,e];return t.__enum__=Ur,t.toString=o,t},Ur.__empty_constructs__=[Ur.Blocked,Ur.Overflow,Ur.OutsideBounds];var Pr=function(){};a["haxe.io.FPHelper"]=Pr,Pr.__name__=["haxe","io","FPHelper"],Pr.i32ToFloat=function(e){var t=1-(e>>>31<<1),n=e>>>23&255,i=8388607&e;return 0==i&&0==n?0:t*(1+Math.pow(2,-23)*i)*Math.pow(2,n-127)},Pr.floatToI32=function(e){if(0==e)return 0;var t=e<0?-e:e,n=Math.floor(Math.log(t)/.6931471805599453);n<-127?n=-127:n>128&&(n=128);var i=Math.round(8388608*(t/Math.pow(2,n)-1));return 8388608==i&&n<128&&(i=0,++n),(e<0?-2147483648:0)|n+127<<23|i},Pr.i64ToDouble=function(e,t){var n=1-(t>>>31<<1),i=(t>>20&2047)-1023,r=4294967296*(1048575&t)+2147483648*(e>>>31)+(2147483647&e);return 0==r&&-1023==i?0:n*(1+Math.pow(2,-52)*r)*Math.pow(2,i)},Pr.doubleToI64=function(e){var t=Pr.i64tmp;if(0==e)t.low=0,t.high=0;else if(isFinite(e)){var n=e<0?-e:e,i=Math.floor(Math.log(n)/.6931471805599453),r=Math.round(4503599627370496*(n/Math.pow(2,i)-1)),a=0|r,o=r/4294967296|0;t.low=a,t.high=(e<0?-2147483648:0)|i+1023<<20|o}else e>0?(t.low=0,t.high=2146435072):(t.low=0,t.high=-1048576);return t};var Lr=function(){};a["haxe.rtti.Meta"]=Lr,Lr.__name__=["haxe","rtti","Meta"],Lr.getMeta=function(e){return e.__meta__},Lr.getFields=function(e){var t=Lr.getMeta(e);return null==t||null==t.fields?{}:t.fields};var Br=function(e){Error.call(this),this.val=e,this.message=String(e),Error.captureStackTrace&&Error.captureStackTrace(this,Br)};a["js._Boot.HaxeError"]=Br,Br.__name__=["js","_Boot","HaxeError"],Br.wrap=function(e){return e instanceof Error?e:new Br(e)},Br.__super__=Error,Br.prototype=n(Error.prototype,{__class__:Br});var jr=function(){};a["js.Boot"]=jr,jr.__name__=["js","Boot"],jr.getClass=function(e){if(e instanceof Array&&null==e.__enum__)return Array;var t=e.__class__;if(null!=t)return t;var n=jr.__nativeClassName(e);return null!=n?jr.__resolveNativeClass(n):null},jr.__string_rec=function(e,t){if(null==e)return"null";if(t.length>=5)return"<...>";var n=typeof e;switch("function"==n&&(e.__name__||e.__ename__)&&(n="object"),n){case"function":return"<function>";case"object":if(e instanceof Array){if(e.__enum__){if(2==e.length)return e[0];var i=e[0]+"(";t+="\t";for(var r=2,a=e.length;r<a;){var o=r++;i+=2!=o?","+jr.__string_rec(e[o],t):jr.__string_rec(e[o],t)}return i+")"}var s=e.length,l="[";t+="\t";for(var u=0,c=s;u<c;){var _=u++;l+=(_>0?",":"")+jr.__string_rec(e[_],t)}return l+="]"}var h;try{h=e.toString}catch(e){return"???"}if(null!=h&&h!=Object.toString&&"function"==typeof h){var d=e.toString();if("[object Object]"!=d)return d}var f=null,m="{\n";t+="\t";var p=null!=e.hasOwnProperty;for(var f in e)p&&!e.hasOwnProperty(f)||"prototype"!=f&&"__class__"!=f&&"__super__"!=f&&"__interfaces__"!=f&&"__properties__"!=f&&(2!=m.length&&(m+=", \n"),m+=t+f+" : "+jr.__string_rec(e[f],t));return t=t.substring(1),m+="\n"+t+"}";case"string":return e;default:return String(e)}},jr.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;var n=e.__interfaces__;if(null!=n)for(var i=0,r=n.length;i<r;){var a=i++,o=n[a];if(o==t||jr.__interfLoop(o,t))return!0}return jr.__interfLoop(e.__super__,t)},jr.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array&&null==e.__enum__;case ha:return"boolean"==typeof e;case ca:return!0;case _a:return"number"==typeof e;case ua:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(e instanceof t)return!0;if(jr.__interfLoop(jr.getClass(e),t))return!0}else if("object"==typeof t&&jr.__isNativeObj(t)&&e instanceof t)return!0;return t==da&&null!=e.__name__||(t==fa&&null!=e.__ename__||e.__enum__==t)}},jr.__cast=function(e,t){if(jr.__instanceof(e,t))return e;throw new Br("Cannot cast "+v.string(e)+" to "+v.string(t))},jr.__nativeClassName=function(e){var t=jr.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},jr.__isNativeObj=function(e){return null!=jr.__nativeClassName(e)},jr.__resolveNativeClass=function(e){return t[e]};var Hr=require("fs"),zr=require("https"),Gr=require("os"),Wr=require("path"),Kr=require("url"),Yr=require("buffer").Buffer,Vr=function(e,t){var n=new Rr(e);n.set_bigEndian(!0),this.o=this.decode(n,t)};a["msgpack.Decoder"]=Vr,Vr.__name__=["msgpack","Decoder"],Vr.prototype={decode:function(e,t){try{var n=e.readByte();switch(n){case 192:return null;case 194:return!1;case 195:return!0;case 202:return e.readFloat();case 203:return e.readDouble();case 204:return e.readByte();case 205:return e.readUInt16();case 206:return e.readInt32();case 207:return new Cn(e.readInt32(),e.readInt32());case 208:return e.readInt8();case 209:return e.readInt16();case 210:return e.readInt32();case 211:return new Cn(e.readInt32(),e.readInt32());case 218:case 219:return e.read(218==n?e.readUInt16():e.readInt32()).toString();case 220:case 221:return this.readArray(e,220==n?e.readUInt16():e.readInt32(),t);case 222:case 223:return this.readMap(e,222==n?e.readUInt16():e.readInt32(),t);default:if(n<128)return n;if(n<144)return this.readMap(e,15&n,t);if(n<160)return this.readArray(e,15&n,t);if(n<192)return e.read(31&n).toString();if(n>223)return-256|n}}catch(e){if(e instanceof Br&&(e=e.val),!jr.__instanceof(e,Fr))throw e}return null},readArray:function(e,t,n){for(var i=[],r=0,a=t;r<a;){r++;i.push(this.decode(e,n))}return i},readMap:function(e,t,n){if(n){for(var i={},r=0,a=t;r<a;){var o=(r++,this.decode(e,n)),s=this.decode(e,n);i[o]=s}return i}for(var l=new br,u=0,c=t;u<c;){var _=(u++,this.decode(e,n)),h=this.decode(e,n);l.set(_,h)}return l},getResult:function(){return this.o},__class__:Vr};var qr=function(e){this.o=new xr,this.o.set_bigEndian(!0),this.encode(e)};a["msgpack.Encoder"]=qr,qr.__name__=["msgpack","Encoder"],qr.prototype={encode:function(e){var t=I.typeof(e);switch(t[1]){case 0:this.o.writeByte(192);break;case 1:var n=e;n<-32?n<-32768?(this.o.writeByte(210),this.o.writeInt32(n)):n<-128?(this.o.writeByte(209),this.o.writeInt16(n)):(this.o.writeByte(208),this.o.writeInt8(n)):n<128?this.o.writeByte(255&n):n<256?(this.o.writeByte(204),this.o.writeByte(n)):n<65536?(this.o.writeByte(205),this.o.writeUInt16(n)):(this.o.writeByte(206),this.o.writeInt32(n));break;case 2:var i=e,r=Math.abs(i);r>1.401298464324817e-45&&r<3.4028234663852886e38?(this.o.writeByte(202),this.o.writeFloat(i)):(this.o.writeByte(203),this.o.writeDouble(i));break;case 3:this.o.writeByte(e?195:194);break;case 4:var a=g.fields(e),o=h.count(a);o<16?this.o.writeByte(128|o):o<65536?(this.o.writeByte(222),this.o.writeUInt16(o)):(this.o.writeByte(223),this.o.writeInt32(o));for(var s=0;s<a.length;){var l=a[s];++s;var u=Dr.ofString(l),c=u.length;c<32?this.o.writeByte(160|c):c<65536?(this.o.writeByte(218),this.o.writeUInt16(c)):(this.o.writeByte(219),this.o.writeInt32(c)),this.o.write(u),this.encode(g.field(e,l))}break;case 5:throw new Br("Error: Function not supported");case 6:var _=t[2];switch(I.getClassName(_)){case"Array":var d=e,f=d.length;f<16?this.o.writeByte(144|f):f<65536?(this.o.writeByte(220),this.o.writeUInt16(f)):(this.o.writeByte(221),this.o.writeInt32(f));for(var m=0;m<d.length;){var p=d[m];++m,this.encode(p)}break;case"Hash":var v=e,y=h.count(v);y<16?this.o.writeByte(128|y):y<65536?(this.o.writeByte(222),this.o.writeUInt16(y)):(this.o.writeByte(223),this.o.writeInt32(y));for(var S=v.keys();S.hasNext();){var w=S.next(),T=Dr.ofString(w),E=T.length;E<32?this.o.writeByte(160|E):E<65536?(this.o.writeByte(218),this.o.writeUInt16(E)):(this.o.writeByte(219),this.o.writeInt32(E)),this.o.write(T),this.encode(null!=ma[w]?v.getReserved(w):v.h[w])}break;case"String":var b=Dr.ofString(e),A=b.length;A<32?this.o.writeByte(160|A):A<65536?(this.o.writeByte(218),this.o.writeUInt16(A)):(this.o.writeByte(219),this.o.writeInt32(A)),this.o.write(b);break;case"haxe._Int64.___Int64":var N=e;this.o.writeByte(N.high<0?211:207),this.o.writeInt32(N.high),this.o.writeInt32(N.low)}break;case 7:throw new Br("Error: Enum not supported");case 8:throw new Br("Error: Unknown Data Type")}},writeInt:function(e){e<-32?e<-32768?(this.o.writeByte(210),this.o.writeInt32(e)):e<-128?(this.o.writeByte(209),this.o.writeInt16(e)):(this.o.writeByte(208),this.o.writeInt8(e)):e<128?this.o.writeByte(255&e):e<256?(this.o.writeByte(204),this.o.writeByte(e)):e<65536?(this.o.writeByte(205),this.o.writeUInt16(e)):(this.o.writeByte(206),this.o.writeInt32(e))},writeInt64:function(e){this.o.writeByte(e.high<0?211:207),this.o.writeInt32(e.high),this.o.writeInt32(e.low)},writeFloat:function(e){var t=Math.abs(e);t>1.401298464324817e-45&&t<3.4028234663852886e38?(this.o.writeByte(202),this.o.writeFloat(e)):(this.o.writeByte(203),this.o.writeDouble(e))},writeRaw:function(e){var t=e.length;t<32?this.o.writeByte(160|t):t<65536?(this.o.writeByte(218),this.o.writeUInt16(t)):(this.o.writeByte(219),this.o.writeInt32(t)),this.o.write(e)},writeArray:function(e){var t=e.length;t<16?this.o.writeByte(144|t):t<65536?(this.o.writeByte(220),this.o.writeUInt16(t)):(this.o.writeByte(221),this.o.writeInt32(t));for(var n=0;n<e.length;){var i=e[n];++n,this.encode(i)}},writeMapLength:function(e){e<16?this.o.writeByte(128|e):e<65536?(this.o.writeByte(222),this.o.writeUInt16(e)):(this.o.writeByte(223),this.o.writeInt32(e))},writeHashMap:function(e){var t=h.count(e);t<16?this.o.writeByte(128|t):t<65536?(this.o.writeByte(222),this.o.writeUInt16(t)):(this.o.writeByte(223),this.o.writeInt32(t));for(var n=e.keys();n.hasNext();){var i=n.next(),r=Dr.ofString(i),a=r.length;a<32?this.o.writeByte(160|a):a<65536?(this.o.writeByte(218),this.o.writeUInt16(a)):(this.o.writeByte(219),this.o.writeInt32(a)),this.o.write(r),this.encode(null!=ma[i]?e.getReserved(i):e.h[i])}},writeObjectMap:function(e){var t=g.fields(e),n=h.count(t);n<16?this.o.writeByte(128|n):n<65536?(this.o.writeByte(222),this.o.writeUInt16(n)):(this.o.writeByte(223),this.o.writeInt32(n));for(var i=0;i<t.length;){var r=t[i];++i;var a=Dr.ofString(r),o=a.length;o<32?this.o.writeByte(160|o):o<65536?(this.o.writeByte(218),this.o.writeUInt16(o)):(this.o.writeByte(219),this.o.writeInt32(o)),this.o.write(a),this.encode(g.field(e,r))}},getBytes:function(){return this.o.getBytes()},__class__:qr};var Qr=function(){};a["msgpack.MsgPack"]=Qr,Qr.__name__=["msgpack","MsgPack"],Qr.encode=function(e){return new qr(e).o.getBytes()},Qr.decode=function(e,t){return null==t&&(t=!0),new Vr(e,t).o};var Jr=function(){};a["puremvc.interfaces.IController"]=Jr,Jr.__name__=["puremvc","interfaces","IController"],Jr.prototype={__class__:Jr};var Xr=function(){Xr.instance=this,this.commandMap=new kr,this.initializeController()};a["puremvc.core.Controller"]=Xr,Xr.__name__=["puremvc","core","Controller"],Xr.__interfaces__=[Jr],Xr.getInstance=function(){return null==Xr.instance&&(Xr.instance=new Xr),Xr.instance},Xr.prototype={initializeController:function(){this.view=ta.getInstance()},executeCommand:function(e){var t=this.commandMap,n=e.getName(),i=null!=ma[n]?t.getReserved(n):t.h[n];if(null!=i){I.createInstance(i,[]).execute(e)}},registerCommand:function(e,t){var n=this.commandMap;(null!=ma[e]?n.existsReserved(e):n.h.hasOwnProperty(e))||this.view.registerObserver(e,new aa(r(this,this.executeCommand),this));var i=this.commandMap;null!=ma[e]?i.setReserved(e,t):i.h[e]=t},hasCommand:function(e){var t=this.commandMap;return null!=ma[e]?t.existsReserved(e):t.h.hasOwnProperty(e)},removeCommand:function(e){this.hasCommand(e)&&(this.view.removeObserver(e,this),this.commandMap.remove(e))},__class__:Xr};var Zr=function(){};a["puremvc.interfaces.IModel"]=Zr,Zr.__name__=["puremvc","interfaces","IModel"],Zr.prototype={__class__:Zr};var $r=function(){$r.instance=this,this.proxyMap=new kr,this.initializeModel()};a["puremvc.core.Model"]=$r,$r.__name__=["puremvc","core","Model"],$r.__interfaces__=[Zr],$r.getInstance=function(){return null==$r.instance&&($r.instance=new $r),$r.instance},$r.prototype={initializeModel:function(){},registerProxy:function(e){var t=this.proxyMap,n=e.getProxyName();null!=ma[n]?t.setReserved(n,e):t.h[n]=e,e.onRegister()},retrieveProxy:function(e){var t=this.proxyMap;return null!=ma[e]?t.getReserved(e):t.h[e]},hasProxy:function(e){var t=this.proxyMap;return null!=ma[e]?t.existsReserved(e):t.h.hasOwnProperty(e)},removeProxy:function(e){var t=this.proxyMap,n=null!=ma[e]?t.getReserved(e):t.h[e];return null!=n&&(this.proxyMap.remove(e),n.onRemove()),n},__class__:$r};var ea=function(){};a["puremvc.interfaces.IView"]=ea,ea.__name__=["puremvc","interfaces","IView"],ea.prototype={__class__:ea};var ta=function(){ta.instance=this,this.mediatorMap=new kr,this.observerMap=new kr,this.initializeView()};a["puremvc.core.View"]=ta,ta.__name__=["puremvc","core","View"],ta.__interfaces__=[ea],ta.getInstance=function(){return null==ta.instance&&(ta.instance=new ta),ta.instance},ta.prototype={initializeView:function(){},registerObserver:function(e,t){var n=this.observerMap;if(!(null!=ma[e]?n.existsReserved(e):n.h.hasOwnProperty(e))){var i=this.observerMap,r=new d;null!=ma[e]?i.setReserved(e,r):i.h[e]=r}var a=this.observerMap;(null!=ma[e]?a.getReserved(e):a.h[e]).add(t)},notifyObservers:function(e){var t=this.observerMap,n=e.getName();if(null!=ma[n]?t.existsReserved(n):t.h.hasOwnProperty(n)){for(var i=this.observerMap,r=e.getName(),a=null!=ma[r]?i.getReserved(r):i.h[r],o=new d,s=new m(a.h),l=s;l.hasNext();){var u=l.next();o.add(u)}for(var c=new m(o.h),_=c;_.hasNext();){_.next().notifyObserver(e)}}},removeObserver:function(e,t){for(var n=this.observerMap,i=null!=ma[e]?n.getReserved(e):n.h[e],r=i.h;null!=r;){var a=r.item;r=r.next;var o=a;if(1==o.compareNotifyContext(t)){i.remove(o);break}}i.isEmpty()&&this.observerMap.remove(e)},registerMediator:function(e){var t=this.mediatorMap,n=e.getMediatorName();if(null!=ma[n]?!t.existsReserved(n):!t.h.hasOwnProperty(n)){var i=this.mediatorMap,a=e.getMediatorName();null!=ma[a]?i.setReserved(a,e):i.h[a]=e;var o=e.listNotificationInterests();if(o.length>0)for(var s=new aa(r(e,e.handleNotification),e),l=0,u=o.length;l<u;){var c=l++;this.registerObserver(o[c],s)}e.onRegister()}},retrieveMediator:function(e){var t=this.mediatorMap;return null!=ma[e]?t.getReserved(e):t.h[e]},removeMediator:function(e){var t=this.mediatorMap,n=null!=ma[e]?t.getReserved(e):t.h[e];if(null!=n){for(var i=n.listNotificationInterests(),r=0,a=i.length;r<a;){var o=r++;this.removeObserver(i[o],n)}this.mediatorMap.remove(e),n.onRemove()}return n},hasMediator:function(e){var t=this.mediatorMap;return null!=ma[e]?t.existsReserved(e):t.h.hasOwnProperty(e)},__class__:ta};var na=function(){};a["puremvc.interfaces.INotification"]=na,na.__name__=["puremvc","interfaces","INotification"],na.prototype={__class__:na};var ia=function(){};a["puremvc.interfaces.IObserver"]=ia,ia.__name__=["puremvc","interfaces","IObserver"],ia.prototype={__class__:ia};var ra=function(e,t,n){this.name=e,null!=t&&(this.body=t),null!=n&&(this.type=n)};a["puremvc.patterns.observer.Notification"]=ra,ra.__name__=["puremvc","patterns","observer","Notification"],ra.__interfaces__=[na],ra.prototype={getName:function(){return this.name},setBody:function(e){this.body=e},getBody:function(){return this.body},setType:function(e){this.type=e},getType:function(){return this.type},toString:function(){var e="Notification Name: "+this.getName();return e+="\nBody:"+(null==this.body?"null":this.body.toString()),e+="\nType:"+(null==this.type?"null":this.type)},__class__:ra};var aa=function(e,t){this.setNotifyMethod(e),this.setNotifyContext(t)};a["puremvc.patterns.observer.Observer"]=aa,aa.__name__=["puremvc","patterns","observer","Observer"],aa.__interfaces__=[ia],aa.prototype={setNotifyMethod:function(e){this.notify=e},setNotifyContext:function(e){this.context=e},getNotifyMethod:function(){return this.notify},getNotifyContext:function(){return this.context},notifyObserver:function(e){this.getNotifyMethod()(e)},compareNotifyContext:function(e){return e==this.context},__class__:aa};var oa,sa=0,la={};a.Math=Math,String.prototype.__class__=a.String=String,String.__name__=["String"],a.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=a.Date=Date,Date.__name__=["Date"];var ua=a.Int={__name__:["Int"]},ca=a.Dynamic={__name__:["Dynamic"]},_a=a.Float=Number;_a.__name__=["Float"];var ha=a.Bool=Boolean;ha.__ename__=["Bool"];var da=a.Class={__name__:["Class"]},fa={},ma={};A.APP_STATE_CHANGED="app_state_changed",A.ACCESS_TOKEN_CHANGED="access_token_changed",A.CURRENT_USER_CHANGED="current_user_changed",A.CONFIGURATION_CHANGED="configuration_changed",A.DOMAIN_SELECTION_CHANGED="domain_selection_changed",A.TALK_SELECTION_CHANGED="talk_selection_changed",A.TALK_LIST_SCROLL_TO_TALK_TOP_NEEDED="talk_list_scroll_to_talk_top_needed",A.USER_SELECTION_NEEDED="user_selection_needed",A.USER_SELECTION_CHANGED="user_selection_changed",A.FRIEND_SELECTION_NEEDED="friend_selection_needed",A.STAMP_SET_CHANGED="stamp_set_changed",A.STAMP_SELECTION_STARTED="stamp_selection_started",A.STAMP_SELECTION_ENDED="stamp_selection_ended",A.STAMP_SELECTION_CHANGED="stamp_selection_changed",A.ACTION_SELECTION_CHANGED="action_selection_changed",A.CURRENT_PAGE_CHANGED="current_page_changed",A.CURRENT_PAGE_REASSIGNED="current_page_reassgined",A.FILEINFO_SELECTION_CHANGED="fileinfo_selection_changed",A.MESSAGE_FILEINFO_SELECTION_CHANGED="message_fileinfo_selection_changed",A.STAGED_FILEINFO_SELECTION_CHANGED="staged_fileinfo_selection_changed",A.STAGED_FILEINFOS_ADDED="staged_fileinfos_added",A.STAGED_FILEINFOS_MOVED="staged_fileinfos_moved",A.ERROR_OCCURRED="error_occurred",A.UNREAD_COUNT_CHANGED="brand_badge_changed",A.SEND_FORM_TOP_CHANGED="send_form_top_changed",A.SOLUTIONS_LOADED="solutions_loaded",A.RIGHT_PANE_OPENED="right_pane_opened",A.RIGHT_PANE_CLOSED="right_pane_closed",A.PASSWORD_EXPIRATION_OVERED="password_expiration_overed",A.PASSWORD_EXPIRATION_WARNED="password_expiration_warned",A.PHOTO_EDITOR_SAVED="photo_editor_saved",A.MC_AUTHENTICATED_USER_RECEIVED="mc_authenticated_user_received",A.KEYWORD_WATCHING_UPDATED="keyword_watching_updated",A.KEYWORD_DETECTION_UPDATED="keyword_detaction_updated",A.SEND_BY_ENTER_CHANGED="send_by_enter_changed",A.DEPARTMENT_SELECTION_CHANGED_FOR_MEMBERS_PAGE="department_selection_changed_for_members_page",A.PRESENCES_UPDATED="presences_updated",A.NOTEINFO_SELECTION_CHANGED="noteinfo_selection_changed",A.START_NOTE_EDITING="start_note_editing",A.DATA_RECOVERING="data_recovering",A.DATA_RECOVERED="data_recovered",A.NOTIFY_UPDATE_USER="notify_update_user",A.NOTIFY_ADD_FRIEND="notify_add_friend",A.NOTIFY_ADD_ACQUAINTANCE="notify_add_acquaintance",A.NOTIFY_DELETE_FRIEND="notify_delete_friend",A.NOTIFY_DELETE_ACQUAINTANCE="notify_delete_acquaintance",A.NOTIFY_UPDATE_DOMAIN_USERS="notify_update_domain_users",A.GET_DOMAIN_USERS_RESPONSED="get_domain_users_responsed",A.GET_USERS_RESPONSED="get_users_responsed",A.GET_PROFILE_RESPONSED="get_profile_responsed",A.GET_PROFILE_ERRORED="get_profile_errored",A.UPDATE_USER_RESPONSED="update_user_responsed",A.UPDATE_USER_ERRORED="update_user_errored",A.UPDATE_PROFILE_RESPONSED="update_profile_responsed",A.UPDATE_PROFILE_ERRORED="update_profile_errored",A.NOTIFY_UPDATE_DEPARTMENT_TREE="notify_update_department_tree",A.NOTIFY_UPDATE_DEPARTMENT_USERS="notify_update_department_users",A.GET_DEPARTMENT_TREE_RESPONSED="get_department_tree_responsed",A.GET_DEPARTMENT_TREE_CANCELED="get_department_tree_canceled",A.GET_DEPARTMENT_USERS_RESPONSED="get_department_users_responsed",A.GET_DEPARTMENT_USERS_CANCELED="get_department_users_canceled",A.GET_DEPARTMENT_USER_COUNT_RESPONSED="get_department_user_count_responsed",A.GET_ME_RESPONSED="get_me_responsed",A.DEPARTMENT_USER_COUNT_CLEARED="department_user_count_cleared",A.DEPARTMENT_USER_IDS_PREPARED="department_user_ids_prepared",A.NOTIFY_ADD_DOMAIN_INVITE="notify_add_domain_invite",A.NOTIFY_ACCEPT_DOMAIN_INVITE="notify_accept_domain_invite",A.NOTIFY_DELETE_DOMAIN_INVITE="notify_delete_domain_invite",A.NOTIFY_JOIN_DOMAIN="notify_join_domain",A.NOTIFY_UPDATE_DOMAIN="notify_update_domain",A.NOTIFY_LEAVE_DOMAIN="notify_leave_domain",A.NOTIFY_CREATE_PAIR_TALK="notify_create_pair_talk",A.NOTIFY_CREATE_GROUP_TALK="notify_create_group_talk",A.NOTIFY_UPDATE_GROUP_TALK="notify_update_group_talk",A.NOTIFY_UPDATE_GROUP_TALK_ERRORED="notify_update_group_talk_ERRORED",A.NOTIFY_ADD_TALKERS="notify_add_talkers",A.NOTIFY_ADD_TALKERS_INCLUDING_ME="notify_add_talkers_including_me",A.NOTIFY_DELETE_TALKER="notify_delete_talker",A.NOTIFY_DELETE_TALK="notify_delete_talk",A.NOTIFY_UPDATE_READ_STATUSES="notify_update_read_statuses",A.NOTIFY_UPDATE_TALK_STATUS="notify_update_talk_status",A.NOTIFY_UPDATE_LOCAL_TALK_STATUS="notify_update_local_talk_status",A.NOTIFY_ADD_FAVORITE_TALK="notify_add_favorite_talk",A.NOTIFY_DELETE_FAVORITE_TALK="notify_delete_favorite_talk",A.NOTIFY_DISABLE_PUSH_NOTIFICATION="notify_disable_push_notification",A.NOTIFY_ENABLE_PUSH_NOTIFICATION="notify_enable_push_notification",A.NOTIFY_CREATE_MESSAGE="notify_create_message",A.NOTIFY_DELETE_MESSAGE="notify_delete_message",A.NOTIFY_GET_MESSAGES="notify_get_messages",A.NOTIFY_GET_MESSAGE_READ_STATUS="notify_get_message_status",A.CREATE_MESSAGE_START="create_message_start",A.CREATE_MESSAGE_COMPLETE="create_message_complete",A.CREATE_MESSAGE_FAIL="create_message_fail",A.ADD_FAVORITE_MESSAGE_COMPLETED="add_favorite_message_completed",A.DELETE_FAVORITE_MESSAGE_COMPLETED="delete_favorite_message_completed",A.GET_FAVORITE_MESSAGES_COMPLETED="get_favorite_messages_completed",A.NOTIFY_ADD_FAVORITE_MESSAGE="notify_add_favorite_message",A.NOTIFY_DELETE_FAVORITE_MESSAGE="notify_delete_favorite_message",A.NOTIFY_CREATE_ANNOUNCEMENT="notify_create_announcement",A.NOTIFY_DELETE_ANNOUNCEMENT="notify_delete_announcement",A.NOTIFY_UPDATE_ANNOUNCEMENT_STATUS="notify_update_announcement_status",A.NOTIFY_GET_ANNOUNCEMENTS="notify_get_announcements",A.CREATE_ANNOUNCEMENT_START="create_announcement_start",A.CREATE_ANNOUNCEMENT_COMPLETE="create_announcement_complete",A.CREATE_ANNOUNCEMENT_FAIL="create_announcement_fail",A.NOTIFY_UPDATE_QUESTION="notify_update_question",A.NOTIFY_GET_QUESTIONS="get_questions_responsed",A.NOTIFY_CREATE_ATTACHMENT="notify_create_attachment",A.NOTIFY_DELETE_ATTACHMENT="notify_delete_attachment",A.GET_FILE_RESPONSED="get_file_responsed",A.GET_NOTE_STATUSES_LOADED="get_note_statuses_loaded",A.GET_NOTE_LOADED="get_note_loaded",A.GET_NOTE_FAILED_BY_NOTE_NOT_FOUND="get_note_failed_by_note_not_found",A.CREATE_NOTE_COMPLETED="create_note_completed",A.UPDATE_NOTE_SETTING_COMPLETED="update_note_setting_completed",A.UPDATE_NOTE_SETTING_FAILED_BY_NOT_FOUND="update_note_setting_failed_by_not_found",A.UPDATE_NOTE_SETTING_FAILED_BY_CONFLICT="update_note_setting_failed_by_conflict",A.UPDATE_NOTE_COMPLETED="update_note_completed",A.UPDATE_NOTE_FAILED_BY_NOT_FOUND="update_note_failed_by_not_found",A.UPDATE_NOTE_FAILED_BY_CONFLICT="update_note_failed_by_conflict",A.DELETE_NOTE_COMPLETED="delete_note_completed",A.NOTIFY_CREATE_NOTE="notify_create_note",A.NOTIFY_UPDATE_NOTE_PARTIALLY="notify_update_note_partially",A.NOTIFY_DELETE_NOTE="notify_delete_note",A.NOTIFY_UPDATE_NOTE_FOR_SETTING="notify_update_note_for_setting",A.NOTIFY_UPDATE_NOTE_FOR_SUMMARY="notify_update_note_for_revision",A.CREATE_NOTE_BUTTON_CLICKED="create_note_button_clicked",A.NOTIFY_SEARCH_MESSAGES="notify_search_messages",A.NOTIFY_SEARCH_ATTACHMENTS="notify_search_attachments",A.NOTIFY_SEARCH_MESSAGES_FAIL="notify_search_messages_fail",A.NOTIFY_SEARCH_ATTACHMENTS_FAIL="notify_search_attachments_fail",A.NOTIFY_SEARCH_PREPARE="notify_search_prepare",A.NOTIFY_SEARCH_CLEAR="notify_search_clear",A.NOTIFY_FILTER_BOX_TEXT_CHANGED="notify_filter_box_text_changed",A.NOTIFY_SEARCH_BOX_POPUP="notify_search_box_popup",A.NOTIFY_ADD_ACCOUNT_CONTROL_REQUEST="notify_add_account_control_request",A.NOTIFY_DELETE_ACCOUNT_CONTROL_REQUEST="notify_delete_account_control_request",A.NOTIFY_JOIN_ACCOUNT_CONTROL_GROUP="notify_join_account_control_group",A.NOTIFY_UPDATE_ACCOUNT_CONTROL_GROUP_PARTIALLY="notify_update_account_control_group_partially",A.NOTIFY_LEAVE_ACCOUNT_CONTROL_GROUP="notify_leave_account_control_group",A.PREPARE_CONFERENCE_FROM_MESSAGE="prepare_conference_from_message",A.JOIN_CONFERENCE_RESPONSED="join_conference_responsed",A.JOIN_CONFERENCE_CANCELED="join_conference_canceled",A.NOTIFY_OPEN_CONFERENCE="notify_open_conference",A.NOTIFY_CLOSE_CONFERENCE="notify_close_conference",A.NOTIFY_CONFERENCE_PARTICIPANT_JOIN="notify_conference_participant_join",A.NOTIFY_CONFERENCE_PARTICIPANT_LIMIT="notify_conference_participant_limit",A.NOTIFY_CONFERENCE_PARTICIPANT_REJECT="notify_conference_participant_reject",A.NOTIFY_ALL_TALK_MEMBERS_REJECTED_CONFERENCE="notify_all_talk_members_rejected_conference",z.ANNOUNCEMENTS_KEY="-1",Q.__meta__={fields:{api:{inject:null}}},Q.NAME="AccountControlRequest",X.__meta__={fields:{api:{inject:null},conferenceStore:{inject:null}}},X.NAME="Conference",$.__meta__={fields:{api:{inject:null}}},$.NAME="Device",te.__meta__={fields:{api:{inject:null}}},te.NAME="Domain",ie.__meta__={fields:{api:{inject:null},dataStore:{inject:null},fileService:{inject:null}}},ie.NAME="File",ae.NAME="LoadStampSet",ae.TAB_URL="./json/app_ja.json",ae.TAB_PANE_URL="./json/illust_category_ja.json",oe.__meta__={fields:{api:{inject:null}}},oe.NAME="ManageFriends",le.__meta__={fields:{api:{inject:null}}},le.NAME="Message",ce.__meta__={fields:{api:{inject:null}}},ce.NAME="Note",he.__meta__={fields:{api:{inject:null},keywordWatcher:{inject:null},readStatusUpdater:{inject:null}}},he.NAME="Read",fe.__meta__={fields:{api:{inject:null}}},fe.NAME="ReloadData",pe.__meta__={fields:{api:{inject:null},searchService:{inject:null}}},pe.NAME="Search",ve.__meta__={fields:{dataStore:{inject:null},settings:{inject:null}}},ve.NAME="SelectTalk",Se.__meta__={fields:{api:{inject:null}}},Se.NAME="Send",we.__meta__={fields:{accessTokenResolver:{inject:null},session:{inject:null}}},we.NAME="SignIn",Te.__meta__={fields:{api:{
inject:null},settings:{inject:null},dataStore:{inject:null}}},Te.NAME="SignOut",Ie.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},Ie.NAME="Talk",be.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},be.NAME="UpdateProfile",Ae.__meta__={fields:{api:{inject:null}}},Ae.NAME="UpdateUser",Ne.__meta__={fields:{userPresences:{inject:null},api:{inject:null},settings:{inject:null}}},Ne.NAME="UpdateUserPresences",Ne.MAX_USERS_PER_API=100,ke.__meta__={fields:{routing:{inject:null}}},ke.NAME="Url",ze.TalkAutoScrollDelay=1,ze.TalkAutoScrollImmediately=2,ze.TalkAutoScrollNone=3,ze.NAME="browser_settings",We.INCOMING_TIME=6e4,Ke.DEFAULT_PRESENCE_EXPIRATION=3e5;Ve.DEFAULT_TTL=3600,Ve.DEFAULT_MAX_PARTICIPANTS=8,At.MAX_READ_USER_IDS_COUNT=16,$t.QUERY_DATE_TODAY="t",$t.QUERY_DATE_YESTERDAY="-1d",$t.QUERY_DATE_THREE_DAYS_BEFORE="-3d",On.SIXTY_MINUTES=function(e){return new Cn(0,36e5)}(),On.FIFTEEN_MINUTES=function(e){return new Cn(0,9e5)}(),Qn.PREFIX="note-",ii.TU_REG=new l("([BCDFGHIJKLMNOPQRSTUVWYZ])","gm"),ii.XTU_REG=new l("","gm"),si.EMERGENCY=0,si.ALERT=1,si.CRITICAL=2,si.ERROR=3,si.WARNING=4,si.NOTICE=5,si.INFO=6,si.DEBUG=7,si.level=si.getLogLevel(process.env.HUBOT_LOG_LEVEL),si._d=7<=si.level&&null!=console?console.log.bind(console):si._nop,si._i=6<=si.level&&null!=console?console.info.bind(console):si._nop,si._w=4<=si.level&&null!=console?console.warn.bind(console):si._nop,si._e=3<=si.level&&null!=console?console.error.bind(console):si._nop,hi.HIRAGANA_SMALL_A=12353,hi.HIRAGANA_NN=12435,hi.KATAKANA_SMALL_A=12449,gi.NAME="accessTokenResolver",vi.NAME="Proxy",yi.__meta__={fields:{settings:{inject:null},accountLoader:{inject:null},api:{inject:null}}},wi.NAME="accountLoader",Ii.__meta__={fields:{api:{inject:null},dataStore:{inject:null},settings:{inject:null},fileInfoStore:{inject:null},departmentStore:{inject:null},messageStore:{inject:null},dataFactory:{inject:null},keywordWatcher:{inject:null},conferenceStore:{inject:null}}},Ii.NAME="broadcast",Ei.__meta__={fields:{apiCaller:{inject:null},settings:{inject:null},dataStore:{inject:null},dataFactory:{inject:null},fileService:{inject:null},searchService:{inject:null},fileInfoStore:{inject:null},departmentStore:{inject:null},conferenceStore:{inject:null}}},Ei.NAME="api",Ei.API_VERSION="1.105",Ei.UPDATE_VERSION="1.105_1",Ei.ACTIONS_COUNT_PER_API=20,Ei.UPDATE_LAST_USED_AT_INTERVAL=6e5,bi.__meta__={fields:{rpc:{inject:null}}},bi.NAME="apiCaller",bi.DELAY_FOR_DB_REPLICATION=500,bi.DELAY_FOR_DB_REPLICATION_FOR_RETRY=1e3,bi.API_TRY_COUNT=3,Ai.NAME="appState",Ni.__meta__={fields:{dataStore:{inject:null},messageStore:{inject:null}}},Ni.NAME="conferenceStore",ki.__meta__={fields:{dataStore:{inject:null},fileInfoStore:{inject:null},messageStore:{inject:null},solutionsStore:{inject:null},conferenceStore:{inject:null}}},ki.NAME="dataFactory",Di.NAME="dataStore",Di.TYPE_FRIEND=0,Di.TYPE_ACQUAINSTANCE=1,Di.TYPE_NONE=2,Ci.__meta__={fields:{dataStore:{inject:null}}},Ci.NAME="departmentStore",Oi.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},Oi.NAME="features",Ri.NAME="fileInfoStore",Mi.__meta__={fields:{settings:{inject:null}}},Mi.NAME="fileService",Mi.THUMBNAIL_WIDTH=600,Mi.THUMBNAIL_HEIGHT=600,xi.__meta__={fields:{settings:{inject:null},features:{inject:null},dataStore:{inject:null}}},xi.NAME="keywordWatcher",xi.TALK_KEY_PREFIX="talk_",xi.ANNOUNCEMENT_KEY_PREFIX="announcement_",Fi.TEMP_HALF_SPACE="&SPACE",Fi.TEMP_FULL_SPACE="&FULL_PITCH_SPACE",Bi.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},Bi.NAME="limitations",ji.NAME="messageStore",Hi.__meta__={fields:{broadcast:{inject:null}}},Hi.NAME="rpc",Hi.lastMsgId=0,zi.PING_INTERVAL_ON_CONNECTED=45e3,Yi.__meta__={fields:{dataStore:{inject:null},api:{inject:null}}},Yi.NAME="readStatusUpdater",Vi.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},Vi.NAME="routing",Ji.__meta__={fields:{settings:{inject:null}}},Ji.NAME="searchService",Ji.LOAD_SIZE=20,Ji.DUMMY_VALUE_FOR_SET=1,Xi.__meta__={fields:{settings:{inject:null},dataStore:{inject:null},dataFactory:{inject:null},api:{inject:null}}},Xi.NAME="session",Zi.NAME="settings",Zi.KEY_ACCESS_TOKEN="access_token",Zi.KEY_ACCESS_TOKEN_WITHOUT_MANAGEMENT_CONSOLE="access_token_without_management_console",Zi.KEY_SELECTED_DOMAIN_ID_H="selected_domain_id_h",Zi.KEY_SELECTED_DOMAIN_ID_L="selected_domain_id_l",Zi.COOKIE_KEY_SEND_BY_ENTER="send-by-enter",Zi.COOKIE_EXPIRES_SEND_BY_ENTER=31536e3,Zi.KEY_SELECTED_STAMP_TAB_ID="selected_stamp_tab_id",Zi.KEY_INPUT_TEXT="input_text",Zi.KEY_COPY_PROFILE_TO_ALL_DOMAINS="copy_profile_to_all_domains",Zi.KEY_SELECTED_DEPARTMENT_IDS="selected_department_ids",Zi.KEY_SEARCH_HISTORIES="search_histories",Zi.KEY_RIGHT_PANEL_OPENED="right_panel_opened",Zi.KEY_MULTI_VIEW_MODE="multi_view_mode",Zi.KEY_PASSWORD_WARNING_SKIP_UNTIL="password_warning_skip_until",Zi.KEY_LAST_USED_EXPIRED_AT="last_used_expired_at",Zi.KEY_IDFV="idfv",$i.NAME="solutionsStore",er.__meta__={fields:{dataStore:{inject:null},conferenceStore:{inject:null}}},er.NAME="talksService",tr.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},tr.NAME="ThumbnailExpansion",nr.__meta__={fields:{dataStore:{inject:null}}},nr.NAME="userPresences",sr.NAME="Mediator",lr.__meta__={fields:{dataStore:{inject:null},api:{inject:null},hubotObject:{inject:null},messageEvent:{inject:null},sendQueue:{inject:null}}},lr.NAME="commandline",lr.DATA_SAVE_SPAN=5e3,ur.__meta__={fields:{dataStore:{inject:null}}},ur.NAME="hubotObject",cr.__meta__={fields:{dataStore:{inject:null},hubotObject:{inject:null}}},cr.NAME="messageEvent",_r.minWaitMinute=1,_r.maxWaitMinute=1440,hr.__meta__={fields:{messageEvent:{inject:null}}},hr.NAME="sendQueue",hr.MIN_SEND_SPAN_MESSAGE=550,hr.MIN_SEND_SPAN_ANNOUNCE=5050,hr.MAX_TEXT_LENGTH=1024,hr.MAX_FIELD_COUNT=9,hr.MAX_FIELD_LENGTH=64,mr._mul=null!=Math.imul?Math.imul:function(e,t){return e*(65535&t)+(e*(t>>>16)<<16|0)|0},gr.USE_CACHE=!1,gr.USE_ENUM_INDEX=!1,gr.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",Sr.DEFAULT_RESOLVER=new yr,Sr.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",br.count=0,Pr.i64tmp=function(e){return new Cn(0,0)}(),jr.__toStr={}.toString,qr.FLOAT_SINGLE_MIN=1.401298464324817e-45,qr.FLOAT_SINGLE_MAX=3.4028234663852886e38,qr.FLOAT_DOUBLE_MIN=5e-324,qr.FLOAT_DOUBLE_MAX=1.7976931348623157e308,s.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);