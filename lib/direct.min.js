!function(e,t){"use strict";var n={},i=function(){return ho.__string_rec(this,"")};function r(e,t){function n(){}n.prototype=e;var i=new n;for(var r in t)i[r]=t[r];return t.toString!==Object.prototype.toString&&(i.toString=t.toString),i}var a=e.DirectAPI=function(){this.eventEmitter=new Fo};n.DirectAPI=a,a.__name__=["DirectAPI"],a.getInstance=function(){return null==a.instance&&(a.instance=new a),a.instance},a.main=function(){},a.prototype={setOptions:function(e){null!=e&&(Qo.host=e.host,Qo.endpoint=e.endpoint,Qo.accessToken=e.access_token,Qo.proxyURL=e.proxyURL,Qo.account=e.account,Qo.talkWithBot=e.talkWithBot,Qo.acceptableEventTimeDiff=e.acceptableEventTimeDiff),Ar._d("["+s.dateStr(new Date)+"] ","current settings",Qo,"","",""),null==Qo.accessToken&&Ar._e("["+s.dateStr(new Date)+"] ","Not enough parameters provided. I need a access token","","","","")},parseInt64:function(e){return Ra.parseInt64(e)},stringifyInt64:function(e,t){return null==t&&(t=!1),Ra.stringifyInt64(e,t)},listen:function(){this.facade=E.getInstance(),this.api=ho.__cast(this.facade.retrieveProxy("api"),zr),this.data=ho.__cast(this.facade.retrieveProxy("dataStore"),Vr),this.ID=new Ra;var e=ho.__cast(this.facade.retrieveProxy("fileService"),Qr);this.notes=new Ia(new Ea(this,this.api,e)),this.mention=new h,this.facade.startup()},emit:function(e,t,n,i){this.eventEmitter.emit(e,t,n,i)},on:function(e,t){return this.eventEmitter.on(e,t)},getDomainInvites:function(e){this.api._getDomainInvites(e)},acceptDomainInvite:function(e){this.api.acceptDomainInvite(e)},__class__:a};var o=function(e,t){this.r=new RegExp(e,t.split("u").join(""))};n.EReg=o,o.__name__=["EReg"],o.prototype={match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&e>=0&&e<this.r.m.length)return this.r.m[e];throw new _o("EReg::matched")},matchedPos:function(){if(null==this.r.m)throw new _o("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(e,t,n){if(null==n&&(n=-1),this.r.global){this.r.lastIndex=t;var i=this.r,r=n<0?e:s.substr(e,0,t+n);this.r.m=i.exec(r);var a=null!=this.r.m;return a&&(this.r.s=e),a}var o=this.match(n<0?s.substr(e,t,null):s.substr(e,t,n));return o&&(this.r.s=e,this.r.m.index+=t),o},split:function(e){var t="#__delim__#";return e.replace(this.r,t).split(t)},map:function(e,t){for(var n=0,i="";!(n>=e.length);){if(!this.matchSub(e,n)){i+=g.string(s.substr(e,n,null));break}var r=this.matchedPos();if(i+=g.string(s.substr(e,n,r.pos-n)),i+=g.string(t(this)),0==r.len?(i+=g.string(s.substr(e,r.pos,1)),n=r.pos+1):n=r.pos+r.len,!this.r.global)break}return!this.r.global&&n>0&&n<e.length&&(i+=g.string(s.substr(e,n,null))),i},__class__:o};var s=function(){};n.HxOverrides=s,s.__name__=["HxOverrides"],s.dateStr=function(e){var t=e.getMonth()+1,n=e.getDate(),i=e.getHours(),r=e.getMinutes(),a=e.getSeconds();return e.getFullYear()+"-"+(t<10?"0"+t:""+t)+"-"+(n<10?"0"+n:""+n)+" "+(i<10?"0"+i:""+i)+":"+(r<10?"0"+r:""+r)+":"+(a<10?"0"+a:""+a)},s.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),n=new Date;return n.setTime(0),n.setUTCHours(t[0]),n.setUTCMinutes(t[1]),n.setUTCSeconds(t[2]),n;case 10:var i=e.split("-");return new Date(i[0],i[1]-1,i[2],0,0,0);case 19:var r=e.split(" "),a=r[0].split("-"),o=r[1].split(":");return new Date(a[0],a[1]-1,a[2],o[0],o[1],o[2]);default:throw new _o("Invalid date format : "+e)}},s.cca=function(e,t){var n=e.charCodeAt(t);if(n==n)return n},s.substr=function(e,t,n){if(null==n)n=e.length;else if(n<0){if(0!=t)return"";n=e.length+n}return e.substr(t,n)},s.remove=function(e,t){var n=e.indexOf(t);return-1!=n&&(e.splice(n,1),!0)},s.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var l=function(){};n.Lambda=l,l.__name__=["Lambda"],l.array=function(e){for(var t=[],n=Co(e)();n.hasNext();){var i=n.next();t.push(i)}return t},l.map=function(e,t){for(var n=new u,i=Co(e)();i.hasNext();){var r=i.next();n.add(t(r))}return n},l.mapi=function(e,t){for(var n=new u,i=0,r=Co(e)();r.hasNext();){var a=r.next();n.add(t(i++,a))}return n},l.has=function(e,t){for(var n=Co(e)();n.hasNext();){if(n.next()==t)return!0}return!1},l.exists=function(e,t){for(var n=Co(e)();n.hasNext();){if(t(n.next()))return!0}return!1},l.foreach=function(e,t){for(var n=Co(e)();n.hasNext();){if(!t(n.next()))return!1}return!0},l.iter=function(e,t){for(var n=Co(e)();n.hasNext();){t(n.next())}},l.filter=function(e,t){for(var n=new u,i=Co(e)();i.hasNext();){var r=i.next();t(r)&&n.add(r)}return n},l.fold=function(e,t,n){for(var i=Co(e)();i.hasNext();){n=t(i.next(),n)}return n},l.count=function(e,t){var n=0;if(null==t)for(var i=Co(e)();i.hasNext();){i.next();++n}else for(var r=Co(e)();r.hasNext();){t(r.next())&&++n}return n},l.find=function(e,t){for(var n=Co(e)();n.hasNext();){var i=n.next();if(t(i))return i}return null};var u=function(){this.length=0};n.List=u,u.__name__=["List"],u.prototype={add:function(e){var t=new c(e,null);null==this.h?this.h=t:this.q.next=t,this.q=t,this.length++},isEmpty:function(){return null==this.h},remove:function(e){for(var t=null,n=this.h;null!=n;){if(n.item==e)return null==t?this.h=n.next:t.next=n.next,this.q==n&&(this.q=t),this.length--,!0;t=n,n=n.next}return!1},iterator:function(){return new _(this.h)},map:function(e){for(var t=new u,n=this.h;null!=n;){var i=n.item;n=n.next,t.add(e(i))}return t},__class__:u};var c=function(e,t){this.item=e,this.next=t};n["_List.ListNode"]=c,c.__name__=["_List","ListNode"],c.prototype={__class__:c};var _=function(e){this.head=e};n["_List.ListIterator"]=_,_.__name__=["_List","ListIterator"],_.prototype={hasNext:function(){return null!=this.head},next:function(){var e=this.head.item;return this.head=this.head.next,e},__class__:_},Math.__name__=["Math"];var h=function(){this.forAll="ALL"};n.MentionUtil=h,h.__name__=["MentionUtil"],h.extractMentionParts=function(e){return Bo.extractMentionParts(e).map(function(e){return new d(e)})},h.removeMentionMarkup=function(e){return Bo.removeMentionMarkup(e)},h.prototype={markup:function(e){if(e&&e.id&&(e.name||e.displayName)){var t=R.makeFromIdStr(e.id),n=e.displayName?e.displayName:e.name;return"{@:"+Ga.toString(t)+","+(Bo.codePointCount(n)+1)+"}@"+n}return"string"==typeof e&&"ALL"==e?"{@:ALL,4}@ALL":null},__class__:h};var d=function(e){this.start=e.start,this.end=e.end,this.userIdNumStr=e.userIdNumStr,this.mentionText=e.mentionText};n.MentionPart=d,d.__name__=["MentionPart"],d.prototype={isALL:function(){return"ALL"==this.userIdNumStr},__class__:d};var f=function(){};n.ObjectHelper=f,f.__name__=["ObjectHelper"],f.deepCopy=function(e){return null==e?null:JSON.parse(JSON.stringify(e))};var m=function(e,t){this.basetime=0,this.count=0,this.max=e,this.interval=t};n.RateLimit=m,m.__name__=["RateLimit"],m.prototype={_now:function(){return(new Date).getTime()},calculateRetryAfter:function(e){var t;return t=this.basetime>0?this.interval-(e-this.basetime):this.interval,Math.ceil(t/1e3)},createError:function(e){var t=this.max+" calls every "+Math.floor(this.interval/1e3)+" sec";return ka.createTooManyRequestsError(t,this.calculateRetryAfter(e))},apply:function(e){var t=this;return new Promise(function(n,i){var r=t._now();if(t.max>0&&r-t.basetime>t.interval)t.basetime=r,t.count=1;else{if(!(t.max>0&&t.count<t.max))return void i(t.createError(r));t.count++}e().then(n,i)})},__class__:m};var p=function(){};n.Reflect=p,p.__name__=["Reflect"],p.field=function(e,t){try{return e[t]}catch(e){return null}},p.fields=function(e){var t=[];if(null!=e){var n=Object.prototype.hasOwnProperty;for(var i in e)"__id__"!=i&&"hx__closures__"!=i&&n.call(e,i)&&t.push(i)}return t},p.isFunction=function(e){return"function"==typeof e&&!(e.__name__||e.__ename__)},p.compare=function(e,t){return e==t?0:e>t?1:-1},p.isEnumValue=function(e){return null!=e&&null!=e.__enum__},p.deleteField=function(e,t){return!!Object.prototype.hasOwnProperty.call(e,t)&&(delete e[t],!0)};var g=function(){};n.Std=g,g.__name__=["Std"],g.string=function(e){return ho.__string_rec(e,"")},g.parseInt=function(e){var t=parseInt(e,10);return 0!=t||120!=s.cca(e,1)&&88!=s.cca(e,1)||(t=parseInt(e)),isNaN(t)?null:t};var v=function(){this.b=""};n.StringBuf=v,v.__name__=["StringBuf"],v.prototype={toString:function(){return this.b},__class__:v};var S=function(){};n.StringTools=S,S.__name__=["StringTools"],S.htmlEscape=function(e,t){return e=e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;"),t?e.split('"').join("&quot;").split("'").join("&#039;"):e},S.startsWith=function(e,t){return e.length>=t.length&&s.substr(e,0,t.length)==t},S.isSpace=function(e,t){var n=s.cca(e,t);return n>8&&n<14||32==n},S.ltrim=function(e){for(var t=e.length,n=0;n<t&&S.isSpace(e,n);)++n;return n>0?s.substr(e,n,t-n):e},S.rtrim=function(e){for(var t=e.length,n=0;n<t&&S.isSpace(e,t-n-1);)++n;return n>0?s.substr(e,0,t-n):e},S.trim=function(e){return S.ltrim(S.rtrim(e))},S.replace=function(e,t,n){return e.split(t).join(n)},S.hex=function(e,t){for(var n="";n="0123456789ABCDEF".charAt(15&e)+n,(e>>>=4)>0;);if(null!=t)for(;n.length<t;)n="0"+n;return n};var y=n.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};y.TNull=["TNull",0],y.TNull.toString=i,y.TNull.__enum__=y,y.TInt=["TInt",1],y.TInt.toString=i,y.TInt.__enum__=y,y.TFloat=["TFloat",2],y.TFloat.toString=i,y.TFloat.__enum__=y,y.TBool=["TBool",3],y.TBool.toString=i,y.TBool.__enum__=y,y.TObject=["TObject",4],y.TObject.toString=i,y.TObject.__enum__=y,y.TFunction=["TFunction",5],y.TFunction.toString=i,y.TFunction.__enum__=y,y.TClass=function(e){var t=["TClass",6,e];return t.__enum__=y,t.toString=i,t},y.TEnum=function(e){var t=["TEnum",7,e];return t.__enum__=y,t.toString=i,t},y.TUnknown=["TUnknown",8],y.TUnknown.toString=i,y.TUnknown.__enum__=y,y.__empty_constructs__=[y.TNull,y.TInt,y.TFloat,y.TBool,y.TObject,y.TFunction,y.TUnknown];var w=function(){};n.Type=w,w.__name__=["Type"],w.getClassName=function(e){var t=e.__name__;return null==t?null:t.join(".")},w.getEnumName=function(e){return e.__ename__.join(".")},w.resolveClass=function(e){var t=n[e];return null!=t&&t.__name__?t:null},w.resolveEnum=function(e){var t=n[e];return null!=t&&t.__ename__?t:null},w.createInstance=function(e,t){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);case 9:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]);case 10:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);case 11:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10]);case 12:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11]);case 13:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12]);case 14:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13]);default:throw new _o("Too many arguments")}},w.createEmptyInstance=function(e){function t(){}return t.prototype=e.prototype,new t},w.createEnum=function(e,t,n){var i=p.field(e,t);if(null==i)throw new _o("No such constructor "+t);if(p.isFunction(i)){if(null==n)throw new _o("Constructor "+t+" need parameters");return i.apply(e,n)}if(null!=n&&0!=n.length)throw new _o("Constructor "+t+" does not need parameters");return i},w.typeof=function(e){switch(typeof e){case"boolean":return y.TBool;case"function":return e.__name__||e.__ename__?y.TObject:y.TFunction;case"number":return Math.ceil(e)==e%2147483648?y.TInt:y.TFloat;case"object":if(null==e)return y.TNull;var t=e.__enum__;if(null!=t)return y.TEnum(t);var n=ho.getClass(e);return null!=n?y.TClass(n):y.TObject;case"string":return y.TClass(String);case"undefined":return y.TNull;default:return y.TUnknown}},w.enumEq=function(e,t){if(e==t)return!0;try{if(e[0]!=t[0])return!1;for(var n=2,i=e.length;n<i;){var r=n++;if(!w.enumEq(e[r],t[r]))return!1}var a=e.__enum__;if(a!=t.__enum__||null==a)return!1}catch(e){return!1}return!0};var T=function(){};n["puremvc.interfaces.IFacade"]=T,T.__name__=["puremvc","interfaces","IFacade"],T.prototype={__class__:T};var I=function(){I.instance=this,this.initializeFacade()};n["puremvc.patterns.facade.Facade"]=I,I.__name__=["puremvc","patterns","facade","Facade"],I.__interfaces__=[T],I.getInstance=function(){return null==I.instance&&(I.instance=new I),I.instance},I.prototype={initializeFacade:function(){this.initializeModel(),this.initializeController(),this.initializeView()},initializeController:function(){null==this.controller&&(this.controller=wo.getInstance())},initializeModel:function(){null==this.model&&(this.model=Io.getInstance())},initializeView:function(){null==this.view&&(this.view=No.getInstance())},registerCommand:function(e,t){this.controller.registerCommand(e,t)},removeCommand:function(e){this.controller.removeCommand(e)},hasCommand:function(e){return this.controller.hasCommand(e)},registerProxy:function(e){this.model.registerProxy(e)},retrieveProxy:function(e){return this.model.retrieveProxy(e)},removeProxy:function(e){var t=null;return null!=this.model&&(t=this.model.removeProxy(e)),t},hasProxy:function(e){return this.model.hasProxy(e)},registerMediator:function(e){null!=this.view&&this.view.registerMediator(e)},retrieveMediator:function(e){return this.view.retrieveMediator(e)},removeMediator:function(e){var t=null;return null!=this.view&&(t=this.view.removeMediator(e)),t},hasMediator:function(e){return this.view.hasMediator(e)},sendNotification:function(e,t,n){this.notifyObservers(new Do(e,t,n))},notifyObservers:function(e){null!=this.view&&this.view.notifyObservers(e)},__class__:I};var E=function(){I.call(this)};n["albero.AppFacade"]=E,E.__name__=["albero","AppFacade"],E.getInstance=function(){return null==I.instance&&(I.instance=new E),ho.__cast(I.instance,E)},E.__super__=I,E.prototype=r(I.prototype,{initializeModel:function(){I.prototype.initializeModel.call(this);var e=[];e=e.concat([new oa,new Wr,new Vr,new jr,new ga,new Hr,new zr,new ya,new Yr,new Kr,Xr.newInstance(),new ha,new ma,new $r,new qr,new pa,new _a,new aa,new Sa,new va,new ra,Lr.newInstance()]);for(var t=0;t<e.length;){var n=e[t];++t,this.registerProxy(n)}for(var i=0;i<e.length;){var r=e[i];++i,this.autoBind(r)}},initializeView:function(){I.prototype.initializeView.call(this);for(var e=0,t=this.getMediators();e<t.length;){var n=t[e];++e,this.registerMediator(n)}},getMediators:function(){return[new Ca]},initializeController:function(){I.prototype.initializeController.call(this);var e=[ie,Ce,ke,we,Me,Oe,_e,Se,le,be,Ue,Fe,xe,Pe,Ne,X,de,te,$,ge,se,Ie,me];e.push(ae);for(var t=0;t<e.length;){var n=e[t];++t;var i=S.replace(w.getClassName(n).split(".").pop(),"Command","");this.registerCommand(i,n)}},registerMediator:function(e){this.autoBind(e),I.prototype.registerMediator.call(this,e)},autoBind:function(e){for(var t=e,n=co.getFields(null==t?null:ho.getClass(t)),i=0,r=p.fields(n);i<r.length;){var a=r[i];++i;var o=p.field(n,a);if(Object.prototype.hasOwnProperty.call(o,"inject")){var s=this.retrieveProxy(a);if(null==s){var l=e;w.getClassName(null==l?null:ho.getClass(l))}else{var u=e;w.getClassName(null==u?null:ho.getClass(u)),w.getClassName(null==s?null:ho.getClass(s));e[a]=s}}}},startup:function(){ho.__cast(this.retrieveProxy("appState"),Wr).start()},__class__:E});var N=n["albero.AppState"]={__ename__:["albero","AppState"],__constructs__:["Active","Inactive"]};N.Active=["Active",0],N.Active.toString=i,N.Active.__enum__=N,N.Inactive=["Inactive",1],N.Inactive.toString=i,N.Inactive.__enum__=N,N.__empty_constructs__=[N.Active,N.Inactive];var A=n["albero.ConnectionStatus"]={__ename__:["albero","ConnectionStatus"],__constructs__:["Ok","Error","ConcurrentAccessError","ForcibliyClosedError"]};A.Ok=["Ok",0],A.Ok.toString=i,A.Ok.__enum__=A,A.Error=["Error",1],A.Error.toString=i,A.Error.__enum__=A,A.ConcurrentAccessError=["ConcurrentAccessError",2],A.ConcurrentAccessError.toString=i,A.ConcurrentAccessError.__enum__=A,A.ForcibliyClosedError=["ForcibliyClosedError",3],A.ForcibliyClosedError.toString=i,A.ForcibliyClosedError.__enum__=A,A.__empty_constructs__=[A.Ok,A.Error,A.ConcurrentAccessError,A.ForcibliyClosedError];var b=function(){};n["albero.ContentTypeResolver"]=b,b.__name__=["albero","ContentTypeResolver"],b.prototype={__class__:b};var D=function(){};n["albero.DefaultContentTypeResolver"]=D,D.__name__=["albero","DefaultContentTypeResolver"],D.__interfaces__=[b],D.getContentTypeByFileName=function(e,t){if(B.isNotEmpty(t))return"csv"==D.getExtension(e)?"text/csv":t;switch(D.getExtension(e)){case"csv":return"text/csv";case"doc":return"application/msword";case"docm":return"application/vnd.ms-word.document.macroenabled.12";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case"gif":return"image/gif";case"htm":case"html":return"text/html";case"jpeg":case"jpg":return"image/jpeg";case"lzh":return"application/x-lzh";case"md":return"text/markdown";case"pdf":return"application/pdf";case"png":return"image/png";case"ppt":return"application/vnd.ms-powerpoint";case"pptm":return"application/vnd.ms-powerpoint.presentation.macroenabled.12";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation";case"rar":return"application/vnd.rar";case"svg":return"image/svg+xml";case"txt":return"text/plain";case"webp":return"image/webp";case"xls":return"application/vnd.ms-excel";case"xlsb":return"application/vnd.ms-excel.sheet.binary.macroenabled.12";case"xlsm":return"application/vnd.ms-excel.sheet.macroenabled.12";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"xml":return"text/xml";default:return"application/octet-stream"}},D.getExtension=function(e){if(null==e)return"";var t=e.split("."),n=t.length;return 0==n?"":t[n-1]},D.prototype={resolve:function(e){return D.getContentTypeByFileName(e.name,e.type)},__class__:D};var M=function(){};n["albero.DateTimeHelper"]=M,M.__name__=["albero","DateTimeHelper"],M.isSameDate=function(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()},M.dateString=function(e,t){var n=new Date,i="";return e.getFullYear()!=n.getFullYear()&&(i+=e.getFullYear()+"/"),i+=e.getMonth()+1+"/"+e.getDate(),t&&(i+=" ("+M.dayOfWeekString(e)+")"),i},M.dayOfWeekString=function(e){switch(e.getDay()){case 0:return Nr.localize("DateTimeHelper.sun");case 1:return Nr.localize("DateTimeHelper.mon");case 2:return Nr.localize("DateTimeHelper.tue");case 3:return Nr.localize("DateTimeHelper.wed");case 4:return Nr.localize("DateTimeHelper.thu");case 5:return Nr.localize("DateTimeHelper.fri");default:return Nr.localize("DateTimeHelper.sat")}},M.dateStringForPicker=function(e){return e.getFullYear()+"-"+M.toDoubleDigits(e.getMonth()+1)+"-"+M.toDoubleDigits(e.getDate())},M.getDateStringForFile=function(){var e=new Date;return e.getFullYear()+M.toDoubleDigits(e.getMonth()+1)+M.toDoubleDigits(e.getDate())+"_"+M.toDoubleDigits(e.getHours())+M.toDoubleDigits(e.getMinutes())+M.toDoubleDigits(e.getSeconds())},M.getTimeStringForVoice=function(e){return M.toDoubleDigits(e/60|0)+":"+M.toDoubleDigits((0|e)%60)},M.toDoubleDigits=function(e){var t=null==e?"null":""+e;return 1==t.length&&(t="0"+t),t},M.nowAsInt64=function(){return M.dateAsInt64((new Date).getTime())},M.oneDayAfterAsInt64=function(){return M.dateAsInt64((new Date).getTime()+864e5)},M.afterAsInt64=function(e){return M.dateAsInt64((new Date).getTime()+e)},M.dateAsInt64=function(e){return new pi(e/4294967296|0,e%4294967296|0)},M.abbreviateDatetimeString=function(e){if(null==e)return"";var t=new Date,n=e.high,i=e.low,r=new Date(4294967296*n+(i>=0?i:i+4294967296));return t.getFullYear()==r.getFullYear()&&t.getMonth()==r.getMonth()&&t.getDate()==r.getDate()?r.getHours()+":"+(r.getMinutes()<10?"0":"")+r.getMinutes():M.dateString(r,!1)},M.getDateStringForNotification=function(e){if(null==e)return"";var t=new Date,n=e.high,i=e.low,r=new Date(4294967296*n+(i>=0?i:i+4294967296));return t.getFullYear()==r.getFullYear()&&t.getMonth()==r.getMonth()&&t.getDate()==r.getDate()?r.getHours()+":"+(r.getMinutes()<10?"0":"")+r.getMinutes():r.getMonth()+1+"/"+r.getDate()},M.datetimeStringIn11Chars=function(e){if(null==e)return"";var t=new Date,n=e.high,i=e.low,r=new Date(4294967296*n+(i>=0?i:i+4294967296)),a=M.dateString(r,!1);return t.getFullYear()==r.getFullYear()&&(a+=" "+r.getHours()+":"+(r.getMinutes()<10?"0":"")+r.getMinutes()),a},M.timeString=function(e){if(null==e)return"";var t=e.high,n=e.low,i=new Date(4294967296*t+(n>=0?n:n+4294967296));return i.getHours()+":"+(i.getMinutes()<10?"0":"")+i.getMinutes()},M.datetimeString=function(e){if(null==e)return"";var t=parseFloat(Ga.toString(e)),n=new Date(t);return n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate()+" "+n.getHours()+":"+(n.getMinutes()<10?"0":"")+n.getMinutes()};var C=function(){};n["albero.FileDynamicHelper"]=C,C.__name__=["albero","FileDynamicHelper"],C.filterDeleted=function(e){return null==e?[]:e.filter(C.isNotDeleted)},C.isNotDeleted=function(e){return null==e.deleted||!e.deleted},C.createFileInfoDynamic=function(e,t,n,i){var r={url:i.get_url,content_type:e.type,content_size:e.size,name:t,file_id:i.file_id};return P.foreach(n,function(e){null!=e.auth&&(r.thumbnail_url=e.auth.get_url),null!=e.dimension&&(r.thumbnail_dimension=e.dimension.toObject())}),r};var k=function(){};n["albero.FileHelper"]=k,k.__name__=["albero","FileHelper"],k.createByteSizeStringWithUnit=function(e){if(null==e)return"0 B";for(var t,n=["","K","M","G","T"];;){var i=new pi(0,1024),r=t=Ga.divMod(e,i).quotient,a=new pi(0,0),o=r.high-a.high|0;if(o=0!=o?o:Ba.ucompare(r.low,a.low),!((r.high<0?a.high<0?o:-1:a.high>=0?o:1)>0))break;e=t,n.shift()}return Ga.toString(e)+" "+n.shift()+"B"},k.extractFilenameExceptExtension=function(e){return new o("\\.(?=[^.]+$)","").split(e)[0]};var O=function(){};n["albero.History"]=O,O.__name__=["albero","History"],O.replaceState=function(e,t,n){return null!=window.history&&(window.history.replaceState(e,t,n),!0)};var R=function(){};n["albero.Int64Helper"]=R,R.__name__=["albero","Int64Helper"],R.parse=function(e){if(!new o("^\\d+$","").match(e))return null;for(var t=new pi(0,0),n=new pi(0,10),i=0,r=e.length;i<r;){var a=i++,s=65535&t.low,l=t.low>>>16,u=65535&n.low,c=n.low>>>16,_=Ba._mul(s,u),h=Ba._mul(l,u),d=Ba._mul(s,c),f=_,m=(Ba._mul(l,c)+(d>>>16)|0)+(h>>>16)|0;if(f=f+(d<<=16)|0,Ba.ucompare(f,d)<0){m++;m|=0}if(f=f+(h<<=16)|0,Ba.ucompare(f,h)<0){m++;m|=0}m=m+(Ba._mul(t.low,n.high)+Ba._mul(t.high,n.low)|0)|0;var p=new pi(m,f),v=new pi(0,g.parseInt(e.charAt(a))),S=p.high+v.high|0,y=p.low+v.low|0;if(Ba.ucompare(y,p.low)<0){S++;S|=0}t=new pi(S,y)}return t},R.getHigh=function(e){return e.high},R.getLow=function(e){return e.low},R.idStr=function(e){return"_"+e.high+"_"+e.low},R.makeFromIdStr=function(e){var t=new o("^_(-?\\d*)_(-?\\d*)$","");return t.match(e)?new pi(g.parseInt(t.matched(1)),g.parseInt(t.matched(2))):null},R.fromNullableIdStr=function(e){return null!=e?R.makeFromIdStr(e):null},R.toStr=function(e){return Ga.toString(e)},R.isNeg=function(e){return e.high<0},R.add=function(e,t){var n=e.high+t.high|0,i=e.low+t.low|0;if(Ba.ucompare(i,e.low)<0){n++;n|=0}return new pi(n,i)},R.sub=function(e,t){var n=e.high-t.high|0,i=e.low-t.low|0;if(Ba.ucompare(e.low,t.low)<0){n--;n|=0}return new pi(n,i)},R.compare=function(e,t){var n=e.high-t.high|0;return n=0!=n?n:Ba.ucompare(e.low,t.low),e.high<0?t.high<0?n:-1:t.high>=0?n:1},R.eq=function(e,t){return null!=e&&null!=t&&e.high==t.high&&e.low==t.low},R.eqOrBothNull=function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.high==t.high&&e.low==t.low},R.toFloat=function(e){var t=e.high,n=e.low;return 4294967296*t+(n>=0?n:n+4294967296)},R.idStrToInt64=function(e){var t=e.split("_");return t.length>2?new pi(g.parseInt(t[1]),g.parseInt(t[2])):null},R.decrement=function(e){if(null==e)return null;var t=new pi(0,1),n=e.high-t.high|0,i=e.low-t.low|0;if(Ba.ucompare(e.low,t.low)<0){n--;n|=0}return new pi(n,i)},R.increment=function(e){if(null==e)return null;var t=new pi(0,1),n=e.high+t.high|0,i=e.low+t.low|0;if(Ba.ucompare(i,e.low)<0){n++;n|=0}return new pi(n,i)},R.unique=function(e){if(null==e)return[];for(var t=[],n=0,i=e.length;n<i;){var r=n++,a=e[r];R.indexOf(e,a)==r&&t.push(a)}return t},R.indexOf=function(e,t){if(null==e)return-1;for(var n=0,i=e.length;n<i;){var r=n++,a=e[r];if(null!=a&&null!=t&&a.high==t.high&&a.low==t.low)return r}return-1},R.contains=function(e,t){if(null==e)return!1;for(var n=0;n<e.length;){var i=e[n];if(++n,null!=i&&null!=t&&i.high==t.high&&i.low==t.low)return!0}return!1},R.notContains=function(e,t){return!R.contains(e,t)},R.remove=function(e,t){if(null==e)return!1;for(var n=0;n<e.length;){var i=e[n];if(++n,null!=i&&null!=t&&i.high==t.high&&i.low==t.low)return s.remove(e,i),!0}return!1},R.fromIntOrInt64=function(e){if(null==e||ho.__instanceof(e,pi))return e;var t=ho.__cast(e,Go);return new pi(t>>31,t)},R.eqArray=function(e,t){if(e!=t){if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var n=0,i=e.length;n<i;){var r=n++,a=e[r],o=t[r];if(null==a||null==o||a.high!=o.high||a.low!=o.low)return!1}}return!0},R.splitUsingMaxCount=function(e,t){for(var n=[],i=0;i<e.length;){var r=i+t,a=e.slice(i,r);n.push(a),i=r}return n};var F=function(){};n["albero.LambdaHelper"]=F,F.__name__=["albero","LambdaHelper"],F.flatten=function(e){return l.filter(e,function(e){return P.isDefined(e)}).map(function(e){return P.get(e)})},F.headOption=function(e){for(var t=Co(e)();t.hasNext();){var n=t.next();return Za.Some(n)}return Za.None},F.lastOption=function(e){for(var t=Za.None,n=Co(e)();n.hasNext();){var i=n.next();t=Za.Some(i)}return t},F.findOption=function(e,t){return P.option(l.find(e,t))},F.indexWhere=function(e,t){for(var n=0,i=Co(e)();i.hasNext();){if(t(i.next()))return n;++n}return-1},F.forall=function(e,t){return!l.exists(e,function(e){return!t(e)})};var U=function(){};n["albero.ArrayHelper"]=U,U.__name__=["albero","ArrayHelper"],U.lastOption=function(e){return 0==e.length?Za.None:Za.Some(e[e.length-1])},U.sortAndReturn=function(e,t){return e.sort(t),e},U.reverseAndReturn=function(e){return e.reverse(),e},U.asArray=function(e){return ho.__cast(e,Array)};var x=function(){};n["albero.MapHelper"]=x,x.__name__=["albero","MapHelper"],x.copyStringMap=function(e){for(var t=new eo,n=e.keys();n.hasNext();){var i=n.next(),r=null!=Jo[i]?e.getReserved(i):e.h[i];null!=Jo[i]?t.setReserved(i,r):t.h[i]=r}return t},x.toKeyArray=function(e){for(var t=[],n=e.keys();n.hasNext();)t.push(n.next());return t},x.toValueArray=function(e){for(var t=[],n=e.iterator();n.hasNext();)t.push(n.next());return t};var P=function(){};n["albero.OptionHelper"]=P,P.__name__=["albero","OptionHelper"],P.map=function(e,t){switch(e[1]){case 0:var n=e[2];return Za.Some(t(n));case 1:return Za.None}},P.flatMap=function(e,t){switch(e[1]){case 0:return t(e[2]);case 1:return Za.None}},P.foreach=function(e,t){switch(e[1]){case 0:t(e[2])}},P.filter=function(e,t){switch(e[1]){case 0:return t(e[2])?e:Za.None;case 1:return Za.None}},P.exists=function(e,t){return P.isDefined(P.filter(e,t))},P.isDefined=function(e){switch(e[1]){case 0:return!0;case 1:return!1}},P.isEmpty=function(e){switch(e[1]){case 0:return!1;case 1:return!0}},P.get=function(e){switch(e[1]){case 0:return e[2];case 1:throw new _o("None.get called")}},P.orNull=function(e){switch(e[1]){case 0:return e[2];case 1:return null}},P.flatten=function(e){return P.flatMap(e,function(e){return e})},P.eq=function(e,t){return w.enumEq(e,t)},P.option=function(e){return null!=e?Za.Some(e):Za.None};var L=function(){};n["albero.StorageHelper"]=L,L.__name__=["albero","StorageHelper"],L.getItemAsJson=function(e){var t=L.getItem(e);if(null==t)return null;try{return JSON.parse(t)}catch(e){return null}},L.getItemAsInt=function(e){var t=L.getItem(e);return null==t?null:g.parseInt(t)},L.getItem=function(e){var t=Er.getLocalStorage();if(null==t)Ar._e("["+s.dateStr(new Date)+"] ","storage not found","","","","");else try{return t.getItem(e)}catch(e){e instanceof _o&&(e=e.val),Ar._e("["+s.dateStr(new Date)+"] ","storage error occered.",e,"","","")}return null},L.removeItem=function(e){var t=Er.getLocalStorage();if(null==t)Ar._e("["+s.dateStr(new Date)+"] ","storage not found","","","","");else try{return t.removeItem(e),!0}catch(e){e instanceof _o&&(e=e.val),Ar._e("["+s.dateStr(new Date)+"] ","storage error occered.",e,"","","")}return!1},L.setItem=function(e,t){var n=Er.getLocalStorage();if(null==n)Ar._e("["+s.dateStr(new Date)+"] ","storage not found","","","","");else try{return n.setItem(e,t),!0}catch(e){e instanceof _o&&(e=e.val),Ar._e("["+s.dateStr(new Date)+"] ","storage error occered.",e,"","","")}return!1},L.getItemWithUnserialize=function(e){var t=L.getItem(e);if(null!=t)try{return Wa.run(t)}catch(e){e instanceof _o&&(e=e.val),Ar._w("["+s.dateStr(new Date)+"] ",e,"","","","")}return null},L.setItemWithSerialize=function(e,t){L.setItem(e,za.run(t))};var B=function(){};n["albero.StringHelper"]=B,B.__name__=["albero","StringHelper"],B.trim=function(e){return e.trim()},B.compare=function(e,t){return e>t?1:e<t?-1:0},B.isEmpty=function(e){return null==e||0==e.length},B.isNotEmpty=function(e){return!B.isEmpty(e)},B.randomString=function(){var e="",t=8;for(e+=g.string(S.hex(0|(new Date).getTime(),8));t++<36;)e+=g.string(0!=(51*t&52)?S.hex(0!=(15^t)?8^(Math.random()*(0!=(20^t)?16:4)|0):4):"-");return e.toLowerCase()};var G=n["albero.Urls"]={__ename__:["albero","Urls"],__constructs__:["auto","domains","domain","members","talks","actions","bookmarks","scheduled_messages","settings","announcements","error","loading","environment","apps","unknown"]};G.auto=["auto",0],G.auto.toString=i,G.auto.__enum__=G,G.domains=["domains",1],G.domains.toString=i,G.domains.__enum__=G,G.domain=function(e){var t=["domain",2,e];return t.__enum__=G,t.toString=i,t},G.members=function(e){var t=["members",3,e];return t.__enum__=G,t.toString=i,t},G.talks=function(e,t){var n=["talks",4,e,t];return n.__enum__=G,n.toString=i,n},G.actions=function(e){var t=["actions",5,e];return t.__enum__=G,t.toString=i,t},G.bookmarks=function(e){var t=["bookmarks",6,e];return t.__enum__=G,t.toString=i,t},G.scheduled_messages=function(e){var t=["scheduled_messages",7,e];return t.__enum__=G,t.toString=i,t},G.settings=function(e){var t=["settings",8,e];return t.__enum__=G,t.toString=i,t},G.announcements=["announcements",9],G.announcements.toString=i,G.announcements.__enum__=G,G.error=["error",10],G.error.toString=i,G.error.__enum__=G,G.loading=["loading",11],G.loading.toString=i,G.loading.__enum__=G,G.environment=function(e){var t=["environment",12,e];return t.__enum__=G,t.toString=i,t},G.apps=function(e){var t=["apps",13,e];return t.__enum__=G,t.toString=i,t},G.unknown=["unknown",14],G.unknown.toString=i,G.unknown.__enum__=G,G.__empty_constructs__=[G.auto,G.domains,G.announcements,G.error,G.loading,G.unknown];var H=function(){};n["albero.UrlsHelper"]=H,H.__name__=["albero","UrlsHelper"],H.isDisabledForDirectAppsOnly=function(e){if(null==e)return!1;switch(e[1]){case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}},H.isDirectAppsOnly=function(e){return null!=e&&13==e[1]};var z=n["albero.TalkUrlParam"]={__ename__:["albero","TalkUrlParam"],__constructs__:["multi","single"]};z.multi=function(e){var t=["multi",0,e];return t.__enum__=z,t.toString=i,t},z.single=function(e){var t=["single",1,e];return t.__enum__=z,t.toString=i,t},z.__empty_constructs__=[];var Y=function(){};n["albero.TalkUrlParamHelper"]=Y,Y.__name__=["albero","TalkUrlParamHelper"],Y.getTalkSelectionForSingle=function(e){switch(e[1]){case 0:return Za.None;case 1:var t=e[2];return Za.Some(t)}},Y.getTalkSelectionsForMulti=function(e){switch(e[1]){case 0:var t=e[2];return Za.Some(t);case 1:return Za.None}};var K=function(){};n["albero.UrlConverter"]=K,K.__name__=["albero","UrlConverter"],K.createUrls=function(e,t){if(null==e)return G.unknown;var n=e.split("/");return""!=n[0]?G.unknown:n.length<2?G.unknown:2==n.length?K.createUrlsWithoutDomain(n,t):K.createUrlsWithDomain(n,t)},K.createUrlsWithoutDomain=function(e,t){switch(e[1]){case"":return G.domains;case"apps":var n=t.getFallbackDomainId();return P.foreach(n,function(e){O.replaceState("apps",null,"#"+K.createFragment(G.apps(e),t))}),G.apps(P.orNull(n));case"environment":var i=t.getFallbackDomainId();return P.foreach(i,function(e){O.replaceState("environment",null,"#"+K.createFragment(G.environment(e),t))}),G.environment(P.orNull(i));case"error":return G.error;case"loading":return G.loading;case"settings":var r=t.getFallbackDomainId();return P.foreach(r,function(e){O.replaceState("settings",null,"#"+K.createFragment(G.settings(e),t))}),G.settings(P.orNull(r));default:return G.unknown}},K.createUrlsWithDomain=function(e,t){var n=R.parse(e[1]);if(null==n)return G.unknown;switch(e[2]){case"":return G.domain(n);case"actions":return G.actions(n);case"apps":return G.apps(n);case"bookmarks":return G.bookmarks(n);case"environment":return G.environment(n);case"members":return G.members(n);case"scheduled_messages":return G.scheduled_messages(n);case"settings":return G.settings(n);case"talks":if(e.length<4)return G.talks(n,z.single(ai.NotSelected));if("multi"==e[3]||",,"==e[3])return G.talks(n,z.multi([ai.NotSelected,ai.NotSelected,ai.NotSelected]));if("single"==e[3]||""==e[3])return G.talks(n,z.single(ai.NotSelected));var i=e[3].split(",");if(1==i.length){var r=e.length<5?Za.None:P.option(R.parse(e[4])),a=K.createTalkSelection(i[0],r);return G.talks(n,z.single(a))}if(3==i.length){var o=i.map(function(e){return K.createTalkSelection(e,Za.None)});return G.talks(n,z.multi(o))}}return G.unknown},K.createTalkSelection=function(e,t){if(e==K.ANNOUNCEMENTS_KEY)return ai.AnnouncementsSelected;var n=R.parse(e);return null==n?ai.NotSelected:ai.TalkSelected(n,t)},K.createFragment=function(e,t){switch(e[1]){case 1:return"/";case 2:var n=e[2];return"/"+Ga.toString(n)+"/";case 3:var i=e[2];return"/"+Ga.toString(i)+"/members";case 4:var r=e[3],a=e[2];switch(r[1]){case 0:var o="/"+r[2].map(K.createTalkPartFragment).join(",");return"/"+Ga.toString(a)+"/talks"+o;case 1:var s=r[2],l=K.createTalkPartFragment(s),u=B.isEmpty(l)?"":"/"+l;return"/"+Ga.toString(a)+"/talks"+u}break;case 5:var c=e[2];return"/"+Ga.toString(c)+"/actions";case 6:var _=e[2];return"/"+Ga.toString(_)+"/bookmarks";case 7:var h=e[2];return"/"+Ga.toString(h)+"/scheduled_messages";case 8:var d,f=e[2];switch(P.option(f)[1]){case 0:d=P.option(f);break;case 1:d=t.getLastSelectedDomainId()}var m=P.map(d,function(e){return"/"+Ga.toString(e)+"/settings"});switch(m[1]){case 0:return m[2];case 1:return"/settings"}break;case 10:case 11:return"/"+g.string(e);case 12:var p,v=e[2];switch(P.option(v)[1]){case 0:p=P.option(v);break;case 1:p=t.getLastSelectedDomainId()}var S=P.map(p,function(e){return"/"+Ga.toString(e)+"/environment"});switch(S[1]){case 0:return S[2];case 1:return"/environment"}break;case 13:var y=e[2];return"/"+Ga.toString(y)+"/apps";default:return null}},K.createTalkPartFragment=function(e){switch(e[1]){case 0:return"";case 1:var t,n=e[3],i=e[2],r=P.map(n,function(e){return"/"+Ga.toString(e)});switch(r[1]){case 0:t=r[2];break;case 1:t=""}return Ga.toString(i)+t;case 2:return K.ANNOUNCEMENTS_KEY}};var W=function(){};n["albero.IUrlConverterDelegate"]=W,W.__name__=["albero","IUrlConverterDelegate"],W.prototype={__class__:W};var j=function(){};n["puremvc.interfaces.INotifier"]=j,j.__name__=["puremvc","interfaces","INotifier"],j.prototype={__class__:j};var V=function(){this.facade=I.getInstance()};n["puremvc.patterns.observer.Notifier"]=V,V.__name__=["puremvc","patterns","observer","Notifier"],V.__interfaces__=[j],V.prototype={sendNotification:function(e,t,n){this.facade.sendNotification(e,t,n)},__class__:V};var q=function(){};n["puremvc.interfaces.ICommand"]=q,q.__name__=["puremvc","interfaces","ICommand"],q.prototype={__class__:q};var Q=function(){V.call(this)};n["puremvc.patterns.command.SimpleCommand"]=Q,Q.__name__=["puremvc","patterns","command","SimpleCommand"],Q.__interfaces__=[q],Q.__super__=V,Q.prototype=r(V.prototype,{execute:function(e){},__class__:Q});var J=function(){Q.call(this),E.getInstance().autoBind(this)};n["albero.command.AutoBindCommand"]=J,J.__name__=["albero","command","AutoBindCommand"],J.__super__=Q,J.prototype=r(Q.prototype,{__class__:J});var X=function(){J.call(this)};n["albero.command.AccountControlRequestCommand"]=X,X.__name__=["albero","command","AccountControlRequestCommand"],X.__super__=J,X.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.api.acceptAccountControlRequest(n);break;case 1:var i=t[2];this.api.rejectAccountControlRequest(i)}},__class__:X});var Z=n["albero.command.AccountControlRequestAction"]={__ename__:["albero","command","AccountControlRequestAction"],__constructs__:["ACCEPT_REQUEST","REJECT_REQUEST"]};Z.ACCEPT_REQUEST=function(e){var t=["ACCEPT_REQUEST",0,e];return t.__enum__=Z,t.toString=i,t},Z.REJECT_REQUEST=function(e){var t=["REJECT_REQUEST",1,e];return t.__enum__=Z,t.toString=i,t},Z.__empty_constructs__=[];var $=function(){J.call(this)};n["albero.command.ConferenceCommand"]=$,$.__name__=["albero","command","ConferenceCommand"],$.__super__=J,$.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.api.joinConference(i,n);break;case 1:var r=t[2];this.api.leaveConference(r);var a=this.dataStore.getConference(r);if(null==a||!a.isExpired())return;this.dataStore.removeConference(a),this.sendNotification("notify_close_conference",a);break;case 2:var o=t[2];this.api.rejectConference(o);break;case 3:var s=t[2];this.api.getConferenceParticipants(s)}},__class__:$});var ee=n["albero.command.ConferenceAction"]={__ename__:["albero","command","ConferenceAction"],__constructs__:["JOIN_CONFERENCE","LEAVE_CONFERENCE","REJECT_CONFERENCE","GET_CONFERENCE_PARTICIPANTS"]};ee.JOIN_CONFERENCE=function(e,t){var n=["JOIN_CONFERENCE",0,e,t];return n.__enum__=ee,n.toString=i,n},ee.LEAVE_CONFERENCE=function(e){var t=["LEAVE_CONFERENCE",1,e];return t.__enum__=ee,t.toString=i,t},ee.REJECT_CONFERENCE=function(e){var t=["REJECT_CONFERENCE",2,e];return t.__enum__=ee,t.toString=i,t},ee.GET_CONFERENCE_PARTICIPANTS=function(e){var t=["GET_CONFERENCE_PARTICIPANTS",3,e];return t.__enum__=ee,t.toString=i,t},ee.__empty_constructs__=[];var te=function(){J.call(this)};n["albero.command.DeviceCommand"]=te,te.__name__=["albero","command","DeviceCommand"],te.__super__=J,te.prototype=r(J.prototype,{execute:function(e){e.getBody()},__class__:te});var ne=n["albero.command.DeviceAction"]={__ename__:["albero","command","DeviceAction"],__constructs__:["AUTHORIZE"]};ne.AUTHORIZE=["AUTHORIZE",0],ne.AUTHORIZE.toString=i,ne.AUTHORIZE.__enum__=ne,ne.__empty_constructs__=[ne.AUTHORIZE];var ie=function(){J.call(this)};n["albero.command.DomainCommand"]=ie,ie.__name__=["albero","command","DomainCommand"],ie.__super__=J,ie.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.api.acceptDomainInvite(n);break;case 1:var i=t[2];this.api.deleteDomainInvite(i);break;case 2:var r=t[2];this.api.leaveDomain(r)}},__class__:ie});var re=n["albero.command.DomainAction"]={__ename__:["albero","command","DomainAction"],__constructs__:["ACCEPT_INVITE","DELETE_INVITE","LEAVE"]};re.ACCEPT_INVITE=function(e){var t=["ACCEPT_INVITE",0,e];return t.__enum__=re,t.toString=i,t},re.DELETE_INVITE=function(e){var t=["DELETE_INVITE",1,e];return t.__enum__=re,t.toString=i,t},re.LEAVE=function(e){var t=["LEAVE",2,e];return t.__enum__=re,t.toString=i,t},re.__empty_constructs__=[];var ae=function(){J.call(this)};n["albero.command.FileCommand"]=ae,ae.__name__=["albero","command","FileCommand"],ae.__super__=J,ae.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.api.uploadV2(i.domainId,i.id,n);break;case 1:var r=t[4],a=t[3],o=t[2];this.api.uploadMultiV2(o.domainId,o.id,a,r);break;case 2:var s=t[2];s.deleted=!0,this.api.deleteAttachment(s.id,s.messageId);break;case 3:var l=t[6],u=t[5],c=t[4],_=t[3],h=t[2];this.api.createDownloadAuth(h,_,c,u,l)}},__class__:ae});var oe=n["albero.command.FileAction"]={__ename__:["albero","command","FileAction"],__constructs__:["UPLOAD","UPLOAD_MULTI","DELETE","AUTH"]};oe.UPLOAD=function(e,t){var n=["UPLOAD",0,e,t];return n.__enum__=oe,n.toString=i,n},oe.UPLOAD_MULTI=function(e,t,n){var r=["UPLOAD_MULTI",1,e,t,n];return r.__enum__=oe,r.toString=i,r},oe.DELETE=function(e){var t=["DELETE",2,e];return t.__enum__=oe,t.toString=i,t},oe.AUTH=function(e,t,n,r,a){var o=["AUTH",3,e,t,n,r,a];return o.__enum__=oe,o.toString=i,o},oe.__empty_constructs__=[];var se=function(){J.call(this)};n["albero.command.FilePreviewCommand"]=se,se.__name__=["albero","command","FilePreviewCommand"],se.__super__=J,se.prototype=r(J.prototype,{get:function(e){return this.api.getFilePreview(e)},create:function(e){return this.api.createFilePreview(e)},__class__:se});var le=function(){J.call(this)};n["albero.command.LoadStampsetCommand"]=le,le.__name__=["albero","command","LoadStampsetCommand"],le.__super__=J,le.prototype=r(J.prototype,{execute:function(e){e.getBody();this.loadCommonStampset()},getOriginalStampset:function(e){var t=ce.getInstance(),n=t.get(e);if(null!=n)return n;var i=this.api.getStampsets([e]);return t.add(e,i),i.then(function(n){t.remove(e)},function(n){t.remove(e)}),i},getOriginalStamp:function(e){var t=this,n=this.dataStore.getOriginalStamp(e.stampId);return null!=n?Promise.resolve(n):this.getOriginalStampset(e.stampsetId).then(function(n){var i=t.dataStore.getOriginalStamp(e.stampId);return null==i?Promise.reject("stamp_not_found"):Promise.resolve(i)})},loadCommonStampset:function(){},__class__:le});var ue=n["albero.command.LoadStampsetAction"]={__ename__:["albero","command","LoadStampsetAction"],__constructs__:["COMMON"]};ue.COMMON=["COMMON",0],ue.COMMON.toString=i,ue.COMMON.__enum__=ue,ue.__empty_constructs__=[ue.COMMON];var ce=function(){this.loadings=new eo};n["albero.command.StampsetLoadingPromises"]=ce,ce.__name__=["albero","command","StampsetLoadingPromises"],ce.getInstance=function(){return null==ce.instance&&(ce.instance=new ce),ce.instance},ce.prototype={get:function(e){var t="_"+e.high+"_"+e.low,n=this.loadings;return null!=Jo[t]?n.getReserved(t):n.h[t]},add:function(e,t){var n="_"+e.high+"_"+e.low,i=this.loadings;null!=Jo[n]?i.setReserved(n,t):i.h[n]=t},remove:function(e){this.loadings.remove("_"+e.high+"_"+e.low)},__class__:ce};var _e=function(){J.call(this)};n["albero.command.ManageFriendsCommand"]=_e,_e.__name__=["albero","command","ManageFriendsCommand"],_e.__super__=J,_e.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t.action[1]){case 0:for(var n=0,i=t.users;n<i.length;){var r=i[n];++n,this.api.addFriend(r)}break;case 1:for(var a=0,o=t.users;a<o.length;){var s=o[a];++a,this.api.deleteFriend(s)}}},__class__:_e});var he=n["albero.command.ManageFriendsAction"]={__ename__:["albero","command","ManageFriendsAction"],__constructs__:["ADD","DELETE"]};he.ADD=["ADD",0],he.ADD.toString=i,he.ADD.__enum__=he,he.DELETE=["DELETE",1],he.DELETE.toString=i,he.DELETE.__enum__=he,he.__empty_constructs__=[he.ADD,he.DELETE];var de=function(){J.call(this)};n["albero.command.MessageCommand"]=de,de.__name__=["albero","command","MessageCommand"],de.__super__=J,de.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.api.deleteMessage(i,n);break;case 1:var r=t[3],a=t[2];this.api.forwardMessages(a,r,0);break;case 2:var o=t[4],s=t[3],l=t[2];this.api.addFavoriteMessage(l,s,o);break;case 3:var u=t[3],c=t[2];this.api.deleteFavoriteMessage(c,u);break;case 4:var _=t[4],h=t[3],d=t[2];this.api.getFavoriteMessages(d,h,_)}},__class__:de});var fe=n["albero.command.MessageAction"]={__ename__:["albero","command","MessageAction"],__constructs__:["DELETE","FORWARD","ADD_FAVORITE","DELETE_FAVORITE","GET_FAVORITES"]};fe.DELETE=function(e,t){var n=["DELETE",0,e,t];return n.__enum__=fe,n.toString=i,n},fe.FORWARD=function(e,t){var n=["FORWARD",1,e,t];return n.__enum__=fe,n.toString=i,n},fe.ADD_FAVORITE=function(e,t,n){var r=["ADD_FAVORITE",2,e,t,n];return r.__enum__=fe,r.toString=i,r},fe.DELETE_FAVORITE=function(e,t){var n=["DELETE_FAVORITE",3,e,t];return n.__enum__=fe,n.toString=i,n},fe.GET_FAVORITES=function(e,t,n){var r=["GET_FAVORITES",4,e,t,n];return r.__enum__=fe,r.toString=i,r},fe.__empty_constructs__=[];var me=function(){J.call(this)};n["albero.command.MessageReactionCommand"]=me,me.__name__=["albero","command","MessageReactionCommand"],me.__super__=J,me.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[4],i=t[3],r=t[2];this.api.setMessageReaction(r,i,n);break;case 1:var a=t[3],o=t[2];this.api.resetMessageReaction(o,a);break;case 2:var s=t[3],l=t[2];this.api.getMessageReactionSummaries(l,s);break;case 3:var u=t[2];this.api.getAvailableMessageReactions(u)}},getMessageReactionUsersUsers:function(e,t){var n=this.dataStore.getMessageReactionUsers(t);return null!=n?Promise.resolve(n):this.api.getMessageReactionUsers(e,t)},__class__:me});var pe=n["albero.command.MessageReactionAction"]={__ename__:["albero","command","MessageReactionAction"],__constructs__:["SET_MY_REACTION","RESET_MY_REACTION","GET_SUMMARIES","GET_AVAILABLE_REACTIONS"]};pe.SET_MY_REACTION=function(e,t,n){var r=["SET_MY_REACTION",0,e,t,n];return r.__enum__=pe,r.toString=i,r},pe.RESET_MY_REACTION=function(e,t){var n=["RESET_MY_REACTION",1,e,t];return n.__enum__=pe,n.toString=i,n},pe.GET_SUMMARIES=function(e,t){var n=["GET_SUMMARIES",2,e,t];return n.__enum__=pe,n.toString=i,n},pe.GET_AVAILABLE_REACTIONS=function(e){var t=["GET_AVAILABLE_REACTIONS",3,e];return t.__enum__=pe,t.toString=i,t},pe.__empty_constructs__=[];var ge=function(){J.call(this)};n["albero.command.NoteCommand"]=ge,ge.__name__=["albero","command","NoteCommand"],ge.__super__=J,ge.prototype=r(J.prototype,{execute:function(e){var t=this,n=e.getBody();switch(n[1]){case 0:var i=n[3],r=n[2];this.api.getNoteStatuses(r,i);break;case 1:var a=n[2];this.api.getNote(a);break;case 2:n[3];var o=n[2];Yr.delayForReplicationLag().then(function(e){t.api.getNote(o)});break;case 3:var s=n[4],l=n[3],u=n[2];this.api.createNoteV2(u,l,s);break;case 4:var c=n[5],_=n[4],h=n[3],d=n[2],f=this.createNoteLocalEdit(d,h,c);this.api.createNoteV2(d,f,_);break;case 5:var m=n[4],p=n[3],g=n[2];this.api.updateNoteSetting(g,p,m);break;case 6:var v=n[5],S=n[4],y=n[3],w=n[2];this.api.updateNoteV2(w,y,S,v);break;case 7:var T=n[2];this.api.deleteNote(T);break;case 8:var I=n[2];this.dataStore.setNoteLocalEdit(I,null)}},createNoteLocalEdit:function(e,t,n){var i=$i.createDummyId(),r=this.createNoteAttachmentFileInfoList(e,t.attachments);return new er(e,i,t.title,t.content,r,n)},createNoteAttachmentFileInfoList:function(e,t){for(var n=[],i=0;i<t.length;){var r=t[i];++i;var a=this.fileService.createDummyFile(r.path,r.name,r.type);n.push(xt.createStagedFileInfoFromDummyFile(e,a,null))}return n},updateNote:function(e,t,n,i){return this.api.updateNoteV2(e,t,n,i)},lockNote:function(e,t){return this.api.lockNote(e,t)},unlockNote:function(e,t){return this.api.unlockNote(e,t)},__class__:ge});var ve=n["albero.command.NoteAction"]={__ename__:["albero","command","NoteAction"],__constructs__:["GET_NOTE_STATUSES","GET_NOTE","GET_NOTE_ON_NOTIFY_UPDATE","CREATE_NOTE","CREATE_NOTE_FOR_HUBOT","UPDATE_NOTE_SETTING","UPDATE_NOTE","DELETE_NOTE","DELETE_NOTE_LOCAL_EDIT"]};ve.GET_NOTE_STATUSES=function(e,t){var n=["GET_NOTE_STATUSES",0,e,t];return n.__enum__=ve,n.toString=i,n},ve.GET_NOTE=function(e){var t=["GET_NOTE",1,e];return t.__enum__=ve,t.toString=i,t},ve.GET_NOTE_ON_NOTIFY_UPDATE=function(e,t){var n=["GET_NOTE_ON_NOTIFY_UPDATE",2,e,t];return n.__enum__=ve,n.toString=i,n},ve.CREATE_NOTE=function(e,t,n){var r=["CREATE_NOTE",3,e,t,n];return r.__enum__=ve,r.toString=i,r},ve.CREATE_NOTE_FOR_HUBOT=function(e,t,n,r){var a=["CREATE_NOTE_FOR_HUBOT",4,e,t,n,r];return a.__enum__=ve,a.toString=i,a},ve.UPDATE_NOTE_SETTING=function(e,t,n){var r=["UPDATE_NOTE_SETTING",5,e,t,n];return r.__enum__=ve,r.toString=i,r},ve.UPDATE_NOTE=function(e,t,n,r){var a=["UPDATE_NOTE",6,e,t,n,r];return a.__enum__=ve,a.toString=i,a},ve.DELETE_NOTE=function(e){var t=["DELETE_NOTE",7,e];return t.__enum__=ve,t.toString=i,t},ve.DELETE_NOTE_LOCAL_EDIT=function(e){var t=["DELETE_NOTE_LOCAL_EDIT",8,e];return t.__enum__=ve,t.toString=i,t},ve.__empty_constructs__=[];var Se=function(){J.call(this)};n["albero.command.ReadCommand"]=Se,Se.__name__=["albero","command","ReadCommand"],Se.__super__=J,Se.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.readStatusUpdater.updateReadStatuses(i,n);break;case 1:var r=t[3],a=t[2];this.readStatusUpdater.updateAnnouncementReadStatus(a,r);break;case 2:var o=t[3],s=t[2];this.api.getReadStatus(s,o);break;case 3:var l=t[3],u=t[2];this.keywordWatcher.readKeywordDetection(u,null,l);break;case 4:var c=t[3],_=t[2];this.keywordWatcher.readKeywordDetection(null,_,c)}},__class__:Se});var ye=n["albero.command.ReadType"]={__ename__:["albero","command","ReadType"],__constructs__:["TALK","ANNOUNCEMENT","READ_STATUS","KEYWORD_IN_ANNOUNCEMENTS","KEYWORD_IN_MESSAGES"]};ye.TALK=function(e,t){var n=["TALK",0,e,t];return n.__enum__=ye,n.toString=i,n},ye.ANNOUNCEMENT=function(e,t){var n=["ANNOUNCEMENT",1,e,t];return n.__enum__=ye,n.toString=i,n},ye.READ_STATUS=function(e,t){var n=["READ_STATUS",2,e,t];return n.__enum__=ye,n.toString=i,n},ye.KEYWORD_IN_ANNOUNCEMENTS=function(e,t){var n=["KEYWORD_IN_ANNOUNCEMENTS",3,e,t];return n.__enum__=ye,n.toString=i,n},ye.KEYWORD_IN_MESSAGES=function(e,t){var n=["KEYWORD_IN_MESSAGES",4,e,t];return n.__enum__=ye,n.toString=i,n},ye.__empty_constructs__=[];var we=function(){J.call(this)};n["albero.command.ReloadDataCommand"]=we,we.__name__=["albero","command","ReloadDataCommand"],we.__super__=J,we.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:this.api.getDomains();break;case 1:this.api.getFriends(),this.api.getAcquaintances();break;case 2:this.api.getTalks();break;case 3:var n=t[5],i=t[4],r=t[3],a=t[2];this.api.getMessages(a,r,i,n);break;case 4:var o=t[2];this.api.getAllUsers(o);break;case 5:var s=t[3],l=t[2];this.api.getUsers(l,s);break;case 6:var u=t[3],c=t[2];this.api.getProfile(c,u);break;case 7:var _=t[3],h=t[2];this.api.searchDomainUsers(h,_);break;case 8:var d=t[4],f=t[3],m=t[2];this.api.getAnnouncements(m,f,d);break;case 9:var p=t[5],g=t[4],v=t[3],S=t[2];this.api.getQuestions(S,v,g,p);break;case 10:var y=t[3],w=t[2];this.api.getQuestion(w,y);break;case 11:var T=t[3],I=t[2];this.api.getAttachments(I,T);break;case 12:var E=t[3],N=t[2];this.api.getSolutions(N,E);break;case 13:this.api.getMe();break;case 14:var A=t[2];this.api.getDepartmentTree(A);break;case 15:var b=t[3],D=t[2];this.api.getDepartmentUsers(D,b);break;case 16:var M=t[2];this.api.getDepartmentAllUsers(M);break;case 17:var C=t[3],k=t[2];this.api.getDepartmentUserCount(k,C)}},__class__:we});var Te=n["albero.command.ReloadDataType"]={__ename__:["albero","command","ReloadDataType"],__constructs__:["Domains","Friends","Talks","Messages","AllUsers","GetUsers","GetProfile","SearchDomainUsers","Announcements","Questions","Question","Files","Solutions","Me","DepartmentTree","DepartmentUsers","DepartmentAllUsers","DepartmentUserCount"]};Te.Domains=["Domains",0],Te.Domains.toString=i,Te.Domains.__enum__=Te,Te.Friends=["Friends",1],Te.Friends.toString=i,Te.Friends.__enum__=Te,Te.Talks=["Talks",2],Te.Talks.toString=i,Te.Talks.__enum__=Te,Te.Messages=function(e,t,n,r){var a=["Messages",3,e,t,n,r];return a.__enum__=Te,a.toString=i,a},Te.AllUsers=function(e){var t=["AllUsers",4,e];return t.__enum__=Te,t.toString=i,t},Te.GetUsers=function(e,t){var n=["GetUsers",5,e,t];return n.__enum__=Te,n.toString=i,n},Te.GetProfile=function(e,t){var n=["GetProfile",6,e,t];return n.__enum__=Te,n.toString=i,n},Te.SearchDomainUsers=function(e,t){var n=["SearchDomainUsers",7,e,t];return n.__enum__=Te,n.toString=i,n},Te.Announcements=function(e,t,n){var r=["Announcements",8,e,t,n];return r.__enum__=Te,r.toString=i,r},Te.Questions=function(e,t,n,r){var a=["Questions",9,e,t,n,r];return a.__enum__=Te,a.toString=i,a},Te.Question=function(e,t){var n=["Question",10,e,t];return n.__enum__=Te,n.toString=i,n},Te.Files=function(e,t){var n=["Files",11,e,t];return n.__enum__=Te,n.toString=i,n},Te.Solutions=function(e,t){var n=["Solutions",12,e,t];return n.__enum__=Te,n.toString=i,n},Te.Me=["Me",13],Te.Me.toString=i,Te.Me.__enum__=Te,Te.DepartmentTree=function(e){var t=["DepartmentTree",14,e];return t.__enum__=Te,t.toString=i,t},Te.DepartmentUsers=function(e,t){var n=["DepartmentUsers",15,e,t];return n.__enum__=Te,n.toString=i,n},Te.DepartmentAllUsers=function(e){var t=["DepartmentAllUsers",16,e];return t.__enum__=Te,t.toString=i,t},Te.DepartmentUserCount=function(e,t){var n=["DepartmentUserCount",17,e,t];return n.__enum__=Te,n.toString=i,n},Te.__empty_constructs__=[Te.Domains,Te.Friends,Te.Talks,Te.Me];var Ie=function(){J.call(this)};n["albero.command.ScheduleMessageCommand"]=Ie,Ie.__name__=["albero","command","ScheduleMessageCommand"],Ie.__super__=J,Ie.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2];this.api.getScheduledMessages(i,n,!0);break;case 1:var r=t[3],a=t[2];this.api.getScheduledMessages(a,r,!1);break;case 2:var o=t[3],s=t[2];this.api.scheduleMessage(s,o.talkId,o.type,o.content);break;case 3:var l=t[4],u=t[3],c=t[2];this.api.scheduleFileMessage(c,u.domainId,u.id,l);break;case 4:var _=t[5],h=t[4],d=t[3],f=t[2];this.api.scheduleFilesMessage(f,d.domainId,d.id,h,_);break;case 5:var m=t[2];this.api.deleteScheduledMessage(m)}},__class__:Ie});var Ee=n["albero.command.ScheduleMessageAction"]={__ename__:["albero","command","ScheduleMessageAction"],__constructs__:["RELOAD","GET","SCHEDULE","SCHEDULE_UPLOAD","SCHEDULE_UPLOAD_MULTI","DELETE"]};Ee.RELOAD=function(e,t){var n=["RELOAD",0,e,t];return n.__enum__=Ee,n.toString=i,n},Ee.GET=function(e,t){var n=["GET",1,e,t];return n.__enum__=Ee,n.toString=i,n},Ee.SCHEDULE=function(e,t){var n=["SCHEDULE",2,e,t];return n.__enum__=Ee,n.toString=i,n},Ee.SCHEDULE_UPLOAD=function(e,t,n){var r=["SCHEDULE_UPLOAD",3,e,t,n];return r.__enum__=Ee,r.toString=i,r},Ee.SCHEDULE_UPLOAD_MULTI=function(e,t,n,r){var a=["SCHEDULE_UPLOAD_MULTI",4,e,t,n,r];return a.__enum__=Ee,a.toString=i,a},Ee.DELETE=function(e){var t=["DELETE",5,e];return t.__enum__=Ee,t.toString=i,t},Ee.__empty_constructs__=[];var Ne=function(){J.call(this)};n["albero.command.SearchCommand"]=Ne,Ne.__name__=["albero","command","SearchCommand"],Ne.__super__=J,Ne.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[4],i=t[3],r=t[2];if(this.searchService.isSearching())return;switch(null==n&&this.searchService.saveParams(r),r.searchType[1]){case 0:this.api.searchMessages(r.copy(),i,n);break;case 1:this.api.searchAttachments(r.copy(),i,n)}break;case 1:this.searchService.clearEditingParams(),this.searchService.clearRecentParams(),this.searchService.clearSearching(),this.sendNotification("notify_search_clear",{})}},searchMessagesAroundDateTime:function(e,t){return this.api.searchMessagesAroundDateTime(e,t)},__class__:Ne});var Ae=n["albero.command.SearchAction"]={__ename__:["albero","command","SearchAction"],__constructs__:["SEARCH","CLEAR"]};Ae.SEARCH=function(e,t,n){var r=["SEARCH",0,e,t,n];return r.__enum__=Ae,r.toString=i,r},Ae.CLEAR=["CLEAR",1],Ae.CLEAR.toString=i,Ae.CLEAR.__enum__=Ae,Ae.__empty_constructs__=[Ae.CLEAR];var be=function(){J.call(this)};n["albero.command.SelectTalkCommand"]=be,be.__name__=["albero","command","SelectTalkCommand"],be.__super__=J,be.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[3],i=t[2],r=new ni(i,ai.NotSelected);this.sendNotification("Url",Le.REDIRECT(r.createUrls(n,this.settings)));break;case 1:var a=t[4],o=t[3],s=t[2],u=new ni(s,ai.TalkSelected(o.id,Za.Some(a)));this.sendNotification("Url",Le.REDIRECT(u.createUrls(o.domainId,this.settings)));break;case 2:var c=t[3],_=t[2],h=new ni(_,ai.TalkSelected(c.id,Za.None));this.sendNotification("Url",Le.REDIRECT(h.createUrls(c.domainId,this.settings)));break;case 3:var d=t[3],f=t[2],m=new ni(f,ai.AnnouncementsSelected);this.sendNotification("Url",Le.REDIRECT(m.createUrls(d,this.settings)));break;case 4:var p=t[4],g=t[3],v=t[2],S=this.getFallbackUrls(v,l.array(g));if(P.isEmpty(S)){var y=Ro(this,this.updateSelectionIfNeed),w=v,T=p;l.iter(g,function(e){y(w,T,e)})}else{var I=P.get(S);this.sendNotification("routing_talk_fallback",I)}}},updateSelectionIfNeed:function(e,t,n){if(t||!this.isSelectionParametersNotChanged(e,n)){var i=n.talkSelection;switch(i[1]){case 0:this.settings.clearSelectedTalk(n.paneType);break;case 1:var r=i[3],a=i[2];this.settings.selectTalk(n.paneType,e,a,r);break;case 2:this.settings.selectAnnouncement(n.paneType)}}},isSelectionParametersNotChanged:function(e,t){var n=this.settings.getSelectedDomainIdOnTalkSelectionChanged();return null!=e&&null!=n&&e.high==n.high&&e.low==n.low&&oi.eqTalkSelection(t.talkSelection,this.settings.getTalkSelection(e,t.paneType))},getFallbackUrls:function(e,t){var n=Ro(this,this.getValidTalkSelection),i=e,r=t.map(function(e){return n(i,e)});if(!l.exists(r,P.isEmpty))return Za.None;var a=r.map(Ro(this,this.getOrNotSelected)),o=1==r.length?z.single(a[0]):z.multi(a);return Za.Some(G.talks(e,o))},getOrNotSelected:function(e){switch(e[1]){case 0:return e[2];case 1:return ai.NotSelected}},getValidTalkSelection:function(e,t){var n=t.talkSelection;switch(n[1]){case 0:break;case 1:n[3];var i,r=n[2],a=this.dataStore.getTalk(r);if(null!=a){var o=a.domainId;i=!(null!=o&&null!=e&&o.high==e.high&&o.low==e.low)}else i=!0;if(i)return Za.None;break;case 2:var s=this.dataStore.getDomain(e),l=this.dataStore.getAnnouncementStatus(e);if(!Qe.hasAnnouncement(s,l))return Za.None}return Za.Some(t.talkSelection)},__class__:be});var De=n["albero.command.SelectTalkAction"]={__ename__:["albero","command","SelectTalkAction"],__constructs__:["SelectNone","SelectTalkAndMessage","SelectTalk","SelectAnnouncement","UpdateSelection"]};De.SelectNone=function(e,t){var n=["SelectNone",0,e,t];return n.__enum__=De,n.toString=i,n},De.SelectTalkAndMessage=function(e,t,n){var r=["SelectTalkAndMessage",1,e,t,n];return r.__enum__=De,r.toString=i,r},De.SelectTalk=function(e,t){var n=["SelectTalk",2,e,t];return n.__enum__=De,n.toString=i,n},De.SelectAnnouncement=function(e,t){var n=["SelectAnnouncement",3,e,t];return n.__enum__=De,n.toString=i,n},De.UpdateSelection=function(e,t,n){var r=["UpdateSelection",4,e,t,n];return r.__enum__=De,r.toString=i,r},De.__empty_constructs__=[];var Me=function(){J.call(this)};n["albero.command.SendCommand"]=Me,Me.__name__=["albero","command","SendCommand"],Me.__super__=J,Me.prototype=r(J.prototype,{execute:function(e){var t,n=e.getBody();if(null!=n.id){var i=n.id;t="_"+i.high+"_"+i.low}else t=null;null!=n.talkId?this.api.createMessage(n.talkId,n.type,n.content,t):this.api.createAnnouncement(n.domainId,n.type,n.content,t)},__class__:Me});var Ce=function(){J.call(this)};n["albero.command.SignInCommand"]=Ce,Ce.__name__=["albero","command","SignInCommand"],Ce.__super__=J,Ce.prototype=r(J.prototype,{execute:function(e){this.accessTokenResolver.asyncGetAccessToken(e.getBody(),Ro(ko=this.session,ko.start))},__class__:Ce});var ke=function(){J.call(this)};n["albero.command.SignOutCommand"]=ke,ke.__name__=["albero","command","SignOutCommand"],ke.__super__=J,ke.prototype=r(J.prototype,{execute:function(e){this.api.deleteSession(),this.settings.clearInputTextForAll(),this.dataStore.clear(!0),this.sendNotification("signed_out")},__class__:ke});var Oe=function(){J.call(this)};n["albero.command.TalkCommand"]=Oe,Oe.__name__=["albero","command","TalkCommand"],Oe.__super__=J,Oe.prototype=r(J.prototype,{execute:function(e){var t=this,n=e.getBody();switch(n[1]){case 0:var i=n[4],r=n[3],a=n[2],o=this.dataStore.getValidPairTalk(r,a);null!=o?(this.sendNotification("SelectTalk",De.SelectTalk(i,o)),this.sendNotification("open_existing_pair_talk_completed")):this.api.createPairTalk(a,r,i);break;case 1:var s=n[5],l=n[4],u=n[3],c=n[2];this.api.createGroupTalk(c,u,l,s);break;case 2:var _=n[4],h=n[3],d=n[2];this.api.addTalkers(d,h,_);break;case 3:var f=n[2],m=this.dataStore.me.id;this.api.deleteTalker(f,m);break;case 4:var p=n[3],g=n[2],v=this.dataStore.getTalk(g);null==p&&(p=this.dataStore.me.id),this.api.deleteTalker(v,p);break;case 5:var S=n[6],y=n[5],w=n[4],T=n[3],I=n[2];if(I.type!=Zn.GroupTalk)return;null==S&&(S=ho.__cast(I,Jn).isSystemMessageVisibled()),this.prepareIconUrl(I.domainId,w,y,function(e){t.api.updateGroupTalk(I,T,e,S)});break;case 6:var E=n[6],N=n[5],A=n[4],b=n[3],D=n[2],M=this.dataStore.getTalk(D);if(M.type!=Zn.GroupTalk)return;null==E&&(E=ho.__cast(M,Jn).isSystemMessageVisibled()),this.prepareIconUrl(M.domainId,A,N,function(e){t.api.updateGroupTalk(M,b,e,E)});break;case 7:var C=n[3],k=n[2];this.api.addFavoriteTalk(k,C);break;case 8:var O=n[3],R=n[2];this.api.deleteFavoriteTalk(R,O);break;case 9:var F=n[3],U=n[2];this.api.disablePushNotification(U,F);break;case 10:var x=n[4],P=n[3],L=n[2];this.api.enablePushNotification(L,P,x)}},prepareIconUrl:function(e,t,n,i){var r=this;null==n&&null!=t?this.api.uploadFile(t,e,di.TALK_ICON,function(e){i(e.get_url)},function(e){r.sendNotification("update_group_talk_fail")}):i(n)},__class__:Oe});var Re=n["albero.command.TalkAction"]={__ename__:["albero","command","TalkAction"],__constructs__:["OPEN_PAIR_TALK","OPEN_GROUP_TALK","ADD","DELETE","DELETE_FOR_HUBOT","UPDATE","UPDATE_FOR_HUBOT","ADD_FAVORITE","DELETE_FAVORITE","DISABLE_PUSH_NOTIFICATION","ENABLE_PUSH_NOTIFICATION"]};Re.OPEN_PAIR_TALK=function(e,t,n){var r=["OPEN_PAIR_TALK",0,e,t,n];return r.__enum__=Re,r.toString=i,r},Re.OPEN_GROUP_TALK=function(e,t,n,r){var a=["OPEN_GROUP_TALK",1,e,t,n,r];return a.__enum__=Re,a.toString=i,a},Re.ADD=function(e,t,n){var r=["ADD",2,e,t,n];return r.__enum__=Re,r.toString=i,r},Re.DELETE=function(e){var t=["DELETE",3,e];return t.__enum__=Re,t.toString=i,t},Re.DELETE_FOR_HUBOT=function(e,t){var n=["DELETE_FOR_HUBOT",4,e,t];return n.__enum__=Re,n.toString=i,n},Re.UPDATE=function(e,t,n,r,a){var o=["UPDATE",5,e,t,n,r,a];return o.__enum__=Re,o.toString=i,o},Re.UPDATE_FOR_HUBOT=function(e,t,n,r,a){var o=["UPDATE_FOR_HUBOT",6,e,t,n,r,a];return o.__enum__=Re,o.toString=i,o},Re.ADD_FAVORITE=function(e,t){var n=["ADD_FAVORITE",7,e,t];return n.__enum__=Re,n.toString=i,n},Re.DELETE_FAVORITE=function(e,t){var n=["DELETE_FAVORITE",8,e,t];return n.__enum__=Re,n.toString=i,n},Re.DISABLE_PUSH_NOTIFICATION=function(e,t){var n=["DISABLE_PUSH_NOTIFICATION",9,e,t];return n.__enum__=Re,n.toString=i,n},Re.ENABLE_PUSH_NOTIFICATION=function(e,t,n){var r=["ENABLE_PUSH_NOTIFICATION",10,e,t,n];return r.__enum__=Re,r.toString=i,r},Re.__empty_constructs__=[];var Fe=function(){J.call(this)};n["albero.command.UpdateProfileCommand"]=Fe,Fe.__name__=["albero","command","UpdateProfileCommand"],Fe.__super__=J,Fe.prototype=r(J.prototype,{execute:function(e){var t=e.getBody().domainId,n=e.getBody().profileItemValues,i=e.getBody().copyToAllDomains,r=this.dataStore.getDomain(t);if(null!=r&&null!=r.profileDefinition.itemDefinitions){var a=[];if(i){for(var o=[],l=0;l<n.length;){var u=n[l];++l;var c=fn.findById(r.profileDefinition.itemDefinitions,u.profileItemId);null!=c&&o.push({name:c.name,value:u.value})}for(var _=0,h=this.dataStore.getDomains();_<h.length;){var d=h[_];if(++_,!d.domainInfo.frozen){for(var f=[],m=0,p=d.profileDefinition.itemDefinitions;m<p.length;){var g=p[m];if(++m,g.visible&&!g.locked)for(var v=0;v<o.length;){var S=o[v];if(++v,S.name==g.name){var y=new mn;y.profileItemId=g.profileItemId,y.value=S.value,f.push(y);break}}}f.length>0&&a.push(new pn(d.id,f))}}}else{for(var w=[],T=(s.iter(n),0);T<n.length;){var I=n[T];++T;var E=fn.findById(r.profileDefinition.itemDefinitions,I.profileItemId);null!=E&&E.visible&&!E.locked&&w.push(I)}w.length>0&&a.push(new pn(r.id,w))}0==a.length?this.sendNotification("update_profile_responsed",this.dataStore.me):this.api.updateProfile(a)}},__class__:Fe});var Ue=function(){J.call(this)};n["albero.command.UpdateUserCommand"]=Ue,Ue.__name__=["albero","command","UpdateUserCommand"],Ue.__super__=J,Ue.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();if(null!=t.profileImage){var n=t.profileImage;if(!S.startsWith(n.type,"image/"))return}this.api.updateUser(t.displayName,t.profileImage,t.profileImageUrl,t.phoneticDisplayName,t.status)},__class__:Ue});var xe=function(){J.call(this)};n["albero.command.UpdateUserPresencesCommand"]=xe,xe.__name__=["albero","command","UpdateUserPresencesCommand"],xe.__super__=J,xe.prototype=r(J.prototype,{execute:function(e){var t=e.getBody().domainId,n=e.getBody().userIds;if(null!=t&&null!=n){var i=this.filterOnlyExpired(R.unique(n));0!=i.length&&this.updateIfNeedPerSub(t,i)}},filterOnlyExpired:function(e){var t=this,n=M.nowAsInt64(),i=this.settings.getConfiguration().presenceExpiration,r=new pi(i>>31,i);return e.filter(function(e){var i=P.map(t.userPresences.getUserPresence(e),function(e){return e.isExpired(n,r)});switch(i[1]){case 0:return i[2];case 1:return!0}})},updateIfNeedPerSub:function(e,t){for(var n=this,i=Promise.resolve([]),r=R.splitUsingMaxCount(t,100),a=0;a<r.length;){var o=[r[a]];++a,i=i.then(function(t){return function(i){return n.api.getPresences(e,t[0])}}(o))}i.catch(function(e){})},__class__:xe});var Pe=function(){J.call(this)};n["albero.command.UrlCommand"]=Pe,Pe.__name__=["albero","command","UrlCommand"],Pe.__super__=J,Pe.prototype=r(J.prototype,{execute:function(e){var t=e.getBody();switch(t[1]){case 0:var n=t[2];this.routing.forward(n);break;case 1:var i=t[2];this.routing.redirect(i);break;case 2:var r=t[3],a=t[2];this.routing.redirect(a,r);break;case 3:this.routing.back()}},__class__:Pe});var Le=n["albero.command.UrlAction"]={__ename__:["albero","command","UrlAction"],__constructs__:["FORWARD","REDIRECT","REDIRECT_WITH_HISTORY_STATE","BACK"]};Le.FORWARD=function(e){var t=["FORWARD",0,e];return t.__enum__=Le,t.toString=i,t},Le.REDIRECT=function(e){var t=["REDIRECT",1,e];return t.__enum__=Le,t.toString=i,t},Le.REDIRECT_WITH_HISTORY_STATE=function(e,t){var n=["REDIRECT_WITH_HISTORY_STATE",2,e,t];return n.__enum__=Le,n.toString=i,n},Le.BACK=["BACK",3],Le.BACK.toString=i,Le.BACK.__enum__=Le,Le.__empty_constructs__=[Le.BACK];var Be=function(e,t,n){this.email=e,this.pass=t,this.accessToken=n};n["albero.entity.Account"]=Be,Be.__name__=["albero","entity","Account"],Be.prototype={__class__:Be};var Ge=function(e){null!=e&&(this.id=e.id,this.group=new He(e.group),this.profilePolicy=new ze(e.profile_policy))};n["albero.entity.AccountControlGroup"]=Ge,Ge.__name__=["albero","entity","AccountControlGroup"],Ge.prototype={isAllowedUpdateProfileImage:function(){return null==this.profilePolicy||this.profilePolicy.allowUpdateProfileImage},isAllowedUpdateDisplayName:function(){return null==this.profilePolicy||this.profilePolicy.allowUpdateDisplayName},__class__:Ge};var He=function(e){null!=e&&(this.name=e.name,this.alias=e.alias,this.ownerName=e.owner_name,this.version=e.version)};n["albero.entity.AccountControlGroupGroup"]=He,He.__name__=["albero","entity","AccountControlGroupGroup"],He.prototype={__class__:He};var ze=function(e){null!=e&&(this.allowUpdateDisplayName=e.allow_update_display_name,this.allowUpdateProfileImage=e.allow_update_profile_image,this.version=e.version)};n["albero.entity.AccountControlGroupProfilePolicy"]=ze,ze.__name__=["albero","entity","AccountControlGroupProfilePolicy"],ze.prototype={__class__:ze};var Ye=function(e){null!=e&&(this.id=e.id,null!=e.group&&(this.group=new He(e.group)),null!=e.profile_policy&&(this.profilePolicy=new ze(e.profile_policy)))};n["albero.entity.AccountControlGroupPartialUpdate"]=Ye,Ye.__name__=["albero","entity","AccountControlGroupPartialUpdate"],Ye.prototype={__class__:Ye};var Ke=function(e){null!=e&&(this.id=R.fromIntOrInt64(e.id),this.groupName=e.group_name,this.groupOwnerName=e.group_owner_name,this.groupOwnerEmail=e.group_owner_email,this.hasDomainInvite=e.has_domain_invite,this.updatedAt=e.updated_at,this.version=e.version)};n["albero.entity.AccountControlRequest"]=Ke,Ke.__name__=["albero","entity","AccountControlRequest"],Ke.prototype={__class__:Ke};var We=n["albero.entity.AllowAttachmentTypeValue"]={__ename__:["albero","entity","AllowAttachmentTypeValue"],__constructs__:["ng","ok","image","imageOrVideo","imageOrVideoOrAudio","other"]};We.ng=["ng",0],We.ng.toString=i,We.ng.__enum__=We,We.ok=["ok",1],We.ok.toString=i,We.ok.__enum__=We,We.image=["image",2],We.image.toString=i,We.image.__enum__=We,We.imageOrVideo=["imageOrVideo",3],We.imageOrVideo.toString=i,We.imageOrVideo.__enum__=We,We.imageOrVideoOrAudio=["imageOrVideoOrAudio",4],We.imageOrVideoOrAudio.toString=i,We.imageOrVideoOrAudio.__enum__=We,We.other=["other",5],We.other.toString=i,We.other.__enum__=We,We.__empty_constructs__=[We.ng,We.ok,We.image,We.imageOrVideo,We.imageOrVideoOrAudio,We.other];var je=function(e){this.value=e};n["albero.entity.AllowAttachmentType"]=je,je.__name__=["albero","entity","AllowAttachmentType"],je.fromInt=function(e){if(null==e)return new je(We.other);var t;if(null==e)t=We.other;else switch(e){case 0:t=We.ng;break;case 1:t=We.ok;break;case 2:t=We.image;break;case 3:t=We.imageOrVideo;break;case 4:t=We.imageOrVideoOrAudio;break;default:t=We.other}return new je(t)},je.fromValue=function(e){return new je(e)},je.createAttachmentErrorMessage=function(e,t,n){return null==n&&(n=""),e.compareStrongness(t)>0?e.createAttachmentErrorMessageByNetwork(n):t.createAttachmentErrorMessageByDomain(n)},je.prototype={compareStrongness:function(e){return this.getStrongness()-e.getStrongness()},getStrongness:function(){switch(this.value[1]){case 0:return 40;case 2:return 30;case 3:return 20;case 4:return 10;case 1:case 5:return 0}},createAttachmentErrorMessageByDomain:function(e){switch(null==e&&(e=""),this.value[1]){case 0:return Nr.localize("AllowAttachmentType.ban_attach_file")+e;case 2:return Nr.localize("AllowAttachmentType.ban_attach_file_without_img")+e;case 3:return Nr.localize("AllowAttachmentType.ban_attach_file_without_img_movie")+e;case 4:return Nr.localize("AllowAttachmentType.ban_attach_file_without_img_movie_sound")+e;default:return""}},createAttachmentErrorMessageByNetwork:function(e){switch(null==e&&(e=""),this.value[1]){case 0:return Nr.localize("AllowAttachmentType.network_ban_attach_file")+e;case 2:return Nr.localize("AllowAttachmentType.network_ban_attach_file_without_img")+e;case 3:return Nr.localize("AllowAttachmentType.network_ban_attach_file_without_img_movie")+e;case 4:return Nr.localize("AllowAttachmentType.network_ban_attach_file_without_img_movie_sound")+e;default:return""}},createAttachmentFilter:function(){switch(this.value[1]){case 0:return function(e){return!1};case 2:return function(e){return new o("image.*","").match(e.type)};case 3:return function(e){return new o("image.*|video.*","").match(e.type)};case 4:return function(e){return new o("image.*|video.*|audio.*","").match(e.type)};default:return function(e){return!0}}},createDataTransferItemFilter:function(){switch(this.value[1]){case 0:return function(e){return!1};case 2:var e=new o("image.*","");return function(t){return e.match(t.type)};case 3:var t=new o("image.*|video.*","");return function(e){return t.match(e.type)};case 4:var n=new o("image.*|video.*|audio.*","");return function(e){return n.match(e.type)};default:return function(e){return!0}}},__class__:je};var Ve=function(e){null!=e&&(this.id=e.announcement_id,this.domainId=e.domain_id,this.groupId=e.group_id,this.groupName=e.group_name,this.type=Zt.typeOf(e.type),this.content=e.content,this.userId=e.user_id,this.userName=e.user_name,this.createdAt=e.created_at)};n["albero.entity.Announcement"]=Ve,Ve.__name__=["albero","entity","Announcement"],Ve.prototype={getDisplayTextWithoutEscape:function(){return Zt.getDisplayTextWithoutEscape(this.type,this.content)},getNotificatoinTextWithoutEscape:function(e){switch(null==e&&(e=this.userName),null==e&&(e=""),this.type[1]){case 1:case 7:return e+":"+this.getDisplayTextWithoutEscape();default:return Ar._e("["+s.dateStr(new Date)+"] ","Unsupported announcement.type is detected. announcment:%o",this,"","",""),Zt.getUnsupportText()}},markAsDeleted:function(){this.type=$t.deleted,this.content=""},__class__:Ve};var qe=function(e){this.unreadCount=0,null!=e&&(this.domainId=e.domain_id,this.unreadCount=null!=e.unread_count?e.unread_count:0,this.maxAnnouncementId=e.max_announcement_id,null!=e.max_announcement&&(this.maxAnnouncement=new Ve(e.max_announcement)),this.maxReadAnnouncementId=e.max_read_announcement_id)};n["albero.entity.AnnouncementStatus"]=qe,qe.__name__=["albero","entity","AnnouncementStatus"],qe.fromDomainId=function(e){var t=new qe;return t.domainId=e,t},qe.prototype={updateReadWithStatusUpdate:function(e){var t=0,n=null;if(null!=e.readAnnouncementIds)for(var i=0,r=e.readAnnouncementIds;i<r.length;){var a,o=r[i];if(++i,null!=this.maxReadAnnouncementId){var s=this.maxReadAnnouncementId,l=o.high-s.high|0;l=0!=l?l:Ba.ucompare(o.low,s.low),a=(o.high<0?s.high<0?l:-1:s.high>=0?l:1)>0}else a=!0;if(a){var u;if(null!=n){var c=o.high-n.high|0;c=0!=c?c:Ba.ucompare(o.low,n.low),u=(o.high<0?n.high<0?c:-1:n.high>=0?c:1)>0}else u=!0;u&&(n=o),++t}}null!=n&&this.read(n,t)},updateByAnnouncementDeletion:function(e){var t,n=!1;if(this.isUnread(e)&&(this.decrementUnreadCount(1),n=!0),null!=this.maxAnnouncementId){var i=this.maxAnnouncementId;t=null!=i&&null!=e&&i.high==e.high&&i.low==e.low}else t=!1;return t&&null!=this.maxAnnouncement&&(this.maxAnnouncement.type=$t.deleted,this.maxAnnouncement.content="",n=!0),n},updateByAnnouncement:function(e){this.isNewMax(e.id)&&(this.maxAnnouncementId=e.id,this.maxAnnouncement=e),this.unreadCount++},updateByReadingAnnouncements:function(e){if(null==e||this.canRegardAnnouncementReadCountZero(e)){if(!Qe.isUnreadAnnouncementExisted(this))return!1;if(null==this.maxAnnouncementId)return!1;this.readAll()}else{var t=e.filter(Ro(this,this.isUnread));if(0==t.length)return!1;this.read(t[t.length-1],t.length)}return!0},canRegardAnnouncementReadCountZero:function(e){var t=this.maxAnnouncementId,n=P.orNull(U.lastOption(e));return null!=t&&null!=n&&t.high==n.high&&t.low==n.low},read:function(e,t){this.maxReadAnnouncementId=e,this.decrementUnreadCount(t);this.domainId,this.maxReadAnnouncementId,this.unreadCount},decrementUnreadCount:function(e){this.unreadCount-=e,this.unreadCount<0&&(this.unreadCount=0)},readAll:function(){this.maxReadAnnouncementId=this.maxAnnouncementId,this.unreadCount=0},isUnread:function(e){if(null!=this.maxReadAnnouncementId){var t=this.maxReadAnnouncementId,n=t.high-e.high|0;return n=0!=n?n:Ba.ucompare(t.low,e.low),(t.high<0?e.high<0?n:-1:e.high>=0?n:1)<0}return!0},isMax:function(e){if(null!=this.maxAnnouncementId){var t=this.maxAnnouncementId;return null!=t&&null!=e&&t.high==e.high&&t.low==e.low}return!1},isNewMax:function(e){if(null!=this.maxAnnouncementId){var t=this.maxAnnouncementId,n=t.high-e.high|0;return n=0!=n?n:Ba.ucompare(t.low,e.low),(t.high<0?e.high<0?n:-1:e.high>=0?n:1)<0}return!0},__class__:qe};var Qe=function(){};n["albero.entity.AnnouncementStatusHelper"]=Qe,Qe.__name__=["albero","entity","AnnouncementStatusHelper"],Qe.isUnreadAnnouncementExisted=function(e){return null!=e&&(null!=e.maxAnnouncement&&e.isUnread(e.maxAnnouncement.id))},Qe.hasAnnouncement=function(e,t){return!(null==e||!e.role.allowReadAnnouncements||null==t)&&null!=t.maxAnnouncementId};var Je=function(e){null!=e&&(this.domainId=e.domain_id,this.readAnnouncementIds=e.read_announcement_ids)};n["albero.entity.AnnouncementStatusUpdate"]=Je,Je.__name__=["albero","entity","AnnouncementStatusUpdate"],Je.prototype={__class__:Je};var Xe=function(){this.announcements=new eo};n["albero.entity.AnnouncementStore"]=Xe,Xe.__name__=["albero","entity","AnnouncementStore"],Xe.prototype={getAnnouncement:function(e){if(null==e)return null;var t="_"+e.high+"_"+e.low,n=this.announcements;return null!=Jo[t]?n.getReserved(t):n.h[t]},setAnnouncement:function(e){},removeAnnouncement:function(e){this.announcements.remove("_"+e.high+"_"+e.low)},__class__:Xe};var Ze=function(e){if(this.notificationInvisibleTalkSound=!0,this.notificationInvisibleTalkPopup=!1,this.notificationVisibleTalkSound=!1,this.notificationVisibleTalkPopup=!1,this.notificationIncludingMessageContent=!0,this.notificationPopupTime=5,this.talkAutoScroll=1,this.talksSortMode="new_messages_first",this.talkRightPanelOpened=!0,this.talkRightPanelWidth=0,this.keywordWatchingText="",this.keywordWatchingEmphasis=!1,this.keywordWatchingSelfMessage=!1,this.keywordWatchingActionReply=!1,this.userDataContainer=[],this.language="ja",this.conferenceIncomingSound=!0,this.domainsSortMode="name_order_asc",this.appLeftPanelOpened=!1,null!=e){if(null!=e.notificationInvisibleTalkSound&&(this.notificationInvisibleTalkSound=e.notificationInvisibleTalkSound),null!=e.notificationInvisibleTalkPopup&&(this.notificationInvisibleTalkPopup=e.notificationInvisibleTalkPopup),null!=e.notificationVisibleTalkSound&&(this.notificationVisibleTalkSound=e.notificationVisibleTalkSound),null!=e.notificationVisibleTalkPopup&&(this.notificationVisibleTalkPopup=e.notificationVisibleTalkPopup),null!=e.notificationIncludingMessageContent&&(this.notificationIncludingMessageContent=e.notificationIncludingMessageContent),null!=e.notificationPopupTime&&(this.notificationPopupTime=e.notificationPopupTime),null!=e.notificationVisibleTalkAutoScroll&&(this.talkAutoScroll=e.notificationVisibleTalkAutoScroll?1:3),null!=e.talkAutoScroll&&(this.talkAutoScroll=e.talkAutoScroll),null!=e.talksSortMode&&(this.talksSortMode=e.talksSortMode),null!=e.talkRightPanelOpened?this.talkRightPanelOpened=e.talkRightPanelOpened:this.talkRightPanelOpened=null==L.getItem("right_panel_opened"),null!=e.talkRightPanelWidth)this.talkRightPanelWidth=e.talkRightPanelWidth;else{var t=g.parseInt(L.getItem("right_panel_width"));this.talkRightPanelWidth=null==t?0:t}if(null!=e.keywordWatchingText&&(this.keywordWatchingText=e.keywordWatchingText),null!=e.keywordWatchingEmphasis&&(this.keywordWatchingEmphasis=e.keywordWatchingEmphasis),null!=e.keywordWatchingSelfMessage&&(this.keywordWatchingSelfMessage=e.keywordWatchingSelfMessage),null!=e.keywordWatchingActionReply&&(this.keywordWatchingActionReply=e.keywordWatchingActionReply),null!=e.userDataContainer)for(var n=0,i=ho.__cast(e.userDataContainer,Array);n<i.length;){var r=i[n];++n,this.userDataContainer.push($e.fromJson(r))}null!=e.language&&(this.language=e.language),null!=e.conferenceIncomingSound&&(this.conferenceIncomingSound=e.conferenceIncomingSound),null!=e.domainsSortMode&&(this.domainsSortMode=e.domainsSortMode),null!=e.appLeftPanelOpened?this.appLeftPanelOpened=e.appLeftPanelOpened:this.appLeftPanelOpened=null!=L.getItem("app_left_panel_opened")}};n["albero.entity.BrowserSettings"]=Ze,Ze.__name__=["albero","entity","BrowserSettings"],Ze.fromJson=function(e){return new Ze(e)},Ze.prototype={createCopy:function(){var e=new Ze(null);return this.copyTo(e),e},equalNotificationSettings:function(e){return e.notificationInvisibleTalkSound==this.notificationInvisibleTalkSound&&e.notificationInvisibleTalkPopup==this.notificationInvisibleTalkPopup&&e.notificationVisibleTalkSound==this.notificationVisibleTalkSound&&e.notificationVisibleTalkPopup==this.notificationVisibleTalkPopup&&e.notificationIncludingMessageContent==this.notificationIncludingMessageContent&&e.notificationPopupTime==this.notificationPopupTime},equalTalkSettings:function(e){return e.talkAutoScroll==this.talkAutoScroll&&e.talksSortMode==this.talksSortMode&&e.talkRightPanelOpened==this.talkRightPanelOpened&&e.talkRightPanelWidth==this.talkRightPanelWidth},equalKeywordWatching:function(e){return e.keywordWatchingText==this.keywordWatchingText&&e.keywordWatchingEmphasis==this.keywordWatchingEmphasis&&e.keywordWatchingSelfMessage==this.keywordWatchingSelfMessage&&e.keywordWatchingActionReply==this.keywordWatchingActionReply},equalLanguageSettings:function(e){return e.language==this.language},equalConferenceSettings:function(e){return e.conferenceIncomingSound==this.conferenceIncomingSound},equalUserData:function(e,t){var n=e.getUserData(t),i=this.getUserData(t);if(null==n||null==n)return!0;var r=i.stampHistories.length;if(n.stampHistories.length!=r)return!0;for(var a=0,o=r;a<o;){var s=a++;if(!et.eq(n.stampHistories[s],i.stampHistories[s]))return!0}return!1},copyTo:function(e){this.copyNotificationSettingsTo(e),this.copyKeywordSettingsTo(e),this.copyTalkSettingsTo(e),this.copyUserDataContainerTo(e),this.copyLanguageSettingsTo(e),this.copyConferenceSettingsTo(e),this.copyDomainsSortModeSettingsTo(e),this.copyAppLeftPanelOpenedSettingsTo(e)},copyNotificationSettingsTo:function(e){e.notificationInvisibleTalkSound=this.notificationInvisibleTalkSound,e.notificationInvisibleTalkPopup=this.notificationInvisibleTalkPopup,e.notificationVisibleTalkSound=this.notificationVisibleTalkSound,e.notificationVisibleTalkPopup=this.notificationVisibleTalkPopup,e.notificationIncludingMessageContent=this.notificationIncludingMessageContent,e.notificationPopupTime=this.notificationPopupTime},copyKeywordSettingsTo:function(e){e.keywordWatchingText=this.keywordWatchingText,e.keywordWatchingEmphasis=this.keywordWatchingEmphasis,e.keywordWatchingSelfMessage=this.keywordWatchingSelfMessage,e.keywordWatchingActionReply=this.keywordWatchingActionReply},copyTalkSettingsTo:function(e){e.talkAutoScroll=this.talkAutoScroll,e.talksSortMode=this.talksSortMode,e.talkRightPanelOpened=this.talkRightPanelOpened,e.talkRightPanelWidth=this.talkRightPanelWidth},copyUserDataContainerTo:function(e){e.userDataContainer=this.userDataContainer},getUserData:function(e){return l.find(this.userDataContainer,function(t){return t.userIdString==e})},copyLanguageSettingsTo:function(e){e.language=this.language},copyConferenceSettingsTo:function(e){e.conferenceIncomingSound=this.conferenceIncomingSound},copyDomainsSortModeSettingsTo:function(e){e.domainsSortMode=this.domainsSortMode},copyAppLeftPanelOpenedSettingsTo:function(e){e.appLeftPanelOpened=this.appLeftPanelOpened},assureUserData:function(e){var t=this.getUserData(e);return null==t&&(t=$e.fromUserIdString(e),this.userDataContainer.push(t)),t},isThumbnailExpansionEnabled:function(e){var t=this.getUserData(e);return null!=t&&t.useThumbnailExpansion},setThumbnailExpansionEnabled:function(e,t){this.assureUserData(e).useThumbnailExpansion=t},setPrevSelectedMic:function(e,t){this.assureUserData(e).setPrevSelectedMic(t)},setPrevSelectedSpeaker:function(e,t){this.assureUserData(e).setPrevSelectedSpeaker(t)},setPrevSelectedCamera:function(e,t){this.assureUserData(e).setPrevSelectedCamera(t)},setPrevUseBlur:function(e,t){this.assureUserData(e).setPrevUseBlur(t)},getPrevSelectedDevice:function(e){var t=this.getUserData(e);return null==t||null==t.prevSelectedDevice?$e.createDefaultConfrenceDeviceSetting():t.prevSelectedDevice},getStampHistories:function(e){var t=this.getUserData(e);return null==t?[]:t.stampHistories},addUsedStampJson:function(e,t){var n=this.assureUserData(e),i=n.stampHistories.filter(function(e){return!et.eq(t,e)});i.unshift(t),n.stampHistories=i.slice(0,et.MAX_SIZE)},isJaMode:function(){return null==this.language||"ja"==this.language},__class__:Ze};var $e=function(){};n["albero.entity.UserData"]=$e,$e.__name__=["albero","entity","UserData"],$e.createDefaultConfrenceDeviceSetting=function(){return{mic:"",speaker:"",camera:"",useBlur:!1}},$e.fromUserIdString=function(e){var t=new $e;return t.userIdString=e,t.stampHistories=[],t.useThumbnailExpansion=!1,t.prevSelectedDevice=$e.createDefaultConfrenceDeviceSetting(),t},$e.fromJson=function(e){var t=new $e;return null!=e&&(null!=e.userIdString&&(t.userIdString=e.userIdString),null!=e.stampHistories&&(t.stampHistories=e.stampHistories.map(et.migrate)),null!=e.useThumbnailExpansion&&(t.useThumbnailExpansion=e.useThumbnailExpansion),null!=e.prevSelectedDevice&&(t.prevSelectedDevice=e.prevSelectedDevice,null==t.prevSelectedDevice.useBlur&&(t.prevSelectedDevice.useBlur=!1))),t},$e.prototype={setPrevSelectedMic:function(e){this.assurePrevSelectedDevice().mic=e},setPrevSelectedSpeaker:function(e){this.assurePrevSelectedDevice().speaker=e},setPrevSelectedCamera:function(e){this.assurePrevSelectedDevice().camera=e},setPrevUseBlur:function(e){this.assurePrevSelectedDevice().useBlur=e},assurePrevSelectedDevice:function(){return null==this.prevSelectedDevice&&(this.prevSelectedDevice=$e.createDefaultConfrenceDeviceSetting()),this.prevSelectedDevice},__class__:$e};var et=function(){};n["albero.entity.StampHisory"]=et,et.__name__=["albero","entity","StampHisory"],et.migrate=function(e){return"string"==typeof e?{commonStampId:e}:e},et.eq=function(e,t){return null==e||null==t?e!=t:null!=e.commonStampId&&null!=t.commonStampId?e.commonStampId==t.commonStampId:null!=e.originalStamp&&null!=t.originalStamp&&e.originalStamp.stampIdStr==t.originalStamp.stampIdStr};var tt=function(e){this.allowCreateMessageStampCategories=[],this.version=0,null!=e&&(this.version=e.version,this.allowCreateMessageStampCategories=e.allow_create_message_stamp_categories)};n["albero.entity.BuiltinStampSetting"]=tt,tt.__name__=["albero","entity","BuiltinStampSetting"],tt.prototype={isNewerThan:function(e){return this.version>e.version},isStampsetEnabled:function(e){return l.has(this.allowCreateMessageStampCategories,e)},isStampCategoriesEmpty:function(){return 0==this.allowCreateMessageStampCategories.length},getCategoryIndex:function(e){return this.allowCreateMessageStampCategories.indexOf(e)},__class__:tt};var nt=function(e){null!=e&&(this.userId=e.user_id,this.id=e.conference_id,this.domainId=e.domain_id,this.talkId=e.talk_id,this.messageId=e.message_id,this.createdAt=e.created_at,this.expiredAt=e.expired_at,this.participants=e.participants,this.skywayVersion=null==e.skyway_version?1:e.skyway_version)};n["albero.entity.Conference"]=nt,nt.__name__=["albero","entity","Conference"],nt.prototype={isIncomingExpired:function(){var e=this.createdAt,t=e.high,n=e.low;return 4294967296*t+(n>=0?n:n+4294967296)+nt.INCOMING_TIME<(new Date).getTime()},isExpired:function(){var e=this.expiredAt,t=e.high,n=e.low;return 4294967296*t+(n>=0?n:n+4294967296)<(new Date).getTime()},__class__:nt};var it=function(){this.conferencesMap=new eo,this.talkIdConferenceIdMap=new eo};n["albero.entity.ConferenceStore"]=it,it.__name__=["albero","entity","ConferenceStore"],it.prototype={addConference:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.conferencesMap;null!=Jo[n]?i.setReserved(n,e):i.h[n]=e;var r=e.talkId,a="_"+r.high+"_"+r.low,o=this.talkIdConferenceIdMap;null!=Jo[a]?o.setReserved(a,n):o.h[a]=n},removeConference:function(e){var t=e.id,n="_"+t.high+"_"+t.low;this.conferencesMap.remove(n);var i=e.talkId,r="_"+i.high+"_"+i.low,a=this.talkIdConferenceIdMap;(null!=Jo[r]?a.getReserved(r):a.h[r])==n&&this.talkIdConferenceIdMap.remove(r)},getConferences:function(){return x.toValueArray(this.conferencesMap)},getConference:function(e){var t="_"+e.high+"_"+e.low,n=this.conferencesMap;return null!=Jo[t]?n.getReserved(t):n.h[t]},hasConferenceInTalk:function(e){if(null!=e){var t="_"+e.high+"_"+e.low,n=this.talkIdConferenceIdMap;return null!=Jo[t]?n.existsReserved(t):n.h.hasOwnProperty(t)}return!1},getConferenceIdInTalk:function(e){if(null==e)return null;var t="_"+e.high+"_"+e.low,n=this.talkIdConferenceIdMap,i=null!=Jo[t]?n.getReserved(t):n.h[t];return null==i?null:R.makeFromIdStr(i)},getConferenceTalkIds:function(){return x.toKeyArray(this.talkIdConferenceIdMap).map(R.makeFromIdStr)},hasConference:function(){return this.talkIdConferenceIdMap.keys().hasNext()},__class__:it};var rt=function(e){null!=e&&(this.maxFriends=e.max_friends,this.maxTalks=e.max_talks,this.maxTalkers=e.max_talkers,this.maxMessageContentLength=e.max_message_content_length,this.botExpiredVersion=e.bot_expired_version,this.presenceExpiration=null!=e.presence_expiration?e.presence_expiration:rt.DEFAULT_PRESENCE_EXPIRATION,this.allowAttachmentType=je.fromInt(e.allow_attachment_type),this.imageSanitizationEnabled=!!e.image_sanitization_enabled,this.updateLastUsedAtInterval=null!=e.update_last_used_at_interval?e.update_last_used_at_interval:rt.DEFAULT_PRESENCE_EXPIRATION)};n["albero.entity.Configuration"]=rt,rt.__name__=["albero","entity","Configuration"],rt.prototype={__class__:rt};var at=function(e){this.contractConference=Za.None,null!=e&&(this.id=e.contract_id,this.plan=new _n(e.plan),this.quota=new bn(e.quota),this.solutionIds=e.solution_ids,null!=e.conference&&(this.contractConference=Za.Some(new ot(e.conference))))};n["albero.entity.Contract"]=at,at.__name__=["albero","entity","Contract"],at.prototype={getMaxMessageContentLength:function(){return P.map(P.option(this.quota),function(e){return e.maxMessageContentLength})},getMaxTalkers:function(){return P.flatMap(P.option(this.quota),function(e){return P.option(e.maxTalkers)})},getMaxTalks:function(){return P.flatMap(P.option(this.quota),function(e){return P.option(e.maxTalks)})},isConferenceEnalbed:function(){return P.isDefined(this.contractConference)},isVideoEnalbed:function(){var e=P.map(this.contractConference,function(e){return e.videoEnabled});switch(e[1]){case 0:return e[2];case 1:return!1}},getConferenceTtl:function(){return P.map(this.contractConference,function(e){return e.ttl})},getConferenceMaxParticipants:function(){return P.map(this.contractConference,function(e){return e.maxConferenceParticipants})},isGroupConfenreceEnalbed:function(){var e=P.map(this.contractConference,function(e){return e.groupConferenceEnabled});switch(e[1]){case 0:return e[2];case 1:return!1}},isTargetOfPlanAd:function(){return null!=this.quota&&this.quota.withAd},isFreePlan:function(){return null!=this.plan&&this.plan.free},__class__:at};var ot=function(e){this.groupConferenceEnabled=!1,this.maxConferenceParticipants=ot.DEFAULT_MAX_PARTICIPANTS,this.ttl=ot.DEFAULT_TTL,this.videoEnabled=!1,null!=e&&(this.videoEnabled=e.video_enabled,this.ttl=e.ttl,this.maxConferenceParticipants=e.max_conference_participants,this.groupConferenceEnabled=e.group_conference_enabled)};n["albero.entity.ContractConference"]=ot,ot.__name__=["albero","entity","ContractConference"],ot.prototype={__class__:ot};var st=function(e){if(null!=e){switch(this.id=e.department_id,this.order=e.order,this.parentId=e.parent,this.nodeType=null==e.node?ut.Normal:this.parseDepartmentNodeType(e.node),this.nodeType[1]){case 0:this.name=e.name;break;case 1:this.name=st.getLabelRoot();break;case 2:this.name=st.getLabelFree()}this.depth=0,this.childrenIds=null,this.userCount=null,this.userIds=null,this.userCountLoading=!1}};n["albero.entity.Department"]=st,st.__name__=["albero","entity","Department"],st.getLabelFree=function(){return Nr.localize("Department.label_free")},st.getLabelRoot=function(){return Nr.localize("Department.label_root")},st.prototype={addChild:function(e){null==this.childrenIds&&(this.childrenIds=[]),this.childrenIds.push(e)},isRoot:function(){return this.nodeType==ut.Root},isFree:function(){return this.nodeType==ut.Free},parseDepartmentNodeType:function(e){switch(e){case 1:return ut.Root;case 2:return ut.Free;default:return ut.Normal}},getChildIdStrList:function(){return null==this.childrenIds?[]:this.childrenIds.map(R.idStr)},__class__:st};var lt=function(){};n["albero.entity.DepartmentHelper"]=lt,lt.__name__=["albero","entity","DepartmentHelper"],lt.getName=function(e){return null==e?null:e.name};var ut=n["albero.entity.DepartmentNodeType"]={__ename__:["albero","entity","DepartmentNodeType"],__constructs__:["Normal","Root","Free"]};ut.Normal=["Normal",0],ut.Normal.toString=i,ut.Normal.__enum__=ut,ut.Root=["Root",1],ut.Root.toString=i,ut.Root.__enum__=ut,ut.Free=["Free",2],ut.Free.toString=i,ut.Free.__enum__=ut,ut.__empty_constructs__=[ut.Normal,ut.Root,ut.Free];var ct=function(e){null!=e&&(this.domainId=e.domain_id,this.departments=this.getDepartments(e.departments))};n["albero.entity.DepartmentList"]=ct,ct.__name__=["albero","entity","DepartmentList"],ct.prototype={getDepartments:function(e){return null==e?[]:e.map(function(e){return new st(e)})},__class__:ct};var _t=function(){this.departmentMap=new eo,this.rootDepartmentIdMap=new eo};n["albero.entity.DepartmentStore"]=_t,_t.__name__=["albero","entity","DepartmentStore"],_t.prototype={getDepartment:function(e){if(null==e)return null;var t="_"+e.high+"_"+e.low,n=this.departmentMap;return null!=Jo[t]?n.getReserved(t):n.h[t]},setDepartment:function(e){if(null!=e.parentId){var t=this.getDepartment(e.parentId);null!=t&&(t.addChild(e.id),e.depth=t.depth+1)}var n=e.id,i="_"+n.high+"_"+n.low,r=this.departmentMap;null!=Jo[i]?r.setReserved(i,e):r.h[i]=e},clearDomainDepartment:function(e){var t=this,n="_"+e.high+"_"+e.low,i=this.rootDepartmentIdMap,r=null!=Jo[n]?i.getReserved(n):i.h[n];null!=r&&(l.iter(this.getDepartmentsDescendantOrSelf(r),function(e){var n=e.id;t.departmentMap.remove("_"+n.high+"_"+n.low)}),this.rootDepartmentIdMap.remove(n))},getRootDepartmentId:function(e){var t="_"+e.high+"_"+e.low,n=this.rootDepartmentIdMap;return null!=Jo[t]?n.getReserved(t):n.h[t]},setRootDepartmentId:function(e,t){var n="_"+e.high+"_"+e.low,i=this.rootDepartmentIdMap;null!=Jo[n]?i.setReserved(n,t):i.h[n]=t},setDepartmentUserCount:function(e){var t=this.getDepartment(e.departmentId);null!=t&&(t.userCount=e,t.userCountLoading=!1)},setUserCountLoading:function(e,t){var n=this.getDepartment(e);null!=n&&(n.userCountLoading=t)},isUserCountLoadingRequired:function(e){var t=this.getDepartment(e);return null==t||null==t.userCount&&!t.userCountLoading},clearDomainDepartmentUsers:function(e){var t=this.getRootDepartmentId(e);return null!=t&&(l.iter(this.getDepartmentsDescendantOrSelf(t),function(e){e.userCount=null,e.userIds=null,e.userCountLoading=!1}),!0)},setDepartmentUsers:function(e,t){var n=this.getDepartment(e);null!=n&&(n.userIds=t)},getDepartmentPath:function(e){return this.getDepartmentsAncestorOrSelf(e)},getDepartmentPathWithoutRoot:function(e){return this.getDepartmentPath(e).filter(function(e){return!e.isRoot()})},getDepartmentsAncestorOrSelf:function(e){var t=[];return this._getDepartmentsAncestorOrSelf(e,t),t},_getDepartmentsAncestorOrSelf:function(e,t){var n=this.getDepartment(e);null!=n&&(null!=n.parentId&&this._getDepartmentsAncestorOrSelf(n.parentId,t),t.push(n))},getDepartmentsDescendantOrSelf:function(e){var t=[];return this._getDepartmentsDescendantOrSelf(e,t),t},_getDepartmentsDescendantOrSelf:function(e,t){var n=this,i=this.getDepartment(e);null!=i&&(t.push(i),null!=i.childrenIds&&l.iter(i.childrenIds,function(e){n._getDepartmentsDescendantOrSelf(e,t)}))},__class__:_t};var ht=function(e){null!=e&&(this.departmentId=e.department_id,this.all=e.all,this.partial=e.partial)};n["albero.entity.DepartmentUserCount"]=ht,ht.__name__=["albero","entity","DepartmentUserCount"],ht.prototype={__class__:ht};var dt=function(e){null!=e&&(this.departments=this.getDepartmentUserCounts(e.departments))};n["albero.entity.DepartmentUserCountList"]=dt,dt.__name__=["albero","entity","DepartmentUserCountList"],dt.prototype={getDepartmentUserCounts:function(e){return null==e?[]:e.map(function(e){return new ht(e)})},__class__:dt};var ft=function(e,t){if(null!=e){if(this.id=R.fromIntOrInt64(e.direct_app_id),this.uniqueKey=e.unique_key,this.appUrl=e.app_url,this.locales=new eo,null!=e.locales)for(var n=0,i=p.fields(e.locales);n<i.length;){var r=i[n];++n;var a=p.field(e.locales,r),o=this.locales,s=new mt(a),l=o;null!=Jo[r]?l.setReserved(r,s):l.h[r]=s}if(this.features=[],null!=e.features)for(var u=this.locales,c=null!=Jo[t]?u.getReserved(t):u.h[t],_=0,h=ho.__cast(e.features,Array);_<h.length;){var d=h[_];++_,this.features.push(new pt(d,c))}}};n["albero.entity.DirectApp"]=ft,ft.__name__=["albero","entity","DirectApp"],ft.prototype={getLinkFeature:function(){return l.find(this.features,function(e){return e.isLink()})},getMessageExtensionFeature:function(){return l.find(this.features,function(e){return e.isMessageMenuExtension()})},__class__:ft};var mt=function(e){this.map=new eo;for(var t=0,n=p.fields(e);t<n.length;){var i=n[t];++t;var r=p.field(e,i),a=this.map;null!=Jo[i]?a.setReserved(i,r):a.h[i]=r}};n["albero.entity.DirectAppLangResources"]=mt,mt.__name__=["albero","entity","DirectAppLangResources"],mt.prototype={getResourceText:function(e){var t=this.map;return null!=Jo[e]?t.getReserved(e):t.h[e]},__class__:mt};var pt=function(e,t){this.localizedLabel=null,null!=e&&(this.type=e.type,this.label=e.label,this.iconUrl=e.icon_url,this.priority=e.priority,this.messageCategory=this.parseMessageCategory(e.message_category),this.multiple=!!e.multiple,this.actionUrl=e.action_url,this.localizedLabel=t.getResourceText(this.label))};n["albero.entity.DirectAppFeature"]=pt,pt.__name__=["albero","entity","DirectAppFeature"],pt.prototype={parseMessageCategory:function(e){return 1==e?en.textOrFiles:en.unknown},isLink:function(){return"link"==this.type},isMessageMenuExtension:function(){return"message_menu_extension"==this.type},__class__:pt};var gt=function(){this.store=new eo};n["albero.entity.DirectAppStore"]=gt,gt.__name__=["albero","entity","DirectAppStore"],gt.prototype={clear:function(){this.store=new eo},setDirectApp:function(e,t){null==this.store&&(this.store=new eo);var n="_"+e.high+"_"+e.low,i=this.store;null!=Jo[n]?i.setReserved(n,t):i.h[n]=t},getDirectApp:function(e){if(null==this.store)return null;var t="_"+e.high+"_"+e.low,n=this.store;return null!=Jo[t]?n.getReserved(t):n.h[t]},getDirectApps:function(e){var t=e.map(Ro(this,this.getDirectApp)).filter(function(e){return null!=e});return new vt(t)},getAllDirectApps:function(){return new vt(x.toValueArray(this.store))},removeDirectApp:function(e){if(null!=this.store){var t="_"+e.high+"_"+e.low;this.store.remove(t)}},__class__:gt};var vt=function(e){this.values=e};n["albero.entity.DirectApps"]=vt,vt.__name__=["albero","entity","DirectApps"],vt.prototype={getSortedLinkFeatures:function(){return U.sortAndReturn(this.values.map(function(e){return e.getLinkFeature()}).filter(function(e){return null!=e}),function(e,t){return e.priority-t.priority})},getSortedMessageExtensionFeatures:function(){return U.sortAndReturn(this.values.map(function(e){return e.getMessageExtensionFeature()}).filter(function(e){return null!=e}),function(e,t){return e.priority-t.priority})},getAppUrls:function(){return this.values.map(function(e){return e.appUrl})},__class__:vt};var St=function(e){null!=e&&null!=e.enabled?this.enabled=ho.__cast(e.enabled,Array).map(R.fromIntOrInt64):this.enabled=[]};n["albero.entity.DirectAppsSetting"]=St,St.__name__=["albero","entity","DirectAppsSetting"],St.prototype={__class__:St};var yt=function(e){null!=e&&(this.id=e.domain_id,this.updatedAt=e.updated_at,this.domainInfo=new wt(e.domain),this.contract=new at(e.contract),this.profileDefinition=new dn(e.profile_definition),this.setting=new Tt(e.setting),this.role=new Et(e.role),this.stampsetSetting=new Vn(e.stampset_setting),this.builtinStampSetting=new tt(e.builtin_stamp_setting),this.directAppsSetting=new St(e.direct_apps_setting),this.closed=!1)};n["albero.entity.Domain"]=yt,yt.__name__=["albero","entity","Domain"],yt.isChangedContractTreeEnabled=function(e,t){return yt.isDepartmentEnabled(e)!=yt.isDepartmentEnabled(t)},yt.isDepartmentEnabled=function(e){return null!=e&&(!!yt.isAllowListUser(e)&&!!e.setting.contactTreeEnabled)},yt.isAllowListUser=function(e){return null==e||e.role.allowListUsers},yt.isChangedRoleType=function(e,t){return(null==e?Nt.user:e.role.type)!=(null==t?Nt.user:t.role.type)},yt.isChangedMaxTalkers=function(e,t){var n,i,r=P.flatMap(P.option(e),function(e){return e.getMaxTalkers()});switch(r[1]){case 0:n=r[2];break;case 1:n=0}var a=P.flatMap(P.option(t),function(e){return e.getMaxTalkers()});switch(a[1]){case 0:i=a[2];break;case 1:i=0}return n!=i},yt.isAllowReadAnnouncement=function(e){return null!=e&&!!e.role.allowReadAnnouncements},yt.isSolutionChanged=function(e,t){var n=null==e?[]:e.getSolutionIds(),i=null==t?[]:t.getSolutionIds();if(n.length!=i.length)return!0;for(var r=0,a=n.length;r<a;){var o=r++;if(n[o]!=i[o])return!0}return!1},yt.isForwardTypeChanged=function(e,t){return null==e||e.setting.allowForwardMessageType!=t.setting.allowForwardMessageType},yt.isSaveAllowedChanged=function(e,t,n){return(null==e||e.isSaveAllowed(n))!=(null==t||t.isSaveAllowed(n))},yt.prototype={getMaxMessageContentLengthOrElse:function(e){var t=P.flatMap(P.option(this.contract),function(e){return e.getMaxMessageContentLength()});switch(t[1]){case 0:return t[2];case 1:return e}},getMaxTalkers:function(){return P.flatMap(P.option(this.contract),function(e){return e.getMaxTalkers()})},getMaxTalks:function(){return P.flatMap(P.option(this.contract),function(e){return e.getMaxTalks()})},isDirectAppsOnly:function(e,t){var n,i=this.getMaxTalks();switch(i[1]){case 0:n=i[2];break;case 1:n=0}var r=t.getDomainTalksCount(e.id);return 0==n&&0==r&&!yt.isAllowReadAnnouncement(e)},isSaveAllowed:function(e){return e?this.setting.allowSaveAttachments.desktop:this.setting.allowSaveAttachments.web},isFreePlan:function(){return null!=this.contract&&this.contract.isFreePlan()},isTargetOfPlanAd:function(){return null!=this.contract&&this.contract.isTargetOfPlanAd()},isMyOwnDomain:function(){return this.role.isOwner()},updateStampsetSetting:function(e){e.isNewerThan(this.stampsetSetting)&&(this.stampsetSetting=e)},updateStampsetInfo:function(e){this.stampsetSetting.updateStampsetInfo(e)},deleteStampsetInfo:function(e){this.stampsetSetting.deleteStampsetInfo(e)},updateBuiltinStampSetting:function(e){e.isNewerThan(this.builtinStampSetting)&&(this.builtinStampSetting=e)},hasAnyEnabledStampset:function(){return!this.stampsetSetting.isStampsetIdsEmpty()||!this.builtinStampSetting.isStampCategoriesEmpty()},getSolutionIds:function(){return null==this.contract?[]:null==this.contract.solutionIds?[]:this.contract.solutionIds},__class__:yt};var wt=function(e){null!=e&&(this.name=e.domain_name,this.logoUrl=e.logo_url,this.frozen=null!=e.frozen&&e.frozen)};n["albero.entity.DomainInfo"]=wt,wt.__name__=["albero","entity","DomainInfo"],wt.prototype={__class__:wt};var Tt=function(e){null!=e&&(this.allowAttachmentType=je.fromInt(e.allow_attachment_type),this.allowSaveAttachmentsToDevice=e.allow_save_attachments_to_device,null!=e.allow_save_attachments&&(this.allowSaveAttachments=new It(e.allow_save_attachments)),this.allowForwardMessageType=this.allowForwardMessageTypeOf(e.allow_forward_message_type),this.contactTreeEnabled=!!e.contact_tree_enabled,this.dropboxIntegrationEnabled=!!e.dropbox_integration_enabled,this.boxIntegrationEnabled=!!e.box_integration_enabled,this.allowForwardNote=!!e.allow_forward_note)};n["albero.entity.DomainSetting"]=Tt,Tt.__name__=["albero","entity","DomainSetting"],Tt.prototype={allowForwardMessageTypeOf:function(e){switch(e){case 0:return At.ng;case 1:return At.ok;case 2:return At.onlyTextOrStamp;default:return At.other}},__class__:Tt};var It=function(e){null!=e&&(this.web=null==e.web||e.web,this.ios=null==e.ios||e.ios,this.android=null==e.android||e.android,this.desktop=null==e.desktop||e.desktop)};n["albero.entity.DomainSettingAllowSaveAttachments"]=It,It.__name__=["albero","entity","DomainSettingAllowSaveAttachments"],It.prototype={__class__:It};var Et=function(e){if(null!=e){this.type=this.typeOf(e.type);var t=e.allow_guests;this.allowGuests=t||!0;var n=e.allow_create_attachments;this.allowCreateAttachments=n||!0;var i=e.allow_read_attachments;this.allowReadAttachments=i||!0;var r=e.allow_create_announcement;this.allowCreateAnnouncement=r&&r,this.allowReadAnnouncements=e.allow_read_announcements,null==this.allowReadAnnouncements&&(this.allowReadAnnouncements=!0),this.allowListUsers=e.allow_list_users,null==this.allowListUsers&&(this.allowListUsers=!0)}};n["albero.entity.DomainRole"]=Et,Et.__name__=["albero","entity","DomainRole"],Et.prototype={def:function(e,t){return e||t},typeOf:function(e){switch(e){case 10:return Nt.owner;case 20:return Nt.manager;case 30:return Nt.user;default:return Nt.guest}},isOwner:function(){return w.enumEq(this.type,Nt.owner)},__class__:Et};var Nt=n["albero.entity.DomainRoleType"]={__ename__:["albero","entity","DomainRoleType"],__constructs__:["owner","manager","user","guest"]};Nt.owner=["owner",0],Nt.owner.toString=i,Nt.owner.__enum__=Nt,Nt.manager=["manager",1],Nt.manager.toString=i,Nt.manager.__enum__=Nt,Nt.user=["user",2],Nt.user.toString=i,Nt.user.__enum__=Nt,Nt.guest=["guest",3],Nt.guest.toString=i,Nt.guest.__enum__=Nt,Nt.__empty_constructs__=[Nt.owner,Nt.manager,Nt.user,Nt.guest];var At=n["albero.entity.DomainAllowForwardMessageType"]={__ename__:["albero","entity","DomainAllowForwardMessageType"],__constructs__:["ng","ok","onlyTextOrStamp","other"]};At.ng=["ng",0],At.ng.toString=i,At.ng.__enum__=At,At.ok=["ok",1],At.ok.toString=i,At.ok.__enum__=At,At.onlyTextOrStamp=["onlyTextOrStamp",2],At.onlyTextOrStamp.toString=i,At.onlyTextOrStamp.__enum__=At,At.other=["other",3],At.other.toString=i,At.other.__enum__=At,At.__empty_constructs__=[At.ng,At.ok,At.onlyTextOrStamp,At.other];var bt=function(e){null!=e&&(this.domainId=e.domain_id,this.departments=e.departments)};n["albero.entity.DomainDepartmentPath"]=bt,bt.__name__=["albero","entity","DomainDepartmentPath"],bt.prototype={__class__:bt};var Dt=function(e){null!=e&&(this.id=e.domain_id,this.name=e.domain_name,this.accountControlRequestId=R.fromIntOrInt64(e.account_control_request_id),this.updatedAt=e.updated_at)};n["albero.entity.DomainInvite"]=Dt,Dt.__name__=["albero","entity","DomainInvite"],Dt.prototype={__class__:Dt};var Mt=function(e){null!=e&&(this.id=e.user_id,this.status=e.status,this.displayName=e.display_name,this.canonicalDisplayName=e.canonical_display_name,this.phoneticDisplayName=e.phonetic_display_name,this.canonicalPhoneticDisplayName=e.canonical_phonetic_display_name,this.profileImageUrl=e.profile_image_url,this.updatedAt=e.updated_at)};n["albero.entity.User"]=Mt,Mt.__name__=["albero","entity","User"],Mt.prototype={__class__:Mt};var Ct=function(e){Mt.call(this,e),null!=e&&(this.domainId=e.domain_id,null!=e.profile_contact&&(this.profileContact=ho.__cast(e.profile_contact,Array).map(function(e){return new mn(e)})),this.departments=e.departments)};n["albero.entity.DomainUser"]=Ct,Ct.__name__=["albero","entity","DomainUser"],Ct.__super__=Mt,Ct.prototype=r(Mt.prototype,{setUserIdentifier:function(e){this.email=e.email,this.subEmail=e.subEmail,this.groupAlias=e.groupAlias,this.signinId=e.signinId},match:function(e,t){if(this.matchNameOrPhonetic(e))return!0;if(null!=this.profileContact&&null!=t.profileDefinition.itemDefinitions)for(var n=0,i=this.profileContact;n<i.length;){var r=i[n];++n;for(var a=0,o=t.profileDefinition.itemDefinitions;a<o.length;){var s=o[a];if(++a,s.profileItemId==r.profileItemId){if(s.visible&&10==s.group&&r.canonicalValue.indexOf(e)>-1)return!0;break}}}return!1},matchNameOrPhonetic:function(e){if(B.isEmpty(e))return!0;if(B.isEmpty(this.canonicalDisplayName)){this.canonicalDisplayName=kr.canonicalize(this.displayName);this.canonicalDisplayName,this.displayName}return this.canonicalDisplayName.indexOf(e)>-1||null!=this.canonicalPhoneticDisplayName&&this.canonicalPhoneticDisplayName.indexOf(e)>-1},matchNameOrPhoneticRoman:function(e){if(this.matchNameOrPhonetic(e))return!0;if(B.isEmpty(this.canonicalDisplayNameRoman)){this.canonicalDisplayNameRoman=kr.canonicalizeForRoman(this.displayName);this.canonicalDisplayNameRoman,this.displayName}return this.canonicalDisplayNameRoman.indexOf(e)>-1||null!=this.canonicalPhoneticDisplayName&&(B.isEmpty(this.canonicalPhoneticDisplayNameRoman)&&(this.canonicalPhoneticDisplayNameRoman=kr.canonicalizeForRoman(this.canonicalPhoneticDisplayName)),this.canonicalPhoneticDisplayNameRoman.indexOf(e)>-1)},__class__:Ct});var kt=function(e){this.values=e};n["albero.entity.Domains"]=kt,kt.__name__=["albero","entity","Domains"],kt.prototype={orderByName:function(){var e=U.sortAndReturn(this.values.map(Ot.fromDomain),Ot.compare).map(Ot.toDomain);return new kt(e)},getOldestDomain:function(){return null==this.values||0==this.values.length?Za.None:l.fold(this.values,function(e,t){switch(P.filter(t,function(t){var n=t.id,i=e.id,r=n.high-i.high|0;return r=0!=r?r:Ba.ucompare(n.low,i.low),(n.high<0?i.high<0?r:-1:i.high>=0?r:1)<=0})[1]){case 0:return P.filter(t,function(t){var n=t.id,i=e.id,r=n.high-i.high|0;return r=0!=r?r:Ba.ucompare(n.low,i.low),(n.high<0?i.high<0?r:-1:i.high>=0?r:1)<=0});case 1:return Za.Some(e)}},Za.None)},getDirectAppsIds:function(){if(null==this.values||0==this.values.length)return[];var e=new eo;return l.iter(this.values,function(t){l.iter(t.directAppsSetting.enabled,function(t){var n="_"+t.high+"_"+t.low;null!=Jo[n]?e.setReserved(n,t):e.h[n]=t})}),x.toValueArray(e)},__class__:kt};var Ot=function(e){this.domain=e,this.name=e.domainInfo.name,this.canonicalizedName=kr.canonicalize(this.name)};n["albero.entity.DomainForSort"]=Ot,Ot.__name__=["albero","entity","DomainForSort"],Ot.fromDomain=function(e){return new Ot(e)},Ot.toDomain=function(e){return e.domain},Ot.compare=function(e,t){var n=B.compare(e.canonicalizedName,t.canonicalizedName);return 0!=n?n:B.compare(e.name,t.name)},Ot.prototype={__class__:Ot};var Rt=function(e){null!=e&&(this.fileId=e.file_id,this.url=e.get_url,this.headers=new Ft(e.get_headers))};n["albero.entity.DownloadAuth"]=Rt,Rt.__name__=["albero","entity","DownloadAuth"],Rt.prototype={__class__:Rt};var Ft=function(e){this.rawData=e};n["albero.entity.DownloadAuthHeaders"]=Ft,Ft.__name__=["albero","entity","DownloadAuthHeaders"],Ft.prototype={__class__:Ft};var Ut=function(e){null!=e&&(this.domainId=e.domain_id,this.talkId=e.talk_id,this.orderInFavorites=e.order_in_favorites,this.favoriteVersion=e.favorite_version)};n["albero.entity.FavoriteTalkEvent"]=Ut,Ut.__name__=["albero","entity","FavoriteTalkEvent"],Ut.prototype={__class__:Ut};var xt=function(e){this.uploadResult=Pt.NONE,this.preview=Za.None,this.thumbnailDimension=Za.None,null!=e&&(this.attachmentId=e.attachment_id,this.messageId=e.message_id,this.talkId=e.talk_id,this.id=e.file_id,this.userId=e.user_id,this.name=e.name,this.contentType=e.content_type,this.contentSize=e.content_size,this.url=e.url,this.thumbUrl=e.thumbnail_url,this.updatedAt=e.updated_at,this.file=e.file,this.localThumbInfo=e.localThumbInfo,this.thumbnailDimension=Za.None,this.deleted=null!=e.deleted&&e.deleted,this.previewSupported=null!=e.preview_supported&&e.preview_supported)};n["albero.entity.FileInfo"]=xt,xt.__name__=["albero","entity","FileInfo"],xt.fromMessageAndFile=function(e,t){var n=new xt;return n.messageId=e.id,n.talkId=e.talkId,n.userId=e.userId,n.updatedAt=e.createdAt,n.id=t.file_id,n.name=t.name,n.contentType=t.content_type,n.contentSize=t.content_size,n.url=t.url,n.thumbUrl=t.thumbnail_url,n.thumbnailDimension=null==t.thumbnail_dimension?Za.None:Za.Some(new _i(t.thumbnail_dimension)),n.deleted=null!=t.deleted&&t.deleted,n.file=t.file,n.localThumbInfo=t.localThumbInfo,n.previewSupported=t.preview_supported,n},xt.fromScheduledMessageFileContent=function(e){var t=new xt;return t.id=e.file_id,t.name=e.name,t.contentType=e.content_type,t.contentSize=e.content_size,t.url=e.url,t.thumbUrl=e.thumbnail_url,t.thumbnailDimension=null==e.thumbnail_dimension?Za.None:Za.Some(new _i(e.thumbnail_dimension)),t.deleted=null!=e.deleted&&e.deleted,t.file=e.file,t.localThumbInfo=e.localThumbInfo,t.previewSupported=e.preview_supported,t},xt.fromMessageAndFileWithFileId=function(e,t,n){var i=xt.fromMessageAndFile(e,t);return i.id=n,i},xt.createUploadedFileInfo=function(e){var t=new xt;return t.id=e.id,t.contentType=e.content_type,t.contentSize=e.content_size,t.url=e.url,t.name=e.name,t},xt.createStagedFileInfo=function(e,t,n){var i=t,r=new xt,a=new pi(0,--xt.stagedFileInfosMaxId);return r.id=a,r.talkId=e,null!=t&&(r.contentType=i.type,r.contentSize=i.size,r.addLocalFile(t),r.name=i.name),null!=n&&r.addLocalThumbInfo(n),r},xt.createStagedFileInfoFromDummyFile=function(e,t,n){var i=new xt,r=new pi(0,--xt.stagedFileInfosMaxId);return i.id=r,i.talkId=e,null!=t&&(i.contentType=t.type,i.contentSize=t.size,i.file=t,i.name=t.name),null!=n&&i.addLocalThumbInfo(n),i},xt.prototype={isRemote:function(){return null==this.file},isUploaded:function(){if(this.isRemote())return!0;switch(this.uploadResult[1]){case 0:return!0;case 1:case 2:return!1}},isUploadFailed:function(){if(this.isRemote())return!1;switch(this.uploadResult[1]){case 1:return!0;case 0:case 2:return!1}},setUploadResult:function(e){this.uploadResult=e},isNotUploaded:function(){return!this.isUploaded()},hasThumb:function(){return null!=this.thumbUrl||this.hasLocalThumbInfo()},hasLocalThumbInfo:function(){return null!=this.localThumbInfo},hasLocalFile:function(){return null!=this.file},hasUrl:function(){return null!=this.url},isImage:function(){return S.startsWith(this.contentType,"image/")},isImageGif:function(){return S.startsWith(this.contentType,"image/gif")},isImageJpeg:function(){return S.startsWith(this.contentType,"image/jpeg")},isPdf:function(){return S.startsWith(this.contentType,"application/pdf")},isVideo:function(){return S.startsWith(this.contentType,"video/")},canDisplayAsThumb:function(){return!!this.hasThumb()||this.isImage()},getNoThumbText:function(){return null!=this.name?this.name:this.url},getUploadedFileData:function(){if(null==this.file){var e={url:this.url,content_type:this.contentType,content_size:this.contentSize,name:this.name,file_id:this.id};return null!=this.thumbUrl&&(e.thumbnail_url=this.thumbUrl),P.isDefined(this.thumbnailDimension)&&(e.thumbnail_dimension=P.get(this.thumbnailDimension)),e}var t=this.uploadResult;switch(t[1]){case 0:return t[2];case 1:case 2:return Ar._e("["+s.dateStr(new Date)+"] ","file not uploaded.","","","",""),null}},addLocalFile:function(e){this.file=e},addLocalThumbInfo:function(e){this.localThumbInfo=e},getUploadableFilePack:function(){return{file:this.file,thumb:this.localThumbInfo}},__class__:xt};var Pt=n["albero.entity.UploadResult"]={__ename__:["albero","entity","UploadResult"],__constructs__:["SUCCESS","FAILUER","NONE"]};Pt.SUCCESS=function(e){var t=["SUCCESS",0,e];return t.__enum__=Pt,t.toString=i,t},Pt.FAILUER=["FAILUER",1],Pt.FAILUER.toString=i,Pt.FAILUER.__enum__=Pt,Pt.NONE=["NONE",2],Pt.NONE.toString=i,Pt.NONE.__enum__=Pt,Pt.__empty_constructs__=[Pt.FAILUER,Pt.NONE];var Lt=function(e){null!=e&&(this.messageId=e[0],this.talkId=e[1],this.fileId=e[2])};n["albero.entity.FileInfoDeletion"]=Lt,Lt.__name__=["albero","entity","FileInfoDeletion"],Lt.prototype={__class__:Lt};var Bt=function(){this.fileInfoMap=new eo,this.fileIdStrsMap=new eo,this.messageFileIdStrsMap=new eo,this.noteFileIdStrsMap=new eo,this.filePreviewMap=new eo,this.scheduledMessageFileIdStrsMap=new eo};n["albero.entity.FileInfoStore"]=Bt,Bt.__name__=["albero","entity","FileInfoStore"],Bt.prototype={ensureStagedFileInfos:function(e){return this.ensureStagedFileIdStrs(e).map(R.makeFromIdStr).filter(function(e){return null!=e}).map(Ro(this,this.getFileInfo))},moveStagedFile:function(e,t,n){var i=this.ensureStagedFileIdStrs(e);if(null!=i){var r=i[t];s.remove(i,r),i.splice(n,0,r)}},ensureStagedFileIdStrs:function(e){var t=e.toString(),n=this.fileIdStrsMap,i=null!=Jo[t]?n.getReserved(t):n.h[t];if(null==i){i=[];var r=this.fileIdStrsMap;null!=Jo[t]?r.setReserved(t,i):r.h[t]=i}return i},addStagedFileInfo:function(e,t,n,i){var r=xt.createStagedFileInfo(e,n,i),a=r.id,o="_"+a.high+"_"+a.low,s=this.fileInfoMap;null!=Jo[o]?s.setReserved(o,r):s.h[o]=r;var l=r.id,u="_"+l.high+"_"+l.low;return this.ensureStagedFileIdStrs(t).push(u),r},replaceStagedFileInfo:function(e,t,n,i){var r=xt.createStagedFileInfo(e.talkId,n,i);return this.replaceStagedFileInfoFromFileId(e.id,t,r),r},replaceStagedFileInfoFromFileId:function(e,t,n){var i=n.id,r="_"+i.high+"_"+i.low,a=this.fileInfoMap;null!=Jo[r]?a.setReserved(r,n):a.h[r]=n;var o=this.ensureStagedFileIdStrs(t),s=o.indexOf("_"+e.high+"_"+e.low);if(-1!=s){o.splice(s,1);var l=n.id;o.splice(s,0,"_"+l.high+"_"+l.low),this.removeStagedFileInfo(t,e)}},restoreStagedFile:function(e,t){var n=t.id,i="_"+n.high+"_"+n.low,r=this.fileInfoMap;null!=Jo[i]?r.setReserved(i,t):r.h[i]=t;var a=t.id,o="_"+a.high+"_"+a.low;this.ensureStagedFileIdStrs(e).push(o)},removeStagedFileInfo:function(e,t){var n="_"+t.high+"_"+t.low;s.remove(this.ensureStagedFileIdStrs(e),n);var i=this.fileInfoMap,r=null!=Jo[n]?i.getReserved(n):i.h[n];null!=r&&(r.isRemote()||this.fileInfoMap.remove(n))},removeStagedFileInfos:function(e){for(var t=0,n=this.ensureStagedFileIdStrs(e);t<n.length;){var i=n[t];++t,this.fileInfoMap.remove(i)}this.fileIdStrsMap.remove(e.toString())},ensureTalkFileInfos:function(e){return this.ensureTalkFileIds(e).map(Ro(this,this.fileInfoGetter))},ensureTalkFileIds:function(e){var t="_"+e.high+"_"+e.low,n=this.fileIdStrsMap,i=null!=Jo[t]?n.getReserved(t):n.h[t];if(null==i){i=[];var r=this.fileIdStrsMap;null!=Jo[t]?r.setReserved(t,i):r.h[t]=i}return i},getTalkFileInfo:function(e,t,n){return this.getFileInfoForMessages(n,t)},setTalkFileInfo:function(e,t){var n=e.id,i="_"+n.high+"_"+n.low,r=e.messageId,a="_"+r.high+"_"+r.low;this.messageFileInfoSetter(e);var o=this.ensureTalkFileIds(e.talkId),s=i+a;-1==o.indexOf(s)&&(t?o.push(s):o.unshift(s))},deleteFile:function(e){var t=this.getTalkFileInfo(e.talkId,e.messageId,e.fileId);null!=t&&(t.deleted=!0)},getFileInfo:function(e){var t="_"+e.high+"_"+e.low,n=this.fileInfoMap;return null!=Jo[t]?n.getReserved(t):n.h[t]},getMessageFileInfos:function(e){var t=this,n=P.map(P.option(this.messageFileIdStrsMap.get("_"+e.high+"_"+e.low)),function(n){return n.map(function(n){return t.messageFileInfoGetter(n,"_"+e.high+"_"+e.low)})});switch(n[1]){case 0:return n[2];case 1:return[]}},setMessageFileInfos:function(e,t){for(var n=0;n<t.length;){var i=t[n];++n,this.messageFileInfoSetter(i)}var r=this.messageFileIdStrsMap,a="_"+e.high+"_"+e.low,o=t.map(Ro(this,this.fileIdStrGetter)),s=r;null!=Jo[a]?s.setReserved(a,o):s.h[a]=o},removeMessageFileInfos:function(e){var t="_"+e.high+"_"+e.low,n=this.messageFileIdStrsMap,i=null!=Jo[t]?n.getReserved(t):n.h[t];if(null!=i)for(var r=0;r<i.length;){var a=i[r];++r,this.messageFileInfoRemover(a,t)}this.messageFileIdStrsMap.remove("_"+e.high+"_"+e.low)},isAllFileDeletedOnMessage:function(e){return!l.exists(this.getMessageFileInfos(e),function(e){return!e.deleted})},getFileInfoForMessages:function(e,t){return this.messageFileInfoGetter("_"+e.high+"_"+e.low,"_"+t.high+"_"+t.low)},getScheduledMessageFileInfos:function(e){var t=this,n="_"+e.high+"_"+e.low,i=P.map(P.option(this.scheduledMessageFileIdStrsMap.get(n)),function(e){return e.map(function(e){return t.fileInfoMap.get(t.getScheduledMessgaeFileKey(e,n))})});switch(i[1]){case 0:return i[2];case 1:return[]}},setScheduledMessageFileInfos:function(e,t){for(var n="_"+e.high+"_"+e.low,i=0;i<t.length;){var r=t[i];++i;var a=this.fileInfoMap,o=r.id,s=this.getScheduledMessgaeFileKey("_"+o.high+"_"+o.low,n),l=a;null!=Jo[s]?l.setReserved(s,r):l.h[s]=r}var u=this.scheduledMessageFileIdStrsMap,c=t.map(Ro(this,this.fileIdStrGetter)),_=u;null!=Jo[n]?_.setReserved(n,c):_.h[n]=c},removeScheduledMessageFileInfos:function(e){var t="_"+e.high+"_"+e.low,n=this.scheduledMessageFileIdStrsMap,i=null!=Jo[t]?n.getReserved(t):n.h[t];if(null!=i)for(var r=0;r<i.length;){var a=i[r];++r,this.fileInfoMap.remove(this.getScheduledMessgaeFileKey(a,t))}this.scheduledMessageFileIdStrsMap.remove(t)},getFileInfoForSheduledMessages:function(e,t){var n=this.fileInfoMap,i=this.getScheduledMessgaeFileKey("_"+e.high+"_"+e.low,"_"+t.high+"_"+t.low),r=n;return null!=Jo[i]?r.getReserved(i):r.h[i]},getNoteFileInfos:function(e){var t=this,n=e.toString(),i=P.map(P.option(this.noteFileIdStrsMap.get(n)),function(e){return e.map(Ro(t,t.fileInfoGetter))});switch(i[1]){case 0:return i[2];case 1:return[]}},setNoteFileInfos:function(e,t){var n=e.toString(),i=this.noteFileIdStrsMap,r=null!=Jo[n]?i.getReserved(n):i.h[n];if(null!=r)for(var a=0;a<r.length;){var o=r[a];++a,this.fileInfoMap.remove(o)}if(this.noteFileIdStrsMap.remove(n),null!=t&&0!=t.length){for(var s=0;s<t.length;){var l=t[s];++s;var u=l.id,c="_"+u.high+"_"+u.low,_=this.fileInfoMap;null!=Jo[c]?_.setReserved(c,l):_.h[c]=l}var h=this.noteFileIdStrsMap,d=t.map(Ro(this,this.fileIdStrGetter)),f=h;null!=Jo[n]?f.setReserved(n,d):f.h[n]=d}},getNoteFileInfosForEdit:function(e){var t=this,n=e.toString()+"edit",i=P.map(P.option(this.noteFileIdStrsMap.get(n)),function(e){return e.map(Ro(t,t.fileInfoGetter))});switch(i[1]){case 0:return i[2];case 1:return[]}},setNoteFileInfosForEdit:function(e,t){var n=e.toString()+"edit",i=this.noteFileIdStrsMap,r=null!=Jo[n]?i.getReserved(n):i.h[n];if(null!=r)for(var a=0;a<r.length;){var o=r[a];++a,this.fileInfoMap.remove(o)}if(this.noteFileIdStrsMap.remove(n),null!=t&&0!=t.length){for(var s=0;s<t.length;){var l=t[s];++s;var u=l.id,c="_"+u.high+"_"+u.low,_=this.fileInfoMap;null!=Jo[c]?_.setReserved(c,l):_.h[c]=l}var h=this.noteFileIdStrsMap,d=t.map(Ro(this,this.fileIdStrGetter)),f=h;null!=Jo[n]?f.setReserved(n,d):f.h[n]=d}},getFilePreview:function(e){var t="_"+e.high+"_"+e.low,n=this.filePreviewMap;return P.option(null!=Jo[t]?n.getReserved(t):n.h[t])},setFilePreview:function(e,t){var n="_"+e.high+"_"+e.low,i=this.filePreviewMap;null!=Jo[n]?i.setReserved(n,t):i.h[n]=t},fileIdStrGetter:function(e){var t=e.id;return"_"+t.high+"_"+t.low},fileInfoGetter:function(e){var t=this.fileInfoMap;return null!=Jo[e]?t.getReserved(e):t.h[e]},messageFileInfoSetter:function(e){var t=e.id,n=e.messageId,i="_"+t.high+"_"+t.low+"_"+n.high+"_"+n.low,r=this.fileInfoMap;null!=Jo[i]?r.setReserved(i,e):r.h[i]=e},messageFileInfoGetter:function(e,t){var n=this.fileInfoMap,i=e+t;return null!=Jo[i]?n.getReserved(i):n.h[i]},messageFileInfoRemover:function(e,t){this.fileInfoMap.remove(e+t)},getScheduledMessgaeFileKey:function(e,t){return e+t+"scheduled"},__class__:Bt};var Gt=function(e){null!=e&&(this.domainId=e.domain_id,this.show=e.show,this.updatedAt=e.updated_at,this.version=e.version)};n["albero.entity.FlowNotificationBadge"]=Gt,Gt.__name__=["albero","entity","FlowNotificationBadge"],Gt.prototype={__class__:Gt};var Ht=function(){};n["albero.entity.FlowNotificationBadgeStore"]=Ht,Ht.__name__=["albero","entity","FlowNotificationBadgeStore"],Ht.prototype={clear:function(){this.badgeMap=new eo},setBadge:function(e,t){null==this.badgeMap&&(this.badgeMap=new eo);var n="_"+e.high+"_"+e.low,i=this.badgeMap;null!=Jo[n]?i.setReserved(n,t):i.h[n]=t},getBadge:function(e){if(null==this.badgeMap)return null;var t="_"+e.high+"_"+e.low,n=this.badgeMap;return null!=Jo[t]?n.getReserved(t):n.h[t]},removeBadge:function(e){if(null!=this.badgeMap){var t="_"+e.high+"_"+e.low;this.badgeMap.remove(t)}},isBadgeShownForOneDomain:function(e){return null!=e&&this.isBadgeShown("_"+e.high+"_"+e.low)},isBadgeShown:function(e){if(null==this.badgeMap)return!1;var t=this.badgeMap,n=null!=Jo[e]?t.getReserved(e):t.h[e];return null!=n&&n.show},__class__:Ht};var zt=function(e){null!=e&&(this.talkId=e.talk_id,null!=e.messages&&(this.messages=ho.__cast(e.messages,Array).map(function(e){return new Yt(e)})))};n["albero.entity.HitContext"]=zt,zt.__name__=["albero","entity","HitContext"],zt.prototype={findHitMessage:function(e){return l.find(this.messages,function(t){var n=t.id;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low})},__class__:zt};var Yt=function(e){null!=e&&(this.id=e.message_id,this.talkId=e.talk_id,this.userId=e.user_id,this.type=Zt.typeOf(e.type),this.content=e.content,this.createdAt=e.created_at,this.hit=e.hit)};n["albero.entity.HitMessage"]=Yt,Yt.__name__=["albero","entity","HitMessage"],Yt.prototype={__class__:Yt};var Kt=function(){};n["albero.entity.IdSpec"]=Kt,Kt.__name__=["albero","entity","IdSpec"],Kt.timestamp=function(e){var t=Kt.TIMESTAMP_SHIFT;return 0==(t&=63)?new pi(e.high,e.low):t<32?new pi(e.high>>t,e.high<<32-t|e.low>>>t):new pi(e.high>>31,e.high>>t-32)},Kt.subTimestampPart=function(e,t){var n=Kt.timestamp(e),i=Kt.timestamp(t),r=n.high-i.high|0,a=n.low-i.low|0;if(Ba.ucompare(n.low,i.low)<0){r--;r|=0}return new pi(r,a)},Kt.createForTest=function(e){var t=Kt.TIMESTAMP_SHIFT;return 0==(t&=63)?new pi(e.high,e.low):t<32?new pi(e.high<<t|e.low>>>32-t,e.low<<t):new pi(e.low<<t-32,0)};var Wt=function(){};n["albero.entity.IdValue"]=Wt,Wt.__name__=["albero","entity","IdValue"],Wt.prototype={__class__:Wt};var jt=function(e){null!=e&&(this.conferenceId=e.conference_id,this.roomName=e.room_name,this.credential=e.credential,this.mode=this.parseMode(e.mode),this.timestamp=e.timestamp,this.skywayVersion=null==e.skyway_version?1:e.skyway_version)};n["albero.entity.JoinConference"]=jt,jt.__name__=["albero","entity","JoinConference"],jt.prototype={parseMode:function(e){return"sfu"==e?Vt.sfu:"fullMesh"==e?Vt.fullMesh:Vt.unknown},isSfu:function(e){switch(this.mode[1]){case 0:return!0;case 1:return!1;case 2:return e.type==Zn.GroupTalk}},getEllaspedSecOnJoin:function(){var e=R.fromIntOrInt64(this.credential.timestamp),t=R.fromIntOrInt64(this.timestamp),n=t.high-e.high|0,i=t.low-e.low|0;if(Ba.ucompare(t.low,e.low)<0){n--;n|=0}var r=new pi(n,i);return r.high<0?0:r.high>0||this.credential.ttl<r.low?this.credential.ttl:r.low},__class__:jt};var Vt=n["albero.entity.JoinConferenceMode"]={__ename__:["albero","entity","JoinConferenceMode"],__constructs__:["sfu","fullMesh","unknown"]};Vt.sfu=["sfu",0],Vt.sfu.toString=i,Vt.sfu.__enum__=Vt,Vt.fullMesh=["fullMesh",1],Vt.fullMesh.toString=i,Vt.fullMesh.__enum__=Vt,Vt.unknown=["unknown",2],Vt.unknown.toString=i,Vt.unknown.__enum__=Vt,Vt.__empty_constructs__=[Vt.sfu,Vt.fullMesh,Vt.unknown];var qt=n["albero.entity.LocalErrorType"]={__ename__:["albero","entity","LocalErrorType"],__constructs__:["FailedUser","RequestTimeout","TalksCountOvered","TalkersCountOvered","SendingMessageConflicted","DeletingMessageConflicted","UploadSizeOvered","StorageSizeOvered","GeneralFileError","UploadForbiddenForNote","UploadSizeOveredForNote","StorageSizeOveredForNote","GeneralFileErrorForNote","AddingSomeUsersFailure","NoteForwardingForbidden","ScheduleMessageFailed","SendingScheduledMessageFailed","CannotEditFile","CannotPlayFile","InvalidFileName","MaxBatchDownloadSize","BanForwardNote","DeletedNote","MaxAttachmentFileNum","MaxActionTextLength","CannotReadFileAsImage","FailedToLoadImage","ForbiddenFileExists","FailedToAddReaction","FailedToChangeReaction","FailedToCancelReaction"]};qt.FailedUser=["FailedUser",0],qt.FailedUser.toString=i,qt.FailedUser.__enum__=qt,qt.RequestTimeout=["RequestTimeout",1],qt.RequestTimeout.toString=i,qt.RequestTimeout.__enum__=qt,qt.TalksCountOvered=function(e){var t=["TalksCountOvered",2,e];return t.__enum__=qt,t.toString=i,t},qt.TalkersCountOvered=function(e){var t=["TalkersCountOvered",3,e];return t.__enum__=qt,t.toString=i,t},qt.SendingMessageConflicted=["SendingMessageConflicted",4],qt.SendingMessageConflicted.toString=i,qt.SendingMessageConflicted.__enum__=qt,qt.DeletingMessageConflicted=["DeletingMessageConflicted",5],qt.DeletingMessageConflicted.toString=i,qt.DeletingMessageConflicted.__enum__=qt,qt.UploadSizeOvered=function(e){var t=["UploadSizeOvered",6,e];return t.__enum__=qt,t.toString=i,t},qt.StorageSizeOvered=function(e){var t=["StorageSizeOvered",7,e];return t.__enum__=qt,t.toString=i,t},qt.GeneralFileError=["GeneralFileError",8],qt.GeneralFileError.toString=i,qt.GeneralFileError.__enum__=qt,qt.UploadForbiddenForNote=function(e){var t=["UploadForbiddenForNote",9,e];return t.__enum__=qt,t.toString=i,t},qt.UploadSizeOveredForNote=function(e,t){var n=["UploadSizeOveredForNote",10,e,t];return n.__enum__=qt,n.toString=i,n},qt.StorageSizeOveredForNote=function(e,t){var n=["StorageSizeOveredForNote",11,e,t];return n.__enum__=qt,n.toString=i,n},qt.GeneralFileErrorForNote=function(e){var t=["GeneralFileErrorForNote",12,e];return t.__enum__=qt,t.toString=i,t},qt.AddingSomeUsersFailure=["AddingSomeUsersFailure",13],qt.AddingSomeUsersFailure.toString=i,qt.AddingSomeUsersFailure.__enum__=qt,qt.NoteForwardingForbidden=["NoteForwardingForbidden",14],qt.NoteForwardingForbidden.toString=i,qt.NoteForwardingForbidden.__enum__=qt,qt.ScheduleMessageFailed=function(e){var t=["ScheduleMessageFailed",15,e];return t.__enum__=qt,t.toString=i,t},qt.SendingScheduledMessageFailed=["SendingScheduledMessageFailed",16],qt.SendingScheduledMessageFailed.toString=i,qt.SendingScheduledMessageFailed.__enum__=qt,qt.CannotEditFile=["CannotEditFile",17],qt.CannotEditFile.toString=i,qt.CannotEditFile.__enum__=qt,qt.CannotPlayFile=["CannotPlayFile",18],qt.CannotPlayFile.toString=i,qt.CannotPlayFile.__enum__=qt,qt.InvalidFileName=["InvalidFileName",19],qt.InvalidFileName.toString=i,qt.InvalidFileName.__enum__=qt,qt.MaxBatchDownloadSize=["MaxBatchDownloadSize",20],qt.MaxBatchDownloadSize.toString=i,qt.MaxBatchDownloadSize.__enum__=qt,qt.BanForwardNote=["BanForwardNote",21],qt.BanForwardNote.toString=i,qt.BanForwardNote.__enum__=qt,qt.DeletedNote=["DeletedNote",22],qt.DeletedNote.toString=i,qt.DeletedNote.__enum__=qt,qt.MaxAttachmentFileNum=function(e){var t=["MaxAttachmentFileNum",23,e];return t.__enum__=qt,t.toString=i,t},qt.MaxActionTextLength=function(e){var t=["MaxActionTextLength",24,e];return t.__enum__=qt,t.toString=i,t},qt.CannotReadFileAsImage=["CannotReadFileAsImage",25],qt.CannotReadFileAsImage.toString=i,qt.CannotReadFileAsImage.__enum__=qt,qt.FailedToLoadImage=["FailedToLoadImage",26],qt.FailedToLoadImage.toString=i,qt.FailedToLoadImage.__enum__=qt,qt.ForbiddenFileExists=function(e,t){var n=["ForbiddenFileExists",27,e,t];return n.__enum__=qt,n.toString=i,n},qt.FailedToAddReaction=["FailedToAddReaction",28],qt.FailedToAddReaction.toString=i,qt.FailedToAddReaction.__enum__=qt,qt.FailedToChangeReaction=["FailedToChangeReaction",29],qt.FailedToChangeReaction.toString=i,qt.FailedToChangeReaction.__enum__=qt,qt.FailedToCancelReaction=["FailedToCancelReaction",30],qt.FailedToCancelReaction.toString=i,qt.FailedToCancelReaction.__enum__=qt,qt.__empty_constructs__=[qt.FailedUser,qt.RequestTimeout,qt.SendingMessageConflicted,qt.DeletingMessageConflicted,qt.GeneralFileError,qt.AddingSomeUsersFailure,qt.NoteForwardingForbidden,qt.SendingScheduledMessageFailed,qt.CannotEditFile,qt.CannotPlayFile,qt.InvalidFileName,qt.MaxBatchDownloadSize,qt.BanForwardNote,qt.DeletedNote,qt.CannotReadFileAsImage,qt.FailedToLoadImage,qt.FailedToAddReaction,qt.FailedToChangeReaction,qt.FailedToCancelReaction];var Qt=n["albero.entity.ScheduleMessageFailedType"]={__ename__:["albero","entity","ScheduleMessageFailedType"],__constructs__:["InvalidCreateAt","Conflict","LimitReached","GeneralFileError","UploadSizeOvered","StorageSizeOvered","Unknown"]};Qt.InvalidCreateAt=["InvalidCreateAt",0],Qt.InvalidCreateAt.toString=i,Qt.InvalidCreateAt.__enum__=Qt,Qt.Conflict=["Conflict",1],Qt.Conflict.toString=i,Qt.Conflict.__enum__=Qt,Qt.LimitReached=["LimitReached",2],Qt.LimitReached.toString=i,Qt.LimitReached.__enum__=Qt,Qt.GeneralFileError=["GeneralFileError",3],Qt.GeneralFileError.toString=i,Qt.GeneralFileError.__enum__=Qt,Qt.UploadSizeOvered=function(e){var t=["UploadSizeOvered",4,e];return t.__enum__=Qt,t.toString=i,t},Qt.StorageSizeOvered=function(e){var t=["StorageSizeOvered",5,e];return t.__enum__=Qt,t.toString=i,t},Qt.Unknown=["Unknown",6],Qt.Unknown.toString=i,Qt.Unknown.__enum__=Qt,Qt.__empty_constructs__=[Qt.InvalidCreateAt,Qt.Conflict,Qt.LimitReached,Qt.GeneralFileError,Qt.Unknown];var Jt=function(){};n["albero.entity.LocalErrorTypeMixin"]=Jt,Jt.__name__=["albero","entity","LocalErrorTypeMixin"],Jt.toTitleText=function(e){switch(e[1]){case 0:return Nr.localize("LocalErrorType.failed_user");case 1:return Nr.localize("LocalErrorType.request_timeout");case 2:var t=e[2];return 0==t?Nr.localize("LocalErrorType.talks_forbidden"):Nr.localize("LocalErrorType.number_of_talks",{limitMax:t});case 3:var n=e[2];return Nr.localize("LocalErrorType.number_of_talkers",{limitMax:n});case 4:return Nr.localize("LocalErrorType.retry_sending");case 5:return Nr.localize("LocalErrorType.retry_deletion");case 6:var i=e[2],r=k.createByteSizeStringWithUnit(i);return Nr.localize("LocalErrorType.file_size",{sizeString:r});case 7:var a=e[2],o=k.createByteSizeStringWithUnit(a);return Nr.localize("LocalErrorType.storage_size",{sizeString:o});case 9:return Nr.localize("LocalErrorType.file_forbidden_for_note");case 10:var s=e[2],l=k.createByteSizeStringWithUnit(s);return Nr.localize("LocalErrorType.file_size",{sizeString:l});case 11:var u=e[2],c=k.createByteSizeStringWithUnit(u);return Nr.localize("LocalErrorType.storage_size",{sizeString:c});case 8:case 12:return Nr.localize("LocalErrorType.file");case 13:return Nr.localize("LocalErrorType.adding_users");case 14:return Nr.localize("LocalErrorType.note_forwarding_forbidden");case 15:return Nr.localize("LocalErrorType.schedule_message_failed");case 16:return Nr.localize("LocalErrorType.sending_scheduled_message_failed");case 17:return Nr.localize("LocalErrorType.cannot_edit_file");case 18:return Nr.localize("LocalErrorType.cannot_play_file");case 19:return Nr.localize("LocalErrorType.invalid_file_name");case 20:return Nr.localize("LocalErrorType.max_batch_download_size");case 21:return Nr.localize("LocalErrorType.ban_forward_note");case 22:return Nr.localize("LocalErrorType.deleted_note");case 23:var _=e[2];return Nr.localize("LocalErrorType.max_attachment_file_num",{maxAttachmentFileNum:_});case 24:var h=e[2];return Nr.localize("LocalErrorType.max_action_text_length",{maxActionTextLength:h});case 25:return Nr.localize("LocalErrorType.cannot_read_file_as_image");case 26:return Nr.localize("LocalErrorType.failed_to_load_image");case 27:var d=e[3],f=e[2],m=Nr.localize("LocalErrorType.period");return je.createAttachmentErrorMessage(f,d,m);case 28:return Nr.localize("LocalErrorType.failed_to_add_reaction");case 29:return Nr.localize("LocalErrorType.failed_to_change_reaction");case 30:return Nr.localize("LocalErrorType.failed_to_cancel_reaction")}},Jt.toBodyText=function(e){switch(e[1]){case 15:var t=e[2];return Jt.getScheduledMessageFailedBodyText(t);case 16:return Nr.localize("LocalErrorType.sending_scheduled_message_failed_by_unknown");default:return null}},Jt.getScheduledMessageFailedBodyText=function(e){switch(e[1]){case 0:return Nr.localize("LocalErrorType.schedule_message_failed_by_invalid_create_at");case 1:return Nr.localize("LocalErrorType.schedule_message_failed_by_conflict");case 2:return Nr.localize("LocalErrorType.schedule_message_failed_by_limit_reached");case 3:return Nr.localize("LocalErrorType.file");case 4:var t=e[2],n=k.createByteSizeStringWithUnit(t);return Nr.localize("LocalErrorType.file_size",{sizeString:n});case 5:var i=e[2],r=k.createByteSizeStringWithUnit(i);return Nr.localize("LocalErrorType.storage_size",{sizeString:r});case 6:return Nr.localize("LocalErrorType.schedule_message_failed_by_unknown")}},Jt.getNoteId=function(e){switch(e[1]){case 9:var t=e[2];return Za.Some(t);case 10:var n=e[3];return Za.Some(n);case 11:var i=e[3];return Za.Some(i);case 12:var r=e[2];return Za.Some(r);default:return Za.None}},Jt.convertFileErrorForNote=function(e,t){if(null==t)return null;if(403==t.code)return qt.UploadForbiddenForNote(e);if(502==t.code&&null!=t.detail){var n=R.fromIntOrInt64(t.detail.limit_max);if("file_size"==t.detail.limit_target)return qt.UploadSizeOveredForNote(n,e);if("storage_size"==t.detail.limit_target)return qt.UploadSizeOveredForNote(n,e)}return qt.GeneralFileErrorForNote(e)},Jt.getNoteForwardingForbiddenError=function(){return qt.NoteForwardingForbidden};var Xt=function(e){Mt.call(this,e),null!=e&&(this.email=e.email,this.signinId=e.signin_id,null!=e.profiles&&(this.profiles=ho.__cast(e.profiles,Array).map(function(e){return new hn(e)})),null!=e.departments&&(this.departments=ho.__cast(e.departments,Array).map(function(e){return new bt(e)})))};n["albero.entity.Me"]=Xt,Xt.__name__=["albero","entity","Me"],Xt.__super__=Mt,Xt.prototype=r(Mt.prototype,{toDomainUser:function(e){var t=new Ct;if(t.id=this.id,t.status=this.status,t.domainId=e,t.displayName=this.displayName,t.canonicalDisplayName=this.canonicalDisplayName,t.phoneticDisplayName=this.phoneticDisplayName,t.canonicalPhoneticDisplayName=this.canonicalPhoneticDisplayName,t.profileImageUrl=this.profileImageUrl,t.updatedAt=this.updatedAt,t.email=this.email,null!=this.profiles)for(var n=0,i=this.profiles;n<i.length;){var r=i[n];++n;var a=r.domainId;if(null!=a&&null!=e&&a.high==e.high&&a.low==e.low){t.profileContact=r.itemValues;break}}if(null!=this.departments)for(var o=0,s=this.departments;o<s.length;){var l=s[o];++o;var u=l.domainId;if(null!=u&&null!=e&&u.high==e.high&&u.low==e.low){t.departments=l.departments;break}}return t},__class__:Xt});var Zt=function(e){if(this.scheduleAt=null,this.mention=!1,null==e)return this.readUserIds=[],void(this.favorite=new Vi(null));this.id=e.message_id,this.talkId=e.talk_id,this.userId=e.user_id,this.type=Zt.typeOf(e.type),this.content=e.content,this.createdAt=e.created_at,this.readCount=e.read_count,this.readUserIds=null==e.read_user_ids?[]:e.read_user_ids,this.mention=null!=e.mention&&e.mention,this.isUnreadCountTarget=null==e.is_unread_count_target||e.is_unread_count_target,this.isBotMessage=null!=e.bot_message&&e.bot_message,this.favorite=new Vi(e.favorite)};n["albero.entity.Message"]=Zt,Zt.__name__=["albero","entity","Message"],Zt.typeOf=function(e){switch(e){case 0:return $t.system;case 1:return $t.text;case 2:return $t.stamp;case 3:return $t.geo;case 4:return $t.file;case 5:return $t.textMultipleFile;case 7:return $t.deleted;case 8:return $t.noteShared;case 9:return $t.noteDeleted;case 10:return $t.noteCreated;case 11:return $t.noteUpdated;case 12:return $t.originalStamp;case 500:return $t.yesOrNo;case 501:return $t.yesOrNoReply;case 502:return $t.selectOne;case 503:return $t.selectOneReply;case 504:return $t.todo;case 505:return $t.todoDone;case 506:return $t.yesOrNoClosed;case 507:return $t.selectOneClosed;case 508:return $t.todoClosed;case 509:return $t.openConference;case 600:return $t.phoneCall;case 601:return $t.phoneReceive;default:return $t.unknown}},Zt.enumIndex=function(e){switch(e[1]){case 0:case 1:case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:return e[1];case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:return 500+e[1]-13;case 23:case 24:return 600+e[1]-23;default:return-1}},Zt.typeString=function(e){return g.string(e)},Zt.getDisplayTextWithoutEscape=function(e,t){switch(e[1]){case 1:return t;case 7:return Zt.getDeletedText();default:return Ar._e("["+s.dateStr(new Date)+"] ","Unsupported message.type is detected.",e,"","",""),Zt.getUnsupportText()}},Zt.getDeletedText=function(){return Nr.localize("MessageHelper.deleted")},Zt.getUnsupportText=function(){return Nr.localize("MessageHelper.not_support")},Zt.getCorrectedFilesContentForForwarding=function(e){return C.filterDeleted(e).map(function(e){return Zt.getCorrectedFileContentForForwarding(e)})},Zt.getCorrectedFileContentForForwarding=function(e){var t={url:Zt.getCorrectedUrlForForwarding(e.url),content_type:e.content_type,content_size:e.content_size,name:e.name,file_id:e.file_id};return null!=e.thumbnail_url&&(t.thumbnail_url=Zt.getCorrectedUrlForForwarding(e.thumbnail_url)),t},Zt.getCorrectedUrlForForwarding=function(e){var t=e.split("?message_id=");return 0!=t.length?t[0]:""},Zt.prototype={isDummy:function(){return null!=this.id&&this.id.high<0},isScheduledMessage:function(){return null!=this.scheduleAt},messageStringForKeywordDetection:function(e){switch(this.type[1]){case 0:return"";case 1:return this.content;case 3:case 4:return"";case 5:return null!=this.content.text&&this.content.text.length>0?this.content.text:"";case 7:return"";case 2:case 12:return null!=this.content.text&&this.content.text.length>0?this.content.text:"";case 13:return[this.content.question,Nr.localize("MessageStringMaker.yes"),Nr.localize("MessageStringMaker.no")].join(" ");case 14:return e&&null!=this.content.response?this.content.response?Nr.localize("MessageStringMaker.yes"):Nr.localize("MessageStringMaker.no"):"";case 15:return null!=this.content.options?g.string(this.content.question)+" "+g.string(this.content.options.join(" ")):this.content.question;case 16:return e&&null!=this.content.response&&null!=this.content.options&&this.content.options.length>this.content.response?this.content.options[this.content.response]:"";case 17:return[this.content.title,Nr.localize("MessageStringMaker.achieve"),Nr.localize("MessageStringMaker.remand")].join(" ");case 18:return e&&null!=this.content.done?this.content.done?Nr.localize("MessageStringMaker.achieve"):Nr.localize("MessageStringMaker.remand"):"";case 19:case 20:case 21:default:return""}},messageStringForCompactMessage:function(){switch(this.type[1]){case 1:return this.content;case 5:if(null!=this.content.text&&this.content.text.length>0)return this.content.text;break;case 7:return Nr.localize("Message.bookmark_label_deleted");case 8:return[Nr.localize("Message.bookmark_label_note_shared"),new Hi(this.content).title].join(" ");case 10:return[Nr.localize("Message.bookmark_label_note_created"),new Hi(this.content).title].join(" ");case 11:return[Nr.localize("Message.bookmark_label_note_updated"),new Hi(this.content).title].join(" ");case 2:case 12:return null!=this.content.text&&this.content.text.length>0?[Nr.localize("Message.bookmark_label_stamp"),this.content.text].join(" "):Nr.localize("Message.bookmark_label_stamp");case 14:case 16:return[Nr.localize("Message.bookmark_label_answer"),this.content.question].join(" ");case 13:case 15:return[Nr.localize("Message.bookmark_label_question"),this.content.question].join(" ");case 17:return[Nr.localize("Message.bookmark_label_task"),this.content.title].join(" ");case 18:return[this.content.done?Nr.localize("Message.bookmark_label_completed"):Nr.localize("Message.bookmark_label_reverted"),this.content.title].join(" ");case 19:case 20:return[Nr.localize("Message.bookmark_label_closed"),this.content.question].join(" ");case 21:return[Nr.localize("Message.bookmark_label_closed"),this.content.title].join(" ")}return""},getContentsForNote:function(){switch(this.type[1]){case 8:case 10:case 11:return new Hi(this.content);default:return null}},messageStringRaw:function(){switch(this.type[1]){case 0:return"";case 1:return this.content;case 3:case 4:return"";case 5:return null!=this.content.text&&this.content.text.length>0?this.content.text:"";case 8:case 9:case 10:case 11:return"";case 2:case 12:return null!=this.content.text&&this.content.text.length>0?this.content.text:"";case 14:case 16:return"";case 13:case 15:return this.content.question;case 17:return this.content.title;case 18:return"";case 19:case 20:case 21:case 22:default:return""}},getContentsForNoteDelete:function(){return 9==this.type[1]?new zi(this.content):null},getContentsForOriginalStamp:function(){return 12==this.type[1]?new Yi(this.content):null},isAllowedToDelete:function(e){return!!(this.isSentBy(e)&&this.isNotSystemMessage()&&this.isNotActionStampMessage()&&this.isNotNoteMessage())&&this.isNotDeletedMessage()},isAllowedToReply:function(e){return!(!this.isNotSentBy(e)||!this.isNotSystemMessage())&&this.isNotDeletedMessage()},isAllowedToShowSelectionMessageMenu:function(){return!(this.type!=$t.text&&!this.isStampMessageWithText())||this.isTextMultipleFileWithText()},isAllowedToQuote:function(e){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotFileMessage()&&this.isNotStampMessageWithEmptyText())&&this.isNotTextMultipleFileWithEmptyText()},isAllowedToCopy:function(){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotFileMessage()&&this.isNotStampMessageWithEmptyText())&&this.isNotTextMultipleFileWithEmptyText()},isAllowedToCopyLink:function(){return!(!this.isNotSystemMessage()||!this.isNotDeletedMessage())&&this.isNotStampMessageWithEmptyText()},isAllowedToForward:function(e){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotActionStampMessage()&&this.isNotDeletedFileMessage(e)&&this.isNotTextMultipleFileAllDeletedWithEmptyText(e)&&this.isNotNoteMessage())&&this.isNotOpenConference()},isAllowedToForwardOnOnlyTextOrStamp:function(){return!(!this.isTextMessage()&&!this.isStampMessage())||this.isTextMultipleFileWithText()},isAllowedToAddToFavorites:function(){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotOpenConference()&&this.isNotStampMessageWithEmptyText()&&this.isNotNoteDeletedMessage())&&this.isNotFavorite()},isAllowedToRemoveFromFavorites:function(){return!!(this.isNotSystemMessage()&&this.isNotDeletedMessage()&&this.isNotOpenConference()&&this.isNotStampMessageWithEmptyText()&&this.isNotNoteDeletedMessage())&&this.isFavorite()},isMatchCategory:function(e){switch(e[1]){case 0:return!!(this.isTextMessage()||this.isFileMessage()||this.isTextMultipleFile())||this.isStampMessageWithText();case 1:return!1}},isSentBy:function(e){var t=this.userId;return null!=e&&null!=t&&e.high==t.high&&e.low==t.low},isNotSentBy:function(e){return!this.isSentBy(e)},isSystemMessage:function(){return this.type==$t.system},isNotSystemMessage:function(){return!this.isSystemMessage()},isActionStampMessage:function(){return this.type==$t.yesOrNo||this.type==$t.yesOrNoReply||this.type==$t.selectOne||this.type==$t.selectOneReply||this.type==$t.todo||this.type==$t.todoDone||this.type==$t.yesOrNoClosed||this.type==$t.selectOneClosed||this.type==$t.todoClosed},isNotActionStampMessage:function(){return!this.isActionStampMessage()},isReplyActionStampMessage:function(){return this.type==$t.selectOneReply||this.type==$t.yesOrNoReply||this.type==$t.todoDone},isClosedActionStampMessage:function(){return this.type==$t.yesOrNoClosed||this.type==$t.selectOneClosed||this.type==$t.todoClosed},isTextMultipleFile:function(){return this.type==$t.textMultipleFile},isSendingActionStampMessage:function(){return this.type==$t.yesOrNo||this.type==$t.selectOne||this.type==$t.todo},isNoteMessage:function(){return this.type==$t.noteShared||this.type==$t.noteDeleted||this.type==$t.noteCreated||this.type==$t.noteUpdated},isNoteDeletedMessage:function(){return this.type==$t.noteDeleted},isNotNoteMessage:function(){return!this.isNoteMessage()},isNotNoteDeletedMessage:function(){return!this.isNoteDeletedMessage()},isDeletedMessage:function(){return this.type==$t.deleted},isNotDeletedMessage:function(){return!this.isDeletedMessage()},isFileMessage:function(){return this.type==$t.file},isNotFileMessage:function(){return!this.isFileMessage()},isStampMessage:function(){return this.type==$t.stamp||this.type==$t.originalStamp},isNotStampMessage:function(){return!this.isStampMessage()},isStampMessageWithText:function(){return!!this.isStampMessage()&&this.isNotObjectWithEmptyText()},isStampMessageWithEmptyText:function(){return!!this.isStampMessage()&&this.isObjectWithEmptyText()},isNotStampMessageWithEmptyText:function(){return!!this.isNotStampMessage()||this.isNotObjectWithEmptyText()},isObjectWithEmptyText:function(){return B.isEmpty(this.content.text)},isNotObjectWithEmptyText:function(){return!this.isObjectWithEmptyText()},isNotTextMultipleFile:function(){return!this.isTextMultipleFile()},isTextMultipleFileWithText:function(){return!!this.isTextMultipleFile()&&this.isNotObjectWithEmptyText()},isTextMultipleFileWithEmptyText:function(){return!!this.isTextMultipleFile()&&this.isObjectWithEmptyText()},isNotTextMultipleFileWithEmptyText:function(){return!!this.isNotTextMultipleFile()||this.isNotObjectWithEmptyText()},isNotDeletedFileMessage:function(e){return!!this.isNotFileMessage()||!e},isNotTextMultipleFileAllDeletedWithEmptyText:function(e){return!!this.isNotTextMultipleFileWithEmptyText()||!e},isTextMessage:function(){return this.type==$t.text},isOpenConference:function(){return this.type==$t.openConference},isNotOpenConference:function(){return!this.isOpenConference()},getInReplyTo:function(){var e=this.type;return Ar._i("["+s.dateStr(new Date)+"] ",e,"","","",""),this.isReplyActionStampMessage()||this.isClosedActionStampMessage()?Za.Some(this.content.in_reply_to):Za.None},isNotFavorite:function(){return!this.isFavorite()},isFavorite:function(){return this.favorite.isFavorite()},isNotCalloutHolder:function(){return!(!this.isFileMessage()&&!this.isTextMultipleFileWithEmptyText())||this.isStampMessageWithEmptyText()},isNotReactionTarget:function(){return!!(this.isSystemMessage()||this.isDeletedMessage()||this.isOpenConference()||this.isNoteDeletedMessage())||this.isDummy()},isReactionTarget:function(){return!this.isNotReactionTarget()},close:function(){this.content.closed=!0},markAsDeleted:function(){this.type=$t.deleted,this.content=""},updateFavorite:function(e){this.favorite.update(e)},addReadUsersUntillMaxCount:function(e){var t=this;if(!(this.readUserIds.length>=16)){var n=e.filter(function(e){return R.notContains(t.readUserIds,e)});this.readUserIds=this.readUserIds.concat(n).slice(0,16)}},createReadCountText:function(){return this.readUserIds.length>=16?"15+":g.string(this.readUserIds.length)},hasNoReadUsers:function(){return 0==this.readUserIds.length},deleteFile:function(e){var t;switch(this.type[1]){case 4:t=[this.content];break;case 5:t=this.content.files;break;default:t=[]}if(0!=t.length){var n=l.find(t,function(t){var n=t.file_id,i=e.fileId;return null!=n&&null!=i&&n.high==i.high&&n.low==i.low});null!=n&&(n.deleted=!0)}},getQuestionTitle:function(){switch(this.type[1]){case 17:case 18:case 21:return null==this.content.title?"":this.content.title;case 13:case 14:case 15:case 16:case 19:case 20:return null==this.content.question?"":this.content.question;default:return""}},getChoiceCloseResponse:function(e){var t=Nr.localize("QuestionHelper.close_answer")+"\n";if(null==this.content.responses)t+="...";else{var n=this.content.responses,i=this.content.last_response;if(0==En.closingTypeOf(this.content.closing_type)[1])t+=null!=i?Nr.localize("QuestionHelper.last_response",{content:e(n[i].content),interpolation:{escapeValue:!1}}):Nr.localize("QuestionHelper.no_answer");else{t+=null!=i?null==n?"":n.map(function(t){var n=null==t.count?0:t.count;return e(t.content)+": "+n+Nr.localize("QuestionHelper.name")}).join("\n"):Nr.localize("QuestionHelper.no_answer")}}return t},getTodoCloseResponse:function(){var e=Nr.localize("QuestionHelper.close_task")+"\n";if(null==this.content.responses)e+="...";else{var t=this.content.responses,n=this.content.last_response;if(0==En.closingTypeOf(this.content.closing_type)[1]){e+=null!=n&&"DONE"==t[n].content?Nr.localize("QuestionHelper.achieve_task"):Nr.localize("QuestionHelper.not_achieve_task")}else{var i=0;if(null!=t)for(var r=0;r<t.length;){var a=t[r];if(++r,"DONE"==a.content){i=null==a.count?0:a.count;break}}e+=0!=i?Nr.localize("QuestionHelper.completed")+": "+i+Nr.localize("QuestionHelper.name"):Nr.localize("QuestionHelper.no_achiever")}}return e},createMessageForForwarding:function(e,t){switch(e[1]){case 0:return null;case 1:switch(this.type[1]){case 4:var n=Zt.getCorrectedFilesContentForForwarding([this.content]);if(0==n.length)return null;var i=new Zt;return i.type=$t.file,i.content=n[0],i;case 5:var r=Zt.getCorrectedFilesContentForForwarding(this.content.files);if(0==r.length){var a=t(this.content.text);return this.createTextMessage(a)}var o=new Zt;if(o.type=$t.textMultipleFile,o.content={files:r},null!=this.content.text){var s=t(this.content.text);o.content.text=s}return o}break;case 2:switch(this.type[1]){case 4:return null;case 5:if(null==this.content.text)return null;var l=t(this.content.text);return this.createTextMessage(l)}break;case 3:return null}switch(this.type[1]){case 1:var u=t(this.content);return this.createTextMessage(u);case 2:var c=new Zt;if(c.type=$t.stamp,c.content={stamp_set:this.content.stamp_set,stamp_index:this.content.stamp_index},null!=this.content.text){var _=t(this.content.text);c.content.text=_}return c;case 5:var h=new Zt;if(h.type=$t.textMultipleFile,h.content={files:this.content.files},null!=this.content.text){var d=t(this.content.text);h.content.text=d}return h;case 12:var f=new Zt;if(f.type=$t.originalStamp,f.content={stampset_id:this.content.stampset_id,stamp_id:this.content.stamp_id},null!=this.content.text){var m=t(this.content.text);f.content.text=m}return f;default:return null}},createTextMessage:function(e){if(null==e||0==e.length)return null;var t=new Zt;return t.type=$t.text,t.content=e,t},__class__:Zt};var $t=n["albero.entity.MessageType"]={__ename__:["albero","entity","MessageType"],__constructs__:["system","text","stamp","geo","file","textMultipleFile","unused","deleted","noteShared","noteDeleted","noteCreated","noteUpdated","originalStamp","yesOrNo","yesOrNoReply","selectOne","selectOneReply","todo","todoDone","yesOrNoClosed","selectOneClosed","todoClosed","openConference","phoneCall","phoneReceive","unknown"]};$t.system=["system",0],$t.system.toString=i,$t.system.__enum__=$t,$t.text=["text",1],$t.text.toString=i,$t.text.__enum__=$t,$t.stamp=["stamp",2],$t.stamp.toString=i,$t.stamp.__enum__=$t,$t.geo=["geo",3],$t.geo.toString=i,$t.geo.__enum__=$t,$t.file=["file",4],$t.file.toString=i,$t.file.__enum__=$t,$t.textMultipleFile=["textMultipleFile",5],$t.textMultipleFile.toString=i,$t.textMultipleFile.__enum__=$t,$t.unused=["unused",6],$t.unused.toString=i,$t.unused.__enum__=$t,$t.deleted=["deleted",7],$t.deleted.toString=i,$t.deleted.__enum__=$t,$t.noteShared=["noteShared",8],$t.noteShared.toString=i,$t.noteShared.__enum__=$t,$t.noteDeleted=["noteDeleted",9],$t.noteDeleted.toString=i,$t.noteDeleted.__enum__=$t,$t.noteCreated=["noteCreated",10],$t.noteCreated.toString=i,$t.noteCreated.__enum__=$t,$t.noteUpdated=["noteUpdated",11],$t.noteUpdated.toString=i,$t.noteUpdated.__enum__=$t,$t.originalStamp=["originalStamp",12],$t.originalStamp.toString=i,$t.originalStamp.__enum__=$t,$t.yesOrNo=["yesOrNo",13],$t.yesOrNo.toString=i,$t.yesOrNo.__enum__=$t,$t.yesOrNoReply=["yesOrNoReply",14],$t.yesOrNoReply.toString=i,$t.yesOrNoReply.__enum__=$t,$t.selectOne=["selectOne",15],$t.selectOne.toString=i,$t.selectOne.__enum__=$t,$t.selectOneReply=["selectOneReply",16],$t.selectOneReply.toString=i,$t.selectOneReply.__enum__=$t,$t.todo=["todo",17],$t.todo.toString=i,$t.todo.__enum__=$t,$t.todoDone=["todoDone",18],$t.todoDone.toString=i,$t.todoDone.__enum__=$t,$t.yesOrNoClosed=["yesOrNoClosed",19],$t.yesOrNoClosed.toString=i,$t.yesOrNoClosed.__enum__=$t,$t.selectOneClosed=["selectOneClosed",20],$t.selectOneClosed.toString=i,$t.selectOneClosed.__enum__=$t,$t.todoClosed=["todoClosed",21],$t.todoClosed.toString=i,$t.todoClosed.__enum__=$t,$t.openConference=["openConference",22],$t.openConference.toString=i,$t.openConference.__enum__=$t,$t.phoneCall=["phoneCall",23],$t.phoneCall.toString=i,$t.phoneCall.__enum__=$t,$t.phoneReceive=["phoneReceive",24],$t.phoneReceive.toString=i,$t.phoneReceive.__enum__=$t,$t.unknown=["unknown",25],$t.unknown.toString=i,$t.unknown.__enum__=$t,$t.__empty_constructs__=[$t.system,$t.text,$t.stamp,$t.geo,$t.file,$t.textMultipleFile,$t.unused,$t.deleted,$t.noteShared,$t.noteDeleted,$t.noteCreated,$t.noteUpdated,$t.originalStamp,$t.yesOrNo,$t.yesOrNoReply,$t.selectOne,$t.selectOneReply,$t.todo,$t.todoDone,$t.yesOrNoClosed,$t.selectOneClosed,$t.todoClosed,$t.openConference,$t.phoneCall,$t.phoneReceive,$t.unknown];var en=n["albero.entity.MessageCategory"]={__ename__:["albero","entity","MessageCategory"],__constructs__:["textOrFiles","unknown"]};en.textOrFiles=["textOrFiles",0],en.textOrFiles.toString=i,en.textOrFiles.__enum__=en,en.unknown=["unknown",1],en.unknown.toString=i,en.unknown.__enum__=en,en.__empty_constructs__=[en.textOrFiles,en.unknown];var tn=function(e){null!=e&&(this.talkId=e[0],this.messageId=e[1],this.isMention=!!e[2])};n["albero.entity.MessageDeletion"]=tn,tn.__name__=["albero","entity","MessageDeletion"],tn.prototype={__class__:tn};var nn=function(e){this.id=e.message_id,this.talkId=e.talk_id,this.readUserIds=null==e.read_user_ids?[]:e.read_user_ids,this.unreadUserIds=null==e.unread_user_ids?[]:e.unread_user_ids};n["albero.entity.MessageReadStatus"]=nn,nn.__name__=["albero","entity","MessageReadStatus"],nn.prototype={__class__:nn};var rn=function(e){this.talkId=e.talk_id,this.messageIds=e.message_ids,this.mentionMessageIds=null==e.mention_message_ids?[]:e.mention_message_ids,this.readUserIds=null==e.read_user_ids?[]:e.read_user_ids,this.messageIdsExcludingUnreadCountTargets=e.message_ids_excluding_unread_count_targets,null==this.messageIdsExcludingUnreadCountTargets&&(this.messageIdsExcludingUnreadCountTargets=[])};n["albero.entity.MessageReadStatusesUpdate"]=rn,rn.__name__=["albero","entity","MessageReadStatusesUpdate"],rn.prototype={__class__:rn};var an=function(){this.messageIdsFromThisDevice=new eo,this.messages=new eo};n["albero.entity.MessageStore"]=an,an.__name__=["albero","entity","MessageStore"],an.prototype={getMessage:function(e){if(null==e)return null;var t="_"+e.high+"_"+e.low,n=this.messages;return null!=Jo[t]?n.getReserved(t):n.h[t]},setMessage:function(e){},removeMessage:function(e){this.messages.remove("_"+e.high+"_"+e.low)},setFromThisDevice:function(e){},isFromThisDevice:function(e){var t="_"+e.high+"_"+e.low,n=this.messageIdsFromThisDevice;return null!=Jo[t]?n.existsReserved(t):n.h.hasOwnProperty(t)},deleteFile:function(e){var t=this.getMessage(e.messageId);null!=t&&t.deleteFile(e)},closeConference:function(e){var t=this.getMessage(e.messageId);null!=t&&t.close()},closeAction:function(e){var t=this.getMessage(e);null!=t&&t.close()},deleteFavoriteMessage:function(e){var t=this.getMessage(e.getMessageId());null==t||t.updateFavorite(e)},addFavoriteMessage:function(e){var t=this.getMessage(e.getMessageId());null==t?this.setMessage(e.getMessage()):t.updateFavorite(e)},__class__:an};var on=n["albero.entity.MessagesOrder"]={__ename__:["albero","entity","MessagesOrder"],__constructs__:["asc","desc"]};on.asc=["asc",0],on.asc.toString=i,on.asc.__enum__=on,on.desc=["desc",1],on.desc.toString=i,on.desc.__enum__=on,on.__empty_constructs__=[on.asc,on.desc];var sn=function(){};n["albero.entity.MessagesOrderProc"]=sn,sn.__name__=["albero","entity","MessagesOrderProc"],sn.orderToInt=function(e){switch(e[1]){case 0:return 1;case 1:return 2}};var ln=n["albero.entity.PaneType"]={__ename__:["albero","entity","PaneType"],__constructs__:["SingleTalkPane","MultiTalkPane1","MultiTalkPane2","MultiTalkPane3"]};ln.SingleTalkPane=["SingleTalkPane",0],ln.SingleTalkPane.toString=i,ln.SingleTalkPane.__enum__=ln,ln.MultiTalkPane1=["MultiTalkPane1",1],ln.MultiTalkPane1.toString=i,ln.MultiTalkPane1.__enum__=ln,ln.MultiTalkPane2=["MultiTalkPane2",2],ln.MultiTalkPane2.toString=i,ln.MultiTalkPane2.__enum__=ln,ln.MultiTalkPane3=["MultiTalkPane3",3],ln.MultiTalkPane3.toString=i,ln.MultiTalkPane3.__enum__=ln,ln.__empty_constructs__=[ln.SingleTalkPane,ln.MultiTalkPane1,ln.MultiTalkPane2,ln.MultiTalkPane3];var un=function(){};n["albero.entity.PaneTypeHelper"]=un,un.__name__=["albero","entity","PaneTypeHelper"],un.toPanePrefix=function(e){switch(e[1]){case 0:return"";case 1:return"multi1-";case 2:return"multi2-";case 3:return"multi3-"}},un.getPaneType=function(e){switch(e){case 0:return ln.SingleTalkPane;case 1:return ln.MultiTalkPane1;case 2:return ln.MultiTalkPane2;case 3:return ln.MultiTalkPane3;default:return null}},un.getMultiPaneType=function(e){switch(e){case 0:return ln.MultiTalkPane1;case 1:return ln.MultiTalkPane2;case 2:return ln.MultiTalkPane3;default:return ln.MultiTalkPane1}},un.getMultiPaneTypes=function(){return[ln.MultiTalkPane1,ln.MultiTalkPane2,ln.MultiTalkPane3]},un.fromString=function(e){switch(e){case"multi1":return ln.MultiTalkPane1;case"multi2":return ln.MultiTalkPane2;case"multi3":return ln.MultiTalkPane3;default:return ln.SingleTalkPane}},un.toString=function(e){switch(e[1]){case 0:return"single";case 1:return"multi1";case 2:return"multi2";case 3:return"multi3"}};var cn=function(e){null!=e&&(this.expiration=e.expiration,this.warning=e.warning)};n["albero.entity.PasswordExpiration"]=cn,cn.__name__=["albero","entity","PasswordExpiration"],cn.prototype={isExpired:function(e){return this.timeOvered(this.expiration,e)},needWarning:function(e,t){return!!this.timeOveredOrNotExist(t,e)&&this.timeOvered(this.warning,e)},timeOvered:function(e,t){if(null!=e){var n=t.high-e.high|0;return n=0!=n?n:Ba.ucompare(t.low,e.low),(t.high<0?e.high<0?n:-1:e.high>=0?n:1)>0}return!1},timeOveredOrNotExist:function(e,t){return null==e||this.timeOvered(e,t)},__class__:cn};var _n=function(e){null!=e&&(this.name=e.plan_name,this.trial=!!e.trial,this.free=!!e.free)};n["albero.entity.Plan"]=_n,_n.__name__=["albero","entity","Plan"],_n.prototype={__class__:_n};var hn=function(e){null!=e&&(this.domainId=e.domain_id,this.userId=e.user_id,this.itemValues=null,null!=e.item_values&&(this.itemValues=ho.__cast(e.item_values,Array).map(function(e){return new mn(e)})))};n["albero.entity.Profile"]=hn,hn.__name__=["albero","entity","Profile"],hn.prototype={__class__:hn};var dn=function(e){if(null!=e&&(this.domainId=e.domain_id,null!=e.item_definitions)){this.itemDefinitions=[];for(var t=0,n=ho.__cast(e.item_definitions,Array);t<n.length;){var i=n[t];++t,this.itemDefinitions.push(new fn(i))}}};n["albero.entity.ProfileDefinition"]=dn,dn.__name__=["albero","entity","ProfileDefinition"],dn.isSameProfileItemDefinitions=function(e,t){if(t.length!=e.length)return!1;for(var n=0,i=t.length;n<i;){var r=n++;if(t[r].profileItemId!=e[r].profileItemId)return!1}return!0},dn.prototype={getVisibleItemDefinitions:function(e,t){return null==t&&(t=!1),null==e&&(e=!1),null==this.itemDefinitions?[]:this.itemDefinitions.filter(function(n){return!!n.visible&&(!(!e&&10!=n.group)&&(!t||1!=n.profileItemId&&2!=n.profileItemId))})},__class__:dn};var fn=function(e){this.locked=!1,this.visible=!0,null!=e&&(this.profileItemId=e.profile_item_id,this.group=e.group,this.name=e.name,this.valueType=e.value_type,null!=e.visible&&(this.visible=e.visible),null!=e.locked&&(this.locked=e.locked))};n["albero.entity.ProfileItemDefinition"]=fn,fn.__name__=["albero","entity","ProfileItemDefinition"],fn.findById=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.profileItemId==t)return i}return null},fn.prototype={__class__:fn};var mn=function(e){null!=e&&(this.profileItemId=e.profile_item_id,this.value=e.value,this.canonicalValue=e.canonical_value)};n["albero.entity.ProfileItemValue"]=mn,mn.__name__=["albero","entity","ProfileItemValue"],mn.findById=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.profileItemId==t)return i}return null},mn.prototype={__class__:mn};var pn=function(e,t){this.domainId=e,this.profileItemValues=t};n["albero.entity.ProfileItemValuesPerDomain"]=pn,pn.__name__=["albero","entity","ProfileItemValuesPerDomain"],pn.convertToApiParams=function(e){return e.map(function(e){return e.convertToApiParamsPerDomain()})},pn.prototype={convertToApiParamsPerDomain:function(){return[this.domainId,this.profileItemValues.map(function(e){return{profile_item_id:e.profileItemId,value:e.value}})]},__class__:pn};var gn=function(e){this.type=null==e?Sn.All:this.createPushNotificationType(e.type,e.enabled),this.version=null==e?0:e.version};n["albero.entity.PushNotificationSetting"]=gn,gn.__name__=["albero","entity","PushNotificationSetting"],gn.createWithParams=function(e,t){var n=new gn;return n.type=e,n.version=t,n},gn.prototype={isDisabled:function(){return this.type==Sn.None},createPushNotificationType:function(e,t){return null!=t?t?Sn.All:Sn.None:vn.fromRawValue(e)},__class__:gn};var vn=function(){};n["albero.entity.PushNotificationTypeHelper"]=vn,vn.__name__=["albero","entity","PushNotificationTypeHelper"],vn.fromRawValue=function(e){if(null==e)return Sn.All;if(null==e)return Sn.All;switch(e){case 0:return Sn.None;case 1:return Sn.All;case 2:return Sn.Mention;default:return Sn.All}},vn.toRawValue=function(e){switch(e[1]){case 0:return 1;case 1:return 2;case 2:return 0}},vn.fromString=function(e){return w.createEnum(Sn,e)},vn.toString=function(e){return e[0]};var Sn=n["albero.entity.PushNotificationType"]={__ename__:["albero","entity","PushNotificationType"],__constructs__:["All","Mention","None"]};Sn.All=["All",0],Sn.All.toString=i,Sn.All.__enum__=Sn,Sn.Mention=["Mention",1],Sn.Mention.toString=i,Sn.Mention.__enum__=Sn,Sn.None=["None",2],Sn.None.toString=i,Sn.None.__enum__=Sn,Sn.__empty_constructs__=[Sn.All,Sn.Mention,Sn.None];var yn=function(e){null!=e&&(this.id=e.message_id,this.talkId=e.talk_id,this.type=Zt.typeOf(e.type),this.content=e.content,this.userId=e.user_id,this.recipientIds=e.assigned_user_ids,this.responses=yn.createResponses(e.responses),this.listing=e.listing,this.closingType=En.closingTypeOf(e.closing_type),this.maxResponseId=e.max_response_id,this.lastResponse=e.last_response,this.lastResponseUserId=e.last_response_user_id,this.createdAt=e.created_at,this.updatedAt=e.updated_at,this.responded=e.responded,this.closed=e.closed)};n["albero.entity.Question"]=yn,yn.__name__=["albero","entity","Question"],yn.createResponses=function(e){var t,n=P.option(e);switch(n[1]){case 0:t=n[2];break;case 1:t=[]}return t.map(function(e){return new Nn(e)})},yn.createResponsesFromStrings=function(e){var t,n=P.option(e);switch(n[1]){case 0:t=n[2];break;case 1:t=[]}return t.map(function(e){return new Nn({content:e,count:0,user_ids:[]})})},yn.createResponseTexts=function(e,t){switch(e[1]){case 13:return["YES","NO"];case 15:return t;case 17:return["DONE","UNDONE"];default:return[]}},yn.fromMessageAndTalk=function(e,t){var n=new yn;n.id=e.id,n.talkId=e.talkId,n.type=e.type;var i,r=P.option(e.content.title);switch(r[1]){case 0:i=r[2];break;case 1:i=e.content.question}n.content=i,n.userId=e.userId,n.recipientIds=t.userIds,n.responses=yn.createResponsesFromStrings(yn.createResponseTexts(e.type,e.content.options));var a,o=P.option(e.content.listing);switch(o[1]){case 0:a=o[2];break;case 1:a=!0}n.listing=a,n.closingType=En.closingTypeOf(e.content.closing_type),n.maxResponseId=null,n.lastResponse=null,n.lastResponseUserId=null,n.updatedAt=n.createdAt=e.createdAt,n.responded=!1;var s,l=P.option(e.content.closed);switch(l[1]){case 0:s=l[2];break;case 1:s=!1}return n.closed=s,n},yn.createTodoDoneMessageWithParams=function(e,t,n){var i=new Zt;return i.talkId=e,i.type=$t.todoDone,i.content={in_reply_to:t,done:n},i},yn.createYesOrNoReplyMessageWithParams=function(e,t,n){var i=new Zt;return i.talkId=e,i.content={in_reply_to:t,response:n},i.type=$t.yesOrNoReply,i},yn.createSelectOneReplyMessageWithParams=function(e,t,n){var i=new Zt;return i.talkId=e,i.content={in_reply_to:t,response:n},i.type=$t.selectOneReply,i},yn.fromTypeToInt=function(e){switch(e[1]){case 0:return 0;case 1:return 1}},yn.filterToOpBool=function(e){switch(e[1]){case 0:return Za.Some(!0);case 1:return Za.Some(!1);case 2:return Za.None}},yn.isDoneResponse=function(e){return"DONE"==e.content},yn.prototype={isCompleted:function(e){if(w.enumEq(this.type,$t.todo)){if(w.enumEq(this.closingType,In.any)){if(null!=this.lastResponse&&"DONE"==this.responses[this.lastResponse].content)return!0}else{if(!this.responded)return!1;for(var t=0,n=this.responses;t<n.length;){var i=n[t];if(++t,i.contains(e))return"DONE"==i.content}}return!1}return w.enumEq(this.closingType,In.any)?null!=this.lastResponse:this.responded},createTodoDoneMessage:function(e){return yn.createTodoDoneMessageWithParams(this.talkId,this.id,e)},createYesOrNoReplyMessage:function(e){return yn.createYesOrNoReplyMessageWithParams(this.talkId,this.id,e)},createSelectOneReplyMessage:function(e){return yn.createSelectOneReplyMessageWithParams(this.talkId,this.id,e)},createActionCloseMessage:function(){var e=new Zt;switch(e.talkId=this.talkId,e.content={in_reply_to:this.id},this.type[1]){case 13:e.type=$t.yesOrNoClosed;break;case 15:e.type=$t.selectOneClosed;break;case 17:e.type=$t.todoClosed;break;default:Ar._e("["+s.dateStr(new Date)+"] ","message type is not action.","","","","")}return e},getLastResponse:function(){var e=this;return P.map(P.option(this.lastResponse),function(t){return e.responses[t]})},getLastDoneResponse:function(){return P.filter(this.getLastResponse(),yn.isDoneResponse)},getDoneResponse:function(){return P.option(l.find(this.responses,yn.isDoneResponse))},isSendingQuestion:function(){return this.type==$t.yesOrNo||this.type==$t.selectOne||this.type==$t.todo},isNotSendingQuestion:function(){return!this.isSendingQuestion()},getChoices:function(){return this.responses.map(function(e){return e.content})},updateByMessage:function(e,t){switch(e.type[1]){case 14:var n=new ji(e.content).getResponseIndex();this.updateByReply(n,e,t);break;case 16:var i=new Ki(e.content).getResponseIndex();this.updateByReply(i,e,t);break;case 18:var r=new Wi(e.content).getResponseIndex();this.updateByReply(r,e,t);break;case 19:case 20:case 21:this.updateByClose()}},updateByClose:function(){this.closed=!0},updateByReply:function(e,t,n){this.updateByReplySub(e,t.id,t.userId,t.createdAt,n)},updateByReplySub:function(e,t,n,i,r){l.iter(this.responses,function(e){e.sub(n)}),this.responses[e].add(n),r&&(this.responded=!0);var a=this.updatedAt,o=i.high-a.high|0;o=0!=o?o:Ba.ucompare(i.low,a.low),(i.high<0?a.high<0?o:-1:a.high>=0?o:1)>0&&(this.updatedAt=i,this.maxResponseId=t,this.lastResponse=e,this.lastResponseUserId=n)},__class__:yn};var wn=n["albero.entity.QuestionFromType"]={__ename__:["albero","entity","QuestionFromType"],__constructs__:["fromSelf","fromOther"]};wn.fromSelf=["fromSelf",0],wn.fromSelf.toString=i,wn.fromSelf.__enum__=wn,wn.fromOther=["fromOther",1],wn.fromOther.toString=i,wn.fromOther.__enum__=wn,wn.__empty_constructs__=[wn.fromSelf,wn.fromOther];var Tn=n["albero.entity.QuestionFilter"]={__ename__:["albero","entity","QuestionFilter"],__constructs__:["onlyClosed","onlyUnclosed","noFilter"]};Tn.onlyClosed=["onlyClosed",0],Tn.onlyClosed.toString=i,Tn.onlyClosed.__enum__=Tn,Tn.onlyUnclosed=["onlyUnclosed",1],Tn.onlyUnclosed.toString=i,Tn.onlyUnclosed.__enum__=Tn,Tn.noFilter=["noFilter",2],Tn.noFilter.toString=i,Tn.noFilter.__enum__=Tn,Tn.__empty_constructs__=[Tn.onlyClosed,Tn.onlyUnclosed,Tn.noFilter];var In=n["albero.entity.QuestionClosingType"]={__ename__:["albero","entity","QuestionClosingType"],__constructs__:["any","all","unknown"]};In.any=["any",0],In.any.toString=i,In.any.__enum__=In,In.all=["all",1],In.all.toString=i,In.all.__enum__=In,In.unknown=["unknown",2],In.unknown.toString=i,In.unknown.__enum__=In,In.__empty_constructs__=[In.any,In.all,In.unknown];var En=function(){};n["albero.entity.QuestionClosingTypeHelper"]=En,En.__name__=["albero","entity","QuestionClosingTypeHelper"],En.closingTypeOf=function(e){switch(e){case 0:return In.any;case 1:return In.all;default:return In.unknown}};var Nn=function(e){this.content=e.content,this.count=null==e.count?0:e.count,this.userIds=null==e.user_ids?[]:e.user_ids};n["albero.entity.QuestionResponse"]=Nn,Nn.__name__=["albero","entity","QuestionResponse"],Nn.prototype={add:function(e){this.contains(e)||(this.count+=1,this.userIds=this.userIds.concat([e]))},sub:function(e){this.contains(e)&&(this.count-=1,this.userIds=this.userIds.filter(function(t){return!(e.high==t.high&&e.low==t.low)}))},contains:function(e){return R.contains(this.userIds,e)},__class__:Nn};var An=function(){this.questions=new eo};n["albero.entity.QuestionStore"]=An,An.__name__=["albero","entity","QuestionStore"],An.prototype={removeTalkQuestions:function(e){for(var t=this.getQuestions(e),n=0;n<t.length;){var i=t[n];++n;var r=i.id;this.questions.remove("_"+r.high+"_"+r.low)}},getQuestions:function(e,t){return l.array(this.questions).filter(function(n){var i=n.talkId;if(null!=i&&null!=e&&i.high==e.high&&i.low==e.low){if(null!=t){var r=n.userId;return null!=t&&null!=r&&t.high==r.high&&t.low==r.low}return!0}return!1})},getQuestion:function(e){var t="_"+e.high+"_"+e.low,n=this.questions;return null!=Jo[t]?n.getReserved(t):n.h[t]},setQuestion:function(e){},__class__:An};var bn=function(e){null!=e&&(this.msgRetentionPeriod=e.msg_retention_period,this.msgFileSize=e.msg_file_size,this.maxMessageContentLength=e.max_message_content_length,this.maxTalkers=e.max_talkers,this.maxTalks=e.max_talks,this.withAd=!!e.with_ad)};n["albero.entity.Quota"]=bn,bn.__name__=["albero","entity","Quota"],bn.prototype={__class__:bn};var Dn=function(e){if(null!=e&&(this.total=e.total,this.marker=e.marker,this.nextMarker=e.next_marker,this.contents=[],null!=e.contents))for(var t=0,n=ho.__cast(e.contents,Array);t<n.length;){var i=n[t];++t,this.contents.push(new xt(i))}};n["albero.entity.SearchAttachmentsResult"]=Dn,Dn.__name__=["albero","entity","SearchAttachmentsResult"],Dn.prototype={__class__:Dn};var Mn=function(e){null!=e&&(this.total=e.total,this.marker=e.marker,this.nextMarker=e.next_marker,this.contents=[],null!=e.contents&&(this.contents=ho.__cast(e.contents,Array).map(function(e){return new zt(e)})))};n["albero.entity.SearchMessagesResult"]=Mn,Mn.__name__=["albero","entity","SearchMessagesResult"],Mn.prototype={__class__:Mn};var Cn=function(e){null!=e&&(null!=e.domain_id_str&&(this.domainId=R.makeFromIdStr(e.domain_id_str)),null!=e.talk_id_str&&(this.talkId=R.makeFromIdStr(e.talk_id_str)),this.keyword=e.keyword,null==e.search_type||e.search_type==On.toLocalizeText(kn.MESSAGES)?this.searchType=kn.MESSAGES:this.searchType=kn.ATTACHMENTS,this.sinceText=e.since,this.untilText=e.until,null!=e.from_id_str&&(this.fromUserId=R.makeFromIdStr(e.from_id_str)))};n["albero.entity.SearchParams"]=Cn,Cn.__name__=["albero","entity","SearchParams"],Cn.dateQueryToText=function(e,t){if(null==e)return t;switch(e){case"-1d":return Nr.localize("SearchParams.text_date_yesterday");case"-3d":return Nr.localize("SearchParams.text_date_three_days_before");case"t":return Nr.localize("SearchParams.text_date_today");default:return S.replace(e,"-","/")}},Cn.dateQueryToBaseValue=function(e){if(null==e)return null;switch(e){case"-1d":return"-1d";case"-3d":return"-3d";case"t":return"0d";default:return S.replace(e,"-","/")}},Cn.searchTypeToKey=function(e){switch(e[1]){case 0:return"messages";case 1:return"attachments"}},Cn.prototype={toProps:function(){var e={};if(null!=this.domainId){var t=this.domainId;e.domain_id_str="_"+t.high+"_"+t.low}if(null!=this.talkId){var n=this.talkId;e.talk_id_str="_"+n.high+"_"+n.low}if(e.keyword=this.keyword,e.search_type=On.toLocalizeText(this.searchType),e.since=this.sinceText,e.until=this.untilText,null!=this.fromUserId){var i=this.fromUserId;e.from_id_str="_"+i.high+"_"+i.low}return e},copy:function(){return new Cn(this.toProps())},eq:function(e){return!!this.isSameInt64(this.domainId,e.domainId)&&(!!this.isSameInt64(this.talkId,e.talkId)&&(this.keyword==e.keyword&&(!!w.enumEq(this.searchType,e.searchType)&&(this.sinceText==e.sinceText&&(this.untilText==e.untilText&&!!this.isSameInt64(this.fromUserId,e.fromUserId))))))},isSameInt64:function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.high==t.high&&e.low==t.low},getQueryText:function(){var e=[];return null!=this.keyword&&0!=this.keyword.length&&e.push(this.keyword),null!=this.sinceText&&e.push("since:"+this.sinceText),null!=this.untilText&&e.push("until:"+this.untilText),null!=this.fromUserId&&e.push("from:"+Ga.toString(this.fromUserId)),e.join(" ")},getPeriodText:function(){return Cn.dateQueryToText(this.sinceText,"")+"~"+Cn.dateQueryToText(this.untilText,"")},__class__:Cn};var kn=n["albero.entity.SearchType"]={__ename__:["albero","entity","SearchType"],__constructs__:["MESSAGES","ATTACHMENTS"]};kn.MESSAGES=["MESSAGES",0],kn.MESSAGES.toString=i,kn.MESSAGES.__enum__=kn,kn.ATTACHMENTS=["ATTACHMENTS",1],kn.ATTACHMENTS.toString=i,kn.ATTACHMENTS.__enum__=kn,kn.__empty_constructs__=[kn.MESSAGES,kn.ATTACHMENTS];var On=function(){};n["albero.entity.SearchTypeUtil"]=On,On.__name__=["albero","entity","SearchTypeUtil"],On.toLocalizeText=function(e){switch(e[1]){case 0:return Nr.localize("SearchParams.text_type_messages");case 1:return Nr.localize("SearchParams.text_type_attachments")}};var Rn=n["albero.entity.SearchDate"]={__ename__:["albero","entity","SearchDate"],__constructs__:["DATE_NONE","DATE_TODAY","DATE_YESTERDAY","DATE_THREE_DAYS_BEFORE","DATE_CALENDAR"]};Rn.DATE_NONE=["DATE_NONE",0],Rn.DATE_NONE.toString=i,Rn.DATE_NONE.__enum__=Rn,Rn.DATE_TODAY=["DATE_TODAY",1],Rn.DATE_TODAY.toString=i,Rn.DATE_TODAY.__enum__=Rn,Rn.DATE_YESTERDAY=["DATE_YESTERDAY",2],Rn.DATE_YESTERDAY.toString=i,Rn.DATE_YESTERDAY.__enum__=Rn,Rn.DATE_THREE_DAYS_BEFORE=["DATE_THREE_DAYS_BEFORE",3],Rn.DATE_THREE_DAYS_BEFORE.toString=i,Rn.DATE_THREE_DAYS_BEFORE.__enum__=Rn,Rn.DATE_CALENDAR=["DATE_CALENDAR",4],Rn.DATE_CALENDAR.toString=i,Rn.DATE_CALENDAR.__enum__=Rn,Rn.__empty_constructs__=[Rn.DATE_NONE,Rn.DATE_TODAY,Rn.DATE_YESTERDAY,Rn.DATE_THREE_DAYS_BEFORE,Rn.DATE_CALENDAR];var Fn=function(){};n["albero.entity.SearchDateUtil"]=Fn,Fn.__name__=["albero","entity","SearchDateUtil"],Fn.createSearchDateArray=function(e){return e?[Rn.DATE_TODAY,Rn.DATE_YESTERDAY,Rn.DATE_THREE_DAYS_BEFORE,Rn.DATE_CALENDAR]:[Rn.DATE_YESTERDAY,Rn.DATE_THREE_DAYS_BEFORE,Rn.DATE_CALENDAR]},Fn.toLocalizeText=function(e){switch(e[1]){case 0:return Nr.localize("SearchParams.text_date_none");case 1:return Nr.localize("SearchParams.text_date_today");case 2:return Nr.localize("SearchParams.text_date_yesterday");case 3:return Nr.localize("SearchParams.text_date_three_days_before");case 4:return Nr.localize("SearchParams.text_date_calendar")}};var Un=function(e){null!=e&&(this.user=new Xt(e.user),this.device=e.device,this.notification=e.notification,this.passwordExpiration=new cn(e.password_expiration),this.configuration=new rt(e.configuration))};n["albero.entity.Session"]=Un,Un.__name__=["albero","entity","Session"],Un.prototype={__class__:Un};var xn=function(e){null!=e&&(this.solutionId=e.solution_id,this.name=e.name,null!=e.link&&(this.link=new Pn(e.link)),null!=e.plugin&&(this.plugin=new Ln(e.plugin)))};n["albero.entity.Solution"]=xn,xn.__name__=["albero","entity","Solution"],xn.getSolutionType=function(e){switch(e){case 1:return Bn.PhotoViewTrial;case 2:return Bn.PhotoView;case 3:return Bn.MultiView;case 4:return Bn.KeywordWatching;case 26:return Bn.Flow;default:return Bn.Unknown}},xn.getSolutionIdFromType=function(e){switch(e[1]){case 0:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 26;default:return null}},xn.prototype={__class__:xn};var Pn=function(e){null!=e&&(this.iconUrl=e.icon_url,this.url=e.url)};n["albero.entity.SolutionLink"]=Pn,Pn.__name__=["albero","entity","SolutionLink"],Pn.prototype={getUrlWithPlaceholderParams:function(e,t){return null==this.url?null:S.replace(S.replace(this.url,"${domain_id}",Ga.toString(e)),"${user_id}",Ga.toString(t))},__class__:Pn};var Ln=function(e){null!=e&&(this.url=e.url,this.loaded=!1)};n["albero.entity.SolutionPlugin"]=Ln,Ln.__name__=["albero","entity","SolutionPlugin"],Ln.prototype={__class__:Ln};var Bn=n["albero.entity.SolutionType"]={__ename__:["albero","entity","SolutionType"],__constructs__:["PhotoViewTrial","PhotoView","MultiView","KeywordWatching","Flow","Unknown"]};Bn.PhotoViewTrial=["PhotoViewTrial",0],Bn.PhotoViewTrial.toString=i,Bn.PhotoViewTrial.__enum__=Bn,Bn.PhotoView=["PhotoView",1],Bn.PhotoView.toString=i,Bn.PhotoView.__enum__=Bn,Bn.MultiView=["MultiView",2],Bn.MultiView.toString=i,Bn.MultiView.__enum__=Bn,Bn.KeywordWatching=["KeywordWatching",3],Bn.KeywordWatching.toString=i,Bn.KeywordWatching.__enum__=Bn,Bn.Flow=["Flow",4],Bn.Flow.toString=i,Bn.Flow.__enum__=Bn,Bn.Unknown=["Unknown",5],Bn.Unknown.toString=i,Bn.Unknown.__enum__=Bn,Bn.__empty_constructs__=[Bn.PhotoViewTrial,Bn.PhotoView,Bn.MultiView,Bn.KeywordWatching,Bn.Flow,Bn.Unknown];var Gn=function(){this.loadingSolutionIdsMap=new Ja,this.solutionsMap=new Ja};n["albero.entity.SolutionStore"]=Gn,Gn.__name__=["albero","entity","SolutionStore"],Gn.prototype={setSolution:function(e){this.solutionsMap.h[e.solutionId]=e},getSolution:function(e){return this.solutionsMap.h[e]},isLoadedSolutionId:function(e){return this.solutionsMap.h.hasOwnProperty(e)},addLoadingSolutionId:function(e){this.loadingSolutionIdsMap.h[e]=!0},removeLoadingSolutionId:function(e){this.loadingSolutionIdsMap.remove(e)},isLoadingSolutionId:function(e){return this.loadingSolutionIdsMap.h.hasOwnProperty(e)},__class__:Gn};var Hn=function(){};n["albero.entity.Stamp"]=Hn,Hn.__name__=["albero","entity","Stamp"],Hn.prototype={__class__:Hn};var zn=function(e){this.commonStampId=e};n["albero.entity.CommonStamp"]=zn,zn.__name__=["albero","entity","CommonStamp"],zn.__interfaces__=[Hn],zn.fromCommonStampId=function(e){return new zn(e)},zn.fromJson=function(e){return null==e.commonStampId?null:zn.fromCommonStampId(e.commonStampId)},zn.prototype={getImageUrl:function(){return"./assets/images/stamp/3/"+this.commonStampId+".png"},getKey:function(){return"common_"+this.commonStampId},toJson:function(){return{commonStampId:this.commonStampId}},createMessage:function(e,t){var n=new Zt;return n.talkId=e,n.type=$t.stamp,n.content={stamp_set:3,stamp_index:this.createStampIndex()},null!=t&&0!=t.length&&(n.content.text=t),n},createStampIndex:function(){for(var e=new pi(0,0),t=new pi(0,10),n=0,i=this.commonStampId.length;n<i;){var r=n++,a=65535&e.low,o=e.low>>>16,s=65535&t.low,l=t.low>>>16,u=Ba._mul(a,s),c=Ba._mul(o,s),_=Ba._mul(a,l),h=u,d=(Ba._mul(o,l)+(_>>>16)|0)+(c>>>16)|0;if(h=h+(_<<=16)|0,Ba.ucompare(h,_)<0){d++;d|=0}if(h=h+(c<<=16)|0,Ba.ucompare(h,c)<0){d++;d|=0}d=d+(Ba._mul(e.low,t.high)+Ba._mul(e.high,t.low)|0)|0;var f=new pi(d,h),m=new pi(0,g.parseInt(this.commonStampId.charAt(r))),p=f.high+m.high|0,v=f.low+m.low|0;if(Ba.ucompare(v,f.low)<0){p++;p|=0}e=new pi(p,v)}return e},__class__:zn};var Yn=function(e,t,n){this.stampsetId=e,this.id=t,this.illust=n};n["albero.entity.OriginalStamp"]=Yn,Yn.__name__=["albero","entity","OriginalStamp"],Yn.__interfaces__=[Hn],Yn.fromJson=function(e){if(null==e.originalStamp)return null;var t=e.originalStamp;if(null==t.stampsetIdStr||null==t.stampIdStr)return null;var n=R.makeFromIdStr(t.stampsetIdStr),i=R.makeFromIdStr(t.stampIdStr);return new Yn(n,i,t.illust)},Yn.fromPropsAndStampsetId=function(e,t){return new Yn(t,R.fromIntOrInt64(e.id),e.illust)},Yn.createKey=function(e){return"original__"+e.high+"_"+e.low},Yn.prototype={getImageUrl:function(){return this.illust},getKey:function(){return Yn.createKey(this.id)},toJson:function(){var e=this.stampsetId,t=this.id;return{originalStamp:{stampsetIdStr:"_"+e.high+"_"+e.low,stampIdStr:"_"+t.high+"_"+t.low,illust:this.illust}}},createMessage:function(e,t){var n=new Zt;return n.talkId=e,n.type=$t.originalStamp,n.content={stampset_id:this.stampsetId,stamp_id:this.id},null!=t&&0!=t.length&&(n.content.text=t),n},__class__:Yn};var Kn=function(){this.stampsetStore=new eo,this.stampStore=new eo,this.stampKeyCategoryIdMap=new eo};n["albero.entity.StampStore"]=Kn,Kn.__name__=["albero","entity","StampStore"],Kn.prototype={addStampsets:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.addStampset(n)}},addStampset:function(e,t){null==t&&(t=!0);var n=this.stampsetStore,i=e.toTabId(),r=n;null!=Jo[i]?r.setReserved(i,e):r.h[i]=e;for(var a=0,o=e.getStamps();a<o.length;){var s=o[a];++a;var l,u=s.getKey();if(t)l=!0;else{var c=this.stampStore;l=!(null!=Jo[u]?c.existsReserved(u):c.h.hasOwnProperty(u))}if(l){var _=this.stampStore;null!=Jo[u]?_.setReserved(u,s):_.h[u]=s}if(t){var h=this.stampKeyCategoryIdMap,d=e.getCategoryId(),f=h;null!=Jo[u]?f.setReserved(u,d):f.h[u]=d}}},updateStampsetInfo:function(e){var t=e.toTabId(),n=this.stampsetStore,i=null!=Jo[t]?n.getReserved(t):n.h[t];if(null!=i&&i.isOlderThan(e)){this.stampsetStore.remove(t);for(var r=0,a=i.getStamps();r<a.length;){var o=a[r];++r,this.stampStore.remove(o.getKey())}}},removeStampsetInfo:function(e){var t=Ga.toString(e),n=this.stampsetStore,i=null!=Jo[t]?n.getReserved(t):n.h[t];if(null!=i){this.stampsetStore.remove(t);for(var r=0,a=i.getStamps();r<a.length;){var o=a[r];++r,this.stampStore.remove(o.getKey())}}},addStampsetInfos:function(e){var t=this;l.iter(e,function(e){var n=t.stampsetStore,i=e.toTabId(),r=n;if(null!=Jo[i]?!r.existsReserved(i):!r.h.hasOwnProperty(i)){var a=Wn.fromStampsetInfo(e);t.addStampset(a)}})},getStampsetByStampsetId:function(e){return this.getStampsetByTabId("_"+e.high+"_"+e.low)},getStampsetsByTabIds:function(e){return e.map(Ro(this,this.getStampsetByTabId)).filter(function(e){return null!=e})},getStampsetByTabId:function(e){var t=this.stampsetStore;return null!=Jo[e]?t.getReserved(e):t.h[e]},getStampByStampKey:function(e){var t=this.stampStore;return null!=Jo[e]?t.getReserved(e):t.h[e]},getOriginalStamp:function(e){var t=this.getStampByStampKey(Yn.createKey(e));return null==t?null:ho.__cast(t,Yn)},applyHistories:function(e,t){var n=this,i=t.map(function(t){var i=zn.fromJson(t);if(null!=i){var r=n.stampKeyCategoryIdMap,a=i.getKey(),o=r,l=null!=Jo[a]?o.getReserved(a):o.h[a];return e.builtinStampSetting.isStampsetEnabled(l)?i:null}var u=Yn.fromJson(t);if(null!=u){var c=ho.__cast(u,Yn);if(null!=e&&e.stampsetSetting.containSendableStampset(c.stampsetId))return u}return Ar._d("["+s.dateStr(new Date)+"] ","A history stamp is disabled.",t,e,"",""),null}).filter(function(e){return null!=e}),r=Wn.historyStampset();r.setStamps(i);this.addStampset(r,!1)},__class__:Kn};var Wn=function(e,t,n,i){this.stampsetType=e,this.name=t,this.icon=n,this.version=i,this.stamps=[]};n["albero.entity.Stampset"]=Wn,Wn.__name__=["albero","entity","Stampset"],Wn.historyStampset=function(){return new Wn(Qn.getHistoryStampsetType(),"stamp-history",null,0)},Wn.commonStampset=function(e,t,n){return new Wn(Qn.fromCommonStampCategoryIndex(e),t,"./assets/images/stamp/3/"+n,0)},Wn.originalStampset=function(e){var t=R.fromIntOrInt64(e.stampset_id),n=Qn.fromStampsetId(t),i=new Wn(n,e.name,e.icon,e.version);if(null!=e.stamps){var r=ho.__cast(e.stamps,Array).map(function(e){return Yn.fromPropsAndStampsetId(e,t)});i.setStamps(r)}return i},Wn.fromStampsetInfo=function(e){var t=Qn.fromStampsetId(e.stampsetId);return new Wn(t,e.name,e.icon,e.version)},Wn.prototype={getCategoryId:function(){return this.stampsetType.toCategoryId()},toTabId:function(){return this.stampsetType.toTabId()},getIconUrl:function(){return this.icon},isStampHistory:function(){return"stamp-history"==this.name},isOriginalStampset:function(){return this.stampsetType.isOriginalStampset()},isEmpty:function(){return 0==this.stamps.length},setStamps:function(e){this.stamps=e},getStamps:function(){return this.stamps},isOlderThan:function(e){return this.version<e.version},__class__:Wn};var jn=function(e){null!=e&&(this.stampsetId=R.fromIntOrInt64(e.stampset_id),this.name=e.name,this.icon=e.icon,this.version=e.version)};n["albero.entity.StampsetInfo"]=jn,jn.__name__=["albero","entity","StampsetInfo"],jn.prototype={toTabId:function(){var e=this.stampsetId;return"_"+e.high+"_"+e.low},eqStampsetId:function(e){var t=this.stampsetId,n=e.stampsetId;return null!=t&&null!=n&&t.high==n.high&&t.low==n.low},isNewerThan:function(e){return this.version>e.version},__class__:jn};var Vn=function(e){this.stampsetInfos=[],this.allowCreateMessageStampsetIds=[],this.version=0,null!=e&&(this.version=e.version,this.allowCreateMessageStampsetIds=e.allow_create_message_stampset_ids.map(R.fromIntOrInt64),this.stampsetInfos=this.getStampsetInfos(e.stampset_infos))};n["albero.entity.StampsetSetting"]=Vn,Vn.__name__=["albero","entity","StampsetSetting"],Vn.prototype={getStampsetInfos:function(e){return null==e?[]:e.map(function(e){return new jn(e)})},isForwardForbidden:function(e){var t=e.getContentsForOriginalStamp(),n=null==t?null:t.stampsetId;return null!=n&&!this.containSendableStampset(n)},containSendableStampset:function(e){return null!=this.allowCreateMessageStampsetIds&&l.exists(this.allowCreateMessageStampsetIds,function(t){return null!=e&&null!=t&&e.high==t.high&&e.low==t.low})},containVisibleStampset:function(e){return l.exists(this.stampsetInfos,function(t){var n=t.stampsetId;return null!=e&&null!=n&&e.high==n.high&&e.low==n.low})},getSendableStampsetInfos:function(){var e=this;return null==this.stampsetInfos?[]:null==this.allowCreateMessageStampsetIds?[]:this.stampsetInfos.filter(function(t){return e.containSendableStampset(t.stampsetId)})},isNewerThan:function(e){return this.version>e.version},updateStampsetInfo:function(e){this.stampsetInfos=this.stampsetInfos.map(function(t){return e.eqStampsetId(t)&&e.isNewerThan(t)?e:t})},deleteStampsetInfo:function(e){this.stampsetInfos=this.stampsetInfos.filter(function(t){var n=t.stampsetId;return!(null!=n&&null!=e&&n.high==e.high&&n.low==e.low)}),this.allowCreateMessageStampsetIds=this.allowCreateMessageStampsetIds.filter(function(t){return!(null!=t&&null!=e&&t.high==e.high&&t.low==e.low)})},getStampsetIdsDiff:function(e){for(var t=new eo,n=e.stampsetInfos.concat(this.stampsetInfos),i=0;i<n.length;){var r=n[i];++i;var a=r.stampsetId,o="_"+a.high+"_"+a.low,s=((null!=Jo[o]?t.existsReserved(o):t.h.hasOwnProperty(o))?null!=Jo[o]?t.getReserved(o):t.h[o]:0)+1;null!=Jo[o]?t.setReserved(o,s):t.h[o]=s}for(var l=[],u=t.keys();u.hasNext();){var c=u.next();1==(null!=Jo[c]?t.getReserved(c):t.h[c])&&l.push(R.makeFromIdStr(c))}return l},isStampsetIdsEmpty:function(){return 0==this.allowCreateMessageStampsetIds.length},__class__:Vn};var qn=n["albero.entity.StampsetTypeValue"]={__ename__:["albero","entity","StampsetTypeValue"],__constructs__:["HISTORY","COMMON_CIMMON","COMMON_BUSINESS","COMMON_BUSINESS_TEXT","COMMON_LARGE_TEXT","COMMON_EFFECT","COMMON_EFFECT2","COMMON_HANKO","COMMON_YUZU","COMMON_YUZU2","COMMON_YUZU3","ORIGINAL"]};qn.HISTORY=["HISTORY",0],qn.HISTORY.toString=i,qn.HISTORY.__enum__=qn,qn.COMMON_CIMMON=["COMMON_CIMMON",1],qn.COMMON_CIMMON.toString=i,qn.COMMON_CIMMON.__enum__=qn,qn.COMMON_BUSINESS=["COMMON_BUSINESS",2],qn.COMMON_BUSINESS.toString=i,qn.COMMON_BUSINESS.__enum__=qn,qn.COMMON_BUSINESS_TEXT=["COMMON_BUSINESS_TEXT",3],qn.COMMON_BUSINESS_TEXT.toString=i,qn.COMMON_BUSINESS_TEXT.__enum__=qn,qn.COMMON_LARGE_TEXT=["COMMON_LARGE_TEXT",4],qn.COMMON_LARGE_TEXT.toString=i,qn.COMMON_LARGE_TEXT.__enum__=qn,qn.COMMON_EFFECT=["COMMON_EFFECT",5],qn.COMMON_EFFECT.toString=i,qn.COMMON_EFFECT.__enum__=qn,qn.COMMON_EFFECT2=["COMMON_EFFECT2",6],qn.COMMON_EFFECT2.toString=i,qn.COMMON_EFFECT2.__enum__=qn,qn.COMMON_HANKO=["COMMON_HANKO",7],qn.COMMON_HANKO.toString=i,qn.COMMON_HANKO.__enum__=qn,qn.COMMON_YUZU=["COMMON_YUZU",8],qn.COMMON_YUZU.toString=i,qn.COMMON_YUZU.__enum__=qn,qn.COMMON_YUZU2=["COMMON_YUZU2",9],qn.COMMON_YUZU2.toString=i,qn.COMMON_YUZU2.__enum__=qn,qn.COMMON_YUZU3=["COMMON_YUZU3",10],qn.COMMON_YUZU3.toString=i,qn.COMMON_YUZU3.__enum__=qn,qn.ORIGINAL=function(e){var t=["ORIGINAL",11,e];return t.__enum__=qn,t.toString=i,t},qn.__empty_constructs__=[qn.HISTORY,qn.COMMON_CIMMON,qn.COMMON_BUSINESS,qn.COMMON_BUSINESS_TEXT,qn.COMMON_LARGE_TEXT,qn.COMMON_EFFECT,qn.COMMON_EFFECT2,qn.COMMON_HANKO,qn.COMMON_YUZU,qn.COMMON_YUZU2,qn.COMMON_YUZU3];var Qn=function(e){this.value=e};n["albero.entity.StampsetType"]=Qn,Qn.__name__=["albero","entity","StampsetType"],Qn.fromStampsetId=function(e){return new Qn(qn.ORIGINAL(e))},Qn.fromCommonStampCategoryIndex=function(e){switch(e){case 0:return new Qn(qn.COMMON_CIMMON);case 1:return new Qn(qn.COMMON_BUSINESS);case 2:return new Qn(qn.COMMON_BUSINESS_TEXT);case 3:return new Qn(qn.COMMON_LARGE_TEXT);case 4:return new Qn(qn.COMMON_EFFECT);case 5:return new Qn(qn.COMMON_EFFECT2);case 6:return new Qn(qn.COMMON_HANKO);case 7:return new Qn(qn.COMMON_YUZU);case 8:return new Qn(qn.COMMON_YUZU2);case 9:return new Qn(qn.COMMON_YUZU3);default:return null}},Qn.fromTabId=function(e){var t=g.parseInt(e);if(null!=t)if(null==t){var n=Qn.fromCommonStampCategoryIndex(t-1);if(null!=n)return n}else{if(0==t)return Qn.getHistoryStampsetType();var i=Qn.fromCommonStampCategoryIndex(t-1);if(null!=i)return i}var r=R.makeFromIdStr(e);if(null!=r)return new Qn(qn.ORIGINAL(r));try{return new Qn(w.createEnum(qn,e))}catch(e){return Qn.getDefaultStampsetType()}},Qn.getHistoryStampsetType=function(){return new Qn(qn.HISTORY)},Qn.getDefaultStampsetType=function(){return new Qn(qn.COMMON_CIMMON)},Qn.prototype={toTabId:function(){var e=this.value;if(11==e[1]){var t=e[2];return"_"+t.high+"_"+t.low}return g.string(this.value)},toCategoryId:function(){var e=this.value;switch(e[1]){case 0:return null;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7;case 8:return 8;case 9:return 9;case 10:return 10;case 11:e[2];return null}},getStampsetId:function(){var e=this.value;return 11==e[1]?e[2]:null},isOriginalStampset:function(){var e=this.value;if(11==e[1]){e[2];return!0}return null},fallbackIfInvalid:function(e){return this.isValid(e)?this:Qn.getDefaultStampsetType()},isValid:function(e){var t=this.value;if(11==t[1]){var n=t[2];return null!=e&&null!=e.stampsetSetting&&e.stampsetSetting.containSendableStampset(n)}return!0},__class__:Qn};var Jn=function(e){null!=e&&(this.id=e.talk_id,this.domainId=e.domain_id,this.type=this.typeOf(e.type),this.name=e.talk_name,this.iconUrl=e.icon_url,this.userIds=e.user_ids,this.updatedAt=e.updated_at,this.leftUsers=this.getUsers(e.left_users),this.groupTalkSettings=this.getGroupTalkSetting(e.settings))};n["albero.entity.Talk"]=Jn,Jn.__name__=["albero","entity","Talk"],Jn.prototype={typeOf:function(e){switch(e){case 1:return Zn.PairTalk;case 2:return Zn.GroupTalk;default:return Zn.Unknown}},getUsers:function(e){return null==e?null:e.map(function(e){return new Ct(e)})},getGroupTalkSetting:function(e){return null==e?Za.None:Za.Some(new Xn(e))},isSystemMessageVisibled:function(){var e=P.map(this.groupTalkSettings,function(e){return e.systemMessageVisible});switch(e[1]){case 0:return e[2];case 1:return!0}},isAllowDisplayPastMessages:function(){var e=P.map(this.groupTalkSettings,function(e){return e.allowDisplayPastMessages});switch(e[1]){case 0:return e[2];case 1:return!1}},isMember:function(e){for(var t=0,n=this.userIds;t<n.length;){var i=n[t];if(++t,null!=e&&null!=i&&e.high==i.high&&e.low==i.low)return!0}return!1},__class__:Jn};var Xn=function(e){null!=e&&(this.allowDisplayPastMessages=!!e.allow_display_past_messages,this.systemMessageVisible=null==e.system_message_visible||e.system_message_visible)};n["albero.entity.GroupTalkSettings"]=Xn,Xn.__name__=["albero","entity","GroupTalkSettings"],Xn.createDefault=function(){var e=new Xn;return e.allowDisplayPastMessages=!0,e.systemMessageVisible=!0,e},Xn.prototype={__class__:Xn};var Zn=n["albero.entity.TalkType"]={__ename__:["albero","entity","TalkType"],__constructs__:["Unknown","PairTalk","GroupTalk"]};Zn.Unknown=["Unknown",0],Zn.Unknown.toString=i,Zn.Unknown.__enum__=Zn,Zn.PairTalk=["PairTalk",1],Zn.PairTalk.toString=i,Zn.PairTalk.__enum__=Zn,Zn.GroupTalk=["GroupTalk",2],Zn.GroupTalk.toString=i,Zn.GroupTalk.__enum__=Zn,Zn.__empty_constructs__=[Zn.Unknown,Zn.PairTalk,Zn.GroupTalk];var $n=n["albero.entity.TalkOrAnnouncements"]={__ename__:["albero","entity","TalkOrAnnouncements"],__constructs__:["talk","announcements"]};$n.talk=function(e){var t=["talk",0,e];return t.__enum__=$n,t.toString=i,t},$n.announcements=["announcements",1],$n.announcements.toString=i,$n.announcements.__enum__=$n,$n.__empty_constructs__=[$n.announcements];var ei=function(){};n["albero.entity.TalkOrAnnouncementsHelper"]=ei,ei.__name__=["albero","entity","TalkOrAnnouncementsHelper"],ei.getTalkId=function(e){switch(e[1]){case 0:var t=e[2];return Za.Some(t);case 1:return Za.None}};var ti=function(e,t){this.talk=e,this.status=t};n["albero.entity.TalkPack"]=ti,ti.__name__=["albero","entity","TalkPack"],ti.compareTalkOrderingTimestamp=function(e,t){var n=e.getTalkOrderingTimestamp(),i=t.getTalkOrderingTimestamp(),r=n.high-i.high|0;return r=0!=r?r:Ba.ucompare(n.low,i.low),n.high<0?i.high<0?r:-1:i.high>=0?r:1},ti.prototype={getTalkOrderingTimestamp:function(){return null!=this.status&&null!=this.status.talkOrderingTimestamp?this.status.talkOrderingTimestamp:this.talk.updatedAt},getTalkOrderInFavorites:function(){return null!=this.status?this.status.orderInFavorites:null},__class__:ti};var ni=function(e,t){this.paneType=e,this.talkSelection=t};n["albero.entity.TalkPaneSelection"]=ni,ni.__name__=["albero","entity","TalkPaneSelection"],ni.createArrayForMultiPanes=function(e){return l.mapi(e,function(e,t){return new ni(un.getMultiPaneType(e),t)})},ni.prototype={createUrls:function(e,t){switch(this.paneType[1]){case 0:return G.talks(e,z.single(this.talkSelection));case 1:var n=Ro(t,t.getTalkSelection),i=e,r=un.getMultiPaneTypes().map(function(e){return n(i,e)});return r[0]=this.talkSelection,G.talks(e,z.multi(r));case 2:var a=Ro(t,t.getTalkSelection),o=e,s=un.getMultiPaneTypes().map(function(e){return a(o,e)});return s[1]=this.talkSelection,G.talks(e,z.multi(s));case 3:var l=Ro(t,t.getTalkSelection),u=e,c=un.getMultiPaneTypes().map(function(e){return l(u,e)});return c[2]=this.talkSelection,G.talks(e,z.multi(c))}},getTalkIdOrNull:function(){return oi.getTalkIdOrNull(this.talkSelection)},__class__:ni};var ii=function(){};n["albero.entity.ITalkSelectionGetter"]=ii,ii.__name__=["albero","entity","ITalkSelectionGetter"],ii.prototype={__class__:ii};var ri=function(e,t){this.domainId=e.domain_id,this.talkId=e.talk_id,this.type=t?vn.fromRawValue(e.type):Sn.None,this.version=e.version};n["albero.entity.TalkPushNotificationEvent"]=ri,ri.__name__=["albero","entity","TalkPushNotificationEvent"],ri.prototype={__class__:ri};var ai=n["albero.entity.TalkSelection"]={__ename__:["albero","entity","TalkSelection"],__constructs__:["NotSelected","TalkSelected","AnnouncementsSelected"]};ai.NotSelected=["NotSelected",0],ai.NotSelected.toString=i,ai.NotSelected.__enum__=ai,ai.TalkSelected=function(e,t){var n=["TalkSelected",1,e,t];return n.__enum__=ai,n.toString=i,n},ai.AnnouncementsSelected=["AnnouncementsSelected",2],ai.AnnouncementsSelected.toString=i,ai.AnnouncementsSelected.__enum__=ai,ai.__empty_constructs__=[ai.NotSelected,ai.AnnouncementsSelected];var oi=function(){};n["albero.entity.TalkSelectionHelper"]=oi,oi.__name__=["albero","entity","TalkSelectionHelper"],oi.eqTalkSelection=function(e,t){var n;if(e[0]==t[0]){var i=oi.getTalkIdOrNull(e),r=oi.getTalkIdOrNull(t);n=null==i&&null==r||null!=i&&null!=r&&i.high==r.high&&i.low==r.low}else n=!1;if(n){var a=oi.getMessageIdOrNull(e),o=oi.getMessageIdOrNull(t);return null==a&&null==o||null!=a&&null!=o&&a.high==o.high&&a.low==o.low}return!1},oi.isSelected=function(e,t){switch(e[1]){case 0:return!1;case 1:e[3];var n=e[2],i=P.orNull(ei.getTalkId(t));return null!=n&&null!=i&&n.high==i.high&&n.low==i.low;case 2:return t==$n.announcements}},oi.getTalkIdOrNull=function(e){switch(e[1]){case 0:return null;case 1:return e[2];case 2:return null}},oi.getMessageIdOrNull=function(e){switch(e[1]){case 0:return null;case 1:var t=e[3];return P.orNull(t);case 2:return null}},oi.toTalkSelectionStr=function(e){switch(e[1]){case 0:return"";case 1:var t=e[2];return"_"+t.high+"_"+t.low;case 2:return"announcement"}};var si=function(e){this.unreadMentionCount=0,this.unreadCount=0,null!=e?(this.id=e.talk_id,this.unreadCount=null!=e.unread_count?e.unread_count:0,this.unreadMentionCount=null!=e.unread_mention_count?e.unread_mention_count:0,this.maxMessageId=e.max_message_id,null!=e.max_message?this.maxMessage=new Zt(e.max_message):this.maxMessage=null,this.maxReadMessageId=e.max_read_message_id,this.maxEveryoneReadMessageId=e.max_everyone_read_message_id,this.talkOrderingTimestamp=e.talk_ordering_timestamp,this.orderInFavorites=e.order_in_favorites,this.favoriteVersion=e.favorite_version,this.pushNotificationSetting=new gn(e.push_notification)):this.pushNotificationSetting=new gn};n["albero.entity.TalkStatus"]=si,si.__name__=["albero","entity","TalkStatus"],si.prototype={update:function(e){var t=this,n=!1;return this.needIdUpdate(this.maxEveryoneReadMessageId,e.maxEveryoneReadMessageId)&&(this.maxEveryoneReadMessageId=e.maxEveryoneReadMessageId,n=!0),P.foreach(e.maxReadMessageId,function(e){t.needIdUpdate(t.maxReadMessageId,e)&&(t.maxReadMessageId=e,n=!0)}),n},updateByMessageDeletion:function(e){var t=!1;return this.isUnread(e.messageId)&&(this.decrementUnreadCount(1),e.isMention&&this.decrementUnreadMentionCount(1),t=!0),this.isMax(e.messageId)&&(null!=this.maxMessage&&(this.maxMessage.type=$t.deleted),t=!0),t},updateByMessageReadStatusesUpdate:function(e){var t=e.messageIds,n=e.mentionMessageIds,i=t.filter(Ro(this,this.isUnread));if(0==i.length)return!1;for(var r=i[0],a=0;a<i.length;){var o=i[a];++a;var s=r.high-o.high|0;s=0!=s?s:Ba.ucompare(r.low,o.low),(r.high<0?o.high<0?s:-1:o.high>=0?s:1)<0&&(r=o),R.notContains(e.messageIdsExcludingUnreadCountTargets,o)&&(this.decrementUnreadCount(1),R.contains(n,o)&&this.decrementUnreadMentionCount(1))}return this.maxReadMessageId=r,!0},needIdUpdate:function(e,t){if(null!=t){if(null!=e){var n=e.high-t.high|0;return n=0!=n?n:Ba.ucompare(e.low,t.low),(e.high<0?t.high<0?n:-1:t.high>=0?n:1)<0}return!0}return!1},read:function(e,t,n){this.maxReadMessageId=e,this.decrementUnreadCount(t),this.decrementUnreadMentionCount(n)},decrementUnreadCount:function(e){this.unreadCount-=e,this.unreadCount<0&&(this.unreadCount=0)},decrementUnreadMentionCount:function(e){this.unreadMentionCount-=e,this.unreadMentionCount<0&&(this.unreadMentionCount=0)},readAll:function(){this.maxReadMessageId=this.maxMessageId,this.unreadCount=0,this.unreadMentionCount=0},updateByMessage:function(e,t){this.isNewMax(e.id)&&(this.maxMessageId=e.id,this.maxMessage=e),e.isUnreadCountTarget&&(t?this.isUnread(e.id)&&this.readAll():(this.unreadCount++,e.mention&&this.unreadMentionCount++),this.talkOrderingTimestamp=e.createdAt)},updateByReadingMessages:function(e,t){var n=this;if(null==e||this.canRegardTalkReadCountZero(e)){if(!li.isUnreadMesasgeExisted(this))return!1;if(null==this.maxMessageId)return!1;this.readAll()}else{var i=e.filter(function(e){return n.isUnread(e.id)});if(0==i.length)return!1;var r=i[i.length-1].id,a=i.filter(function(e){if(e.isUnreadCountTarget){var n=e.userId;return!(null!=n&&null!=t&&n.high==t.high&&n.low==t.low)}return!1}),o=a.filter(function(e){return e.mention});this.read(r,a.length,o.length)}return!0},updateByTalkPushNotificationEvent:function(e){return e.version>this.pushNotificationSetting.version&&(this.pushNotificationSetting=gn.createWithParams(e.type,e.version),!0)},canRegardTalkReadCountZero:function(e){var t=this.maxMessageId,n=P.orNull(U.lastOption(e.map(function(e){return e.id})));return null!=t&&null!=n&&t.high==n.high&&t.low==n.low},isMessageAcceptable:function(e,t){if(this.isUnread(e.id))return!0;var n=Kt.subTimestampPart(this.maxReadMessageId,e.id),i=n.high-t.high|0;return i=0!=i?i:Ba.ucompare(n.low,t.low),(n.high<0?t.high<0?i:-1:t.high>=0?i:1)<=0},isUnread:function(e){if(null!=this.maxReadMessageId){var t=this.maxReadMessageId,n=t.high-e.high|0;return n=0!=n?n:Ba.ucompare(t.low,e.low),(t.high<0?e.high<0?n:-1:e.high>=0?n:1)<0}return!0},isMax:function(e){if(null!=this.maxMessageId){var t=this.maxMessageId;return null!=t&&null!=e&&t.high==e.high&&t.low==e.low}return!1},isNewMax:function(e){if(null!=this.maxMessageId){var t=this.maxMessageId,n=t.high-e.high|0;return n=0!=n?n:Ba.ucompare(t.low,e.low),(t.high<0?e.high<0?n:-1:e.high>=0?n:1)<0}return!0},isNotificationDisabled:function(){return this.pushNotificationSetting.isDisabled()},getNotificationType:function(){return this.pushNotificationSetting.type},__class__:si};var li=function(){};n["albero.entity.TalkStatusHelper"]=li,li.__name__=["albero","entity","TalkStatusHelper"],li.isNotificationDisabled=function(e){return null!=e&&e.isNotificationDisabled()},li.isFavoriteTalk=function(e){return null!=e&&null!=e.orderInFavorites},li.isUnreadMesasgeExisted=function(e){return null!=e&&(null!=e.maxMessage&&e.isUnread(e.maxMessage.id))};var ui=function(e){null!=e&&(this.talkId=e.talk_id,this.maxEveryoneReadMessageId=e.max_everyone_read_message_id,this.maxReadMessageId=P.option(e.max_read_message_id))};n["albero.entity.TalkStatusUpdate"]=ui,ui.__name__=["albero","entity","TalkStatusUpdate"],ui.prototype={__class__:ui};var ci=function(e,t,n){this.file=e,this.dimension=_i.createWithSize(t,n),this.auth=null};n["albero.entity.ThumbInfo"]=ci,ci.__name__=["albero","entity","ThumbInfo"],ci.prototype={setAuth:function(e){this.auth=e},__class__:ci};var _i=function(e){null!=e&&(this.width=e.width,this.height=e.height)};n["albero.entity.ThumbDimension"]=_i,_i.__name__=["albero","entity","ThumbDimension"],_i.createWithSize=function(e,t){var n=new _i;return n.width=e,n.height=t,n},_i.prototype={toObject:function(){return{width:this.width,height:this.height}},__class__:_i};var hi=function(e,t,n){var i=new pi(0,0);this.domainId=i,this.domainId=e,this.oldSetting=t,this.newSetting=n};n["albero.entity.UpdateDomainStampSettingEvent"]=hi,hi.__name__=["albero","entity","UpdateDomainStampSettingEvent"],hi.prototype={isValid:function(){return this.newSetting.isNewerThan(this.oldSetting)},getStampsetIdsDiff:function(){return this.oldSetting.getStampsetIdsDiff(this.newSetting)},__class__:hi};var di=n["albero.entity.UploadUseType"]={__ename__:["albero","entity","UploadUseType"],__constructs__:["PROFILE_IMAGE","MESSAGE","TALK_ICON","THUMBNAIL","NOTE_ATTACHMENT","NOTE_THUMBNAIL","SCHEDULE_MESSAGE"]};di.PROFILE_IMAGE=["PROFILE_IMAGE",0],di.PROFILE_IMAGE.toString=i,di.PROFILE_IMAGE.__enum__=di,di.MESSAGE=["MESSAGE",1],di.MESSAGE.toString=i,di.MESSAGE.__enum__=di,di.TALK_ICON=["TALK_ICON",2],di.TALK_ICON.toString=i,di.TALK_ICON.__enum__=di,di.THUMBNAIL=["THUMBNAIL",3],di.THUMBNAIL.toString=i,di.THUMBNAIL.__enum__=di,di.NOTE_ATTACHMENT=["NOTE_ATTACHMENT",4],di.NOTE_ATTACHMENT.toString=i,di.NOTE_ATTACHMENT.__enum__=di,di.NOTE_THUMBNAIL=["NOTE_THUMBNAIL",5],di.NOTE_THUMBNAIL.toString=i,di.NOTE_THUMBNAIL.__enum__=di,di.SCHEDULE_MESSAGE=["SCHEDULE_MESSAGE",6],di.SCHEDULE_MESSAGE.toString=i,di.SCHEDULE_MESSAGE.__enum__=di,di.__empty_constructs__=[di.PROFILE_IMAGE,di.MESSAGE,di.TALK_ICON,di.THUMBNAIL,di.NOTE_ATTACHMENT,di.NOTE_THUMBNAIL,di.SCHEDULE_MESSAGE];var fi=function(){};n["albero.entity.UploadUseTypeHelper"]=fi,fi.__name__=["albero","entity","UploadUseTypeHelper"],fi.getUseTypeInt=function(e){switch(e[1]){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 4;case 4:return 5;case 5:return 6;case 6:return 1}};var mi=function(e){null!=e&&(null!=e.user_id&&(this.userId=e.user_id),null!=e.email&&(this.email=e.email),null!=e.sub_email&&(this.subEmail=e.sub_email),null!=e.group_alias&&(this.groupAlias=e.group_alias),null!=e.signin_id&&(this.signinId=e.signin_id))};n["albero.entity.UserIdentifier"]=mi,mi.__name__=["albero","entity","UserIdentifier"],mi.prototype={__class__:mi};var pi=function(e,t){this.high=e,this.low=t};n["haxe._Int64.___Int64"]=pi,pi.__name__=["haxe","_Int64","___Int64"],pi.prototype={__class__:pi};var gi=function(e,t){this.lastUpdatedAt=t,null!=e&&(this.userId=e.user_id,this.lastUsedAtOpt=P.option(e.last_used_at))};n["albero.entity.UserPresence"]=gi,gi.__name__=["albero","entity","UserPresence"],gi.createUserPresenceState=function(e,t){var n=t.high-e.high|0,i=t.low-e.low|0;if(Ba.ucompare(t.low,e.low)<0){n--;n|=0}var r=new pi(n,i),a=gi.SIXTY_MINUTES,o=r.high-a.high|0;if(o=0!=o?o:Ba.ucompare(r.low,a.low),(r.high<0?a.high<0?o:-1:a.high>=0?o:1)>0)return vi.GT_60;var s=gi.FIFTEEN_MINUTES,l=r.high-s.high|0;return l=0!=l?l:Ba.ucompare(r.low,s.low),(r.high<0?s.high<0?l:-1:s.high>=0?l:1)>0?vi.LT_OR_EQ_60:vi.LT_OR_EQ_15},gi.prototype={toState:function(e){var t=e,n=P.map(this.lastUsedAtOpt,function(e){return gi.createUserPresenceState(e,t)});switch(n[1]){case 0:return n[2];case 1:return vi.GT_60}},isExpired:function(e,t){var n=this.lastUpdatedAt,i=e.high-n.high|0,r=e.low-n.low|0;if(Ba.ucompare(e.low,n.low)<0){i--;i|=0}var a=new pi(i,r),o=a.high-t.high|0;return o=0!=o?o:Ba.ucompare(a.low,t.low),(a.high<0?t.high<0?o:-1:t.high>=0?o:1)>0},__class__:gi};var vi=n["albero.entity.UserPresenceState"]={__ename__:["albero","entity","UserPresenceState"],__constructs__:["LT_OR_EQ_15","LT_OR_EQ_60","GT_60"]};vi.LT_OR_EQ_15=["LT_OR_EQ_15",0],vi.LT_OR_EQ_15.toString=i,vi.LT_OR_EQ_15.__enum__=vi,vi.LT_OR_EQ_60=["LT_OR_EQ_60",1],vi.LT_OR_EQ_60.toString=i,vi.LT_OR_EQ_60.__enum__=vi,vi.GT_60=["GT_60",2],vi.GT_60.toString=i,vi.GT_60.__enum__=vi,vi.__empty_constructs__=[vi.LT_OR_EQ_15,vi.LT_OR_EQ_60,vi.GT_60];var Si=function(e){this.success=e};n["albero.entity.api.message.AddFavoriteMessageResult"]=Si,Si.__name__=["albero","entity","api","message","AddFavoriteMessageResult"],Si.prototype={__class__:Si};var yi=function(e){this.success=e};n["albero.entity.api.message.DeleteFavoriteMessageResult"]=yi,yi.__name__=["albero","entity","api","message","DeleteFavoriteMessageResult"],yi.prototype={__class__:yi};var wi=function(e,t,n,i,r){this.domainId=e,this.talkId=t,this.marker=n,this.nextMarker=i,this.messages=r};n["albero.entity.api.message.GetFavoriteMessagesResultWithParams"]=wi,wi.__name__=["albero","entity","api","message","GetFavoriteMessagesResultWithParams"],wi.prototype={getNextMarker:function(){return this.nextMarker},getMessages:function(){return this.messages},__class__:wi};var Ti=function(e,t,n){this.domainId=e,this.talkId=t,this.marker=n.marker,this.nextMarker=n.nextMarker,this.contents=null==n.contents?[]:ho.__cast(n.contents,Array).map(function(e){return new qi(e)})};n["albero.entity.api.message.GetScheduledMessagesResultWithParams"]=Ti,Ti.__name__=["albero","entity","api","message","GetScheduledMessagesResultWithParams"],Ti.prototype={__class__:Ti};var Ii=function(e,t){var n=this;l.iter(t,function(t){var i=new Ei(t),r=i.createdAt,a=e.high-r.high|0;a=0!=a?a:Ba.ucompare(e.low,r.low),(e.high<0?r.high<0?a:-1:r.high>=0?a:1)<0?n.messageCreatedAtNew=i:n.messageCreatedAtOld=i})};n["albero.entity.api.message.SearchMessagesAroundDateTimeResult"]=Ii,Ii.__name__=["albero","entity","api","message","SearchMessagesAroundDateTimeResult"],Ii.prototype={__class__:Ii};var Ei=function(e){this.messageId=e.message_id,this.createdAt=e.created_at};n["albero.entity.api.message.MessageCreatedAt"]=Ei,Ei.__name__=["albero","entity","api","message","MessageCreatedAt"],Ei.prototype={__class__:Ei};var Ni=function(e,t,n){this.callerId=e,this.error=t,this.emitterKey=n};n["albero.entity.api.note.CreateNoteError"]=Ni,Ni.__name__=["albero","entity","api","note","CreateNoteError"],Ni.prototype={__class__:Ni};var Ai=function(e){this.note=new Ji(e),this.emitterKey=null};n["albero.entity.api.note.CreateNoteResult"]=Ai,Ai.__name__=["albero","entity","api","note","CreateNoteResult"],Ai.prototype={updateWithEmitterKey:function(e){var t=new Ai;return t.note=this.note,t.emitterKey=e,t},__class__:Ai};var bi=function(e){this.result=e};n["albero.entity.api.note.DeleteNoteResult"]=bi,bi.__name__=["albero","entity","api","note","DeleteNoteResult"],bi.prototype={__class__:bi};var Di=function(e){this.note=new Ji(e)};n["albero.entity.api.note.GetNoteResult"]=Di,Di.__name__=["albero","entity","api","note","GetNoteResult"],Di.prototype={getNoteId:function(){return this.note.noteId},getNoteCreateUserId:function(){return this.note.createdBy},getRevisionCreateUserId:function(){return this.note.getRevisionCreateUserId()},getNoteCreateDate:function(){return this.note.createdAt},getRevisionCreateDate:function(){return this.note.getRevisionCreateDate()},getLockedUserIdWithoutSelf:function(e){return this.note.getLockedUserIdWithoutSelf(e)},__class__:Di};var Mi=function(e){null!=e&&(this.marker=e.marker,this.nextMarker=e.next_marker,this.noteStatuses=U.asArray(e.contents).map(function(e){return new hr(e)}))};n["albero.entity.api.note.GetNoteStatusesResult"]=Mi,Mi.__name__=["albero","entity","api","note","GetNoteStatusesResult"],Mi.prototype={isNotEmptyNoteStatuses:function(){return this.noteStatuses.length>0},__class__:Mi};var Ci=function(e){this.note=new Ji(e)};n["albero.entity.api.note.UpdateNoteResult"]=Ci,Ci.__name__=["albero","entity","api","note","UpdateNoteResult"],Ci.prototype={__class__:Ci};var ki=function(e){this.note=new Ji(e)};n["albero.entity.api.note.UpdateNoteSettingResult"]=ki,ki.__name__=["albero","entity","api","note","UpdateNoteSettingResult"],ki.prototype={__class__:ki};var Oi=function(){};n["albero.entity.file.DummyFileUtil"]=Oi,Oi.__name__=["albero","entity","file","DummyFileUtil"],Oi.getBlobFromUpdatableFile=function(e){return null==e.blob?e:e.blob};var Ri=function(e){null!=e&&(this.fileId=e.file_id,this.status=e.status,this.filePreviewFileId=e.file_preview_file_id,this.url=e.url,this.key=e.key)};n["albero.entity.file.FilePreview"]=Ri,Ri.__name__=["albero","entity","file","FilePreview"],Ri.prototype={__class__:Ri};var Fi=function(){};n["albero.entity.file.StageType"]=Fi,Fi.__name__=["albero","entity","file","StageType"],Fi.prototype={__class__:Fi};var Ui=function(e,t){this.talkId=e,this.paneType=t};n["albero.entity.file.StageTypeTalk"]=Ui,Ui.__name__=["albero","entity","file","StageTypeTalk"],Ui.__interfaces__=[Fi],Ui.prototype={toString:function(){var e=this.talkId;return"staged__"+e.high+"_"+e.low+un.toPanePrefix(this.paneType)},isForPane:function(e){return this.paneType==e},isForNote:function(){return!1},isForPreview:function(){return!1},__class__:Ui};var xi=function(){};n["albero.entity.file.StageTypeNote"]=xi,xi.__name__=["albero","entity","file","StageTypeNote"],xi.__interfaces__=[Fi],xi.prototype={toString:function(){return"staged_note_"},isForPane:function(e){return!1},isForNote:function(){return!0},isForPreview:function(){return!1},__class__:xi};var Pi=function(){};n["albero.entity.message.IFavoriteMessageEvent"]=Pi,Pi.__name__=["albero","entity","message","IFavoriteMessageEvent"],Pi.prototype={__class__:Pi};var Li=function(e){this.message=new Zt(e.message),this.domainId=e.domain_id,this.talkId=e.talk_id};n["albero.entity.message.AddFavoriteMessageEvent"]=Li,Li.__name__=["albero","entity","message","AddFavoriteMessageEvent"],Li.__interfaces__=[Pi],Li.prototype={getMessage:function(){return this.message},getMessageId:function(){return this.message.id},isFavorite:function(){return!0},getDomainId:function(){return this.domainId},getTalkId:function(){return this.talkId},__class__:Li};var Bi=function(e){this.messageId=e.message_id,this.domainId=e.domain_id,this.talkId=e.talk_id};n["albero.entity.message.DeleteFavoriteMessageEvent"]=Bi,Bi.__name__=["albero","entity","message","DeleteFavoriteMessageEvent"],Bi.__interfaces__=[Pi],Bi.prototype={getMessageId:function(){return this.messageId},getTalkId:function(){return this.talkId},getDomainId:function(){return this.domainId},isFavorite:function(){return!1},__class__:Bi};var Gi=function(){};n["albero.entity.message.IMessageContentForActionReply"]=Gi,Gi.__name__=["albero","entity","message","IMessageContentForActionReply"],Gi.prototype={__class__:Gi};var Hi=function(e){null!=e&&(this.noteId=new $i(e.note_id),this.title=e.title,this.revision=e.revision,this.deleted=e.deleted,this.hasAttachments=!!e.has_attachments)};n["albero.entity.message.MessageContentForNote"]=Hi,Hi.__name__=["albero","entity","message","MessageContentForNote"],Hi.prototype={__class__:Hi};var zi=function(e){null!=e&&(this.noteId=new $i(e.note_id),this.title=e.title)};n["albero.entity.message.MessageContentForNoteDeleted"]=zi,zi.__name__=["albero","entity","message","MessageContentForNoteDeleted"],zi.prototype={__class__:zi};var Yi=function(e){this.text=Za.None,this.stampsetId=R.fromIntOrInt64(e.stampset_id),this.stampId=R.fromIntOrInt64(e.stamp_id),null!=e.text&&(this.text=Za.Some(e.text))};n["albero.entity.message.MessageContentForOriginalStamp"]=Yi,Yi.__name__=["albero","entity","message","MessageContentForOriginalStamp"],Yi.prototype={hasValidText:function(){return P.isDefined(this.getValidText())},getValidText:function(){return P.filter(this.text,B.isNotEmpty)},__class__:Yi};var Ki=function(e){this.inReplyTo=e.in_reply_to,this.response=e.response,this.options=e.options,this.listing=null==e.listing||e.listing,this.closingType=null==e.closing_type?1:e.closing_type,this.closed=null!=e.closed&&e.closed};n["albero.entity.message.MessageContentForSelectOneReply"]=Ki,Ki.__name__=["albero","entity","message","MessageContentForSelectOneReply"],Ki.__interfaces__=[Gi],Ki.prototype={getResponseIndex:function(){return this.response},__class__:Ki};var Wi=function(e){this.inReplyTo=e.in_reply_to,this.title=e.title,this.listing=null==e.listing||e.listing,this.closingType=null==e.closing_type?1:e.closing_type,this.done=e.done,this.closed=null!=e.closed&&e.closed};n["albero.entity.message.MessageContentForTodoReply"]=Wi,Wi.__name__=["albero","entity","message","MessageContentForTodoReply"],Wi.__interfaces__=[Gi],Wi.prototype={getResponseIndex:function(){return this.done?0:1},__class__:Wi};var ji=function(e){this.inReplyTo=e.in_reply_to,this.response=e.response,this.question=e.question,this.listing=null==e.listing||e.listing,this.closingType=null==e.closing_type?1:e.closing_type,this.closed=null!=e.closed&&e.closed};n["albero.entity.message.MessageContentForYesNoReply"]=ji,ji.__name__=["albero","entity","message","MessageContentForYesNoReply"],ji.__interfaces__=[Gi],ji.prototype={getResponseIndex:function(){return this.response?0:1},__class__:ji};var Vi=function(e){if(null==e)return this.favorite=!1,this.createdAt=null,void(this.tags=[]);this.favorite=!0,this.createdAt=e.created_at,this.tags=e.tags};n["albero.entity.message.MessageFavorite"]=Vi,Vi.__name__=["albero","entity","message","MessageFavorite"],Vi.prototype={isFavorite:function(){return this.favorite},update:function(e){this.favorite=e.isFavorite()},__class__:Vi};var qi=function(e){this.isDummy=!1,null!=e&&(this.id=e.scheduled_message_id,this.createMessageAt=e.create_message_at,this.talkId=e.talk_id,this.type=Zt.typeOf(e.type),this.content=e.content)};n["albero.entity.message.ScheduledMessage"]=qi,qi.__name__=["albero","entity","message","ScheduledMessage"],qi.fromParams=function(e){var t=new qi(null);return t.id=e.id,t.createMessageAt=e.createMessageAt,t.talkId=e.talkId,t.type=e.type,t.content=e.content,t},qi.fromNotifyScheduleMessage=function(e){var t=new qi(null);return t.id=e.id,t.talkId=e.talkId,t.createMessageAt=M.oneDayAfterAsInt64(),t.type=$t.text,t.content="",t.isDummy=!0,t},qi.compare=function(e,t){var n=e.createMessageAt,i=t.createMessageAt,r=n.high-i.high|0;r=0!=r?r:Ba.ucompare(n.low,i.low);var a=n.high<0?i.high<0?r:-1:i.high>=0?r:1;if(0!=a)return a;var o=e.id,s=t.id,l=o.high-s.high|0;return l=0!=l?l:Ba.ucompare(o.low,s.low),o.high<0?s.high<0?l:-1:s.high>=0?l:1},qi.prototype={__class__:qi};var Qi=function(){this.scheduledMessages=new eo};n["albero.entity.message.ScheduledMessageStore"]=Qi,Qi.__name__=["albero","entity","message","ScheduledMessageStore"],Qi.prototype={getScheduledMessage:function(e){if(null==e)return null;var t="_"+e.high+"_"+e.low,n=this.scheduledMessages;return null!=Jo[t]?n.getReserved(t):n.h[t]},getScheduledMessages:function(){return l.array(this.scheduledMessages)},setScheduledMessage:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.scheduledMessages;null!=Jo[n]?i.setReserved(n,e):i.h[n]=e},removeScheduledMessage:function(e){var t="_"+e.high+"_"+e.low,n=this.scheduledMessages,i=null!=Jo[t]?n.getReserved(t):n.h[t];return this.scheduledMessages.remove(t),i},__class__:Qi};var Ji=function(e){null!=e&&(this.noteId=new $i(e.note_id),this.talkId=e.talk_id,this.createdBy=e.created_by,this.createdAt=e.created_at,this.setting=new _r(e.setting),this.noteRevision=new ur(e.note_revision),this.noteLocked=new or(e.locked))};n["albero.entity.note.Note"]=Ji,Ji.__name__=["albero","entity","note","Note"],Ji.prototype={isSameNoteId:function(e){return this.noteId.equals(e)},getRevisionCreateUserId:function(){return this.noteRevision.createdBy},getRevisionCreateDate:function(){return this.noteRevision.createdAt},compareRevision:function(e){return this.noteRevision.compareRevision(e)},lock:function(e,t,n,i){this.noteRevision.revision==e&&this.noteLocked.lock(t,n,i)},unlock:function(e,t){this.noteRevision.revision==e&&this.noteLocked.unlock(t)},getLockedUserIdWithoutSelf:function(e){return this.noteLocked.getLockedUserIdWithoutSelf(e)},isSameTalkId:function(e){var t=this.talkId;return null!=t&&null!=e&&t.high==e.high&&t.low==e.low},__class__:Ji};var Xi=n["albero.entity.note.NoteContentType"]={__ename__:["albero","entity","note","NoteContentType"],__constructs__:["TEXT","FILES"]};Xi.TEXT=["TEXT",0],Xi.TEXT.toString=i,Xi.TEXT.__enum__=Xi,Xi.FILES=["FILES",1],Xi.FILES.toString=i,Xi.FILES.__enum__=Xi,Xi.__empty_constructs__=[Xi.TEXT,Xi.FILES];var Zi=function(){};n["albero.entity.note.NoteContentTypeHelper"]=Zi,Zi.__name__=["albero","entity","note","NoteContentTypeHelper"],Zi.createNoteContentType=function(e){if(null==e)return Ar._e("["+s.dateStr(new Date)+"] ","no value.","","","",""),null;switch(e){case 1:return Xi.TEXT;case 5:return Xi.FILES;default:return Ar._e("["+s.dateStr(new Date)+"] ","value is not expected.","","","",""),null}},Zi.getValue=function(e){if(null==e)return Ar._e("["+s.dateStr(new Date)+"] ","no content type.","","","",""),null;switch(e[1]){case 0:return 1;case 1:return 5}};var $i=function(e){this.value=e};n["albero.entity.note.NoteId"]=$i,$i.__name__=["albero","entity","note","NoteId"],$i.__interfaces__=[Wt],$i.createDummyId=function(){var e,t=$i.nextDummyId,n=$i.nextDummyId;if(null==n)e=null;else{var i=new pi(0,1),r=n.high-i.high|0,a=n.low-i.low|0;if(Ba.ucompare(n.low,i.low)<0){r--;r|=0}e=new pi(r,a)}return $i.nextDummyId=e,new $i(t)},$i.prototype={toString:function(){var e=this.value;return"_"+e.high+"_"+e.low},equals:function(e){if(null==e)return!1;var t=this.value,n=e.value;return null!=t&&null!=n&&t.high==n.high&&t.low==n.low},getHtmlAttributeId:function(){return"note-"+this.toString()},isDummy:function(){return this.value.high<0},__class__:$i};var er=function(e,t,n,i,r,a,o){this.state=tr.SENDING,this.talkId=e,this.noteId=t,this.title=n,this.text=i,this.fileInfos=r,this.emitterKey=a,this.createMessage=null==o||o};n["albero.entity.note.NoteLocalEdit"]=er,er.__name__=["albero","entity","note","NoteLocalEdit"],er.prototype={hasEmitterKey:function(){return null!=this.emitterKey},getEmitterKey:function(){return this.emitterKey},setState:function(e){this.state=e},getTalkId:function(){return this.talkId},getNoteId:function(){return this.noteId},getTitle:function(){return this.title},getText:function(){return this.text},getContent:function(){switch(this.getContentType()[1]){case 0:return this.text;case 1:return{files:this.getUploadedFilesData(),text:null==this.text?"":this.text}}},getFileInfos:function(){return this.fileInfos},getState:function(){return this.state},isSending:function(){return this.state==tr.SENDING},isFailed:function(){switch(this.state[1]){case 0:case 6:return!1;case 1:case 2:case 3:case 4:case 5:return!0}},isForCreate:function(){return this.noteId.isDummy()},canNotSend:function(){return 0!=this.getUnuploadedFileInfos().length},getContentType:function(){return this.fileInfos.length>0?Xi.FILES:Xi.TEXT},getUnuploadedFileInfos:function(){return this.fileInfos.filter(function(e){return e.isNotUploaded()})},getUploadedFilesData:function(){return this.fileInfos.map(function(e){return e.getUploadedFileData()}).filter(function(e){return null!=e})},createNoteRevisionSummary:function(e){var t=new cr;return t.revision=0,t.contentType=this.getContentType(),t.title=this.title,t.contentSummary=this.text,t.createdBy=e,t.createdAt=M.nowAsInt64(),t.contentFiles=this.fileInfos,t},conflict:function(){this.state=tr.FAILED_BY_CONFLICT},deleted:function(){this.state=tr.FAILED_BY_NOT_FOUND},getCreateMessage:function(){return this.createMessage},__class__:er};var tr=n["albero.entity.note.NoteLocalEditState"]={__ename__:["albero","entity","note","NoteLocalEditState"],__constructs__:["SENDING","FAILED_BY_CONFLICT","FAILED_BY_NOT_FOUND","FAILED_BY_NOT_FOUND_FORWARDING","FAILED_BY_FILE","FAILED_BY_UNKNOWN","COMPLETED"]};tr.SENDING=["SENDING",0],tr.SENDING.toString=i,tr.SENDING.__enum__=tr,tr.FAILED_BY_CONFLICT=["FAILED_BY_CONFLICT",1],tr.FAILED_BY_CONFLICT.toString=i,tr.FAILED_BY_CONFLICT.__enum__=tr,tr.FAILED_BY_NOT_FOUND=["FAILED_BY_NOT_FOUND",2],tr.FAILED_BY_NOT_FOUND.toString=i,tr.FAILED_BY_NOT_FOUND.__enum__=tr,tr.FAILED_BY_NOT_FOUND_FORWARDING=["FAILED_BY_NOT_FOUND_FORWARDING",3],tr.FAILED_BY_NOT_FOUND_FORWARDING.toString=i,tr.FAILED_BY_NOT_FOUND_FORWARDING.__enum__=tr,tr.FAILED_BY_FILE=function(e,t){var n=["FAILED_BY_FILE",4,e,t];return n.__enum__=tr,n.toString=i,n},tr.FAILED_BY_UNKNOWN=["FAILED_BY_UNKNOWN",5],tr.FAILED_BY_UNKNOWN.toString=i,tr.FAILED_BY_UNKNOWN.__enum__=tr,tr.COMPLETED=["COMPLETED",6],tr.COMPLETED.toString=i,tr.COMPLETED.__enum__=tr,tr.__empty_constructs__=[tr.SENDING,tr.FAILED_BY_CONFLICT,tr.FAILED_BY_NOT_FOUND,tr.FAILED_BY_NOT_FOUND_FORWARDING,tr.FAILED_BY_UNKNOWN,tr.COMPLETED];var nr=function(e){null!=e&&(this.noteId=new $i(e.note_id),this.revision=e.revision,this.userId=e.user_id,this.deviceId=e.device_id,this.expiredAt=e.expired_at)};n["albero.entity.note.NoteLockEvent"]=nr,nr.__name__=["albero","entity","note","NoteLockEvent"],nr.prototype={__class__:nr};var ir=function(e){this.value=e};n["albero.entity.note.NoteLockExpiredAt"]=ir,ir.__name__=["albero","entity","note","NoteLockExpiredAt"],ir.prototype={fromNow:function(){var e=this.value,t=e.high,n=e.low;return 4294967296*t+(n>=0?n:n+4294967296)-(new Date).getTime()|0},calcRelockDelay:function(){return.9*this.fromNow()|0},__class__:ir};var rr=n["albero.entity.note.NoteLockStateValue"]={__ename__:["albero","entity","note","NoteLockStateValue"],__constructs__:["FAILED_BY_CONFLICT","FAILED_BY_LOCKED","FAILED_BY_NOT_FOUND","FAILED_BY_UNKNOWN","COMPLETED","RELEASED"]};rr.FAILED_BY_CONFLICT=["FAILED_BY_CONFLICT",0],rr.FAILED_BY_CONFLICT.toString=i,rr.FAILED_BY_CONFLICT.__enum__=rr,rr.FAILED_BY_LOCKED=function(e){var t=["FAILED_BY_LOCKED",1,e];return t.__enum__=rr,t.toString=i,t},rr.FAILED_BY_NOT_FOUND=["FAILED_BY_NOT_FOUND",2],rr.FAILED_BY_NOT_FOUND.toString=i,rr.FAILED_BY_NOT_FOUND.__enum__=rr,rr.FAILED_BY_UNKNOWN=["FAILED_BY_UNKNOWN",3],rr.FAILED_BY_UNKNOWN.toString=i,rr.FAILED_BY_UNKNOWN.__enum__=rr,rr.COMPLETED=function(e){var t=["COMPLETED",4,e];return t.__enum__=rr,t.toString=i,t},rr.RELEASED=["RELEASED",5],rr.RELEASED.toString=i,rr.RELEASED.__enum__=rr,rr.__empty_constructs__=[rr.FAILED_BY_CONFLICT,rr.FAILED_BY_NOT_FOUND,rr.FAILED_BY_UNKNOWN,rr.RELEASED];var ar=function(e){this.value=e};n["albero.entity.note.NoteLockState"]=ar,ar.__name__=["albero","entity","note","NoteLockState"],ar.prototype={isCompleted:function(){return 4==this.value[1]},getExpiredAtOrNull:function(){var e=this.value;return 4==e[1]?e[2]:null},isLockedByOther:function(){return 1==this.value[1]},getLockedUser:function(){var e=this.value;return 1==e[1]?e[2]:null},__class__:ar};var or=function(e){null!=e&&(this.userId=e.user_id,this.deviceId=e.device_id,this.expiredAt=e.expired_at)};n["albero.entity.note.NoteLocked"]=or,or.__name__=["albero","entity","note","NoteLocked"],or.prototype={lock:function(e,t,n){this.expiredAt=n,this.deviceId=t,this.userId=e},unlock:function(e){var t=this.userId;null!=t&&null!=e&&t.high==e.high&&t.low==e.low&&(this.expiredAt=null,this.userId=null,this.deviceId=null)},getLockedUserIdWithoutSelf:function(e){var t,n=this.deviceId;if(null!=n&&null!=e&&n.high==e.high&&n.low==e.low)return null;if(null!=this.expiredAt){var i=this.expiredAt,r=i.high,a=i.low;t=4294967296*r+(a>=0?a:a+4294967296)<=(new Date).getTime()}else t=!0;return t?null:this.userId},__class__:or};var sr=function(e){null!=e&&(this.noteId=new $i(e.note_id),this.talkId=e.talk_id,this.setting=new _r(e.setting))};n["albero.entity.note.NotePartialUpdateForSetting"]=sr,sr.__name__=["albero","entity","note","NotePartialUpdateForSetting"],sr.prototype={__class__:sr};var lr=function(e){null!=e&&(this.noteId=new $i(e.note_id),this.talkId=e.talk_id,this.noteRevisionSummary=new cr(e.note_revision_summary))};n["albero.entity.note.NotePartialUpdateForSummary"]=lr,lr.__name__=["albero","entity","note","NotePartialUpdateForSummary"],lr.prototype={getRevision:function(){return this.noteRevisionSummary.revision},getUpdatedBy:function(){return this.noteRevisionSummary.createdBy},getUpdatedAt:function(){return this.noteRevisionSummary.createdAt},__class__:lr};var ur=function(e){if(this.contentFiles=[],null!=e){switch(this.revision=e.revision,this.title=e.title,this.contentType=Zi.createNoteContentType(e.content_type),this.contentType[1]){case 0:this.contentText=e.content;break;case 1:if(this.contentText=null==e.content.text?"":e.content.text,null!=e.content.files)for(var t=0,n=ho.__cast(e.content.files,Array);t<n.length;){var i=n[t];++t,this.contentFiles.push(new xt(i))}}this.createdBy=e.created_by,this.createdAt=e.created_at}};n["albero.entity.note.NoteRevision"]=ur,ur.__name__=["albero","entity","note","NoteRevision"],ur.prototype={isEmptyTitle:function(){return""==this.title||null==this.title},compareRevision:function(e){return this.revision==e?0:this.revision<e?-1:1},__class__:ur};var cr=function(e){if(null!=e&&(this.revision=e.revision,this.title=e.title,this.contentType=Zi.createNoteContentType(e.content_type),this.contentSummary=e.content_summary,this.createdBy=e.created_by,this.createdAt=e.created_at,this.contentFiles=[],null!=e.content_files))for(var t=0,n=ho.__cast(e.content_files,Array);t<n.length;){var i=n[t];++t,this.contentFiles.push(new xt(i))}};n["albero.entity.note.NoteRevisionSummary"]=cr,cr.__name__=["albero","entity","note","NoteRevisionSummary"],cr.prototype={isEmptyTitle:function(){return""==this.title||null==this.title},compareRevision:function(e){return this.revision==e?0:this.revision<e?-1:1},getContentSummaryWithEllipsis:function(){var e=S.replace(S.replace(this.contentSummary,"- [x] ",""),"- [ ] ","");return e.length<100?e:e.substring(0,99)+""},__class__:cr};var _r=function(e){null!=e&&(this.collaborativeEditing=e.collaborative_editing,this.version=e.version)};n["albero.entity.note.NoteSetting"]=_r,_r.__name__=["albero","entity","note","NoteSetting"],_r.prototype={__class__:_r};var hr=function(e){null!=e&&(this.noteId=new $i(e.note_id),this.noteSummary=new dr(e.note_summary),this.commentIds=e.comment_ids,this.readUserIds=e.read_user_ids)};n["albero.entity.note.NoteStatus"]=hr,hr.__name__=["albero","entity","note","NoteStatus"],hr.prototype={getNoteRevisionSummary:function(){return this.noteSummary.noteRevisionSummary},__class__:hr};var dr=function(e){null!=e&&(this.noteId=new $i(e.note_id),this.talkId=e.talk_id,this.createdBy=e.created_by,this.createdAt=e.created_at,this.setting=new _r(e.setting),this.noteRevisionSummary=new cr(e.note_revision_summary),this.noteLocked=new or(e.locked))};n["albero.entity.note.NoteSummary"]=dr,dr.__name__=["albero","entity","note","NoteSummary"],dr.prototype={getNoteIdByString:function(){return this.noteId.toString()},getRevisionCreatedAt:function(){return this.noteRevisionSummary.createdAt},getRevisionContentSummary:function(){return this.noteRevisionSummary.contentSummary},getRevisionTitle:function(){return this.noteRevisionSummary.isEmptyTitle()?"":this.noteRevisionSummary.title},lock:function(e,t,n,i){this.noteRevisionSummary.revision==e&&this.noteLocked.lock(t,n,i)},unlock:function(e,t){this.noteRevisionSummary.revision==e&&this.noteLocked.unlock(t)},__class__:dr};var fr=function(){};n["albero.entity.note.NoteTextParts"]=fr,fr.__name__=["albero","entity","note","NoteTextParts"],fr.isUncheckedCheckBox=function(e){return S.startsWith(e,"- [ ] ")},fr.isCheckedCheckBox=function(e){return!!S.startsWith(e,"- [x] ")||S.startsWith(e,"- [x] ".toUpperCase())};var mr=function(e){null!=e&&(this.noteId=new $i(e.note_id),this.revision=e.revision,this.userId=e.user_id)};n["albero.entity.note.NoteUnlockEvent"]=mr,mr.__name__=["albero","entity","note","NoteUnlockEvent"],mr.prototype={__class__:mr};var pr=function(e){this.id=R.fromIntOrInt64(e.id),this.order=e.order,this.imageUrl=e.imageUrl,this.type=pr.getReactionTypeFromReactionId(this.id)};n["albero.entity.reaction.AvailableMessageReaction"]=pr,pr.__name__=["albero","entity","reaction","AvailableMessageReaction"],pr.compare=function(e,t){return e.order-t.order},pr.getReactionTypeFromReactionId=function(e){var t=new pi(0,1);if(null!=e&&null!=t&&e.high==t.high&&e.low==t.low)return gr.ThumbsUp;var n=new pi(0,2);if(null!=e&&null!=n&&e.high==n.high&&e.low==n.low)return gr.Heart;var i=new pi(0,3);if(null!=e&&null!=i&&e.high==i.high&&e.low==i.low)return gr.PartyPoper;var r=new pi(0,4);if(null!=e&&null!=r&&e.high==r.high&&e.low==r.low)return gr.Eyes;var a=new pi(0,5);if(null!=e&&null!=a&&e.high==a.high&&e.low==a.low)return gr.Thank;var o=new pi(0,6);return null!=e&&null!=o&&e.high==o.high&&e.low==o.low?gr.Weep:gr.Custom(e)},pr.getReactionIdFromReactionType=function(e){switch(e[1]){case 0:return new pi(0,2);case 1:return new pi(0,1);case 2:return new pi(0,3);case 3:return new pi(0,5);case 4:return new pi(0,6);case 5:return new pi(0,4);case 6:return e[2]}},pr.prototype={__class__:pr};var gr=n["albero.entity.reaction.ReactionType"]={__ename__:["albero","entity","reaction","ReactionType"],__constructs__:["Heart","ThumbsUp","PartyPoper","Thank","Weep","Eyes","Custom"]};gr.Heart=["Heart",0],gr.Heart.toString=i,gr.Heart.__enum__=gr,gr.ThumbsUp=["ThumbsUp",1],gr.ThumbsUp.toString=i,gr.ThumbsUp.__enum__=gr,gr.PartyPoper=["PartyPoper",2],gr.PartyPoper.toString=i,gr.PartyPoper.__enum__=gr,gr.Thank=["Thank",3],gr.Thank.toString=i,gr.Thank.__enum__=gr,gr.Weep=["Weep",4],gr.Weep.toString=i,gr.Weep.__enum__=gr,gr.Eyes=["Eyes",5],gr.Eyes.toString=i,gr.Eyes.__enum__=gr,gr.Custom=function(e){var t=["Custom",6,e];return t.__enum__=gr,t.toString=i,t},gr.__empty_constructs__=[gr.Heart,gr.ThumbsUp,gr.PartyPoper,gr.Thank,gr.Weep,gr.Eyes];var vr=function(){this.availableMessageReactionsMap=new eo,this.summaries=new eo,this.usersMap=new eo,this.loadingMap=new eo};n["albero.entity.reaction.MessageReactionStore"]=vr,vr.__name__=["albero","entity","reaction","MessageReactionStore"],vr.prototype={updateAvailableMessageReactions:function(e,t){t.sort(pr.compare);var n="_"+e.high+"_"+e.low,i=this.availableMessageReactionsMap;null!=Jo[n]?i.setReserved(n,t):i.h[n]=t},getAvailableMessageReactions:function(e){var t="_"+e.high+"_"+e.low,n=this.availableMessageReactionsMap,i=null!=Jo[t]?n.getReserved(t):n.h[t];return null==i?[]:i},isAvailableMessageReactionsLoaded:function(e){var t="_"+e.high+"_"+e.low,n=this.availableMessageReactionsMap;return null!=Jo[t]?n.existsReserved(t):n.h.hasOwnProperty(t)},setMessageReactionSummary:function(e){var t=e.messageId,n="_"+t.high+"_"+t.low,i=this.summaries;null!=Jo[n]?i.setReserved(n,e):i.h[n]=e},removeMessageReactionSummary:function(e){this.summaries.remove("_"+e.high+"_"+e.low)},getMessageReactionSummary:function(e){var t="_"+e.high+"_"+e.low,n=this.summaries;return null!=Jo[t]?n.getReserved(t):n.h[t]},setMessageReactionUsers:function(e){var t=e.messageId,n="_"+t.high+"_"+t.low,i=this.usersMap;null!=Jo[n]?i.setReserved(n,e):i.h[n]=e},removeMessageReactionUsers:function(e){this.usersMap.remove("_"+e.high+"_"+e.low)},getMessageReactionUsers:function(e){var t="_"+e.high+"_"+e.low,n=this.usersMap;return null!=Jo[t]?n.getReserved(t):n.h[t]},addLoadingMessageReactionSmmary:function(e){var t="_"+e.high+"_"+e.low,n=this.loadingMap;null!=Jo[t]?n.setReserved(t,!0):n.h[t]=!0},removeLoadingMessageReactionSmmary:function(e){this.loadingMap.remove("_"+e.high+"_"+e.low)},isLoadingMessageReactionSmmary:function(e){var t="_"+e.high+"_"+e.low,n=this.loadingMap;return null!=Jo[t]?n.existsReserved(t):n.h.hasOwnProperty(t)},__class__:vr};var Sr=function(e){this.reactionCounts=new eo;var t=this;null!=e&&(this.messageId=e.message_id,this.myReactionId=R.fromIntOrInt64(e.my_reaction_id),l.iter(p.fields(e.reaction_counts),function(n){var i=t.reactionCounts,r=p.field(e.reaction_counts,n),a=i;null!=Jo[n]?a.setReserved(n,r):a.h[n]=r}))};n["albero.entity.reaction.MessageReactionSummary"]=Sr,Sr.__name__=["albero","entity","reaction","MessageReactionSummary"],Sr.prototype={getReactionCount:function(e){var t=this.reactionCounts,n=Ga.toString(e),i=t,r=null!=Jo[n]?i.getReserved(n):i.h[n];return null==r?0:r},setReactionCount:function(e,t){var n=this.reactionCounts,i=Ga.toString(e),r=n;null!=Jo[i]?r.setReserved(i,t):r.h[i]=t},updateMyReaction:function(e){null!=this.myReactionId&&this.setReactionCount(this.myReactionId,this.getReactionCount(this.myReactionId)-1),null!=e&&this.setReactionCount(e,this.getReactionCount(e)+1),this.myReactionId=e},isMyReactionId:function(e){var t=this.myReactionId;return null!=e&&null!=t&&e.high==t.high&&e.low==t.low},hasMyReaction:function(){return null!=this.myReactionId},__class__:Sr};var yr=function(e){this.reactionUserIds=new eo;var t=this;null!=e&&(this.messageId=e.message_id,l.iter(p.fields(e.reaction_user_ids),function(n){var i=p.field(e.reaction_user_ids,n),r=t.reactionUserIds;null!=Jo[n]?r.setReserved(n,i):r.h[n]=i}))};n["albero.entity.reaction.MessageReactionUsers"]=yr,yr.__name__=["albero","entity","reaction","MessageReactionUsers"],yr.prototype={getReactionUserIds:function(e){var t=this.reactionUserIds,n=Ga.toString(e),i=t,r=null!=Jo[n]?i.getReserved(n):i.h[n];return null==r?[]:r},isReactionUser:function(e){for(var t=this.reactionUserIds,n=new $a(t,t.arrayKeys());n.hasNext();){var i=n.next();if(R.contains(i,e))return!0}return!1},__class__:yr};var wr=function(){};n["albero.js.Base64"]=wr,wr.__name__=["albero","js","Base64"],wr.initCodes=function(){for(var e=[],t=0,n=wr.BASE64.length;t<n;){var i=t++;e[wr.BASE64.charCodeAt(i)]=i}return e},wr.encode=function(e){for(var t=e,n=0,i=t.length-2,r="",a=wr.BASE64;n<i;){var o=t.b[n++],s=t.b[n++],l=t.b[n++];r+=g.string(a.charAt(o>>2)),r+=g.string(a.charAt(63&(o<<4|s>>4))),r+=g.string(a.charAt(63&(s<<2|l>>6))),r+=g.string(a.charAt(63&l))}if(n==i){var u=t.b[n++],c=t.b[n++];r+=g.string(a.charAt(u>>2)),r+=g.string(a.charAt(63&(u<<4|c>>4))),r+=g.string(a.charAt(c<<2&63))}else if(n==i+1){var _=t.b[n++];r+=g.string(a.charAt(_>>2)),r+=g.string(a.charAt(_<<4&63))}var h=r;switch(h.length%4){case 2:h+="==";break;case 3:h+="="}return h},wr.decode=function(e){var t=e.length-1;"="==e.charAt(t)&&("="==e.charAt(t-1)&&--t,e=s.substr(e,0,t));var n=e.length,i=e,r=wr.CODES;null==r&&(r=wr.initCodes(),wr.CODES=r);for(var a=0,o=3&n,l=a+(n-o),u=new to(new Xo(3*(n>>2)+(o>=2?o-1:0))),c=0;a<l;){var _=r[i.charCodeAt(a++)],h=r[i.charCodeAt(a++)];u.b[c++]=255&(_<<2|h>>4);var d=r[i.charCodeAt(a++)];u.b[c++]=255&(h<<4|d>>2);var f=r[i.charCodeAt(a++)];u.b[c++]=255&(d<<6|f)}if(o>=2){var m=r[i.charCodeAt(a++)],p=r[i.charCodeAt(a++)];if(u.b[c++]=255&(m<<2|p>>4),3==o){var g=r[i.charCodeAt(a++)];u.b[c++]=255&(p<<4|g>>2)}}return u};var Tr=function(){};n["albero.js.KatakanaToRoman"]=Tr,Tr.__name__=["albero","js","KatakanaToRoman"],Tr.assureConvertTable=function(){return null!=Tr.convertTable?Tr.convertTable:(Tr.convertTable=new eo,l.iter([["","A"],["","I"],["","U"],["","E"],["","O"],["","KA"],["","KI"],["","KU"],["","KE"],["","KO"],["","KYA"],["","KYU"],["","KYO"],["","SA"],["","SI"],["","SU"],["","SE"],["","SO"],["","SHA"],["","SHU"],["","SHO"],["","TA"],["","TI"],["","TU"],["","TE"],["","TO"],["","THA"],["","THU"],["","THO"],["","NA"],["","NI"],["","NU"],["","NE"],["","NO"],["","NYA"],["","NYU"],["","NYO"],["","HA"],["","HI"],["","FU"],["","HE"],["","HO"],["","HYA"],["","HYU"],["","HYO"],["","MA"],["","MI"],["","MU"],["","ME"],["","MO"],["","MYA"],["","MYU"],["","MYO"],["","YA"],["","YU"],["","YO"],["","RA"],["","RI"],["","RU"],["","RE"],["","RO"],["","RYA"],["","RYU"],["","RYO"],["","WA"],["","O"],["","N"],["","GA"],["","GI"],["","GU"],["","GE"],["","GO"],["","GYA"],["","GYU"],["","GYO"],["","ZA"],["","JI"],["","ZU"],["","ZE"],["","ZO"],["","ZYA"],["","ZYU"],["","ZYO"],["","DA"],["","JI"],["","ZU"],["","DE"],["","DO"],["","BA"],["","BI"],["","BU"],["","BE"],["","BO"],["","BYA"],["","BYU"],["","BYO"],["","PA"],["","PI"],["","PU"],["","PE"],["","PO"],["","PYA"],["","PYU"],["","PYO"],["",""],["",""]],function(e){var t=Tr.convertTable,n=e[0],i=e[1];null!=Jo[n]?t.setReserved(n,i):t.h[n]=i}),Tr.convertTable)},Tr.matchNext=function(e,t){var n=Tr.assureConvertTable();if(t+1<e.length){var i=e.substring(t,t+2),r=null!=Jo[i]?n.getReserved(i):n.h[i];if(null!=r)return Ir.MatchedToTwoCharsKey(r)}if(t<e.length){var a=e.substring(t,t+1),o=null!=Jo[a]?n.getReserved(a):n.h[a];if(null!=o)return Ir.MatchedToOneCharKey(o)}var s=t<e.length?e.substring(t,t+1):"";return Ir.NotMatched(s)},Tr.prototype={convert:function(e){for(var t=0,n="";t<e.length;){var i=Tr.matchNext(e,t);switch(i[1]){case 0:t+=2,n+=i[2];break;case 1:++t,n+=i[2];break;case 2:++t,n+=i[2]}}return n=(n=n.replace(Tr.TU_REG.r,"$1$1")).replace(Tr.XTU_REG.r,"XTU")},__class__:Tr};var Ir=n["albero.js.ResultOfMatchNext"]={__ename__:["albero","js","ResultOfMatchNext"],__constructs__:["MatchedToTwoCharsKey","MatchedToOneCharKey","NotMatched"]};Ir.MatchedToTwoCharsKey=function(e){var t=["MatchedToTwoCharsKey",0,e];return t.__enum__=Ir,t.toString=i,t},Ir.MatchedToOneCharKey=function(e){var t=["MatchedToOneCharKey",1,e];return t.__enum__=Ir,t.toString=i,t},Ir.NotMatched=function(e){var t=["NotMatched",2,e];return t.__enum__=Ir,t.toString=i,t},Ir.__empty_constructs__=[];var Er=function(e){this.isDirty=!1,this.key=e};n["albero.js.LocalStorage"]=Er,Er.__name__=["albero","js","LocalStorage"],Er.getLocalStorage=function(){return fo.getLocalStorage()},Er.prototype={load:function(){var e=this.val();if(null==e||""==e)return null;var t=null;try{t=Wa.run(e),this.isDirty=!1}catch(e){e instanceof _o&&(e=e.val),Ar._w("["+s.dateStr(new Date)+"] ",e,"","","","")}return t},save:function(e){try{this.val(za.run(e)),this.isDirty=!1}catch(e){e instanceof _o&&(e=e.val),Ar._w("["+s.dateStr(new Date)+"] ",e,"","","","")}},setDirtyFlag:function(){if(!this.isDirty)try{this.val(""),this.isDirty=!0}catch(e){e instanceof _o&&(e=e.val),Ar._w("["+s.dateStr(new Date)+"] ",e,"","","","")}},val:function(e){var t=Er.getLocalStorage();return null!=t&&(null==e?e=t.getItem(this.key):""==e?t.removeItem(this.key):t.setItem(this.key,e)),e},__class__:Er};var Nr=function(){};n["albero.js.Localizer"]=Nr,Nr.__name__=["albero","js","Localizer"],Nr.setLocalizeForMock=function(e,t){null==Nr.mock&&(Nr.mock=new eo);var n=Nr.mock;null!=Jo[e]?n.setReserved(e,t):n.h[e]=t},Nr.setLocalizeValueForMock=function(e,t){Nr.setLocalizeForMock(e,function(e){return t})},Nr.localizeForMock=function(e,t){if(null==Nr.mock)return null;var n=Nr.mock,i=null!=Jo[e]?n.getReserved(e):n.h[e];return null==i?null:i(t)},Nr.runOrReserve=function(e){e()},Nr.localize=function(e,t){return""},Nr.asyncPrepare=function(){return Promise.resolve()};var Ar=e.AlberoLog=function(){};n.AlberoLog=Ar,Ar.__name__=["AlberoLog"],Ar._nop=function(){},Ar.dateStr=function(){return"["+s.dateStr(new Date)+"] "};var br=function(e,t,n){this.ignoreCase=t,this.normalizeFunc=n,t&&(e=e.toUpperCase()),this.normalizedPattern=n(e)};n["albero.js.NFKCTextSearch"]=br,br.__name__=["albero","js","NFKCTextSearch"],br.prototype={search:function(e){var t=new v,n=[];this.ignoreCase&&(e=e.toUpperCase()),this.normalize(e,t,n);for(var i,r=0,a=[],o=t.b;-1!=(i=o.indexOf(this.normalizedPattern,r));){r=i+this.normalizedPattern.length;for(var s=n[i],l=n[r-1],u=null,c=r,_=n.length;c<_;){if(l!=(u=n[c++]))break;u=null}null==u&&(u=e.length),a.push(new Dr(s,u))}return a},normalize:function(e,t,n){for(var i=e.length,r=new v,a=0,o=0,s=i;o<s;){var l=o++,u=r.b.length,c=r.b,_=c+e.charAt(l),h=this.normalizeFunc(_);if(_!=h)if(S.startsWith(h,c)){var d=c.substring(0,u);t.b+=g.string(d),r=new v;var f=h.substring(u,h.length);r.b+=g.string(f);for(var m=0,p=u;m<p;){m++;n.push(a)}a=l}else(r=new v).b+=null==h?"null":""+h;else{t.b+=g.string(r),r=new v;var y=e.charAt(l);r.b+=g.string(y);for(var w=0,T=u;w<T;){w++;n.push(a)}a=l}}t.b+=g.string(r.b);for(var I=0,E=r.b.length;I<E;){I++;n.push(a)}},__class__:br};var Dr=function(e,t){this.start=e,this.end=t};n["albero.js.HitSpan"]=Dr,Dr.__name__=["albero","js","HitSpan"],Dr.prototype={__class__:Dr};var Mr=function(){};n["albero.js.PromiseHelper"]=Mr,Mr.__name__=["albero","js","PromiseHelper"],Mr.resolveVoid=function(e){e()},Mr.delay=function(e){return new Promise(function(t,n){Ya.delay(function(){Mr.resolveVoid(t)},e)})};var Cr=function(){};n["albero.js.SettingsResolver"]=Cr,Cr.__name__=["albero","js","SettingsResolver"],Cr.get=function(e,t){return null!=e?e:t},Cr.getAcceptableEventTimeDiff=function(){return Ha.parseString(Cr.get(Qo.acceptableEventTimeDiff,"10000"))};var kr=function(){};n["albero.js.TextCanonicalizer"]=kr,kr.__name__=["albero","js","TextCanonicalizer"],kr.canonicalize=function(e){return kr.basicLatinAlphabetToUpperCase(kr.hiraganaToKatakana(kr.normalize(kr.eraseInvisible(e))))},kr.canonicalizeForRoman=function(e){return kr.basicLatinAlphabetToUpperCase(kr.katakanaToRoman(kr.hiraganaToKatakana(kr.normalize(kr.eraseInvisible(e)))))},kr.basicLatinAlphabetToUpperCase=function(e){return e.toUpperCase()},kr.hiraganaToKatakana=function(e){for(var t=0,n="",i=0,r=e.length;i<r;){var a=i++,o=s.cca(e,a);o>=kr.HIRAGANA_SMALL_A&&o<=kr.HIRAGANA_NN&&(n+=e.substring(t,a),n+=String.fromCharCode(o+(kr.KATAKANA_SMALL_A-kr.HIRAGANA_SMALL_A)),t=a+1)}return n+=e.substring(t,e.length)},kr.katakanaToRoman=function(e){return(new Tr).convert(e)},kr.normalize=function(e){return new Or(null).normalize(e)},kr.normalizeForFile=function(e){return new Or(null).normalizeForFile(e)},kr.eraseInvisible=function(e){var t=new RegExp("[\\u0000-\\u0020]","g".split("u").join(""));return e.replace(t,"")};var Or=function(e){this.beforeTask=null,this.beforeTask=e};n["albero.js.Normalizer"]=Or,Or.__name__=["albero","js","Normalizer"],Or.prototype={normalize:function(e){try{return null!=this.beforeTask&&this.beforeTask(),e.normalize("NFKC")}catch(e){return e instanceof _o&&(e=e.val),Ar._e("["+s.dateStr(new Date)+"] ","invalid character:",e,"","",""),Nr.localize("TextCanonicalizer.invalid")}},normalizeForFile:function(e){try{return null!=this.beforeTask&&this.beforeTask(),e.normalize("NFC")}catch(e){return e instanceof _o&&(e=e.val),Ar._e("["+s.dateStr(new Date)+"] ","invalid character:",e,"","",""),Nr.localize("TextCanonicalizer.invalid")}},__class__:Or};var Rr=function(){};n["albero.js.WebSocket"]=Rr,Rr.__name__=["albero","js","WebSocket"],Rr.prototype={__class__:Rr};var Fr=function(){};n["albero.js.WebSocketFactory"]=Fr,Fr.__name__=["albero","js","WebSocketFactory"],Fr.newInstance=function(e,t){return new Ur(e,t)};var Ur=function(e,t){this.onopen=t.onopen,this.onmessage=t.onmessage,this.onerror=null,this.onclose=t.onclose,this.onpong=t.onpong,this.ws=new WebSocket(e),qo.websocketsbinary&&(this.ws.binaryType="arraybuffer"),this.ws.onopen=Ro(this,this.onOpen),this.ws.onmessage=Ro(this,this.onMessage),this.ws.onerror=Ro(this,this.onError),this.ws.onclose=Ro(this,this.onClose)};n["albero.js.WebSocketForBrowser"]=Ur,Ur.__name__=["albero","js","WebSocketForBrowser"],Ur.__interfaces__=[Rr],Ur.prototype={onOpen:function(e){Ar._i("["+s.dateStr(new Date)+"] ","WebSocket opened.","","","",""),null!=this.onopen&&this.onopen()},onMessage:function(e){if(null!=this.onmessage){var t;t=this.getBinaryData(e),this.onmessage(t)}},getBinaryData:function(e){return qo.websocketsbinary?to.ofData(new Zo(e.data)):wr.decode(e.data)},onPong:function(e){null!=this.onpong&&this.onpong(e)},onError:function(e){Ar._e("["+s.dateStr(new Date)+"] ","WebSocket error. event:",e,"","",""),null!=this.onerror&&this.onerror()},onClose:function(e){var t="WebSocket closed. "+g.string(e.code)+" "+g.string(e.reason)+" "+g.string(e.wasClean);Ar._i("["+s.dateStr(new Date)+"] ",t,"","","",""),null!=this.onclose&&this.onclose(e.code,e.reason,e.wasClean)},close:function(){this.onopen=null,this.onmessage=null,this.onerror=null,this.onclose=null,this.onpong=null,this.ws.close()},send:function(e){qo.websocketsbinary?this.ws.send(new Zo(e.b.bufferValue).buffer):this.ws.send(wr.encode(e))},ping:function(e){this.send(new to(new Xo(0)))},isClosed:function(){return null==this.ws||3==this.ws.readyState},__class__:Ur};var xr=function(){};n["puremvc.interfaces.IProxy"]=xr,xr.__name__=["puremvc","interfaces","IProxy"],xr.prototype={__class__:xr};var Pr=function(){};n["albero.proxy.AccessTokenResolverProxy"]=Pr,Pr.__name__=["albero","proxy","AccessTokenResolverProxy"],Pr.__interfaces__=[xr],Pr.prototype={__class__:Pr};var Lr=function(){};n["albero.proxy.AccessTokenResolverProxyFactory"]=Lr,Lr.__name__=["albero","proxy","AccessTokenResolverProxyFactory"],Lr.newInstance=function(){return new Gr("accessTokenResolver")};var Br=function(e,t){V.call(this),this.proxyName=null!=e?e:Br.NAME,null!=t&&this.setData(t)};n["puremvc.patterns.proxy.Proxy"]=Br,Br.__name__=["puremvc","patterns","proxy","Proxy"],Br.__interfaces__=[xr],Br.__super__=V,Br.prototype=r(V.prototype,{getProxyName:function(){return this.proxyName},setData:function(e){this.data=e},getData:function(){return this.data},onRegister:function(){},onRemove:function(){},__class__:Br});var Gr=function(e){Br.call(this,e)};n["albero.proxy.AccessTokenResolverProxyForDirectJs"]=Gr,Gr.__name__=["albero","proxy","AccessTokenResolverProxyForDirectJs"],Gr.__interfaces__=[Pr],Gr.__super__=Br,Gr.prototype=r(Br.prototype,{asyncGetAccessToken:function(e,t){var n=this.settings.getAccessToken();if(null==n){var i=null!=Qo.account?Qo.account.split(":"):null;null!=i&&2==i.length&&this.api.createAccessToken(i[0],i[1],t)}else t(n)},__class__:Gr});var Hr=function(){Br.call(this,"broadcast")};n["albero.proxy.AlberoBroadcastProxy"]=Hr,Hr.__name__=["albero","proxy","AlberoBroadcastProxy"],Hr.__super__=Br,Hr.prototype=r(Br.prototype,{handleNotification:function(e,t){var n=this;switch(e){case"notify_add_account_control_request":var i=new Ke(t);this.dataStore.setAccountControlRequest(i),this.sendNotification(e,i);break;case"notify_add_acquaintance":var r=this.dataFactory.newDomainUser(t[1]);this.dataStore.addAcquaintance(r),this.sendNotification(e,r);break;case"notify_add_acquaintances":var a=t[1].map(Ro(ko=this.dataFactory,ko.newDomainUser));l.iter(a,Ro(ko=this.dataStore,ko.addAcquaintance)),this.api.sendAddAcquaintanceNotifications(a),this.sendNotification(e,a);break;case"notify_add_domain_invite":var o=new Dt(t);this.dataStore.setDomainInvite(o),this.sendNotification(e,o);break;case"notify_add_favorite_message":var u=new Li(t);this.dataStore.addFavoriteMessage(u),this.sendNotification(e,u);break;case"notify_add_favorite_talk":var c=new Ut(t);this.updateTalkStatusByFavoriteTalkEvent(c),this.sendNotification(e,c);break;case"notify_add_friend":var _=this.dataFactory.newDomainUser(t[1]);this.dataStore.addFriend(_),this.sendNotification(e,_);break;case"notify_add_talkers":var h=new Jn(t);null==this.dataStore.getTalk(h.id)&&this.sendNotification("notify_add_talkers_including_me",h),this.dataStore.setTalk(h),this.sendNotification(e,h);break;case"notify_close_conference":var d=new nt(t);this.dataStore.removeConference(d),this.updateTalkStatusByConferenceClosedEvent(d),this.sendNotification(e,d);break;case"notify_conference_participant_join":var f,m=t[3],p=t[4],g=this.dataStore;if(null!=g.me){var v=g.me.id;f=null!=v&&null!=p&&v.high==p.high&&v.low==p.low}else f=!1;f&&this.dataStore.addReactedConfereceId(m),this.sendNotification(e,t);break;case"notify_conference_participant_reject":var S=t[3];this.dataStore.addReactedConfereceId(S),this.sendNotification(e,t);break;case"notify_create_announcement":var y=new Ve(t);this.dataStore.setAnnouncement(y),this.keywordWatcher.onAnnouncementCreated(y),this.sendNotification("notify_update_announcement_status",this.newAnnouncementStatus(y)),this.sendNotification(e,y);break;case"notify_create_message":var w=new Zt(t);this.dataStore.setMessage(w),this.keywordWatcher.onMessageCreated(w);var T=this.newTalkStatusByMessage(w);switch(null!=T&&this.sendNotification("notify_update_local_talk_status",T),w.type[1]){case 0:var I=w.content,E=null;switch(I.type){case"delete_talker":E=I.deleted_user_id;break;case"hide_pair_talk":E=I.user_id}if(null==E)return void this.sendNotification(e,w);for(var N=w.talkId,A=this.dataStore.getQuestions(N,E),b=0;b<A.length;){var D=A[b];++b,D.closed=!0,this.sendNotification("notify_update_question",D)}this.sendNotification(e,w);break;case 4:if(null!=w.content.file_id){var M=this.dataStore.getMessageFileInfos(w.id);l.iter(M,function(e){n.dataStore.setTalkFileInfo(e,!1),n.sendNotification("notify_create_attachment",e)})}this.sendNotification(e,w);break;case 5:var C=this.dataStore.getMessageFileInfos(w.id);l.iter(C,function(e){n.dataStore.setTalkFileInfo(e,!1),n.sendNotification("notify_create_attachment",e)}),this.sendNotification(e,w);break;case 13:case 15:case 17:var k=this.dataStore.getTalk(w.talkId);null!=k&&this.sendNotification("notify_update_question",this.dataStore.setQuestion(yn.fromMessageAndTalk(w,k))),this.sendNotification(e,w);break;case 14:case 16:case 18:case 19:case 20:case 21:var O=w.content.in_reply_to,F=this.dataStore.getTalk(w.talkId),U=this.dataStore.getQuestion(O);if(null!=F&&null!=U){var x,P=this.dataStore,L=w.userId;if(null!=P.me){var B=P.me.id;x=null!=B&&null!=L&&B.high==L.high&&B.low==L.low}else x=!1;U.updateByMessage(w,x),this.sendNotification("notify_update_question",U),w.isClosedActionStampMessage()&&this.dataStore.closeAction(O),this.sendNotification(e,w)}else this.sendNotification(e,w);break;default:this.sendNotification(e,w)}break;case"notify_create_note":var G=new dr(t);this.dataStore.setNoteRevisionSummary(G.noteId,G.noteRevisionSummary),this.sendNotification(e,G);break;case"notify_create_group_talk":case"notify_create_pair_talk":var H=new Jn(t);this.dataStore.setTalk(H),this.newTalkStatusByTalk(H),this.sendNotification(e,H);break;case"notify_delete_account_control_request":var z=R.fromIntOrInt64(t);this.dataStore.removeAccountControlRequest(z),this.sendNotification(e,z);break;case"notify_delete_acquaintance":this.dataStore.removeAcquaintance(t[0],t[1]),this.sendNotification(e,t);break;case"notify_delete_acquaintances":for(var Y=t[0],K=t[1],W=0;W<K.length;){var j=K[W];++W,this.dataStore.removeAcquaintance(Y,j),this.sendNotification("notify_delete_acquaintance",[Y,j])}this.sendNotification(e,t);break;case"notify_delete_announcement":var V=t[0],q=t[1],Q=this.dataStore.getAnnouncement(q);null!=Q&&Q.markAsDeleted();var J=this.dataStore.getAnnouncementStatus(V);null!=J&&J.updateByAnnouncementDeletion(q)&&this.dataStore.setAnnouncementStatus(J),this.sendNotification(e,t);break;case"notify_delete_attachment":var X=new Lt(t);this.dataStore.deleteFile(X),this.sendNotification(e,X);break;case"notify_delete_domain_invite":var Z=t;this.dataStore.removeDomainInvite(Z),this.sendNotification(e,Z);break;case"notify_delete_favorite_message":var $=new Bi(t);this.dataStore.deleteFavoriteMessage($),this.sendNotification(e,$);break;case"notify_delete_favorite_talk":var ee=new Ut(t);this.updateTalkStatusByFavoriteTalkEvent(ee),this.sendNotification(e,ee);break;case"notify_delete_friend":this.dataStore.removeFriend(t[0],t[1]),this.sendNotification(e,t);break;case"notify_delete_message":var te=new tn(t),ne=this.dataStore.getMessage(te.messageId);null!=ne&&ne.markAsDeleted();var ie=this.updateTalkStatusOnMessageDelete(te);null!=ie&&this.sendNotification("notify_update_local_talk_status",ie),this.sendNotification(e,te);break;case"notify_delete_note":var re=new $i(t);this.dataStore.setNote(re,null),this.dataStore.setNoteRevisionSummary(re,null);var ae=this.dataStore.getNoteLocalEdit(re);null!=ae&&ae.deleted(),this.sendNotification(e,re);break;case"notify_delete_scheduled_message":var oe=t,se=this.dataStore.removeScheduledMessage(oe);this.sendNotification(e,se);break;case"notify_delete_stampset":var le=t;this.dataStore.removeStampsetInfo(le),this.sendNotification(e,le);break;case"notify_delete_talk":var ue=t;this.dataStore.removeTalk(ue),this.dataStore.removeTalkStatus(ue),this.dataStore.removeConferencesOnLeaveTalk(ue),this.sendNotification("brand_badge_changed"),this.sendNotification(e,t);break;case"notify_disable_push_notification":var ce=new ri(t,!1);this.updateTalkStatusByTalkPushNotificationEvent(ce),this.sendNotification(e,ce);break;case"notify_enable_push_notification":var _e=new ri(t,!0);this.updateTalkStatusByTalkPushNotificationEvent(_e),this.sendNotification(e,_e);break;case"notify_flow_notification_badge":var he=new Gt(t);this.dataStore.setFlowNotificationBadge(he.domainId,he),this.sendNotification(e,he);break;case"notify_join_account_control_group":var de=new Ge(t);this.dataStore.setAccountControlGroup(de),this.dataStore.removeAccountControlRequests(),this.sendNotification("brand_badge_changed"),this.sendNotification(e,de);break;case"notify_join_domain":var fe=this.dataStore.setDomainIfLatest(new yt(t));yt.isAllowReadAnnouncement(fe)&&Ya.delay(function(){n.api.getAnnouncementStatus(fe.id)},500),this.sendNotification(e,[null,fe]);break;case"notify_leave_account_control_group":var me=t;this.dataStore.removeAccountControlGroup(me),this.sendNotification(e,me);break;case"notify_leave_domain":var pe=t;this.dataStore.removeDomain(pe),this.dataStore.removeConferencesOnLeaveDomain(pe),this.sendNotification(e,pe);break;case"notify_lock_note":var ge=new nr(t),ve=this.dataStore.getNote(ge.noteId);null!=ve&&ve.lock(ge.revision,ge.userId,ge.deviceId,ge.expiredAt),this.sendNotification(e,ge);break;case"notify_open_conference":var Se=new nt(t);this.dataStore.addConference(Se),this.sendNotification(e,Se);break;case"notify_processed_scheduled_message":var ye=t,we=ye.scheduled_message_id,Te=ye.result_code,Ie=this.dataStore.removeScheduledMessage(we);0!=Te&&this.sendNotification("error_occurred",{localErrorType:qt.SendingScheduledMessageFailed}),this.sendNotification(e,Ie);break;case"notify_schedule_message":var Ee=t[0],Ne=t[1],Ae=this.dataStore.getScheduledMessage(Ne);null==Ae&&(Ae=qi.fromNotifyScheduleMessage({id:Ne,talkId:Ee}),this.dataStore.setScheduledMessage(Ae)),this.sendNotification(e,Ae);break;case"notify_unlock_note":var be=new mr(t),De=this.dataStore.getNote(be.noteId);null!=De&&De.unlock(be.revision,be.userId),this.sendNotification(e,be);break;case"notify_update_account_control_group_partially":var Me=new Ye(t);this.dataStore.updateAccountControlGroup(Me),this.sendNotification(e,Me);break;case"notify_update_announcement_status":var Ce=new Je(t),ke=this.dataStore.getAnnouncementStatus(Ce.domainId);null==ke&&(ke=this.assureAnnouncementStatus(Ce.domainId)),ke.updateReadWithStatusUpdate(Ce),this.dataStore.setAnnouncementStatus(ke),this.sendNotification(e,Ce);break;case"notify_update_department_tree":var Oe=t;this.dataStore.clearDomainDepartment(Oe),this.api.getDepartmentTree(Oe),this.sendNotification(e,Oe);break;case"notify_update_department_users":var Re=t;this.dataStore.clearDomainDepartmentUsers(Re)&&this.sendNotification("department_user_count_cleared",Re),this.api.getUsers(Re,this.dataStore.getFriendsOrAcquaintances(Re).map(function(e){return e.id})),this.api.getMe(),this.sendNotification(e,Re);break;case"notify_update_domain":var Fe=new yt(t),Ue=this.dataStore.getDomain(Fe.id),xe=this.dataStore.setDomainIfLatest(Fe);if(null!=Ue&&yt.isAllowReadAnnouncement(Ue)&&!yt.isAllowReadAnnouncement(xe)){this.dataStore.removeAnnouncementStatus(Ue.id);var Pe=new Je;Pe.domainId=xe.id,this.sendNotification("notify_update_announcement_status",Pe)}if(!yt.isAllowReadAnnouncement(Ue)&&yt.isAllowReadAnnouncement(xe)&&this.api.getAnnouncementStatus(xe.id),yt.isChangedContractTreeEnabled(Ue,xe)&&!yt.isDepartmentEnabled(xe)){var Le=xe.id;this.dataStore.clearDomainDepartment(Le),this.dataStore.clearUsersDepartments(Le)}var Be=xe.directAppsSetting.enabled.filter(function(e){return null==n.dataStore.getDirectApp(e)});0!=Be.length&&this.api.getDirectApps(Be).catch(function(e){}),this.sendNotification(e,[Ue,xe]);break;case"notify_update_domain_builtin_stampsetting":var He=t[0],ze=this.dataStore.getDomain(He);if(null!=ze){var We=new tt(t[1]);ze.updateBuiltinStampSetting(We),this.dataStore.setDomainIfLatest(ze),this.sendNotification(e,He)}break;case"notify_update_domain_stampsetting":var je=t[0],qe=this.dataStore.getDomain(je);if(null!=qe){var Qe=qe.stampsetSetting;qe.updateStampsetSetting(new Vn(t[1])),this.dataStore.setDomainIfLatest(qe);var Xe=qe.stampsetSetting,Ze=new hi(je,Qe,Xe);Ze.isValid()&&this.sendNotification(e,Ze)}break;case"notify_update_domain_users":for(var $e=t,et=0;et<$e.length;){var it=$e[et];++et;var rt=this.dataStore.getDomain(it);null!=rt&&rt.setting.contactTreeEnabled&&this.dataStore.clearDomainDepartmentUsers(it)&&this.sendNotification("department_user_count_cleared",it)}this.sendNotification(e,t);break;case"notify_delete_talker":case"notify_update_group_talk":var at=new Jn(t);this.dataStore.setTalk(at),this.sendNotification(e,at);break;case"notify_update_message_reactions":l.iter(t,function(e){var t=e[1];n.dataStore.removeMessageReactionSummary(t),n.dataStore.removeMessageReactionUsers(t)}),this.sendNotification(e,t);break;case"notify_update_note_partially":if(null==t)return void Ar._e("["+s.dateStr(new Date)+"] ","notePartiallyUpdate is null.","","","","");if(null==t.note_id)return void Ar._e("["+s.dateStr(new Date)+"] ","noteId is null.","","","","");var ot=new $i(t.note_id),st=this.dataStore.getNote(ot);if(null!=st&&null!=t.note_revision_summary&&st.compareRevision(t.note_revision_summary.revision)<=-1&&this.dataStore.setNote(ot,null),null==t.note_revision_summary&&null==t.setting)return void Ar._e("["+s.dateStr(new Date)+"] ","noteSetting and noteRevisionSummary are null.","","","","");if(null!=t.setting&&this.sendNotification("notify_update_note_for_setting",new sr(t)),null!=t.note_revision_summary){var lt=new lr(t),ut=this.dataStore.getNoteRevisionSummary(ot);if(null!=ut&&ut.compareRevision(lt.getRevision())<0){var ct=this.dataStore.getNoteLocalEdit(ot);null!=ct&&ct.conflict(),this.dataStore.setNoteRevisionSummary(ot,lt.noteRevisionSummary),this.sendNotification("notify_update_note_for_revision",new lr(t))}}break;case"notify_update_read_statuses":var _t=new rn(t),ht=this.updateTalkStatus(_t);null!=ht&&this.sendNotification("notify_update_local_talk_status",ht),this.sendNotification(e,_t);break;case"notify_update_stampset":var dt=new jn(t);this.dataStore.updateStampsetInfo(dt),this.sendNotification(e,dt);break;case"notify_update_talk_status":var ft=new ui(t),mt=this.dataStore.getTalkStatus(ft.talkId);null!=mt&&mt.update(ft)&&(this.dataStore.setTalkStatus(mt),this.sendNotification("notify_update_local_talk_status",mt)),this.sendNotification(e,ft);break;case"notify_update_user":if(t instanceof Array&&null==t.__enum__){var pt=this.dataFactory.newDomainUser(t[1]);this.dataStore.setUserIfLatest(null,pt)}else{var gt=new Xt(t);Ar._d("["+s.dateStr(new Date)+"] ","Current user updated. user:",gt,"","","");var vt=this.dataStore;vt.me=gt;for(var St=0,wt=vt.getDomains();St<wt.length;){var Tt=wt[St];++St,vt.sendNotification("notify_update_user",vt.me.toDomainUser(Tt.id))}vt.sendNotification("current_user_changed",gt),vt.storageForUsers.setDirtyFlag()}break;default:this.sendNotification(e,t)}},updateTalkStatusByFavoriteTalkEvent:function(e){var t=this.dataStore.getTalkStatus(e.talkId);if(null==t){var n=this.dataStore.getTalk(e.talkId);if(null==n)return void Ar._e("["+s.dateStr(new Date)+"] ","talk not found on change favorite talk.","","","","");(t=new si).id=e.talkId,t.talkOrderingTimestamp=n.updatedAt}(null==t.favoriteVersion||e.favoriteVersion>t.favoriteVersion)&&(t.favoriteVersion=e.favoriteVersion,t.orderInFavorites=e.orderInFavorites,this.dataStore.setTalkStatus(t))},updateTalkStatusByConferenceClosedEvent:function(e){var t=this.dataStore.getTalkStatus(e.talkId);if(null!=t&&null!=t.maxMessage){var n=t.maxMessage.id,i=e.messageId;null!=n&&null!=i&&n.high==i.high&&n.low==i.low&&(t.maxMessage.content.closed=!0,this.dataStore.setTalkStatus(t))}},updateTalkStatusByTalkPushNotificationEvent:function(e){var t=this.dataStore.getTalkStatus(e.talkId);if(null==t){var n=this.dataStore.getTalk(e.talkId);if(null==n)return void Ar._e("["+s.dateStr(new Date)+"] ","talk not found on change favorite talk.","","","","");(t=new si).id=e.talkId,t.talkOrderingTimestamp=n.updatedAt}t.updateByTalkPushNotificationEvent(e)&&this.dataStore.setTalkStatus(t)},newTalkStatusByTalk:function(e){var t=this.dataStore.getTalkStatus(e.id);return null==t&&((t=new si).id=e.id),null==t.talkOrderingTimestamp&&(t.talkOrderingTimestamp=e.updatedAt),this.dataStore.setTalkStatus(t),t},newTalkStatusByMessage:function(e){var t=this.dataStore.getTalkStatus(e.talkId);null==t&&((t=new si).id=e.talkId);var n,i=this.dataStore,r=e.userId;if(null!=i.me){var a=i.me.id;n=null!=a&&null!=r&&a.high==r.high&&a.low==r.low}else n=!1;return t.updateByMessage(e,n),this.dataStore.setTalkStatus(t),t},updateTalkStatusOnMessageDelete:function(e){var t=this.dataStore.getTalkStatus(e.talkId);return null!=t&&t.updateByMessageDeletion(e)&&this.dataStore.setTalkStatus(t),t},updateTalkStatus:function(e){var t=this;if(!l.exists(e.readUserIds,function(e){var n=t.dataStore;if(null!=n.me){var i=n.me.id;return null!=i&&null!=e&&i.high==e.high&&i.low==e.low}return!1}))return null;var n=this.dataStore.getTalkStatus(e.talkId);return null==n?(Ar._e("["+s.dateStr(new Date)+"] ","talkStatus is not found.","","","",""),null):(n.updateByMessageReadStatusesUpdate(e)&&this.dataStore.setTalkStatus(n),n)},newAnnouncementStatus:function(e){var t=this.dataStore.getAnnouncementStatus(e.domainId);return null==t&&((t=new qe).domainId=e.domainId),t.updateByAnnouncement(e),this.dataStore.setAnnouncementStatus(t),t},assureAnnouncementStatus:function(e){var t=this.dataStore.getAnnouncementStatus(e);return null==t&&(t=qe.fromDomainId(e),this.dataStore.setAnnouncementStatus(t)),t},__class__:Hr});var zr=function(){Br.call(this,"api")};n["albero.proxy.AlberoServiceProxy"]=zr,zr.__name__=["albero","proxy","AlberoServiceProxy"],zr.__super__=Br,zr.prototype=r(Br.prototype,{getOSString:function(){return"bot","bot"},createAccessToken:function(e,t,n){var i=this,r=e.split("$"),a=this.settings.getOs(),o=this.settings.getIDFV(),s=function(e){i.settings.setAccessToken(e),n(e)},l=function(e){i.sendNotification("Url",Le.FORWARD(G.error))};-1==e.indexOf("@")&&2==r.length?this.wsApi.createAccessTokenById(r[1],r[0],t,o,a).then(s,l):this.wsApi.createAccessToken(e,t,o,a).then(s,l)},authorizeDevice:function(e,t){var n=this,i=this.settings.getIDFV();this.wsApi.authorizeDevice(e,i).then(function(e){t()},function(e){n.apiCaller.handleServerErrorDefault(e)})},createSession:function(e,t){var n=this;this.apiCaller.onSessionClear(),this.wsApi.createSession(e,"1.124",null).then(function(e){var i=M.nowAsInt64();e.passwordExpiration.isExpired(i)?n.sendNotification("password_expiration_overed"):(e.passwordExpiration.needWarning(i,n.settings.getPasswordWarningSkipUntil())&&(n.settings.setPasswordWarningSkipUntil(M.oneDayAfterAsInt64()),n.sendNotification("password_expiration_warned")),n.apiCaller.onSessionCreated(),t(e),n.apiCaller.fireCallbacksWaitingForSession())},function(e){if(null!=e){if(401==e.code&&"expired password"==e.message)return void n.sendNotification("password_expiration_overed");if(401==e.code&&"deleted account"==e.message)return void n.sendNotification("SignOut");if(401==e.code&&"unauthorized device"==e.message)return void n.sendNotification("Device",ne.AUTHORIZE);n.apiCaller.handleServerErrorDefault(e)}n.settings.clearAccessToken(),n.sendNotification("Url",Le.FORWARD(G.error))})},startNotification:function(){var e=this;this.wsApi.startNotification().then(function(t){t||(e.dataStore.clear(!0),e.sendNotification("start_notification_failed"))},function(t){e.apiCaller.handleServerErrorDefault(t)})},resetNotification:function(e){var t=this;this.wsApi.resetNotification().then(e,function(e){t.apiCaller.handleServerErrorDefault(e)})},sendDomainNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_update_domain",[null,n])}},sendAnnouncementStatusNotification:function(e){var t=new Je;t.domainId=e.domainId,this.sendNotification("notify_update_announcement_status",t)},sendAddFriendNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_add_friend",n)}},sendAddAcquaintanceNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_add_acquaintance",n)}},sendTalkNotification:function(e){var t=e.type==Zn.PairTalk?"notify_create_pair_talk":"notify_create_group_talk";this.sendNotification(t,e)},sendTalkNotifications:function(e){l.iter(e,Ro(this,this.sendTalkNotification))},sendTalkStatusNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_update_local_talk_status",n)}},sendAddDomainInviteNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_add_domain_invite",n)}},sendAddAccountControlRequestNotifications:function(e){for(var t=0;t<e.length;){var n=e[t];++t,this.sendNotification("notify_add_account_control_request",n)}},sendJoinAccountControlGroupNotification:function(e){this.sendNotification("notify_join_account_control_group",e)},deleteSession:function(){this.settings.clearSelectedStampsetType(),this.settings.clearDomainSelection(),this.settings.clearAccessToken(),this.apiCaller.restart()},updateUser:function(e,t,n,i,r){var a=this,o=function(e){a.sendNotification("update_user_errored",a.dataStore.me)},s=function(t){a.wsApi.updateUser(e,t,i,r).then(function(e){var t=a.dataStore;t.me=e;for(var n=0,i=t.getDomains();n<i.length;){var r=i[n];++n,t.sendNotification("notify_update_user",t.me.toDomainUser(r.id))}t.sendNotification("current_user_changed",e),t.storageForUsers.setDirtyFlag(),a.sendNotification("update_user_responsed",a.dataStore.me)},function(e){o(),a.apiCaller.handleServerErrorDefault(e)})};null!=n?s(n):null!=t?this.uploadFile(t,null,di.PROFILE_IMAGE,function(e){s(e.get_url)},o):s()},updateProfile:function(e){var t=this;this.wsApi.updateProfile(e).then(function(e){var n=t.dataStore;n.me=e;for(var i=0,r=n.getDomains();i<r.length;){var a=r[i];++i,n.sendNotification("notify_update_user",n.me.toDomainUser(a.id))}n.sendNotification("current_user_changed",e),n.storageForUsers.setDirtyFlag(),t.sendNotification("update_profile_responsed",t.dataStore.me)},function(e){t.sendNotification("update_profile_errored",t.dataStore.me),t.apiCaller.handleServerErrorDefault(e)})},addFriend:function(e){var t=this,n=this.settings.getSelectedDomainId();this.wsApi.addFriend(n,e.id).then(function(e){},function(e){t.apiCaller.handleServerErrorDefault(e)})},deleteFriend:function(e){var t=this,n=this.settings.getSelectedDomainId();this.wsApi.deleteFriend(n,e.id).then(function(e){},function(e){t.apiCaller.handleServerErrorDefault(e)})},getFriends:function(e){var t=this;this.wsApi.getFriends().then(function(n){for(var i=0;i<n.length;){var r=n[i];++i,l.iter(r.domainUsers,Ro(ko=t.dataStore,ko.addFriend)),t.sendAddFriendNotifications(r.domainUsers)}null!=e&&e()},function(e){t.apiCaller.handleServerErrorDefault(e)})},getAcquaintances:function(e){var t=this;this.wsApi.getAcquaintances().then(function(n){for(var i=0;i<n.length;){var r=n[i];++i,l.iter(r.domainUsers,Ro(ko=t.dataStore,ko.addAcquaintance)),t.sendAddAcquaintanceNotifications(r.domainUsers)}null!=e&&e()},function(e){t.apiCaller.handleServerErrorDefault(e)})},getAllUsers:function(e,t){var n=this;null==t&&(t=this.settings.getSelectedDomainId());this.wsApi.getAllUsers(t,[2,4,8],40,e).then(function(e){n.dataStore.setUsersIfLatest(t,e.contents),n.sendNotification("get_domain_users_responsed",[t,e.marker,e.nextMarker,e.contents])},function(e){n.apiCaller.handleServerErrorDefault(e)})},searchDomainUsers:function(e,t){var n=this,i=this.settings.getSelectedDomainId();this.wsApi.searchDomainUsers(i,e,[2,4,8],40,t).then(function(t){n.dataStore.setUsersIfLatest(i,t.contents),n.sendNotification("get_domain_users_responsed",[i,t.marker,t.nextMarker,t.contents,e])},function(e){n.apiCaller.handleServerErrorDefault(e)})},getUsers:function(e,t){var n=this,i=t.slice(0,100);0!=i.length&&this.wsApi.getUsers(e,i).then(function(i){n.dataStore.setUsersIfLatest(e,i),n.sendNotification("get_users_responsed",[e,i]);var r=t.slice(100);n.getUsers(e,r)},function(e){n.apiCaller.handleServerErrorDefault(e)})},getProfile:function(e,t){var n=this;this.wsApi.getProfile(e,t).then(function(e){n.sendNotification("get_profile_responsed",e)},function(e){403==e.code&&"invalid user"==e.message?null!=e.detail&&null!=e.detail.invalid_user_ids&&n.sendNotification("get_profile_errored",e.detail.invalid_user_ids):n.apiCaller.handleServerErrorDefault(e)})},getUserIdentifiers:function(e,t,n){var i=this;if(0==t.length)null!=n&&n();else{var r=t.slice(0,100);this._getUserIdentifiers(e,r,function(){var r=t.slice(100);i.getUserIdentifiers(e,r,n)})}},_getUserIdentifiers:function(e,t,n){var i=this;this.apiCaller.call("get_user_identifiers",[e,t],function(r){for(var a=r.contents,o=new eo,s=0,l=a.length;s<l;){var u=s++,c=new mi(a[u]),_=c.userId,h="_"+_.high+"_"+_.low;null!=Jo[h]?o.setReserved(h,c):o.h[h]=c}for(var d=0,f=t.length;d<f;){var m=d++,p=i.dataStore.getUser(e,t[m]);if(null!=p){var g=p.id,v="_"+g.high+"_"+g.low,S=null!=Jo[v]?o.getReserved(v):o.h[v];null!=S&&p.setUserIdentifier(S),p.__uid_caching=!0}}null!=n&&n()},function(r){for(var a=0,o=t.length;a<o;){var s=a++,l=i.dataStore.getUser(e,t[s]);null!=l&&(l.__uid_caching=null)}null!=n&&n()})},getAllUserIdentifiers:function(e){var t=this,n=null,i=this.dataStore.getUsers();null==i&&(i=[]);for(var r=0;r<i.length;){var a=i[r];if(++r,null==a.__uid_caching){a.__uid_caching=!1;var o=a.domainId,s="_"+o.high+"_"+o.low;null==n&&(n=new eo);var l=null!=Jo[s]?n.getReserved(s):n.h[s];null==l&&(l=[],null!=Jo[s]?n.setReserved(s,l):n.h[s]=l),l.push(a.id)}}if(null==n)e();else{var u=n.keys(),c=null;(c=function(){if(u.hasNext()){var i=u.next(),r=R.makeFromIdStr(i),a=null!=Jo[i]?n.getReserved(i):n.h[i];t.getUserIdentifiers(r,a,c)}else e()})()}},getAllUserEmails:function(e){Ar._w("["+s.dateStr(new Date)+"] ","'getAllUserEmails' is deprecated, please use 'getAllUserIdentifiers' instead","","","",""),this.getAllUserIdentifiers(e)},getDepartmentTree:function(e){var t=this;this.apiCaller.call("get_department_tree",[e],function(n){l.iter(new ct(n).departments,function(n){n.isRoot()&&t.dataStore.setRootDepartmentId(e,n.id),t.dataStore.setDepartment(n)});var i=t.settings.getSelectedDepartmentId(e);null!=i&&null==t.dataStore.getDepartment(i)&&t.settings.setSelectedDepartmentId(e,null),t.sendNotification("get_department_tree_responsed",[e])},function(n){403!=n.code||"forbidden"!=n.message?t.apiCaller.handleServerErrorDefault(n):t.sendNotification("get_department_tree_canceled",[e])})},getDepartmentUsers:function(e,t){this._getDepartmentUsers(e,t,null)},getDepartmentAllUsers:function(e){var t=this,n=this.dataStore.getDepartment(e);if(null==n||null==n.userIds){var i=new eo,r=null;r=function(n,a,o){if(l.iter(o,function(e){var t=e.id,n="_"+t.high+"_"+t.low,r=e.id;null!=Jo[n]?i.setReserved(n,r):i.h[n]=r}),null==a){for(var s=[],u=i.arrayKeys(),c=new $a(i,u);c.hasNext();){var _=c.next();s.push(_)}s.length;t.dataStore.setDepartmentUsers(e,s),t.sendNotification("department_user_ids_prepared",s)}else t._getDepartmentUsers(e,a,r)},this._getDepartmentUsers(e,null,r)}else this.sendNotification("department_user_ids_prepared",n.userIds)},_getDepartmentUsers:function(e,t,n){var i=this,r=this.settings.getSelectedDomainId(),a=this.dataStore.getDepartment(e),o=null!=a&&null!=a.childrenIds;this.apiCaller.call("get_department_users",[r,e,o,100,t],function(t){var a=U.asArray(t.contents).map(Ro(ko=i.dataFactory,ko.newDomainUser));i.dataStore.setUsersIfLatest(r,a),i.sendNotification("get_department_users_responsed",[r,t.marker,t.next_marker,a,e]),null!=n&&n(t.marker,t.next_marker,a)},function(e){403!=e.code||"forbidden"!=e.message?i.apiCaller.handleServerErrorDefault(e):i.sendNotification("get_department_users_canceled",[r])})},getMe:function(){var e=this;this.apiCaller.call("get_me",[],function(t){var n=e.dataStore,i=new Xt(t);n.me=i;for(var r=0,a=n.getDomains();r<a.length;){var o=a[r];++r,n.sendNotification("notify_update_user",n.me.toDomainUser(o.id))}n.sendNotification("current_user_changed",i),n.storageForUsers.setDirtyFlag(),e.sendNotification("get_me_responsed")},function(t){e.apiCaller.handleServerErrorDefault(t)})},getDepartmentUserCount:function(e,t){var n=t.filter(Ro(ko=this.dataStore,ko.isUserCountLoadingRequired));this._getDepartmentUserCount(e,n)},_getDepartmentUserCount:function(e,t){var n=this,i=t.splice(0,100);0!=i.length&&(l.iter(i,function(e){n.dataStore.setUserCountLoading(e,!0)}),this.apiCaller.call("get_department_user_count",[e,i],function(r){var a=new dt(r);l.iter(a.departments,Ro(ko=n.dataStore,ko.setDepartmentUserCount)),n.sendNotification("get_department_user_count_responsed",{completed:i,remaining:t}),n._getDepartmentUserCount(e,t)},function(e){l.iter(i,function(e){n.dataStore.setUserCountLoading(e,!1)}),n.apiCaller.handleServerErrorDefault(e)}))},getDomains:function(e){var t=this;this.wsApi.getDomains().then(function(n){l.iter(n,Ro(ko=t.dataStore,ko.setDomainIfLatest));var i=t.dataStore.getDomains();t.sendDomainNotifications(i),null!=e&&e()},function(e){t.apiCaller.handleServerErrorDefault(e)})},leaveDomain:function(e){var t=this;this.wsApi.leaveDomain(e.id).then(function(e){t.dataStore.removeDomain(e)},function(e){t.apiCaller.handleServerErrorDefault(e)})},getDomainInvites:function(e){var t;t=null==e?function(e){}:function(t){e()},this._getDomainInvites(t)},_getDomainInvites:function(e){var t=this;this.wsApi.getDomainInvites().then(function(n){l.iter(n,Ro(ko=t.dataStore,ko.setDomainInvite)),t.sendAddDomainInviteNotifications(n),e(n)},function(e){t.apiCaller.handleServerErrorDefault(e)})},acceptDomainInvite:function(e){var t=this;this.wsApi.acceptDomainInvite(e).then(function(e){},function(e){t.apiCaller.handleServerErrorDefault(e)})},deleteDomainInvite:function(e){var t=this;this.wsApi.deleteDomainInvite(e).then(function(e){},function(e){t.apiCaller.handleServerErrorDefault(e)})},getAccountControlRequests:function(e){var t=this;this.wsApi.getAccountControlRequests().then(function(n){l.iter(n,Ro(ko=t.dataStore,ko.setAccountControlRequest)),t.sendAddAccountControlRequestNotifications(n),null!=e&&e()},function(e){t.apiCaller.handleServerErrorDefault(e)})},acceptAccountControlRequest:function(e){if(null!=e){var t=this.dataStore.getAccountControlRequest(e);null!=t&&this.apiCaller.call("accept_account_control_request",[t.id,t.version],function(e){})}},rejectAccountControlRequest:function(e){if(null!=e){var t=this.dataStore.getAccountControlRequest(e);null!=t&&this.apiCaller.call("reject_account_control_request",[t.id,t.version],function(e){})}},getJoinedAccountControlGroup:function(e){var t=this;this.wsApi.getJoinedAccountControlGroup().then(function(n){if(l.iter(n,Ro(ko=t.dataStore,ko.setAccountControlGroup)),1==n.length){var i=n[0];t.sendJoinAccountControlGroupNotification(i)}null!=e&&e()},function(e){t.apiCaller.handleServerErrorDefault(e)})},getTalks:function(e){var t=this;this.wsApi.getTalks().then(function(e){return l.iter(e,Ro(ko=t.dataStore,ko.setTalk)),t.wsApi.getTalkStatuses()}).then(function(n){l.iter(n,Ro(ko=t.dataStore,ko.setTalkStatus));var i=t.dataStore.getTalks();t.sendTalkNotifications(i);var r=t.dataStore.getTalkStatuses();t.sendTalkStatusNotifications(r),null!=e&&e()},function(e){t.apiCaller.handleServerErrorDefault(e)})},getReadStatus:function(e,t){var n=this;this.wsApi.getReadStatus(e,t).then(function(e){n.sendNotification("notify_get_message_status",e)},function(e){n.apiCaller.handleServerErrorDefault(e)})},createGroupTalk:function(e,t,n,i){var r=this;null==e&&(e=this.settings.getSelectedDomainId()),0!=t.length&&this.wsApi.createGroupTalk(e,t,n).then(function(e){r.dataStore.setTalk(e),r.sendNotification("create_group_talk_complete",e),null!=i&&r.sendNotification("SelectTalk",De.SelectTalk(i,e))},function(e){if(r.sendNotification("create_group_talk_fail"),null!=e&&500==e.code&&null!=e.detail&&"failure in adding some users"==e.message){var t=ca.toLocalError(qt.AddingSomeUsersFailure,e);r.sendNotification("error_occurred",t)}else if(null!=e&&502==e.code&&null!=e.detail&&"talks"==e.detail.limit_target){var n=e.detail.limit_max,i=ca.toLocalError(qt.TalksCountOvered(n),e);r.sendNotification("error_occurred",i)}else if(null!=e&&502==e.code&&null!=e.detail&&"talkers"==e.detail.limit_target){var a=e.detail.limit_max,o=ca.toLocalError(qt.TalkersCountOvered(a),e);r.sendNotification("error_occurred",o)}else r.apiCaller.handleServerErrorDefault(e)})},createPairTalk:function(e,t,n){var i=this;null==e&&(e=this.settings.getSelectedDomainId()),this.wsApi.createPairTalk(e,t).then(function(e){i.dataStore.setTalk(e),i.sendNotification("create_pair_talk_complete",e),null!=n&&i.sendNotification("SelectTalk",De.SelectTalk(n,e))},function(e){if(i.sendNotification("create_pair_talk_fail"),null!=e&&502==e.code&&null!=e.detail&&"talks"==e.detail.limit_target){var t=e.detail.limit_max,n=ca.toLocalError(qt.TalksCountOvered(t),e);i.sendNotification("error_occurred",n)}else i.apiCaller.handleServerErrorDefault(e)})},updateGroupTalk:function(e,t,n,i){var r=this;this.wsApi.updateGroupTalk(e.id,t,n,i).then(function(e){r.dataStore.setTalk(e),r.sendNotification("update_group_talk_complete",e)},function(e){r.sendNotification("update_group_talk_fail"),r.apiCaller.handleServerErrorDefault(e)})},addTalkers:function(e,t,n){var i=this;if(e.type!=Zn.PairTalk)0!=t.length&&this.wsApi.addTalkers(e.id,t).then(function(e){i.dataStore.setTalk(e),i.sendNotification("notify_add_talkers",e),i.sendNotification("add_talkers_succeeded",e)},function(e){if(i.sendNotification("add_talkers_failed",e),null!=e&&500==e.code&&null!=e.detail&&"failure in adding some users"==e.message){var t=ca.toLocalError(qt.AddingSomeUsersFailure,e);i.sendNotification("error_occurred",t)}else if(null!=e&&502==e.code&&null!=e.detail&&"talkers"==e.detail.limit_target){var n=e.detail.limit_max,r=ca.toLocalError(qt.TalkersCountOvered(n),e);i.sendNotification("error_occurred",r)}else i.apiCaller.handleServerErrorDefault(e)});else{var r=e.userIds.concat(t);R.remove(r,this.dataStore.me.id);var a=this.settings.getSelectedDomainId();this.createGroupTalk(a,r,Xn.createDefault(),n)}},deleteTalker:function(e,t){var n,i=this,r=null,a=null,o=this.dataStore;if(null!=o.me){var s=o.me.id;n=null!=s&&null!=t&&s.high==t.high&&s.low==t.low}else n=!1;n&&(r=e,a=this.dataStore.getTalkStatus(e.id),this.dataStore.removeTalk(e.id),this.dataStore.removeTalkStatus(e.id)),this.wsApi.deleteTalker(e.id,t).then(function(r){R.remove(e.userIds,t),n||i.dataStore.setTalk(e),n&&i.dataStore.removeConferencesOnLeaveTalk(e.id),i.sendNotification("notify_delete_talker",e)},function(e){null!=r&&i.dataStore.setTalk(r),null!=a&&i.dataStore.setTalkStatus(a),i.sendNotification("error_occurred",e)})},getMessages:function(e,t,n,i){var r=this;t=null==t?{sinceId:null,maxId:null}:t,null==n&&(n=on.desc),this.wsApi.getMessages(e,20,t,n).then(function(t){l.iter(t,Ro(ko=r.dataStore,ko.setMessage)),r.sendNotification("notify_get_messages",{talkId:e,messages:t,sortOrder:n,callerKey:i})},function(e){r.apiCaller.handleServerErrorDefault(e)})},createMessage:function(e,t,n,i){var r=this.dataFactory.newDummyMessage(e,t,n);if(null==this.dataStore.getTalk(e)){var a={code:400,message:"invalid talk_id (deleted talk)"};return Ar._w("["+s.dateStr(new Date)+"] ","WARNING method: create_message",a,"","",""),void this.sendNotification("create_message_fail",[a,r],i)}this.sendNotification("create_message_start",r),this._createMessage(e,t,n,r,i)},_createMessage:function(e,t,n,i,r){var a=this;this.wsApi.createMessage(e,t,n).then(function(e){a.dataStore.removeMessage(i.id),a.dataStore.setMessage(e),a.dataStore.setFromThisDevice(e),a.sendNotification("create_message_complete",[e,i.id],r)},function(e){if(a.sendNotification("create_message_fail",[e,i],r),null!=e&&409==e.code){var t=ca.toLocalError(qt.SendingMessageConflicted,e);a.sendNotification("error_occurred",t)}else a.sendNotification("error_occurred",e)})},forwardMessages:function(e,t,n){null==n&&(n=0);var i=this;if(!(n>=t.length)){var r=t[n],a=e.id,o=this.dataFactory.newDummyMessage(a,r.type,r.content);this.sendNotification("create_message_start",o),this.wsApi.createMessage(a,r.type,r.content).then(function(r){i.dataStore.setMessage(r),i.sendNotification("create_message_complete",[r,o.id]),i.forwardMessages(e,t,n+1),i.dataStore.removeMessage(o.id)},function(e){if(i.sendNotification("create_message_fail",[e,o]),null!=e&&409==e.code){var t=ca.toLocalError(qt.SendingMessageConflicted,e);i.sendNotification("error_occurred",t)}else i.sendNotification("error_occurred",e)})}},deleteMessage:function(e,t){var n=this;this.wsApi.deleteMessage(e,t).then(function(e){},function(e){if(null!=e){if(403==e.code&&"frozen domain"==e.message)return void n.sendNotification("error_occurred",e);if(409==e.code&&"conflict"==e.message){var t=ca.toLocalError(qt.DeletingMessageConflicted,e);return void n.sendNotification("error_occurred",t)}n.sendNotification("error_occurred",e)}})},updateReadStatuses:function(e,t){var n=this;this.wsApi.updateReadStatuses(e,t).then(function(i){var r,a=n.dataStore.getTalkStatus(e);if(null!=a){var o=a.maxReadMessageId;r=null!=o&&null!=t&&o.high==t.high&&o.low==t.low}else r=!1;r&&n.sendNotification("notify_update_local_talk_status",a)},function(e){n.apiCaller.handleServerErrorDefault(e)})},searchMessagesAroundDateTime:function(e,t){return this.wsApi.searchMessagesAroundDateTime(e,t)},uploadV2:function(e,t,n,i){var r=this,a=this.dataFactory.newDummyFileMessage(t,n);this.sendNotification("create_message_start",a),this.prepareMessageFileAsync(n.file,n.thumb,e,!1).then(function(e){r._createMessage(t,$t.file,e,a,i)},function(e){r.sendNotification("create_message_fail",[e,a],i)})},uploadForHubot:function(e,t,n){var i=this.dataStore.getTalk(e),r={file:t,thumb:null};if(null==i){var a=this.dataFactory.newDummyFileMessage(e,r),o={code:400,message:"invalid talk_id (deleted talk)"};return Ar._w("["+s.dateStr(new Date)+"] ","WARNING method: upload",o,"","",""),void this.sendNotification("create_message_fail",[o,a],n)}this.uploadV2(i.domainId,i.id,r,n)},uploadMultiV2:function(e,t,n,i,r){var a=this,o=this.dataFactory.newDummyMultipleFileMessage(t,n,i);this.sendNotification("create_message_start",o),this.prepareMessageFilesAsync(e,n,i,!1).then(function(e){a._createMessage(t,$t.textMultipleFile,e,o,r)},function(e){a.sendNotification("create_message_fail",[e,o],r)})},uploadMultiForHubot:function(e,t,n,i){var r=this.dataStore.getTalk(e),a=n.map(function(e){return{file:e,thumb:null}});if(null==r){var o=this.dataFactory.newDummyMultipleFileMessage(e,t,a),l={code:400,message:"invalid talk_id (deleted talk)"};return Ar._w("["+s.dateStr(new Date)+"] ","WARNING method: uploadMulti",l,"","",""),void this.sendNotification("create_message_fail",[l,o],i)}this.uploadMultiV2(r.domainId,r.id,t,a,i)},validateFileName:function(e){var t=S.replace(e.name,"$","__");if(t==e.name)return e;try{return e.name=t,e}catch(r){var n=e,i=n.slice(0,n.size,n.type);return new File([i],t,{type:n.type})}},prepareMessageFilesAsync:function(e,t,n,i){for(var r=this,a=Promise.resolve([]),o=0;o<n.length;){var s=[n[o]];++o,a=a.then(function(t){return function(n){return r.prepareMessageFileAsync(t[0].file,t[0].thumb,e,i).then(function(e){return n.push(e),n})}}(s))}return a.then(function(e){if(e.length!=n.length){return Promise.reject({code:400,message:"uploaded files count is invalid."})}var i={files:e};return null!=t&&t.length>0&&(i.text=t),Promise.resolve(i)})},prepareMessageFileAsync:function(e,t,n,i){var r=this;return e=this.validateFileName(e),new Promise(function(e,i){null!=t?r.uploadFile(t.file,n,di.THUMBNAIL,function(n){t.setAuth(n),e(Za.Some(t))},function(t){e(Za.None)}):e(Za.None)}).then(function(t){return new Promise(function(a,o){var s=i?di.SCHEDULE_MESSAGE:di.MESSAGE;r.uploadFile(e,n,s,function(n){var i=kr.normalizeForFile(e.name),r=C.createFileInfoDynamic(e,i,t,n);a(r)},o)})})},prepareNoteFileAsync:function(e,t,n){var i=this;return e=this.validateFileName(e),new Promise(function(e,r){null!=t?i.uploadFile(t.file,n,di.NOTE_THUMBNAIL,function(n){t.setAuth(n),e(Za.Some(t))},function(t){e(Za.None)}):e(Za.None)}).then(function(t){return new Promise(function(r,a){i.uploadFile(e,n,di.NOTE_ATTACHMENT,function(n){var i=kr.normalizeForFile(e.name),a=C.createFileInfoDynamic(e,i,t,n);r(a)},a)})})},uploadFile:function(e,t,n,i,r){var a=this,o=e,l=kr.normalizeForFile(o.name),u=o.type,c=o.size;this.wsApi.createUploadAuth(l,u,c,t,n).then(function(t){a.fileService.upload(t,u,e).then(function(e){i(t.rawValue)},function(e){var t="failed to upload: "+g.string(e);Ar._e("["+s.dateStr(new Date)+"] ",t,"","","","");var i=new ua({code:null,detail:null,message:e});if(n!=di.THUMBNAIL&&n!=di.NOTE_THUMBNAIL&&n!=di.NOTE_ATTACHMENT){var o=n==di.SCHEDULE_MESSAGE?qt.ScheduleMessageFailed(Qt.GeneralFileError):qt.GeneralFileError,l=ca.toLocalError(o,i);a.sendNotification("error_occurred",l)}r(i)})},function(e){if(n!=di.THUMBNAIL&&n!=di.NOTE_THUMBNAIL&&n!=di.NOTE_ATTACHMENT&&null!=e)if(502==e.code&&null!=e.detail){var t=R.fromIntOrInt64(e.detail.limit_max);if("file_size"==e.detail.limit_target){var i=n==di.SCHEDULE_MESSAGE?qt.ScheduleMessageFailed(Qt.UploadSizeOvered(t)):qt.UploadSizeOvered(t),o=ca.toLocalError(i,e);a.sendNotification("error_occurred",o)}else if("storage_size"==e.detail.limit_target){var s=n==di.SCHEDULE_MESSAGE?qt.ScheduleMessageFailed(Qt.StorageSizeOvered(t)):qt.StorageSizeOvered(t),l=ca.toLocalError(s,e);a.sendNotification("error_occurred",l)}}else a.sendNotification("error_occurred",e);r(e)})},createDownloadAuth:function(e,t,n,i,r){this.wsApi.createDownloadAuth(e,t,n).then(function(e){i(e)},function(e){r(e)})},deleteAttachment:function(e,t){var n=this;this.wsApi.deleteAttachment(e,t).then(function(e){},function(e){n.apiCaller.handleServerErrorDefault(e)})},getAttachments:function(e,t){var n=this;null==t&&(t={sinceId:null,maxId:null}),this.wsApi.getAttachments(e,20,t.sinceId,t.maxId).then(function(t){l.iter(t,function(e){n.dataStore.setTalkFileInfo(e,!0)}),n.sendNotification("get_file_responsed",{talkId:e,files:t})},function(e){n.apiCaller.handleServerErrorDefault(e)})},createAnnouncement:function(e,t,n,i){var r=this;if(null!=e||null!=(e=this.settings.getSelectedDomainId())){var a=this.dataFactory.newDummyMessage(null,t,n);this.sendNotification("create_announcement_start",a),this.wsApi.createAnnouncement(e,t,n).then(function(e){r.sendNotification("create_announcement_complete",[e,a.id],i)},function(e){r.sendNotification("create_announcement_fail",a),r.sendNotification("error_occurred",e)})}},getAnnouncements:function(e,t,n){var i=this,r=this.settings.getSelectedDomainId();null!=r&&(e=null==e?{sinceId:null,maxId:null}:e,this.wsApi.getAnnouncements(r,20,e,t).then(function(e){l.iter(e,Ro(ko=i.dataStore,ko.setAnnouncement)),i.sendNotification("notify_get_announcements",{domainId:r,announcements:e,sortOrder:t,callerKey:n})},function(e){i.apiCaller.handleServerErrorDefault(e)}))},getAnnouncementStatuses:function(e){var t=this;this.wsApi.getAnnouncementStatuses().then(function(n){l.iter(n,function(e){t.dataStore.setAnnouncementStatus(e),t.sendAnnouncementStatusNotification(e)}),null!=e&&e()},function(e){t.apiCaller.handleServerErrorDefault(e)})},getAnnouncementStatus:function(e,t){var n=this;this.wsApi.getAnnouncementStatus(e).then(function(e){n.dataStore.setAnnouncementStatus(e),n.sendAnnouncementStatusNotification(e),null!=t&&t()},function(e){n.apiCaller.handleServerErrorDefault(e)})},updateAnnouncementReadStatus:function(e,t){var n=this;this.wsApi.updateAnnouncementReadStatus(e,t).then(function(i){var r,a=n.dataStore.getAnnouncementStatus(e);if(null!=a){var o=a.maxReadAnnouncementId;r=null!=o&&null!=t&&o.high==t.high&&o.low==t.low}else r=!1;r&&n.sendAnnouncementStatusNotification(a)},function(e){n.apiCaller.handleServerErrorDefault(e)})},getQuestions:function(e,t,n,i){var r=this,a=this.settings.getSelectedDomainId(),o=null;null!=e&&(a=e.domainId,o=e.id);var s=P.orNull(yn.filterToOpBool(n));i=null==i?{sinceId:null,maxId:null}:i,this.wsApi.getQuestions(a,o,t,s,20,i).then(function(e){l.iter(e,Ro(ko=r.dataStore,ko.setQuestion)),r.sendNotification("get_questions_responsed",{domainId:a,talkId:o,questions:e,fromType:t,filter:n})},function(e){r.apiCaller.handleServerErrorDefault(e)})},getQuestion:function(e,t){var n=this;this.wsApi.getQuestion(e).then(function(e){n.dataStore.setQuestion(e),n.sendNotification("notify_update_question",e),null!=t&&t(e)},function(e){n.apiCaller.handleServerErrorDefault(e)})},searchMessages:function(e,t,n,i){var r=this;this.searchService.prepareForSearching(e,n),this.apiCaller.call("search_messages",[e.domainId,e.talkId,e.getQueryText(),t,n],function(t){r.searchService.isRecentParams(e)&&r.searchService.isSearching()&&r.searchService.saveSearchMessagesResult(new Mn(t)),null!=i&&i()},function(a){r.searchService.notifySearchMessagesFail(),400!=a.code||null==n?r.sendNotification("error_occurred",a):r.searchMessages(e,t,null,i)})},searchAttachments:function(e,t,n,i){var r=this;this.searchService.prepareForSearching(e,n),this.apiCaller.call("search_attachments",[e.domainId,e.talkId,e.getQueryText(),t,n],function(t){r.searchService.isRecentParams(e)&&r.searchService.isSearching()&&r.searchService.saveSearchAttachmentsResult(new Dn(t)),null!=i&&i()},function(a){r.searchService.notifySearchAttachmentsFail(),400!=a.code||null==n?r.sendNotification("error_occurred",a):r.searchAttachments(e,t,null,i)})},startUpdateLastUsedAtIfNeed:function(){this.lastUsedAtUpdater.startPolling(Ro(this,this.updateLastUsedAt))},updateLastUsedAt:function(){var e=this;this.apiCaller.call("update_last_used_at",[],function(t){e.lastUsedAtUpdater.update()},function(t){e.lastUsedAtUpdater.cancel(),e.apiCaller.handleServerErrorDefault(t)})},addFavoriteTalk:function(e,t){this.apiCaller.call("add_favorite_talk",[e,t])},deleteFavoriteTalk:function(e,t){this.apiCaller.call("delete_favorite_talk",[e,t])},disablePushNotification:function(e,t){this.apiCaller.call("disable_push_notification",[e,t])},enablePushNotification:function(e,t,n){this.apiCaller.call("enable_push_notification",[e,t,vn.toRawValue(n)])},getSolutions:function(e,t){var n=this;l.iter(t,Ro(ko=this.dataStore,ko.addLoadingSolutionId)),this.wsApi.getSolutions(e,t).then(function(e){l.iter(e,Ro(ko=n.dataStore,ko.setSolution)),l.iter(t,Ro(ko=n.dataStore,ko.removeLoadingSolutionId)),n.sendNotification("solutions_loaded")},function(e){l.iter(t,Ro(ko=n.dataStore,ko.removeLoadingSolutionId)),n.apiCaller.handleServerErrorDefault(e)})},getPresences:function(e,t){var n=this;return this.wsApi.getPresences(e,t).then(function(e){return l.iter(e,Ro(ko=n.dataStore,ko.setUserPresence)),n.sendNotification("presences_updated",t),Promise.resolve(t)},function(e){return n.apiCaller.handleServerErrorDefault(e),Promise.reject(e)})},joinConference:function(e,t){var n=this;this.apiCaller.call("join_conference",[e,t],function(t){var i=new jt(t);n.sendNotification("join_conference_responsed",{talkId:e,joinConference:i})},function(e){n.sendNotification("join_conference_canceled",e)})},rejectConference:function(e){var t=this;this.apiCaller.call("reject_conference",[e],function(e){},function(e){404!=e.code&&409!=e.code&&t.sendNotification("error_occurred",e)})},leaveConference:function(e){var t=this;this.apiCaller.call("leave_conference",[e],function(e){},function(e){404!=e.code&&t.sendNotification("error_occurred",e)})},getConferences:function(){var e=this;this.wsApi.getConferences().then(function(t){l.iter(t,function(t){e.dataStore.addConference(t),e.sendNotification("notify_open_conference",t)}),e.dataStore.filterReactedConferenceIds(t.filter(function(t){return!e.dataStore.isReactedConferenceId(t.id)}).map(function(e){return e.id}))},function(t){e.apiCaller.handleServerErrorDefault(t)})},getConferenceParticipants:function(e){var t=this;this.apiCaller.call("get_conference_participants",[e],function(n){var i=t.dataStore.getConference(e);null!=i&&(i.participants=n,t.sendNotification("get_conference_participants_responsed",i))})},getNoteStatuses:function(e,t){var n=this.settings.getSelectedDomainId();this.apiNote.getNoteStatuses(n,e,t).catch(function(e){})},getNote:function(e,t){var n=null!=t?t:function(e,t){};this.apiNote.getNote(e).then(function(e){n(null,e)}).catch(function(e){n(e,null)})},createNote:function(e,t,n,i,r){Ar._w("["+s.dateStr(new Date)+"] ","'createNote' is deprecated, please use 'res.send' instead.","","","",""),this.apiNote.createNote(e,t,n,i,r).catch(function(e){})},createNoteV2:function(e,t,n,i){var r=this,a=this.dataStore.getTalk(t.getTalkId());if(null!=a){var o=a.domainId,s=t.getNoteId();this.dataStore.setNoteLocalEdit(s,t);for(var l=Promise.resolve(),u=0,c=t.getUnuploadedFileInfos();u<c.length;){var _=[c[u]];++u,l=l.then(function(e){return function(n){return r.prepareNoteFileAsync(e[0].file,e[0].localThumbInfo,o).then((a=e,function(e){a[0].setUploadResult(Pt.SUCCESS(e))})).catch((i=e,function(e){i[0].setUploadResult(Pt.FAILUER);var n=Jt.convertFileErrorForNote(s,e);if(null!=n){t.setState(tr.FAILED_BY_FILE(i[0].id,n)),r.dataStore.setNoteLocalEdit(s,t);var a=ca.toLocalError(n,e);r.sendNotification("error_occurred",a)}return Promise.reject(e)}));var i,a}}(_))}var h=null!=i?i:function(e,t){};l.then(function(i){var a=r.apiNote,o=t.getTitle(),s=t.getContentType(),l=t.getContent();return a.createNote(e,o,s,l,n,t)}).then(function(e){h(null,e)}).catch(function(e){h(e,null)})}},updateNoteSetting:function(e,t,n){this.apiNote.updateNoteSetting(e,t,n).catch(function(e){})},updateNote:function(e,t,n,i,r,a){this.apiNote.updateNote(e,t,n,i,r,a).catch(function(e){})},updateNoteV2:function(e,t,n,i,r){var a=this,o=this.dataStore.getTalk(n.getTalkId());if(null==o)return Promise.resolve();var s=o.domainId;this.dataStore.setNoteLocalEdit(e,n);for(var l=Promise.resolve(),u=0,c=n.getUnuploadedFileInfos();u<c.length;){var _=[c[u]];++u,l=l.then(function(t){return function(i){return a.prepareNoteFileAsync(t[0].file,t[0].localThumbInfo,s).then((o=t,function(e){o[0].setUploadResult(Pt.SUCCESS(e))})).catch((r=t,function(t){r[0].setUploadResult(Pt.FAILUER);var i=Jt.convertFileErrorForNote(e,t);if(null!=i){n.setState(tr.FAILED_BY_FILE(r[0].id,i)),a.dataStore.setNoteLocalEdit(e,n);var o=ca.toLocalError(i,t);a.sendNotification("error_occurred",o)}return Promise.reject(t)}));var r,o}}(_))}var h=null!=r?r:function(e,t){};return l.then(function(r){var o=a.apiNote,s=n.getTitle(),l=n.getContentType(),u=n.getContent();return o.updateNote(e,t,s,l,u,i,n)}).then(function(e){h(null,e)}).catch(function(n){return h(n,null),409==n.code&&"locked by another user"==n.message?Promise.reject(n):a.unlockNote(e,t).then(function(e){})}).catch(function(e){})},deleteNote:function(e,t){var n=null!=t?t:function(e,t){};this.apiNote.deleteNote(e).then(function(e){n(null,e)}).catch(function(e){n(e,null)})},lockNote:function(e,t){var n=this.settings.getSelectedDomainId();return this.apiNote.lockNote(n,e,t)},unlockNote:function(e,t){var n=this.settings.getSelectedDomainId();return this.apiNote.unlockNote(n,e,t)},addFavoriteMessage:function(e,t,n){var i=this;this.apiCaller.call("add_favorite_message",[e,t,n],function(e){i.sendNotification("add_favorite_message_completed",new Si(e))},function(e){400==e.code&&e.message,400==e.code&&e.message,403==e.code&&e.message,e.code;409==e.code&&"conflict"==e.message||i.sendNotification("error_occurred",e)})},deleteFavoriteMessage:function(e,t){var n=this;this.apiCaller.call("delete_favorite_message",[e,t],function(e){n.sendNotification("delete_favorite_message_completed",new yi(e))},function(e){e.code,e.code;n.sendNotification("error_occurred",e)})},getFavoriteMessages:function(e,t,n){var i=this;this.apiCaller.call("get_favorite_messages",[e,t,20,n],function(n){var r=n.marker,a=n.next_marker,o=n.contents.map(function(e){return new Zt(e)});l.iter(o,Ro(ko=i.dataStore,ko.setMessage));var s=new wi(e,t,r,a,o);i.sendNotification("get_favorite_messages_completed",s)},function(e){e.code;i.sendNotification("error_occurred",e)})},scheduleFileMessage:function(e,t,n,i){var r=this,a=this.dataFactory.newDummyFileMessage(n,i,e);this.sendNotification("schedule_message_started",a),this.prepareMessageFileAsync(i.file,i.thumb,t,!0).then(function(t){r._scheduleMessage(e,n,$t.file,t,a)},function(e){r.sendNotification("schedule_message_faileed",[e,a])})},scheduleFilesMessage:function(e,t,n,i,r){var a=this,o=this.dataFactory.newDummyMultipleFileMessage(n,i,r,e);this.sendNotification("schedule_message_started",o),this.prepareMessageFilesAsync(t,i,r,!0).then(function(t){a._scheduleMessage(e,n,$t.textMultipleFile,t,o)},function(e){a.sendNotification("schedule_message_faileed",[e,o])})},scheduleMessage:function(e,t,n,i){var r=this.dataFactory.newDummyMessage(t,n,i,e);this.sendNotification("schedule_message_started",r),this._scheduleMessage(e,t,n,i,r)},_scheduleMessage:function(e,t,n,i,r){var a=this;this.wsApi.scheduleMessage(e,t,n,i).then(function(e){a.dataStore.setScheduledMessage(e),a.sendNotification("schedule_message_completed",[e,r.id])},function(e){if(a.sendNotification("schedule_message_faileed",[e,r]),400!=e.code)if(403!=e.code)if(409!=e.code)if(502!=e.code)a.apiCaller.handleServerErrorDefault(e);else{var t=qt.ScheduleMessageFailed(Qt.LimitReached),n=ca.toLocalError(t,e);a.sendNotification("error_occurred",n)}else{var i=qt.ScheduleMessageFailed(Qt.Conflict),o=ca.toLocalError(i,e);a.sendNotification("error_occurred",o)}else{var s=qt.ScheduleMessageFailed(Qt.Unknown),l=ca.toLocalError(s,e);a.sendNotification("error_occurred",l)}else{var u=qt.ScheduleMessageFailed(Qt.InvalidCreateAt),c=ca.toLocalError(u,e);a.sendNotification("error_occurred",c)}})},deleteScheduledMessage:function(e){var t=this;this.wsApi.deleteScheduledMessage(e).then(function(n){var i=t.dataStore.removeScheduledMessage(e);t.sendNotification("delete_scheduled_messages_completed",i)},function(e){t.apiCaller.handleServerErrorDefault(e)})},getScheduledMessages:function(e,t,n){var i=this;this.wsApi.getScheduledMessages(e,t,10,null).then(function(t){n&&i.dataStore.removeScheduledMessagesInDomain(e),l.iter(t.contents,Ro(ko=i.dataStore,ko.setScheduledMessage)),i.sendNotification("get_scheduled_messages_completed",t)},function(e){i.sendNotification("get_scheduled_messages_failed"),i.apiCaller.handleServerErrorDefault(e)})},getStampsets:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.call("get_stampsets",[e],function(e){var i=e.map(Wn.originalStampset);t.dataStore.addStampsets(i),n(i)},function(e){i(e)})})},setMessageReaction:function(e,t,n){var i=this,r=this.dataStore.getMessageReactionSummary(t);this.wsApi.setMessageReaction(e,t,n).then(function(a){null!=r&&(r.updateMyReaction(n),i.dataStore.removeMessageReactionUsers(t)),i.sendNotification("set_message_reaction_completed",[e,t])},function(e){i.sendNotification("set_message_reaction_failed");var t=r.hasMyReaction()?qt.FailedToChangeReaction:qt.FailedToAddReaction,n=ca.toLocalError(t,e);i.sendNotification("error_occurred",n)})},resetMessageReaction:function(e,t){var n=this;this.wsApi.resetMessageReaction(e,t).then(function(i){var r=n.dataStore.getMessageReactionSummary(t);null!=r&&(r.updateMyReaction(null),n.dataStore.removeMessageReactionUsers(t)),n.sendNotification("reset_message_reaction_completed",[e,t])},function(e){n.sendNotification("reset_message_reaction_failed");var t=ca.toLocalError(qt.FailedToCancelReaction,e);n.sendNotification("error_occurred",t)})},getMessageReactionSummaries:function(e,t){var n=this;l.iter(t,Ro(ko=this.dataStore,ko.addLoadingMessageReactionSmmary)),this.wsApi.getMessageReactionSummaries(e,t).then(function(i){l.iter(t,Ro(ko=n.dataStore,ko.removeLoadingMessageReactionSmmary)),l.iter(i,function(e){n.dataStore.setMessageReactionSummary(e)}),n.sendNotification("get_message_reaction_summaries_completed",[e,t])},function(e){l.iter(t,Ro(ko=n.dataStore,ko.removeLoadingMessageReactionSmmary)),n.sendNotification("get_message_reaction_summaries_failed")})},getMessageReactionUsers:function(e,t){var n=this;return this.wsApi.getMessageReactionUsers(e,t).then(function(e){return n.dataStore.setMessageReactionUsers(e),Promise.resolve(e)},function(e){return Promise.reject(e)})},getAvailableMessageReactions:function(e){var t=this;this.wsApi.getAvailableMessageReactions(e).then(function(n){t.dataStore.updateAvailableMessageReactions(e,n)},function(e){t.apiCaller.handleServerErrorDefault(e)})},getFlowNotificationBadges:function(e){var t=this;return this._getFlowNotificationBadges(e).then(function(e){t.sendNotification("get_flow_notification_badges_completed")},function(e){t.apiCaller.handleServerErrorDefault(e),t.sendNotification("get_flow_notification_badges_failed")})},_getFlowNotificationBadges:function(e){var t=this;if(0==e.length)return Promise.resolve();var n=e.slice(0,100),i=e.slice(100);return new Promise(function(e,i){t.apiCaller.call("get_flow_notification_badges",[n],function(n){var i=n.map(function(e){return new Gt(e)});l.iter(i,function(e){t.dataStore.setFlowNotificationBadge(e.domainId,e)}),Mr.resolveVoid(e)},function(e){i(e)})}).then(function(e){return t._getFlowNotificationBadges(i)})},getDirectApps:function(e){var t=this;return 0==e.length?Promise.resolve([]):new Promise(function(n,i){t.apiCaller.call("get_direct_apps",[e],function(e){var i=t.settings.getBrowserSettings().language,r=e.map(function(e){return new ft(e,i)});l.iter(r,function(e){t.dataStore.setDirectApp(e.id,e)}),t.sendNotification("get_direct_apps_completed"),n(r)},function(e){t.sendNotification("get_direct_apps_failed"),t.sendNotification("error_occurred",e),i(e)})})},getFilePreview:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.call("get_file_preview",[e],function(e){n(new Ri(e))},function(e){i(e)})})},createFilePreview:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.call("create_file_preview",[e],function(i){var r=new Ri(i);t.dataStore.setFilePreview(e,r),n(r)},function(e){i(e)})})},asInt:function(e){return ho.__cast(e,Go)},__class__:zr});var Yr=function(){this.callbacksWhenCreateSessionSucceed=[],this.createSessionSucceed=!1,Br.call(this,"apiCaller")};n["albero.proxy.ApiCallerProxy"]=Yr,Yr.__name__=["albero","proxy","ApiCallerProxy"],Yr.delayForReplicationLag=function(){return Mr.delay(500)},Yr.__super__=Br,Yr.prototype=r(Br.prototype,{onSessionClear:function(){this.createSessionSucceed=!1},onSessionCreated:function(){this.createSessionSucceed=!0},fireCallbacksWaitingForSession:function(){l.iter(this.callbacksWhenCreateSessionSucceed,function(e){e()}),this.callbacksWhenCreateSessionSucceed.splice(0,this.callbacksWhenCreateSessionSucceed.length)},callImmediately:function(e,t,n,i){this.rpc.call(e,t,n,i)},callImmediatelyReliable:function(e,t,n,i,r,a){null==a&&(a=3);var o=this,s=this.createOnErrorReliable(a,i,r,function(s){Ya.delay(function(){o.callImmediatelyReliable(e,t,n,i,r,a-1)},s)});this.callImmediately(e,t,n,s)},call:function(e,t,n,i){var r=Ro(ko=this.rpc,ko.call),a=e,o=t,s=n,l=i,u=function(){r(a,o,s,l)};this.createSessionSucceed?u():this.callbacksWhenCreateSessionSucceed.push(u)},callApiReliable:function(e,t,n,i,r,a){null==a&&(a=3);var o=this,s=this.createOnErrorReliable(a,i,r,function(s){Ya.delay(function(){o.callApiReliable(e,t,n,i,r,a-1)},s)});this.call(e,t,n,s)},createOnErrorReliable:function(e,t,n,i){var r=this;return null==n&&(n=function(e){return 404==e.code?Za.Some(r.retryTimeForReplicationLag()):Za.None}),null==t&&(t=Ro(this,this.handleServerErrorDefault)),function(r){if(0!=e){var a=n(r);P.isEmpty(a)?t(r):P.foreach(a,i)}else t(r)}},handleServerErrorDefault:function(e){this.rpc.onServerError(e)},restart:function(){this.rpc.restart()},retryTimeForReplicationLag:function(){return 1e3},__class__:Yr});var Kr=function(){Br.call(this,"apiNote")};n["albero.proxy.ApiNoteProxy"]=Kr,Kr.__name__=["albero","proxy","ApiNoteProxy"],Kr.__super__=Br,Kr.prototype=r(Br.prototype,{getNoteStatuses:function(e,t,n){var i=this;return new Promise(function(r,a){i.apiCaller.call("get_note_statuses",[e,t,60,n],function(e){r(new Mi(e))},a)}).then(function(e){if(e.isNotEmptyNoteStatuses())for(var n=0,r=e.noteStatuses;n<r.length;){var a=r[n];++n,i.dataStore.setNoteRevisionSummary(a.noteId,a.getNoteRevisionSummary())}return i.sendNotification("get_note_statuses_loaded",{talkId:t,result:e}),e},function(e){return i.sendNotification("error_occurred",e),Promise.reject(e)})},getNote:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.call("get_note",[e.value],function(e){n(new Di(e))},i)}).then(function(e){return t.dataStore.setNote(e.getNoteId(),e.note),t.sendNotification("get_note_loaded",e),e},function(n){return 404==n.code?(t.dataStore.setNote(e,null),t.sendNotification("get_note_failed_by_note_not_found",e),Promise.reject(n)):(t.sendNotification("error_occurred",n),Promise.reject(n))})},createNote:function(e,t,n,i,r,a){var o=this;return new Promise(function(a,s){var l=Zi.getValue(n);o.apiCaller.callApiReliable("create_note",[e,t,l,i,r],function(e){a(new Ai(e))},s,Ro(o,o.retryTimeForCreateOrUpdateNoteFromError))}).then(function(e){var t;return null!=a&&o.dataStore.setNoteLocalEdit(a.getNoteId(),null),t=null!=a&&a.hasEmitterKey()?e.updateWithEmitterKey(a.getEmitterKey()):e,o.sendNotification("create_note_completed",t),e},function(e){if(null!=a&&(a.setState(tr.FAILED_BY_UNKNOWN),o.dataStore.setNoteLocalEdit(a.getNoteId(),a)),null!=a&&a.hasEmitterKey()){var t=o.dataStore.me.id,n=a.getEmitterKey();o.sendNotification("create_note_failed",new Ni(t,e,n))}if(null!=a&&a.getFileInfos().length>0&&400==e.code&&"invalid file_id"==e.message&&(a.setState(tr.FAILED_BY_NOT_FOUND_FORWARDING),o.dataStore.setNoteLocalEdit(a.getNoteId(),a)),null!=a&&400==e.code&&"invalid talk_id"==e.message){var i=Jt.getNoteForwardingForbiddenError(),r=ca.toLocalError(i,e);return o.sendNotification("error_occurred",r),Promise.reject(e)}return o.sendNotification("error_occurred",e),Promise.reject(e)})},updateNoteSetting:function(e,t,n){var i=this;return new Promise(function(r,a){i.apiCaller.call("update_note_setting",[e.value,t,n],function(e){r(new ki(e))},a)}).then(function(e){return i.sendNotification("update_note_setting_completed",e),e},function(t){return 404==t.code?(i.dataStore.setNote(e,null),i.sendNotification("update_note_setting_failed_by_not_found",e),Promise.reject(t)):409==t.code&&"conflict"==t.message?(i.dataStore.setNote(e,null),i.sendNotification("update_note_setting_failed_by_conflict",e),Promise.reject(t)):409==t.code&&"locked by another user"==t.message&&null!=t.detail&&null!=t.detail.user_id&&null!=t.detail.device_id?(i.sendNotification("update_note_setting_failed_by_editing",e),Promise.reject(t)):(i.sendNotification("error_occurred",t),Promise.reject(t))})},updateNote:function(e,t,n,i,r,a,o){var s=this;return new Promise(function(o,l){var u=Zi.getValue(i);s.apiCaller.callApiReliable("update_note",[e.value,t,n,u,r,a],function(e){o(new Ci(e))},l,Ro(s,s.retryTimeForCreateOrUpdateNoteFromError))}).then(function(t){return null!=o&&s.dataStore.setNoteLocalEdit(e,null),s.dataStore.setNote(e,t.note),s.sendNotification("update_note_completed",t),t},function(t){return 404==t.code?(null!=o?(o.setState(tr.FAILED_BY_NOT_FOUND),s.dataStore.setNoteLocalEdit(e,o)):s.dataStore.setNote(e,null),Promise.reject(t)):409==t.code&&"conflict"==t.message?(null!=o?(o.setState(tr.FAILED_BY_CONFLICT),s.dataStore.setNoteLocalEdit(e,o)):s.dataStore.setNote(e,null),Promise.reject(t)):409==t.code&&"locked by another user"==t.message&&null!=t.detail&&null!=t.detail.user_id&&null!=t.detail.device_id?(null!=o&&(o.setState(tr.FAILED_BY_CONFLICT),s.dataStore.setNoteLocalEdit(e,o)),Promise.reject(t)):(null!=o&&(o.setState(tr.FAILED_BY_UNKNOWN),s.dataStore.setNoteLocalEdit(e,o)),s.sendNotification("error_occurred",t),Promise.reject(t))})},deleteNote:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.call("delete_note",[e.value],function(e){n(new bi(e))},i)}).then(function(e){return t.sendNotification("delete_note_completed",e),e},function(n){return 404==n.code&&t.dataStore.setNote(e,null),t.sendNotification("error_occurred",n),Promise.reject(n)})},lockNote:function(e,t,n){var i=this;return new Promise(function(e,r){i.apiCaller.call("lock_note",[t.value,n],e,r)}).then(function(e){var r=i.dataStore.getNote(t);if(null!=r){var a=i.dataStore.me.id,o=i.settings.getDeviceId();r.lock(n,a,o,e)}return new ar(rr.COMPLETED(new ir(e)))}).catch(function(n){if(400==n.code)return i.sendNotification("error_occurred",n),new ar(rr.FAILED_BY_UNKNOWN);if(403==n.code)return i.sendNotification("error_occurred",n),new ar(rr.FAILED_BY_UNKNOWN);if(404==n.code)return i.dataStore.setNote(t,null),new ar(rr.FAILED_BY_NOT_FOUND);if(409==n.code&&"locked by another user"==n.message&&null!=n.detail&&null!=n.detail.user_id&&null!=n.detail.device_id){var r=i.dataStore.getUser(e,n.detail.user_id);return new ar(rr.FAILED_BY_LOCKED(r))}return 409==n.code&&"conflict"==n.message?new ar(rr.FAILED_BY_CONFLICT):(i.sendNotification("error_occurred",n),new ar(rr.FAILED_BY_UNKNOWN))})},unlockNote:function(e,t,n){var i=this;return new Promise(function(e,r){i.apiCaller.call("unlock_note",[t.value,n],e,r)}).then(function(e){var r=i.dataStore.getNote(t);return null!=r&&r.unlock(n,i.dataStore.me.id),new ar(rr.RELEASED)}).catch(function(n){if(400==n.code)return i.sendNotification("error_occurred",n),new ar(rr.FAILED_BY_UNKNOWN);if(403==n.code)return i.sendNotification("error_occurred",n),new ar(rr.FAILED_BY_UNKNOWN);if(404==n.code)return i.dataStore.setNote(t,null),new ar(rr.FAILED_BY_NOT_FOUND);if(409==n.code&&"conflict"==n.message)return new ar(rr.FAILED_BY_CONFLICT);if(409==n.code&&"locked by another user"==n.message&&null!=n.detail&&null!=n.detail.user_id&&null!=n.detail.device_id){var r=i.dataStore.getUser(e,n.detail.user_id);return new ar(rr.FAILED_BY_LOCKED(r))}return i.sendNotification("error_occurred",n),new ar(rr.FAILED_BY_UNKNOWN)})},retryTimeForCreateOrUpdateNoteFromError:function(e){return this.shouldRetryCreateOrUpdateNote(e)?Za.Some(this.apiCaller.retryTimeForReplicationLag()):Za.None},shouldRetryCreateOrUpdateNote:function(e){return null!=e.code&&(500==e.code?"Internal Error (IllegalStateException)"==e.message:400==e.code&&"invalid file_id"==e.message)},__class__:Kr});var Wr=function(){Br.call(this,"appState")};n["albero.proxy.AppStateProxy"]=Wr,Wr.__name__=["albero","proxy","AppStateProxy"],Wr.__super__=Br,Wr.prototype=r(Br.prototype,{start:function(){this.updateLastActivityAt(),this.checkInactiveInterval()},activateAppIfNeed:function(){this.updateLastActivityAt(),this.appState==N.Inactive&&this.setAppState(N.Active)},setAppState:function(e){this.appState=e,this.sendNotification("app_state_changed",this.appState)},updateLastActivityAt:function(){this.lastActivityAt=new Date},checkInactiveInterval:function(){this.checkInactive(),new Ya(500).run=Ro(this,this.checkInactive)},checkInactive:function(){this.appState!=N.Inactive&&((new Date).getTime()-this.lastActivityAt.getTime()<2e3||this.setAppState(N.Inactive))},__class__:Wr});var jr=function(){var e=new pi(-1,-1);this.dummyFileId=e;var t=new pi(-1,-1);this.dummyMsgId=t,Br.call(this,"dataFactory")};n["albero.proxy.DataFactoryProxy"]=jr,jr.__name__=["albero","proxy","DataFactoryProxy"],jr.__super__=Br,jr.prototype=r(Br.prototype,{onRegister:function(){},newDomainUser:function(e){return new Ct(e)},newDummyMessage:function(e,t,n,i){var r=this,a=new Zt;a.id=this.dummyMsgId,a.userId=this.dataStore.me.id,a.talkId=e,a.type=t,a.content=n,a.scheduleAt=i;var o,s=this.dummyMsgId;if(null==s)o=null;else{var l=new pi(0,1),u=s.high-l.high|0,c=s.low-l.low|0;if(Ba.ucompare(s.low,l.low)<0){u--;u|=0}o=new pi(u,c)}this.dummyMsgId=o;var _=[];switch(a.type[1]){case 4:_=[this.createDummyFileInfo(a,a.content)];break;case 5:_=ho.__cast(a.content.files,Array).map(function(e){return r.createDummyFileInfo(a,e)})}return this.dataStore.setMessageWithFileInfos(a,_),a},newDummyFileMessage:function(e,t,n){var i=this.createFileInfoDynamic(t);return this.newDummyMessage(e,$t.file,i,n)},newDummyMultipleFileMessage:function(e,t,n,i){var r=l.array(n.filter(function(e){return null!=e.file}).map(Ro(this,this.createFileInfoDynamic)));return this.newDummyMessage(e,$t.textMultipleFile,{text:t,files:r},i)},createFileInfoDynamic:function(e){var t=e.file;return{content_type:t.type,content_size:t.size,name:kr.normalizeForFile(t.name),file:t,localThumbInfo:e.thumb}},createDummyFileInfo:function(e,t){var n,i=xt.fromMessageAndFileWithFileId(e,t,this.dummyFileId),r=this.dummyFileId;if(null==r)n=null;else{var a=new pi(0,1),o=r.high-a.high|0,s=r.low-a.low|0;if(Ba.ucompare(r.low,a.low)<0){o--;o|=0}n=new pi(o,s)}return this.dummyFileId=n,i},__class__:jr});var Vr=function(){this.departmentStore=new _t,this.stampStore=new Kn,this.questionStore=new An,this.fileInfoStore=new Bt,this.scheduledMessageStore=new Qi,this.messageReactionStore=new vr,this.announcementStore=new Xe,this.messageStore=new an,this.conferenceStore=new it,this.solutionStore=new Gn,this.directAppStore=new gt,this.flowNotificationBadgeStore=new Ht,Br.call(this,"dataStore")};n["albero.proxy.DataStoreProxy"]=Vr,Vr.__name__=["albero","proxy","DataStoreProxy"],Vr.__super__=Br,Vr.prototype=r(Br.prototype,{onRegister:function(){this.init()},setMe:function(e){this.me=e;for(var t=0,n=this.getDomains();t<n.length;){var i=n[t];++t,this.sendNotification("notify_update_user",this.me.toDomainUser(i.id))}this.sendNotification("current_user_changed",e),this.storageForUsers.setDirtyFlag()},getMe:function(){return this.me},isMe:function(e){if(null!=this.me){var t=this.me.id;return null!=t&&null!=e&&t.high==e.high&&t.low==e.low}return!1},getFriendsOrAcquaintances:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=Jo[t]?n.getReserved(t):n.h[t],r=[];if(null!=i)for(var a=new $a(i,i.arrayKeys());a.hasNext();){var o=a.next();0!=o.type&&1!=o.type||r.push(o.user)}return r},getFriends:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=Jo[t]?n.getReserved(t):n.h[t],r=[];if(null!=i)for(var a=new $a(i,i.arrayKeys());a.hasNext();){var o=a.next();0==o.type&&r.push(o.user)}return r},getAcquaintances:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=Jo[t]?n.getReserved(t):n.h[t],r=[];if(null!=i)for(var a=new $a(i,i.arrayKeys());a.hasNext();){var o=a.next();1==o.type&&r.push(o.user)}return r},isFriend:function(e,t){var n="_"+e.high+"_"+e.low,i=this.users,r=null!=Jo[n]?i.getReserved(n):i.h[n];if(null!=r){var a="_"+t.high+"_"+t.low,o=null!=Jo[a]?r.getReserved(a):r.h[a];return null!=o&&0==o.type}return!1},addFriend:function(e){var t=this.ensureDomainUserMap(e.domainId),n=e.id,i="_"+n.high+"_"+n.low,r={type:0,user:e};return null!=Jo[i]?t.setReserved(i,r):t.h[i]=r,this.storageForUsers.setDirtyFlag(),e},addAcquaintance:function(e){var t=this.ensureDomainUserMap(e.domainId),n=e.id,i="_"+n.high+"_"+n.low,r={type:1,user:e};return null!=Jo[i]?t.setReserved(i,r):t.h[i]=r,this.storageForUsers.setDirtyFlag(),e},ensureDomainUserMap:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=Jo[t]?n.getReserved(t):n.h[t];if(null==i){i=new eo;var r=this.users;null!=Jo[t]?r.setReserved(t,i):r.h[t]=i}return i},setUserIfLatest:function(e,t){null==e&&(e=this.ensureDomainUserMap(t.domainId));var n=t.id,i="_"+n.high+"_"+n.low,r=null!=Jo[i]?e.getReserved(i):e.h[i];if(null!=r){var a=t.updatedAt,o=r.user.updatedAt,s=a.high-o.high|0;s=0!=s?s:Ba.ucompare(a.low,o.low);var l=a.high<0?o.high<0?s:-1:o.high>=0?s:1;(l>1||2==r.type&&0!=l)&&(r.user=t,this.sendNotification("notify_update_user",t))}else{var u={type:2,user:t};null!=Jo[i]?e.setReserved(i,u):e.h[i]=u}this.storageForUsers.setDirtyFlag()},setUserPresence:function(e){null==this.userPresences&&(this.userPresences=new eo);var t=e.userId,n="_"+t.high+"_"+t.low,i=this.userPresences;null!=Jo[n]?i.setReserved(n,e):i.h[n]=e},getUserPresence:function(e){if(null==this.userPresences)return null;var t="_"+e.high+"_"+e.low,n=this.userPresences;return null!=Jo[t]?n.getReserved(t):n.h[t]},isDepartmentsChanged:function(e,t){return!R.eqArray(e.departments,t.departments)},setUsersIfLatest:function(e,t){var n=this.ensureDomainUserMap(e),i=Ro(this,this.setUserIfLatest),r=n;l.iter(t,function(e){i(r,e)})},clearDomainUsers:function(e){this.users.remove("_"+e.high+"_"+e.low)&&this.storageForUsers.setDirtyFlag()},clearUsersDepartments:function(e){var t="_"+e.high+"_"+e.low,n=this.users,i=null!=Jo[t]?n.getReserved(t):n.h[t];if(null!=i)for(var r=new $a(i,i.arrayKeys());r.hasNext();){var a=r.next();a.user.departments=null,this.sendNotification("notify_update_user",a.user)}this.storageForUsers.setDirtyFlag()},removeFriend:function(e,t){var n="_"+e.high+"_"+e.low,i=this.users,r=null!=Jo[n]?i.getReserved(n):i.h[n];if(null!=r){var a="_"+t.high+"_"+t.low,o=null!=Jo[a]?r.getReserved(a):r.h[a];null!=o&&(o.type=2)}this.storageForUsers.setDirtyFlag()},removeAcquaintance:function(e,t){this.removeFriend(e,t)},getUser:function(e,t){if(null==t)return null;var n,i=new pi(0,0);if(t.high==i.high&&t.low==i.low)return null;if(null!=this.me){var r=this.me.id;n=null!=r&&null!=t&&r.high==t.high&&r.low==t.low}else n=!1;if(n)return this.me.toDomainUser(e);var a="_"+e.high+"_"+e.low,o=this.users,s=null!=Jo[a]?o.getReserved(a):o.h[a];if(null!=s){var l="_"+t.high+"_"+t.low,u=null!=Jo[l]?s.getReserved(l):s.h[l];if(null!=u)return u.user}return null},getUsers:function(e,t){var n=this,i=function(e,t){var i="_"+e.high+"_"+e.low,r=n.users,a=null!=Jo[i]?r.getReserved(i):r.h[i];if(null!=a){if(null!=t)return t.map(function(t){var i=new pi(0,0);if(t.high==i.high&&t.low==i.low)return null;var r=n.me.id;if(null!=r&&null!=t&&r.high==t.high&&r.low==t.low)return n.me.toDomainUser(e);var o="_"+t.high+"_"+t.low,s=null!=Jo[o]?a.getReserved(o):a.h[o];return null!=s?s.user:null});for(var o=[],s=a.arrayKeys(),l=new $a(a,s);l.hasNext();)o.push(l.next().user);return o}return[]};if(null!=e)return i(e,t);for(var r=this.domains,a=new $a(r,r.arrayKeys()),o=null;a.hasNext();)o=null==o?i(a.next().id,t):o.concat(i(a.next().id,t));return null==o?[]:o},getTalk:function(e){var t="_"+e.high+"_"+e.low,n=this.talks;return null!=Jo[t]?n.getReserved(t):n.h[t]},getValidPairTalk:function(e,t){var n=this;return null==this.me?null:l.find(this.getTalks(),function(i){if(!w.enumEq(i.type,Zn.PairTalk))return!1;var r=i.domainId;return null!=r&&null!=t&&r.high==t.high&&r.low==t.low&&(!!l.exists(i.userIds,function(t){return null!=t&&null!=e&&t.high==e.high&&t.low==e.low})&&!!l.exists(i.userIds,function(e){var t=n.me.id;return null!=e&&null!=t&&e.high==t.high&&e.low==t.low}))})},setTalk:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.talks;if(null!=Jo[n]?i.setReserved(n,e):i.h[n]=e,null!=e.leftUsers)for(var r=this.ensureDomainUserMap(e.domainId),a=0,o=e.leftUsers;a<o.length;){var s=o[a];++a;var l=s.id,u="_"+l.high+"_"+l.low,c=null!=Jo[u]?r.getReserved(u):r.h[u];if(null!=c){var _;if(2==c.type){var h=s.updatedAt,d=c.user.updatedAt,f=h.high-d.high|0;f=0!=f?f:Ba.ucompare(h.low,d.low),_=(h.high<0?d.high<0?f:-1:d.high>=0?f:1)>0}else _=!1;_&&(c.user=s,this.storageForUsers.setDirtyFlag(),this.sendNotification("notify_update_user",s))}else{var m={type:2,user:s};null!=Jo[u]?r.setReserved(u,m):r.h[u]=m,this.storageForUsers.setDirtyFlag(),this.sendNotification("notify_update_user",s)}}return this.storageForTalks.setDirtyFlag(),e},getTalks:function(){for(var e=[],t=this.talks.keys();t.hasNext();){var n=t.next(),i=this.talks;e.push(null!=Jo[n]?i.getReserved(n):i.h[n])}return e},setTalks:function(e){l.iter(e,Ro(this,this.setTalk))},removeTalk:function(e){if(null!=this.domainUnreadCounts){var t="_"+e.high+"_"+e.low,n=this.talks,i=null!=Jo[t]?n.getReserved(t):n.h[t];if(null!=i){var r=i.domainId;this.domainUnreadCounts.remove("_"+r.high+"_"+r.low)}}this.questionStore.removeTalkQuestions(e),this.talks.remove("_"+e.high+"_"+e.low),this.storageForTalks.setDirtyFlag()},getTalkStatuses:function(){for(var e=[],t=this.talkStatuses.keys();t.hasNext();){var n=t.next(),i=this.talks;if(null!=Jo[n]?i.existsReserved(n):i.h.hasOwnProperty(n)){var r=this.talkStatuses;e.push(null!=Jo[n]?r.getReserved(n):r.h[n])}}return e},getTalkStatus:function(e){var t="_"+e.high+"_"+e.low,n=this.talkStatuses;return null!=Jo[t]?n.getReserved(t):n.h[t]},setTalkStatus:function(e){var t=e.id,n="_"+t.high+"_"+t.low;if(null!=this.domainUnreadCounts){var i=this.talks,r=null!=Jo[n]?i.getReserved(n):i.h[n];if(null!=r){var a=r.domainId;this.domainUnreadCounts.remove("_"+a.high+"_"+a.low)}}var o=this.talkStatuses;return null!=Jo[n]?o.setReserved(n,e):o.h[n]=e,this.sendNotification("brand_badge_changed"),this.storageForTalkStatuses.setDirtyFlag(),e},removeTalkStatus:function(e){var t="_"+e.high+"_"+e.low;if(null!=this.domainUnreadCounts){var n=this.talks,i=null!=Jo[t]?n.getReserved(t):n.h[t];if(null!=i){var r=i.domainId;this.domainUnreadCounts.remove("_"+r.high+"_"+r.low)}}this.talkStatuses.remove(t),this.storageForTalkStatuses.setDirtyFlag()},getDomains:function(){for(var e=[],t=this.domains,n=new $a(t,t.arrayKeys());n.hasNext();){var i=n.next();e.push(i)}return e},getDomain:function(e){var t="_"+e.high+"_"+e.low,n=this.domains;return null!=Jo[t]?n.getReserved(t):n.h[t]},setDomainIfLatest:function(e){var t,n=e.id,i="_"+n.high+"_"+n.low,r=this.domains,a=null!=Jo[i]?r.getReserved(i):r.h[i];if(null!=a){var o=e.updatedAt,s=a.updatedAt,l=o.high-s.high|0;l=0!=l?l:Ba.ucompare(o.low,s.low),t=(o.high<0?s.high<0?l:-1:s.high>=0?l:1)>=0}else t=!0;if(t){var u=this.domains;return null!=Jo[i]?u.setReserved(i,e):u.h[i]=e,this.storage.setDirtyFlag(),e}return a},removeDomain:function(e){this.domains.remove("_"+e.high+"_"+e.low),this.storage.setDirtyFlag();for(var t=this.getTalks().filter(function(t){var n=t.domainId;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low}),n=0;n<t.length;){var i=t[n];++n,this.removeTalk(i.id),this.removeTalkStatus(i.id)}},getUnreadCount:function(){for(var e=0,t=this.domains.keys();t.hasNext();){var n=t.next();e+=this._getDomainUnreadCount(n)}return e},_getDomainUnreadCount:function(e){var t;if(null!=this.domainUnreadCounts){var n=this.domainUnreadCounts;t=null!=Jo[e]?n.existsReserved(e):n.h.hasOwnProperty(e)}else t=!1;if(t){var i=this.domainUnreadCounts;return null!=Jo[e]?i.getReserved(e):i.h[e]}null==this.domainUnreadCounts&&(this.domainUnreadCounts=new eo);for(var r=0,a=this.talkStatuses,o=new $a(a,a.arrayKeys());o.hasNext();){var s=o.next();if(0!=s.unreadCount){var l,u=s.id,c="_"+u.high+"_"+u.low,_=this.talks,h=null!=Jo[c]?_.getReserved(c):_.h[c];if(null!=h){var d=h.domainId;l="_"+d.high+"_"+d.low==e}else l=!1;l&&(r+=s.unreadCount)}}var f=this.announcementStatuses,m=null!=Jo[e]?f.getReserved(e):f.h[e];if(null!=m&&null!=m.unreadCount){var p=this.domains,g=null!=Jo[e]?p.getReserved(e):p.h[e];null!=g&&g.role.allowReadAnnouncements&&(r+=m.unreadCount)}var v=this.domainUnreadCounts;return null!=Jo[e]?v.setReserved(e,r):v.h[e]=r,r},getDomainUnreadCount:function(e){return null==e?0:this._getDomainUnreadCount("_"+e.high+"_"+e.low)},getDomainInvites:function(){for(var e=[],t=this.domainInvites.keys();t.hasNext();){var n=t.next(),i=this.domainInvites;e.push(null!=Jo[n]?i.getReserved(n):i.h[n])}return e},getDomainInvitesWithoutWaiting:function(){var e=this;return this.getDomainInvites().filter(function(t){return null==t.accountControlRequestId||null==e.getAccountControlRequest(t.accountControlRequestId)})},getDomainInvitesCount:function(){return null==this.accountControlGroup?this.getDomainInvitesWithoutWaiting().length:this.getDomainInvites().length},getDomainInvite:function(e){var t="_"+e.high+"_"+e.low,n=this.domainInvites;return null!=Jo[t]?n.getReserved(t):n.h[t]},setDomainInvite:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.domainInvites;return null!=Jo[n]?i.setReserved(n,e):i.h[n]=e,this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),e},removeDomainInvite:function(e){this.domainInvites.remove("_"+e.high+"_"+e.low),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag()},clearFlowNotificationBadge:function(){this.flowNotificationBadgeStore.clear()},setFlowNotificationBadge:function(e,t){var n=this.flowNotificationBadgeStore.getBadge(e);(null==n||n.version<t.version)&&this.flowNotificationBadgeStore.setBadge(e,t)},removeFlowNotificationBadge:function(e){this.flowNotificationBadgeStore.removeBadge(e)},isFlowNotificationBadgeShownForDomains:function(e){if(null!=this.domains)for(var t=this.domains,n=new $a(t,t.arrayKeys());n.hasNext();){var i=n.next(),r=i.id;if((null==r||null==e||r.high!=e.high||r.low!=e.low)&&this.isFlowNotificationBadgeShownForOneDomain(i.id))return!0}return!1},isFlowNotificationBadgeShownForOneDomain:function(e){return!!this.flowNotificationBadgeStore.isBadgeShownForOneDomain(e)&&this.isDirectAppExists(e)},isDirectAppExists:function(e){return 0!=this.getDomainDirectApps(e).getSortedLinkFeatures().length},getFlowNotificationBadge:function(e){return this.flowNotificationBadgeStore.getBadge(e)},getQuestions:function(e,t){return this.questionStore.getQuestions(e,t)},getQuestion:function(e){return this.questionStore.getQuestion(e)},setQuestion:function(e){return this.questionStore.setQuestion(e),e},getAnnouncementStatus:function(e){var t="_"+e.high+"_"+e.low,n=this.announcementStatuses;return null!=Jo[t]?n.getReserved(t):n.h[t]},setAnnouncementStatus:function(e){var t=e.domainId,n="_"+t.high+"_"+t.low,i=this.announcementStatuses;return null!=Jo[n]?i.setReserved(n,e):i.h[n]=e,null!=this.domainUnreadCounts&&this.domainUnreadCounts.remove(n),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),e},removeAnnouncementStatus:function(e){var t="_"+e.high+"_"+e.low;this.announcementStatuses.remove(t),null!=this.domainUnreadCounts&&this.domainUnreadCounts.remove(t),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag()},getAccountControlRequests:function(){for(var e=[],t=this.accountControlRequests,n=new $a(t,t.arrayKeys());n.hasNext();){var i=n.next();e.push(i)}return e},getAccountControlRequest:function(e){var t="_"+e.high+"_"+e.low,n=this.accountControlRequests;return null!=Jo[t]?n.getReserved(t):n.h[t]},setAccountControlRequest:function(e){var t=e.id,n="_"+t.high+"_"+t.low,i=this.accountControlRequests,r=null!=Jo[n]?i.getReserved(n):i.h[n];if(null!=r&&r.version>e.version)return r;var a=this.accountControlRequests;return null!=Jo[n]?a.setReserved(n,e):a.h[n]=e,this.storage.setDirtyFlag(),e},removeAccountControlRequest:function(e){var t="_"+e.high+"_"+e.low;this.accountControlRequests.remove(t),this.storage.setDirtyFlag()},removeAccountControlRequests:function(){this.accountControlRequests=new eo,this.storage.setDirtyFlag()},getAccountControlGroup:function(){return this.accountControlGroup},setAccountControlGroup:function(e){return this.accountControlGroup=e,this.storage.setDirtyFlag(),this.accountControlGroup},updateAccountControlGroup:function(e){if(null!=this.accountControlGroup){var t=this.accountControlGroup.id,n=e.id;if(null!=t&&null!=n&&t.high==n.high&&t.low==n.low){var i=e.group;null!=i&&this.accountControlGroup.group.version<i.version&&(this.accountControlGroup.group=i,this.storage.setDirtyFlag());var r=e.profilePolicy;null!=r&&this.accountControlGroup.profilePolicy.version<r.version&&(this.accountControlGroup.profilePolicy=r,this.storage.setDirtyFlag())}}},removeAccountControlGroup:function(e){var t;if(null!=this.accountControlGroup){var n=this.accountControlGroup.id;t=null!=n&&null!=e&&n.high==e.high&&n.low==e.low}else t=!1;t&&(this.accountControlGroup=null,this.storage.setDirtyFlag())},addReactedConfereceId:function(e){var t="_"+e.high+"_"+e.low,n=this.reactedConferenceIds;null!=Jo[t]?n.setReserved(t,!0):n.h[t]=!0,this.storage.setDirtyFlag()},removeReactedConfereceId:function(e){this.reactedConferenceIds.remove("_"+e.high+"_"+e.low),this.storage.setDirtyFlag()},isReactedConferenceId:function(e){var t="_"+e.high+"_"+e.low,n=this.reactedConferenceIds;return null!=Jo[t]?n.existsReserved(t):n.h.hasOwnProperty(t)},filterReactedConferenceIds:function(e){var t=this,n=new eo;l.iter(e.map(function(e){return"_"+e.high+"_"+e.low}).filter(function(e){var n=t.reactedConferenceIds;return null!=Jo[e]?n.existsReserved(e):n.h.hasOwnProperty(e)}),function(e){null!=Jo[e]?n.setReserved(e,!0):n.h[e]=!0}),this.reactedConferenceIds=n},getNote:function(e){if(null==this.notes)return null;var t=this.notes,n=e.toString(),i=t;return null!=Jo[n]?i.getReserved(n):i.h[n]},setNote:function(e,t){if(null==this.notes&&(this.notes=new eo),null==t)return this.fileInfoStore.setNoteFileInfos(e,null),this.notes.remove(e.toString()),t;this.fileInfoStore.setNoteFileInfos(e,t.noteRevision.contentFiles);var n=this.notes,i=e.toString(),r=n;return null!=Jo[i]?r.setReserved(i,t):r.h[i]=t,t},setNoteRevisionSummary:function(e,t){if(null==this.noteRevisionSummaries&&(this.noteRevisionSummaries=new eo),null==t)return this.noteRevisionSummaries.remove(e.toString()),void this.fileInfoStore.setNoteFileInfos(e,null);var n=this.noteRevisionSummaries,i=e.toString(),r=n;null!=Jo[i]?r.setReserved(i,t):r.h[i]=t,this.fileInfoStore.setNoteFileInfos(e,t.contentFiles)},getNoteRevisionSummary:function(e){if(null==this.noteRevisionSummaries)return null;var t=this.noteRevisionSummaries,n=e.toString(),i=t;return null!=Jo[n]?i.getReserved(n):i.h[n]},setNoteLocalEdit:function(e,t){if(null==this.noteLocalEdits&&(this.noteLocalEdits=new eo),null==t){var n=this.noteLocalEdits,i=e.toString(),r=n,a=null!=Jo[i]?r.getReserved(i):r.h[i];if(null==a)return;return this.noteLocalEdits.remove(e.toString()),this.fileInfoStore.setNoteFileInfosForEdit(e,null),void this.sendNotification("clear_note_local_edit",a)}var o=this.noteLocalEdits,s=e.toString(),l=o;null!=Jo[s]?l.setReserved(s,t):l.h[s]=t,this.fileInfoStore.setNoteFileInfosForEdit(e,t.getFileInfos()),this.sendNotification("update_note_local_edit",t)},getNoteLocalEdit:function(e){if(null==this.noteLocalEdits)return null;var t=this.noteLocalEdits,n=e.toString(),i=t;return null!=Jo[n]?i.getReserved(n):i.h[n]},getNoteLocalEdits:function(e){var t=[];if(null!=this.noteLocalEdits)for(var n=this.noteLocalEdits,i=new $a(n,n.arrayKeys());i.hasNext();){var r=i.next(),a=r.getTalkId();null!=a&&null!=e&&a.high==e.high&&a.low==e.low&&t.push(r)}return t},setDirectApp:function(e,t){this.directAppStore.setDirectApp(e,t)},removeDirectApp:function(e){this.directAppStore.removeDirectApp(e)},getDirectApp:function(e){return this.directAppStore.getDirectApp(e)},getDomainDirectApps:function(e){var t=this.getDomain(e),n=null==t?[]:t.directAppsSetting.enabled;return this.directAppStore.getDirectApps(n)},getAllDirectApps:function(){return this.directAppStore.getAllDirectApps()},setMessageWithFileInfos:function(e,t){0!=t.length&&this.fileInfoStore.setMessageFileInfos(e.id,t),this.messageStore.setMessage(e)},setMessage:function(e){var t=[];switch(e.type[1]){case 4:t=[xt.fromMessageAndFile(e,e.content)];break;case 5:var n=e;t=U.asArray(e.content.files).map(function(e){return xt.fromMessageAndFile(n,e)})}this.setMessageWithFileInfos(e,t)},getMessage:function(e){return this.messageStore.getMessage(e)},removeMessage:function(e){this.fileInfoStore.removeMessageFileInfos(e),this.messageStore.removeMessage(e)},setFromThisDevice:function(e){this.messageStore.setFromThisDevice(e)},isFromThisDevice:function(e){return this.messageStore.isFromThisDevice(e)},closeAction:function(e){this.messageStore.closeAction(e)},deleteFile:function(e){this.messageStore.deleteFile(e),this.fileInfoStore.deleteFile(e)},deleteFavoriteMessage:function(e){this.messageStore.deleteFavoriteMessage(e)},addFavoriteMessage:function(e){this.messageStore.addFavoriteMessage(e)},getScheduledMessage:function(e){return this.scheduledMessageStore.getScheduledMessage(e)},getScheduledMessagesInTalk:function(e){return this.scheduledMessageStore.getScheduledMessages().filter(function(t){var n=t.talkId;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low})},getScheduledMessagesInDomain:function(e){var t=this;return this.scheduledMessageStore.getScheduledMessages().filter(function(n){var i=t.getTalk(n.talkId);if(null!=i){var r=i.domainId;return null!=r&&null!=e&&r.high==e.high&&r.low==e.low}return!1})},setScheduledMessage:function(e){var t=[];switch(e.type[1]){case 4:t=[xt.fromScheduledMessageFileContent(e.content)];break;case 5:t=U.asArray(e.content.files).map(xt.fromScheduledMessageFileContent)}0!=t.length&&this.fileInfoStore.setScheduledMessageFileInfos(e.id,t),this.scheduledMessageStore.setScheduledMessage(e)},removeScheduledMessage:function(e){return this.scheduledMessageStore.removeScheduledMessage(e)},removeScheduledMessagesInDomain:function(e){var t=this;l.iter(this.scheduledMessageStore.getScheduledMessages(),function(n){var i,r=t.getTalk(n.talkId);if(null!=r){var a=r.domainId;i=!(null!=a&&null!=e&&a.high==e.high&&a.low==e.low)}else i=!0;i||t.scheduledMessageStore.removeScheduledMessage(n.id)})},getAnnouncement:function(e){return this.announcementStore.getAnnouncement(e)},setAnnouncement:function(e){this.announcementStore.setAnnouncement(e)},removeAnnouncement:function(e){this.announcementStore.removeAnnouncement(e)},updateAvailableMessageReactions:function(e,t){this.messageReactionStore.updateAvailableMessageReactions(e,t)},getAvailableMessageReactions:function(e){return this.messageReactionStore.getAvailableMessageReactions(e)},isAvailableMessageReactionsLoaded:function(e){return this.messageReactionStore.isAvailableMessageReactionsLoaded(e)},setMessageReactionSummary:function(e){this.messageReactionStore.setMessageReactionSummary(e)},removeMessageReactionSummary:function(e){this.messageReactionStore.removeMessageReactionSummary(e)},getMessageReactionSummary:function(e){return this.messageReactionStore.getMessageReactionSummary(e)},removeMessageReactionUsers:function(e){this.messageReactionStore.removeMessageReactionUsers(e)},getMessageReactionUsers:function(e){return this.messageReactionStore.getMessageReactionUsers(e)},setMessageReactionUsers:function(e){this.messageReactionStore.setMessageReactionUsers(e)},addLoadingMessageReactionSmmary:function(e){this.messageReactionStore.addLoadingMessageReactionSmmary(e)},removeLoadingMessageReactionSmmary:function(e){this.messageReactionStore.removeLoadingMessageReactionSmmary(e)},isLoadingMessageReactionSmmary:function(e){return this.messageReactionStore.isLoadingMessageReactionSmmary(e)},setSolution:function(e){this.solutionStore.setSolution(e)},getSolution:function(e){return this.solutionStore.getSolution(e)},addLoadingSolutionId:function(e){this.solutionStore.addLoadingSolutionId(e)},removeLoadingSolutionId:function(e){this.solutionStore.removeLoadingSolutionId(e)},isLoadedSolutionId:function(e){return this.solutionStore.isLoadedSolutionId(e)},isLoadingSolutionId:function(e){return this.solutionStore.isLoadedSolutionId(e)},addConference:function(e){this.conferenceStore.addConference(e)},removeConference:function(e){this.removeReactedConfereceId(e.id),this.conferenceStore.removeConference(e),this.messageStore.closeConference(e)},removeConferencesOnLeaveDomain:function(e){var t=this;l.iter(this.conferenceStore.getConferences().filter(function(t){var n=t.domainId;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low}),function(e){t.removeConference(e),t.sendNotification("notify_close_conference",e)})},removeConferencesOnLeaveTalk:function(e){var t=this;l.iter(this.conferenceStore.getConferences().filter(function(t){var n=t.talkId;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low}),function(e){t.removeConference(e),t.sendNotification("notify_close_conference",e)})},getConference:function(e){return this.conferenceStore.getConference(e)},hasConferenceInTalk:function(e){return this.conferenceStore.hasConferenceInTalk(e)},getConferenceIdInTalk:function(e){return this.conferenceStore.getConferenceIdInTalk(e)},hasConferenceInDomain:function(e){return null!=l.find(this.conferenceStore.getConferenceTalkIds().map(Ro(this,this.getTalk)),function(t){if(null!=t){var n=t.domainId;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low}return!1})},hasConferenceInAllDomains:function(e){return null==e?this.conferenceStore.hasConference():null!=l.find(this.conferenceStore.getConferenceTalkIds().map(Ro(this,this.getTalk)),function(t){if(null!=t){var n=t.domainId;return!(null!=n&&null!=e&&n.high==e.high&&n.low==e.low)}return!1})},getFileInfo:function(e){return this.fileInfoStore.getFileInfo(e)},getTalkFileInfo:function(e,t,n){return this.fileInfoStore.getTalkFileInfo(e,t,n)},setTalkFileInfo:function(e,t){this.fileInfoStore.setTalkFileInfo(e,t)},getFilePreview:function(e){return P.orNull(this.fileInfoStore.getFilePreview(e))},setFilePreview:function(e,t){this.fileInfoStore.setFilePreview(e,t)},getMessageFileInfos:function(e){return this.fileInfoStore.getMessageFileInfos(e)},getScheduledMessageFileInfos:function(e){return this.fileInfoStore.getScheduledMessageFileInfos(e)},isAllFileDeletedOnMessage:function(e){return this.fileInfoStore.isAllFileDeletedOnMessage(e)},addStagedFileInfo:function(e,t,n,i){return this.fileInfoStore.addStagedFileInfo(e,t,n,i)},replaceStagedFileInfo:function(e,t,n,i){return this.fileInfoStore.replaceStagedFileInfo(e,t,n,i)},moveStagedFile:function(e,t,n){this.fileInfoStore.moveStagedFile(e,t,n)},ensureTalkFileInfos:function(e){return this.fileInfoStore.ensureTalkFileInfos(e)},ensureStagedFileInfos:function(e){return this.fileInfoStore.ensureStagedFileInfos(e)},getStagedFilesCount:function(e){var t=this.fileInfoStore.ensureStagedFileIdStrs(e);return null==t?0:t.length},removeStagedFileInfos:function(e){this.fileInfoStore.removeStagedFileInfos(e)},removeStagedFileInfo:function(e,t){this.fileInfoStore.removeStagedFileInfo(e,t)},restoreStagedFile:function(e,t){this.fileInfoStore.restoreStagedFile(e,t)},replaceStagedFileInfoFromFileId:function(e,t,n){this.fileInfoStore.replaceStagedFileInfoFromFileId(e,t,n)},addStampsets:function(e){this.stampStore.addStampsets(e)},updateStampsetInfo:function(e){l.iter(this.getDomains(),function(t){t.updateStampsetInfo(e)}),this.stampStore.updateStampsetInfo(e)},removeStampsetInfo:function(e){l.iter(this.getDomains(),function(t){t.deleteStampsetInfo(e)}),this.stampStore.removeStampsetInfo(e)},addStampsetInfos:function(e){this.stampStore.addStampsetInfos(e)},getStampsetByStampsetId:function(e){return this.stampStore.getStampsetByStampsetId(e)},getStampsetsByTabIds:function(e){return this.stampStore.getStampsetsByTabIds(e)},getStampByStampKey:function(e){return this.stampStore.getStampByStampKey(e)},getOriginalStamp:function(e){return this.stampStore.getOriginalStamp(e)},applyHistories:function(e,t){this.stampStore.applyHistories(e,t)},getDepartment:function(e){return this.departmentStore.getDepartment(e)},setDepartment:function(e){this.departmentStore.setDepartment(e)},clearDomainDepartment:function(e){this.departmentStore.clearDomainDepartment(e)},getRootDepartmentId:function(e){return this.departmentStore.getRootDepartmentId(e)},setRootDepartmentId:function(e,t){this.departmentStore.setRootDepartmentId(e,t)},setDepartmentUserCount:function(e){this.departmentStore.setDepartmentUserCount(e)},setUserCountLoading:function(e,t){this.departmentStore.setUserCountLoading(e,t)},isUserCountLoadingRequired:function(e){return this.departmentStore.isUserCountLoadingRequired(e)},clearDomainDepartmentUsers:function(e){return this.departmentStore.clearDomainDepartmentUsers(e)},setDepartmentUsers:function(e,t){this.departmentStore.setDepartmentUsers(e,t)},getDepartmentPath:function(e){return this.departmentStore.getDepartmentPath(e)},getDepartmentPathWithoutRoot:function(e){return this.departmentStore.getDepartmentPathWithoutRoot(e)},clear:function(e){this.users=new eo,this.talks=new eo,this.talkStatuses=new eo,this.domains=new eo,this.domainInvites=new eo,this.announcementStatuses=new eo,this.accountControlRequests=new eo,this.accountControlGroup=null,this.reactedConferenceIds=new eo,e&&(this.me=null),this.storage.setDirtyFlag(),this.storageForTalks.setDirtyFlag(),this.storageForTalkStatuses.setDirtyFlag(),this.storageForUsers.setDirtyFlag()},init:function(){this.storage=new Er("dataStore"),this.storageForTalks=new Er("dataStoreTalks"),this.storageForTalkStatuses=new Er("dataStoreTalkStatuses"),this.storageForUsers=new Er("dataStoreUsers");var e=!1,t=this.storage.load();null!=t&&("1.124_1"==t.shift()&&(this.domains=t.shift(),this.domainInvites=t.shift(),this.announcementStatuses=t.shift(),this.accountControlRequests=t.shift(),this.accountControlGroup=t.shift(),this.reactedConferenceIds=t.shift(),e=!0));var n=!1,i=this.storageForTalks.load();null!=i&&("1.124_1"==i.shift()&&(this.talks=i.shift(),n=!0));var r=!1,a=this.storageForTalkStatuses.load();null!=a&&("1.124_1"==a.shift()&&(this.talkStatuses=a.shift(),r=!0));var o=!1,l=this.storageForUsers.load();null!=l&&("1.124_1"==l.shift()&&(this.me=l.shift(),this.users=l.shift(),o=!0));e&&n&&r&&o?Ar._d("["+s.dateStr(new Date)+"] ","dataStore is loaded.","","","",""):(this.clear(!0),Ar._d("["+s.dateStr(new Date)+"] ","dataStore is initialized.","","","",""))},saveIfNeeded:function(){this.storage.isDirty&&(this.storage.save(["1.124_1",this.domains,this.domainInvites,this.announcementStatuses,this.accountControlRequests,this.accountControlGroup,this.reactedConferenceIds]),Ar._d("["+s.dateStr(new Date)+"] ","dataStore is saved.","","","","")),this.storageForTalks.isDirty&&(this.storageForTalks.save(["1.124_1",this.talks]),Ar._d("["+s.dateStr(new Date)+"] ","dataStoreTalks is saved.","","","","")),this.storageForTalkStatuses.isDirty&&(this.storageForTalkStatuses.save(["1.124_1",this.talkStatuses]),Ar._d("["+s.dateStr(new Date)+"] ","dataStoreTalkStatuses is saved.","","","","")),this.storageForUsers.isDirty&&(this.storageForUsers.save(["1.124_1",this.me,this.users]),Ar._d("["+s.dateStr(new Date)+"] ","dataStoreUsers is saved.","","","",""))},__class__:Vr});var qr=function(){Br.call(this,"features")};n["albero.proxy.FeaturesProxy"]=qr,qr.__name__=["albero","proxy","FeaturesProxy"],qr.__super__=Br,qr.prototype=r(Br.prototype,{canSendMessageOnMultiView:function(e){return!!this.settings.isOnPremises()||this.selectedDomainHasSolution(e,Bn.MultiView)},canDetectKeyword:function(e){return!!this.settings.isOnPremises()||this.selectedDomainHasSolution(e,Bn.KeywordWatching)},selectedDomainHasSolution:function(e,t){if(null==e)return!1;var n=this.dataStore.getDomain(e),i=null==n?[]:n.getSolutionIds();return l.exists(i,function(e){return xn.getSolutionType(e)==t})},canConference:function(e){if(null==e)return!1;var t=this.dataStore.getDomain(e);return null!=t&&null!=t.contract&&t.contract.isConferenceEnalbed()},__class__:qr});var Qr=function(){};n["albero.proxy.FileServiceProxy"]=Qr,Qr.__name__=["albero","proxy","FileServiceProxy"],Qr.__interfaces__=[xr],Qr.prototype={__class__:Qr};var Jr=function(e){this.rawValue=e,this.post_url=e.post_url,this.post_form=e.post_form,this.put_url=e.put_url};n["albero.proxy.UploadAuth"]=Jr,Jr.__name__=["albero","proxy","UploadAuth"],Jr.prototype={__class__:Jr};var Xr=function(){};n["albero.proxy.FileServiceProxyFactory"]=Xr,Xr.__name__=["albero","proxy","FileServiceProxyFactory"],Xr.newInstance=function(){return new Zr("fileService")};var Zr=function(e){Br.call(this,e)};n["albero.proxy.FileServiceProxyImpl"]=Zr,Zr.__name__=["albero","proxy","FileServiceProxyImpl"],Zr.__interfaces__=[Qr],Zr.convertUploadableFile=function(e){var t=!1,n=e.name;B.isEmpty(n)&&(n="clipboard_"+M.getDateStringForFile()+".png",t=!0);var i=Zr.getContentTypeByFileName(n,e.type);return i!=e.type&&(t=!0),t?{name:n,type:i,file:n,blob:e,size:e.size}:e},Zr.getContentTypeByFileName=function(e,t){return(new D).resolve({name:e,type:t})},Zr.__super__=Br,Zr.prototype=r(Br.prototype,{downloadUrl:function(e,t){throw null==t&&(t=!1),new _o("Unsupported. downloadUrl() is implemented by only FileServiceProxyImplForHubot.")},download:function(e,t,n){throw new _o("Unsupported. download() is implemented by only FileServiceProxyImplForHubot.")},upload:function(e,t,n){return this.uploadForBrowser(e,t,n)},uploadForBrowser:function(e,t,n){for(var i={},r=0,a=p.fields(e.post_form);r<a.length;){var o=a[r];++r;var s=o,l=p.field(e.post_form,o);i[s]=l}var u=e.post_url,c={};return new Promise(function(e,t){Vo.upload({url:u,headers:c,data:i,files:{file:n},complete:function(n,i){n?t(i.responseText):Mr.resolveVoid(e)},cache:!0})})},createDummyFile:function(e,t,n){var i=S.replace(e,"/","\\").split("\\");if(0==i.length)return null;var r=i[i.length-1];if(null!=t&&(r=t),0==r.length)return null;return{name:r,size:1,type:Zr.getContentTypeByFileName(r,n)}},__class__:Zr});var $r=function(){Br.call(this,"keywordWatcher")};n["albero.proxy.KeywordWatcherProxy"]=$r,$r.__name__=["albero","proxy","KeywordWatcherProxy"],$r.__super__=Br,$r.prototype=r(Br.prototype,{onMessageCreated:function(e){if(null!=e){var t,n=P.map(P.option(this.dataStore.getTalk(e.talkId)),function(e){return e.domainId});switch(n[1]){case 0:t=n[2];break;case 1:t=this.settings.getSelectedDomainId()}if(this.features.canDetectKeyword(t)){var i;if(this.settings.getBrowserSettings().keywordWatchingSelfMessage)i=!1;else{var r=this.dataStore,a=e.userId;if(null!=r.me){var o=r.me.id;i=null!=o&&null!=a&&o.high==a.high&&o.low==a.low}else i=!1}if(!i){var s=e.messageStringForKeywordDetection(this.settings.getBrowserSettings().keywordWatchingActionReply);this.detectKeyword(s,e.type,e.id,t,e.talkId)}}}},onAnnouncementCreated:function(e){if(null!=e&&this.features.canDetectKeyword(e.domainId)){var t=Zt.getDisplayTextWithoutEscape(e.type,e.content);this.detectKeyword(t,e.type,e.id,e.domainId,null)}},detectKeyword:function(e,t,n,i,r){var a=this;this.reserveOnNormalizedKeywordPrepared(function(o){for(var s=S.htmlEscape(e,!0),l=o.keys();l.hasNext();){var u=l.next(),c=o.get(u);if(null!=c&&0!=c.length&&ia.match(t,u))for(var _=0;_<c.length;){var h=c[_];if(++_,0!=h.search(s).length)return void a.addkeywordDetection(i,r,n)}}})},reserveOnNormalizedKeywordPrepared:function(e){var t=this.settings.getBrowserSettings().keywordWatchingText;if(this.cachedKeyword!=t){this.cachedKeyword=t,this.cachedNormalizedKeywordsMap=new Qa;for(var n=0,i=na.__empty_constructs__;n<i.length;){var r=i[n];++n,this.cachedNormalizedKeywordsMap.set(r,[])}for(var a=0,o=ea.parse(t);a<o.length;){var s=o[a];++a,this.cachedNormalizedKeywordsMap.get(s.type).push(new br(s.word,!0,kr.normalize))}}e(this.cachedNormalizedKeywordsMap)},addkeywordDetection:function(e,t,n){null==this.detectedDomainTalkIdStrings&&(this.detectedDomainTalkIdStrings=new eo);var i=this.getKey(e,t);if(null!=i)if(this.hasKeywordDetection(e,t)){var r=this.detectedDomainTalkIdStrings;null!=Jo[i]?r.setReserved(i,n):r.h[i]=n}else{var a=this.detectedDomainTalkIdStrings;null!=Jo[i]?a.setReserved(i,n):a.h[i]=n;var o=this.settings.getBrowserSettings().keywordWatchingEmphasis;this.sendNotification("keyword_detaction_updated",{domainId:e,talkId:t,detected:!0,emphasis:o})}},readKeywordDetection:function(e,t,n){if(!this.settings.getBrowserSettings().keywordWatchingEmphasis){var i,r=this.getDetectId(e,t);if(null!=r){var a=n.high-r.high|0;a=0!=a?a:Ba.ucompare(n.low,r.low),i=(n.high<0?r.high<0?a:-1:r.high>=0?a:1)>=0}else i=!1;i&&this.removeKeywordDetection(e,t)}},removeKeywordDetection:function(e,t){if(null!=this.detectedDomainTalkIdStrings){var n=this.getKey(e,t);if(null!=n){this.detectedDomainTalkIdStrings.remove(n);var i=this.settings.getBrowserSettings().keywordWatchingEmphasis;this.sendNotification("keyword_detaction_updated",{domainId:e,talkId:t,detected:!1,emphasis:i})}}},removeKeywordDetectionAll:function(){if(null!=this.detectedDomainTalkIdStrings)for(var e=this.settings.getBrowserSettings().keywordWatchingEmphasis,t=this.detectedDomainTalkIdStrings.keys();t.hasNext();){var n=t.next();if(S.startsWith(n,"talk_")){var i=n.substring("talk_".length),r=R.makeFromIdStr(i);this.sendNotification("keyword_detaction_updated",{domainId:null,talkId:r,detected:!1,emphasis:e})}else if(S.startsWith(n,"announcement_")){var a=n.substring("announcement_".length),o=R.makeFromIdStr(a);this.sendNotification("keyword_detaction_updated",{domainId:o,talkId:null,detected:!1,emphasis:e})}this.detectedDomainTalkIdStrings.remove(n)}},getDetectId:function(e,t){if(null==this.detectedDomainTalkIdStrings)return null;var n=this.getKey(e,t);if(null==n)return null;var i=this.detectedDomainTalkIdStrings;return null!=Jo[n]?i.getReserved(n):i.h[n]},hasKeywordDetection:function(e,t){return null!=this.getDetectId(e,t)},getKey:function(e,t){return null==e&&null==t?null:null!=t?"talk__"+t.high+"_"+t.low:"announcement__"+e.high+"_"+e.low},__class__:$r});var ea=function(){};n["albero.proxy.KeywordParser"]=ea,ea.__name__=["albero","proxy","KeywordParser"],ea.parse=function(e){var t=S.htmlEscape(e,!0),n=new o("&quot;(.*?)&quot;","g").map(t,function(e){return ea.encodeSpace(e.matched(1))});return new o("[ ]","g").split(n).filter(B.isNotEmpty).map(ea.decodeSpace).map(ea.createParsedKeyword)},ea.encodeSpace=function(e){return S.replace(S.replace(e," ","&SPACE"),"","&FULL_PITCH_SPACE")},ea.decodeSpace=function(e){return S.replace(S.replace(e,"&SPACE"," "),"&FULL_PITCH_SPACE","")},ea.createParsedKeyword=function(e){var t=new o("\\[type:([A-Za-z]+)\\](.*)","g");if(t.match(e)){var n=t.matched(1),i=t.matched(2),r=ia.getKeywordTypeByMessageTypeString(n);if(r!=na.normal)return new ta(r,i)}return new ta(na.normal,e)};var ta=function(e,t){this.type=e,this.word=t};n["albero.proxy.ParsedKeyword"]=ta,ta.__name__=["albero","proxy","ParsedKeyword"],ta.prototype={__class__:ta};var na=n["albero.proxy.KeywordType"]={__ename__:["albero","proxy","KeywordType"],__constructs__:["normal","selectOneReplyOnly","yesOrNoReplyOnly","todoDoneOnly"]};na.normal=["normal",0],na.normal.toString=i,na.normal.__enum__=na,na.selectOneReplyOnly=["selectOneReplyOnly",1],na.selectOneReplyOnly.toString=i,na.selectOneReplyOnly.__enum__=na,na.yesOrNoReplyOnly=["yesOrNoReplyOnly",2],na.yesOrNoReplyOnly.toString=i,na.yesOrNoReplyOnly.__enum__=na,na.todoDoneOnly=["todoDoneOnly",3],na.todoDoneOnly.toString=i,na.todoDoneOnly.__enum__=na,na.__empty_constructs__=[na.normal,na.selectOneReplyOnly,na.yesOrNoReplyOnly,na.todoDoneOnly];var ia=function(){};n["albero.proxy.KeywordTypeHelper"]=ia,ia.__name__=["albero","proxy","KeywordTypeHelper"],ia.getKeywordType=function(e){return null!=e?ia.getKeywordTypeByMessageTypeString(Zt.typeString(e)):na.normal},ia.getKeywordTypeByMessageTypeString=function(e){if(null!=e)switch(e){case"selectOneReply":return na.selectOneReplyOnly;case"todoDone":return na.todoDoneOnly;case"yesOrNoReply":return na.yesOrNoReplyOnly}return na.normal},ia.match=function(e,t){switch(t[1]){case 0:return!0;case 1:return e==$t.selectOneReply;case 2:return e==$t.yesOrNoReply;case 3:return e==$t.todoDone}},ia.createFilterClassStringFromMessageType=function(e){return ia.createFilterClassString(ia.getKeywordType(e))},ia.createFilterClassString=function(e){return"keyword_type_"+g.string(e)};var ra=function(){this.isCallingUpdateLastUsedAt=!1,Br.call(this,"lastUsedAtUpdater")};n["albero.proxy.LastUsedAtUpdaterProxy"]=ra,ra.__name__=["albero","proxy","LastUsedAtUpdaterProxy"],ra.__super__=Br,ra.prototype=r(Br.prototype,{startPolling:function(e){var t=this;if(null==this.pollingTimer){var n,i=this.getLastUsedExpiredAt();if(null==i)n=0;else{var r=i.high,a=i.low;n=4294967296*r+(a>=0?a:a+4294967296)-(new Date).getTime()}n>0?Ya.delay(function(){t.startPolling(e)},0|n):(this.isCallingUpdateLastUsedAt=!0,e(),this.pollingTimer=new Ya(this.settings.getConfiguration().updateLastUsedAtInterval),this.pollingTimer.run=function(){t.isCallingUpdateLastUsedAt||(t.isCallingUpdateLastUsedAt=!0,e())})}},stopPolling:function(){null!=this.pollingTimer&&(this.pollingTimer.stop(),this.pollingTimer=null)},getLastUsedExpiredAt:function(){return null!=this.lastUsedExpiredAtCache?this.lastUsedExpiredAtCache:this.settings.getLastUsedExpiredAt()},update:function(){this.lastUsedExpiredAtCache=M.afterAsInt64(this.settings.getConfiguration().updateLastUsedAtInterval),this.settings.setLastUsedExpiredAt(this.lastUsedExpiredAtCache),this.isCallingUpdateLastUsedAt=!1},cancel:function(){this.isCallingUpdateLastUsedAt=!1},__class__:ra});var aa=function(){Br.call(this,"limitations")};n["albero.proxy.LimitationsProxy"]=aa,aa.__name__=["albero","proxy","LimitationsProxy"],aa.__super__=Br,aa.prototype=r(Br.prototype,{getMaxTalkers:function(){var e=this,t=P.flatMap(P.flatMap(P.option(this.settings.getSelectedDomainId()),function(t){return P.option(e.dataStore.getDomain(t))}),function(e){return e.getMaxTalkers()});switch(t[1]){case 0:return t[2];case 1:return this.settings.getConfiguration().maxTalkers}},__class__:aa});var oa=function(){this.connectionStatus=A.Ok,Br.call(this,"rpc"),this.responseHandlers=new Ja,this.connectionKeeper=new sa(Ro(this,this.ping))};n["albero.proxy.MsgPackRpcProxy"]=oa,oa.__name__=["albero","proxy","MsgPackRpcProxy"],oa.__super__=Br,oa.prototype=r(Br.prototype,{initWebSocket:function(){null==this.ws&&(this.ws=Fr.newInstance(Qo.endpoint,{onopen:Ro(this,this.onOpen),onmessage:Ro(this,this.onMessage),onclose:Ro(this,this.onClose),onpong:Ro(this,this.onPong)}),oa.pingAt=null)},finishWebSocket:function(){if(null==this.ws)return null;this.ws.close();var e=this.ws;return this.ws=null,oa.pingAt=null,this.lastUsedAtUpdater.stopPolling(),e},onRegister:function(){this.initWebSocket(),this.connectionKeeper.start()},onRemove:function(){this.connectionKeeper.stop(),this.finishWebSocket()},onOpen:function(){this.connectionStatus=A.Ok,this.connectionKeeper.setConnected(!0),this.sendNotification("SignIn")},onPong:function(e){oa.pingAt=null;g.string(e)},onMessage:function(e){var t=new go(e,!0).o,n=ho.__cast(t[0],Go);if(1==n&&4==t.length){var i=ho.__cast(t[1],Go),r=t[2],a=t[3],o=this.responseHandlers.h[i];if(null==o)return void Ar._e("["+s.dateStr(new Date)+"] ","No ResponseHandler prepared. msgId:%s error:%s result:",i,r,a,"");o.method;if(null==r)o.onSuccess(a);else{var l=o.method;Ar._e("["+s.dateStr(new Date)+"] ","Receive Error Response. method:",l," error:",r,""),o.onError(r)}this.responseHandlers.remove(i)}else if(0==n&&4==t.length){var u=ho.__cast(t[1],Go),c=ho.__cast(t[2],String),_=ho.__cast(t[3],Array);if(0==_.length)return void Ar._e("["+s.dateStr(new Date)+"] ","empty params.","","","","");if(this.broadcast.handleNotification(c,_[0]),null==this.ws)return void Ar._e("["+s.dateStr(new Date)+"] ","websocket was finished.","","","","");this.ws.send(new vo([1,u,null,!0]).o.getBytes())}},onClose:function(e,t,n){Ar._i("["+s.dateStr(new Date)+"] ","onClose. code:"+e+", reason:"+t+", wasClean:"+(null==n?"null":""+n),"","","",""),1001==e&&n||(this.connectionStatus=1e3!=e&&1005!=e||"concurrent access"!=t?1e3!=e&&1005!=e||"forcibly closed"!=t?A.Error:A.ForcibliyClosedError:A.ConcurrentAccessError,this.connectionStatus==A.ForcibliyClosedError?this.sendNotification("SignOut"):this.sendNotification("Url",Le.FORWARD(G.error))),this.finishWebSocket(),this.connectionKeeper.setConnected(!1)},restart:function(e){null==e&&(e=500);for(var t=this,n=this.finishWebSocket(),i=this.responseHandlers.keys();i.hasNext();){var r=i.next();this.responseHandlers.remove(r)}var a=null;a=function(){null==n||n.isClosed()?t.initWebSocket():Ya.delay(a,100)},Ya.delay(a,e)},call:function(e,t,n,i){var r=this;if(null!=this.ws){null==t&&(t=[]),null==n&&(n=function(e){}),null==i&&(i=Ro(this,this.onServerError));var a=oa.lastMsgId++,o=new la(e,n,i);this.responseHandlers.h[a]=o;var l=new vo([0,a,e,t]).o.getBytes();this.sendAsPromise(l).catch(function(e){return Mr.delay(1e3).then(function(e){return r.sendAsPromise(l)})}).then(function(e){},function(t){o.onError(new ua({message:"failed to execute send on websocket",detail:e})),r.responseHandlers.remove(a)})}else{var u=this.data;Ar._e("["+s.dateStr(new Date)+"] ","disconnected. data:",u,"","","")}},sendAsPromise:function(e){try{return this.ws.send(e),Promise.resolve()}catch(e){return e instanceof _o&&(e=e.val),Promise.reject(e)}},ping:function(){switch(this.connectionStatus[1]){case 2:case 3:return}if(null==this.ws||this.ws.isClosed()){this.restart();oa.pingAt,g.string(null==this.ws||this.ws.isClosed())}else{oa.pingAt;this.connectionKeeper.isConnected()&&(this.ws.ping("PING"),oa.pingAt=(new Date).getTime())}},onServerError:function(e){if(this.sendNotification("error_occurred",e),503==e.code&&"service temporarily unavailable"==e.message){var t=e.detail.retry_after;this.restart(1e3*t)}"invalid session"==e.message&&this.restart()},__class__:oa});var sa=function(e){this.connected=!1,this.ping=e};n["albero.proxy._MsgPackRpcProxy.ConnectionKeeper"]=sa,sa.__name__=["albero","proxy","_MsgPackRpcProxy","ConnectionKeeper"],sa.prototype={start:function(){},stop:function(){this.deleteTimer()},setConnected:function(e){this.connected==e&&null!=this.timer||(this.connected=e,this.resetTimer())},isConnected:function(){return this.connected},resetTimer:function(){var e=this;if(this.deleteTimer(),this.connected)this.timer=new Ya(45e3),this.timer.run=this.ping;else{var t=null;(t=function(n){var i=0|Math.min(2*n,45e3);return function(){e.ping();var r=t(i);e.timer=Ya.delay(r,n)}})(3e3)()}},deleteTimer:function(){null!=this.timer&&(this.timer.stop(),this.timer=null)},__class__:sa};var la=function(e,t,n){this.method=e,this.onSuccess=t,this.onError=n};n["albero.proxy._MsgPackRpcProxy.ResponseHandler"]=la,la.__name__=["albero","proxy","_MsgPackRpcProxy","ResponseHandler"],la.prototype={__class__:la};var ua=function(e){this.code=e.code,this.message=e.message,this.detail=e.detail};n["albero.proxy.Error"]=ua,ua.__name__=["albero","proxy","Error"],ua.prototype={__class__:ua};var ca=function(){};n["albero.proxy.ErrorConverter"]=ca,ca.__name__=["albero","proxy","ErrorConverter"],ca.toLocalError=function(e,t){return{code:t.code,message:t.message,detail:t.detail,localErrorType:e}};var _a=function(){Br.call(this,"readStatusUpdater"),this.updateReadStatusesTimers=new eo,this.updateReadAnnouncementStatusesTimers=new eo};n["albero.proxy.ReadStatusUpdaterProxy"]=_a,_a.__name__=["albero","proxy","ReadStatusUpdaterProxy"],_a.__super__=Br,_a.prototype=r(Br.prototype,{updateReadStatuses:function(e,t){var n=this,i=this.dataStore.getTalkStatus(e);if(null!=i&&i.updateByReadingMessages(t,this.dataStore.me.id)){this.dataStore.setTalkStatus(i);var r="_"+e.high+"_"+e.low,a=this.updateReadStatusesTimers,o=null!=Jo[r]?a.getReserved(r):a.h[r];null!=o&&o.stop();var s=i.maxReadMessageId,l=Ya.delay(function(){n.updateReadStatusesTimers.remove(r),null!=n.dataStore.getTalkStatus(e)&&n.api.updateReadStatuses(e,s)},1e3),u=this.updateReadStatusesTimers;null!=Jo[r]?u.setReserved(r,l):u.h[r]=l}},updateAnnouncementReadStatus:function(e,t){var n=this,i=this.dataStore.getAnnouncementStatus(e);if(null!=i&&i.updateByReadingAnnouncements(t)){this.dataStore.setAnnouncementStatus(i);var r="_"+e.high+"_"+e.low,a=this.updateReadAnnouncementStatusesTimers,o=null!=Jo[r]?a.getReserved(r):a.h[r];null!=o&&o.stop();var s=i.maxReadAnnouncementId;o=Ya.delay(function(){n.updateReadAnnouncementStatusesTimers.remove(r),n.api.updateAnnouncementReadStatus(e,s)},1e3);var l=this.updateReadAnnouncementStatusesTimers;null!=Jo[r]?l.setReserved(r,o):l.h[r]=o}},__class__:_a});var ha=function(){Br.call(this,"routing")};n["albero.proxy.RoutingProxy"]=ha,ha.__name__=["albero","proxy","RoutingProxy"],ha.__super__=Br,ha.prototype=r(Br.prototype,{onRegister:function(){},init:function(){null==this.router&&(this.router=new da(this,this.settings,this.dataStore),this.sendNotification("first_routing_will_start"))},forward:function(e){this.init(),this.router.forward(e)},redirect:function(e,t){this.init(),this.router.redirect(e,t)},back:function(){null!=this.router&&this.router.back()},stop:function(){null!=this.router&&this.router.stop()},__class__:ha});var da=function(e,t,n){this.proxy=e,this.settings=t,this.dataStore=n,this.urlConverterDelegate=new fa(t,n)};n["albero.proxy._RoutingProxy.LocalRouter"]=da,da.__name__=["albero","proxy","_RoutingProxy","LocalRouter"],da.prototype={notify:function(e){var t=this.getDomainId(e);this.settings.setSelectedDomainId(t),this.proxy.sendNotification("current_page_changed",e)},forward:function(e){0!=e[1]&&this.notify(e)},redirect:function(e,t){},redirectWithHash:function(){},back:function(){this.notify(this.prev)},stop:function(){},getDomainId:function(e){switch(e[1]){case 2:return e[2];case 3:return e[2];case 4:return e[2];case 5:return e[2];case 6:return e[2];case 7:return e[2];case 8:return e[2];case 12:return e[2];case 13:return e[2];default:return null}},parseFragment:function(e){return K.createUrls(e,this.urlConverterDelegate)},toFragment:function(e){return K.createFragment(e,this.urlConverterDelegate)},__class__:da};var fa=function(e,t){this.settings=e,this.dataStore=t};n["albero.proxy.UrlConverterDelegate"]=fa,fa.__name__=["albero","proxy","UrlConverterDelegate"],fa.__interfaces__=[W],fa.prototype={isMultiViewMode:function(){return this.settings.isMultiViewMode()},getLastSelectedDomainId:function(){return P.option(this.settings.getLastSelectedDomainId())},getFallbackDomainId:function(){var e;switch(P.flatMap(this.getLastSelectedDomainId(),Ro(this,this.getDomain))[1]){case 0:e=P.flatMap(this.getLastSelectedDomainId(),Ro(this,this.getDomain));break;case 1:e=this.getOldestDomain()}return P.map(e,function(e){return e.id})},getDomain:function(e){return P.option(this.dataStore.getDomain(e))},getOldestDomain:function(){return new kt(this.dataStore.getDomains()).getOldestDomain()},__class__:fa};var ma=function(){Br.call(this,"searchService")};n["albero.proxy.SearchServiceProxy"]=ma,ma.__name__=["albero","proxy","SearchServiceProxy"],ma.__super__=Br,ma.prototype=r(Br.prototype,{isSearching:function(){return this.searching},clearSearching:function(){this.searching=!1},isRecentParams:function(e){return null!=this.recentParams&&null!=e&&this.recentParams.eq(e)},clearRecentParams:function(){this.recentParams=null},clearEditingParams:function(){this.editingParams=null},saveParams:function(e){this.editingParams=e,this.recentParams=e.copy()},updateTalkIdParam:function(e){this.assureParams(),this.editingParams.talkId=e},updateSearchTypeParam:function(e){this.assureParams(),this.editingParams.searchType=e},updateFromUserIdParam:function(e){this.assureParams(),this.editingParams.fromUserId=e},updateKeywordParam:function(e){this.assureParams(),this.editingParams.keyword=e},updateDomainIdParam:function(e){this.assureParams(),this.editingParams.domainId=e},updateSinceTextParam:function(e){this.assureParams(),this.editingParams.sinceText=e},updateUntilTextParam:function(e){this.assureParams(),this.editingParams.untilText=e},assureParams:function(){if(null==this.editingParams){var e=this.settings.getSelectedDomainId(),t={domain_id_str:"_"+e.high+"_"+e.low};this.editingParams=new Cn(t)}},prepareForSearching:function(e,t){this.searching=!0,null==t&&this.sendNotification("notify_search_prepare",{searching:!0,params:e})},notifySearchMessagesFail:function(){this.searching=!1,this.sendNotification("notify_search_messages_fail",{})},notifySearchAttachmentsFail:function(){this.searching=!1,this.sendNotification("notify_search_attachments_fail",{})},saveSearchMessagesResult:function(e){null==this.contextMap&&(this.contextMap=new eo),this.messagesNextMarker=e.nextMarker,null==e.marker&&(this.hitMessageIdSet=new eo);for(var t=0,n=e.contents;t<n.length;){var i=n[t];++t;var r=i.messages[0].id,a="_"+r.high+"_"+r.low,o=this.contextMap;null!=Jo[a]?o.setReserved(a,i):o.h[a]=i,this.hitMessageIdSet=l.fold(i.messages,function(e,t){if(e.hit){var n=e.id,i="_"+n.high+"_"+n.low;null!=Jo[i]?t.setReserved(i,1):t.h[i]=1}return t},this.hitMessageIdSet)}this.searching=!1,this.sendNotification("notify_search_messages",e)},saveSearchAttachmentsResult:function(e){null==this.attachmentsMap&&(this.attachmentsMap=new eo),this.attachmentsNextMarker=e.nextMarker;for(var t=0,n=e.contents;t<n.length;){var i=n[t];++t;var r=i.attachmentId,a="_"+r.high+"_"+r.low,o=this.attachmentsMap;null!=Jo[a]?o.setReserved(a,i):o.h[a]=i}this.searching=!1,this.sendNotification("notify_search_attachments",e)},getHitContext:function(e){var t=this.contextMap;return null!=Jo[e]?t.getReserved(e):t.h[e]},getFileInfo:function(e){var t=this.attachmentsMap;return null!=Jo[e]?t.getReserved(e):t.h[e]},isHitMessage:function(e){var t="_"+e.high+"_"+e.low,n=this.hitMessageIdSet;return null!=Jo[t]?n.existsReserved(t):n.h.hasOwnProperty(t)},reserveOnNormalizedKeywordPrepared:function(e){var t=this;if(null!=this.recentParams&&null!=this.recentParams.keyword){var n=null==this.recentParams?"":this.recentParams.keyword;if(this.cachedKeyword!=n){this.cachedKeyword=n,null==this.cachedNormalizedKeywords?this.cachedNormalizedKeywords=[]:this.cachedNormalizedKeywords.splice(0,this.cachedNormalizedKeywords.length);var i=new o("[ ]","g").split(S.htmlEscape(n,!0));l.iter(i.filter(B.isNotEmpty),function(e){t.cachedNormalizedKeywords.push(new br(e,!0,kr.normalize))})}e(this.cachedNormalizedKeywords)}},__class__:ma});var pa=function(){Br.call(this,"session"),this.createSessionCount=0};n["albero.proxy.SessionProxy"]=pa,pa.__name__=["albero","proxy","SessionProxy"],pa.__super__=Br,pa.prototype=r(Br.prototype,{start:function(e){this.api.createSession(e,Ro(this,this.onSessionCreated))},onSessionCreated:function(e){var t,n=this;if(e.notification){var i=this.dataStore,r=e.user.id;if(null!=i.me){var a=i.me.id;t=null!=a&&null!=r&&a.high==r.high&&a.low==r.low}else t=!1}else t=!1;var o=this.dataStore,s=e.user;o.me=s;for(var l=0,u=o.getDomains();l<u.length;){var c=u[l];++l,o.sendNotification("notify_update_user",o.me.toDomainUser(c.id))}o.sendNotification("current_user_changed",s),o.storageForUsers.setDirtyFlag(),this.settings.setConfiguration(e.configuration),this.settings.setDeviceId(e.device.device_id),this.sendNotification("data_recovering"),Promise.all([Nr.asyncPrepare()]).then(function(e){t?n.prepareNecessaryDataFromCache():(n.dataStore.clear(!1),n.prepareNecessaryDataFromServer()),n.createSessionCount++})},prepareNecessaryDataFromServer:function(){var e=this;this.api.resetNotification(function(t){var n=0,i=function(){4==(n+=1)&&e.onNecessaryDataPrepared()};e.api.getDomains(function(){e.dataStore.getDomains().length>0?e.api.getAnnouncementStatuses(i):i();var t=0,n=function(){2==(t+=1)&&e.api.getTalks(i)};e.api.getFriends(n),e.api.getAcquaintances(n)}),e.api.getAccountControlRequests(function(){e.api.getDomainInvites(i)}),e.api.getJoinedAccountControlGroup(i)})},prepareNecessaryDataFromCache:function(){var e=U.sortAndReturn(this.dataStore.getDomains(),function(e,t){var n=t.id,i=e.id,r=n.high-i.high|0;return r=0!=r?r:Ba.ucompare(n.low,i.low),n.high<0?i.high<0?r:-1:i.high>=0?r:1});this.api.sendDomainNotifications(e);for(var t=0;t<e.length;){var n=e[t];++t;var i=this.dataStore.getAnnouncementStatus(n.id);null==i&&(i=qe.fromDomainId(n.id),this.dataStore.setAnnouncementStatus(i)),this.api.sendAnnouncementStatusNotification(i),this.api.sendAddFriendNotifications(this.dataStore.getFriends(n.id)),this.api.sendAddAcquaintanceNotifications(this.dataStore.getAcquaintances(n.id))}this.api.sendTalkNotifications(this.dataStore.getTalks()),this.api.sendTalkStatusNotifications(this.dataStore.getTalkStatuses()),this.api.sendAddDomainInviteNotifications(this.dataStore.getDomainInvites()),this.api.sendAddAccountControlRequestNotifications(this.dataStore.getAccountControlRequests());var r=this.dataStore.getAccountControlGroup();null!=r&&this.api.sendJoinAccountControlGroupNotification(r),this.onNecessaryDataPrepared()},onNecessaryDataPrepared:function(){this.sendNotification("data_recovered"),this.api.startNotification(),this.api.startUpdateLastUsedAtIfNeed();var e=new kt(this.dataStore.getDomains()).getDirectAppsIds();this.api.getDirectApps(e).catch(function(e){})},__class__:pa});var ga=function(){this.deviceId=null,this.selectedDomainIdOnTalkSelectionChanged=null,this.selectedDomainId=null,this.remember=!0,Br.call(this,"settings")};n["albero.proxy.SettingsProxy"]=ga,ga.__name__=["albero","proxy","SettingsProxy"],ga.__interfaces__=[ii],ga.__super__=Br,ga.prototype=r(Br.prototype,{onRegister:function(){this.loadBrowserSettings()},getValidHost:function(){return"https://"+Qo.host},setAccessTokenRemember:function(e){this.remember=e},setAccessToken:function(e){this.remember&&(this.accessToken=e,this.sendNotification("access_token_changed",e))},getAccessToken:function(){return null==this.accessToken&&(this.accessToken=Qo.accessToken),this.accessToken},clearAccessToken:function(){this.accessToken=null},getOs:function(){return"bot"},getIDFV:function(){var e=L.getItem("idfv");return null!=e&&""!=e||(e=B.randomString(),L.setItem("idfv",e)),e},setConfiguration:function(e){this.configuration=e,this.sendNotification("configuration_changed",e)},getConfiguration:function(){return this.configuration},setDeviceId:function(e){this.deviceId=e},getDeviceId:function(){return this.deviceId},setSelectedDomainId:function(e){var t=this.selectedDomainId;null!=t&&null!=e&&t.high==e.high&&t.low==e.low||(null!=e?(L.setItem("selected_domain_id_h",g.string(e.high)),L.setItem("selected_domain_id_l",g.string(e.low))):(L.removeItem("selected_domain_id_h"),L.removeItem("selected_domain_id_l")),this.selectedDomainId=e,this.sendNotification("domain_selection_changed",e))},getLastSelectedDomainId:function(){var e,t=L.getItemAsInt("selected_domain_id_h"),n=L.getItemAsInt("selected_domain_id_l");null!=t&&null!=n?e=new pi(t,n):e=null;return e},getSelectedDomainId:function(){return this.selectedDomainId},getSelectedDomainIdOnTalkSelectionChanged:function(){return this.selectedDomainIdOnTalkSelectionChanged},clearDomainSelection:function(){this.selectedDomainId=null,L.removeItem("selected_domain_id_h"),L.removeItem("selected_domain_id_l")},clearSelectedTalk:function(e){null==e&&(e=ln.SingleTalkPane);var t=this.selectedDomainId;this.assureTalkSelectionMap("_"+t.high+"_"+t.low).remove(e),this.selectedDomainIdOnTalkSelectionChanged=this.selectedDomainId,this.sendNotification("talk_selection_changed",new ni(e,ai.NotSelected))},selectTalk:function(e,t,n,i){var r="_"+t.high+"_"+t.low;if(null==r)return!1;var a=this.assureTalkSelectionMap(r),o=ai.TalkSelected(n,i);a.set(e,o);var s=this.selectedDomainId;return null!=t&&null!=s&&t.high==s.high&&t.low==s.low&&(this.selectedDomainIdOnTalkSelectionChanged=this.selectedDomainId,this.sendNotification("talk_selection_changed",new ni(e,o)),!0)},selectAnnouncement:function(e){if(null==this.selectedDomainId)return!1;var t=this.selectedDomainId,n="_"+t.high+"_"+t.low;return this.assureTalkSelectionMap(n).set(e,ai.AnnouncementsSelected),this.selectedDomainIdOnTalkSelectionChanged=this.selectedDomainId,this.sendNotification("talk_selection_changed",new ni(e,ai.AnnouncementsSelected)),!0},hasSelectedTalkOrAnnouncements:function(e){null==e&&(e=ln.SingleTalkPane);var t=this.getTalkSelectionMap(this.selectedDomainId);return null!=t&&t.get(e)!=ai.NotSelected},hasSelectedTalk:function(e){null==e&&(e=ln.SingleTalkPane);var t=this.getTalkSelectionMap(this.selectedDomainId);if(null==t)return!1;var n=t.get(e);return null!=n&&0!=n[1]},getTalkSelectionMap:function(e){if(null==this.paneTalkSelections)return null;if(null==e)return null;var t="_"+e.high+"_"+e.low,n=this.paneTalkSelections;return null!=Jo[t]?n.getReserved(t):n.h[t]},assureTalkSelectionMap:function(e){null==this.paneTalkSelections&&(this.paneTalkSelections=new eo);var t=this.paneTalkSelections,n=null!=Jo[e]?t.getReserved(e):t.h[e];if(null==n){n=new Qa;var i=this.paneTalkSelections;null!=Jo[e]?i.setReserved(e,n):i.h[e]=n}return n},getSelectedTalkId:function(){var e=this.getTalkSelection(this.selectedDomainId,ln.SingleTalkPane);if(1==e[1]){e[3];return e[2]}return null},isSelectedTalkOrAnnouncements:function(e,t){return oi.isSelected(this.getTalkSelection(this.selectedDomainId,e),t)},getTalkSelection:function(e,t){if(null==this.paneTalkSelections)return ai.NotSelected;var n=this.getTalkSelectionMap(e);if(null==n)return ai.NotSelected;var i=n.get(t);return null==i?ai.NotSelected:i},setSelectedStampsetType:function(e){L.setItem("selected_stamp_tab_id",e.toTabId())},getSelectedStampsetType:function(){return Qn.fromTabId(L.getItem("selected_stamp_tab_id"))},clearSelectedStampsetType:function(){L.removeItem("selected_stamp_tab_id")},setInputTextForTalkId:function(e,t){null==e||0==e.length?this.clearInputTextForTalkId(t):(this.loadInputTextForAll(),this.inputTexts["_"+t.high+"_"+t.low]=e)},getInputTextForTalkId:function(e){this.loadInputTextForAll();var t=this.inputTexts["_"+e.high+"_"+e.low];return null!=t?t:""},clearInputTextForTalkId:function(e){this.loadInputTextForAll(),delete this.inputTexts["_"+e.high+"_"+e.low]},loadInputTextForAll:function(){null==this.inputTexts&&(this.inputTexts=L.getItemAsJson("input_text"),null==this.inputTexts&&(this.inputTexts={}))},saveInputTextForAll:function(){if(null!=this.inputTexts){var e=JSON.stringify(this.inputTexts);L.setItem("input_text",e)}},clearInputTextForAll:function(){L.removeItem("input_text"),this.inputTexts=null},setCopyProfileToAllDomains:function(e){e?L.setItem("copy_profile_to_all_domains","true"):L.removeItem("copy_profile_to_all_domains")},isCopyProfileToAllDomains:function(){return null!=L.getItem("copy_profile_to_all_domains")},setSearchHistoriesForSelectedDomain:function(e){if(null!=this.selectedDomainId){if(this.loadSearchHistoryForAll(),null==e){var t=this.selectedDomainId;delete this.searchHistories["_"+t.high+"_"+t.low]}else{var n=this.selectedDomainId;this.searchHistories["_"+n.high+"_"+n.low]=e}this.saveSearchHistoryForAll()}},getSearchHistoriesForSelectedDomain:function(){if(null==this.selectedDomainId)return null;this.loadSearchHistoryForAll();var e=this.selectedDomainId;return this.searchHistories["_"+e.high+"_"+e.low]},loadSearchHistoryForAll:function(){null==this.searchHistories&&(this.searchHistories=L.getItemAsJson("search_histories"),null==this.searchHistories&&(this.searchHistories={}))},saveSearchHistoryForAll:function(){if(null!=this.searchHistories){var e=JSON.stringify(this.searchHistories);L.setItem("search_histories",e)}},setSelectedDepartmentId:function(e,t){if(null!=e){if(this.loadSelectedDepartmentIdsForAll(),null==t)this.selectedDepartmentIds.remove("_"+e.high+"_"+e.low);else{var n="_"+e.high+"_"+e.low,i=this.selectedDepartmentIds;null!=Jo[n]?i.setReserved(n,t):i.h[n]=t}this.saveSelectedDepartmentIdsForAll()}},getSelectedDepartmentId:function(e){if(null==e)return null;this.loadSelectedDepartmentIdsForAll();var t="_"+e.high+"_"+e.low,n=this.selectedDepartmentIds;return null!=Jo[t]?n.getReserved(t):n.h[t]},loadSelectedDepartmentIdsForAll:function(){null==this.selectedDepartmentIds&&(this.selectedDepartmentIds=L.getItemWithUnserialize("selected_department_ids"),null==this.selectedDepartmentIds&&(this.selectedDepartmentIds=new eo))},saveSelectedDepartmentIdsForAll:function(){null!=this.selectedDepartmentIds&&L.setItemWithSerialize("selected_department_ids",this.selectedDepartmentIds)},setRightPanelOpened:function(e){var t=this.browserSettings.createCopy();t.talkRightPanelOpened=e,this.applyTalkSettings(t)},isRightPanelOpened:function(){return this.browserSettings.talkRightPanelOpened},setRightPanelWidth:function(e){var t=this.browserSettings.createCopy();t.talkRightPanelWidth=e,this.applyTalkSettings(t)},getRightPanelWidth:function(){return this.browserSettings.talkRightPanelWidth},setMultiViewMode:function(e){e?L.setItem("multi_view_mode","true"):L.removeItem("multi_view_mode")},isMultiViewMode:function(){return null!=L.getItem("multi_view_mode")},setPasswordWarningSkipUntil:function(e){null==e?L.removeItem("password_warning_skip_until"):L.setItem("password_warning_skip_until","_"+e.high+"_"+e.low)},getPasswordWarningSkipUntil:function(){var e=L.getItem("password_warning_skip_until");return null==e?null:R.makeFromIdStr(e)},setLastUsedExpiredAt:function(e){null==e?L.removeItem("last_used_expired_at"):L.setItem("last_used_expired_at","_"+e.high+"_"+e.low)},getLastUsedExpiredAt:function(){var e=L.getItem("last_used_expired_at");return null==e?null:R.makeFromIdStr(e)},setOnPremise:function(e){this.onPremises=e},isOnPremises:function(){return this.onPremises},updateThumbnailExpansionEnabled:function(e,t){var n=this.browserSettings.createCopy();n.setThumbnailExpansionEnabled("_"+e.high+"_"+e.low,t),this.applyUserDataSettings(n)},isThumbnailExpansionEnabled:function(e){return this.browserSettings.isThumbnailExpansionEnabled("_"+e.high+"_"+e.low)},getBrowserSettings:function(){return this.browserSettings},applyNotificationSettings:function(e){return e.copyNotificationSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyKeywordWatchingSettings:function(e){return e.copyKeywordSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyTalkSettings:function(e){return e.copyTalkSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyUserDataSettings:function(e){return e.copyUserDataContainerTo(this.browserSettings),this.saveBrowserSettings()},applyLanguageSettings:function(e){return e.copyLanguageSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyConferenceSettings:function(e){return e.copyConferenceSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyDomainsSortModeSettings:function(e){return e.copyDomainsSortModeSettingsTo(this.browserSettings),this.saveBrowserSettings()},applyAppLeftPanelOpenedSettings:function(e){return e.copyAppLeftPanelOpenedSettingsTo(this.browserSettings),this.saveBrowserSettings()},loadBrowserSettings:function(){this.browserSettings=Ze.fromJson(L.getItemAsJson(Ze.NAME))},saveBrowserSettings:function(){var e=L.getItemAsJson(Ze.NAME);return null==e&&(e={}),this.browserSettings.copyTo(e),L.setItem(Ze.NAME,JSON.stringify(e))},__class__:ga});var va=function(){Br.call(this,"talksService")};n["albero.proxy.TalksServiceProxy"]=va,va.__name__=["albero","proxy","TalksServiceProxy"],va.__super__=Br,va.prototype=r(Br.prototype,{getDomainTalksOrderedByTimestampDesc:function(e){return U.reverseAndReturn(this.getDomainTalksOrderedByTimestampAsc(e))},getDomainTalksOrderedByTimestampAsc:function(e){return U.sortAndReturn(this.getDomainTalks(e).map(Ro(this,this.createTalkPack)),ti.compareTalkOrderingTimestamp).map(Ro(this,this.getTalkFromTalkPack))},getDomainTalksCount:function(e){return this.getDomainTalks(e).length},hasConferenceInTalk:function(e){return null!=e&&this.dataStore.hasConferenceInTalk(e.id)},isFavoriteTalk:function(e){var t=this.dataStore.getTalkStatus(e.id);return null!=t&&null!=t.orderInFavorites},hasUnread:function(e){var t=this.dataStore.getTalkStatus(e.id);return null!=t&&0!=t.unreadCount},getTalkFromTalkPack:function(e){return e.talk},getTalkIdFromTalk:function(e){return e.id},getDomainTalks:function(e){return null==e?[]:this.dataStore.getTalks().filter(function(t){var n=t.domainId;return null!=n&&null!=e&&n.high==e.high&&n.low==e.low})},createTalkPack:function(e){return new ti(e,this.dataStore.getTalkStatus(e.id))},__class__:va});var Sa=function(){Br.call(this,"userPresences")};n["albero.proxy.UserPresencesProxy"]=Sa,Sa.__name__=["albero","proxy","UserPresencesProxy"],Sa.__super__=Br,Sa.prototype=r(Br.prototype,{getUserPresenceState:function(e,t){var n=P.map(this.getUserPresence(e),function(e){return e.toState(t)});switch(n[1]){case 0:return n[2];case 1:return vi.GT_60}},getUserPresence:function(e){return P.option(this.dataStore.getUserPresence(e))},getLastUsedAtString:function(e){var t=P.map(P.flatMap(this.getUserPresence(e),function(e){return e.lastUsedAtOpt}),function(e){return M.datetimeString(e)});switch(t[1]){case 0:return t[2];case 1:return" - "}},__class__:Sa});var ya=function(){Br.call(this,"wsApi")};n["albero.proxy.WsApiProxy"]=ya,ya.__name__=["albero","proxy","WsApiProxy"],ya.__super__=Br,ya.prototype=r(Br.prototype,{createAccessToken:function(e,t,n,i){var r=this;return new Promise(function(a,o){r.apiCaller.callImmediately("create_access_token",[e,t,n,i,""],function(e){a(e)},function(e){o(e)})})},createAccessTokenById:function(e,t,n,i,r){var a=this;return new Promise(function(o,s){a.apiCaller.callImmediately("create_access_token_by_id",[e,t,n,i,r,""],function(e){o(e)},function(e){s(e)})})},authorizeDevice:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.callImmediately("authorize_device",[e,t],function(e){i(e)},function(e){r(e)})})},createSession:function(e,t,n){var i=this,r=null!=n?[e,t,n]:[e,t];return new Promise(function(e,t){i.apiCaller.callImmediatelyReliable("create_session",r,function(t){var n=new Un(t);e(n)},function(e){t(e)},function(e){return i.shouldRetryCreateSession(e)?Za.Some(i.apiCaller.retryTimeForReplicationLag()):Za.None})})},shouldRetryCreateSession:function(e){return 401==e.code&&"invalid token"==e.message},startNotification:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("start_notification",[],function(e){t(e)},function(e){n(e)})})},resetNotification:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("reset_notification",[],function(e){t(e)},function(e){n(e)})})},addFriend:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("add_friend",[e,t],function(e){var t={domainId:e[0],domainUser:e[1]};i(t)},function(e){r(e)})})},deleteFriend:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("delete_friend",[e,t],function(e){var t={domainId:e[0],userId:e[1]};i(t)},function(e){r(e)})})},getFriends:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("get_friends",[],function(e){var n=e.map(function(e){return{domainId:e[0],domainUsers:e[1].map(function(e){return new Ct(e)})}});t(n)},function(e){n(e)})})},getAcquaintances:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("get_acquaintances",[],function(e){var n=e.map(function(e){return{domainId:e[0],domainUsers:e[1].map(function(e){return new Ct(e)})}});t(n)},function(e){n(e)})})},getAllUsers:function(e,t,n,i){var r=this,a=l.fold(t,function(e,t){return e+t},0);return new Promise(function(t,o){r.apiCaller.call("get_domain_users",[e,a,n,i],function(e){var n={marker:e.marker,nextMarker:e.next_marker,contents:U.asArray(e.contents).map(function(e){return new Ct(e)})};t(n)},function(e){o(e)})})},searchDomainUsers:function(e,t,n,i,r){var a=this,o=l.fold(n,function(e,t){return e+t},0);return new Promise(function(n,s){a.apiCaller.call("search_domain_users",[e,t,o,i,r],function(e){var t={marker:e.marker,nextMarker:e.next_marker,contents:U.asArray(e.contents).map(function(e){return new Ct(e)})};n(t)},function(e){s(e)})})},getUsers:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("get_users",[e,t],function(e){var t=e.map(function(e){return new Ct(e)});i(t)},function(e){r(e)})})},getProfile:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("get_profile",[e,t],function(e){var t=new hn(e);i(t)},function(e){r(e)})})},updateUser:function(e,t,n,i){var r=this;return new Promise(function(a,o){r.apiCaller.call("update_user",[e,t,n,i],function(e){var t=new Xt(e);a(t)},function(e){o(e)})})},updateProfile:function(e){var t=this;return new Promise(function(n,i){var r=pn.convertToApiParams(e);t.apiCaller.call("update_profile",[r],function(e){var t=new Xt(e);n(t)},function(e){i(e)})})},getPresences:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("get_presences",[e,t],function(e){var t=M.nowAsInt64(),n=e.map(function(e){return new gi(e,t)});i(n)},function(e){r(e)})})},getDomains:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("get_domains",[],function(e){var n=e.map(function(e){return new yt(e)});t(n)},function(e){n(e)})})},leaveDomain:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.call("leave_domain",[e],function(e){n(e)},function(e){i(e)})})},getDomainInvites:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("get_domain_invites",[],function(e){var n=e.map(function(e){return new Dt(e)});t(n)},function(e){n(e)})})},acceptDomainInvite:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.call("accept_domain_invite",[e],function(e){n(e)},function(e){i(e)})})},deleteDomainInvite:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.call("delete_domain_invite",[e],function(e){n(e)},function(e){i(e)})})},createGroupTalk:function(e,t,n){var i=this;return new Promise(function(r,a){i.apiCaller.call("create_group_talk",[e,t,n.allowDisplayPastMessages,!0],function(e){var t=new Jn(e);r(t)},function(e){a(e)})})},createPairTalk:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("create_pair_talk",[e,t],function(e){var t=new Jn(e);i(t)},function(e){r(e)})})},updateGroupTalk:function(e,t,n,i){var r=this;return new Promise(function(a,o){r.apiCaller.call("update_group_talk",[e,t,n,i],function(e){var t=new Jn(e);a(t)},function(e){o(e)})})},addTalkers:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("add_talkers",[e,t,!0],function(e){var t=new Jn(e);i(t)},function(e){r(e)})})},deleteTalker:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("delete_talker",[e,t],function(e){Mr.resolveVoid(i)},function(e){r(e)})})},getTalks:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("get_talks",[],function(e){var n=e.map(function(e){return new Jn(e)});t(n)},function(e){n(e)})})},getTalkStatuses:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("get_talk_statuses",[],function(e){var n=e.map(function(e){return new si(e)});t(n)},function(e){n(e)})})},getReadStatus:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("get_read_status",[e,t],function(e){i(new nn(e))},function(e){r(e)})})},createAnnouncement:function(e,t,n){var i=this;return new Promise(function(r,a){var o=i.apiCaller,s=Zt.enumIndex(t);o.call("create_announcement",[e,s,n],function(e){var t=new Ve(e);r(t)},function(e){a(e)})})},getAnnouncements:function(e,t,n,i){var r=this;return new Promise(function(a,o){var s=r.apiCaller,l=n.sinceId,u=n.maxId,c=sn.orderToInt(i);s.call("get_announcements",[e,t,l,u,c],function(e){var t=e.map(function(e){return new Ve(e)});a(t)},function(e){o(e)})})},getAnnouncementStatuses:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("get_announcement_statuses",[],function(e){var n=e.map(function(e){return new qe(e)});t(n)},function(e){n(e)})})},getAnnouncementStatus:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.callApiReliable("get_announcement_status",[e],function(e){var t=new qe(e);n(t)},function(e){i(e)},function(e){return 400==e.code&&"invalid domain_id"==e.message?Za.Some(t.apiCaller.retryTimeForReplicationLag()):Za.None})})},updateAnnouncementReadStatus:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("update_announcement_status",[e,t],function(e){i(e)},function(e){r(e)})})},getMessages:function(e,t,n,i){var r=this;return new Promise(function(a,o){var s=r.apiCaller,l=n.sinceId,u=n.maxId,c=sn.orderToInt(i);s.call("get_messages",[e,t,l,u,c],function(e){var t=e.map(function(e){return new Zt(e)});a(t)},function(e){o(e)})})},createMessage:function(e,t,n){var i=this;return t==$t.file||t==$t.textMultipleFile?new Promise(function(r,a){var o=i.apiCaller,s=Zt.enumIndex(t);o.callApiReliable("create_message",[e,s,n],function(e){var t=new Zt(e);r(t)},function(e){a(e)},function(e){return i.shouldRetryCreateMessage(e)?Za.Some(i.apiCaller.retryTimeForReplicationLag()):Za.None})}):new Promise(function(r,a){var o=i.apiCaller,s=Zt.enumIndex(t);o.call("create_message",[e,s,n],function(e){var t=new Zt(e);r(t)},function(e){a(e)})})},shouldRetryCreateMessage:function(e){return null!=e.code&&(500==e.code?"Internal Error (IllegalStateException)"==e.message:400==e.code&&"invalid file_id"==e.message)},deleteMessage:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("delete_message",[e,t],function(e){i(e)},function(e){r(e)})})},scheduleMessage:function(e,t,n,i){var r=this;return(n==$t.file||n==$t.textMultipleFile?new Promise(function(a,o){var s=r.apiCaller,l=Zt.enumIndex(n);s.callApiReliable("schedule_message",[e,t,l,i],function(e){a(e)},function(e){o(e)},function(e){return r.shouldRetryScheduleMessage(e)?Za.Some(r.apiCaller.retryTimeForReplicationLag()):Za.None})}):new Promise(function(a,o){var s=r.apiCaller,l=Zt.enumIndex(n);s.call("schedule_message",[e,t,l,i],function(e){a(e)},function(e){o(e)})})).then(function(r){return qi.fromParams({id:r,talkId:t,createMessageAt:e,type:n,content:i})})},shouldRetryScheduleMessage:function(e){return null!=e.code&&(500==e.code?"Internal Error (IllegalStateException)"==e.message:400==e.code&&"invalid file_id"==e.message)},deleteScheduledMessage:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.call("delete_scheduled_message",[e],function(e){n(e)},function(e){i(e)})})},getScheduledMessages:function(e,t,n,i){var r=this;return new Promise(function(a,o){r.apiCaller.call("get_scheduled_messages",[e,t,n,i],function(n){var i=new Ti(e,t,n);a(i)},function(e){o(e)})})},updateReadStatuses:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.callApiReliable("update_read_statuses",[e,t],function(e){i(e)},function(e){r(e)},function(e){return 429==e.code&&"too many requests"==e.message?Za.Some(1e3*n.asInt(e.detail.retry_after)):Za.None})})},searchMessagesAroundDateTime:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("search_messages_around_datetime",[e,t],function(e){var n=new Ii(t,e);i(n)},function(e){r(e)})})},createUploadAuth:function(e,t,n,i,r){var a=this;return new Promise(function(o,s){var l=a.apiCaller,u=fi.getUseTypeInt(r);l.call("create_upload_auth",[e,t,n,i,u],function(e){o(new Jr(e))},function(e){s(e)})})},createDownloadAuth:function(e,t,n){var i=this;return new Promise(function(r,a){i.apiCaller.callApiReliable("create_download_auth",[e,t,n],function(e){r(new Rt(e))},function(e){a(e)},function(e){return 429==e.code&&"too many requests"==e.message?Za.Some(1e3*i.asInt(e.detail.retry_after)):Za.None})})},deleteAttachment:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("delete_attachment",[e,t],function(e){i(e)},function(e){r(e)})})},getAttachments:function(e,t,n,i){var r=this;return new Promise(function(a,o){r.apiCaller.call("get_attachments",[e,t,n,i],function(e){var t=e.map(function(e){return new xt(e)});a(t)},function(e){o(e)})})},getQuestions:function(e,t,n,i,r,a){var o=this,s=yn.fromTypeToInt(n);return new Promise(function(n,l){o.apiCaller.call("get_actions",[e,t,s,i,r,a.sinceId,a.maxId],function(e){var t=e.map(function(e){return new yn(e)});n(t)},function(e){l(e)})})},getQuestion:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.callApiReliable("get_action",[e],function(e){var t=new yn(e);n(t)},function(e){i(e)})})},setMessageReaction:function(e,t,n){var i=this;return new Promise(function(r,a){i.apiCaller.call("set_message_reaction",[e,t,n],function(e){r(e)},function(e){a(e)})})},resetMessageReaction:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("reset_message_reaction",[e,t],function(e){i(e)},function(e){r(e)})})},getMessageReactionSummaries:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.callApiReliable("get_message_reaction_summaries",[e,t],function(e){var t=e.map(function(e){return new Sr(e)});i(t)},function(e){r(e)})})},getMessageReactionUsers:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("get_message_reaction_users",[e,t],function(e){var t=new yr(e);i(t)},function(e){r(e)})})},getAvailableMessageReactions:function(e){var t=this;return new Promise(function(n,i){t.apiCaller.call("get_available_message_reactions",[e],function(e){var t=e.map(function(e){return new pr(e)});n(t)},function(e){i(e)})})},getSolutions:function(e,t){var n=this;return new Promise(function(i,r){n.apiCaller.call("get_solutions",[e,t],function(e){var t=e.map(function(e){return new xn(e)});i(t)},function(e){r(e)})})},getConferences:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("get_conferences",[],function(e){var n=e.map(function(e){return new nt(e)});t(n)},function(e){n(e)})})},getAccountControlRequests:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("get_account_control_requests",[],function(e){var n=e.map(function(e){return new Ke(e)});t(n)},function(e){n(e)})})},getJoinedAccountControlGroup:function(){var e=this;return new Promise(function(t,n){e.apiCaller.call("get_joined_account_control_group",[],function(e){var n=e.map(function(e){return new Ge(e)});t(n)},function(e){n(e)})})},asInt:function(e){return ho.__cast(e,Go)},__class__:ya});var wa=n["albero_cli.UpdateNoteAttachment"]={__ename__:["albero_cli","UpdateNoteAttachment"],__constructs__:["LocalFileAttachment","RemoteFileAttachment"]};wa.LocalFileAttachment=function(e){var t=["LocalFileAttachment",0,e];return t.__enum__=wa,t.toString=i,t},wa.RemoteFileAttachment=function(e){var t=["RemoteFileAttachment",1,e];return t.__enum__=wa,t.toString=i,t},wa.__empty_constructs__=[];var Ta=function(){};n["albero_cli.INotes"]=Ta,Ta.__name__=["albero_cli","INotes"],Ta.prototype={__class__:Ta};var Ia=function(e,t){this.delegate=e;var n=null!=t?t:{max:24,interval:12e4};this.ratelimit=new m(n.max,n.interval)};n["albero_cli.LimitedNotes"]=Ia,Ia.__name__=["albero_cli","LimitedNotes"],Ia.__interfaces__=[Ta],Ia.prototype={limit:function(e){return this.ratelimit.apply(e)},get:function(e){var t=this;return this.limit(function(){return t.delegate.get(e)})},update:function(e,t){var n=this;return this.limit(function(){return n.delegate.update(e,t)})},delete:function(e){var t=this;return this.limit(function(){return t.delegate.delete(e)})},__class__:Ia};var Ea=function(e,t,n){this.utils=e,this.api=t,this.fileService=n};n["albero_cli.Notes"]=Ea,Ea.__name__=["albero_cli","Notes"],Ea.__interfaces__=[Ta],Ea.all=function(e,t){return l.foreach(e,t)},Ea.isValidAsAttachment=function(e){return Ea.isStringNullOrEmpty(e.url)?!Ea.isStringNullOrEmpty(e.path):!Ea.isStringNullOrEmpty(e.id)&&!Ea.isStringNullOrEmpty(e.name)&&null!=e.content_size&&!Ea.isStringNullOrEmpty(e.content_type)},Ea.isStringNullOrEmpty=function(e){return null==e||0==e.length},Ea.prototype={toNoteId:function(e){return new $i(this.utils.parseInt64(e.id))},handleResponse:function(e,t,n){return function(i,r){if(null!=i){var a=ka.of(i);t(a)}else{var o=n(r);e(o)}}},get:function(e){var t=this,n=this.toNoteId(e);return new Promise(function(e,i){var r=t.api,a=t.handleResponse(e,i,xa.of);r.getNote(n,a)})},update:function(e,t){var n=this,i=e.talkId_i64,r=new $i(e.id_i64),a=this.validateUpdateNoteInput(t);switch(a[1]){case 0:var o=a[2];return Promise.reject(o);case 1:var s=a[2],l=this.mergeNoteObject(e,s),u=this.createNoteLocalEdit(i,r,l,null);return new Promise(function(e,t){var i=n.api,a=l.currentRevision,o=n.handleResponse(e,t,Pa.of);i.updateNoteV2(r,a,u,!0,o)})}},validateUpdateNoteInput:function(e){if(null!=e.note_title){if("string"!=typeof e.note_title)return qa.Left(ka.createInvalidParameterError("note_title is not String"));if(0==e.note_title.length)return qa.Left(ka.createInvalidParameterError("note_title is empty"))}if(null!=e.note_content){if("string"!=typeof e.note_content)return qa.Left(ka.createInvalidParameterError("note_content is not String"));if(0==e.note_content.length)return qa.Left(ka.createInvalidParameterError("note_content is empty"))}var t=null;if(null!=e.note_attachments){if(!(e.note_attachments instanceof Array&&null==e.note_attachments.__enum__&&Ea.all(e.note_attachments,Ea.isValidAsAttachment))){var n="note_attachments is invalid: "+JSON.stringify(e.note_attachments);return qa.Left(ka.createInvalidParameterError(n))}t=this.toUpdateNoteAttachmentArray(e.note_attachments)}return qa.Right({title:e.note_title,content:e.note_content,attachments:t})},mergeNoteObject:function(e,t){var n={title:e.noteRevision.title,content:e.noteRevision.contentText,attachments:this.toUpdateNoteAttachmentArray(e.get_attachments()),currentRevision:e.noteRevision.revision};return null!=t.title&&(n.title=t.title),null!=t.content&&(n.content=t.content),null!=t.attachments&&(n.attachments=t.attachments),n},toUpdateNoteAttachmentArray:function(e){var t=Ro(ko=this.utils,ko.parseInt64);return l.array(l.map(e,function(e){if(Ea.isStringNullOrEmpty(e.url))return wa.LocalFileAttachment(e);var n=null==e?null:JSON.parse(JSON.stringify(e));return n.id=t(e.id),wa.RemoteFileAttachment(n)}))},createNoteLocalEdit:function(e,t,n,i){var r=this.createNoteAttachmentFileInfoList(n.attachments);return new er(e,t,n.title,n.content,r,i)},createNoteAttachmentFileInfoList:function(e){for(var t=[],n=0;n<e.length;){var i=e[n];++n;var r=null;switch(i[1]){case 0:var a=i[2],o=this.fileService.createDummyFile(a.path,a.name,a.type);r=xt.createStagedFileInfoFromDummyFile(null,o,null);break;case 1:var s=i[2];r=xt.createUploadedFileInfo(s)}t.push(r)}return t},delete:function(e){var t=this,n=this.toNoteId(e);return new Promise(function(e,i){var r=t.api,a=t.handleResponse(e,i,Ua.of);r.deleteNote(n,a)})},__class__:Ea};var Na=function(e){var t=e.id;this.id="_"+t.high+"_"+t.low,this.id_i64=e.id,this.name=e.name,this.content_type=e.contentType,this.content_size=e.contentSize,this.url=e.url};n["albero_cli.entity.RemoteFileInfo"]=Na,Na.__name__=["albero_cli","entity","RemoteFileInfo"],Na.of=function(e){return new Na(e)},Na.prototype={__class__:Na};var Aa=function(e){this.id=e.noteId.toString(),this.id_i64=e.noteId.value;var t=e.talkId;this.talkId="_"+t.high+"_"+t.low,this.talkId_i64=e.talkId,this.createdBy=e.createdBy,this.createdAt=e.createdAt,this.noteRevision=ba.of(e.noteRevision),Object.defineProperty(this,"attachments",{get:this.get_attachments})};n["albero_cli.entity.note.Note"]=Aa,Aa.__name__=["albero_cli","entity","note","Note"],Aa.of=function(e){return new Aa(e)},Aa.prototype={get_attachments:function(){return this.noteRevision.contentFiles},__class__:Aa};var ba=function(e){this.revision=e.revision,this.title=e.title,this.contentType=Zi.getValue(e.contentType),this.contentText=e.contentText,this.contentFiles=this.convertFiles(e.contentFiles),this.createdBy=e.createdBy,this.createdAt=e.createdAt};n["albero_cli.entity.note.NoteRevision"]=ba,ba.__name__=["albero_cli","entity","note","NoteRevision"],ba.of=function(e){return new ba(e)},ba.prototype={convertFiles:function(e){return null==e||e.length<=0?[]:e.map(function(e){return Na.of(e)})},__class__:ba};var Da=function(){};n["puremvc.interfaces.IMediator"]=Da,Da.__name__=["puremvc","interfaces","IMediator"],Da.prototype={__class__:Da};var Ma=function(e,t){V.call(this),this.mediatorName=null!=e?e:Ma.NAME,null!=t&&(this.viewComponent=t)};n["puremvc.patterns.mediator.Mediator"]=Ma,Ma.__name__=["puremvc","patterns","mediator","Mediator"],Ma.__interfaces__=[Da],Ma.__super__=V,Ma.prototype=r(V.prototype,{getMediatorName:function(){return this.mediatorName},setViewComponent:function(e){this.viewComponent=e},getViewComponent:function(){return this.viewComponent},listNotificationInterests:function(){return[]},handleNotification:function(e){},onRegister:function(){},onRemove:function(){},__class__:Ma});var Ca=function(){Ma.call(this,"commandline",null)};n["albero_cli.mediator.CommandLineMediator"]=Ca,Ca.__name__=["albero_cli","mediator","CommandLineMediator"],Ca.__super__=Ma,Ca.prototype=r(Ma.prototype,{onRegister:function(){this.getViewComponent();this.eventEmitter=a.getInstance(),this.dataRecovered=!1,this.startDataSaver()},listNotificationInterests:function(){return["app_state_changed","access_token_changed","current_user_changed","configuration_changed","domain_selection_changed","talk_selection_changed","talk_list_scroll_to_talk_top_needed","user_selection_needed","user_selection_changed","friend_selection_needed","common_stamp_set_loaded","stamp_selection_started","stamp_selection_ended","stamp_selection_changed","action_selection_changed","current_page_changed","current_page_reassgined","fileinfo_selection_changed","message_fileinfo_selection_changed","staged_fileinfo_selection_changed","staged_fileinfos_added","staged_fileinfos_moved","error_occurred","brand_badge_changed","send_form_top_changed","solutions_loaded","right_pane_opened","right_pane_closed","password_expiration_overed","password_expiration_warned","photo_editor_saved","mc_authenticated_user_received","keyword_watching_updated","keyword_detaction_updated","department_selection_changed_for_members_page","presences_updated","noteinfo_selection_changed","start_note_editing","start_notification_failed","signed_out","data_recovering","data_recovered","notify_update_user","notify_add_friend","notify_add_acquaintance","notify_add_acquaintances","notify_delete_friend","notify_delete_acquaintance","notify_delete_acquaintances","notify_update_domain_users","get_domain_users_responsed","get_users_responsed","get_profile_responsed","get_profile_errored","update_user_responsed","update_user_errored","update_profile_responsed","update_profile_errored","notify_update_department_tree","notify_update_department_users","get_department_tree_responsed","get_department_tree_canceled","get_department_users_responsed","get_department_users_canceled","get_department_user_count_responsed","get_me_responsed","department_user_count_cleared","department_user_ids_prepared","notify_add_domain_invite","notify_accept_domain_invite","notify_delete_domain_invite","notify_join_domain","notify_update_domain","notify_leave_domain","notify_add_domain_members","notify_create_pair_talk","notify_create_group_talk","notify_update_group_talk","notify_add_talkers","notify_add_talkers_including_me","notify_delete_talker","notify_delete_talk","notify_create_message","notify_delete_message","notify_update_read_statuses","notify_update_talk_status","notify_update_local_talk_status","notify_get_messages","notify_get_message_status","notify_add_favorite_talk","notify_delete_favorite_talk","notify_disable_push_notification","notify_enable_push_notification","create_message_start","create_message_complete","create_message_fail","notify_create_announcement","notify_delete_announcement","notify_update_announcement_status","notify_get_announcements","create_announcement_start","create_announcement_complete","create_announcement_fail","notify_update_question","get_questions_responsed","notify_create_attachment","notify_delete_attachment","get_note_statuses_loaded","get_note_loaded","get_note_failed_by_note_not_found","create_note_completed","create_note_failed","update_note_local_edit","clear_note_local_edit","update_note_setting_completed","update_note_setting_failed_by_not_found","update_note_setting_failed_by_conflict","update_note_setting_failed_by_editing","update_note_completed","delete_note_completed","notify_create_note","notify_update_note_partially","notify_delete_note","notify_update_note_for_setting","notify_update_note_for_revision","create_note_button_clicked","notify_lock_note","notify_unlock_note","get_file_responsed","notify_search_messages","notify_search_attachments","notify_search_messages_fail","notify_search_attachments_fail","notify_search_prepare","notify_search_clear","notify_filter_box_text_changed","notify_search_box_popup","notify_add_account_control_request","notify_delete_account_control_request","notify_join_account_control_group","notify_update_account_control_group_partially","notify_leave_account_control_group","prepare_conference_from_message","join_conference_responsed","join_conference_canceled","notify_open_conference","notify_close_conference","notify_conference_participant_join","notify_conference_participant_limit","notify_conference_participant_reject","notify_all_talk_members_rejected_conference"]},handleNotification:function(e){var t=e.getName();switch(t){case"current_page_changed":var n=e.getBody();w.enumEq(n,G.error)&&(this.dataRecovered=!1),this.eventEmitter.emit(e.getName(),e.getBody());break;case"data_recovered":if(this.dataRecovered)return;this.dataRecovered=!0,this.eventEmitter.emit(e.getName());break;case"data_recovering":this.dataRecovered=!1,this.eventEmitter.emit(e.getName());break;case"error_occurred":this.eventEmitter.emit(e.getName(),new Error("AdapterError"),e.getBody());break;case"signed_out":break;case"start_notification_failed":Ar._e("["+s.dateStr(new Date)+"] ","start_notification failed.","","","","");break;default:this.eventEmitter.emit(e.getName(),e.getBody())}},startDataSaver:function(){var e=this;Ya.delay(function(){e.dataRecovered&&e.dataStore.saveIfNeeded(),e.startDataSaver()},5e3)},__class__:Ca});var ka=function(e,t,n){this.code=e,this.message=t,this.detail=n};n["albero_cli.value.ApiErrorResponse"]=ka,ka.__name__=["albero_cli","value","ApiErrorResponse"],ka.of=function(e){switch(e.code){case 400:if("invalid parameter"==e.message)return new ka(Oa.INVALID_PARAMETER);break;case 403:if("forbidden"==e.message)return new ka(Oa.FORBIDDEN);break;case 404:if("not found"==e.message)return new ka(Oa.NOT_FOUND);break;case 409:switch(e.message){case"conflict":return new ka(Oa.CONFLICT);case"locked by another user":return new ka(Oa.LOCKED_BY_ANOTHER_USER,null,{userId:e.detail.user_id})}break;case 429:return ka.createTooManyRequestsError(e.message,e.detail.retry_after)}var t="please contact us: error = "+g.string(e);return Ar._w("["+s.dateStr(new Date)+"] ",t,"","","",""),new ka(Oa.UNKNOWN)},ka.createInvalidParameterError=function(e){return new ka(Oa.INVALID_PARAMETER,e)},ka.createTooManyRequestsError=function(e,t){return new ka(Oa.TOO_MANY_REQUESTS,e,{retryAfter:t})},ka.prototype={__class__:ka};var Oa=function(){};n["albero_cli.value.ApiErrorCode"]=Oa,Oa.__name__=["albero_cli","value","ApiErrorCode"];var Ra=function(){};n["albero_cli.value.IDUtil"]=Ra,Ra.__name__=["albero_cli","value","IDUtil"],Ra._from=function(e){if(null==e)return null;if("string"==typeof e){var t=Ra.parseInt64(e);if(null!=t)return new Fa(t)}if(null!=e.high&&null!=e.low){var n=Ra.parseInt64(Ra.stringifyInt64(e,!0));if(null!=n)return new Fa(n)}return null},Ra.parseInt64=function(e){return e.length>0&&"_"==e.charAt(0)?R.makeFromIdStr(e):R.parse(e)},Ra.stringifyInt64=function(e,t){return null==t&&(t=!1),t?"_"+e.high+"_"+e.low:Ga.toString(e)},Ra.prototype={from:function(e){return Ra._from(e)},__class__:Ra};var Fa=function(e){this.value=e};n["albero_cli.value.ID"]=Fa,Fa.__name__=["albero_cli","value","ID"],Fa.prototype={toString:function(){return Ga.toString(this.value)},toDaabID:function(){var e=this.value;return"_"+e.high+"_"+e.low},toInt64:function(){return this.value},eq:function(e){if(this==e)return!0;if(null==e)return!1;var t=this.value,n=e.value;return null!=t&&null!=n&&t.high==n.high&&t.low==n.low},__class__:Fa};var Ua=function(){};n["albero_cli.value.note.DeleteNoteResult"]=Ua,Ua.__name__=["albero_cli","value","note","DeleteNoteResult"],Ua.of=function(e){return new Ua},Ua.prototype={__class__:Ua};var xa=function(e){this.note=e};n["albero_cli.value.note.GetNoteResult"]=xa,xa.__name__=["albero_cli","value","note","GetNoteResult"],xa.of=function(e){return new xa(Aa.of(e.note))},xa.prototype={__class__:xa};var Pa=function(e){this.note=e};n["albero_cli.value.note.UpdateNoteResult"]=Pa,Pa.__name__=["albero_cli","value","note","UpdateNoteResult"],Pa.of=function(e){return new Pa(Aa.of(e.note))},Pa.prototype={__class__:Pa};var La=function(){};n["haxe.IMap"]=La,La.__name__=["haxe","IMap"],La.prototype={__class__:La};var Ba={};n["haxe._Int32.Int32_Impl_"]=Ba,Ba.__name__=["haxe","_Int32","Int32_Impl_"],Ba.ucompare=function(e,t){return e<0?t<0?~t-~e|0:1:t<0?-1:e-t|0};var Ga={};n["haxe._Int64.Int64_Impl_"]=Ga,Ga.__name__=["haxe","_Int64","Int64_Impl_"],Ga.toString=function(e){var t=e,n=new pi(0,0);if(t.high==n.high&&t.low==n.low)return"0";var i="",r=!1;t.high<0&&(r=!0);for(var a=new pi(0,10);;){var o=new pi(0,0);if(t.high==o.high&&t.low==o.low)break;var s=Ga.divMod(t,a);if(s.modulus.high<0){var l=s.modulus,u=~l.high,c=-l.low;if(0==c){u++;u|=0}i=new pi(u,c).low+i;var _=s.quotient,h=~_.high,d=-_.low;if(0==d){h++;h|=0}t=new pi(h,d)}else i=s.modulus.low+i,t=s.quotient}return r&&(i="-"+i),i},Ga.divMod=function(e,t){if(0==t.high)switch(t.low){case 0:throw new _o("divide by zero");case 1:return{quotient:new pi(e.high,e.low),modulus:new pi(0,0)}}var n,i=e.high<0!=t.high<0;if(e.high<0){var r=~e.high,a=-e.low;if(0==a){r++;r|=0}n=new pi(r,a)}else{n=new pi(e.high,e.low)}if(t.high<0){var o=~t.high,s=-t.low;if(0==s){o++;o|=0}t=new pi(o,s)}else t=t;for(var l=new pi(0,0),u=new pi(0,1);!(t.high<0);){var c=Ba.ucompare(t.high,n.high),_=0!=c?c:Ba.ucompare(t.low,n.low),h=1;if(0==(h&=63))t=new pi(t.high,t.low);else if(h<32){t=new pi(t.high<<h|t.low>>>32-h,t.low<<h)}else{t=new pi(t.low<<h-32,0)}var d=1;if(0==(d&=63))u=new pi(u.high,u.low);else if(d<32){u=new pi(u.high<<d|u.low>>>32-d,u.low<<d)}else{u=new pi(u.low<<d-32,0)}if(_>=0)break}for(;;){var f=new pi(0,0);if(u.high==f.high&&u.low==f.low)break;var m=Ba.ucompare(n.high,t.high);if((0!=m?m:Ba.ucompare(n.low,t.low))>=0){l=new pi(l.high|u.high,l.low|u.low);var p=n.high-t.high|0,g=n.low-t.low|0;if(Ba.ucompare(n.low,t.low)<0){p--;p|=0}n=new pi(p,g)}var v=1;if(0==(v&=63))u=new pi(u.high,u.low);else if(v<32){u=new pi(u.high>>>v,u.high<<32-v|u.low>>>v)}else{u=new pi(0,u.high>>>v-32)}var S=1;if(0==(S&=63))t=new pi(t.high,t.low);else if(S<32){t=new pi(t.high>>>S,t.high<<32-S|t.low>>>S)}else{t=new pi(0,t.high>>>S-32)}}if(i){var y=~l.high,w=-l.low;if(0==w){y++;y|=0}l=new pi(y,w)}if(e.high<0){var T=~n.high,I=-n.low;if(0==I){T++;T|=0}n=new pi(T,I)}return{quotient:l,modulus:n}};var Ha=function(){};n["haxe.Int64Helper"]=Ha,Ha.__name__=["haxe","Int64Helper"],Ha.parseString=function(e){var t=new pi(0,10),n=new pi(0,0),i=new pi(0,1),r=!1,a=S.trim(e);"-"==a.charAt(0)&&(r=!0,a=a.substring(1,a.length));for(var o=a.length,l=0,u=o;l<u;){var c=l++,_=s.cca(a,o-1-c)-48;if(_<0||_>9)throw new _o("NumberFormatError");var h=new pi(_>>31,_);if(r){var d=65535&i.low,f=i.low>>>16,m=65535&h.low,p=h.low>>>16,g=Ba._mul(d,m),v=Ba._mul(f,m),y=Ba._mul(d,p),w=g,T=(Ba._mul(f,p)+(y>>>16)|0)+(v>>>16)|0;if(w=w+(y<<=16)|0,Ba.ucompare(w,y)<0){T++;T|=0}if(w=w+(v<<=16)|0,Ba.ucompare(w,v)<0){T++;T|=0}T=T+(Ba._mul(i.low,h.high)+Ba._mul(i.high,h.low)|0)|0;var I=new pi(T,w),E=n.high-I.high|0,N=n.low-I.low|0;if(Ba.ucompare(n.low,I.low)<0){E--;E|=0}if(!((n=new pi(E,N)).high<0))throw new _o("NumberFormatError: Underflow")}else{var A=65535&i.low,b=i.low>>>16,D=65535&h.low,M=h.low>>>16,C=Ba._mul(A,D),k=Ba._mul(b,D),O=Ba._mul(A,M),R=C,F=(Ba._mul(b,M)+(O>>>16)|0)+(k>>>16)|0;if(R=R+(O<<=16)|0,Ba.ucompare(R,O)<0){F++;F|=0}if(R=R+(k<<=16)|0,Ba.ucompare(R,k)<0){F++;F|=0}F=F+(Ba._mul(i.low,h.high)+Ba._mul(i.high,h.low)|0)|0;var U=new pi(F,R),x=n.high+U.high|0,P=n.low+U.low|0;if(Ba.ucompare(P,n.low)<0){x++;x|=0}if((n=new pi(x,P)).high<0)throw new _o("NumberFormatError: Overflow")}var L=65535&i.low,B=i.low>>>16,G=65535&t.low,H=t.low>>>16,z=Ba._mul(L,G),Y=Ba._mul(B,G),K=Ba._mul(L,H),W=z,j=(Ba._mul(B,H)+(K>>>16)|0)+(Y>>>16)|0;if(W=W+(K<<=16)|0,Ba.ucompare(W,K)<0){j++;j|=0}if(W=W+(Y<<=16)|0,Ba.ucompare(W,Y)<0){j++;j|=0}j=j+(Ba._mul(i.low,t.high)+Ba._mul(i.high,t.low)|0)|0,i=new pi(j,W)}return n};var za=function(){this.buf=new v,this.cache=[],this.useCache=za.USE_CACHE,this.useEnumIndex=za.USE_ENUM_INDEX,this.shash=new eo,this.scount=0};n["haxe.Serializer"]=za,za.__name__=["haxe","Serializer"],za.run=function(e){var t=new za;return t.serialize(e),t.toString()},za.prototype={toString:function(){return this.buf.b},serializeString:function(e){var t=this.shash,n=null!=Jo[e]?t.getReserved(e):t.h[e];if(null!=n)return this.buf.b+="R",void(this.buf.b+=null==n?"null":""+n);var i=this.shash,r=this.scount++;null!=Jo[e]?i.setReserved(e,r):i.h[e]=r,this.buf.b+="y",e=encodeURIComponent(e),this.buf.b+=g.string(e.length),this.buf.b+=":",this.buf.b+=null==e?"null":""+e},serializeRef:function(e){for(var t=typeof e,n=0,i=this.cache.length;n<i;){var r=n++,a=this.cache[r];if(typeof a==t&&a==e)return this.buf.b+="r",this.buf.b+=null==r?"null":""+r,!0}return this.cache.push(e),!1},serializeFields:function(e){for(var t=0,n=p.fields(e);t<n.length;){var i=n[t];++t,this.serializeString(i),this.serialize(p.field(e,i))}this.buf.b+="g"},serialize:function(e){var t=w.typeof(e);switch(t[1]){case 0:this.buf.b+="n";break;case 1:var n=e;if(0==n)return void(this.buf.b+="z");this.buf.b+="i",this.buf.b+=null==n?"null":""+n;break;case 2:var i=e;isNaN(i)?this.buf.b+="k":isFinite(i)?(this.buf.b+="d",this.buf.b+=null==i?"null":""+i):this.buf.b+=i<0?"m":"p";break;case 3:this.buf.b+=e?"t":"f";break;case 4:if(ho.__instanceof(e,Wo)){var r=w.getClassName(e);this.buf.b+="A",this.serializeString(r)}else if(ho.__instanceof(e,jo))this.buf.b+="B",this.serializeString(w.getEnumName(e));else{if(this.useCache&&this.serializeRef(e))return;this.buf.b+="o",this.serializeFields(e)}break;case 5:throw new _o("Cannot serialize function");case 6:var a=t[2];if(a==String)return void this.serializeString(e);if(this.useCache&&this.serializeRef(e))return;switch(a){case Array:var o=0;this.buf.b+="a";for(var l=0,c=e.length;l<c;){var _=l++;null==e[_]?++o:(o>0&&(1==o?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==o?"null":""+o),o=0),this.serialize(e[_]))}o>0&&(1==o?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==o?"null":""+o)),this.buf.b+="h";break;case Date:var h=e;this.buf.b+="v",this.buf.b+=g.string(h.getTime());break;case u:this.buf.b+="l";for(var d=e.h;null!=d;){var f=d.item;d=d.next;var m=f;this.serialize(m)}this.buf.b+="h";break;case Ja:this.buf.b+="q";for(var v=e,S=v.keys();S.hasNext();){var y=S.next();this.buf.b+=":",this.buf.b+=null==y?"null":""+y,this.serialize(v.h[y])}this.buf.b+="h";break;case Xa:this.buf.b+="M";for(var T=e,I=T.keys();I.hasNext();){var E=I.next(),N=p.field(E,"__id__");p.deleteField(E,"__id__"),this.serialize(E),E.__id__=N,this.serialize(T.h[E.__id__])}this.buf.b+="h";break;case eo:this.buf.b+="b";for(var A=e,b=A.keys();b.hasNext();){var D=b.next();this.serializeString(D),this.serialize(null!=Jo[D]?A.getReserved(D):A.h[D])}this.buf.b+="h";break;case to:var M=e;this.buf.b+="s",this.buf.b+=g.string(Math.ceil(8*M.length/6)),this.buf.b+=":";var C=0,k=M.length-2,O=za.BASE64_CODES;if(null==O){var R=za.BASE64.length;O=new Array(R);for(var F=0,U=za.BASE64.length;F<U;){var x=F++;O[x]=s.cca(za.BASE64,x)}za.BASE64_CODES=O}for(;C<k;){var P=M.b[C++],L=M.b[C++],B=M.b[C++];this.buf.b+=String.fromCharCode(O[P>>2]),this.buf.b+=String.fromCharCode(O[63&(P<<4|L>>4)]),this.buf.b+=String.fromCharCode(O[63&(L<<2|B>>6)]),this.buf.b+=String.fromCharCode(O[63&B])}if(C==k){var G=M.b[C++],H=M.b[C++];this.buf.b+=String.fromCharCode(O[G>>2]),this.buf.b+=String.fromCharCode(O[63&(G<<4|H>>4)]),this.buf.b+=String.fromCharCode(O[H<<2&63])}else if(C==k+1){var z=M.b[C++];this.buf.b+=String.fromCharCode(O[z>>2]),this.buf.b+=String.fromCharCode(O[z<<4&63])}break;default:this.useCache&&this.cache.pop(),null!=e.hxSerialize?(this.buf.b+="C",this.serializeString(w.getClassName(a)),this.useCache&&this.cache.push(e),e.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(w.getClassName(a)),this.useCache&&this.cache.push(e),this.serializeFields(e))}break;case 7:var Y=t[2];if(this.useCache){if(this.serializeRef(e))return;this.cache.pop()}this.buf.b+=g.string(this.useEnumIndex?"j":"w"),this.serializeString(w.getEnumName(Y)),this.useEnumIndex?(this.buf.b+=":",this.buf.b+=g.string(e[1])):this.serializeString(e[0]),this.buf.b+=":";var K=e.length;this.buf.b+=g.string(K-2);for(var W=2,j=K;W<j;){var V=W++;this.serialize(e[V])}this.useCache&&this.cache.push(e);break;default:throw new _o("Cannot serialize "+g.string(e))}},__class__:za};var Ya=function(e){var t=this;this.id=setInterval(function(){t.run()},e)};n["haxe.Timer"]=Ya,Ya.__name__=["haxe","Timer"],Ya.delay=function(e,t){var n=new Ya(t);return n.run=function(){n.stop(),e()},n},Ya.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:Ya};var Ka=function(){};n["haxe._Unserializer.DefaultResolver"]=Ka,Ka.__name__=["haxe","_Unserializer","DefaultResolver"],Ka.prototype={resolveClass:function(e){return w.resolveClass(e)},resolveEnum:function(e){return w.resolveEnum(e)},__class__:Ka};var Wa=function(e){this.buf=e,this.length=e.length,this.pos=0,this.scache=[],this.cache=[];var t=Wa.DEFAULT_RESOLVER;null==t&&(t=new Ka,Wa.DEFAULT_RESOLVER=t),this.resolver=t};n["haxe.Unserializer"]=Wa,Wa.__name__=["haxe","Unserializer"],Wa.initCodes=function(){for(var e=[],t=0,n=Wa.BASE64.length;t<n;){var i=t++;e[Wa.BASE64.charCodeAt(i)]=i}return e},Wa.run=function(e){return new Wa(e).unserialize()},Wa.prototype={readDigits:function(){for(var e=0,t=!1,n=this.pos;;){var i=this.buf.charCodeAt(this.pos);if(i!=i)break;if(45!=i){if(i<48||i>57)break;e=10*e+(i-48),this.pos++}else{if(this.pos!=n)break;t=!0,this.pos++}}return t&&(e*=-1),e},readFloat:function(){for(var e=this.pos;;){var t=this.buf.charCodeAt(this.pos);if(t!=t)break;if(!(t>=43&&t<58||101==t||69==t))break;this.pos++}return parseFloat(s.substr(this.buf,e,this.pos-e))},unserializeObject:function(e){for(;;){if(this.pos>=this.length)throw new _o("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var t=this.unserialize();if("string"!=typeof t)throw new _o("Invalid object key");var n=this.unserialize();e[t]=n}this.pos++},unserializeEnum:function(e,t){if(58!=this.buf.charCodeAt(this.pos++))throw new _o("Invalid enum format");var n=this.readDigits();if(0==n)return w.createEnum(e,t);for(var i=[];n-- >0;)i.push(this.unserialize());return w.createEnum(e,t,i)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var e=this.unserialize(),t=this.resolver.resolveClass(e);if(null==t)throw new _o("Class not found "+e);return t;case 66:var n=this.unserialize(),i=this.resolver.resolveEnum(n);if(null==i)throw new _o("Enum not found "+n);return i;case 67:var r=this.unserialize(),a=this.resolver.resolveClass(r);if(null==a)throw new _o("Class not found "+r);var o=w.createEmptyInstance(a);if(this.cache.push(o),o.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new _o("Invalid custom data");return o;case 77:var l=new Xa;this.cache.push(l);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var c=this.unserialize();l.set(c,this.unserialize())}return this.pos++,l;case 82:var _=this.readDigits();if(_<0||_>=this.scache.length)throw new _o("Invalid string reference");return this.scache[_];case 97:this.buf;var h=[];for(this.cache.push(h);;){var d=this.buf.charCodeAt(this.pos);if(104==d){this.pos++;break}if(117==d){this.pos++;var f=this.readDigits();h[h.length+f-1]=null}else h.push(this.unserialize())}return h;case 98:var m=new eo;this.cache.push(m);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var p=this.unserialize(),g=this.unserialize();null!=Jo[p]?m.setReserved(p,g):m.h[p]=g}return this.pos++,m;case 99:var v=this.unserialize(),S=this.resolver.resolveClass(v);if(null==S)throw new _o("Class not found "+v);var y=w.createEmptyInstance(S);return this.cache.push(y),this.unserializeObject(y),y;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var T=this.unserialize(),I=this.resolver.resolveEnum(T);if(null==I)throw new _o("Enum not found "+T);this.pos++;var E=this.readDigits(),N=I.__constructs__.slice()[E];if(null==N)throw new _o("Unknown enum index "+T+"@"+E);var A=this.unserializeEnum(I,N);return this.cache.push(A),A;case 107:return NaN;case 108:var b=new u;this.cache.push(b);for(this.buf;104!=this.buf.charCodeAt(this.pos);)b.add(this.unserialize());return this.pos++,b;case 109:return-1/0;case 110:return null;case 111:var D={};return this.cache.push(D),this.unserializeObject(D),D;case 112:return 1/0;case 113:var M=new Ja;this.cache.push(M);this.buf;for(var C=this.buf.charCodeAt(this.pos++);58==C;){var k=this.readDigits(),O=this.unserialize();M.h[k]=O,C=this.buf.charCodeAt(this.pos++)}if(104!=C)throw new _o("Invalid IntMap format");return M;case 114:var R=this.readDigits();if(R<0||R>=this.cache.length)throw new _o("Invalid reference");return this.cache[R];case 115:var F=this.readDigits(),U=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<F)throw new _o("Invalid bytes length");var x=Wa.CODES;null==x&&(x=Wa.initCodes(),Wa.CODES=x);for(var P=this.pos,L=3&F,B=P+(F-L),G=new to(new Xo(3*(F>>2)+(L>=2?L-1:0))),H=0;P<B;){var z=x[U.charCodeAt(P++)],Y=x[U.charCodeAt(P++)];G.b[H++]=255&(z<<2|Y>>4);var K=x[U.charCodeAt(P++)];G.b[H++]=255&(Y<<4|K>>2);var W=x[U.charCodeAt(P++)];G.b[H++]=255&(K<<6|W)}if(L>=2){var j=x[U.charCodeAt(P++)],V=x[U.charCodeAt(P++)];if(G.b[H++]=255&(j<<2|V>>4),3==L){var q=x[U.charCodeAt(P++)];G.b[H++]=255&(V<<4|q>>2)}}return this.pos+=F,this.cache.push(G),G;case 116:return!0;case 118:var Q;if(this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4))Q=s.strDate(s.substr(this.buf,this.pos,19)),this.pos+=19;else{var J=this.readFloat();Q=new Date(J)}return this.cache.push(Q),Q;case 119:var X=this.unserialize(),Z=this.resolver.resolveEnum(X);if(null==Z)throw new _o("Enum not found "+X);var $=this.unserializeEnum(Z,this.unserialize());return this.cache.push($),$;case 120:throw _o.wrap(this.unserialize());case 121:var ee=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<ee)throw new _o("Invalid string length");var te=s.substr(this.buf,this.pos,ee);return this.pos+=ee,te=decodeURIComponent(te.split("+").join(" ")),this.scache.push(te),te;case 122:return 0}throw this.pos--,new _o("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:Wa};var ja=function(){};n["haxe.ds.BalancedTree"]=ja,ja.__name__=["haxe","ds","BalancedTree"],ja.prototype={set:function(e,t){this.root=this.setLoop(e,t,this.root)},get:function(e){for(var t=this.root;null!=t;){var n=this.compare(e,t.key);if(0==n)return t.value;t=n<0?t.left:t.right}return null},remove:function(e){try{return this.root=this.removeLoop(e,this.root),!0}catch(e){if(e instanceof _o&&(e=e.val),ho.__instanceof(e,String))return!1;throw e}},iterator:function(){var e=[];return this.iteratorLoop(this.root,e),s.iter(e)},keys:function(){var e=[];return this.keysLoop(this.root,e),s.iter(e)},setLoop:function(e,t,n){if(null==n)return new Va(null,e,t,null);var i=this.compare(e,n.key);if(0==i)return new Va(n.left,e,t,n.right,null==n?0:n._height);if(i<0){var r=this.setLoop(e,t,n.left);return this.balance(r,n.key,n.value,n.right)}var a=this.setLoop(e,t,n.right);return this.balance(n.left,n.key,n.value,a)},removeLoop:function(e,t){if(null==t)throw new _o("Not_found");var n=this.compare(e,t.key);return 0==n?this.merge(t.left,t.right):n<0?this.balance(this.removeLoop(e,t.left),t.key,t.value,t.right):this.balance(t.left,t.key,t.value,this.removeLoop(e,t.right))},iteratorLoop:function(e,t){null!=e&&(this.iteratorLoop(e.left,t),t.push(e.value),this.iteratorLoop(e.right,t))},keysLoop:function(e,t){null!=e&&(this.keysLoop(e.left,t),t.push(e.key),this.keysLoop(e.right,t))},merge:function(e,t){if(null==e)return t;if(null==t)return e;var n=this.minBinding(t);return this.balance(e,n.key,n.value,this.removeMinBinding(t))},minBinding:function(e){if(null==e)throw new _o("Not_found");return null==e.left?e:this.minBinding(e.left)},removeMinBinding:function(e){return null==e.left?e.right:this.balance(this.removeMinBinding(e.left),e.key,e.value,e.right)},balance:function(e,t,n,i){var r=null==e?0:e._height,a=null==i?0:i._height;if(r>a+2){var o=e.left,s=e.right;return(null==o?0:o._height)>=(null==s?0:s._height)?new Va(e.left,e.key,e.value,new Va(e.right,t,n,i)):new Va(new Va(e.left,e.key,e.value,e.right.left),e.right.key,e.right.value,new Va(e.right.right,t,n,i))}if(a>r+2){var l=i.right,u=i.left;return(null==l?0:l._height)>(null==u?0:u._height)?new Va(new Va(e,t,n,i.left),i.key,i.value,i.right):new Va(new Va(e,t,n,i.left.left),i.left.key,i.left.value,new Va(i.left.right,i.key,i.value,i.right))}return new Va(e,t,n,i,(r>a?r:a)+1)},compare:function(e,t){return p.compare(e,t)},__class__:ja};var Va=function(e,t,n,i,r){if(null==r&&(r=-1),this.left=e,this.key=t,this.value=n,this.right=i,-1==r){var a,o=this.left,s=this.right;if((null==o?0:o._height)>(null==s?0:s._height)){var l=this.left;a=null==l?0:l._height}else{var u=this.right;a=null==u?0:u._height}this._height=a+1}else this._height=r};n["haxe.ds.TreeNode"]=Va,Va.__name__=["haxe","ds","TreeNode"],Va.prototype={__class__:Va};var qa=n["haxe.ds.Either"]={__ename__:["haxe","ds","Either"],__constructs__:["Left","Right"]};qa.Left=function(e){var t=["Left",0,e];return t.__enum__=qa,t.toString=i,t},qa.Right=function(e){var t=["Right",1,e];return t.__enum__=qa,t.toString=i,t},qa.__empty_constructs__=[];var Qa=function(){ja.call(this)};n["haxe.ds.EnumValueMap"]=Qa,Qa.__name__=["haxe","ds","EnumValueMap"],Qa.__interfaces__=[La],Qa.__super__=ja,Qa.prototype=r(ja.prototype,{compare:function(e,t){var n=e[1]-t[1];if(0!=n)return n;var i=e.slice(2),r=t.slice(2);return 0==i.length&&0==r.length?0:this.compareArgs(i,r)},compareArgs:function(e,t){var n=e.length-t.length;if(0!=n)return n;for(var i=0,r=e.length;i<r;){var a=i++,o=this.compareArg(e[a],t[a]);if(0!=o)return o}return 0},compareArg:function(e,t){return p.isEnumValue(e)&&p.isEnumValue(t)?this.compare(e,t):e instanceof Array&&null==e.__enum__&&t instanceof Array&&null==t.__enum__?this.compareArgs(e,t):p.compare(e,t)},__class__:Qa});var Ja=function(){this.h={}};n["haxe.ds.IntMap"]=Ja,Ja.__name__=["haxe","ds","IntMap"],Ja.__interfaces__=[La],Ja.prototype={get:function(e){return this.h[e]},remove:function(e){return!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(0|t);return s.iter(e)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var e=this.it.next();return this.ref[e]}}},__class__:Ja};var Xa=function(){this.h={__keys__:{}}};n["haxe.ds.ObjectMap"]=Xa,Xa.__name__=["haxe","ds","ObjectMap"],Xa.__interfaces__=[La],Xa.assignId=function(e){return e.__id__=++Xa.count},Xa.getId=function(e){return e.__id__},Xa.prototype={set:function(e,t){var n=e.__id__||(e.__id__=++Xa.count);this.h[n]=t,this.h.__keys__[n]=e},get:function(e){return this.h[e.__id__]},keys:function(){var e=[];for(var t in this.h.__keys__)this.h.hasOwnProperty(t)&&e.push(this.h.__keys__[t]);return s.iter(e)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var e=this.it.next();return this.ref[e.__id__]}}},__class__:Xa};var Za=n["haxe.ds.Option"]={__ename__:["haxe","ds","Option"],__constructs__:["Some","None"]};Za.Some=function(e){var t=["Some",0,e];return t.__enum__=Za,t.toString=i,t},Za.None=["None",1],Za.None.toString=i,Za.None.__enum__=Za,Za.__empty_constructs__=[Za.None];var $a=function(e,t){this.map=e,this.keys=t,this.index=0,this.count=t.length};n["haxe.ds._StringMap.StringMapIterator"]=$a,$a.__name__=["haxe","ds","_StringMap","StringMapIterator"],$a.prototype={hasNext:function(){return this.index<this.count},next:function(){var e=this.map,t=this.keys[this.index++];return null!=Jo[t]?e.getReserved(t):e.h[t]},__class__:$a};var eo=function(){this.h={}};n["haxe.ds.StringMap"]=eo,eo.__name__=["haxe","ds","StringMap"],eo.__interfaces__=[La],eo.prototype={get:function(e){return null!=Jo[e]?this.getReserved(e):this.h[e]},setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},getReserved:function(e){return null==this.rh?null:this.rh["$"+e]},existsReserved:function(e){return null!=this.rh&&this.rh.hasOwnProperty("$"+e)},remove:function(e){return null!=Jo[e]?(e="$"+e,!(null==this.rh||!this.rh.hasOwnProperty(e))&&(delete this.rh[e],!0)):!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){return s.iter(this.arrayKeys())},arrayKeys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(t);if(null!=this.rh)for(var t in this.rh)36==t.charCodeAt(0)&&e.push(t.substr(1));return e},iterator:function(){return new $a(this,this.arrayKeys())},__class__:eo};var to=function(e){this.length=e.byteLength,this.b=new Zo(e),this.b.bufferValue=e,e.hxBytes=this,e.bytes=this.b};n["haxe.io.Bytes"]=to,to.__name__=["haxe","io","Bytes"],to.alloc=function(e){return new to(new Xo(e))},to.ofString=function(e){for(var t=[],n=0;n<e.length;){var i=e.charCodeAt(n++);55296<=i&&i<=56319&&(i=i-55232<<10|1023&e.charCodeAt(n++)),i<=127?t.push(i):i<=2047?(t.push(192|i>>6),t.push(128|63&i)):i<=65535?(t.push(224|i>>12),t.push(128|i>>6&63),t.push(128|63&i)):(t.push(240|i>>18),t.push(128|i>>12&63),t.push(128|i>>6&63),t.push(128|63&i))}return new to(new Zo(t).buffer)},to.ofData=function(e){var t=e.hxBytes;return null!=t?t:new to(e)},to.fastGet=function(e,t){return e.bytes[t]},to.prototype={getString:function(e,t){if(e<0||t<0||e+t>this.length)throw new _o(lo.OutsideBounds);for(var n="",i=this.b,r=String.fromCharCode,a=e,o=e+t;a<o;){var s=i[a++];if(s<128){if(0==s)break;n+=r(s)}else if(s<224)n+=r((63&s)<<6|127&i[a++]);else if(s<240){n+=r((31&s)<<12|(127&i[a++])<<6|127&i[a++])}else{var l=(15&s)<<18|(127&i[a++])<<12|(127&i[a++])<<6|127&i[a++];n+=r(55232+(l>>10)),n+=r(1023&l|56320)}}return n},toString:function(){return this.getString(0,this.length)},__class__:to};var no=function(){this.b=[]};n["haxe.io.BytesBuffer"]=no,no.__name__=["haxe","io","BytesBuffer"],no.prototype={getBytes:function(){var e=new to(new Zo(this.b).buffer);return this.b=null,e},__class__:no};var io=function(){};n["haxe.io.Input"]=io,io.__name__=["haxe","io","Input"],io.prototype={readByte:function(){throw new _o("Not implemented")},readBytes:function(e,t,n){var i=n,r=e.b;if(t<0||n<0||t+n>e.length)throw new _o(lo.OutsideBounds);try{for(;i>0;)r[t]=this.readByte(),++t,--i}catch(e){if(e instanceof _o&&(e=e.val),!ho.__instanceof(e,so))throw e}return n-i},set_bigEndian:function(e){return this.bigEndian=e,e},read:function(e){for(var t=new to(new Xo(e)),n=0;e>0;){var i=this.readBytes(t,n,e);if(0==i)throw new _o(lo.Blocked);n+=i,e-=i}return t},readFloat:function(){return uo.i32ToFloat(this.readInt32())},readDouble:function(){var e=this.readInt32(),t=this.readInt32();return this.bigEndian?uo.i64ToDouble(t,e):uo.i64ToDouble(e,t)},readInt8:function(){var e=this.readByte();return e>=128?e-256:e},readInt16:function(){var e=this.readByte(),t=this.readByte(),n=this.bigEndian?t|e<<8:e|t<<8;return 0!=(32768&n)?n-65536:n},readUInt16:function(){var e=this.readByte(),t=this.readByte();return this.bigEndian?t|e<<8:e|t<<8},readInt32:function(){var e=this.readByte(),t=this.readByte(),n=this.readByte(),i=this.readByte();return this.bigEndian?i|n<<8|t<<16|e<<24:e|t<<8|n<<16|i<<24},__class__:io};var ro=function(e,t,n){if(null==t&&(t=0),null==n&&(n=e.length-t),t<0||n<0||t+n>e.length)throw new _o(lo.OutsideBounds);this.b=e.b,this.pos=t,this.len=n,this.totlen=n};n["haxe.io.BytesInput"]=ro,ro.__name__=["haxe","io","BytesInput"],ro.__super__=io,ro.prototype=r(io.prototype,{readByte:function(){if(0==this.len)throw new _o(new so);return this.len--,this.b[this.pos++]},readBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw new _o(lo.OutsideBounds);if(0==this.len&&n>0)throw new _o(new so);this.len<n&&(n=this.len);for(var i=this.b,r=e.b,a=0,o=n;a<o;){var s=a++;r[t+s]=i[this.pos+s]}return this.pos+=n,this.len-=n,n},__class__:ro});var ao=function(){};n["haxe.io.Output"]=ao,ao.__name__=["haxe","io","Output"],ao.prototype={writeByte:function(e){throw new _o("Not implemented")},writeBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw new _o(lo.OutsideBounds);for(var i=e.b,r=n;r>0;)this.writeByte(i[t]),++t,--r;return n},set_bigEndian:function(e){return this.bigEndian=e,e},write:function(e){for(var t=e.length,n=0;t>0;){var i=this.writeBytes(e,n,t);if(0==i)throw new _o(lo.Blocked);n+=i,t-=i}},writeFloat:function(e){this.writeInt32(uo.floatToI32(e))},writeDouble:function(e){var t=uo.doubleToI64(e);this.bigEndian?(this.writeInt32(t.high),this.writeInt32(t.low)):(this.writeInt32(t.low),this.writeInt32(t.high))},writeInt8:function(e){if(e<-128||e>=128)throw new _o(lo.Overflow);this.writeByte(255&e)},writeInt16:function(e){if(e<-32768||e>=32768)throw new _o(lo.Overflow);this.writeUInt16(65535&e)},writeUInt16:function(e){if(e<0||e>=65536)throw new _o(lo.Overflow);this.bigEndian?(this.writeByte(e>>8),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8))},writeInt32:function(e){this.bigEndian?(this.writeByte(e>>>24),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8&255),this.writeByte(e>>16&255),this.writeByte(e>>>24))},__class__:ao};var oo=function(){this.b=new no};n["haxe.io.BytesOutput"]=oo,oo.__name__=["haxe","io","BytesOutput"],oo.__super__=ao,oo.prototype=r(ao.prototype,{writeByte:function(e){this.b.b.push(e)},writeBytes:function(e,t,n){var i=this.b;if(t<0||n<0||t+n>e.length)throw new _o(lo.OutsideBounds);i.b;for(var r=e.b,a=t,o=t+n;a<o;){var s=a++;i.b.push(r[s])}return n},getBytes:function(){return this.b.getBytes()},__class__:oo});var so=function(){};n["haxe.io.Eof"]=so,so.__name__=["haxe","io","Eof"],so.prototype={toString:function(){return"Eof"},__class__:so};var lo=n["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};lo.Blocked=["Blocked",0],lo.Blocked.toString=i,lo.Blocked.__enum__=lo,lo.Overflow=["Overflow",1],lo.Overflow.toString=i,lo.Overflow.__enum__=lo,lo.OutsideBounds=["OutsideBounds",2],lo.OutsideBounds.toString=i,lo.OutsideBounds.__enum__=lo,lo.Custom=function(e){var t=["Custom",3,e];return t.__enum__=lo,t.toString=i,t},lo.__empty_constructs__=[lo.Blocked,lo.Overflow,lo.OutsideBounds];var uo=function(){};n["haxe.io.FPHelper"]=uo,uo.__name__=["haxe","io","FPHelper"],uo.i32ToFloat=function(e){var t=e>>>23&255,n=8388607&e;return 0==n&&0==t?0:(1-(e>>>31<<1))*(1+Math.pow(2,-23)*n)*Math.pow(2,t-127)},uo.floatToI32=function(e){if(0==e)return 0;var t=e<0?-e:e,n=Math.floor(Math.log(t)/.6931471805599453);n<-127?n=-127:n>128&&(n=128);var i=Math.round(8388608*(t/Math.pow(2,n)-1));return 8388608==i&&n<128&&(i=0,++n),(e<0?-2147483648:0)|n+127<<23|i},uo.i64ToDouble=function(e,t){var n=(t>>20&2047)-1023,i=4294967296*(1048575&t)+2147483648*(e>>>31)+(2147483647&e);return 0==i&&-1023==n?0:(1-(t>>>31<<1))*(1+Math.pow(2,-52)*i)*Math.pow(2,n)},uo.doubleToI64=function(e){var t=uo.i64tmp;if(0==e)t.low=0,t.high=0;else if(isFinite(e)){var n=e<0?-e:e,i=Math.floor(Math.log(n)/.6931471805599453),r=Math.round(4503599627370496*(n/Math.pow(2,i)-1)),a=0|r,o=r/4294967296|0;t.low=a,t.high=(e<0?-2147483648:0)|i+1023<<20|o}else e>0?(t.low=0,t.high=2146435072):(t.low=0,t.high=-1048576);return t};var co=function(){};n["haxe.rtti.Meta"]=co,co.__name__=["haxe","rtti","Meta"],co.getMeta=function(e){return e.__meta__},co.getFields=function(e){var t=co.getMeta(e);return null==t||null==t.fields?{}:t.fields};var _o=function(e){Error.call(this),this.val=e,this.message=String(e),Error.captureStackTrace&&Error.captureStackTrace(this,_o)};n["js._Boot.HaxeError"]=_o,_o.__name__=["js","_Boot","HaxeError"],_o.wrap=function(e){return e instanceof Error?e:new _o(e)},_o.__super__=Error,_o.prototype=r(Error.prototype,{__class__:_o});var ho=function(){};n["js.Boot"]=ho,ho.__name__=["js","Boot"],ho.getClass=function(e){if(e instanceof Array&&null==e.__enum__)return Array;var t=e.__class__;if(null!=t)return t;var n=ho.__nativeClassName(e);return null!=n?ho.__resolveNativeClass(n):null},ho.__string_rec=function(e,t){if(null==e)return"null";if(t.length>=5)return"<...>";var n=typeof e;switch("function"==n&&(e.__name__||e.__ename__)&&(n="object"),n){case"function":return"<function>";case"object":if(e instanceof Array){if(e.__enum__){if(2==e.length)return e[0];var i=e[0]+"(";t+="\t";for(var r=2,a=e.length;r<a;){var o=r++;i+=2!=o?","+ho.__string_rec(e[o],t):ho.__string_rec(e[o],t)}return i+")"}var s=e.length,l="[";t+="\t";for(var u=0,c=s;u<c;){var _=u++;l+=(_>0?",":"")+ho.__string_rec(e[_],t)}return l+="]"}var h;try{h=e.toString}catch(e){return"???"}if(null!=h&&h!=Object.toString&&"function"==typeof h){var d=e.toString();if("[object Object]"!=d)return d}var f=null,m="{\n";t+="\t";var p=null!=e.hasOwnProperty;for(var f in e)p&&!e.hasOwnProperty(f)||"prototype"!=f&&"__class__"!=f&&"__super__"!=f&&"__interfaces__"!=f&&"__properties__"!=f&&(2!=m.length&&(m+=", \n"),m+=t+f+" : "+ho.__string_rec(e[f],t));return m+="\n"+(t=t.substring(1))+"}";case"string":return e;default:return String(e)}},ho.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;var n=e.__interfaces__;if(null!=n)for(var i=0,r=n.length;i<r;){var a=n[i++];if(a==t||ho.__interfLoop(a,t))return!0}return ho.__interfLoop(e.__super__,t)},ho.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array&&null==e.__enum__;case Yo:return"boolean"==typeof e;case Ho:return!0;case zo:return"number"==typeof e;case Go:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(e instanceof t)return!0;if(ho.__interfLoop(ho.getClass(e),t))return!0}else if("object"==typeof t&&ho.__isNativeObj(t)&&e instanceof t)return!0;return t==Wo&&null!=e.__name__||(t==jo&&null!=e.__ename__||e.__enum__==t)}},ho.__cast=function(e,t){if(ho.__instanceof(e,t))return e;throw new _o("Cannot cast "+g.string(e)+" to "+g.string(t))},ho.__nativeClassName=function(e){var t=ho.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},ho.__isNativeObj=function(e){return null!=ho.__nativeClassName(e)},ho.__resolveNativeClass=function(e){return t[e]};var fo=function(){};n["js.Browser"]=fo,fo.__name__=["js","Browser"],fo.getLocalStorage=function(){try{var e=window.localStorage;return e.getItem(""),e}catch(e){return null}};var mo=function(e){if(e instanceof Array&&null==e.__enum__)this.a=e,this.byteLength=e.length;else{var t=e;this.a=[];for(var n=0,i=t;n<i;){var r=n++;this.a[r]=0}this.byteLength=t}};n["js.html.compat.ArrayBuffer"]=mo,mo.__name__=["js","html","compat","ArrayBuffer"],mo.sliceImpl=function(e,t){var n=new Zo(this,e,null==t?null:t-e),i=new Xo(n.byteLength);return new Zo(i).set(n),i},mo.prototype={slice:function(e,t){return new mo(this.a.slice(e,t))},__class__:mo};var po=function(){};n["js.html.compat.Uint8Array"]=po,po.__name__=["js","html","compat","Uint8Array"],po._new=function(e,t,n){var i;if("number"==typeof e){i=[];for(var r=0,a=e;r<a;){i[r++]=0}i.byteLength=i.length,i.byteOffset=0,i.buffer=new mo(i)}else if(ho.__instanceof(e,mo)){var o=e;null==t&&(t=0),null==n&&(n=o.byteLength-t),(i=0==t?o.a:o.a.slice(t,t+n)).byteLength=i.length,i.byteOffset=t,i.buffer=o}else{if(!(e instanceof Array&&null==e.__enum__))throw new _o("TODO "+g.string(e));(i=e.slice()).byteLength=i.length,i.byteOffset=0,i.buffer=new mo(i)}return i.subarray=po._subarray,i.set=po._set,i},po._set=function(e,t){if(ho.__instanceof(e.buffer,mo)){var n=e;if(e.byteLength+t>this.byteLength)throw new _o("set() outside of range");for(var i=0,r=e.byteLength;i<r;){var a=i++;this[a+t]=n[a]}}else{if(!(e instanceof Array&&null==e.__enum__))throw new _o("TODO");var o=e;if(o.length+t>this.byteLength)throw new _o("set() outside of range");for(var s=0,l=o.length;s<l;){var u=s++;this[u+t]=o[u]}}},po._subarray=function(e,t){var n=po._new(this.slice(e,t));return n.byteOffset=e,n};var go=function(e,t){var n=new ro(e);n.set_bigEndian(!0),this.o=this.decode(n,t)};n["msgpack.Decoder"]=go,go.__name__=["msgpack","Decoder"],go.prototype={decode:function(e,t){try{var n=e.readByte();switch(n){case 192:return null;case 194:return!1;case 195:return!0;case 202:return e.readFloat();case 203:return e.readDouble();case 204:return e.readByte();case 205:return e.readUInt16();case 206:return e.readInt32();case 207:return new pi(e.readInt32(),e.readInt32());case 208:return e.readInt8();case 209:return e.readInt16();case 210:return e.readInt32();case 211:return new pi(e.readInt32(),e.readInt32());case 218:case 219:return e.read(218==n?e.readUInt16():e.readInt32()).toString();case 220:case 221:return this.readArray(e,220==n?e.readUInt16():e.readInt32(),t);case 222:case 223:return this.readMap(e,222==n?e.readUInt16():e.readInt32(),t);default:if(n<128)return n;if(n<144)return this.readMap(e,15&n,t);if(n<160)return this.readArray(e,15&n,t);if(n<192)return e.read(31&n).toString();if(n>223)return-256|n}}catch(e){if(e instanceof _o&&(e=e.val),!ho.__instanceof(e,so))throw e}return null},readArray:function(e,t,n){for(var i=[],r=0,a=t;r<a;){r++;i.push(this.decode(e,n))}return i},readMap:function(e,t,n){if(n){for(var i={},r=0,a=t;r<a;){r++;var o=this.decode(e,n),s=this.decode(e,n);i[o]=s}return i}for(var l=new Xa,u=0,c=t;u<c;){u++;var _=this.decode(e,n),h=this.decode(e,n);l.set(_,h)}return l},getResult:function(){return this.o},__class__:go};var vo=function(e){this.o=new oo,this.o.set_bigEndian(!0),this.encode(e)};n["msgpack.Encoder"]=vo,vo.__name__=["msgpack","Encoder"],vo.prototype={encode:function(e){var t=w.typeof(e);switch(t[1]){case 0:this.o.writeByte(192);break;case 1:var n=e;n<-32?n<-32768?(this.o.writeByte(210),this.o.writeInt32(n)):n<-128?(this.o.writeByte(209),this.o.writeInt16(n)):(this.o.writeByte(208),this.o.writeInt8(n)):n<128?this.o.writeByte(255&n):n<256?(this.o.writeByte(204),this.o.writeByte(n)):n<65536?(this.o.writeByte(205),this.o.writeUInt16(n)):(this.o.writeByte(206),this.o.writeInt32(n));break;case 2:var i=e,r=Math.abs(i);r>1.401298464324817e-45&&r<3.4028234663852886e38?(this.o.writeByte(202),this.o.writeFloat(i)):(this.o.writeByte(203),this.o.writeDouble(i));break;case 3:this.o.writeByte(e?195:194);break;case 4:var a=p.fields(e),o=l.count(a);o<16?this.o.writeByte(128|o):o<65536?(this.o.writeByte(222),this.o.writeUInt16(o)):(this.o.writeByte(223),this.o.writeInt32(o));for(var s=0;s<a.length;){var u=a[s];++s;var c=to.ofString(u),_=c.length;_<32?this.o.writeByte(160|_):_<65536?(this.o.writeByte(218),this.o.writeUInt16(_)):(this.o.writeByte(219),this.o.writeInt32(_)),this.o.write(c),this.encode(p.field(e,u))}break;case 5:throw new _o("Error: Function not supported");case 6:var h=t[2];switch(w.getClassName(h)){case"Array":var d=e,f=d.length;f<16?this.o.writeByte(144|f):f<65536?(this.o.writeByte(220),this.o.writeUInt16(f)):(this.o.writeByte(221),this.o.writeInt32(f));for(var m=0;m<d.length;){var g=d[m];++m,this.encode(g)}break;case"Hash":var v=e,S=l.count(v);S<16?this.o.writeByte(128|S):S<65536?(this.o.writeByte(222),this.o.writeUInt16(S)):(this.o.writeByte(223),this.o.writeInt32(S));for(var y=v.keys();y.hasNext();){var T=y.next(),I=to.ofString(T),E=I.length;E<32?this.o.writeByte(160|E):E<65536?(this.o.writeByte(218),this.o.writeUInt16(E)):(this.o.writeByte(219),this.o.writeInt32(E)),this.o.write(I),this.encode(null!=Jo[T]?v.getReserved(T):v.h[T])}break;case"String":var N=to.ofString(e),A=N.length;A<32?this.o.writeByte(160|A):A<65536?(this.o.writeByte(218),this.o.writeUInt16(A)):(this.o.writeByte(219),this.o.writeInt32(A)),this.o.write(N);break;case"haxe._Int64.___Int64":var b=e;this.o.writeByte(b.high<0?211:207),this.o.writeInt32(b.high),this.o.writeInt32(b.low)}break;case 7:throw new _o("Error: Enum not supported");case 8:throw new _o("Error: Unknown Data Type")}},writeInt:function(e){e<-32?e<-32768?(this.o.writeByte(210),this.o.writeInt32(e)):e<-128?(this.o.writeByte(209),this.o.writeInt16(e)):(this.o.writeByte(208),this.o.writeInt8(e)):e<128?this.o.writeByte(255&e):e<256?(this.o.writeByte(204),this.o.writeByte(e)):e<65536?(this.o.writeByte(205),this.o.writeUInt16(e)):(this.o.writeByte(206),this.o.writeInt32(e))},writeInt64:function(e){this.o.writeByte(e.high<0?211:207),this.o.writeInt32(e.high),this.o.writeInt32(e.low)},writeFloat:function(e){var t=Math.abs(e);t>1.401298464324817e-45&&t<3.4028234663852886e38?(this.o.writeByte(202),this.o.writeFloat(e)):(this.o.writeByte(203),this.o.writeDouble(e))},writeRaw:function(e){var t=e.length;t<32?this.o.writeByte(160|t):t<65536?(this.o.writeByte(218),this.o.writeUInt16(t)):(this.o.writeByte(219),this.o.writeInt32(t)),this.o.write(e)},writeArray:function(e){var t=e.length;t<16?this.o.writeByte(144|t):t<65536?(this.o.writeByte(220),this.o.writeUInt16(t)):(this.o.writeByte(221),this.o.writeInt32(t));for(var n=0;n<e.length;){var i=e[n];++n,this.encode(i)}},writeMapLength:function(e){e<16?this.o.writeByte(128|e):e<65536?(this.o.writeByte(222),this.o.writeUInt16(e)):(this.o.writeByte(223),this.o.writeInt32(e))},writeHashMap:function(e){var t=l.count(e);t<16?this.o.writeByte(128|t):t<65536?(this.o.writeByte(222),this.o.writeUInt16(t)):(this.o.writeByte(223),this.o.writeInt32(t));for(var n=e.keys();n.hasNext();){var i=n.next(),r=to.ofString(i),a=r.length;a<32?this.o.writeByte(160|a):a<65536?(this.o.writeByte(218),this.o.writeUInt16(a)):(this.o.writeByte(219),this.o.writeInt32(a)),this.o.write(r),this.encode(null!=Jo[i]?e.getReserved(i):e.h[i])}},writeObjectMap:function(e){var t=p.fields(e),n=l.count(t);n<16?this.o.writeByte(128|n):n<65536?(this.o.writeByte(222),this.o.writeUInt16(n)):(this.o.writeByte(223),this.o.writeInt32(n));for(var i=0;i<t.length;){var r=t[i];++i;var a=to.ofString(r),o=a.length;o<32?this.o.writeByte(160|o):o<65536?(this.o.writeByte(218),this.o.writeUInt16(o)):(this.o.writeByte(219),this.o.writeInt32(o)),this.o.write(a),this.encode(p.field(e,r))}},getBytes:function(){return this.o.getBytes()},__class__:vo};var So=function(){};n["msgpack.MsgPack"]=So,So.__name__=["msgpack","MsgPack"],So.encode=function(e){return new vo(e).o.getBytes()},So.decode=function(e,t){return null==t&&(t=!0),new go(e,t).o};var yo=function(){};n["puremvc.interfaces.IController"]=yo,yo.__name__=["puremvc","interfaces","IController"],yo.prototype={__class__:yo};var wo=function(){wo.instance=this,this.commandMap=new eo,this.initializeController()};n["puremvc.core.Controller"]=wo,wo.__name__=["puremvc","core","Controller"],wo.__interfaces__=[yo],wo.getInstance=function(){return null==wo.instance&&(wo.instance=new wo),wo.instance},wo.prototype={initializeController:function(){this.view=No.getInstance()},executeCommand:function(e){var t=this.commandMap,n=e.getName(),i=null!=Jo[n]?t.getReserved(n):t.h[n];null!=i&&w.createInstance(i,[]).execute(e)},registerCommand:function(e,t){var n=this.commandMap;(null!=Jo[e]?n.existsReserved(e):n.h.hasOwnProperty(e))||this.view.registerObserver(e,new Mo(Ro(this,this.executeCommand),this));var i=this.commandMap;null!=Jo[e]?i.setReserved(e,t):i.h[e]=t},hasCommand:function(e){var t=this.commandMap;return null!=Jo[e]?t.existsReserved(e):t.h.hasOwnProperty(e)},removeCommand:function(e){this.hasCommand(e)&&(this.view.removeObserver(e,this),this.commandMap.remove(e))},__class__:wo};var To=function(){};n["puremvc.interfaces.IModel"]=To,To.__name__=["puremvc","interfaces","IModel"],To.prototype={__class__:To};var Io=function(){Io.instance=this,this.proxyMap=new eo,this.initializeModel()};n["puremvc.core.Model"]=Io,Io.__name__=["puremvc","core","Model"],Io.__interfaces__=[To],Io.getInstance=function(){return null==Io.instance&&(Io.instance=new Io),Io.instance},Io.prototype={initializeModel:function(){},registerProxy:function(e){var t=this.proxyMap,n=e.getProxyName();null!=Jo[n]?t.setReserved(n,e):t.h[n]=e,e.onRegister()},retrieveProxy:function(e){var t=this.proxyMap;return null!=Jo[e]?t.getReserved(e):t.h[e]},hasProxy:function(e){var t=this.proxyMap;return null!=Jo[e]?t.existsReserved(e):t.h.hasOwnProperty(e)},removeProxy:function(e){var t=this.proxyMap,n=null!=Jo[e]?t.getReserved(e):t.h[e];return null!=n&&(this.proxyMap.remove(e),n.onRemove()),n},__class__:Io};var Eo=function(){};n["puremvc.interfaces.IView"]=Eo,Eo.__name__=["puremvc","interfaces","IView"],Eo.prototype={__class__:Eo};var No=function(){No.instance=this,this.mediatorMap=new eo,this.observerMap=new eo,this.initializeView()};n["puremvc.core.View"]=No,No.__name__=["puremvc","core","View"],No.__interfaces__=[Eo],No.getInstance=function(){return null==No.instance&&(No.instance=new No),No.instance},No.prototype={initializeView:function(){},registerObserver:function(e,t){var n=this.observerMap;if(!(null!=Jo[e]?n.existsReserved(e):n.h.hasOwnProperty(e))){var i=this.observerMap,r=new u;null!=Jo[e]?i.setReserved(e,r):i.h[e]=r}var a=this.observerMap;(null!=Jo[e]?a.getReserved(e):a.h[e]).add(t)},notifyObservers:function(e){var t=this.observerMap,n=e.getName();if(null!=Jo[n]?t.existsReserved(n):t.h.hasOwnProperty(n)){for(var i=this.observerMap,r=e.getName(),a=null!=Jo[r]?i.getReserved(r):i.h[r],o=new u,s=new _(a.h);s.hasNext();){var l=s.next();o.add(l)}for(var c=new _(o.h);c.hasNext();){c.next().notifyObserver(e)}}},removeObserver:function(e,t){for(var n=this.observerMap,i=null!=Jo[e]?n.getReserved(e):n.h[e],r=i.h;null!=r;){var a=r.item;r=r.next;var o=a;if(1==o.compareNotifyContext(t)){i.remove(o);break}}i.isEmpty()&&this.observerMap.remove(e)},registerMediator:function(e){var t=this.mediatorMap,n=e.getMediatorName();if(null!=Jo[n]?!t.existsReserved(n):!t.h.hasOwnProperty(n)){var i=this.mediatorMap,r=e.getMediatorName();null!=Jo[r]?i.setReserved(r,e):i.h[r]=e;var a=e.listNotificationInterests();if(a.length>0)for(var o=new Mo(Ro(e,e.handleNotification),e),s=0,l=a.length;s<l;){var u=s++;this.registerObserver(a[u],o)}e.onRegister()}},retrieveMediator:function(e){var t=this.mediatorMap;return null!=Jo[e]?t.getReserved(e):t.h[e]},removeMediator:function(e){var t=this.mediatorMap,n=null!=Jo[e]?t.getReserved(e):t.h[e];if(null!=n){for(var i=n.listNotificationInterests(),r=0,a=i.length;r<a;){var o=r++;this.removeObserver(i[o],n)}this.mediatorMap.remove(e),n.onRemove()}return n},hasMediator:function(e){var t=this.mediatorMap;return null!=Jo[e]?t.existsReserved(e):t.h.hasOwnProperty(e)},__class__:No};var Ao=function(){};n["puremvc.interfaces.INotification"]=Ao,Ao.__name__=["puremvc","interfaces","INotification"],Ao.prototype={__class__:Ao};var bo=function(){};n["puremvc.interfaces.IObserver"]=bo,bo.__name__=["puremvc","interfaces","IObserver"],bo.prototype={__class__:bo};var Do=function(e,t,n){this.name=e,null!=t&&(this.body=t),null!=n&&(this.type=n)};n["puremvc.patterns.observer.Notification"]=Do,Do.__name__=["puremvc","patterns","observer","Notification"],Do.__interfaces__=[Ao],Do.prototype={getName:function(){return this.name},setBody:function(e){this.body=e},getBody:function(){return this.body},setType:function(e){this.type=e},getType:function(){return this.type},toString:function(){var e="Notification Name: "+this.getName();return e+="\nBody:"+(null==this.body?"null":this.body.toString()),e+="\nType:"+(null==this.type?"null":this.type)},__class__:Do};var Mo=function(e,t){this.setNotifyMethod(e),this.setNotifyContext(t)};function Co(e){return e instanceof Array?function(){return s.iter(e)}:"function"==typeof e.iterator?Ro(e,e.iterator):e.iterator}n["puremvc.patterns.observer.Observer"]=Mo,Mo.__name__=["puremvc","patterns","observer","Observer"],Mo.__interfaces__=[bo],Mo.prototype={setNotifyMethod:function(e){this.notify=e},setNotifyContext:function(e){this.context=e},getNotifyMethod:function(){return this.notify},getNotifyContext:function(){return this.context},notifyObserver:function(e){this.getNotifyMethod()(e)},compareNotifyContext:function(e){return e==this.context},__class__:Mo};var ko,Oo=0;function Ro(e,t){return null==t?null:(null==t.__id__&&(t.__id__=Oo++),null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[t.__id__],null==n&&((n=function(){return n.method.apply(n.scope,arguments)}).scope=e,n.method=t,e.hx__closures__[t.__id__]=n),n);var n}function Fo(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function Uo(e){return"function"==typeof e}function xo(e){return"object"==typeof e&&null!==e}function Po(e){return void 0===e}(Ko={}).exports=null,Ko.exports=Fo,Fo.EventEmitter=Fo,Fo.prototype._events=void 0,Fo.prototype._maxListeners=void 0,Fo.defaultMaxListeners=10,Fo.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},Fo.prototype.emit=function(e){var t,n,i,r,a,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||xo(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(Po(n=this._events[e]))return!1;if(Uo(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),n.apply(this,r)}else if(xo(n))for(r=Array.prototype.slice.call(arguments,1),i=(o=n.slice()).length,a=0;a<i;a++)o[a].apply(this,r);return!0},Fo.prototype.addListener=function(e,t){var n;if(!Uo(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,Uo(t.listener)?t.listener:t),this._events[e]?xo(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,xo(this._events[e])&&!this._events[e].warned&&(n=Po(this._maxListeners)?Fo.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},Fo.prototype.on=Fo.prototype.addListener,Fo.prototype.once=function(e,t){if(!Uo(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},Fo.prototype.removeListener=function(e,t){var n,i,r,a;if(!Uo(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(n=this._events[e]).length,i=-1,n===t||Uo(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(xo(n)){for(a=r;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},Fo.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(Uo(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},Fo.prototype.listeners=function(e){return this._events&&this._events[e]?Uo(this._events[e])?[this._events[e]]:this._events[e].slice():[]},Fo.listenerCount=function(e,t){return e._events&&e._events[t]?Uo(e._events[t])?1:e._events[t].length:0};Ko.exports;n.Math=Math;var Lo=Lo||{};Lo.exports=(()=>{var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,r={};((t,n)=>{for(var i in n)e(t,i,{get:n[i],enumerable:!0})})(r,{codePointCount:()=>o,extractMentionParts:()=>h,findMentionSuggestionHint:()=>f,hasMentionPartForMeOrAll:()=>l,invalidateManualMentionMarkup:()=>c,parseMessageMention:()=>_,removeMentionMarkup:()=>u});var a=e=>Array.from(e),o=e=>a(e).length,s=/{@:(ALL|\d+),(\d+)}@/g,l=e=>h(e).some(({userIdNumStr:e})=>null===e||"ALL"===e),u=e=>_(e).map(t=>"mention"===t.type?t.mentionText:"normal"===t.type?e.substring(t.start,t.end):"").join(""),c=e=>e.replace(s,e=>e.substring(0,e.length-1)+" "),_=e=>{let t=0;const n=h(e).flatMap(e=>{const n=[];return t!==e.start&&n.push({type:"normal",start:t,end:e.start}),n.push(e),t=e.end,n});return e.length!==t&&n.push({type:"normal",start:t,end:e.length}),n},h=e=>{let t=0;return Array.from(e.matchAll(s)).flatMap(n=>{var i;const r=null!=(i=n.index)?i:0;if(r<t)return[];const o=r+n[0].length,s=n[1],l=n[2],u=parseInt(l);if(u<2)return[];const c=u-1,_=o+2*c,h=e.substring(o,_),d=a(h).slice(0,c);if(d.length!==c)return[];const f=d.join(""),m="@"+f,p={type:"mention",start:r,end:o+f.length,userIdNumStr:s,mentionText:m};return t=p.end,p})},d=/^(.*?)([@]?[@])([^@\s]*)$/,f=e=>{const t=e.match(d);return null===t?null:{prev:t[1],atMarks:t[2],keyword:t[3]}};return(r=>((r,a,o,s)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let l of n(a))i.call(r,l)||l===o||e(r,l,{get:()=>a[l],enumerable:!(s=t(a,l))||s.enumerable});return r})(e({},"__esModule",{value:!0}),r))(r)})();var Bo=Lo.exports;String.prototype.__class__=n.String=String,String.__name__=["String"],n.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=n.Date=Date,Date.__name__=["Date"];var Go=n.Int={__name__:["Int"]},Ho=n.Dynamic={__name__:["Dynamic"]},zo=n.Float=Number;zo.__name__=["Float"];var Yo=n.Bool=Boolean;Yo.__ename__=["Bool"];var Ko,Wo=n.Class={__name__:["Class"]},jo={};(Ko={}).exports=null,Ko.exports={upload:function(e){var t=e.url,n=e.headers,i=e.data,r=e.files,a=e.complete,o=new FormData;for(var s in i)i.hasOwnProperty(s)&&o.append(s,i[s]);for(var s in r)r.hasOwnProperty(s)&&o.append(s,r[s]);var l=new XMLHttpRequest;for(var s in l.open("POST",t,!0),n)n.hasOwnProperty(s)&&l.setRequestHeader(s,n[s]);return l.onload=function(e){4===l.readyState&&a(200===l.status,l)},l.onerror=function(e){a(!1,l)},l.send(o),l}};var Vo=Ko.exports,qo={websocketsbinary:!0,audio:!1},Qo={},Jo={},Xo=t.ArrayBuffer||mo;null==Xo.prototype.slice&&(Xo.prototype.slice=mo.sliceImpl);var Zo=t.Uint8Array||po._new;E.APP_STATE_CHANGED="app_state_changed",E.ACCESS_TOKEN_CHANGED="access_token_changed",E.CURRENT_USER_CHANGED="current_user_changed",E.CONFIGURATION_CHANGED="configuration_changed",E.DOMAIN_SELECTION_CHANGED="domain_selection_changed",E.TALK_SELECTION_CHANGED="talk_selection_changed",E.TALK_LIST_SCROLL_TO_TALK_TOP_NEEDED="talk_list_scroll_to_talk_top_needed",E.USER_SELECTION_NEEDED="user_selection_needed",E.USER_SELECTION_CHANGED="user_selection_changed",E.FRIEND_SELECTION_NEEDED="friend_selection_needed",E.COMMON_STAMP_SET_LOADED="common_stamp_set_loaded",E.STAMP_SELECTION_STARTED="stamp_selection_started",E.STAMP_SELECTION_ENDED="stamp_selection_ended",E.STAMP_SELECTION_CHANGED="stamp_selection_changed",E.ACTION_SELECTION_CHANGED="action_selection_changed",E.CURRENT_PAGE_CHANGED="current_page_changed",E.CURRENT_PAGE_REASSIGNED="current_page_reassgined",E.FILEINFO_SELECTION_CHANGED="fileinfo_selection_changed",E.NOTE_FILEINFO_SELECTION_CHANGED="note_fileinfo_selection_changed",E.MESSAGE_FILEINFO_SELECTION_CHANGED="message_fileinfo_selection_changed",E.STAGED_FILEINFO_SELECTION_CHANGED="staged_fileinfo_selection_changed",E.STAGED_FILEINFOS_ADDED="staged_fileinfos_added",E.STAGED_FILEINFOS_MOVED="staged_fileinfos_moved",E.CLOSE_FILEPREVIEW_MODAL="close_filepreview_modal",E.ERROR_OCCURRED="error_occurred",E.UNREAD_COUNT_CHANGED="brand_badge_changed",E.SEND_FORM_TOP_CHANGED="send_form_top_changed",E.SOLUTIONS_LOADED="solutions_loaded",E.RIGHT_PANE_OPENED="right_pane_opened",E.RIGHT_PANE_CLOSED="right_pane_closed",E.PASSWORD_EXPIRATION_OVERED="password_expiration_overed",E.PASSWORD_EXPIRATION_WARNED="password_expiration_warned",E.PHOTO_EDITOR_SAVED="photo_editor_saved",E.ICON_EDITOR_SAVED="icon_editor_saved",E.MC_AUTHENTICATED_USER_RECEIVED="mc_authenticated_user_received",E.KEYWORD_WATCHING_UPDATED="keyword_watching_updated",E.KEYWORD_DETECTION_UPDATED="keyword_detaction_updated",E.DEPARTMENT_SELECTION_CHANGED_FOR_MEMBERS_PAGE="department_selection_changed_for_members_page",E.PRESENCES_UPDATED="presences_updated",E.NOTEINFO_SELECTION_CHANGED="noteinfo_selection_changed",E.START_NOTE_EDITING="start_note_editing",E.OPEN_EXISTING_PAIR_TALK_COMPLETED="open_existing_pair_talk_completed",E.FIRST_ROUTING_WILL_START="first_routing_will_start",E.SIGNED_OUT="signed_out",E.ROUTUNG_TALK_FALLBACK="routing_talk_fallback",E.ROUTUNG_DOMAIN_FALLBACK="routing_domain_fallback",E.TALKS_SORT_MODE_CHANGED="talks_sort_mode_changed",E.DATA_RECOVERING="data_recovering",E.DATA_RECOVERED="data_recovered",E.NOTIFY_UPDATE_USER="notify_update_user",E.NOTIFY_ADD_FRIEND="notify_add_friend",E.NOTIFY_ADD_ACQUAINTANCE="notify_add_acquaintance",E.NOTIFY_ADD_ACQUAINTANCES="notify_add_acquaintances",E.NOTIFY_DELETE_FRIEND="notify_delete_friend",E.NOTIFY_DELETE_ACQUAINTANCE="notify_delete_acquaintance",E.NOTIFY_DELETE_ACQUAINTANCES="notify_delete_acquaintances",E.NOTIFY_UPDATE_DOMAIN_USERS="notify_update_domain_users",E.GET_DOMAIN_USERS_RESPONSED="get_domain_users_responsed",E.GET_USERS_RESPONSED="get_users_responsed",E.GET_PROFILE_RESPONSED="get_profile_responsed",E.GET_PROFILE_ERRORED="get_profile_errored",E.UPDATE_USER_RESPONSED="update_user_responsed",E.UPDATE_USER_ERRORED="update_user_errored",E.UPDATE_PROFILE_RESPONSED="update_profile_responsed",E.UPDATE_PROFILE_ERRORED="update_profile_errored",E.NOTIFY_UPDATE_DEPARTMENT_TREE="notify_update_department_tree",E.NOTIFY_UPDATE_DEPARTMENT_USERS="notify_update_department_users",E.GET_DEPARTMENT_TREE_RESPONSED="get_department_tree_responsed",E.GET_DEPARTMENT_TREE_CANCELED="get_department_tree_canceled",E.GET_DEPARTMENT_USERS_RESPONSED="get_department_users_responsed",E.GET_DEPARTMENT_USERS_CANCELED="get_department_users_canceled",E.GET_DEPARTMENT_USER_COUNT_RESPONSED="get_department_user_count_responsed",E.GET_ME_RESPONSED="get_me_responsed",E.DEPARTMENT_USER_COUNT_CLEARED="department_user_count_cleared",E.DEPARTMENT_USER_IDS_PREPARED="department_user_ids_prepared",E.NOTIFY_ADD_DOMAIN_INVITE="notify_add_domain_invite",E.NOTIFY_ACCEPT_DOMAIN_INVITE="notify_accept_domain_invite",E.NOTIFY_DELETE_DOMAIN_INVITE="notify_delete_domain_invite",E.NOTIFY_JOIN_DOMAIN="notify_join_domain",E.NOTIFY_UPDATE_DOMAIN="notify_update_domain",E.NOTIFY_LEAVE_DOMAIN="notify_leave_domain",E.NOTIFY_ADD_DOMAIN_MEMBERS="notify_add_domain_members",E.NOTIFY_CREATE_PAIR_TALK="notify_create_pair_talk",E.CREATE_PAIR_TALK_COMPLETE="create_pair_talk_complete",E.CREATE_PAIR_TALK_FAIL="create_pair_talk_fail",E.NOTIFY_CREATE_GROUP_TALK="notify_create_group_talk",E.CREATE_GROUP_TALK_COMPLETE="create_group_talk_complete",E.CREATE_GROUP_TALK_FAIL="create_group_talk_fail",E.NOTIFY_UPDATE_GROUP_TALK="notify_update_group_talk",E.UPDATE_GROUP_TALK_COMPLETE="update_group_talk_complete",E.UPDATE_GROUP_TALK_FAIL="update_group_talk_fail",E.NOTIFY_ADD_TALKERS="notify_add_talkers",E.NOTIFY_ADD_TALKERS_INCLUDING_ME="notify_add_talkers_including_me",E.NOTIFY_DELETE_TALKER="notify_delete_talker",E.NOTIFY_DELETE_TALK="notify_delete_talk",E.NOTIFY_UPDATE_READ_STATUSES="notify_update_read_statuses",E.NOTIFY_UPDATE_TALK_STATUS="notify_update_talk_status",E.NOTIFY_UPDATE_LOCAL_TALK_STATUS="notify_update_local_talk_status",E.NOTIFY_ADD_FAVORITE_TALK="notify_add_favorite_talk",E.NOTIFY_DELETE_FAVORITE_TALK="notify_delete_favorite_talk",E.NOTIFY_DISABLE_PUSH_NOTIFICATION="notify_disable_push_notification",E.NOTIFY_ENABLE_PUSH_NOTIFICATION="notify_enable_push_notification",E.ADD_TALKERS_SUCCEEDED="add_talkers_succeeded",E.ADD_TALKERS_FAILED="add_talkers_failed",E.NOTIFY_CREATE_MESSAGE="notify_create_message",E.NOTIFY_DELETE_MESSAGE="notify_delete_message",E.NOTIFY_GET_MESSAGES="notify_get_messages",E.NOTIFY_GET_MESSAGE_READ_STATUS="notify_get_message_status",E.CREATE_MESSAGE_START="create_message_start",E.CREATE_MESSAGE_COMPLETE="create_message_complete",E.CREATE_MESSAGE_FAIL="create_message_fail",E.ADD_FAVORITE_MESSAGE_COMPLETED="add_favorite_message_completed",E.DELETE_FAVORITE_MESSAGE_COMPLETED="delete_favorite_message_completed",E.GET_FAVORITE_MESSAGES_COMPLETED="get_favorite_messages_completed",E.NOTIFY_ADD_FAVORITE_MESSAGE="notify_add_favorite_message",E.NOTIFY_DELETE_FAVORITE_MESSAGE="notify_delete_favorite_message",E.NOTIFY_SCHEDULE_MESSAGE="notify_schedule_message",E.NOTIFY_PROCESSED_SCHEDULED_MESSAGE="notify_processed_scheduled_message",E.NOTIFY_DELETE_SCHEDULED_MESSAGE="notify_delete_scheduled_message",E.GET_SCHEDULED_MESSAGES_COMPLETED="get_scheduled_messages_completed",E.GET_SCHEDULED_MESSAGES_FAILED="get_scheduled_messages_failed",E.DELETE_SCHEDULED_MESSAGES_COMPLETED="delete_scheduled_messages_completed",E.SCHEDULE_MESSAGE_STARTED="schedule_message_started",E.SCHEDULE_MESSAGE_COMPLETED="schedule_message_completed",E.SCHEDULE_MESSAGE_FAILED="schedule_message_faileed",E.NOTIFY_UPDATE_MESSAGE_REACTIONS="notify_update_message_reactions",E.GET_MESSAGE_REACTION_SUMMARIES_COMPLETED="get_message_reaction_summaries_completed",E.GET_MESSAGE_REACTION_SUMMARIES_FAILED="get_message_reaction_summaries_failed",E.SET_MESSAGE_REACTION_COMPLETED="set_message_reaction_completed",E.SET_MESSAGE_REACTION_FAILED="set_message_reaction_failed",E.RESET_MESSAGE_REACTION_COMPLETED="reset_message_reaction_completed",E.RESET_MESSAGE_REACTION_FAILED="reset_message_reaction_failed",E.NOTIFY_CREATE_ANNOUNCEMENT="notify_create_announcement",E.NOTIFY_DELETE_ANNOUNCEMENT="notify_delete_announcement",E.NOTIFY_UPDATE_ANNOUNCEMENT_STATUS="notify_update_announcement_status",E.NOTIFY_GET_ANNOUNCEMENTS="notify_get_announcements",E.CREATE_ANNOUNCEMENT_START="create_announcement_start",E.CREATE_ANNOUNCEMENT_COMPLETE="create_announcement_complete",E.CREATE_ANNOUNCEMENT_FAIL="create_announcement_fail",E.NOTIFY_UPDATE_QUESTION="notify_update_question",E.NOTIFY_GET_QUESTIONS="get_questions_responsed",E.NOTIFY_CREATE_ATTACHMENT="notify_create_attachment",E.NOTIFY_DELETE_ATTACHMENT="notify_delete_attachment",E.GET_FILE_RESPONSED="get_file_responsed",E.GET_FILE_PREVIEW="get_file_preview",E.CREATE_FILE_PREVIEW="create_file_preview",E.GET_NOTE_STATUSES_LOADED="get_note_statuses_loaded",E.GET_NOTE_LOADED="get_note_loaded",E.GET_NOTE_FAILED_BY_NOTE_NOT_FOUND="get_note_failed_by_note_not_found",E.CREATE_NOTE_COMPLETED="create_note_completed",E.CREATE_NOTE_FAILED="create_note_failed",E.UPDATE_NOTE_LOCAL_EDIT="update_note_local_edit",E.CLEAR_NOTE_LOCAL_EDIT="clear_note_local_edit",E.UPDATE_NOTE_SETTING_COMPLETED="update_note_setting_completed",E.UPDATE_NOTE_SETTING_FAILED_BY_NOT_FOUND="update_note_setting_failed_by_not_found",E.UPDATE_NOTE_SETTING_FAILED_BY_CONFLICT="update_note_setting_failed_by_conflict",E.UPDATE_NOTE_SETTING_FAILED_BY_EDITING="update_note_setting_failed_by_editing",E.UPDATE_NOTE_COMPLETED="update_note_completed",E.DELETE_NOTE_COMPLETED="delete_note_completed",E.NOTIFY_CREATE_NOTE="notify_create_note",E.NOTIFY_UPDATE_NOTE_PARTIALLY="notify_update_note_partially",E.NOTIFY_DELETE_NOTE="notify_delete_note",E.NOTIFY_UPDATE_NOTE_FOR_SETTING="notify_update_note_for_setting",E.NOTIFY_UPDATE_NOTE_FOR_SUMMARY="notify_update_note_for_revision",E.CREATE_NOTE_BUTTON_CLICKED="create_note_button_clicked",E.NOTIFY_LOCK_NOTE="notify_lock_note",E.NOTIFY_UNLOCK_NOTE="notify_unlock_note",E.NOTIFY_SEARCH_MESSAGES="notify_search_messages",E.NOTIFY_SEARCH_ATTACHMENTS="notify_search_attachments",E.NOTIFY_SEARCH_MESSAGES_FAIL="notify_search_messages_fail",E.NOTIFY_SEARCH_ATTACHMENTS_FAIL="notify_search_attachments_fail",E.NOTIFY_SEARCH_PREPARE="notify_search_prepare",E.NOTIFY_SEARCH_CLEAR="notify_search_clear",E.NOTIFY_FILTER_BOX_TEXT_CHANGED="notify_filter_box_text_changed",E.NOTIFY_SEARCH_BOX_POPUP="notify_search_box_popup",E.NOTIFY_ADD_ACCOUNT_CONTROL_REQUEST="notify_add_account_control_request",E.NOTIFY_DELETE_ACCOUNT_CONTROL_REQUEST="notify_delete_account_control_request",E.NOTIFY_JOIN_ACCOUNT_CONTROL_GROUP="notify_join_account_control_group",E.NOTIFY_UPDATE_ACCOUNT_CONTROL_GROUP_PARTIALLY="notify_update_account_control_group_partially",E.NOTIFY_LEAVE_ACCOUNT_CONTROL_GROUP="notify_leave_account_control_group",E.PREPARE_CONFERENCE_FROM_MESSAGE="prepare_conference_from_message",E.JOIN_CONFERENCE_RESPONSED="join_conference_responsed",E.JOIN_CONFERENCE_CANCELED="join_conference_canceled",E.GET_CONFERENCE_PARTICIPANTS_RESPONSED="get_conference_participants_responsed",E.NOTIFY_OPEN_CONFERENCE="notify_open_conference",E.NOTIFY_CLOSE_CONFERENCE="notify_close_conference",E.NOTIFY_CONFERENCE_PARTICIPANT_JOIN="notify_conference_participant_join",E.NOTIFY_CONFERENCE_PARTICIPANT_LIMIT="notify_conference_participant_limit",E.NOTIFY_CONFERENCE_PARTICIPANT_REJECT="notify_conference_participant_reject",E.NOTIFY_ALL_TALK_MEMBERS_REJECTED_CONFERENCE="notify_all_talk_members_rejected_conference",E.NOTIFY_UPDATE_DOMAIN_STAMP_SETTING="notify_update_domain_stampsetting",E.NOTIFY_UPDATE_STAMPSET="notify_update_stampset",E.NOTIFY_DELETE_STAMPSET="notify_delete_stampset",E.NOTIFY_UPDATE_DOMAIN_BUILTIN_STAMP_SETTING="notify_update_domain_builtin_stampsetting",E.NOTIFY_FLOW_NOTIFICATION_BADGE="notify_flow_notification_badge",E.GET_FLOW_NOTIFICATION_BADGES_COMPLETED="get_flow_notification_badges_completed",E.GET_FLOW_NOTIFICATION_BADGES_FAILED="get_flow_notification_badges_failed",E.GET_DIRECT_APPS_COMPLETED="get_direct_apps_completed",E.GET_DIRECT_APPS_FAILED="get_direct_apps_failed",E.START_NOTIFICATION_FAILED="start_notification_failed",K.ANNOUNCEMENTS_KEY="-1",X.__meta__={fields:{api:{inject:null}}},X.NAME="AccountControlRequest",$.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},$.NAME="Conference",te.__meta__={fields:{api:{inject:null}}},te.NAME="Device",ie.__meta__={fields:{api:{inject:null}}},ie.NAME="Domain",ae.__meta__={fields:{api:{inject:null}}},ae.NAME="File",se.__meta__={fields:{api:{inject:null}}},se.NAME="FilePreview",le.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},le.NAME="LoadStampset",_e.__meta__={fields:{api:{inject:null}}},_e.NAME="ManageFriends",de.__meta__={fields:{api:{inject:null}}},de.NAME="Message",me.__meta__={fields:{dataStore:{inject:null},api:{inject:null}}},me.NAME="MessageReaction",ge.__meta__={fields:{api:{inject:null},dataStore:{inject:null},fileService:{inject:null}}},ge.NAME="Note",Se.__meta__={fields:{api:{inject:null},keywordWatcher:{inject:null},readStatusUpdater:{inject:null}}},Se.NAME="Read",we.__meta__={fields:{api:{inject:null}}},we.NAME="ReloadData",Ie.__meta__={fields:{dataStore:{inject:null},api:{inject:null}}},Ie.NAME="ScheduleMessage",Ne.__meta__={fields:{api:{inject:null},searchService:{inject:null}}},Ne.NAME="Search",be.__meta__={fields:{dataStore:{inject:null},settings:{inject:null}}},be.NAME="SelectTalk",Me.__meta__={fields:{api:{inject:null}}},Me.NAME="Send",Ce.__meta__={fields:{accessTokenResolver:{inject:null},session:{inject:null}}},Ce.NAME="SignIn",ke.__meta__={fields:{api:{inject:null},settings:{inject:null},dataStore:{inject:null}}},ke.NAME="SignOut",Oe.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},Oe.NAME="Talk",Fe.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},Fe.NAME="UpdateProfile",Ue.__meta__={fields:{api:{inject:null}}},Ue.NAME="UpdateUser",xe.__meta__={fields:{userPresences:{inject:null},api:{inject:null},settings:{inject:null}}},xe.NAME="UpdateUserPresences",xe.MAX_USERS_PER_API=100,Pe.__meta__={fields:{routing:{inject:null}}},Pe.NAME="Url",Ze.TalkAutoScrollDelay=1,Ze.TalkAutoScrollImmediately=2,Ze.TalkAutoScrollNone=3,Ze.NotificationPopupTime5Sec=5,Ze.TalksSortModeNewMessagesFirst="new_messages_first",Ze.TalksSortModeUnreadMessagesFirst="unread_messages_first",Ze.TalksSortModeOldMessagesFirst="old_messages_first",Ze.DomainsSortModeNameOrderAsc="name_order_asc",Ze.OLD_KEY_RIGHT_PANEL_OPENED="right_panel_opened",Ze.OLD_KEY_RIGHT_PANEL_WIDTH="right_panel_width",Ze.OLD_KEY_APP_LEFT_PANEL_OPENED="app_left_panel_opened",Ze.NAME="browser_settings",et.MAX_SIZE=72,nt.INCOMING_TIME=6e4,rt.DEFAULT_PRESENCE_EXPIRATION=3e5,rt.DEFAULT_UPDATE_LAST_USED_AT_INTERVAL=6e5,ot.DEFAULT_TTL=3600,ot.DEFAULT_MAX_PARTICIPANTS=8,xt.stagedFileInfosMaxId=0,Kt.TIMESTAMP_SHIFT=22,Zt.MAX_READ_USER_IDS_COUNT=16,Cn.QUERY_DATE_TODAY="t",Cn.QUERY_DATE_YESTERDAY="-1d",Cn.QUERY_DATE_THREE_DAYS_BEFORE="-3d",Wn.HISTORY_TAB_NAME="stamp-history",gi.SIXTY_MINUTES=new pi(0,36e5),gi.FIFTEEN_MINUTES=new pi(0,9e5),$i.PREFIX="note-",$i.nextDummyId=new pi(-1,-1),ir.CONTINUE_MARGIN_RATE=.1,fr.CHEKBOX_UNCHECKED="- [ ] ",fr.CHEKBOX_CHECKED="- [x] ",wr.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Tr.TU_REG=new o("([BCDFGHIJKLMNOPQRSTUVWYZ])","gm"),Tr.XTU_REG=new o("","gm"),Ar.EMERGENCY=0,Ar.ALERT=1,Ar.CRITICAL=2,Ar.ERROR=3,Ar.WARNING=4,Ar.NOTICE=5,Ar.INFO=6,Ar.DEBUG=7,Ar.level=6,Ar._d=Ar._nop,Ar._i=null!=console?console.info.bind(console):Ar._nop,Ar._w=null!=console?console.warn.bind(console):Ar._nop,Ar._e=null!=console?console.error.bind(console):Ar._nop,kr.HIRAGANA_SMALL_A=12353,kr.HIRAGANA_NN=12435,kr.KATAKANA_SMALL_A=12449,Lr.NAME="accessTokenResolver",Br.NAME="Proxy",Gr.__meta__={fields:{settings:{inject:null},api:{inject:null}}},Hr.__meta__={fields:{api:{inject:null},dataStore:{inject:null},settings:{inject:null},dataFactory:{inject:null},keywordWatcher:{inject:null}}},Hr.NAME="broadcast",zr.__meta__={fields:{wsApi:{inject:null},apiCaller:{inject:null},apiNote:{inject:null},settings:{inject:null},dataStore:{inject:null},dataFactory:{inject:null},fileService:{inject:null},searchService:{inject:null},lastUsedAtUpdater:{inject:null}}},zr.NAME="api",zr.API_VERSION="1.124",zr.UPDATE_VERSION="1.124_1",zr.ACTIONS_COUNT_PER_API=20,Yr.__meta__={fields:{rpc:{inject:null}}},Yr.NAME="apiCaller",Yr.DELAY_FOR_DB_REPLICATION=500,Yr.DELAY_FOR_DB_REPLICATION_FOR_RETRY=1e3,Yr.API_TRY_COUNT=3,Kr.__meta__={fields:{apiCaller:{inject:null},dataStore:{inject:null},settings:{inject:null}}},Kr.NAME="apiNote",Wr.NAME="appState",jr.__meta__={fields:{dataStore:{inject:null}}},jr.NAME="dataFactory",Vr.NAME="dataStore",Vr.STORAGE_KEY_FOR_GENERAL="dataStore",Vr.STORAGE_KEY_FOR_TALKS="dataStoreTalks",Vr.STORAGE_KEY_FOR_TALK_STATUSES="dataStoreTalkStatuses",Vr.STORAGE_KEY_FOR_USERS="dataStoreUsers",Vr.TYPE_FRIEND=0,Vr.TYPE_ACQUAINSTANCE=1,Vr.TYPE_NONE=2,qr.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},qr.NAME="features",Xr.NAME="fileService",Zr.__meta__={fields:{settings:{inject:null}}},$r.__meta__={fields:{settings:{inject:null},features:{inject:null},dataStore:{inject:null}}},$r.NAME="keywordWatcher",$r.TALK_KEY_PREFIX="talk_",$r.ANNOUNCEMENT_KEY_PREFIX="announcement_",ea.TEMP_HALF_SPACE="&SPACE",ea.TEMP_FULL_SPACE="&FULL_PITCH_SPACE",ra.__meta__={fields:{settings:{inject:null}}},ra.NAME="lastUsedAtUpdater",aa.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},aa.NAME="limitations",oa.__meta__={fields:{broadcast:{inject:null},lastUsedAtUpdater:{inject:null}}},oa.NAME="rpc",oa.lastMsgId=0,sa.PING_INTERVAL_ON_CONNECTED=45e3,_a.__meta__={fields:{dataStore:{inject:null},api:{inject:null}}},_a.NAME="readStatusUpdater",ha.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},ha.NAME="routing",ma.__meta__={fields:{settings:{inject:null}}},ma.NAME="searchService",ma.LOAD_SIZE=20,ma.DUMMY_VALUE_FOR_SET=1,pa.__meta__={fields:{settings:{inject:null},dataStore:{inject:null},dataFactory:{inject:null},api:{inject:null}}},pa.NAME="session",ga.NAME="settings",ga.KEY_ACCESS_TOKEN="access_token",ga.KEY_SELECTED_DOMAIN_ID_H="selected_domain_id_h",ga.KEY_SELECTED_DOMAIN_ID_L="selected_domain_id_l",ga.KEY_SELECTED_STAMP_TAB_ID="selected_stamp_tab_id",ga.KEY_INPUT_TEXT="input_text",ga.KEY_COPY_PROFILE_TO_ALL_DOMAINS="copy_profile_to_all_domains",ga.KEY_SELECTED_DEPARTMENT_IDS="selected_department_ids",ga.KEY_SEARCH_HISTORIES="search_histories",ga.KEY_MULTI_VIEW_MODE="multi_view_mode",ga.KEY_PASSWORD_WARNING_SKIP_UNTIL="password_warning_skip_until",ga.KEY_LAST_USED_EXPIRED_AT="last_used_expired_at",ga.KEY_IDFV="idfv",va.__meta__={fields:{dataStore:{inject:null}}},va.NAME="talksService",Sa.__meta__={fields:{dataStore:{inject:null}}},Sa.NAME="userPresences",ya.__meta__={fields:{apiCaller:{inject:null}}},ya.NAME="wsApi",Ma.NAME="Mediator",Ca.__meta__={fields:{dataStore:{inject:null},api:{inject:null}}},Ca.NAME="commandline",Ca.DATA_SAVE_SPAN=5e3,Oa.INVALID_PARAMETER="INVALID_PARAMETER",Oa.FORBIDDEN="FORBIDDEN",Oa.NOT_FOUND="NOT_FOUND",Oa.LOCKED_BY_ANOTHER_USER="LOCKED_BY_ANOTHER_USER",Oa.CONFLICT="CONFLICT",Oa.TOO_MANY_REQUESTS="TOO_MANY_REQUESTS",Oa.UNKNOWN="UNKNOWN",Ba._mul=null!=Math.imul?Math.imul:function(e,t){return e*(65535&t)+(e*(t>>>16)<<16|0)|0},za.USE_CACHE=!1,za.USE_ENUM_INDEX=!1,za.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",Wa.DEFAULT_RESOLVER=new Ka,Wa.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",Xa.count=0,uo.i64tmp=new pi(0,0),ho.__toStr={}.toString,po.BYTES_PER_ELEMENT=1,vo.FLOAT_SINGLE_MIN=1.401298464324817e-45,vo.FLOAT_SINGLE_MAX=3.4028234663852886e38,vo.FLOAT_DOUBLE_MIN=5e-324,vo.FLOAT_DOUBLE_MAX=1.7976931348623157e308,a.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);